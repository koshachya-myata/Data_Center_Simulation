{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -362.84024726019965, "policy_loss": -8386310.591579861, "vf_loss": 21082515.416666668}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 27.5, "diff_num_grad_updates_vs_sampler_policy": 26.5}}, "num_env_steps_sampled": 51430560, "num_env_steps_trained": 51430560, "num_agent_steps_sampled": 51430560, "num_agent_steps_trained": 51430560}, "sampler_results": {"episode_reward_max": -10208.11455103456, "episode_reward_min": -10433.26104331468, "episode_reward_mean": -10320.68779717462, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456], "episode_lengths": [1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.434252302431157, "mean_inference_ms": 0.37368254480834606, "mean_action_processing_ms": 0.09147061352330613, "mean_env_wait_ms": 1.97381002115538, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008058547973632812, "StateBufferConnector_ms": 0.002372264862060547, "ViewRequirementAgentConnector_ms": 0.06322860717773438}}, "episode_reward_max": -10208.11455103456, "episode_reward_min": -10433.26104331468, "episode_reward_mean": -10320.68779717462, "episode_len_mean": 1200.0, "episodes_this_iter": 2, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456], "episode_lengths": [1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.434252302431157, "mean_inference_ms": 0.37368254480834606, "mean_action_processing_ms": 0.09147061352330613, "mean_env_wait_ms": 1.97381002115538, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.008058547973632812, "StateBufferConnector_ms": 0.002372264862060547, "ViewRequirementAgentConnector_ms": 0.06322860717773438}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51430560, "num_agent_steps_trained": 51430560, "num_env_steps_sampled": 51430560, "num_env_steps_trained": 51430560, "num_env_steps_sampled_this_iter": 2400, "num_env_steps_trained_this_iter": 2400, "num_env_steps_sampled_throughput_per_sec": 202.79887941674485, "num_env_steps_trained_throughput_per_sec": 202.79887941674485, "timesteps_total": 51430560, "num_steps_trained_this_iter": 2400, "agent_timesteps_total": 51430560, "timers": {"training_iteration_time_ms": 5917.172, "sample_time_ms": 5876.298, "load_time_ms": 0.587, "load_throughput": 2044339.886, "learn_time_ms": 39.459, "learn_throughput": 30411.688, "synch_weights_time_ms": 0.776}, "counters": {"num_env_steps_sampled": 51430560, "num_env_steps_trained": 51430560, "num_agent_steps_sampled": 51430560, "num_agent_steps_trained": 51430560}, "done": false, "episodes_total": 12315, "training_iteration": 3861, "trial_id": "9f686_00000", "date": "2023-08-08_15-11-13", "timestamp": 1691496673, "time_this_iter_s": 11.836941957473755, "time_total_s": 93096.0101287365, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 11.836941957473755, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 22.176470588235293, "ram_util_percent": 65.74117647058824}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -363.086676703559, "policy_loss": -7481173.42578125, "vf_loss": 21809878.666666668}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 81.5, "diff_num_grad_updates_vs_sampler_policy": 80.5}}, "num_env_steps_sampled": 51434160, "num_env_steps_trained": 51434160, "num_agent_steps_sampled": 51434160, "num_agent_steps_trained": 51434160}, "sampler_results": {"episode_reward_max": -10208.11455103456, "episode_reward_min": -10433.26104331468, "episode_reward_mean": -10343.6339037433, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343], "episode_lengths": [1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4307548554215996, "mean_inference_ms": 0.3736443924472622, "mean_action_processing_ms": 0.09150517805932105, "mean_env_wait_ms": 1.5367064925134752, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069332122802734375, "StateBufferConnector_ms": 0.0025224685668945312, "ViewRequirementAgentConnector_ms": 0.06400585174560547}}, "episode_reward_max": -10208.11455103456, "episode_reward_min": -10433.26104331468, "episode_reward_mean": -10343.6339037433, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343], "episode_lengths": [1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4307548554215996, "mean_inference_ms": 0.3736443924472622, "mean_action_processing_ms": 0.09150517805932105, "mean_env_wait_ms": 1.5367064925134752, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0069332122802734375, "StateBufferConnector_ms": 0.0025224685668945312, "ViewRequirementAgentConnector_ms": 0.06400585174560547}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51434160, "num_agent_steps_trained": 51434160, "num_env_steps_sampled": 51434160, "num_env_steps_trained": 51434160, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 270.3959637377201, "num_env_steps_trained_throughput_per_sec": 270.3959637377201, "timesteps_total": 51434160, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51434160, "timers": {"training_iteration_time_ms": 5029.622, "sample_time_ms": 4993.357, "load_time_ms": 0.6, "load_throughput": 2001417.528, "learn_time_ms": 34.841, "learn_throughput": 34442.544, "synch_weights_time_ms": 0.776}, "counters": {"num_env_steps_sampled": 51434160, "num_env_steps_trained": 51434160, "num_agent_steps_sampled": 51434160, "num_agent_steps_trained": 51434160}, "done": false, "episodes_total": 12318, "training_iteration": 3862, "trial_id": "9f686_00000", "date": "2023-08-08_15-11-26", "timestamp": 1691496686, "time_this_iter_s": 13.3162100315094, "time_total_s": 93109.326338768, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 25.153151988983154, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 20.51052631578947, "ram_util_percent": 65.85263157894738}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-08, "entropy_coeff": 0.15, "policy_entropy": -362.3415239122179, "policy_loss": -5721017.736545139, "vf_loss": 21036212.444444444}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 135.5, "diff_num_grad_updates_vs_sampler_policy": 134.5}}, "num_env_steps_sampled": 51437760, "num_env_steps_trained": 51437760, "num_agent_steps_sampled": 51437760, "num_agent_steps_trained": 51437760}, "sampler_results": {"episode_reward_max": -10143.351118966008, "episode_reward_min": -10433.26104331468, "episode_reward_mean": -10308.957445974784, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4275173516560473, "mean_inference_ms": 0.3732541846422157, "mean_action_processing_ms": 0.09144824357652866, "mean_env_wait_ms": 1.3538712037531981, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006708502769470215, "StateBufferConnector_ms": 0.0025510787963867188, "ViewRequirementAgentConnector_ms": 0.06512999534606934}}, "episode_reward_max": -10143.351118966008, "episode_reward_min": -10433.26104331468, "episode_reward_mean": -10308.957445974784, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4275173516560473, "mean_inference_ms": 0.3732541846422157, "mean_action_processing_ms": 0.09144824357652866, "mean_env_wait_ms": 1.3538712037531981, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006708502769470215, "StateBufferConnector_ms": 0.0025510787963867188, "ViewRequirementAgentConnector_ms": 0.06512999534606934}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51437760, "num_agent_steps_trained": 51437760, "num_env_steps_sampled": 51437760, "num_env_steps_trained": 51437760, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 274.33531369485775, "num_env_steps_trained_throughput_per_sec": 274.33531369485775, "timesteps_total": 51437760, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51437760, "timers": {"training_iteration_time_ms": 4783.837, "sample_time_ms": 4748.558, "load_time_ms": 0.613, "load_throughput": 1956621.721, "learn_time_ms": 33.857, "learn_throughput": 35442.888, "synch_weights_time_ms": 0.761}, "counters": {"num_env_steps_sampled": 51437760, "num_env_steps_trained": 51437760, "num_agent_steps_sampled": 51437760, "num_agent_steps_trained": 51437760}, "done": false, "episodes_total": 12321, "training_iteration": 3863, "trial_id": "9f686_00000", "date": "2023-08-08_15-11-39", "timestamp": 1691496699, "time_this_iter_s": 13.125322341918945, "time_total_s": 93122.45166110992, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 38.2784743309021, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 20.157894736842103, "ram_util_percent": 65.82105263157894}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-08, "entropy_coeff": 0.15, "policy_entropy": -362.25242784288196, "policy_loss": -10632616.822048612, "vf_loss": 21909033.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 189.5, "diff_num_grad_updates_vs_sampler_policy": 188.5}}, "num_env_steps_sampled": 51441360, "num_env_steps_trained": 51441360, "num_agent_steps_sampled": 51441360, "num_agent_steps_trained": 51441360}, "sampler_results": {"episode_reward_max": -10143.351118966008, "episode_reward_min": -10433.26104331468, "episode_reward_mean": -10322.200299981685, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.425952998539952, "mean_inference_ms": 0.37317135720401146, "mean_action_processing_ms": 0.09143720795625371, "mean_env_wait_ms": 1.2484445921161016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006313757462935014, "StateBufferConnector_ms": 0.002574920654296875, "ViewRequirementAgentConnector_ms": 0.06516629999334161}}, "episode_reward_max": -10143.351118966008, "episode_reward_min": -10433.26104331468, "episode_reward_mean": -10322.200299981685, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.425952998539952, "mean_inference_ms": 0.37317135720401146, "mean_action_processing_ms": 0.09143720795625371, "mean_env_wait_ms": 1.2484445921161016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006313757462935014, "StateBufferConnector_ms": 0.002574920654296875, "ViewRequirementAgentConnector_ms": 0.06516629999334161}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51441360, "num_agent_steps_trained": 51441360, "num_env_steps_sampled": 51441360, "num_env_steps_trained": 51441360, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 271.35982729004047, "num_env_steps_trained_throughput_per_sec": 271.35982729004047, "timesteps_total": 51441360, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51441360, "timers": {"training_iteration_time_ms": 4408.749, "sample_time_ms": 4375.242, "load_time_ms": 0.601, "load_throughput": 1995624.599, "learn_time_ms": 32.091, "learn_throughput": 37394.081, "synch_weights_time_ms": 0.769}, "counters": {"num_env_steps_sampled": 51441360, "num_env_steps_trained": 51441360, "num_agent_steps_sampled": 51441360, "num_agent_steps_trained": 51441360}, "done": false, "episodes_total": 12324, "training_iteration": 3864, "trial_id": "9f686_00000", "date": "2023-08-08_15-11-52", "timestamp": 1691496712, "time_this_iter_s": 13.269209146499634, "time_total_s": 93135.72087025642, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 51.54768347740173, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 19.80526315789474, "ram_util_percent": 65.67894736842106}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-08, "entropy_coeff": 0.15, "policy_entropy": -362.1377766927083, "policy_loss": -7517871.170572917, "vf_loss": 21654600.138888888}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 243.5, "diff_num_grad_updates_vs_sampler_policy": 242.5}}, "num_env_steps_sampled": 51444960, "num_env_steps_trained": 51444960, "num_agent_steps_sampled": 51444960, "num_agent_steps_trained": 51444960}, "sampler_results": {"episode_reward_max": -10143.351118966008, "episode_reward_min": -10490.528558995664, "episode_reward_mean": -10326.771470301528, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4248168814351305, "mean_inference_ms": 0.372991488554134, "mean_action_processing_ms": 0.09140758673893493, "mean_env_wait_ms": 1.1778564809486203, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005628381456647601, "StateBufferConnector_ms": 0.0025612967354910715, "ViewRequirementAgentConnector_ms": 0.06530625479561943}}, "episode_reward_max": -10143.351118966008, "episode_reward_min": -10490.528558995664, "episode_reward_mean": -10326.771470301528, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4248168814351305, "mean_inference_ms": 0.372991488554134, "mean_action_processing_ms": 0.09140758673893493, "mean_env_wait_ms": 1.1778564809486203, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005628381456647601, "StateBufferConnector_ms": 0.0025612967354910715, "ViewRequirementAgentConnector_ms": 0.06530625479561943}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51444960, "num_agent_steps_trained": 51444960, "num_env_steps_sampled": 51444960, "num_env_steps_trained": 51444960, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 272.5816924900435, "num_env_steps_trained_throughput_per_sec": 272.5816924900435, "timesteps_total": 51444960, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51444960, "timers": {"training_iteration_time_ms": 4400.944, "sample_time_ms": 4367.544, "load_time_ms": 0.585, "load_throughput": 2050419.522, "learn_time_ms": 32.011, "learn_throughput": 37487.327, "synch_weights_time_ms": 0.757}, "counters": {"num_env_steps_sampled": 51444960, "num_env_steps_trained": 51444960, "num_agent_steps_sampled": 51444960, "num_agent_steps_trained": 51444960}, "done": false, "episodes_total": 12327, "training_iteration": 3865, "trial_id": "9f686_00000", "date": "2023-08-08_15-12-06", "timestamp": 1691496726, "time_this_iter_s": 13.209552764892578, "time_total_s": 93148.93042302132, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 64.75723624229431, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 20.878947368421056, "ram_util_percent": 65.68947368421053}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-08, "entropy_coeff": 0.15, "policy_entropy": -366.0801883273655, "policy_loss": -5426005.181206597, "vf_loss": 21358913.361111112}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 297.5, "diff_num_grad_updates_vs_sampler_policy": 296.5}}, "num_env_steps_sampled": 51448560, "num_env_steps_trained": 51448560, "num_agent_steps_sampled": 51448560, "num_agent_steps_trained": 51448560}, "sampler_results": {"episode_reward_max": -10143.351118966008, "episode_reward_min": -10490.528558995664, "episode_reward_mean": -10322.33860235624, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.423489784150149, "mean_inference_ms": 0.37283615663696795, "mean_action_processing_ms": 0.0913830675228987, "mean_env_wait_ms": 1.1264380815522679, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0052129521089441634, "StateBufferConnector_ms": 0.002559493569766774, "ViewRequirementAgentConnector_ms": 0.06545010735006894}}, "episode_reward_max": -10143.351118966008, "episode_reward_min": -10490.528558995664, "episode_reward_mean": -10322.33860235624, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.423489784150149, "mean_inference_ms": 0.37283615663696795, "mean_action_processing_ms": 0.0913830675228987, "mean_env_wait_ms": 1.1264380815522679, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0052129521089441634, "StateBufferConnector_ms": 0.002559493569766774, "ViewRequirementAgentConnector_ms": 0.06545010735006894}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51448560, "num_agent_steps_trained": 51448560, "num_env_steps_sampled": 51448560, "num_env_steps_trained": 51448560, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 274.1489591223134, "num_env_steps_trained_throughput_per_sec": 274.1489591223134, "timesteps_total": 51448560, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51448560, "timers": {"training_iteration_time_ms": 4395.776, "sample_time_ms": 4362.309, "load_time_ms": 0.583, "load_throughput": 2057964.918, "learn_time_ms": 32.068, "learn_throughput": 37420.02, "synch_weights_time_ms": 0.768}, "counters": {"num_env_steps_sampled": 51448560, "num_env_steps_trained": 51448560, "num_agent_steps_sampled": 51448560, "num_agent_steps_trained": 51448560}, "done": false, "episodes_total": 12330, "training_iteration": 3866, "trial_id": "9f686_00000", "date": "2023-08-08_15-12-19", "timestamp": 1691496739, "time_this_iter_s": 13.134144067764282, "time_total_s": 93162.06456708908, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 77.8913803100586, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 20.055555555555557, "ram_util_percent": 65.81111111111112}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-08, "entropy_coeff": 0.15, "policy_entropy": -364.3952229817708, "policy_loss": -7119043.668402778, "vf_loss": 21432826.444444444}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 351.5, "diff_num_grad_updates_vs_sampler_policy": 350.5}}, "num_env_steps_sampled": 51452160, "num_env_steps_trained": 51452160, "num_agent_steps_sampled": 51452160, "num_agent_steps_trained": 51452160}, "sampler_results": {"episode_reward_max": -10143.351118966008, "episode_reward_min": -10490.528558995664, "episode_reward_mean": -10325.20075211335, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4226039897204137, "mean_inference_ms": 0.372724336749029, "mean_action_processing_ms": 0.09136169856291787, "mean_env_wait_ms": 1.0872486879755103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004899501800537109, "StateBufferConnector_ms": 0.0025451183319091797, "ViewRequirementAgentConnector_ms": 0.06558537483215332}}, "episode_reward_max": -10143.351118966008, "episode_reward_min": -10490.528558995664, "episode_reward_mean": -10325.20075211335, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4226039897204137, "mean_inference_ms": 0.372724336749029, "mean_action_processing_ms": 0.09136169856291787, "mean_env_wait_ms": 1.0872486879755103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004899501800537109, "StateBufferConnector_ms": 0.0025451183319091797, "ViewRequirementAgentConnector_ms": 0.06558537483215332}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51452160, "num_agent_steps_trained": 51452160, "num_env_steps_sampled": 51452160, "num_env_steps_trained": 51452160, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 272.05225163657974, "num_env_steps_trained_throughput_per_sec": 272.05225163657974, "timesteps_total": 51452160, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51452160, "timers": {"training_iteration_time_ms": 4403.768, "sample_time_ms": 4370.579, "load_time_ms": 0.573, "load_throughput": 2092792.017, "learn_time_ms": 31.808, "learn_throughput": 37726.364, "synch_weights_time_ms": 0.76}, "counters": {"num_env_steps_sampled": 51452160, "num_env_steps_trained": 51452160, "num_agent_steps_sampled": 51452160, "num_agent_steps_trained": 51452160}, "done": false, "episodes_total": 12333, "training_iteration": 3867, "trial_id": "9f686_00000", "date": "2023-08-08_15-12-32", "timestamp": 1691496752, "time_this_iter_s": 13.23543119430542, "time_total_s": 93175.29999828339, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 91.12681150436401, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 19.63157894736842, "ram_util_percent": 65.74736842105263}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-08, "entropy_coeff": 0.15, "policy_entropy": -365.36610243055554, "policy_loss": -7814658.052083333, "vf_loss": 21383089.583333332}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 405.5, "diff_num_grad_updates_vs_sampler_policy": 404.5}}, "num_env_steps_sampled": 51455760, "num_env_steps_trained": 51455760, "num_agent_steps_sampled": 51455760, "num_agent_steps_trained": 51455760}, "sampler_results": {"episode_reward_max": -10143.351118966008, "episode_reward_min": -10490.528558995664, "episode_reward_mean": -10317.19822369402, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.421697439275059, "mean_inference_ms": 0.37262189304379767, "mean_action_processing_ms": 0.09133879007159151, "mean_env_wait_ms": 1.0558403705415744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004655381907587466, "StateBufferConnector_ms": 0.0025427859762440557, "ViewRequirementAgentConnector_ms": 0.0653132148410963}}, "episode_reward_max": -10143.351118966008, "episode_reward_min": -10490.528558995664, "episode_reward_mean": -10317.19822369402, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.421697439275059, "mean_inference_ms": 0.37262189304379767, "mean_action_processing_ms": 0.09133879007159151, "mean_env_wait_ms": 1.0558403705415744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004655381907587466, "StateBufferConnector_ms": 0.0025427859762440557, "ViewRequirementAgentConnector_ms": 0.0653132148410963}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51455760, "num_agent_steps_trained": 51455760, "num_env_steps_sampled": 51455760, "num_env_steps_trained": 51455760, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 275.04937392658843, "num_env_steps_trained_throughput_per_sec": 275.04937392658843, "timesteps_total": 51455760, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51455760, "timers": {"training_iteration_time_ms": 4386.976, "sample_time_ms": 4353.677, "load_time_ms": 0.576, "load_throughput": 2083608.544, "learn_time_ms": 31.906, "learn_throughput": 37610.189, "synch_weights_time_ms": 0.769}, "counters": {"num_env_steps_sampled": 51455760, "num_env_steps_trained": 51455760, "num_agent_steps_sampled": 51455760, "num_agent_steps_trained": 51455760}, "done": false, "episodes_total": 12336, "training_iteration": 3868, "trial_id": "9f686_00000", "date": "2023-08-08_15-12-45", "timestamp": 1691496765, "time_this_iter_s": 13.091541051864624, "time_total_s": 93188.39153933525, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 104.21835255622864, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 19.226315789473688, "ram_util_percent": 65.8263157894737}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.999999999999999e-08, "entropy_coeff": 0.15, "policy_entropy": -363.81634351942273, "policy_loss": -8712668.40234375, "vf_loss": 21385793.833333332}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 459.5, "diff_num_grad_updates_vs_sampler_policy": 458.5}}, "num_env_steps_sampled": 51459360, "num_env_steps_trained": 51459360, "num_agent_steps_sampled": 51459360, "num_agent_steps_trained": 51459360}, "sampler_results": {"episode_reward_max": -10143.351118966008, "episode_reward_min": -10490.528558995664, "episode_reward_mean": -10313.92448311808, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4203581214538303, "mean_inference_ms": 0.3725287071841753, "mean_action_processing_ms": 0.09132319120517754, "mean_env_wait_ms": 1.0300901960813766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004496024205134465, "StateBufferConnector_ms": 0.002551995790921725, "ViewRequirementAgentConnector_ms": 0.06563663482666016}}, "episode_reward_max": -10143.351118966008, "episode_reward_min": -10490.528558995664, "episode_reward_mean": -10313.92448311808, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4203581214538303, "mean_inference_ms": 0.3725287071841753, "mean_action_processing_ms": 0.09132319120517754, "mean_env_wait_ms": 1.0300901960813766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004496024205134465, "StateBufferConnector_ms": 0.002551995790921725, "ViewRequirementAgentConnector_ms": 0.06563663482666016}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51459360, "num_agent_steps_trained": 51459360, "num_env_steps_sampled": 51459360, "num_env_steps_trained": 51459360, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 277.3105623985912, "num_env_steps_trained_throughput_per_sec": 277.3105623985912, "timesteps_total": 51459360, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51459360, "timers": {"training_iteration_time_ms": 4364.838, "sample_time_ms": 4331.266, "load_time_ms": 0.572, "load_throughput": 2098026.178, "learn_time_ms": 32.17, "learn_throughput": 37301.629, "synch_weights_time_ms": 0.782}, "counters": {"num_env_steps_sampled": 51459360, "num_env_steps_trained": 51459360, "num_agent_steps_sampled": 51459360, "num_agent_steps_trained": 51459360}, "done": false, "episodes_total": 12339, "training_iteration": 3869, "trial_id": "9f686_00000", "date": "2023-08-08_15-12-58", "timestamp": 1691496778, "time_this_iter_s": 12.984532833099365, "time_total_s": 93201.37607216835, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 117.202885389328, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 23.633333333333333, "ram_util_percent": 65.43333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.25e-08, "entropy_coeff": 0.15, "policy_entropy": -363.82979498969183, "policy_loss": -6766842.00390625, "vf_loss": 21629474.777777776}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 513.5, "diff_num_grad_updates_vs_sampler_policy": 512.5}}, "num_env_steps_sampled": 51462960, "num_env_steps_trained": 51462960, "num_agent_steps_sampled": 51462960, "num_agent_steps_trained": 51462960}, "sampler_results": {"episode_reward_max": -10143.351118966008, "episode_reward_min": -10490.528558995664, "episode_reward_mean": -10315.957146607507, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.41937011927899, "mean_inference_ms": 0.37244029257583466, "mean_action_processing_ms": 0.0913095856433435, "mean_env_wait_ms": 1.0087699974744426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004358127199370286, "StateBufferConnector_ms": 0.002544501732135641, "ViewRequirementAgentConnector_ms": 0.06553880099592538}}, "episode_reward_max": -10143.351118966008, "episode_reward_min": -10490.528558995664, "episode_reward_mean": -10315.957146607507, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.41937011927899, "mean_inference_ms": 0.37244029257583466, "mean_action_processing_ms": 0.0913095856433435, "mean_env_wait_ms": 1.0087699974744426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004358127199370286, "StateBufferConnector_ms": 0.002544501732135641, "ViewRequirementAgentConnector_ms": 0.06553880099592538}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51462960, "num_agent_steps_trained": 51462960, "num_env_steps_sampled": 51462960, "num_env_steps_trained": 51462960, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 271.98584559880464, "num_env_steps_trained_throughput_per_sec": 271.98584559880464, "timesteps_total": 51462960, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51462960, "timers": {"training_iteration_time_ms": 4369.821, "sample_time_ms": 4336.391, "load_time_ms": 0.569, "load_throughput": 2109810.865, "learn_time_ms": 32.032, "learn_throughput": 37462.299, "synch_weights_time_ms": 0.78}, "counters": {"num_env_steps_sampled": 51462960, "num_env_steps_trained": 51462960, "num_agent_steps_sampled": 51462960, "num_agent_steps_trained": 51462960}, "done": false, "episodes_total": 12342, "training_iteration": 3870, "trial_id": "9f686_00000", "date": "2023-08-08_15-13-11", "timestamp": 1691496791, "time_this_iter_s": 13.238578081130981, "time_total_s": 93214.61465024948, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 130.44146347045898, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 19.242105263157892, "ram_util_percent": 65.50526315789473}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.4999999999999996e-08, "entropy_coeff": 0.15, "policy_entropy": -362.09820726182727, "policy_loss": -5830025.690972222, "vf_loss": 21377966.472222224}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 567.5, "diff_num_grad_updates_vs_sampler_policy": 566.5}}, "num_env_steps_sampled": 51466560, "num_env_steps_trained": 51466560, "num_agent_steps_sampled": 51466560, "num_agent_steps_trained": 51466560}, "sampler_results": {"episode_reward_max": -10143.351118966008, "episode_reward_min": -10490.528558995664, "episode_reward_mean": -10307.995697462986, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.418537984848715, "mean_inference_ms": 0.37235554327020826, "mean_action_processing_ms": 0.09129508350326093, "mean_env_wait_ms": 0.99047692673216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004241615533828735, "StateBufferConnector_ms": 0.0025540590286254883, "ViewRequirementAgentConnector_ms": 0.06559938192367554}}, "episode_reward_max": -10143.351118966008, "episode_reward_min": -10490.528558995664, "episode_reward_mean": -10307.995697462986, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.418537984848715, "mean_inference_ms": 0.37235554327020826, "mean_action_processing_ms": 0.09129508350326093, "mean_env_wait_ms": 0.99047692673216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004241615533828735, "StateBufferConnector_ms": 0.0025540590286254883, "ViewRequirementAgentConnector_ms": 0.06559938192367554}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51466560, "num_agent_steps_trained": 51466560, "num_env_steps_sampled": 51466560, "num_env_steps_trained": 51466560, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 275.3156152503556, "num_env_steps_trained_throughput_per_sec": 275.3156152503556, "timesteps_total": 51466560, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51466560, "timers": {"training_iteration_time_ms": 4364.697, "sample_time_ms": 4330.983, "load_time_ms": 0.572, "load_throughput": 2098463.54, "learn_time_ms": 32.3, "learn_throughput": 37152.202, "synch_weights_time_ms": 0.794}, "counters": {"num_env_steps_sampled": 51466560, "num_env_steps_trained": 51466560, "num_agent_steps_sampled": 51466560, "num_agent_steps_trained": 51466560}, "done": false, "episodes_total": 12345, "training_iteration": 3871, "trial_id": "9f686_00000", "date": "2023-08-08_15-13-24", "timestamp": 1691496804, "time_this_iter_s": 13.078520774841309, "time_total_s": 93227.69317102432, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 143.5199842453003, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 19.810526315789474, "ram_util_percent": 65.57368421052631}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.7499999999999995e-08, "entropy_coeff": 0.15, "policy_entropy": -362.5707770453559, "policy_loss": -14187143.567708334, "vf_loss": 21999168.361111112}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 621.5, "diff_num_grad_updates_vs_sampler_policy": 620.5}}, "num_env_steps_sampled": 51470160, "num_env_steps_trained": 51470160, "num_agent_steps_sampled": 51470160, "num_agent_steps_trained": 51470160}, "sampler_results": {"episode_reward_max": -10143.351118966008, "episode_reward_min": -10490.528558995664, "episode_reward_mean": -10311.732353017404, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.417936184492882, "mean_inference_ms": 0.37228002805415245, "mean_action_processing_ms": 0.09128267243603057, "mean_env_wait_ms": 0.9748341825482305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041266850062779015, "StateBufferConnector_ms": 0.0025538035801478793, "ViewRequirementAgentConnector_ms": 0.06556579044886998}}, "episode_reward_max": -10143.351118966008, "episode_reward_min": -10490.528558995664, "episode_reward_mean": -10311.732353017404, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.417936184492882, "mean_inference_ms": 0.37228002805415245, "mean_action_processing_ms": 0.09128267243603057, "mean_env_wait_ms": 0.9748341825482305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041266850062779015, "StateBufferConnector_ms": 0.0025538035801478793, "ViewRequirementAgentConnector_ms": 0.06556579044886998}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51470160, "num_agent_steps_trained": 51470160, "num_env_steps_sampled": 51470160, "num_env_steps_trained": 51470160, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 271.6832224450819, "num_env_steps_trained_throughput_per_sec": 271.6832224450819, "timesteps_total": 51470160, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51470160, "timers": {"training_iteration_time_ms": 4394.911, "sample_time_ms": 4361.367, "load_time_ms": 0.572, "load_throughput": 2098813.561, "learn_time_ms": 32.144, "learn_throughput": 37331.759, "synch_weights_time_ms": 0.78}, "counters": {"num_env_steps_sampled": 51470160, "num_env_steps_trained": 51470160, "num_agent_steps_sampled": 51470160, "num_agent_steps_trained": 51470160}, "done": false, "episodes_total": 12348, "training_iteration": 3872, "trial_id": "9f686_00000", "date": "2023-08-08_15-13-38", "timestamp": 1691496818, "time_this_iter_s": 13.253357172012329, "time_total_s": 93240.94652819633, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 156.77334141731262, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 20.289473684210527, "ram_util_percent": 65.60526315789473}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.4999999999999996e-08, "entropy_coeff": 0.15, "policy_entropy": -365.73072136773004, "policy_loss": -6116587.923611111, "vf_loss": 21471400.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 675.5, "diff_num_grad_updates_vs_sampler_policy": 674.5}}, "num_env_steps_sampled": 51473760, "num_env_steps_trained": 51473760, "num_agent_steps_sampled": 51473760, "num_agent_steps_trained": 51473760}, "sampler_results": {"episode_reward_max": -10143.351118966008, "episode_reward_min": -10490.528558995664, "episode_reward_mean": -10308.911835171803, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.417423995481192, "mean_inference_ms": 0.37221546067167105, "mean_action_processing_ms": 0.09127170577276107, "mean_env_wait_ms": 0.9611683939635969, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004048096506219161, "StateBufferConnector_ms": 0.0025554707175806947, "ViewRequirementAgentConnector_ms": 0.06550111268696032}}, "episode_reward_max": -10143.351118966008, "episode_reward_min": -10490.528558995664, "episode_reward_mean": -10308.911835171803, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.417423995481192, "mean_inference_ms": 0.37221546067167105, "mean_action_processing_ms": 0.09127170577276107, "mean_env_wait_ms": 0.9611683939635969, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004048096506219161, "StateBufferConnector_ms": 0.0025554707175806947, "ViewRequirementAgentConnector_ms": 0.06550111268696032}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51473760, "num_agent_steps_trained": 51473760, "num_env_steps_sampled": 51473760, "num_env_steps_trained": 51473760, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 273.8851173806622, "num_env_steps_trained_throughput_per_sec": 273.8851173806622, "timesteps_total": 51473760, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51473760, "timers": {"training_iteration_time_ms": 4384.914, "sample_time_ms": 4351.561, "load_time_ms": 0.579, "load_throughput": 2073394.356, "learn_time_ms": 31.931, "learn_throughput": 37581.601, "synch_weights_time_ms": 0.795}, "counters": {"num_env_steps_sampled": 51473760, "num_env_steps_trained": 51473760, "num_agent_steps_sampled": 51473760, "num_agent_steps_trained": 51473760}, "done": false, "episodes_total": 12351, "training_iteration": 3873, "trial_id": "9f686_00000", "date": "2023-08-08_15-13-51", "timestamp": 1691496831, "time_this_iter_s": 13.146867275238037, "time_total_s": 93254.09339547157, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 169.92020869255066, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 19.811111111111114, "ram_util_percent": 65.66111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.4999999999999996e-08, "entropy_coeff": 0.15, "policy_entropy": -362.1664462619358, "policy_loss": -9244955.013888888, "vf_loss": 21784286.444444444}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 729.5, "diff_num_grad_updates_vs_sampler_policy": 728.5}}, "num_env_steps_sampled": 51477360, "num_env_steps_trained": 51477360, "num_agent_steps_sampled": 51477360, "num_agent_steps_trained": 51477360}, "sampler_results": {"episode_reward_max": -10143.351118966008, "episode_reward_min": -10490.528558995664, "episode_reward_mean": -10306.531843359307, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.417028471493946, "mean_inference_ms": 0.3721608488481767, "mean_action_processing_ms": 0.09126261817192405, "mean_env_wait_ms": 0.9490866764603431, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00398217177972561, "StateBufferConnector_ms": 0.002556312374952363, "ViewRequirementAgentConnector_ms": 0.06544473694591987}}, "episode_reward_max": -10143.351118966008, "episode_reward_min": -10490.528558995664, "episode_reward_mean": -10306.531843359307, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.417028471493946, "mean_inference_ms": 0.3721608488481767, "mean_action_processing_ms": 0.09126261817192405, "mean_env_wait_ms": 0.9490866764603431, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00398217177972561, "StateBufferConnector_ms": 0.002556312374952363, "ViewRequirementAgentConnector_ms": 0.06544473694591987}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51477360, "num_agent_steps_trained": 51477360, "num_env_steps_sampled": 51477360, "num_env_steps_trained": 51477360, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 273.5930473004042, "num_env_steps_trained_throughput_per_sec": 273.5930473004042, "timesteps_total": 51477360, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51477360, "timers": {"training_iteration_time_ms": 4394.954, "sample_time_ms": 4361.979, "load_time_ms": 0.575, "load_throughput": 2087237.621, "learn_time_ms": 31.58, "learn_throughput": 37998.194, "synch_weights_time_ms": 0.771}, "counters": {"num_env_steps_sampled": 51477360, "num_env_steps_trained": 51477360, "num_agent_steps_sampled": 51477360, "num_agent_steps_trained": 51477360}, "done": false, "episodes_total": 12354, "training_iteration": 3874, "trial_id": "9f686_00000", "date": "2023-08-08_15-14-04", "timestamp": 1691496844, "time_this_iter_s": 13.160835266113281, "time_total_s": 93267.25423073769, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 183.08104395866394, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 20.163157894736845, "ram_util_percent": 65.69473684210526}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.4999999999999996e-08, "entropy_coeff": 0.15, "policy_entropy": -366.360344780816, "policy_loss": -7414631.810763889, "vf_loss": 21544340.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 783.5, "diff_num_grad_updates_vs_sampler_policy": 782.5}}, "num_env_steps_sampled": 51480960, "num_env_steps_trained": 51480960, "num_agent_steps_sampled": 51480960, "num_agent_steps_trained": 51480960}, "sampler_results": {"episode_reward_max": -10143.351118966008, "episode_reward_min": -10490.528558995664, "episode_reward_mean": -10310.493699594794, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4166665337066586, "mean_inference_ms": 0.37211444866012067, "mean_action_processing_ms": 0.09125362750305652, "mean_env_wait_ms": 0.9384263750691978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003924694928255948, "StateBufferConnector_ms": 0.002547285773537376, "ViewRequirementAgentConnector_ms": 0.0654757022857666}}, "episode_reward_max": -10143.351118966008, "episode_reward_min": -10490.528558995664, "episode_reward_mean": -10310.493699594794, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4166665337066586, "mean_inference_ms": 0.37211444866012067, "mean_action_processing_ms": 0.09125362750305652, "mean_env_wait_ms": 0.9384263750691978, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003924694928255948, "StateBufferConnector_ms": 0.002547285773537376, "ViewRequirementAgentConnector_ms": 0.0654757022857666}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51480960, "num_agent_steps_trained": 51480960, "num_env_steps_sampled": 51480960, "num_env_steps_trained": 51480960, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 272.7537614364424, "num_env_steps_trained_throughput_per_sec": 272.7537614364424, "timesteps_total": 51480960, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51480960, "timers": {"training_iteration_time_ms": 4395.894, "sample_time_ms": 4363.116, "load_time_ms": 0.577, "load_throughput": 2078617.659, "learn_time_ms": 31.375, "learn_throughput": 38247.27, "synch_weights_time_ms": 0.776}, "counters": {"num_env_steps_sampled": 51480960, "num_env_steps_trained": 51480960, "num_agent_steps_sampled": 51480960, "num_agent_steps_trained": 51480960}, "done": false, "episodes_total": 12357, "training_iteration": 3875, "trial_id": "9f686_00000", "date": "2023-08-08_15-14-17", "timestamp": 1691496857, "time_this_iter_s": 13.201387166976929, "time_total_s": 93280.45561790466, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 196.28243112564087, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 19.25263157894737, "ram_util_percent": 65.56842105263156}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.4999999999999996e-08, "entropy_coeff": 0.15, "policy_entropy": -362.9139234754774, "policy_loss": -7404398.446180556, "vf_loss": 21616325.833333332}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 837.5, "diff_num_grad_updates_vs_sampler_policy": 836.5}}, "num_env_steps_sampled": 51484560, "num_env_steps_trained": 51484560, "num_agent_steps_sampled": 51484560, "num_agent_steps_trained": 51484560}, "sampler_results": {"episode_reward_max": -10143.351118966008, "episode_reward_min": -10490.528558995664, "episode_reward_mean": -10310.051298070814, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4164611622506773, "mean_inference_ms": 0.37207712964872247, "mean_action_processing_ms": 0.09124642450819712, "mean_env_wait_ms": 0.9288625878217989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003877599188622008, "StateBufferConnector_ms": 0.002557166079257397, "ViewRequirementAgentConnector_ms": 0.0657644677669444}}, "episode_reward_max": -10143.351118966008, "episode_reward_min": -10490.528558995664, "episode_reward_mean": -10310.051298070814, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4164611622506773, "mean_inference_ms": 0.37207712964872247, "mean_action_processing_ms": 0.09124642450819712, "mean_env_wait_ms": 0.9288625878217989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003877599188622008, "StateBufferConnector_ms": 0.002557166079257397, "ViewRequirementAgentConnector_ms": 0.0657644677669444}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51484560, "num_agent_steps_trained": 51484560, "num_env_steps_sampled": 51484560, "num_env_steps_trained": 51484560, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 271.76797883220127, "num_env_steps_trained_throughput_per_sec": 271.76797883220127, "timesteps_total": 51484560, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51484560, "timers": {"training_iteration_time_ms": 4399.582, "sample_time_ms": 4366.665, "load_time_ms": 0.578, "load_throughput": 2075531.876, "learn_time_ms": 31.515, "learn_throughput": 38076.844, "synch_weights_time_ms": 0.773}, "counters": {"num_env_steps_sampled": 51484560, "num_env_steps_trained": 51484560, "num_agent_steps_sampled": 51484560, "num_agent_steps_trained": 51484560}, "done": false, "episodes_total": 12360, "training_iteration": 3876, "trial_id": "9f686_00000", "date": "2023-08-08_15-14-31", "timestamp": 1691496871, "time_this_iter_s": 13.249438047409058, "time_total_s": 93293.70505595207, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 209.53186917304993, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 20.15789473684211, "ram_util_percent": 65.48421052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.4999999999999996e-08, "entropy_coeff": 0.15, "policy_entropy": -361.89881388346356, "policy_loss": -6679831.912760417, "vf_loss": 21177407.666666668}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 891.5, "diff_num_grad_updates_vs_sampler_policy": 890.5}}, "num_env_steps_sampled": 51488160, "num_env_steps_trained": 51488160, "num_agent_steps_sampled": 51488160, "num_agent_steps_trained": 51488160}, "sampler_results": {"episode_reward_max": -10143.351118966008, "episode_reward_min": -10490.528558995664, "episode_reward_mean": -10308.737798206448, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.41643307951515, "mean_inference_ms": 0.37204487639727063, "mean_action_processing_ms": 0.09123970614834008, "mean_env_wait_ms": 0.9202483717783743, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038247108459472656, "StateBufferConnector_ms": 0.0025615692138671875, "ViewRequirementAgentConnector_ms": 0.06580305099487305}}, "episode_reward_max": -10143.351118966008, "episode_reward_min": -10490.528558995664, "episode_reward_mean": -10308.737798206448, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.41643307951515, "mean_inference_ms": 0.37204487639727063, "mean_action_processing_ms": 0.09123970614834008, "mean_env_wait_ms": 0.9202483717783743, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038247108459472656, "StateBufferConnector_ms": 0.0025615692138671875, "ViewRequirementAgentConnector_ms": 0.06580305099487305}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51488160, "num_agent_steps_trained": 51488160, "num_env_steps_sampled": 51488160, "num_env_steps_trained": 51488160, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 270.1631602161084, "num_env_steps_trained_throughput_per_sec": 270.1631602161084, "timesteps_total": 51488160, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51488160, "timers": {"training_iteration_time_ms": 4414.143, "sample_time_ms": 4381.022, "load_time_ms": 0.579, "load_throughput": 2071176.001, "learn_time_ms": 31.71, "learn_throughput": 37842.946, "synch_weights_time_ms": 0.782}, "counters": {"num_env_steps_sampled": 51488160, "num_env_steps_trained": 51488160, "num_agent_steps_sampled": 51488160, "num_agent_steps_trained": 51488160}, "done": false, "episodes_total": 12363, "training_iteration": 3877, "trial_id": "9f686_00000", "date": "2023-08-08_15-14-44", "timestamp": 1691496884, "time_this_iter_s": 13.327948808670044, "time_total_s": 93307.03300476074, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 222.85981798171997, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 18.15263157894737, "ram_util_percent": 65.49473684210527}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.4999999999999996e-08, "entropy_coeff": 0.15, "policy_entropy": -361.6548716227214, "policy_loss": -9042911.331597222, "vf_loss": 21456185.361111112}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 945.5, "diff_num_grad_updates_vs_sampler_policy": 944.5}}, "num_env_steps_sampled": 51491760, "num_env_steps_trained": 51491760, "num_agent_steps_sampled": 51491760, "num_agent_steps_trained": 51491760}, "sampler_results": {"episode_reward_max": -10143.351118966008, "episode_reward_min": -10490.528558995664, "episode_reward_mean": -10311.890044565775, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.416410817164204, "mean_inference_ms": 0.37202080049019703, "mean_action_processing_ms": 0.09123445215545818, "mean_env_wait_ms": 0.9125281548597504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003781858480201577, "StateBufferConnector_ms": 0.002555127413767689, "ViewRequirementAgentConnector_ms": 0.06579992906102594}}, "episode_reward_max": -10143.351118966008, "episode_reward_min": -10490.528558995664, "episode_reward_mean": -10311.890044565775, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.416410817164204, "mean_inference_ms": 0.37202080049019703, "mean_action_processing_ms": 0.09123445215545818, "mean_env_wait_ms": 0.9125281548597504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003781858480201577, "StateBufferConnector_ms": 0.002555127413767689, "ViewRequirementAgentConnector_ms": 0.06579992906102594}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51491760, "num_agent_steps_trained": 51491760, "num_env_steps_sampled": 51491760, "num_env_steps_trained": 51491760, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 270.9869438066965, "num_env_steps_trained_throughput_per_sec": 270.9869438066965, "timesteps_total": 51491760, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51491760, "timers": {"training_iteration_time_ms": 4414.804, "sample_time_ms": 4381.574, "load_time_ms": 0.585, "load_throughput": 2049584.558, "learn_time_ms": 31.803, "learn_throughput": 37731.851, "synch_weights_time_ms": 0.79}, "counters": {"num_env_steps_sampled": 51491760, "num_env_steps_trained": 51491760, "num_agent_steps_sampled": 51491760, "num_agent_steps_trained": 51491760}, "done": false, "episodes_total": 12366, "training_iteration": 3878, "trial_id": "9f686_00000", "date": "2023-08-08_15-14-57", "timestamp": 1691496897, "time_this_iter_s": 13.287718772888184, "time_total_s": 93320.32072353363, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 236.14753675460815, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 19.378947368421052, "ram_util_percent": 65.48947368421054}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.4999999999999996e-08, "entropy_coeff": 0.15, "policy_entropy": -364.28229268391925, "policy_loss": -15234124.493923612, "vf_loss": 22163823.416666668}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 999.5, "diff_num_grad_updates_vs_sampler_policy": 998.5}}, "num_env_steps_sampled": 51495360, "num_env_steps_trained": 51495360, "num_agent_steps_sampled": 51495360, "num_agent_steps_trained": 51495360}, "sampler_results": {"episode_reward_max": -10143.351118966008, "episode_reward_min": -10490.528558995664, "episode_reward_mean": -10314.36539152797, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.416441270630441, "mean_inference_ms": 0.3719982262795743, "mean_action_processing_ms": 0.09122953018496986, "mean_env_wait_ms": 0.9055342487106374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037410429545811246, "StateBufferConnector_ms": 0.0025612967354910715, "ViewRequirementAgentConnector_ms": 0.06588654858725411}}, "episode_reward_max": -10143.351118966008, "episode_reward_min": -10490.528558995664, "episode_reward_mean": -10314.36539152797, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.416441270630441, "mean_inference_ms": 0.3719982262795743, "mean_action_processing_ms": 0.09122953018496986, "mean_env_wait_ms": 0.9055342487106374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037410429545811246, "StateBufferConnector_ms": 0.0025612967354910715, "ViewRequirementAgentConnector_ms": 0.06588654858725411}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51495360, "num_agent_steps_trained": 51495360, "num_env_steps_sampled": 51495360, "num_env_steps_trained": 51495360, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 270.73977153029716, "num_env_steps_trained_throughput_per_sec": 270.73977153029716, "timesteps_total": 51495360, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51495360, "timers": {"training_iteration_time_ms": 4434.857, "sample_time_ms": 4401.635, "load_time_ms": 0.588, "load_throughput": 2039121.987, "learn_time_ms": 31.794, "learn_throughput": 37742.942, "synch_weights_time_ms": 0.789}, "counters": {"num_env_steps_sampled": 51495360, "num_env_steps_trained": 51495360, "num_agent_steps_sampled": 51495360, "num_agent_steps_trained": 51495360}, "done": false, "episodes_total": 12369, "training_iteration": 3879, "trial_id": "9f686_00000", "date": "2023-08-08_15-15-11", "timestamp": 1691496911, "time_this_iter_s": 13.299682855606079, "time_total_s": 93333.62040638924, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 249.44721961021423, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 18.005263157894735, "ram_util_percent": 65.49473684210527}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.4999999999999996e-08, "entropy_coeff": 0.15, "policy_entropy": -363.5311855740017, "policy_loss": -9724672.2734375, "vf_loss": 21973906.722222224}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1053.5, "diff_num_grad_updates_vs_sampler_policy": 1052.5}}, "num_env_steps_sampled": 51498960, "num_env_steps_trained": 51498960, "num_agent_steps_sampled": 51498960, "num_agent_steps_trained": 51498960}, "sampler_results": {"episode_reward_max": -10143.351118966008, "episode_reward_min": -10490.528558995664, "episode_reward_mean": -10317.319665878576, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4164853874063694, "mean_inference_ms": 0.37198131948608276, "mean_action_processing_ms": 0.09122541545292691, "mean_env_wait_ms": 0.8991833980455762, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003714884741831634, "StateBufferConnector_ms": 0.0025490582999536547, "ViewRequirementAgentConnector_ms": 0.0658524238457114}}, "episode_reward_max": -10143.351118966008, "episode_reward_min": -10490.528558995664, "episode_reward_mean": -10317.319665878576, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4164853874063694, "mean_inference_ms": 0.37198131948608276, "mean_action_processing_ms": 0.09122541545292691, "mean_env_wait_ms": 0.8991833980455762, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003714884741831634, "StateBufferConnector_ms": 0.0025490582999536547, "ViewRequirementAgentConnector_ms": 0.0658524238457114}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51498960, "num_agent_steps_trained": 51498960, "num_env_steps_sampled": 51498960, "num_env_steps_trained": 51498960, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 270.8488954089324, "num_env_steps_trained_throughput_per_sec": 270.8488954089324, "timesteps_total": 51498960, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51498960, "timers": {"training_iteration_time_ms": 4430.322, "sample_time_ms": 4397.386, "load_time_ms": 0.586, "load_throughput": 2047750.031, "learn_time_ms": 31.514, "learn_throughput": 38078.544, "synch_weights_time_ms": 0.788}, "counters": {"num_env_steps_sampled": 51498960, "num_env_steps_trained": 51498960, "num_agent_steps_sampled": 51498960, "num_agent_steps_trained": 51498960}, "done": false, "episodes_total": 12372, "training_iteration": 3880, "trial_id": "9f686_00000", "date": "2023-08-08_15-15-24", "timestamp": 1691496924, "time_this_iter_s": 13.294232845306396, "time_total_s": 93346.91463923454, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 262.74145245552063, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 18.963157894736845, "ram_util_percent": 65.54210526315791}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.4999999999999996e-08, "entropy_coeff": 0.15, "policy_entropy": -362.3438245985243, "policy_loss": -10638906.430555556, "vf_loss": 22270332.888888888}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1107.5, "diff_num_grad_updates_vs_sampler_policy": 1106.5}}, "num_env_steps_sampled": 51502560, "num_env_steps_trained": 51502560, "num_agent_steps_sampled": 51502560, "num_agent_steps_trained": 51502560}, "sampler_results": {"episode_reward_max": -10143.351118966008, "episode_reward_min": -10490.528558995664, "episode_reward_mean": -10320.090583462837, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4165335811835758, "mean_inference_ms": 0.37196859772799584, "mean_action_processing_ms": 0.09122169831870472, "mean_env_wait_ms": 0.8933782319866601, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003681644316642515, "StateBufferConnector_ms": 0.0025495406120054184, "ViewRequirementAgentConnector_ms": 0.06579660600231539}}, "episode_reward_max": -10143.351118966008, "episode_reward_min": -10490.528558995664, "episode_reward_mean": -10320.090583462837, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4165335811835758, "mean_inference_ms": 0.37196859772799584, "mean_action_processing_ms": 0.09122169831870472, "mean_env_wait_ms": 0.8933782319866601, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003681644316642515, "StateBufferConnector_ms": 0.0025495406120054184, "ViewRequirementAgentConnector_ms": 0.06579660600231539}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51502560, "num_agent_steps_trained": 51502560, "num_env_steps_sampled": 51502560, "num_env_steps_trained": 51502560, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 271.3889152248798, "num_env_steps_trained_throughput_per_sec": 271.3889152248798, "timesteps_total": 51502560, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51502560, "timers": {"training_iteration_time_ms": 4423.71, "sample_time_ms": 4390.96, "load_time_ms": 0.584, "load_throughput": 2054436.834, "learn_time_ms": 31.348, "learn_throughput": 38280.345, "synch_weights_time_ms": 0.769}, "counters": {"num_env_steps_sampled": 51502560, "num_env_steps_trained": 51502560, "num_agent_steps_sampled": 51502560, "num_agent_steps_trained": 51502560}, "done": false, "episodes_total": 12375, "training_iteration": 3881, "trial_id": "9f686_00000", "date": "2023-08-08_15-15-37", "timestamp": 1691496937, "time_this_iter_s": 13.267915964126587, "time_total_s": 93360.18255519867, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 276.0093684196472, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 17.50526315789474, "ram_util_percent": 65.67894736842106}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.4999999999999996e-08, "entropy_coeff": 0.15, "policy_entropy": -361.68473646375867, "policy_loss": -9725592.704861112, "vf_loss": 21900081.361111112}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1161.5, "diff_num_grad_updates_vs_sampler_policy": 1160.5}}, "num_env_steps_sampled": 51506160, "num_env_steps_trained": 51506160, "num_agent_steps_sampled": 51506160, "num_agent_steps_trained": 51506160}, "sampler_results": {"episode_reward_max": -10143.351118966008, "episode_reward_min": -10490.528558995664, "episode_reward_mean": -10322.422317228156, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4166254438129173, "mean_inference_ms": 0.3719583493054608, "mean_action_processing_ms": 0.09121844651792403, "mean_env_wait_ms": 0.8880334444179613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036492714515099158, "StateBufferConnector_ms": 0.002548511211688702, "ViewRequirementAgentConnector_ms": 0.0657349366408128}}, "episode_reward_max": -10143.351118966008, "episode_reward_min": -10490.528558995664, "episode_reward_mean": -10322.422317228156, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4166254438129173, "mean_inference_ms": 0.3719583493054608, "mean_action_processing_ms": 0.09121844651792403, "mean_env_wait_ms": 0.8880334444179613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036492714515099158, "StateBufferConnector_ms": 0.002548511211688702, "ViewRequirementAgentConnector_ms": 0.0657349366408128}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51506160, "num_agent_steps_trained": 51506160, "num_env_steps_sampled": 51506160, "num_env_steps_trained": 51506160, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 270.48084901013414, "num_env_steps_trained_throughput_per_sec": 270.48084901013414, "timesteps_total": 51506160, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51506160, "timers": {"training_iteration_time_ms": 4433.989, "sample_time_ms": 4400.943, "load_time_ms": 0.579, "load_throughput": 2073308.947, "learn_time_ms": 31.645, "learn_throughput": 37920.497, "synch_weights_time_ms": 0.774}, "counters": {"num_env_steps_sampled": 51506160, "num_env_steps_trained": 51506160, "num_agent_steps_sampled": 51506160, "num_agent_steps_trained": 51506160}, "done": false, "episodes_total": 12378, "training_iteration": 3882, "trial_id": "9f686_00000", "date": "2023-08-08_15-15-50", "timestamp": 1691496950, "time_this_iter_s": 13.31240177154541, "time_total_s": 93373.49495697021, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 289.3217701911926, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 18.966666666666665, "ram_util_percent": 65.57222222222224}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.2e-08, "entropy_coeff": 0.15, "policy_entropy": -363.01573859320746, "policy_loss": -8629258.392361112, "vf_loss": 21857299.277777776}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1215.5, "diff_num_grad_updates_vs_sampler_policy": 1214.5}}, "num_env_steps_sampled": 51509760, "num_env_steps_trained": 51509760, "num_agent_steps_sampled": 51509760, "num_agent_steps_trained": 51509760}, "sampler_results": {"episode_reward_max": -10143.351118966008, "episode_reward_min": -10490.528558995664, "episode_reward_mean": -10322.844020233795, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.416769905432686, "mean_inference_ms": 0.37195205329138026, "mean_action_processing_ms": 0.09121584286344275, "mean_env_wait_ms": 0.8830887854736011, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036218587089987364, "StateBufferConnector_ms": 0.0025503775652717144, "ViewRequirementAgentConnector_ms": 0.06578599705415614}}, "episode_reward_max": -10143.351118966008, "episode_reward_min": -10490.528558995664, "episode_reward_mean": -10322.844020233795, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.416769905432686, "mean_inference_ms": 0.37195205329138026, "mean_action_processing_ms": 0.09121584286344275, "mean_env_wait_ms": 0.8830887854736011, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036218587089987364, "StateBufferConnector_ms": 0.0025503775652717144, "ViewRequirementAgentConnector_ms": 0.06578599705415614}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51509760, "num_agent_steps_trained": 51509760, "num_env_steps_sampled": 51509760, "num_env_steps_trained": 51509760, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 269.9294736476103, "num_env_steps_trained_throughput_per_sec": 269.9294736476103, "timesteps_total": 51509760, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51509760, "timers": {"training_iteration_time_ms": 4439.803, "sample_time_ms": 4406.411, "load_time_ms": 0.574, "load_throughput": 2090358.335, "learn_time_ms": 31.981, "learn_throughput": 37522.625, "synch_weights_time_ms": 0.788}, "counters": {"num_env_steps_sampled": 51509760, "num_env_steps_trained": 51509760, "num_agent_steps_sampled": 51509760, "num_agent_steps_trained": 51509760}, "done": false, "episodes_total": 12381, "training_iteration": 3883, "trial_id": "9f686_00000", "date": "2023-08-08_15-16-04", "timestamp": 1691496964, "time_this_iter_s": 13.33969783782959, "time_total_s": 93386.83465480804, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 302.6614680290222, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 17.52105263157895, "ram_util_percent": 65.65263157894738}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.7499999999999998e-08, "entropy_coeff": 0.15, "policy_entropy": -362.47718132866754, "policy_loss": -4669137.953559028, "vf_loss": 21036737.611111112}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1269.5, "diff_num_grad_updates_vs_sampler_policy": 1268.5}}, "num_env_steps_sampled": 51513360, "num_env_steps_trained": 51513360, "num_agent_steps_sampled": 51513360, "num_agent_steps_trained": 51513360}, "sampler_results": {"episode_reward_max": -10143.351118966008, "episode_reward_min": -10490.528558995664, "episode_reward_mean": -10320.566269896663, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4169964582280863, "mean_inference_ms": 0.3719458003993529, "mean_action_processing_ms": 0.09121324270528149, "mean_env_wait_ms": 0.8784665157628277, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035984415403554136, "StateBufferConnector_ms": 0.0025517503980179907, "ViewRequirementAgentConnector_ms": 0.06577666376678037}}, "episode_reward_max": -10143.351118966008, "episode_reward_min": -10490.528558995664, "episode_reward_mean": -10320.566269896663, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4169964582280863, "mean_inference_ms": 0.3719458003993529, "mean_action_processing_ms": 0.09121324270528149, "mean_env_wait_ms": 0.8784665157628277, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035984415403554136, "StateBufferConnector_ms": 0.0025517503980179907, "ViewRequirementAgentConnector_ms": 0.06577666376678037}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51513360, "num_agent_steps_trained": 51513360, "num_env_steps_sampled": 51513360, "num_env_steps_trained": 51513360, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 269.7533003813582, "num_env_steps_trained_throughput_per_sec": 269.7533003813582, "timesteps_total": 51513360, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51513360, "timers": {"training_iteration_time_ms": 4444.19, "sample_time_ms": 4410.815, "load_time_ms": 0.576, "load_throughput": 2084989.561, "learn_time_ms": 31.955, "learn_throughput": 37552.832, "synch_weights_time_ms": 0.795}, "counters": {"num_env_steps_sampled": 51513360, "num_env_steps_trained": 51513360, "num_agent_steps_sampled": 51513360, "num_agent_steps_trained": 51513360}, "done": false, "episodes_total": 12384, "training_iteration": 3884, "trial_id": "9f686_00000", "date": "2023-08-08_15-16-17", "timestamp": 1691496977, "time_this_iter_s": 13.348376989364624, "time_total_s": 93400.18303179741, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 316.00984501838684, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 18.589473684210525, "ram_util_percent": 65.43157894736842}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.2999999999999999e-08, "entropy_coeff": 0.15, "policy_entropy": -362.0946994357639, "policy_loss": -14160811.494791666, "vf_loss": 21667840.638888888}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1323.5, "diff_num_grad_updates_vs_sampler_policy": 1322.5}}, "num_env_steps_sampled": 51516960, "num_env_steps_trained": 51516960, "num_agent_steps_sampled": 51516960, "num_agent_steps_trained": 51516960}, "sampler_results": {"episode_reward_max": -10143.351118966008, "episode_reward_min": -10506.216872191348, "episode_reward_mean": -10323.599770812549, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4172368736997423, "mean_inference_ms": 0.3719415403044448, "mean_action_processing_ms": 0.09121115977939588, "mean_env_wait_ms": 0.8742034295346968, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035846555555188978, "StateBufferConnector_ms": 0.002559455665382179, "ViewRequirementAgentConnector_ms": 0.06600167300250079}}, "episode_reward_max": -10143.351118966008, "episode_reward_min": -10506.216872191348, "episode_reward_mean": -10323.599770812549, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4172368736997423, "mean_inference_ms": 0.3719415403044448, "mean_action_processing_ms": 0.09121115977939588, "mean_env_wait_ms": 0.8742034295346968, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035846555555188978, "StateBufferConnector_ms": 0.002559455665382179, "ViewRequirementAgentConnector_ms": 0.06600167300250079}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51516960, "num_agent_steps_trained": 51516960, "num_env_steps_sampled": 51516960, "num_env_steps_trained": 51516960, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 268.8436442922806, "num_env_steps_trained_throughput_per_sec": 268.8436442922806, "timesteps_total": 51516960, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51516960, "timers": {"training_iteration_time_ms": 4450.334, "sample_time_ms": 4416.792, "load_time_ms": 0.576, "load_throughput": 2084989.561, "learn_time_ms": 32.101, "learn_throughput": 37382.25, "synch_weights_time_ms": 0.815}, "counters": {"num_env_steps_sampled": 51516960, "num_env_steps_trained": 51516960, "num_agent_steps_sampled": 51516960, "num_agent_steps_trained": 51516960}, "done": false, "episodes_total": 12387, "training_iteration": 3885, "trial_id": "9f686_00000", "date": "2023-08-08_15-16-31", "timestamp": 1691496991, "time_this_iter_s": 13.393419981002808, "time_total_s": 93413.57645177841, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 329.40326499938965, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 18.636842105263156, "ram_util_percent": 65.13157894736844}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-08, "entropy_coeff": 0.15, "policy_entropy": -363.0980750189887, "policy_loss": -8967086.613715278, "vf_loss": 21391451.194444444}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1377.5, "diff_num_grad_updates_vs_sampler_policy": 1376.5}}, "num_env_steps_sampled": 51520560, "num_env_steps_trained": 51520560, "num_agent_steps_sampled": 51520560, "num_agent_steps_trained": 51520560}, "sampler_results": {"episode_reward_max": -10143.351118966008, "episode_reward_min": -10506.216872191348, "episode_reward_mean": -10322.459214953866, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4175186733814966, "mean_inference_ms": 0.3719371636179933, "mean_action_processing_ms": 0.0912092865035419, "mean_env_wait_ms": 0.8702160888078605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035703956306754768, "StateBufferConnector_ms": 0.0025640834461558948, "ViewRequirementAgentConnector_ms": 0.06596608595414595}}, "episode_reward_max": -10143.351118966008, "episode_reward_min": -10506.216872191348, "episode_reward_mean": -10322.459214953866, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4175186733814966, "mean_inference_ms": 0.3719371636179933, "mean_action_processing_ms": 0.0912092865035419, "mean_env_wait_ms": 0.8702160888078605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035703956306754768, "StateBufferConnector_ms": 0.0025640834461558948, "ViewRequirementAgentConnector_ms": 0.06596608595414595}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51520560, "num_agent_steps_trained": 51520560, "num_env_steps_sampled": 51520560, "num_env_steps_trained": 51520560, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 269.484639949862, "num_env_steps_trained_throughput_per_sec": 269.484639949862, "timesteps_total": 51520560, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51520560, "timers": {"training_iteration_time_ms": 4455.781, "sample_time_ms": 4422.496, "load_time_ms": 0.588, "load_throughput": 2041934.683, "learn_time_ms": 31.85, "learn_throughput": 37676.971, "synch_weights_time_ms": 0.798}, "counters": {"num_env_steps_sampled": 51520560, "num_env_steps_trained": 51520560, "num_agent_steps_sampled": 51520560, "num_agent_steps_trained": 51520560}, "done": false, "episodes_total": 12390, "training_iteration": 3886, "trial_id": "9f686_00000", "date": "2023-08-08_15-16-44", "timestamp": 1691497004, "time_this_iter_s": 13.36161184310913, "time_total_s": 93426.93806362152, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 342.7648768424988, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 18.257894736842108, "ram_util_percent": 65.16842105263157}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-08, "entropy_coeff": 0.15, "policy_entropy": -367.54452345106336, "policy_loss": -7969946.003472222, "vf_loss": 21431265.972222224}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1431.5, "diff_num_grad_updates_vs_sampler_policy": 1430.5}}, "num_env_steps_sampled": 51524160, "num_env_steps_trained": 51524160, "num_agent_steps_sampled": 51524160, "num_agent_steps_trained": 51524160}, "sampler_results": {"episode_reward_max": -10143.351118966008, "episode_reward_min": -10506.216872191348, "episode_reward_mean": -10322.022141849506, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4177963948826964, "mean_inference_ms": 0.37193492751750734, "mean_action_processing_ms": 0.09120766646798886, "mean_env_wait_ms": 0.866475908938952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003553628921508789, "StateBufferConnector_ms": 0.0025597214698791504, "ViewRequirementAgentConnector_ms": 0.06590336561203003}}, "episode_reward_max": -10143.351118966008, "episode_reward_min": -10506.216872191348, "episode_reward_mean": -10322.022141849506, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4177963948826964, "mean_inference_ms": 0.37193492751750734, "mean_action_processing_ms": 0.09120766646798886, "mean_env_wait_ms": 0.866475908938952, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003553628921508789, "StateBufferConnector_ms": 0.0025597214698791504, "ViewRequirementAgentConnector_ms": 0.06590336561203003}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51524160, "num_agent_steps_trained": 51524160, "num_env_steps_sampled": 51524160, "num_env_steps_trained": 51524160, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 271.3676010201966, "num_env_steps_trained_throughput_per_sec": 271.3676010201966, "timesteps_total": 51524160, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51524160, "timers": {"training_iteration_time_ms": 4443.525, "sample_time_ms": 4410.279, "load_time_ms": 0.589, "load_throughput": 2035987.541, "learn_time_ms": 31.81, "learn_throughput": 37724.441, "synch_weights_time_ms": 0.798}, "counters": {"num_env_steps_sampled": 51524160, "num_env_steps_trained": 51524160, "num_agent_steps_sampled": 51524160, "num_agent_steps_trained": 51524160}, "done": false, "episodes_total": 12393, "training_iteration": 3887, "trial_id": "9f686_00000", "date": "2023-08-08_15-16-57", "timestamp": 1691497017, "time_this_iter_s": 13.268970012664795, "time_total_s": 93440.20703363419, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 356.0338468551636, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 18.747368421052634, "ram_util_percent": 65.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-08, "entropy_coeff": 0.15, "policy_entropy": -361.90208604600696, "policy_loss": -10482951.6640625, "vf_loss": 21930785.277777776}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1485.5, "diff_num_grad_updates_vs_sampler_policy": 1484.5}}, "num_env_steps_sampled": 51527760, "num_env_steps_trained": 51527760, "num_agent_steps_sampled": 51527760, "num_agent_steps_trained": 51527760}, "sampler_results": {"episode_reward_max": -10143.351118966008, "episode_reward_min": -10506.216872191348, "episode_reward_mean": -10322.958204255247, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.418067143753135, "mean_inference_ms": 0.37193418212784496, "mean_action_processing_ms": 0.09120641144242941, "mean_env_wait_ms": 0.8629899017882937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003535776253206184, "StateBufferConnector_ms": 0.0025648668587925924, "ViewRequirementAgentConnector_ms": 0.0659043530383742}}, "episode_reward_max": -10143.351118966008, "episode_reward_min": -10506.216872191348, "episode_reward_mean": -10322.958204255247, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.418067143753135, "mean_inference_ms": 0.37193418212784496, "mean_action_processing_ms": 0.09120641144242941, "mean_env_wait_ms": 0.8629899017882937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003535776253206184, "StateBufferConnector_ms": 0.0025648668587925924, "ViewRequirementAgentConnector_ms": 0.0659043530383742}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51527760, "num_agent_steps_trained": 51527760, "num_env_steps_sampled": 51527760, "num_env_steps_trained": 51527760, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 269.8322805769257, "num_env_steps_trained_throughput_per_sec": 269.8322805769257, "timesteps_total": 51527760, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51527760, "timers": {"training_iteration_time_ms": 4442.663, "sample_time_ms": 4409.723, "load_time_ms": 0.591, "load_throughput": 2030156.825, "learn_time_ms": 31.535, "learn_throughput": 38053.209, "synch_weights_time_ms": 0.765}, "counters": {"num_env_steps_sampled": 51527760, "num_env_steps_trained": 51527760, "num_agent_steps_sampled": 51527760, "num_agent_steps_trained": 51527760}, "done": false, "episodes_total": 12396, "training_iteration": 3888, "trial_id": "9f686_00000", "date": "2023-08-08_15-17-11", "timestamp": 1691497031, "time_this_iter_s": 13.344446182250977, "time_total_s": 93453.55147981644, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 369.37829303741455, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 17.894736842105264, "ram_util_percent": 65.26315789473684}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-08, "entropy_coeff": 0.15, "policy_entropy": -362.3590562608507, "policy_loss": -6389433.258680556, "vf_loss": 21383157.638888888}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1539.5, "diff_num_grad_updates_vs_sampler_policy": 1538.5}}, "num_env_steps_sampled": 51531360, "num_env_steps_trained": 51531360, "num_agent_steps_sampled": 51531360, "num_agent_steps_trained": 51531360}, "sampler_results": {"episode_reward_max": -10143.351118966008, "episode_reward_min": -10506.216872191348, "episode_reward_mean": -10320.960492498894, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4183155686652014, "mean_inference_ms": 0.37193335303191294, "mean_action_processing_ms": 0.09120525305450329, "mean_env_wait_ms": 0.8596971548193403, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035272088161734647, "StateBufferConnector_ms": 0.002562999725341797, "ViewRequirementAgentConnector_ms": 0.06590998449990916}}, "episode_reward_max": -10143.351118966008, "episode_reward_min": -10506.216872191348, "episode_reward_mean": -10320.960492498894, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4183155686652014, "mean_inference_ms": 0.37193335303191294, "mean_action_processing_ms": 0.09120525305450329, "mean_env_wait_ms": 0.8596971548193403, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035272088161734647, "StateBufferConnector_ms": 0.002562999725341797, "ViewRequirementAgentConnector_ms": 0.06590998449990916}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51531360, "num_agent_steps_trained": 51531360, "num_env_steps_sampled": 51531360, "num_env_steps_trained": 51531360, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 272.9595728816973, "num_env_steps_trained_throughput_per_sec": 272.9595728816973, "timesteps_total": 51531360, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51531360, "timers": {"training_iteration_time_ms": 4421.394, "sample_time_ms": 4388.57, "load_time_ms": 0.588, "load_throughput": 2039452.49, "learn_time_ms": 31.416, "learn_throughput": 38197.548, "synch_weights_time_ms": 0.771}, "counters": {"num_env_steps_sampled": 51531360, "num_env_steps_trained": 51531360, "num_agent_steps_sampled": 51531360, "num_agent_steps_trained": 51531360}, "done": false, "episodes_total": 12399, "training_iteration": 3889, "trial_id": "9f686_00000", "date": "2023-08-08_15-17-24", "timestamp": 1691497044, "time_this_iter_s": 13.191602945327759, "time_total_s": 93466.74308276176, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 382.5698959827423, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 18.75789473684211, "ram_util_percent": 65.28421052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-08, "entropy_coeff": 0.15, "policy_entropy": -368.162843492296, "policy_loss": -1078179.9895833333, "vf_loss": 20917339.722222224}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1593.5, "diff_num_grad_updates_vs_sampler_policy": 1592.5}}, "num_env_steps_sampled": 51534960, "num_env_steps_trained": 51534960, "num_agent_steps_sampled": 51534960, "num_agent_steps_trained": 51534960}, "sampler_results": {"episode_reward_max": -10138.422643509588, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10321.730849005226, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4185621536575863, "mean_inference_ms": 0.3719323430824282, "mean_action_processing_ms": 0.09120423624793456, "mean_env_wait_ms": 0.8566050319329518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035208262754290293, "StateBufferConnector_ms": 0.0025714381357257285, "ViewRequirementAgentConnector_ms": 0.06586835625466336}}, "episode_reward_max": -10138.422643509588, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10321.730849005226, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4185621536575863, "mean_inference_ms": 0.3719323430824282, "mean_action_processing_ms": 0.09120423624793456, "mean_env_wait_ms": 0.8566050319329518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035208262754290293, "StateBufferConnector_ms": 0.0025714381357257285, "ViewRequirementAgentConnector_ms": 0.06586835625466336}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51534960, "num_agent_steps_trained": 51534960, "num_env_steps_sampled": 51534960, "num_env_steps_trained": 51534960, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 270.2821775978764, "num_env_steps_trained_throughput_per_sec": 270.2821775978764, "timesteps_total": 51534960, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51534960, "timers": {"training_iteration_time_ms": 4427.623, "sample_time_ms": 4394.861, "load_time_ms": 0.578, "load_throughput": 2075874.289, "learn_time_ms": 31.368, "learn_throughput": 38255.904, "synch_weights_time_ms": 0.768}, "counters": {"num_env_steps_sampled": 51534960, "num_env_steps_trained": 51534960, "num_agent_steps_sampled": 51534960, "num_agent_steps_trained": 51534960}, "done": false, "episodes_total": 12402, "training_iteration": 3890, "trial_id": "9f686_00000", "date": "2023-08-08_15-17-37", "timestamp": 1691497057, "time_this_iter_s": 13.322242021560669, "time_total_s": 93480.06532478333, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 395.892138004303, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 19.0, "ram_util_percent": 65.38947368421053}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-08, "entropy_coeff": 0.15, "policy_entropy": -363.0818905300564, "policy_loss": -9012233.161458334, "vf_loss": 21979269.555555556}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1647.5, "diff_num_grad_updates_vs_sampler_policy": 1646.5}}, "num_env_steps_sampled": 51538560, "num_env_steps_trained": 51538560, "num_agent_steps_sampled": 51538560, "num_agent_steps_trained": 51538560}, "sampler_results": {"episode_reward_max": -10138.422643509588, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10322.397406401347, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4188074850520045, "mean_inference_ms": 0.37193045527886387, "mean_action_processing_ms": 0.09120299726029782, "mean_env_wait_ms": 0.853689801294589, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035184880961542544, "StateBufferConnector_ms": 0.0025663686835247536, "ViewRequirementAgentConnector_ms": 0.06589371225108272}}, "episode_reward_max": -10138.422643509588, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10322.397406401347, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4188074850520045, "mean_inference_ms": 0.37193045527886387, "mean_action_processing_ms": 0.09120299726029782, "mean_env_wait_ms": 0.853689801294589, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035184880961542544, "StateBufferConnector_ms": 0.0025663686835247536, "ViewRequirementAgentConnector_ms": 0.06589371225108272}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51538560, "num_agent_steps_trained": 51538560, "num_env_steps_sampled": 51538560, "num_env_steps_trained": 51538560, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 270.62765062671576, "num_env_steps_trained_throughput_per_sec": 270.62765062671576, "timesteps_total": 51538560, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51538560, "timers": {"training_iteration_time_ms": 4422.769, "sample_time_ms": 4390.095, "load_time_ms": 0.575, "load_throughput": 2088016.926, "learn_time_ms": 31.276, "learn_throughput": 38368.532, "synch_weights_time_ms": 0.775}, "counters": {"num_env_steps_sampled": 51538560, "num_env_steps_trained": 51538560, "num_agent_steps_sampled": 51538560, "num_agent_steps_trained": 51538560}, "done": false, "episodes_total": 12405, "training_iteration": 3891, "trial_id": "9f686_00000", "date": "2023-08-08_15-17-51", "timestamp": 1691497071, "time_this_iter_s": 13.305392980575562, "time_total_s": 93493.3707177639, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 409.19753098487854, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 18.944444444444443, "ram_util_percent": 65.46111111111112}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-08, "entropy_coeff": 0.15, "policy_entropy": -361.8360358344184, "policy_loss": -7495163.719618056, "vf_loss": 21522568.972222224}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1701.5, "diff_num_grad_updates_vs_sampler_policy": 1700.5}}, "num_env_steps_sampled": 51542160, "num_env_steps_trained": 51542160, "num_agent_steps_sampled": 51542160, "num_agent_steps_trained": 51542160}, "sampler_results": {"episode_reward_max": -10138.422643509588, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10321.20757547901, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4190606567511765, "mean_inference_ms": 0.37192896849995144, "mean_action_processing_ms": 0.0912019070495739, "mean_env_wait_ms": 0.8509272160787347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003501239575837788, "StateBufferConnector_ms": 0.0025658858449835527, "ViewRequirementAgentConnector_ms": 0.0658803237111945}}, "episode_reward_max": -10138.422643509588, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10321.20757547901, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4190606567511765, "mean_inference_ms": 0.37192896849995144, "mean_action_processing_ms": 0.0912019070495739, "mean_env_wait_ms": 0.8509272160787347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003501239575837788, "StateBufferConnector_ms": 0.0025658858449835527, "ViewRequirementAgentConnector_ms": 0.0658803237111945}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51542160, "num_agent_steps_trained": 51542160, "num_env_steps_sampled": 51542160, "num_env_steps_trained": 51542160, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 270.47019486131336, "num_env_steps_trained_throughput_per_sec": 270.47019486131336, "timesteps_total": 51542160, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51542160, "timers": {"training_iteration_time_ms": 4437.727, "sample_time_ms": 4404.967, "load_time_ms": 0.578, "load_throughput": 2077588.046, "learn_time_ms": 31.365, "learn_throughput": 38259.568, "synch_weights_time_ms": 0.769}, "counters": {"num_env_steps_sampled": 51542160, "num_env_steps_trained": 51542160, "num_agent_steps_sampled": 51542160, "num_agent_steps_trained": 51542160}, "done": false, "episodes_total": 12408, "training_iteration": 3892, "trial_id": "9f686_00000", "date": "2023-08-08_15-18-04", "timestamp": 1691497084, "time_this_iter_s": 13.313123941421509, "time_total_s": 93506.68384170532, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 422.51065492630005, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 17.789473684210527, "ram_util_percent": 65.56842105263159}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-08, "entropy_coeff": 0.15, "policy_entropy": -370.2866617838542, "policy_loss": -5749368.910590278, "vf_loss": 21327641.138888888}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1755.5, "diff_num_grad_updates_vs_sampler_policy": 1754.5}}, "num_env_steps_sampled": 51545760, "num_env_steps_trained": 51545760, "num_agent_steps_sampled": 51545760, "num_agent_steps_trained": 51545760}, "sampler_results": {"episode_reward_max": -10138.422643509588, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10319.762828597646, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.419327716117026, "mean_inference_ms": 0.37192671481102724, "mean_action_processing_ms": 0.09120082780150139, "mean_env_wait_ms": 0.848298069712327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034886963513432716, "StateBufferConnector_ms": 0.002562999725341797, "ViewRequirementAgentConnector_ms": 0.06587821610119877}}, "episode_reward_max": -10138.422643509588, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10319.762828597646, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10433.26104331468, -10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.419327716117026, "mean_inference_ms": 0.37192671481102724, "mean_action_processing_ms": 0.09120082780150139, "mean_env_wait_ms": 0.848298069712327, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034886963513432716, "StateBufferConnector_ms": 0.002562999725341797, "ViewRequirementAgentConnector_ms": 0.06587821610119877}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51545760, "num_agent_steps_trained": 51545760, "num_env_steps_sampled": 51545760, "num_env_steps_trained": 51545760, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 270.39162040129037, "num_env_steps_trained_throughput_per_sec": 270.39162040129037, "timesteps_total": 51545760, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51545760, "timers": {"training_iteration_time_ms": 4430.785, "sample_time_ms": 4397.68, "load_time_ms": 0.578, "load_throughput": 2076902.204, "learn_time_ms": 31.698, "learn_throughput": 37857.092, "synch_weights_time_ms": 0.779}, "counters": {"num_env_steps_sampled": 51545760, "num_env_steps_trained": 51545760, "num_agent_steps_sampled": 51545760, "num_agent_steps_trained": 51545760}, "done": false, "episodes_total": 12411, "training_iteration": 3893, "trial_id": "9f686_00000", "date": "2023-08-08_15-18-17", "timestamp": 1691497097, "time_this_iter_s": 13.317017078399658, "time_total_s": 93520.00085878372, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 435.8276720046997, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 17.273684210526316, "ram_util_percent": 65.46842105263157}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-08, "entropy_coeff": 0.15, "policy_entropy": -363.14306979709204, "policy_loss": -5748436.866319444, "vf_loss": 21433981.666666668}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1809.5, "diff_num_grad_updates_vs_sampler_policy": 1808.5}}, "num_env_steps_sampled": 51549360, "num_env_steps_trained": 51549360, "num_agent_steps_sampled": 51549360, "num_agent_steps_trained": 51549360}, "sampler_results": {"episode_reward_max": -10138.422643509588, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10317.718341126421, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4194592812616027, "mean_inference_ms": 0.3719072177036528, "mean_action_processing_ms": 0.09119710151048295, "mean_env_wait_ms": 0.8345164985524304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034837722778320312, "StateBufferConnector_ms": 0.002563953399658203, "ViewRequirementAgentConnector_ms": 0.06596994400024414}}, "episode_reward_max": -10138.422643509588, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10317.718341126421, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10208.11455103456, -10419.257734143745, -10321.918232296171, -10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4194592812616027, "mean_inference_ms": 0.3719072177036528, "mean_action_processing_ms": 0.09119710151048295, "mean_env_wait_ms": 0.8345164985524304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034837722778320312, "StateBufferConnector_ms": 0.002563953399658203, "ViewRequirementAgentConnector_ms": 0.06596994400024414}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51549360, "num_agent_steps_trained": 51549360, "num_env_steps_sampled": 51549360, "num_env_steps_trained": 51549360, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 270.01050286615913, "num_env_steps_trained_throughput_per_sec": 270.01050286615913, "timesteps_total": 51549360, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51549360, "timers": {"training_iteration_time_ms": 4439.391, "sample_time_ms": 4406.131, "load_time_ms": 0.58, "load_throughput": 2068962.387, "learn_time_ms": 31.859, "learn_throughput": 37666.059, "synch_weights_time_ms": 0.771}, "counters": {"num_env_steps_sampled": 51549360, "num_env_steps_trained": 51549360, "num_agent_steps_sampled": 51549360, "num_agent_steps_trained": 51549360}, "done": false, "episodes_total": 12414, "training_iteration": 3894, "trial_id": "9f686_00000", "date": "2023-08-08_15-18-31", "timestamp": 1691497111, "time_this_iter_s": 13.335942268371582, "time_total_s": 93533.3368010521, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 449.1636142730713, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 18.805263157894736, "ram_util_percent": 65.31578947368422}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-08, "entropy_coeff": 0.15, "policy_entropy": -367.2225630018446, "policy_loss": -6760290.177083333, "vf_loss": 21134605.722222224}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1863.5, "diff_num_grad_updates_vs_sampler_policy": 1862.5}}, "num_env_steps_sampled": 51552960, "num_env_steps_trained": 51552960, "num_agent_steps_sampled": 51552960, "num_agent_steps_trained": 51552960}, "sampler_results": {"episode_reward_max": -10138.422643509588, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10316.359566393714, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4194269599103477, "mean_inference_ms": 0.3718547648459571, "mean_action_processing_ms": 0.09118704778832154, "mean_env_wait_ms": 0.8127670650477357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034744739532470703, "StateBufferConnector_ms": 0.002567768096923828, "ViewRequirementAgentConnector_ms": 0.06595587730407715}}, "episode_reward_max": -10138.422643509588, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10316.359566393714, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10335.617957927343, -10384.729940517867, -10143.351118966008, -10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4194269599103477, "mean_inference_ms": 0.3718547648459571, "mean_action_processing_ms": 0.09118704778832154, "mean_env_wait_ms": 0.8127670650477357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034744739532470703, "StateBufferConnector_ms": 0.002567768096923828, "ViewRequirementAgentConnector_ms": 0.06595587730407715}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51552960, "num_agent_steps_trained": 51552960, "num_env_steps_sampled": 51552960, "num_env_steps_trained": 51552960, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 270.63029899770595, "num_env_steps_trained_throughput_per_sec": 270.63029899770595, "timesteps_total": 51552960, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51552960, "timers": {"training_iteration_time_ms": 4437.499, "sample_time_ms": 4404.248, "load_time_ms": 0.577, "load_throughput": 2081454.365, "learn_time_ms": 31.844, "learn_throughput": 37683.628, "synch_weights_time_ms": 0.78}, "counters": {"num_env_steps_sampled": 51552960, "num_env_steps_trained": 51552960, "num_agent_steps_sampled": 51552960, "num_agent_steps_trained": 51552960}, "done": false, "episodes_total": 12417, "training_iteration": 3895, "trial_id": "9f686_00000", "date": "2023-08-08_15-18-44", "timestamp": 1691497124, "time_this_iter_s": 13.305057048797607, "time_total_s": 93546.64185810089, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 462.4686713218689, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 19.26842105263158, "ram_util_percent": 65.37368421052632}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-08, "entropy_coeff": 0.15, "policy_entropy": -361.83321804470484, "policy_loss": -6369929.332465278, "vf_loss": 21329069.277777776}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1917.5, "diff_num_grad_updates_vs_sampler_policy": 1916.5}}, "num_env_steps_sampled": 51556560, "num_env_steps_trained": 51556560, "num_agent_steps_sampled": 51556560, "num_agent_steps_trained": 51556560}, "sampler_results": {"episode_reward_max": -10138.422643509588, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10316.394746765058, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4195722694925768, "mean_inference_ms": 0.37182327865438985, "mean_action_processing_ms": 0.09117997826374877, "mean_env_wait_ms": 0.8022026725829439, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034673213958740234, "StateBufferConnector_ms": 0.002566099166870117, "ViewRequirementAgentConnector_ms": 0.06593441963195801}}, "episode_reward_max": -10138.422643509588, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10316.394746765058, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10225.408989597892, -10297.12273970137, -10398.4682145832, -10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4195722694925768, "mean_inference_ms": 0.37182327865438985, "mean_action_processing_ms": 0.09117997826374877, "mean_env_wait_ms": 0.8022026725829439, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034673213958740234, "StateBufferConnector_ms": 0.002566099166870117, "ViewRequirementAgentConnector_ms": 0.06593441963195801}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51556560, "num_agent_steps_trained": 51556560, "num_env_steps_sampled": 51556560, "num_env_steps_trained": 51556560, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 272.5534158954756, "num_env_steps_trained_throughput_per_sec": 272.5534158954756, "timesteps_total": 51556560, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51556560, "timers": {"training_iteration_time_ms": 4427.195, "sample_time_ms": 4394.119, "load_time_ms": 0.577, "load_throughput": 2079304.635, "learn_time_ms": 31.674, "learn_throughput": 37885.759, "synch_weights_time_ms": 0.775}, "counters": {"num_env_steps_sampled": 51556560, "num_env_steps_trained": 51556560, "num_agent_steps_sampled": 51556560, "num_agent_steps_trained": 51556560}, "done": false, "episodes_total": 12420, "training_iteration": 3896, "trial_id": "9f686_00000", "date": "2023-08-08_15-18-57", "timestamp": 1691497137, "time_this_iter_s": 13.211297035217285, "time_total_s": 93559.85315513611, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 475.6799683570862, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 18.726315789473684, "ram_util_percent": 65.23684210526315}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-08, "entropy_coeff": 0.15, "policy_entropy": -361.87304348415796, "policy_loss": -11369113.974826388, "vf_loss": 21929504.472222224}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1971.5, "diff_num_grad_updates_vs_sampler_policy": 1970.5}}, "num_env_steps_sampled": 51560160, "num_env_steps_trained": 51560160, "num_agent_steps_sampled": 51560160, "num_agent_steps_trained": 51560160}, "sampler_results": {"episode_reward_max": -10138.422643509588, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10317.524230539697, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4198046890780662, "mean_inference_ms": 0.37179476006082296, "mean_action_processing_ms": 0.09117356518026991, "mean_env_wait_ms": 0.7952245481193501, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034568309783935547, "StateBufferConnector_ms": 0.002561807632446289, "ViewRequirementAgentConnector_ms": 0.06593942642211914}}, "episode_reward_max": -10138.422643509588, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10317.524230539697, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10376.95277771569, -10490.528558995664, -10195.93586784804, -10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4198046890780662, "mean_inference_ms": 0.37179476006082296, "mean_action_processing_ms": 0.09117356518026991, "mean_env_wait_ms": 0.7952245481193501, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034568309783935547, "StateBufferConnector_ms": 0.002561807632446289, "ViewRequirementAgentConnector_ms": 0.06593942642211914}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51560160, "num_agent_steps_trained": 51560160, "num_env_steps_sampled": 51560160, "num_env_steps_trained": 51560160, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 269.61442596184594, "num_env_steps_trained_throughput_per_sec": 269.61442596184594, "timesteps_total": 51560160, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51560160, "timers": {"training_iteration_time_ms": 4432.406, "sample_time_ms": 4399.791, "load_time_ms": 0.576, "load_throughput": 2083867.346, "learn_time_ms": 31.206, "learn_throughput": 38454.54, "synch_weights_time_ms": 0.784}, "counters": {"num_env_steps_sampled": 51560160, "num_env_steps_trained": 51560160, "num_agent_steps_sampled": 51560160, "num_agent_steps_trained": 51560160}, "done": false, "episodes_total": 12423, "training_iteration": 3897, "trial_id": "9f686_00000", "date": "2023-08-08_15-19-11", "timestamp": 1691497151, "time_this_iter_s": 13.35536503791809, "time_total_s": 93573.20852017403, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 489.0353333950043, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 17.915789473684214, "ram_util_percent": 65.27894736842104}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-08, "entropy_coeff": 0.15, "policy_entropy": -361.95054796006946, "policy_loss": -9136698.141927084, "vf_loss": 21437492.388888888}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2025.5, "diff_num_grad_updates_vs_sampler_policy": 2024.5}}, "num_env_steps_sampled": 51563760, "num_env_steps_trained": 51563760, "num_agent_steps_sampled": 51563760, "num_agent_steps_trained": 51563760}, "sampler_results": {"episode_reward_max": -10138.422643509588, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10315.608394000856, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4200593858274546, "mean_inference_ms": 0.3717760968898512, "mean_action_processing_ms": 0.09116891195188086, "mean_env_wait_ms": 0.7900126320246863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034613609313964844, "StateBufferConnector_ms": 0.0025675296783447266, "ViewRequirementAgentConnector_ms": 0.0659935474395752}}, "episode_reward_max": -10138.422643509588, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10315.608394000856, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10344.13285757915, -10309.287905404215, -10346.83247746492, -10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4200593858274546, "mean_inference_ms": 0.3717760968898512, "mean_action_processing_ms": 0.09116891195188086, "mean_env_wait_ms": 0.7900126320246863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034613609313964844, "StateBufferConnector_ms": 0.0025675296783447266, "ViewRequirementAgentConnector_ms": 0.0659935474395752}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51563760, "num_agent_steps_trained": 51563760, "num_env_steps_sampled": 51563760, "num_env_steps_trained": 51563760, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 271.8964292735082, "num_env_steps_trained_throughput_per_sec": 271.8964292735082, "timesteps_total": 51563760, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51563760, "timers": {"training_iteration_time_ms": 4418.847, "sample_time_ms": 4386.384, "load_time_ms": 0.579, "load_throughput": 2072796.639, "learn_time_ms": 31.04, "learn_throughput": 38659.644, "synch_weights_time_ms": 0.795}, "counters": {"num_env_steps_sampled": 51563760, "num_env_steps_trained": 51563760, "num_agent_steps_sampled": 51563760, "num_agent_steps_trained": 51563760}, "done": false, "episodes_total": 12426, "training_iteration": 3898, "trial_id": "9f686_00000", "date": "2023-08-08_15-19-24", "timestamp": 1691497164, "time_this_iter_s": 13.243278980255127, "time_total_s": 93586.45179915428, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 502.2786123752594, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 20.211111111111112, "ram_util_percent": 65.2611111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-08, "entropy_coeff": 0.15, "policy_entropy": -363.1575944688585, "policy_loss": -14342303.980034722, "vf_loss": 21670764.944444444}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2079.5, "diff_num_grad_updates_vs_sampler_policy": 2078.5}}, "num_env_steps_sampled": 51567360, "num_env_steps_trained": 51567360, "num_agent_steps_sampled": 51567360, "num_agent_steps_trained": 51567360}, "sampler_results": {"episode_reward_max": -10138.422643509588, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10313.514210004434, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4203808400683924, "mean_inference_ms": 0.3717673346286324, "mean_action_processing_ms": 0.09116592785073153, "mean_env_wait_ms": 0.7859018042957608, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003457784652709961, "StateBufferConnector_ms": 0.0025701522827148438, "ViewRequirementAgentConnector_ms": 0.06598806381225586}}, "episode_reward_max": -10138.422643509588, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10313.514210004434, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10248.835272965558, -10380.485830608288, -10370.426197688823, -10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4203808400683924, "mean_inference_ms": 0.3717673346286324, "mean_action_processing_ms": 0.09116592785073153, "mean_env_wait_ms": 0.7859018042957608, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003457784652709961, "StateBufferConnector_ms": 0.0025701522827148438, "ViewRequirementAgentConnector_ms": 0.06598806381225586}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51567360, "num_agent_steps_trained": 51567360, "num_env_steps_sampled": 51567360, "num_env_steps_trained": 51567360, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 274.3651078754326, "num_env_steps_trained_throughput_per_sec": 274.3651078754326, "timesteps_total": 51567360, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51567360, "timers": {"training_iteration_time_ms": 4413.753, "sample_time_ms": 4381.405, "load_time_ms": 0.578, "load_throughput": 2076902.204, "learn_time_ms": 30.938, "learn_throughput": 38787.484, "synch_weights_time_ms": 0.783}, "counters": {"num_env_steps_sampled": 51567360, "num_env_steps_trained": 51567360, "num_agent_steps_sampled": 51567360, "num_agent_steps_trained": 51567360}, "done": false, "episodes_total": 12429, "training_iteration": 3899, "trial_id": "9f686_00000", "date": "2023-08-08_15-19-37", "timestamp": 1691497177, "time_this_iter_s": 13.124138116836548, "time_total_s": 93599.57593727112, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 515.402750492096, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 20.978947368421053, "ram_util_percent": 65.40526315789474}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.5e-09, "entropy_coeff": 0.15, "policy_entropy": -362.1494784884983, "policy_loss": -4893012.677083333, "vf_loss": 21068225.388888888}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2133.5, "diff_num_grad_updates_vs_sampler_policy": 2132.5}}, "num_env_steps_sampled": 51570960, "num_env_steps_trained": 51570960, "num_agent_steps_sampled": 51570960, "num_agent_steps_trained": 51570960}, "sampler_results": {"episode_reward_max": -10120.460325040927, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10310.806116828264, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4207126403634116, "mean_inference_ms": 0.3717607069162906, "mean_action_processing_ms": 0.0911636469086454, "mean_env_wait_ms": 0.7825101300616509, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034568309783935547, "StateBufferConnector_ms": 0.002595186233520508, "ViewRequirementAgentConnector_ms": 0.06606483459472656}}, "episode_reward_max": -10120.460325040927, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10310.806116828264, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10273.346773913812, -10176.142109260441, -10365.255347900316, -10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4207126403634116, "mean_inference_ms": 0.3717607069162906, "mean_action_processing_ms": 0.0911636469086454, "mean_env_wait_ms": 0.7825101300616509, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034568309783935547, "StateBufferConnector_ms": 0.002595186233520508, "ViewRequirementAgentConnector_ms": 0.06606483459472656}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51570960, "num_agent_steps_trained": 51570960, "num_env_steps_sampled": 51570960, "num_env_steps_trained": 51570960, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 275.15522600048104, "num_env_steps_trained_throughput_per_sec": 275.15522600048104, "timesteps_total": 51570960, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51570960, "timers": {"training_iteration_time_ms": 4392.079, "sample_time_ms": 4359.715, "load_time_ms": 0.575, "load_throughput": 2085248.705, "learn_time_ms": 30.963, "learn_throughput": 38756.064, "synch_weights_time_ms": 0.777}, "counters": {"num_env_steps_sampled": 51570960, "num_env_steps_trained": 51570960, "num_agent_steps_sampled": 51570960, "num_agent_steps_trained": 51570960}, "done": false, "episodes_total": 12432, "training_iteration": 3900, "trial_id": "9f686_00000", "date": "2023-08-08_15-19-50", "timestamp": 1691497190, "time_this_iter_s": 13.086535930633545, "time_total_s": 93612.66247320175, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 528.4892864227295, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 20.168421052631583, "ram_util_percent": 65.45263157894738}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7e-09, "entropy_coeff": 0.15, "policy_entropy": -363.58156331380206, "policy_loss": -11816040.448784722, "vf_loss": 22031019.138888888}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2187.5, "diff_num_grad_updates_vs_sampler_policy": 2186.5}}, "num_env_steps_sampled": 51574560, "num_env_steps_trained": 51574560, "num_agent_steps_sampled": 51574560, "num_agent_steps_trained": 51574560}, "sampler_results": {"episode_reward_max": -10120.460325040927, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10313.622852708793, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4210778332915943, "mean_inference_ms": 0.37175782077808783, "mean_action_processing_ms": 0.09116287252740833, "mean_env_wait_ms": 0.7797028625983602, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003477334976196289, "StateBufferConnector_ms": 0.0025916099548339844, "ViewRequirementAgentConnector_ms": 0.06614017486572266}}, "episode_reward_max": -10120.460325040927, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10313.622852708793, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10250.146645534738, -10385.998841908697, -10224.736782805583, -10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4210778332915943, "mean_inference_ms": 0.37175782077808783, "mean_action_processing_ms": 0.09116287252740833, "mean_env_wait_ms": 0.7797028625983602, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003477334976196289, "StateBufferConnector_ms": 0.0025916099548339844, "ViewRequirementAgentConnector_ms": 0.06614017486572266}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51574560, "num_agent_steps_trained": 51574560, "num_env_steps_sampled": 51574560, "num_env_steps_trained": 51574560, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 270.73493171146083, "num_env_steps_trained_throughput_per_sec": 270.73493171146083, "timesteps_total": 51574560, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51574560, "timers": {"training_iteration_time_ms": 4393.258, "sample_time_ms": 4360.63, "load_time_ms": 0.575, "load_throughput": 2088710.13, "learn_time_ms": 31.231, "learn_throughput": 38423.217, "synch_weights_time_ms": 0.775}, "counters": {"num_env_steps_sampled": 51574560, "num_env_steps_trained": 51574560, "num_agent_steps_sampled": 51574560, "num_agent_steps_trained": 51574560}, "done": false, "episodes_total": 12435, "training_iteration": 3901, "trial_id": "9f686_00000", "date": "2023-08-08_15-20-03", "timestamp": 1691497203, "time_this_iter_s": 13.300023794174194, "time_total_s": 93625.96249699593, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 541.7893102169037, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 20.583333333333332, "ram_util_percent": 65.48333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.5e-09, "entropy_coeff": 0.15, "policy_entropy": -361.83804490831164, "policy_loss": -6314100.431857639, "vf_loss": 21243618.027777776}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2241.5, "diff_num_grad_updates_vs_sampler_policy": 2240.5}}, "num_env_steps_sampled": 51578160, "num_env_steps_trained": 51578160, "num_agent_steps_sampled": 51578160, "num_agent_steps_trained": 51578160}, "sampler_results": {"episode_reward_max": -10120.460325040927, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10313.234478898592, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4215743898294555, "mean_inference_ms": 0.3717586446063575, "mean_action_processing_ms": 0.09116224505526714, "mean_env_wait_ms": 0.7773422601615766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034759044647216797, "StateBufferConnector_ms": 0.0025882720947265625, "ViewRequirementAgentConnector_ms": 0.0661172866821289}}, "episode_reward_max": -10120.460325040927, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10313.234478898592, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10255.741791393315, -10270.5137684212, -10395.842525808504, -10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4215743898294555, "mean_inference_ms": 0.3717586446063575, "mean_action_processing_ms": 0.09116224505526714, "mean_env_wait_ms": 0.7773422601615766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034759044647216797, "StateBufferConnector_ms": 0.0025882720947265625, "ViewRequirementAgentConnector_ms": 0.0661172866821289}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51578160, "num_agent_steps_trained": 51578160, "num_env_steps_sampled": 51578160, "num_env_steps_trained": 51578160, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 271.90617763069304, "num_env_steps_trained_throughput_per_sec": 271.90617763069304, "timesteps_total": 51578160, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51578160, "timers": {"training_iteration_time_ms": 4406.54, "sample_time_ms": 4373.816, "load_time_ms": 0.577, "load_throughput": 2080851.993, "learn_time_ms": 31.324, "learn_throughput": 38308.898, "synch_weights_time_ms": 0.775}, "counters": {"num_env_steps_sampled": 51578160, "num_env_steps_trained": 51578160, "num_agent_steps_sampled": 51578160, "num_agent_steps_trained": 51578160}, "done": false, "episodes_total": 12438, "training_iteration": 3902, "trial_id": "9f686_00000", "date": "2023-08-08_15-20-17", "timestamp": 1691497217, "time_this_iter_s": 13.2427818775177, "time_total_s": 93639.20527887344, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 555.0320920944214, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 20.068421052631578, "ram_util_percent": 65.3842105263158}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-09, "entropy_coeff": 0.15, "policy_entropy": -363.5330522325304, "policy_loss": -4599974.423611111, "vf_loss": 21196218.166666668}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2295.5, "diff_num_grad_updates_vs_sampler_policy": 2294.5}}, "num_env_steps_sampled": 51581760, "num_env_steps_trained": 51581760, "num_agent_steps_sampled": 51581760, "num_agent_steps_trained": 51581760}, "sampler_results": {"episode_reward_max": -10120.460325040927, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10313.911500460541, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4221133996178863, "mean_inference_ms": 0.37176305151555544, "mean_action_processing_ms": 0.09116177041874543, "mean_env_wait_ms": 0.775275152127853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003468751907348633, "StateBufferConnector_ms": 0.002593517303466797, "ViewRequirementAgentConnector_ms": 0.06607174873352051}}, "episode_reward_max": -10120.460325040927, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10313.911500460541, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10334.364396317895, -10255.98922086355, -10160.688751635582, -10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4221133996178863, "mean_inference_ms": 0.37176305151555544, "mean_action_processing_ms": 0.09116177041874543, "mean_env_wait_ms": 0.775275152127853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003468751907348633, "StateBufferConnector_ms": 0.002593517303466797, "ViewRequirementAgentConnector_ms": 0.06607174873352051}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51581760, "num_agent_steps_trained": 51581760, "num_env_steps_sampled": 51581760, "num_env_steps_trained": 51581760, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 272.13284881971583, "num_env_steps_trained_throughput_per_sec": 272.13284881971583, "timesteps_total": 51581760, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51581760, "timers": {"training_iteration_time_ms": 4411.484, "sample_time_ms": 4378.579, "load_time_ms": 0.578, "load_throughput": 2075788.675, "learn_time_ms": 31.502, "learn_throughput": 38093.299, "synch_weights_time_ms": 0.777}, "counters": {"num_env_steps_sampled": 51581760, "num_env_steps_trained": 51581760, "num_agent_steps_sampled": 51581760, "num_agent_steps_trained": 51581760}, "done": false, "episodes_total": 12441, "training_iteration": 3903, "trial_id": "9f686_00000", "date": "2023-08-08_15-20-30", "timestamp": 1691497230, "time_this_iter_s": 13.231732845306396, "time_total_s": 93652.43701171875, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 568.2638249397278, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 18.71578947368421, "ram_util_percent": 65.22105263157896}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-09, "entropy_coeff": 0.15, "policy_entropy": -362.5972883436415, "policy_loss": -15036952.877604166, "vf_loss": 22024471.416666668}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2349.5, "diff_num_grad_updates_vs_sampler_policy": 2348.5}}, "num_env_steps_sampled": 51585360, "num_env_steps_trained": 51585360, "num_agent_steps_sampled": 51585360, "num_agent_steps_trained": 51585360}, "sampler_results": {"episode_reward_max": -10120.460325040927, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10317.45219330914, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.42265736510875, "mean_inference_ms": 0.37177216329887985, "mean_action_processing_ms": 0.09116226011626052, "mean_env_wait_ms": 0.7734983379565521, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003473043441772461, "StateBufferConnector_ms": 0.002595186233520508, "ViewRequirementAgentConnector_ms": 0.06616878509521484}}, "episode_reward_max": -10120.460325040927, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10317.45219330914, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10276.42709469874, -10274.975147689696, -10377.220989777223, -10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.42265736510875, "mean_inference_ms": 0.37177216329887985, "mean_action_processing_ms": 0.09116226011626052, "mean_env_wait_ms": 0.7734983379565521, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003473043441772461, "StateBufferConnector_ms": 0.002595186233520508, "ViewRequirementAgentConnector_ms": 0.06616878509521484}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51585360, "num_agent_steps_trained": 51585360, "num_env_steps_sampled": 51585360, "num_env_steps_trained": 51585360, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 270.0109036199571, "num_env_steps_trained_throughput_per_sec": 270.0109036199571, "timesteps_total": 51585360, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51585360, "timers": {"training_iteration_time_ms": 4423.739, "sample_time_ms": 4390.66, "load_time_ms": 0.575, "load_throughput": 2086372.409, "learn_time_ms": 31.674, "learn_throughput": 37885.56, "synch_weights_time_ms": 0.781}, "counters": {"num_env_steps_sampled": 51585360, "num_env_steps_trained": 51585360, "num_agent_steps_sampled": 51585360, "num_agent_steps_trained": 51585360}, "done": false, "episodes_total": 12444, "training_iteration": 3904, "trial_id": "9f686_00000", "date": "2023-08-08_15-20-43", "timestamp": 1691497243, "time_this_iter_s": 13.33584189414978, "time_total_s": 93665.7728536129, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 581.5996668338776, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 18.884210526315794, "ram_util_percent": 65.21578947368421}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-09, "entropy_coeff": 0.15, "policy_entropy": -363.7446119520399, "policy_loss": -5667002.057291667, "vf_loss": 21100957.361111112}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2403.5, "diff_num_grad_updates_vs_sampler_policy": 2402.5}}, "num_env_steps_sampled": 51588960, "num_env_steps_trained": 51588960, "num_agent_steps_sampled": 51588960, "num_agent_steps_trained": 51588960}, "sampler_results": {"episode_reward_max": -10120.460325040927, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10317.012578612548, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4231848525491064, "mean_inference_ms": 0.37178526503590886, "mean_action_processing_ms": 0.091163442033641, "mean_env_wait_ms": 0.7719225112180007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003470897674560547, "StateBufferConnector_ms": 0.0025947093963623047, "ViewRequirementAgentConnector_ms": 0.06616044044494629}}, "episode_reward_max": -10120.460325040927, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10317.012578612548, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10402.573899326591, -10315.461907527102, -10245.096816139136, -10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4231848525491064, "mean_inference_ms": 0.37178526503590886, "mean_action_processing_ms": 0.091163442033641, "mean_env_wait_ms": 0.7719225112180007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003470897674560547, "StateBufferConnector_ms": 0.0025947093963623047, "ViewRequirementAgentConnector_ms": 0.06616044044494629}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51588960, "num_agent_steps_trained": 51588960, "num_env_steps_sampled": 51588960, "num_env_steps_trained": 51588960, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 271.804145846852, "num_env_steps_trained_throughput_per_sec": 271.804145846852, "timesteps_total": 51588960, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51588960, "timers": {"training_iteration_time_ms": 4415.841, "sample_time_ms": 4382.702, "load_time_ms": 0.576, "load_throughput": 2082057.086, "learn_time_ms": 31.718, "learn_throughput": 37833.815, "synch_weights_time_ms": 0.795}, "counters": {"num_env_steps_sampled": 51588960, "num_env_steps_trained": 51588960, "num_agent_steps_sampled": 51588960, "num_agent_steps_trained": 51588960}, "done": false, "episodes_total": 12447, "training_iteration": 3905, "trial_id": "9f686_00000", "date": "2023-08-08_15-20-57", "timestamp": 1691497257, "time_this_iter_s": 13.247682094573975, "time_total_s": 93679.02053570747, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 594.8473489284515, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 20.210526315789473, "ram_util_percent": 65.23684210526316}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-09, "entropy_coeff": 0.15, "policy_entropy": -363.1217261420356, "policy_loss": -6057876.385850694, "vf_loss": 21372783.888888888}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2457.5, "diff_num_grad_updates_vs_sampler_policy": 2456.5}}, "num_env_steps_sampled": 51592560, "num_env_steps_trained": 51592560, "num_agent_steps_sampled": 51592560, "num_agent_steps_trained": 51592560}, "sampler_results": {"episode_reward_max": -10120.460325040927, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10318.369683072458, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.423700057663412, "mean_inference_ms": 0.3717987958931783, "mean_action_processing_ms": 0.09116479241211184, "mean_env_wait_ms": 0.7705290522262142, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034689903259277344, "StateBufferConnector_ms": 0.002605915069580078, "ViewRequirementAgentConnector_ms": 0.06620049476623535}}, "episode_reward_max": -10120.460325040927, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10318.369683072458, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10267.458657253193, -10256.872434073832, -10229.947811051834, -10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.423700057663412, "mean_inference_ms": 0.3717987958931783, "mean_action_processing_ms": 0.09116479241211184, "mean_env_wait_ms": 0.7705290522262142, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034689903259277344, "StateBufferConnector_ms": 0.002605915069580078, "ViewRequirementAgentConnector_ms": 0.06620049476623535}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51592560, "num_agent_steps_trained": 51592560, "num_env_steps_sampled": 51592560, "num_env_steps_trained": 51592560, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 270.71467139956303, "num_env_steps_trained_throughput_per_sec": 270.71467139956303, "timesteps_total": 51592560, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51592560, "timers": {"training_iteration_time_ms": 4425.492, "sample_time_ms": 4392.255, "load_time_ms": 0.575, "load_throughput": 2088536.786, "learn_time_ms": 31.83, "learn_throughput": 37700.395, "synch_weights_time_ms": 0.784}, "counters": {"num_env_steps_sampled": 51592560, "num_env_steps_trained": 51592560, "num_agent_steps_sampled": 51592560, "num_agent_steps_trained": 51592560}, "done": false, "episodes_total": 12450, "training_iteration": 3906, "trial_id": "9f686_00000", "date": "2023-08-08_15-21-10", "timestamp": 1691497270, "time_this_iter_s": 13.301023960113525, "time_total_s": 93692.32155966759, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 608.1483728885651, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 18.821052631578947, "ram_util_percent": 65.15789473684211}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-09, "entropy_coeff": 0.15, "policy_entropy": -362.1723141140408, "policy_loss": -10843381.394965278, "vf_loss": 21714924.444444444}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2511.5, "diff_num_grad_updates_vs_sampler_policy": 2510.5}}, "num_env_steps_sampled": 51596160, "num_env_steps_trained": 51596160, "num_agent_steps_sampled": 51596160, "num_agent_steps_trained": 51596160}, "sampler_results": {"episode_reward_max": -10120.460325040927, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10318.310580451182, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.424192279567896, "mean_inference_ms": 0.37181355873766947, "mean_action_processing_ms": 0.09116619121460229, "mean_env_wait_ms": 0.7692873374006888, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003464221954345703, "StateBufferConnector_ms": 0.002594470977783203, "ViewRequirementAgentConnector_ms": 0.06619477272033691}}, "episode_reward_max": -10120.460325040927, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10318.310580451182, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10342.335596077384, -10365.328197611392, -10450.020474818924, -10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.424192279567896, "mean_inference_ms": 0.37181355873766947, "mean_action_processing_ms": 0.09116619121460229, "mean_env_wait_ms": 0.7692873374006888, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003464221954345703, "StateBufferConnector_ms": 0.002594470977783203, "ViewRequirementAgentConnector_ms": 0.06619477272033691}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51596160, "num_agent_steps_trained": 51596160, "num_env_steps_sampled": 51596160, "num_env_steps_trained": 51596160, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 274.45624035872015, "num_env_steps_trained_throughput_per_sec": 274.45624035872015, "timesteps_total": 51596160, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51596160, "timers": {"training_iteration_time_ms": 4412.644, "sample_time_ms": 4379.351, "load_time_ms": 0.581, "load_throughput": 2067177.92, "learn_time_ms": 31.874, "learn_throughput": 37648.534, "synch_weights_time_ms": 0.791}, "counters": {"num_env_steps_sampled": 51596160, "num_env_steps_trained": 51596160, "num_agent_steps_sampled": 51596160, "num_agent_steps_trained": 51596160}, "done": false, "episodes_total": 12453, "training_iteration": 3907, "trial_id": "9f686_00000", "date": "2023-08-08_15-21-23", "timestamp": 1691497283, "time_this_iter_s": 13.119736909866333, "time_total_s": 93705.44129657745, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 621.2681097984314, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 19.605555555555558, "ram_util_percent": 65.17222222222223}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-09, "entropy_coeff": 0.15, "policy_entropy": -364.73272196451825, "policy_loss": -6629568.0390625, "vf_loss": 21395819.861111112}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2565.5, "diff_num_grad_updates_vs_sampler_policy": 2564.5}}, "num_env_steps_sampled": 51599760, "num_env_steps_trained": 51599760, "num_agent_steps_sampled": 51599760, "num_agent_steps_trained": 51599760}, "sampler_results": {"episode_reward_max": -10120.460325040927, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10315.530486896307, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4246792766446545, "mean_inference_ms": 0.3718274265970797, "mean_action_processing_ms": 0.09116774412888072, "mean_env_wait_ms": 0.7681474225796127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034673213958740234, "StateBufferConnector_ms": 0.0025954246520996094, "ViewRequirementAgentConnector_ms": 0.06620907783508301}}, "episode_reward_max": -10120.460325040927, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10315.530486896307, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10278.568532009, -10324.323527778404, -10277.134751731932, -10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4246792766446545, "mean_inference_ms": 0.3718274265970797, "mean_action_processing_ms": 0.09116774412888072, "mean_env_wait_ms": 0.7681474225796127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034673213958740234, "StateBufferConnector_ms": 0.0025954246520996094, "ViewRequirementAgentConnector_ms": 0.06620907783508301}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51599760, "num_agent_steps_trained": 51599760, "num_env_steps_sampled": 51599760, "num_env_steps_trained": 51599760, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 273.69093502007996, "num_env_steps_trained_throughput_per_sec": 273.69093502007996, "timesteps_total": 51599760, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51599760, "timers": {"training_iteration_time_ms": 4394.228, "sample_time_ms": 4361.042, "load_time_ms": 0.579, "load_throughput": 2073992.418, "learn_time_ms": 31.779, "learn_throughput": 37761.037, "synch_weights_time_ms": 0.78}, "counters": {"num_env_steps_sampled": 51599760, "num_env_steps_trained": 51599760, "num_agent_steps_sampled": 51599760, "num_agent_steps_trained": 51599760}, "done": false, "episodes_total": 12456, "training_iteration": 3908, "trial_id": "9f686_00000", "date": "2023-08-08_15-21-36", "timestamp": 1691497296, "time_this_iter_s": 13.156466007232666, "time_total_s": 93718.59776258469, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 634.4245758056641, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 21.605263157894733, "ram_util_percent": 65.2421052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-09, "entropy_coeff": 0.15, "policy_entropy": -363.8670925564236, "policy_loss": -6201376.320746528, "vf_loss": 21392324.694444444}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2619.5, "diff_num_grad_updates_vs_sampler_policy": 2618.5}}, "num_env_steps_sampled": 51603360, "num_env_steps_trained": 51603360, "num_agent_steps_sampled": 51603360, "num_agent_steps_trained": 51603360}, "sampler_results": {"episode_reward_max": -10120.460325040927, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10314.136585237016, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4251409219512716, "mean_inference_ms": 0.3718395444549021, "mean_action_processing_ms": 0.09116914460338205, "mean_env_wait_ms": 0.7671079155106265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034656524658203125, "StateBufferConnector_ms": 0.002591371536254883, "ViewRequirementAgentConnector_ms": 0.06613779067993164}}, "episode_reward_max": -10120.460325040927, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10314.136585237016, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10309.229947646958, -10258.548518232492, -10324.61914382522, -10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4251409219512716, "mean_inference_ms": 0.3718395444549021, "mean_action_processing_ms": 0.09116914460338205, "mean_env_wait_ms": 0.7671079155106265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034656524658203125, "StateBufferConnector_ms": 0.002591371536254883, "ViewRequirementAgentConnector_ms": 0.06613779067993164}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51603360, "num_agent_steps_trained": 51603360, "num_env_steps_sampled": 51603360, "num_env_steps_trained": 51603360, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 271.72848642740945, "num_env_steps_trained_throughput_per_sec": 271.72848642740945, "timesteps_total": 51603360, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51603360, "timers": {"training_iteration_time_ms": 4397.577, "sample_time_ms": 4364.295, "load_time_ms": 0.58, "load_throughput": 2069047.439, "learn_time_ms": 31.834, "learn_throughput": 37696.046, "synch_weights_time_ms": 0.818}, "counters": {"num_env_steps_sampled": 51603360, "num_env_steps_trained": 51603360, "num_agent_steps_sampled": 51603360, "num_agent_steps_trained": 51603360}, "done": false, "episodes_total": 12459, "training_iteration": 3909, "trial_id": "9f686_00000", "date": "2023-08-08_15-21-49", "timestamp": 1691497309, "time_this_iter_s": 13.251494884490967, "time_total_s": 93731.84925746918, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 647.676070690155, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 18.557894736842105, "ram_util_percent": 65.22105263157896}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-09, "entropy_coeff": 0.15, "policy_entropy": -361.6747792561849, "policy_loss": -3343458.9329427085, "vf_loss": 20962927.027777776}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2673.5, "diff_num_grad_updates_vs_sampler_policy": 2672.5}}, "num_env_steps_sampled": 51606960, "num_env_steps_trained": 51606960, "num_agent_steps_sampled": 51606960, "num_agent_steps_trained": 51606960}, "sampler_results": {"episode_reward_max": -10120.460325040927, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10314.21644259386, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4255367752088874, "mean_inference_ms": 0.3718507885587614, "mean_action_processing_ms": 0.0911705110276532, "mean_env_wait_ms": 0.7661676464945928, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034635066986083984, "StateBufferConnector_ms": 0.002586841583251953, "ViewRequirementAgentConnector_ms": 0.06611204147338867}}, "episode_reward_max": -10120.460325040927, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10314.21644259386, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10281.311238936569, -10374.568597516334, -10441.164497635227, -10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4255367752088874, "mean_inference_ms": 0.3718507885587614, "mean_action_processing_ms": 0.0911705110276532, "mean_env_wait_ms": 0.7661676464945928, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034635066986083984, "StateBufferConnector_ms": 0.002586841583251953, "ViewRequirementAgentConnector_ms": 0.06611204147338867}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51606960, "num_agent_steps_trained": 51606960, "num_env_steps_sampled": 51606960, "num_env_steps_trained": 51606960, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 271.3257481051754, "num_env_steps_trained_throughput_per_sec": 271.3257481051754, "timesteps_total": 51606960, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51606960, "timers": {"training_iteration_time_ms": 4410.099, "sample_time_ms": 4377.135, "load_time_ms": 0.575, "load_throughput": 2086112.985, "learn_time_ms": 31.537, "learn_throughput": 38050.965, "synch_weights_time_ms": 0.803}, "counters": {"num_env_steps_sampled": 51606960, "num_env_steps_trained": 51606960, "num_agent_steps_sampled": 51606960, "num_agent_steps_trained": 51606960}, "done": false, "episodes_total": 12462, "training_iteration": 3910, "trial_id": "9f686_00000", "date": "2023-08-08_15-22-03", "timestamp": 1691497323, "time_this_iter_s": 13.271113872528076, "time_total_s": 93745.1203713417, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 660.9471845626831, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 19.005555555555556, "ram_util_percent": 65.32777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-09, "entropy_coeff": 0.15, "policy_entropy": -362.33939785427515, "policy_loss": -8204733.971354167, "vf_loss": 21524450.777777776}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2727.5, "diff_num_grad_updates_vs_sampler_policy": 2726.5}}, "num_env_steps_sampled": 51610560, "num_env_steps_trained": 51610560, "num_agent_steps_sampled": 51610560, "num_agent_steps_trained": 51610560}, "sampler_results": {"episode_reward_max": -10120.460325040927, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10312.727389751479, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.425901882404344, "mean_inference_ms": 0.3718595664280758, "mean_action_processing_ms": 0.09117173395401623, "mean_env_wait_ms": 0.765274011608861, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034630298614501953, "StateBufferConnector_ms": 0.0025827884674072266, "ViewRequirementAgentConnector_ms": 0.06611776351928711}}, "episode_reward_max": -10120.460325040927, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10312.727389751479, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10277.54935651216, -10346.80391227447, -10309.613376391071, -10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.425901882404344, "mean_inference_ms": 0.3718595664280758, "mean_action_processing_ms": 0.09117173395401623, "mean_env_wait_ms": 0.765274011608861, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034630298614501953, "StateBufferConnector_ms": 0.0025827884674072266, "ViewRequirementAgentConnector_ms": 0.06611776351928711}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51610560, "num_agent_steps_trained": 51610560, "num_env_steps_sampled": 51610560, "num_env_steps_trained": 51610560, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 273.10347162671013, "num_env_steps_trained_throughput_per_sec": 273.10347162671013, "timesteps_total": 51610560, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51610560, "timers": {"training_iteration_time_ms": 4404.699, "sample_time_ms": 4371.837, "load_time_ms": 0.574, "load_throughput": 2088796.813, "learn_time_ms": 31.439, "learn_throughput": 38168.957, "synch_weights_time_ms": 0.799}, "counters": {"num_env_steps_sampled": 51610560, "num_env_steps_trained": 51610560, "num_agent_steps_sampled": 51610560, "num_agent_steps_trained": 51610560}, "done": false, "episodes_total": 12465, "training_iteration": 3911, "trial_id": "9f686_00000", "date": "2023-08-08_15-22-16", "timestamp": 1691497336, "time_this_iter_s": 13.185196161270142, "time_total_s": 93758.30556750298, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 674.1323807239532, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 19.147368421052633, "ram_util_percent": 65.28947368421053}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-09, "entropy_coeff": 0.15, "policy_entropy": -363.7164323594835, "policy_loss": -7237186.795138889, "vf_loss": 21431540.805555556}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2781.5, "diff_num_grad_updates_vs_sampler_policy": 2780.5}}, "num_env_steps_sampled": 51614160, "num_env_steps_trained": 51614160, "num_agent_steps_sampled": 51614160, "num_agent_steps_trained": 51614160}, "sampler_results": {"episode_reward_max": -10120.460325040927, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10314.824426655541, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4262550946307986, "mean_inference_ms": 0.37186870389582616, "mean_action_processing_ms": 0.09117315928638924, "mean_env_wait_ms": 0.7644347714018579, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003465890884399414, "StateBufferConnector_ms": 0.0025796890258789062, "ViewRequirementAgentConnector_ms": 0.06615948677062988}}, "episode_reward_max": -10120.460325040927, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10314.824426655541, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10417.87227491456, -10271.640840405891, -10454.038861783269, -10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4262550946307986, "mean_inference_ms": 0.37186870389582616, "mean_action_processing_ms": 0.09117315928638924, "mean_env_wait_ms": 0.7644347714018579, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003465890884399414, "StateBufferConnector_ms": 0.0025796890258789062, "ViewRequirementAgentConnector_ms": 0.06615948677062988}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51614160, "num_agent_steps_trained": 51614160, "num_env_steps_sampled": 51614160, "num_env_steps_trained": 51614160, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 269.29444063495976, "num_env_steps_trained_throughput_per_sec": 269.29444063495976, "timesteps_total": 51614160, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51614160, "timers": {"training_iteration_time_ms": 4417.256, "sample_time_ms": 4384.471, "load_time_ms": 0.576, "load_throughput": 2082487.815, "learn_time_ms": 31.372, "learn_throughput": 38250.177, "synch_weights_time_ms": 0.786}, "counters": {"num_env_steps_sampled": 51614160, "num_env_steps_trained": 51614160, "num_agent_steps_sampled": 51614160, "num_agent_steps_trained": 51614160}, "done": false, "episodes_total": 12468, "training_iteration": 3912, "trial_id": "9f686_00000", "date": "2023-08-08_15-22-29", "timestamp": 1691497349, "time_this_iter_s": 13.371216058731079, "time_total_s": 93771.6767835617, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 687.5035967826843, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 19.310526315789474, "ram_util_percent": 65.00000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.499999999999999e-09, "entropy_coeff": 0.15, "policy_entropy": -361.9247334798177, "policy_loss": -11399146.444444444, "vf_loss": 21695868.555555556}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2835.5, "diff_num_grad_updates_vs_sampler_policy": 2834.5}}, "num_env_steps_sampled": 51617760, "num_env_steps_trained": 51617760, "num_agent_steps_sampled": 51617760, "num_agent_steps_trained": 51617760}, "sampler_results": {"episode_reward_max": -10120.460325040927, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10311.875885537613, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4265916683997766, "mean_inference_ms": 0.37187671330900046, "mean_action_processing_ms": 0.09117467009666863, "mean_env_wait_ms": 0.7636280346900517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003467559814453125, "StateBufferConnector_ms": 0.0025832653045654297, "ViewRequirementAgentConnector_ms": 0.06616377830505371}}, "episode_reward_max": -10120.460325040927, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10311.875885537613, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10391.718659080558, -10231.818207882841, -10408.921853554977, -10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4265916683997766, "mean_inference_ms": 0.37187671330900046, "mean_action_processing_ms": 0.09117467009666863, "mean_env_wait_ms": 0.7636280346900517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003467559814453125, "StateBufferConnector_ms": 0.0025832653045654297, "ViewRequirementAgentConnector_ms": 0.06616377830505371}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51617760, "num_agent_steps_trained": 51617760, "num_env_steps_sampled": 51617760, "num_env_steps_trained": 51617760, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 272.3606842881873, "num_env_steps_trained_throughput_per_sec": 272.3606842881873, "timesteps_total": 51617760, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51617760, "timers": {"training_iteration_time_ms": 4415.099, "sample_time_ms": 4382.225, "load_time_ms": 0.576, "load_throughput": 2082057.086, "learn_time_ms": 31.479, "learn_throughput": 38120.622, "synch_weights_time_ms": 0.769}, "counters": {"num_env_steps_sampled": 51617760, "num_env_steps_trained": 51617760, "num_agent_steps_sampled": 51617760, "num_agent_steps_trained": 51617760}, "done": false, "episodes_total": 12471, "training_iteration": 3913, "trial_id": "9f686_00000", "date": "2023-08-08_15-22-43", "timestamp": 1691497363, "time_this_iter_s": 13.220641851425171, "time_total_s": 93784.89742541313, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 700.7242386341095, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 19.315789473684212, "ram_util_percent": 65.08421052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.7500000000000005e-09, "entropy_coeff": 0.15, "policy_entropy": -363.6842685275608, "policy_loss": -8059624.4375, "vf_loss": 21432741.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2889.5, "diff_num_grad_updates_vs_sampler_policy": 2888.5}}, "num_env_steps_sampled": 51621360, "num_env_steps_trained": 51621360, "num_agent_steps_sampled": 51621360, "num_agent_steps_trained": 51621360}, "sampler_results": {"episode_reward_max": -10120.460325040927, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10310.945920208635, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4269205244771994, "mean_inference_ms": 0.37188297345325894, "mean_action_processing_ms": 0.09117602502935013, "mean_env_wait_ms": 0.7628551873322472, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003462553024291992, "StateBufferConnector_ms": 0.0025835037231445312, "ViewRequirementAgentConnector_ms": 0.06620287895202637}}, "episode_reward_max": -10120.460325040927, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10310.945920208635, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10483.015826422026, -10247.254407850949, -10475.604516580184, -10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4269205244771994, "mean_inference_ms": 0.37188297345325894, "mean_action_processing_ms": 0.09117602502935013, "mean_env_wait_ms": 0.7628551873322472, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003462553024291992, "StateBufferConnector_ms": 0.0025835037231445312, "ViewRequirementAgentConnector_ms": 0.06620287895202637}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51621360, "num_agent_steps_trained": 51621360, "num_env_steps_sampled": 51621360, "num_env_steps_trained": 51621360, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 271.85997827676016, "num_env_steps_trained_throughput_per_sec": 271.85997827676016, "timesteps_total": 51621360, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51621360, "timers": {"training_iteration_time_ms": 4425.772, "sample_time_ms": 4393.001, "load_time_ms": 0.574, "load_throughput": 2088796.813, "learn_time_ms": 31.365, "learn_throughput": 38259.801, "synch_weights_time_ms": 0.783}, "counters": {"num_env_steps_sampled": 51621360, "num_env_steps_trained": 51621360, "num_agent_steps_sampled": 51621360, "num_agent_steps_trained": 51621360}, "done": false, "episodes_total": 12474, "training_iteration": 3914, "trial_id": "9f686_00000", "date": "2023-08-08_15-22-56", "timestamp": 1691497376, "time_this_iter_s": 13.244997024536133, "time_total_s": 93798.14242243767, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 713.9692356586456, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 20.105263157894736, "ram_util_percent": 65.02631578947368}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3e-09, "entropy_coeff": 0.15, "policy_entropy": -365.9638163248698, "policy_loss": -5694653.012152778, "vf_loss": 21019315.388888888}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2943.5, "diff_num_grad_updates_vs_sampler_policy": 2942.5}}, "num_env_steps_sampled": 51624960, "num_env_steps_trained": 51624960, "num_agent_steps_sampled": 51624960, "num_agent_steps_trained": 51624960}, "sampler_results": {"episode_reward_max": -10120.460325040927, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10306.137593966116, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4272368859116753, "mean_inference_ms": 0.3718877227022097, "mean_action_processing_ms": 0.091177343819548, "mean_env_wait_ms": 0.7621145468765448, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003490924835205078, "StateBufferConnector_ms": 0.0025925636291503906, "ViewRequirementAgentConnector_ms": 0.06624364852905273}}, "episode_reward_max": -10120.460325040927, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10306.137593966116, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10388.975520703078, -10350.819709642028, -10257.17576923303, -10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4272368859116753, "mean_inference_ms": 0.3718877227022097, "mean_action_processing_ms": 0.091177343819548, "mean_env_wait_ms": 0.7621145468765448, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003490924835205078, "StateBufferConnector_ms": 0.0025925636291503906, "ViewRequirementAgentConnector_ms": 0.06624364852905273}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51624960, "num_agent_steps_trained": 51624960, "num_env_steps_sampled": 51624960, "num_env_steps_trained": 51624960, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 271.36680119302594, "num_env_steps_trained_throughput_per_sec": 271.36680119302594, "timesteps_total": 51624960, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51624960, "timers": {"training_iteration_time_ms": 4419.644, "sample_time_ms": 4386.95, "load_time_ms": 0.579, "load_throughput": 2071431.723, "learn_time_ms": 31.291, "learn_throughput": 38349.529, "synch_weights_time_ms": 0.773}, "counters": {"num_env_steps_sampled": 51624960, "num_env_steps_trained": 51624960, "num_agent_steps_sampled": 51624960, "num_agent_steps_trained": 51624960}, "done": false, "episodes_total": 12477, "training_iteration": 3915, "trial_id": "9f686_00000", "date": "2023-08-08_15-23-09", "timestamp": 1691497389, "time_this_iter_s": 13.269016742706299, "time_total_s": 93811.41143918037, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 727.2382524013519, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 18.933333333333334, "ram_util_percent": 65.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-09, "entropy_coeff": 0.15, "policy_entropy": -368.5838114420573, "policy_loss": -9427576.617621528, "vf_loss": 21623947.833333332}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2997.5, "diff_num_grad_updates_vs_sampler_policy": 2996.5}}, "num_env_steps_sampled": 51628560, "num_env_steps_trained": 51628560, "num_agent_steps_sampled": 51628560, "num_agent_steps_trained": 51628560}, "sampler_results": {"episode_reward_max": -10120.460325040927, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10304.65232003734, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4275065633200867, "mean_inference_ms": 0.3718909863947061, "mean_action_processing_ms": 0.09117858529868657, "mean_env_wait_ms": 0.7614086674040307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003541231155395508, "StateBufferConnector_ms": 0.0025932788848876953, "ViewRequirementAgentConnector_ms": 0.066253662109375}}, "episode_reward_max": -10120.460325040927, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10304.65232003734, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10387.947277192785, -10333.75925219593, -10295.111221001174, -10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4275065633200867, "mean_inference_ms": 0.3718909863947061, "mean_action_processing_ms": 0.09117858529868657, "mean_env_wait_ms": 0.7614086674040307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003541231155395508, "StateBufferConnector_ms": 0.0025932788848876953, "ViewRequirementAgentConnector_ms": 0.066253662109375}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51628560, "num_agent_steps_trained": 51628560, "num_env_steps_sampled": 51628560, "num_env_steps_trained": 51628560, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 273.76093104169996, "num_env_steps_trained_throughput_per_sec": 273.76093104169996, "timesteps_total": 51628560, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51628560, "timers": {"training_iteration_time_ms": 4403.821, "sample_time_ms": 4371.117, "load_time_ms": 0.578, "load_throughput": 2076388.119, "learn_time_ms": 31.291, "learn_throughput": 38350.201, "synch_weights_time_ms": 0.786}, "counters": {"num_env_steps_sampled": 51628560, "num_env_steps_trained": 51628560, "num_agent_steps_sampled": 51628560, "num_agent_steps_trained": 51628560}, "done": false, "episodes_total": 12480, "training_iteration": 3916, "trial_id": "9f686_00000", "date": "2023-08-08_15-23-22", "timestamp": 1691497402, "time_this_iter_s": 13.153005123138428, "time_total_s": 93824.56444430351, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 740.3912575244904, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 20.142105263157895, "ram_util_percent": 65.1157894736842}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-09, "entropy_coeff": 0.15, "policy_entropy": -362.0849372016059, "policy_loss": -5093268.061631944, "vf_loss": 21352447.111111112}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3051.5, "diff_num_grad_updates_vs_sampler_policy": 3050.5}}, "num_env_steps_sampled": 51632160, "num_env_steps_trained": 51632160, "num_agent_steps_sampled": 51632160, "num_agent_steps_trained": 51632160}, "sampler_results": {"episode_reward_max": -10120.460325040927, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10303.844904974216, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4277223128090535, "mean_inference_ms": 0.3718933854332766, "mean_action_processing_ms": 0.09117975956474983, "mean_env_wait_ms": 0.7607541570281083, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035364627838134766, "StateBufferConnector_ms": 0.0025894641876220703, "ViewRequirementAgentConnector_ms": 0.06624960899353027}}, "episode_reward_max": -10120.460325040927, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10303.844904974216, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10177.941313567913, -10331.837815491439, -10506.216872191348, -10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4277223128090535, "mean_inference_ms": 0.3718933854332766, "mean_action_processing_ms": 0.09117975956474983, "mean_env_wait_ms": 0.7607541570281083, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035364627838134766, "StateBufferConnector_ms": 0.0025894641876220703, "ViewRequirementAgentConnector_ms": 0.06624960899353027}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51632160, "num_agent_steps_trained": 51632160, "num_env_steps_sampled": 51632160, "num_env_steps_trained": 51632160, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 271.5424422100569, "num_env_steps_trained_throughput_per_sec": 271.5424422100569, "timesteps_total": 51632160, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51632160, "timers": {"training_iteration_time_ms": 4406.274, "sample_time_ms": 4373.335, "load_time_ms": 0.582, "load_throughput": 2062434.355, "learn_time_ms": 31.527, "learn_throughput": 38062.792, "synch_weights_time_ms": 0.781}, "counters": {"num_env_steps_sampled": 51632160, "num_env_steps_trained": 51632160, "num_agent_steps_sampled": 51632160, "num_agent_steps_trained": 51632160}, "done": false, "episodes_total": 12483, "training_iteration": 3917, "trial_id": "9f686_00000", "date": "2023-08-08_15-23-36", "timestamp": 1691497416, "time_this_iter_s": 13.26045298576355, "time_total_s": 93837.82489728928, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 753.6517105102539, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 19.86315789473684, "ram_util_percent": 65.09473684210525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-09, "entropy_coeff": 0.15, "policy_entropy": -362.79610019259985, "policy_loss": -8178427.97265625, "vf_loss": 21632282.166666668}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3105.5, "diff_num_grad_updates_vs_sampler_policy": 3104.5}}, "num_env_steps_sampled": 51635760, "num_env_steps_trained": 51635760, "num_agent_steps_sampled": 51635760, "num_agent_steps_trained": 51635760}, "sampler_results": {"episode_reward_max": -10120.460325040927, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10304.836277116461, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.427893040937293, "mean_inference_ms": 0.3718962682791859, "mean_action_processing_ms": 0.09118099554429092, "mean_env_wait_ms": 0.7601327132242913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035398006439208984, "StateBufferConnector_ms": 0.0025815963745117188, "ViewRequirementAgentConnector_ms": 0.06609988212585449}}, "episode_reward_max": -10120.460325040927, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10304.836277116461, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10348.123189782833, -10327.991409570173, -10296.23101438081, -10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.427893040937293, "mean_inference_ms": 0.3718962682791859, "mean_action_processing_ms": 0.09118099554429092, "mean_env_wait_ms": 0.7601327132242913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035398006439208984, "StateBufferConnector_ms": 0.0025815963745117188, "ViewRequirementAgentConnector_ms": 0.06609988212585449}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51635760, "num_agent_steps_trained": 51635760, "num_env_steps_sampled": 51635760, "num_env_steps_trained": 51635760, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 271.0821722100159, "num_env_steps_trained_throughput_per_sec": 271.0821722100159, "timesteps_total": 51635760, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51635760, "timers": {"training_iteration_time_ms": 4407.206, "sample_time_ms": 4374.011, "load_time_ms": 0.587, "load_throughput": 2045918.784, "learn_time_ms": 31.75, "learn_throughput": 37794.95, "synch_weights_time_ms": 0.808}, "counters": {"num_env_steps_sampled": 51635760, "num_env_steps_trained": 51635760, "num_agent_steps_sampled": 51635760, "num_agent_steps_trained": 51635760}, "done": false, "episodes_total": 12486, "training_iteration": 3918, "trial_id": "9f686_00000", "date": "2023-08-08_15-23-49", "timestamp": 1691497429, "time_this_iter_s": 13.283106088638306, "time_total_s": 93851.10800337791, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 766.9348165988922, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 19.610526315789475, "ram_util_percent": 65.32105263157895}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-09, "entropy_coeff": 0.15, "policy_entropy": -361.79329766167535, "policy_loss": -14405492.027777778, "vf_loss": 22349957.722222224}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3159.5, "diff_num_grad_updates_vs_sampler_policy": 3158.5}}, "num_env_steps_sampled": 51639360, "num_env_steps_trained": 51639360, "num_agent_steps_sampled": 51639360, "num_agent_steps_trained": 51639360}, "sampler_results": {"episode_reward_max": -10120.460325040927, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10306.692148764478, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4280265183871537, "mean_inference_ms": 0.37189997940910124, "mean_action_processing_ms": 0.09118208439307686, "mean_env_wait_ms": 0.7595479100008792, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035407543182373047, "StateBufferConnector_ms": 0.002580404281616211, "ViewRequirementAgentConnector_ms": 0.06607437133789062}}, "episode_reward_max": -10120.460325040927, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10306.692148764478, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10258.754087368023, -10404.760604382835, -10271.6784292461, -10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4280265183871537, "mean_inference_ms": 0.37189997940910124, "mean_action_processing_ms": 0.09118208439307686, "mean_env_wait_ms": 0.7595479100008792, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035407543182373047, "StateBufferConnector_ms": 0.002580404281616211, "ViewRequirementAgentConnector_ms": 0.06607437133789062}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51639360, "num_agent_steps_trained": 51639360, "num_env_steps_sampled": 51639360, "num_env_steps_trained": 51639360, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 269.87355821702687, "num_env_steps_trained_throughput_per_sec": 269.87355821702687, "timesteps_total": 51639360, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51639360, "timers": {"training_iteration_time_ms": 4432.483, "sample_time_ms": 4399.392, "load_time_ms": 0.579, "load_throughput": 2073223.545, "learn_time_ms": 31.659, "learn_throughput": 37903.934, "synch_weights_time_ms": 0.802}, "counters": {"num_env_steps_sampled": 51639360, "num_env_steps_trained": 51639360, "num_agent_steps_sampled": 51639360, "num_agent_steps_trained": 51639360}, "done": false, "episodes_total": 12489, "training_iteration": 3919, "trial_id": "9f686_00000", "date": "2023-08-08_15-24-02", "timestamp": 1691497442, "time_this_iter_s": 13.34259295463562, "time_total_s": 93864.45059633255, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 780.2774095535278, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 19.53684210526316, "ram_util_percent": 65.39999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-09, "entropy_coeff": 0.15, "policy_entropy": -361.90093994140625, "policy_loss": -4465068.564236111, "vf_loss": 21165933.055555556}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3213.5, "diff_num_grad_updates_vs_sampler_policy": 3212.5}}, "num_env_steps_sampled": 51642960, "num_env_steps_trained": 51642960, "num_agent_steps_sampled": 51642960, "num_agent_steps_trained": 51642960}, "sampler_results": {"episode_reward_max": -10120.460325040927, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10305.842042925959, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4281437661752214, "mean_inference_ms": 0.37190204505688124, "mean_action_processing_ms": 0.0911830746099291, "mean_env_wait_ms": 0.7589929003671414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035262107849121094, "StateBufferConnector_ms": 0.0025787353515625, "ViewRequirementAgentConnector_ms": 0.06612873077392578}}, "episode_reward_max": -10120.460325040927, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10305.842042925959, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10255.97276288405, -10302.45348394707, -10357.136525096437, -10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4281437661752214, "mean_inference_ms": 0.37190204505688124, "mean_action_processing_ms": 0.0911830746099291, "mean_env_wait_ms": 0.7589929003671414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035262107849121094, "StateBufferConnector_ms": 0.0025787353515625, "ViewRequirementAgentConnector_ms": 0.06612873077392578}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51642960, "num_agent_steps_trained": 51642960, "num_env_steps_sampled": 51642960, "num_env_steps_trained": 51642960, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 271.4222442794633, "num_env_steps_trained_throughput_per_sec": 271.4222442794633, "timesteps_total": 51642960, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51642960, "timers": {"training_iteration_time_ms": 4430.75, "sample_time_ms": 4397.476, "load_time_ms": 0.574, "load_throughput": 2088796.813, "learn_time_ms": 31.824, "learn_throughput": 37707.315, "synch_weights_time_ms": 0.824}, "counters": {"num_env_steps_sampled": 51642960, "num_env_steps_trained": 51642960, "num_agent_steps_sampled": 51642960, "num_agent_steps_trained": 51642960}, "done": false, "episodes_total": 12492, "training_iteration": 3920, "trial_id": "9f686_00000", "date": "2023-08-08_15-24-16", "timestamp": 1691497456, "time_this_iter_s": 13.26650071144104, "time_total_s": 93877.71709704399, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 793.5439102649689, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 18.86111111111111, "ram_util_percent": 65.14999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-09, "entropy_coeff": 0.15, "policy_entropy": -362.82447645399304, "policy_loss": -7125166.888888889, "vf_loss": 21519966.277777776}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3267.5, "diff_num_grad_updates_vs_sampler_policy": 3266.5}}, "num_env_steps_sampled": 51646560, "num_env_steps_trained": 51646560, "num_agent_steps_sampled": 51646560, "num_agent_steps_trained": 51646560}, "sampler_results": {"episode_reward_max": -10120.460325040927, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10306.901561740118, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428249379428372, "mean_inference_ms": 0.3719032085847322, "mean_action_processing_ms": 0.0911839388534281, "mean_env_wait_ms": 0.7584501984914988, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035266876220703125, "StateBufferConnector_ms": 0.002574920654296875, "ViewRequirementAgentConnector_ms": 0.06615805625915527}}, "episode_reward_max": -10120.460325040927, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10306.901561740118, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10384.1695961815, -10291.027973683633, -10232.43834406433, -10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428249379428372, "mean_inference_ms": 0.3719032085847322, "mean_action_processing_ms": 0.0911839388534281, "mean_env_wait_ms": 0.7584501984914988, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035266876220703125, "StateBufferConnector_ms": 0.002574920654296875, "ViewRequirementAgentConnector_ms": 0.06615805625915527}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51646560, "num_agent_steps_trained": 51646560, "num_env_steps_sampled": 51646560, "num_env_steps_trained": 51646560, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 272.2500739968024, "num_env_steps_trained_throughput_per_sec": 272.2500739968024, "timesteps_total": 51646560, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51646560, "timers": {"training_iteration_time_ms": 4423.358, "sample_time_ms": 4390.37, "load_time_ms": 0.576, "load_throughput": 2083694.804, "learn_time_ms": 31.555, "learn_throughput": 38028.655, "synch_weights_time_ms": 0.806}, "counters": {"num_env_steps_sampled": 51646560, "num_env_steps_trained": 51646560, "num_agent_steps_sampled": 51646560, "num_agent_steps_trained": 51646560}, "done": false, "episodes_total": 12495, "training_iteration": 3921, "trial_id": "9f686_00000", "date": "2023-08-08_15-24-29", "timestamp": 1691497469, "time_this_iter_s": 13.22608470916748, "time_total_s": 93890.94318175316, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 806.7699949741364, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 19.894736842105264, "ram_util_percent": 65.02105263157895}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5000000000000005e-09, "entropy_coeff": 0.15, "policy_entropy": -363.11692979600696, "policy_loss": -9981915.423611112, "vf_loss": 22266478.833333332}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3321.5, "diff_num_grad_updates_vs_sampler_policy": 3320.5}}, "num_env_steps_sampled": 51650160, "num_env_steps_trained": 51650160, "num_agent_steps_sampled": 51650160, "num_agent_steps_trained": 51650160}, "sampler_results": {"episode_reward_max": -10120.460325040927, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10306.682727370593, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428356644523183, "mean_inference_ms": 0.3719042610082854, "mean_action_processing_ms": 0.09118472541412347, "mean_env_wait_ms": 0.7579278778547425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035238265991210938, "StateBufferConnector_ms": 0.0025739669799804688, "ViewRequirementAgentConnector_ms": 0.0661461353302002}}, "episode_reward_max": -10120.460325040927, "episode_reward_min": -10511.438262251953, "episode_reward_mean": -10306.682727370593, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10273.60508397145, -10381.582300798584, -10511.438262251953, -10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428356644523183, "mean_inference_ms": 0.3719042610082854, "mean_action_processing_ms": 0.09118472541412347, "mean_env_wait_ms": 0.7579278778547425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035238265991210938, "StateBufferConnector_ms": 0.0025739669799804688, "ViewRequirementAgentConnector_ms": 0.0661461353302002}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51650160, "num_agent_steps_trained": 51650160, "num_env_steps_sampled": 51650160, "num_env_steps_trained": 51650160, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 272.1903128982888, "num_env_steps_trained_throughput_per_sec": 272.1903128982888, "timesteps_total": 51650160, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51650160, "timers": {"training_iteration_time_ms": 4414.171, "sample_time_ms": 4381.276, "load_time_ms": 0.572, "load_throughput": 2097414.177, "learn_time_ms": 31.5, "learn_throughput": 38094.943, "synch_weights_time_ms": 0.773}, "counters": {"num_env_steps_sampled": 51650160, "num_env_steps_trained": 51650160, "num_agent_steps_sampled": 51650160, "num_agent_steps_trained": 51650160}, "done": false, "episodes_total": 12498, "training_iteration": 3922, "trial_id": "9f686_00000", "date": "2023-08-08_15-24-42", "timestamp": 1691497482, "time_this_iter_s": 13.229070663452148, "time_total_s": 93904.17225241661, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 819.9990656375885, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 18.594736842105263, "ram_util_percent": 64.94210526315788}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.05e-09, "entropy_coeff": 0.15, "policy_entropy": -363.21962483723956, "policy_loss": -14149398.539930556, "vf_loss": 22002928.305555556}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3375.5, "diff_num_grad_updates_vs_sampler_policy": 3374.5}}, "num_env_steps_sampled": 51653760, "num_env_steps_trained": 51653760, "num_agent_steps_sampled": 51653760, "num_agent_steps_trained": 51653760}, "sampler_results": {"episode_reward_max": -10120.460325040927, "episode_reward_min": -10509.679485939503, "episode_reward_mean": -10305.772621895258, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4284508063931534, "mean_inference_ms": 0.37190593424249807, "mean_action_processing_ms": 0.09118554094986374, "mean_env_wait_ms": 0.7574327504232072, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003517627716064453, "StateBufferConnector_ms": 0.0025739669799804688, "ViewRequirementAgentConnector_ms": 0.06614398956298828}}, "episode_reward_max": -10120.460325040927, "episode_reward_min": -10509.679485939503, "episode_reward_mean": -10305.772621895258, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10138.422643509588, -10221.591173206472, -10424.395346655907, -10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4284508063931534, "mean_inference_ms": 0.37190593424249807, "mean_action_processing_ms": 0.09118554094986374, "mean_env_wait_ms": 0.7574327504232072, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003517627716064453, "StateBufferConnector_ms": 0.0025739669799804688, "ViewRequirementAgentConnector_ms": 0.06614398956298828}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51653760, "num_agent_steps_trained": 51653760, "num_env_steps_sampled": 51653760, "num_env_steps_trained": 51653760, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 271.471691925766, "num_env_steps_trained_throughput_per_sec": 271.471691925766, "timesteps_total": 51653760, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51653760, "timers": {"training_iteration_time_ms": 4407.796, "sample_time_ms": 4374.912, "load_time_ms": 0.572, "load_throughput": 2096365.863, "learn_time_ms": 31.483, "learn_throughput": 38115.628, "synch_weights_time_ms": 0.779}, "counters": {"num_env_steps_sampled": 51653760, "num_env_steps_trained": 51653760, "num_agent_steps_sampled": 51653760, "num_agent_steps_trained": 51653760}, "done": false, "episodes_total": 12501, "training_iteration": 3923, "trial_id": "9f686_00000", "date": "2023-08-08_15-24-55", "timestamp": 1691497495, "time_this_iter_s": 13.263832092285156, "time_total_s": 93917.4360845089, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 833.2628977298737, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 19.857894736842105, "ram_util_percent": 65.00526315789473}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.3750000000000001e-09, "entropy_coeff": 0.15, "policy_entropy": -362.2301720513238, "policy_loss": -5885865.544270833, "vf_loss": 21694461.777777776}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3429.5, "diff_num_grad_updates_vs_sampler_policy": 3428.5}}, "num_env_steps_sampled": 51657360, "num_env_steps_trained": 51657360, "num_agent_steps_sampled": 51657360, "num_agent_steps_trained": 51657360}, "sampler_results": {"episode_reward_max": -10120.460325040927, "episode_reward_min": -10509.679485939503, "episode_reward_mean": -10307.59089010179, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428515067185126, "mean_inference_ms": 0.3719091939482626, "mean_action_processing_ms": 0.09118661128062701, "mean_env_wait_ms": 0.7569563918588338, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035190582275390625, "StateBufferConnector_ms": 0.0025665760040283203, "ViewRequirementAgentConnector_ms": 0.06612634658813477}}, "episode_reward_max": -10120.460325040927, "episode_reward_min": -10509.679485939503, "episode_reward_mean": -10307.59089010179, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10380.529307596613, -10389.46239989379, -10141.407928793014, -10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428515067185126, "mean_inference_ms": 0.3719091939482626, "mean_action_processing_ms": 0.09118661128062701, "mean_env_wait_ms": 0.7569563918588338, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035190582275390625, "StateBufferConnector_ms": 0.0025665760040283203, "ViewRequirementAgentConnector_ms": 0.06612634658813477}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51657360, "num_agent_steps_trained": 51657360, "num_env_steps_sampled": 51657360, "num_env_steps_trained": 51657360, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 273.6578946104535, "num_env_steps_trained_throughput_per_sec": 273.6578946104535, "timesteps_total": 51657360, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51657360, "timers": {"training_iteration_time_ms": 4406.203, "sample_time_ms": 4373.26, "load_time_ms": 0.571, "load_throughput": 2103374.483, "learn_time_ms": 31.548, "learn_throughput": 38037.766, "synch_weights_time_ms": 0.776}, "counters": {"num_env_steps_sampled": 51657360, "num_env_steps_trained": 51657360, "num_agent_steps_sampled": 51657360, "num_agent_steps_trained": 51657360}, "done": false, "episodes_total": 12504, "training_iteration": 3924, "trial_id": "9f686_00000", "date": "2023-08-08_15-25-09", "timestamp": 1691497509, "time_this_iter_s": 13.158200025558472, "time_total_s": 93930.59428453445, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 846.4210977554321, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 21.916666666666668, "ram_util_percent": 65.03888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.000000000000001e-10, "entropy_coeff": 0.15, "policy_entropy": -365.3842129177517, "policy_loss": -5668726.1640625, "vf_loss": 21562173.388888888}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3483.5, "diff_num_grad_updates_vs_sampler_policy": 3482.5}}, "num_env_steps_sampled": 51660960, "num_env_steps_trained": 51660960, "num_agent_steps_sampled": 51660960, "num_agent_steps_trained": 51660960}, "sampler_results": {"episode_reward_max": -10120.460325040927, "episode_reward_min": -10509.679485939503, "episode_reward_mean": -10308.412548076218, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4285549589555, "mean_inference_ms": 0.37191344496951145, "mean_action_processing_ms": 0.09118786089782394, "mean_env_wait_ms": 0.7565007463408969, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003509044647216797, "StateBufferConnector_ms": 0.0025663375854492188, "ViewRequirementAgentConnector_ms": 0.0661470890045166}}, "episode_reward_max": -10120.460325040927, "episode_reward_min": -10509.679485939503, "episode_reward_mean": -10308.412548076218, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10323.287952895007, -10297.5999245946, -10282.137945258039, -10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4285549589555, "mean_inference_ms": 0.37191344496951145, "mean_action_processing_ms": 0.09118786089782394, "mean_env_wait_ms": 0.7565007463408969, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003509044647216797, "StateBufferConnector_ms": 0.0025663375854492188, "ViewRequirementAgentConnector_ms": 0.0661470890045166}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51660960, "num_agent_steps_trained": 51660960, "num_env_steps_sampled": 51660960, "num_env_steps_trained": 51660960, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 272.53788028858287, "num_env_steps_trained_throughput_per_sec": 272.53788028858287, "timesteps_total": 51660960, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51660960, "timers": {"training_iteration_time_ms": 4411.987, "sample_time_ms": 4378.843, "load_time_ms": 0.58, "load_throughput": 2070749.938, "learn_time_ms": 31.726, "learn_throughput": 37824.461, "synch_weights_time_ms": 0.79}, "counters": {"num_env_steps_sampled": 51660960, "num_env_steps_trained": 51660960, "num_agent_steps_sampled": 51660960, "num_agent_steps_trained": 51660960}, "done": false, "episodes_total": 12507, "training_iteration": 3925, "trial_id": "9f686_00000", "date": "2023-08-08_15-25-22", "timestamp": 1691497522, "time_this_iter_s": 13.212198972702026, "time_total_s": 93943.80648350716, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 859.6332967281342, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 19.678947368421053, "ram_util_percent": 65.09473684210526}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.35e-10, "entropy_coeff": 0.15, "policy_entropy": -361.8851504855686, "policy_loss": -8760264.924045138, "vf_loss": 21719352.194444444}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3537.5, "diff_num_grad_updates_vs_sampler_policy": 3536.5}}, "num_env_steps_sampled": 51664560, "num_env_steps_trained": 51664560, "num_agent_steps_sampled": 51664560, "num_agent_steps_trained": 51664560}, "sampler_results": {"episode_reward_max": -10120.460325040927, "episode_reward_min": -10509.679485939503, "episode_reward_mean": -10308.640045800777, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4285747193946254, "mean_inference_ms": 0.371917436633248, "mean_action_processing_ms": 0.0911889212903187, "mean_env_wait_ms": 0.7560693555054716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035102367401123047, "StateBufferConnector_ms": 0.0025680065155029297, "ViewRequirementAgentConnector_ms": 0.06615519523620605}}, "episode_reward_max": -10120.460325040927, "episode_reward_min": -10509.679485939503, "episode_reward_mean": -10308.640045800777, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10242.29966221101, -10295.645972532931, -10280.938717504978, -10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4285747193946254, "mean_inference_ms": 0.371917436633248, "mean_action_processing_ms": 0.0911889212903187, "mean_env_wait_ms": 0.7560693555054716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035102367401123047, "StateBufferConnector_ms": 0.0025680065155029297, "ViewRequirementAgentConnector_ms": 0.06615519523620605}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51664560, "num_agent_steps_trained": 51664560, "num_env_steps_sampled": 51664560, "num_env_steps_trained": 51664560, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 271.4413760834379, "num_env_steps_trained_throughput_per_sec": 271.4413760834379, "timesteps_total": 51664560, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51664560, "timers": {"training_iteration_time_ms": 4407.225, "sample_time_ms": 4374.091, "load_time_ms": 0.58, "load_throughput": 2070749.938, "learn_time_ms": 31.736, "learn_throughput": 37812.128, "synch_weights_time_ms": 0.769}, "counters": {"num_env_steps_sampled": 51664560, "num_env_steps_trained": 51664560, "num_agent_steps_sampled": 51664560, "num_agent_steps_trained": 51664560}, "done": false, "episodes_total": 12510, "training_iteration": 3926, "trial_id": "9f686_00000", "date": "2023-08-08_15-25-35", "timestamp": 1691497535, "time_this_iter_s": 13.26545524597168, "time_total_s": 93957.07193875313, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 872.8987519741058, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 20.757894736842108, "ram_util_percent": 65.16315789473686}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.9000000000000002e-10, "entropy_coeff": 0.15, "policy_entropy": -363.6881510416667, "policy_loss": -11442006.795138888, "vf_loss": 21600200.111111112}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3591.5, "diff_num_grad_updates_vs_sampler_policy": 3590.5}}, "num_env_steps_sampled": 51668160, "num_env_steps_trained": 51668160, "num_agent_steps_sampled": 51668160, "num_agent_steps_trained": 51668160}, "sampler_results": {"episode_reward_max": -10120.460325040927, "episode_reward_min": -10509.679485939503, "episode_reward_mean": -10308.246975879005, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428569856975004, "mean_inference_ms": 0.371921324913848, "mean_action_processing_ms": 0.09119002849193471, "mean_env_wait_ms": 0.7556613355087317, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035009384155273438, "StateBufferConnector_ms": 0.0025701522827148438, "ViewRequirementAgentConnector_ms": 0.0660712718963623}}, "episode_reward_max": -10120.460325040927, "episode_reward_min": -10509.679485939503, "episode_reward_mean": -10308.246975879005, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10291.753263349485, -10270.371044388432, -10357.836469502858, -10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428569856975004, "mean_inference_ms": 0.371921324913848, "mean_action_processing_ms": 0.09119002849193471, "mean_env_wait_ms": 0.7556613355087317, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035009384155273438, "StateBufferConnector_ms": 0.0025701522827148438, "ViewRequirementAgentConnector_ms": 0.0660712718963623}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51668160, "num_agent_steps_trained": 51668160, "num_env_steps_sampled": 51668160, "num_env_steps_trained": 51668160, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 271.6274234946988, "num_env_steps_trained_throughput_per_sec": 271.6274234946988, "timesteps_total": 51668160, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51668160, "timers": {"training_iteration_time_ms": 4421.069, "sample_time_ms": 4387.902, "load_time_ms": 0.578, "load_throughput": 2075446.291, "learn_time_ms": 31.767, "learn_throughput": 37774.64, "synch_weights_time_ms": 0.771}, "counters": {"num_env_steps_sampled": 51668160, "num_env_steps_trained": 51668160, "num_agent_steps_sampled": 51668160, "num_agent_steps_trained": 51668160}, "done": false, "episodes_total": 12513, "training_iteration": 3927, "trial_id": "9f686_00000", "date": "2023-08-08_15-25-48", "timestamp": 1691497548, "time_this_iter_s": 13.256279945373535, "time_total_s": 93970.3282186985, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 886.1550319194794, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 19.415789473684214, "ram_util_percent": 65.32105263157895}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.45e-10, "entropy_coeff": 0.15, "policy_entropy": -361.9133809407552, "policy_loss": -7383411.079861111, "vf_loss": 21980860.722222224}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3645.5, "diff_num_grad_updates_vs_sampler_policy": 3644.5}}, "num_env_steps_sampled": 51671760, "num_env_steps_trained": 51671760, "num_agent_steps_sampled": 51671760, "num_agent_steps_trained": 51671760}, "sampler_results": {"episode_reward_max": -10120.460325040927, "episode_reward_min": -10509.679485939503, "episode_reward_mean": -10308.618512974463, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4285433054856544, "mean_inference_ms": 0.3719248244317302, "mean_action_processing_ms": 0.09119099050414264, "mean_env_wait_ms": 0.7552709515935051, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035004615783691406, "StateBufferConnector_ms": 0.002562284469604492, "ViewRequirementAgentConnector_ms": 0.06606912612915039}}, "episode_reward_max": -10120.460325040927, "episode_reward_min": -10509.679485939503, "episode_reward_mean": -10308.618512974463, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10185.205530312367, -10258.891505879044, -10329.472805262516, -10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4285433054856544, "mean_inference_ms": 0.3719248244317302, "mean_action_processing_ms": 0.09119099050414264, "mean_env_wait_ms": 0.7552709515935051, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035004615783691406, "StateBufferConnector_ms": 0.002562284469604492, "ViewRequirementAgentConnector_ms": 0.06606912612915039}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51671760, "num_agent_steps_trained": 51671760, "num_env_steps_sampled": 51671760, "num_env_steps_trained": 51671760, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 272.69733970322676, "num_env_steps_trained_throughput_per_sec": 272.69733970322676, "timesteps_total": 51671760, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51671760, "timers": {"training_iteration_time_ms": 4408.633, "sample_time_ms": 4375.47, "load_time_ms": 0.569, "load_throughput": 2108043.558, "learn_time_ms": 31.787, "learn_throughput": 37751.237, "synch_weights_time_ms": 0.758}, "counters": {"num_env_steps_sampled": 51671760, "num_env_steps_trained": 51671760, "num_agent_steps_sampled": 51671760, "num_agent_steps_trained": 51671760}, "done": false, "episodes_total": 12516, "training_iteration": 3928, "trial_id": "9f686_00000", "date": "2023-08-08_15-26-02", "timestamp": 1691497562, "time_this_iter_s": 13.20441198348999, "time_total_s": 93983.53263068199, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 899.3594439029694, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 18.415789473684214, "ram_util_percent": 65.36842105263156}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-10, "entropy_coeff": 0.15, "policy_entropy": -364.96577792697485, "policy_loss": -2656090.78125, "vf_loss": 21301504.666666668}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3699.5, "diff_num_grad_updates_vs_sampler_policy": 3698.5}}, "num_env_steps_sampled": 51675360, "num_env_steps_trained": 51675360, "num_agent_steps_sampled": 51675360, "num_agent_steps_trained": 51675360}, "sampler_results": {"episode_reward_max": -10120.460325040927, "episode_reward_min": -10509.679485939503, "episode_reward_mean": -10310.634848083882, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4285118447444187, "mean_inference_ms": 0.37192834022193255, "mean_action_processing_ms": 0.09119184109535355, "mean_env_wait_ms": 0.7549030717664112, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035109519958496094, "StateBufferConnector_ms": 0.0025637149810791016, "ViewRequirementAgentConnector_ms": 0.06612157821655273}}, "episode_reward_max": -10120.460325040927, "episode_reward_min": -10509.679485939503, "episode_reward_mean": -10310.634848083882, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10278.852743403986, -10347.96462335599, -10253.191658870752, -10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4285118447444187, "mean_inference_ms": 0.37192834022193255, "mean_action_processing_ms": 0.09119184109535355, "mean_env_wait_ms": 0.7549030717664112, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035109519958496094, "StateBufferConnector_ms": 0.0025637149810791016, "ViewRequirementAgentConnector_ms": 0.06612157821655273}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51675360, "num_agent_steps_trained": 51675360, "num_env_steps_sampled": 51675360, "num_env_steps_trained": 51675360, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 271.7895369908406, "num_env_steps_trained_throughput_per_sec": 271.7895369908406, "timesteps_total": 51675360, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51675360, "timers": {"training_iteration_time_ms": 4409.672, "sample_time_ms": 4376.54, "load_time_ms": 0.568, "load_throughput": 2111758.328, "learn_time_ms": 31.752, "learn_throughput": 37793.219, "synch_weights_time_ms": 0.763}, "counters": {"num_env_steps_sampled": 51675360, "num_env_steps_trained": 51675360, "num_agent_steps_sampled": 51675360, "num_agent_steps_trained": 51675360}, "done": false, "episodes_total": 12519, "training_iteration": 3929, "trial_id": "9f686_00000", "date": "2023-08-08_15-26-15", "timestamp": 1691497575, "time_this_iter_s": 13.248510122299194, "time_total_s": 93996.78114080429, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 912.6079540252686, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 19.294444444444444, "ram_util_percent": 65.28888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-10, "entropy_coeff": 0.15, "policy_entropy": -364.93629964192706, "policy_loss": -8630490.413194444, "vf_loss": 21576654.666666668}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3753.5, "diff_num_grad_updates_vs_sampler_policy": 3752.5}}, "num_env_steps_sampled": 51678960, "num_env_steps_trained": 51678960, "num_agent_steps_sampled": 51678960, "num_agent_steps_trained": 51678960}, "sampler_results": {"episode_reward_max": -10120.460325040927, "episode_reward_min": -10509.679485939503, "episode_reward_mean": -10310.97370704201, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428467858560966, "mean_inference_ms": 0.371932409700807, "mean_action_processing_ms": 0.09119278230243308, "mean_env_wait_ms": 0.7545468200314754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035092830657958984, "StateBufferConnector_ms": 0.002564668655395508, "ViewRequirementAgentConnector_ms": 0.06608915328979492}}, "episode_reward_max": -10120.460325040927, "episode_reward_min": -10509.679485939503, "episode_reward_mean": -10310.97370704201, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10432.79203911965, -10305.648884991751, -10280.751659994145, -10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428467858560966, "mean_inference_ms": 0.371932409700807, "mean_action_processing_ms": 0.09119278230243308, "mean_env_wait_ms": 0.7545468200314754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035092830657958984, "StateBufferConnector_ms": 0.002564668655395508, "ViewRequirementAgentConnector_ms": 0.06608915328979492}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51678960, "num_agent_steps_trained": 51678960, "num_env_steps_sampled": 51678960, "num_env_steps_trained": 51678960, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 272.0760855438018, "num_env_steps_trained_throughput_per_sec": 272.0760855438018, "timesteps_total": 51678960, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51678960, "timers": {"training_iteration_time_ms": 4408.528, "sample_time_ms": 4375.301, "load_time_ms": 0.57, "load_throughput": 2105926.695, "learn_time_ms": 31.835, "learn_throughput": 37694.635, "synch_weights_time_ms": 0.773}, "counters": {"num_env_steps_sampled": 51678960, "num_env_steps_trained": 51678960, "num_agent_steps_sampled": 51678960, "num_agent_steps_trained": 51678960}, "done": false, "episodes_total": 12522, "training_iteration": 3930, "trial_id": "9f686_00000", "date": "2023-08-08_15-26-28", "timestamp": 1691497588, "time_this_iter_s": 13.23444676399231, "time_total_s": 94010.01558756828, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 925.8424007892609, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 19.210526315789473, "ram_util_percent": 64.99473684210525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-10, "entropy_coeff": 0.15, "policy_entropy": -365.0770433213976, "policy_loss": -10279025.499131944, "vf_loss": 21445168.888888888}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3807.5, "diff_num_grad_updates_vs_sampler_policy": 3806.5}}, "num_env_steps_sampled": 51682560, "num_env_steps_trained": 51682560, "num_agent_steps_sampled": 51682560, "num_agent_steps_trained": 51682560}, "sampler_results": {"episode_reward_max": -10119.054446528804, "episode_reward_min": -10509.679485939503, "episode_reward_mean": -10308.229831184812, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428421460010574, "mean_inference_ms": 0.37193595753736547, "mean_action_processing_ms": 0.09119373270106537, "mean_env_wait_ms": 0.754193179155557, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003536701202392578, "StateBufferConnector_ms": 0.0025730133056640625, "ViewRequirementAgentConnector_ms": 0.06615638732910156}}, "episode_reward_max": -10119.054446528804, "episode_reward_min": -10509.679485939503, "episode_reward_mean": -10308.229831184812, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10285.433005689452, -10276.757342737304, -10187.354864162848, -10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428421460010574, "mean_inference_ms": 0.37193595753736547, "mean_action_processing_ms": 0.09119373270106537, "mean_env_wait_ms": 0.754193179155557, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003536701202392578, "StateBufferConnector_ms": 0.0025730133056640625, "ViewRequirementAgentConnector_ms": 0.06615638732910156}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51682560, "num_agent_steps_trained": 51682560, "num_env_steps_sampled": 51682560, "num_env_steps_trained": 51682560, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 273.0871472149794, "num_env_steps_trained_throughput_per_sec": 273.0871472149794, "timesteps_total": 51682560, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51682560, "timers": {"training_iteration_time_ms": 4405.072, "sample_time_ms": 4371.888, "load_time_ms": 0.57, "load_throughput": 2105486.216, "learn_time_ms": 31.8, "learn_throughput": 37735.925, "synch_weights_time_ms": 0.765}, "counters": {"num_env_steps_sampled": 51682560, "num_env_steps_trained": 51682560, "num_agent_steps_sampled": 51682560, "num_agent_steps_trained": 51682560}, "done": false, "episodes_total": 12525, "training_iteration": 3931, "trial_id": "9f686_00000", "date": "2023-08-08_15-26-41", "timestamp": 1691497601, "time_this_iter_s": 13.185538053512573, "time_total_s": 94023.2011256218, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 939.0279388427734, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 19.65789473684211, "ram_util_percent": 64.97894736842106}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-10, "entropy_coeff": 0.15, "policy_entropy": -362.48380364312067, "policy_loss": -18905503.735243056, "vf_loss": 22429331.166666668}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3861.5, "diff_num_grad_updates_vs_sampler_policy": 3860.5}}, "num_env_steps_sampled": 51686160, "num_env_steps_trained": 51686160, "num_agent_steps_sampled": 51686160, "num_agent_steps_trained": 51686160}, "sampler_results": {"episode_reward_max": -10119.054446528804, "episode_reward_min": -10509.679485939503, "episode_reward_mean": -10312.963544320985, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4283830964279223, "mean_inference_ms": 0.37193970466524734, "mean_action_processing_ms": 0.09119461156529818, "mean_env_wait_ms": 0.7538739858054799, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035347938537597656, "StateBufferConnector_ms": 0.0025603771209716797, "ViewRequirementAgentConnector_ms": 0.06605887413024902}}, "episode_reward_max": -10119.054446528804, "episode_reward_min": -10509.679485939503, "episode_reward_mean": -10312.963544320985, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10326.72263390595, -10378.233023360328, -10120.460325040927, -10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4283830964279223, "mean_inference_ms": 0.37193970466524734, "mean_action_processing_ms": 0.09119461156529818, "mean_env_wait_ms": 0.7538739858054799, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035347938537597656, "StateBufferConnector_ms": 0.0025603771209716797, "ViewRequirementAgentConnector_ms": 0.06605887413024902}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51686160, "num_agent_steps_trained": 51686160, "num_env_steps_sampled": 51686160, "num_env_steps_trained": 51686160, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 269.94805775165355, "num_env_steps_trained_throughput_per_sec": 269.94805775165355, "timesteps_total": 51686160, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51686160, "timers": {"training_iteration_time_ms": 4415.947, "sample_time_ms": 4382.761, "load_time_ms": 0.572, "load_throughput": 2096627.843, "learn_time_ms": 31.777, "learn_throughput": 37763.247, "synch_weights_time_ms": 0.788}, "counters": {"num_env_steps_sampled": 51686160, "num_env_steps_trained": 51686160, "num_agent_steps_sampled": 51686160, "num_agent_steps_trained": 51686160}, "done": false, "episodes_total": 12528, "training_iteration": 3932, "trial_id": "9f686_00000", "date": "2023-08-08_15-26-55", "timestamp": 1691497615, "time_this_iter_s": 13.338708877563477, "time_total_s": 94036.53983449936, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 952.3666477203369, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 19.83684210526316, "ram_util_percent": 64.93157894736842}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-10, "entropy_coeff": 0.15, "policy_entropy": -363.4748229980469, "policy_loss": -9012554.288628472, "vf_loss": 21476807.166666668}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3915.5, "diff_num_grad_updates_vs_sampler_policy": 3914.5}}, "num_env_steps_sampled": 51689760, "num_env_steps_trained": 51689760, "num_agent_steps_sampled": 51689760, "num_agent_steps_trained": 51689760}, "sampler_results": {"episode_reward_max": -10119.054446528804, "episode_reward_min": -10509.679485939503, "episode_reward_mean": -10311.376208368834, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4283599508342455, "mean_inference_ms": 0.3719440924028545, "mean_action_processing_ms": 0.09119558187217336, "mean_env_wait_ms": 0.7535751497298148, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035333633422851562, "StateBufferConnector_ms": 0.0025408267974853516, "ViewRequirementAgentConnector_ms": 0.06604671478271484}}, "episode_reward_max": -10119.054446528804, "episode_reward_min": -10509.679485939503, "episode_reward_mean": -10311.376208368834, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10230.244635244357, -10390.918730081461, -10306.103096113806, -10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4283599508342455, "mean_inference_ms": 0.3719440924028545, "mean_action_processing_ms": 0.09119558187217336, "mean_env_wait_ms": 0.7535751497298148, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035333633422851562, "StateBufferConnector_ms": 0.0025408267974853516, "ViewRequirementAgentConnector_ms": 0.06604671478271484}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51689760, "num_agent_steps_trained": 51689760, "num_env_steps_sampled": 51689760, "num_env_steps_trained": 51689760, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 273.22232077454134, "num_env_steps_trained_throughput_per_sec": 273.22232077454134, "timesteps_total": 51689760, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51689760, "timers": {"training_iteration_time_ms": 4415.902, "sample_time_ms": 4383.058, "load_time_ms": 0.572, "load_throughput": 2098201.101, "learn_time_ms": 31.454, "learn_throughput": 38150.643, "synch_weights_time_ms": 0.768}, "counters": {"num_env_steps_sampled": 51689760, "num_env_steps_trained": 51689760, "num_agent_steps_sampled": 51689760, "num_agent_steps_trained": 51689760}, "done": false, "episodes_total": 12531, "training_iteration": 3933, "trial_id": "9f686_00000", "date": "2023-08-08_15-27-08", "timestamp": 1691497628, "time_this_iter_s": 13.178776025772095, "time_total_s": 94049.71861052513, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 965.545423746109, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 19.022222222222226, "ram_util_percent": 64.96666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-10, "entropy_coeff": 0.15, "policy_entropy": -364.86292521158856, "policy_loss": -8886324.036458334, "vf_loss": 21542875.138888888}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3969.5, "diff_num_grad_updates_vs_sampler_policy": 3968.5}}, "num_env_steps_sampled": 51693360, "num_env_steps_trained": 51693360, "num_agent_steps_sampled": 51693360, "num_agent_steps_trained": 51693360}, "sampler_results": {"episode_reward_max": -10119.054446528804, "episode_reward_min": -10509.679485939503, "episode_reward_mean": -10310.89555780679, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.42833484697622, "mean_inference_ms": 0.37194939881772343, "mean_action_processing_ms": 0.09119672639954159, "mean_env_wait_ms": 0.753273646897608, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035338401794433594, "StateBufferConnector_ms": 0.002543926239013672, "ViewRequirementAgentConnector_ms": 0.06598782539367676}}, "episode_reward_max": -10119.054446528804, "episode_reward_min": -10509.679485939503, "episode_reward_mean": -10310.89555780679, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10399.395992932261, -10307.714618055725, -10280.765796134416, -10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.42833484697622, "mean_inference_ms": 0.37194939881772343, "mean_action_processing_ms": 0.09119672639954159, "mean_env_wait_ms": 0.753273646897608, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035338401794433594, "StateBufferConnector_ms": 0.002543926239013672, "ViewRequirementAgentConnector_ms": 0.06598782539367676}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51693360, "num_agent_steps_trained": 51693360, "num_env_steps_sampled": 51693360, "num_env_steps_trained": 51693360, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 275.2621029598594, "num_env_steps_trained_throughput_per_sec": 275.2621029598594, "timesteps_total": 51693360, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51693360, "timers": {"training_iteration_time_ms": 4397.872, "sample_time_ms": 4364.798, "load_time_ms": 0.577, "load_throughput": 2079562.368, "learn_time_ms": 31.658, "learn_throughput": 37904.647, "synch_weights_time_ms": 0.789}, "counters": {"num_env_steps_sampled": 51693360, "num_env_steps_trained": 51693360, "num_agent_steps_sampled": 51693360, "num_agent_steps_trained": 51693360}, "done": false, "episodes_total": 12534, "training_iteration": 3934, "trial_id": "9f686_00000", "date": "2023-08-08_15-27-21", "timestamp": 1691497641, "time_this_iter_s": 13.082183837890625, "time_total_s": 94062.80079436302, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 978.6276075839996, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 24.763157894736842, "ram_util_percent": 65.02105263157897}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-10, "entropy_coeff": 0.15, "policy_entropy": -363.145506117079, "policy_loss": -10372290.087673612, "vf_loss": 21629006.388888888}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4023.5, "diff_num_grad_updates_vs_sampler_policy": 4022.5}}, "num_env_steps_sampled": 51696960, "num_env_steps_trained": 51696960, "num_agent_steps_sampled": 51696960, "num_agent_steps_trained": 51696960}, "sampler_results": {"episode_reward_max": -10119.054446528804, "episode_reward_min": -10509.679485939503, "episode_reward_mean": -10309.882404604437, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428315214724186, "mean_inference_ms": 0.37195513093095095, "mean_action_processing_ms": 0.09119789703361623, "mean_env_wait_ms": 0.7529766329105239, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003513336181640625, "StateBufferConnector_ms": 0.0025441646575927734, "ViewRequirementAgentConnector_ms": 0.06596899032592773}}, "episode_reward_max": -10119.054446528804, "episode_reward_min": -10509.679485939503, "episode_reward_mean": -10309.882404604437, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10233.564475038778, -10503.522829759144, -10279.741128127514, -10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428315214724186, "mean_inference_ms": 0.37195513093095095, "mean_action_processing_ms": 0.09119789703361623, "mean_env_wait_ms": 0.7529766329105239, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003513336181640625, "StateBufferConnector_ms": 0.0025441646575927734, "ViewRequirementAgentConnector_ms": 0.06596899032592773}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51696960, "num_agent_steps_trained": 51696960, "num_env_steps_sampled": 51696960, "num_env_steps_trained": 51696960, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 271.311293002775, "num_env_steps_trained_throughput_per_sec": 271.311293002775, "timesteps_total": 51696960, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51696960, "timers": {"training_iteration_time_ms": 4396.14, "sample_time_ms": 4362.861, "load_time_ms": 0.578, "load_throughput": 2075617.469, "learn_time_ms": 31.854, "learn_throughput": 37671.415, "synch_weights_time_ms": 0.798}, "counters": {"num_env_steps_sampled": 51696960, "num_env_steps_trained": 51696960, "num_agent_steps_sampled": 51696960, "num_agent_steps_trained": 51696960}, "done": false, "episodes_total": 12537, "training_iteration": 3935, "trial_id": "9f686_00000", "date": "2023-08-08_15-27-34", "timestamp": 1691497654, "time_this_iter_s": 13.271836996078491, "time_total_s": 94076.0726313591, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 991.8994445800781, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 20.373684210526314, "ram_util_percent": 65.03684210526316}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.500000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -363.8213585747613, "policy_loss": -8357780.967881944, "vf_loss": 21492124.916666668}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4077.5, "diff_num_grad_updates_vs_sampler_policy": 4076.5}}, "num_env_steps_sampled": 51700560, "num_env_steps_trained": 51700560, "num_agent_steps_sampled": 51700560, "num_agent_steps_trained": 51700560}, "sampler_results": {"episode_reward_max": -10119.054446528804, "episode_reward_min": -10509.679485939503, "episode_reward_mean": -10309.151586623115, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4282983848733535, "mean_inference_ms": 0.3719611961961423, "mean_action_processing_ms": 0.091199021123457, "mean_env_wait_ms": 0.7526914213008618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035130977630615234, "StateBufferConnector_ms": 0.0025458335876464844, "ViewRequirementAgentConnector_ms": 0.06597661972045898}}, "episode_reward_max": -10119.054446528804, "episode_reward_min": -10509.679485939503, "episode_reward_mean": -10309.151586623115, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10206.536283931167, -10403.215712283281, -10303.430694326596, -10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4282983848733535, "mean_inference_ms": 0.3719611961961423, "mean_action_processing_ms": 0.091199021123457, "mean_env_wait_ms": 0.7526914213008618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035130977630615234, "StateBufferConnector_ms": 0.0025458335876464844, "ViewRequirementAgentConnector_ms": 0.06597661972045898}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51700560, "num_agent_steps_trained": 51700560, "num_env_steps_sampled": 51700560, "num_env_steps_trained": 51700560, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 271.3519711056184, "num_env_steps_trained_throughput_per_sec": 271.3519711056184, "timesteps_total": 51700560, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51700560, "timers": {"training_iteration_time_ms": 4399.593, "sample_time_ms": 4366.121, "load_time_ms": 0.579, "load_throughput": 2074248.836, "learn_time_ms": 32.034, "learn_throughput": 37460.515, "synch_weights_time_ms": 0.811}, "counters": {"num_env_steps_sampled": 51700560, "num_env_steps_trained": 51700560, "num_agent_steps_sampled": 51700560, "num_agent_steps_trained": 51700560}, "done": false, "episodes_total": 12540, "training_iteration": 3936, "trial_id": "9f686_00000", "date": "2023-08-08_15-27-48", "timestamp": 1691497668, "time_this_iter_s": 13.26989221572876, "time_total_s": 94089.34252357483, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1005.1693367958069, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 19.342105263157894, "ram_util_percent": 65.24736842105263}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8e-11, "entropy_coeff": 0.15, "policy_entropy": -365.0421668158637, "policy_loss": -3970210.8741319445, "vf_loss": 21195641.694444444}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4131.5, "diff_num_grad_updates_vs_sampler_policy": 4130.5}}, "num_env_steps_sampled": 51704160, "num_env_steps_trained": 51704160, "num_agent_steps_sampled": 51704160, "num_agent_steps_trained": 51704160}, "sampler_results": {"episode_reward_max": -10119.054446528804, "episode_reward_min": -10509.679485939503, "episode_reward_mean": -10308.300964271331, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4282772001911987, "mean_inference_ms": 0.3719671864567815, "mean_action_processing_ms": 0.09120003513954307, "mean_env_wait_ms": 0.7524037233314398, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035142898559570312, "StateBufferConnector_ms": 0.0025441646575927734, "ViewRequirementAgentConnector_ms": 0.06590127944946289}}, "episode_reward_max": -10119.054446528804, "episode_reward_min": -10509.679485939503, "episode_reward_mean": -10308.300964271331, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10398.46524706718, -10412.221576754539, -10285.978146800795, -10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4282772001911987, "mean_inference_ms": 0.3719671864567815, "mean_action_processing_ms": 0.09120003513954307, "mean_env_wait_ms": 0.7524037233314398, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035142898559570312, "StateBufferConnector_ms": 0.0025441646575927734, "ViewRequirementAgentConnector_ms": 0.06590127944946289}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51704160, "num_agent_steps_trained": 51704160, "num_env_steps_sampled": 51704160, "num_env_steps_trained": 51704160, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 273.1281224699756, "num_env_steps_trained_throughput_per_sec": 273.1281224699756, "timesteps_total": 51704160, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51704160, "timers": {"training_iteration_time_ms": 4409.011, "sample_time_ms": 4375.753, "load_time_ms": 0.578, "load_throughput": 2074761.862, "learn_time_ms": 31.827, "learn_throughput": 37703.642, "synch_weights_time_ms": 0.802}, "counters": {"num_env_steps_sampled": 51704160, "num_env_steps_trained": 51704160, "num_agent_steps_sampled": 51704160, "num_agent_steps_trained": 51704160}, "done": false, "episodes_total": 12543, "training_iteration": 3937, "trial_id": "9f686_00000", "date": "2023-08-08_15-28-01", "timestamp": 1691497681, "time_this_iter_s": 13.1837158203125, "time_total_s": 94102.52623939514, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1018.3530526161194, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 19.461111111111112, "ram_util_percent": 65.18888888888888}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.500000000000002e-11, "entropy_coeff": 0.15, "policy_entropy": -363.1132558186849, "policy_loss": -3786416.939236111, "vf_loss": 21072268.027777776}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4185.5, "diff_num_grad_updates_vs_sampler_policy": 4184.5}}, "num_env_steps_sampled": 51707760, "num_env_steps_trained": 51707760, "num_agent_steps_sampled": 51707760, "num_agent_steps_trained": 51707760}, "sampler_results": {"episode_reward_max": -10119.054446528804, "episode_reward_min": -10509.679485939503, "episode_reward_mean": -10305.683403122344, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428256401613491, "mean_inference_ms": 0.3719726241472874, "mean_action_processing_ms": 0.09120093409319278, "mean_env_wait_ms": 0.7521196424123119, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035114288330078125, "StateBufferConnector_ms": 0.0025463104248046875, "ViewRequirementAgentConnector_ms": 0.06594061851501465}}, "episode_reward_max": -10119.054446528804, "episode_reward_min": -10509.679485939503, "episode_reward_mean": -10305.683403122344, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10186.462038950987, -10329.895083158812, -10509.679485939503, -10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428256401613491, "mean_inference_ms": 0.3719726241472874, "mean_action_processing_ms": 0.09120093409319278, "mean_env_wait_ms": 0.7521196424123119, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035114288330078125, "StateBufferConnector_ms": 0.0025463104248046875, "ViewRequirementAgentConnector_ms": 0.06594061851501465}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51707760, "num_agent_steps_trained": 51707760, "num_env_steps_sampled": 51707760, "num_env_steps_trained": 51707760, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 271.9159070999711, "num_env_steps_trained_throughput_per_sec": 271.9159070999711, "timesteps_total": 51707760, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51707760, "timers": {"training_iteration_time_ms": 4412.074, "sample_time_ms": 4378.948, "load_time_ms": 0.58, "load_throughput": 2069813.217, "learn_time_ms": 31.712, "learn_throughput": 37840.272, "synch_weights_time_ms": 0.785}, "counters": {"num_env_steps_sampled": 51707760, "num_env_steps_trained": 51707760, "num_agent_steps_sampled": 51707760, "num_agent_steps_trained": 51707760}, "done": false, "episodes_total": 12546, "training_iteration": 3938, "trial_id": "9f686_00000", "date": "2023-08-08_15-28-14", "timestamp": 1691497694, "time_this_iter_s": 13.24234914779663, "time_total_s": 94115.76858854294, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1031.595401763916, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 17.905263157894737, "ram_util_percent": 65.24736842105263}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -361.77545166015625, "policy_loss": -8901365.841145834, "vf_loss": 21868439.111111112}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4239.5, "diff_num_grad_updates_vs_sampler_policy": 4238.5}}, "num_env_steps_sampled": 51711360, "num_env_steps_trained": 51711360, "num_agent_steps_sampled": 51711360, "num_agent_steps_trained": 51711360}, "sampler_results": {"episode_reward_max": -10119.054446528804, "episode_reward_min": -10556.796204591585, "episode_reward_mean": -10307.921731001652, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4282343410537313, "mean_inference_ms": 0.3719784671249521, "mean_action_processing_ms": 0.09120192347204843, "mean_env_wait_ms": 0.7518470535356796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035238265991210938, "StateBufferConnector_ms": 0.0025403499603271484, "ViewRequirementAgentConnector_ms": 0.06597352027893066}}, "episode_reward_max": -10119.054446528804, "episode_reward_min": -10556.796204591585, "episode_reward_mean": -10307.921731001652, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10259.268499885457, -10210.287953574496, -10207.670220628643, -10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4282343410537313, "mean_inference_ms": 0.3719784671249521, "mean_action_processing_ms": 0.09120192347204843, "mean_env_wait_ms": 0.7518470535356796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035238265991210938, "StateBufferConnector_ms": 0.0025403499603271484, "ViewRequirementAgentConnector_ms": 0.06597352027893066}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51711360, "num_agent_steps_trained": 51711360, "num_env_steps_sampled": 51711360, "num_env_steps_trained": 51711360, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 270.2686848859993, "num_env_steps_trained_throughput_per_sec": 270.2686848859993, "timesteps_total": 51711360, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51711360, "timers": {"training_iteration_time_ms": 4418.068, "sample_time_ms": 4384.853, "load_time_ms": 0.578, "load_throughput": 2074932.927, "learn_time_ms": 31.807, "learn_throughput": 37727.863, "synch_weights_time_ms": 0.78}, "counters": {"num_env_steps_sampled": 51711360, "num_env_steps_trained": 51711360, "num_agent_steps_sampled": 51711360, "num_agent_steps_trained": 51711360}, "done": false, "episodes_total": 12549, "training_iteration": 3939, "trial_id": "9f686_00000", "date": "2023-08-08_15-28-28", "timestamp": 1691497708, "time_this_iter_s": 13.323063135147095, "time_total_s": 94129.09165167809, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1044.918464899063, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 19.252631578947366, "ram_util_percent": 64.89999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -364.2582041422526, "policy_loss": -3647324.9075520835, "vf_loss": 21670936.416666668}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4293.5, "diff_num_grad_updates_vs_sampler_policy": 4292.5}}, "num_env_steps_sampled": 51714960, "num_env_steps_trained": 51714960, "num_agent_steps_sampled": 51714960, "num_agent_steps_trained": 51714960}, "sampler_results": {"episode_reward_max": -10119.054446528804, "episode_reward_min": -10556.796204591585, "episode_reward_mean": -10310.195275476066, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4282189486453207, "mean_inference_ms": 0.37198400201369397, "mean_action_processing_ms": 0.0912029341522007, "mean_env_wait_ms": 0.7515891094780165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035200119018554688, "StateBufferConnector_ms": 0.002542734146118164, "ViewRequirementAgentConnector_ms": 0.06597518920898438}}, "episode_reward_max": -10119.054446528804, "episode_reward_min": -10556.796204591585, "episode_reward_mean": -10310.195275476066, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10330.410466048275, -10400.549817600087, -10229.487085766492, -10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4282189486453207, "mean_inference_ms": 0.37198400201369397, "mean_action_processing_ms": 0.0912029341522007, "mean_env_wait_ms": 0.7515891094780165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035200119018554688, "StateBufferConnector_ms": 0.002542734146118164, "ViewRequirementAgentConnector_ms": 0.06597518920898438}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51714960, "num_agent_steps_trained": 51714960, "num_env_steps_sampled": 51714960, "num_env_steps_trained": 51714960, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 271.7928783957405, "num_env_steps_trained_throughput_per_sec": 271.7928783957405, "timesteps_total": 51714960, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51714960, "timers": {"training_iteration_time_ms": 4413.376, "sample_time_ms": 4380.114, "load_time_ms": 0.577, "load_throughput": 2080765.968, "learn_time_ms": 31.85, "learn_throughput": 37676.717, "synch_weights_time_ms": 0.786}, "counters": {"num_env_steps_sampled": 51714960, "num_env_steps_trained": 51714960, "num_agent_steps_sampled": 51714960, "num_agent_steps_trained": 51714960}, "done": false, "episodes_total": 12552, "training_iteration": 3940, "trial_id": "9f686_00000", "date": "2023-08-08_15-28-41", "timestamp": 1691497721, "time_this_iter_s": 13.2482590675354, "time_total_s": 94142.33991074562, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1058.1667239665985, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 18.605263157894733, "ram_util_percent": 64.94210526315788}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -365.68682183159723, "policy_loss": -6542836.697916667, "vf_loss": 21424639.944444444}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4347.5, "diff_num_grad_updates_vs_sampler_policy": 4346.5}}, "num_env_steps_sampled": 51718560, "num_env_steps_trained": 51718560, "num_agent_steps_sampled": 51718560, "num_agent_steps_trained": 51718560}, "sampler_results": {"episode_reward_max": -10119.054446528804, "episode_reward_min": -10556.796204591585, "episode_reward_mean": -10309.060249878657, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428205469187876, "mean_inference_ms": 0.37198960882797805, "mean_action_processing_ms": 0.09120398438863508, "mean_env_wait_ms": 0.7513447062932166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003518342971801758, "StateBufferConnector_ms": 0.0025446414947509766, "ViewRequirementAgentConnector_ms": 0.06599140167236328}}, "episode_reward_max": -10119.054446528804, "episode_reward_min": -10556.796204591585, "episode_reward_mean": -10309.060249878657, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10249.6380096534, -10164.658010549478, -10330.018597028566, -10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428205469187876, "mean_inference_ms": 0.37198960882797805, "mean_action_processing_ms": 0.09120398438863508, "mean_env_wait_ms": 0.7513447062932166, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003518342971801758, "StateBufferConnector_ms": 0.0025446414947509766, "ViewRequirementAgentConnector_ms": 0.06599140167236328}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51718560, "num_agent_steps_trained": 51718560, "num_env_steps_sampled": 51718560, "num_env_steps_trained": 51718560, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 274.0017541417523, "num_env_steps_trained_throughput_per_sec": 274.0017541417523, "timesteps_total": 51718560, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51718560, "timers": {"training_iteration_time_ms": 4402.849, "sample_time_ms": 4369.582, "load_time_ms": 0.577, "load_throughput": 2080421.94, "learn_time_ms": 31.833, "learn_throughput": 37696.357, "synch_weights_time_ms": 0.806}, "counters": {"num_env_steps_sampled": 51718560, "num_env_steps_trained": 51718560, "num_agent_steps_sampled": 51718560, "num_agent_steps_trained": 51718560}, "done": false, "episodes_total": 12555, "training_iteration": 3941, "trial_id": "9f686_00000", "date": "2023-08-08_15-28-54", "timestamp": 1691497734, "time_this_iter_s": 13.141515970230103, "time_total_s": 94155.48142671585, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1071.3082399368286, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 18.483333333333334, "ram_util_percent": 64.89444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -362.3966420491536, "policy_loss": -5792877.356336806, "vf_loss": 21103393.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4401.5, "diff_num_grad_updates_vs_sampler_policy": 4400.5}}, "num_env_steps_sampled": 51722160, "num_env_steps_trained": 51722160, "num_agent_steps_sampled": 51722160, "num_agent_steps_trained": 51722160}, "sampler_results": {"episode_reward_max": -10119.054446528804, "episode_reward_min": -10556.796204591585, "episode_reward_mean": -10308.99497189635, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428186532143762, "mean_inference_ms": 0.3719954205525859, "mean_action_processing_ms": 0.0912051158745599, "mean_env_wait_ms": 0.7511087192447607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035164356231689453, "StateBufferConnector_ms": 0.002545595169067383, "ViewRequirementAgentConnector_ms": 0.06592202186584473}}, "episode_reward_max": -10119.054446528804, "episode_reward_min": -10556.796204591585, "episode_reward_mean": -10308.99497189635, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10245.960038012317, -10325.272117576329, -10381.92549098337, -10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428186532143762, "mean_inference_ms": 0.3719954205525859, "mean_action_processing_ms": 0.0912051158745599, "mean_env_wait_ms": 0.7511087192447607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035164356231689453, "StateBufferConnector_ms": 0.002545595169067383, "ViewRequirementAgentConnector_ms": 0.06592202186584473}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51722160, "num_agent_steps_trained": 51722160, "num_env_steps_sampled": 51722160, "num_env_steps_trained": 51722160, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 273.716967215241, "num_env_steps_trained_throughput_per_sec": 273.716967215241, "timesteps_total": 51722160, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51722160, "timers": {"training_iteration_time_ms": 4398.67, "sample_time_ms": 4365.683, "load_time_ms": 0.575, "load_throughput": 2087064.521, "learn_time_ms": 31.578, "learn_throughput": 38000.747, "synch_weights_time_ms": 0.784}, "counters": {"num_env_steps_sampled": 51722160, "num_env_steps_trained": 51722160, "num_agent_steps_sampled": 51722160, "num_agent_steps_trained": 51722160}, "done": false, "episodes_total": 12558, "training_iteration": 3942, "trial_id": "9f686_00000", "date": "2023-08-08_15-29-07", "timestamp": 1691497747, "time_this_iter_s": 13.155067205429077, "time_total_s": 94168.63649392128, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1084.4633071422577, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 18.910526315789472, "ram_util_percent": 64.99473684210527}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -363.63148498535156, "policy_loss": -6288951.306857639, "vf_loss": 21310170.388888888}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4455.5, "diff_num_grad_updates_vs_sampler_policy": 4454.5}}, "num_env_steps_sampled": 51725760, "num_env_steps_trained": 51725760, "num_agent_steps_sampled": 51725760, "num_agent_steps_trained": 51725760}, "sampler_results": {"episode_reward_max": -10119.054446528804, "episode_reward_min": -10556.796204591585, "episode_reward_mean": -10308.24449461361, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428159713524285, "mean_inference_ms": 0.3720015181726164, "mean_action_processing_ms": 0.09120638641572358, "mean_env_wait_ms": 0.7508778909829411, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035161972045898438, "StateBufferConnector_ms": 0.0025560855865478516, "ViewRequirementAgentConnector_ms": 0.0659170150756836}}, "episode_reward_max": -10119.054446528804, "episode_reward_min": -10556.796204591585, "episode_reward_mean": -10308.24449461361, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10193.185736829322, -10230.03006509215, -10419.888286562857, -10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428159713524285, "mean_inference_ms": 0.3720015181726164, "mean_action_processing_ms": 0.09120638641572358, "mean_env_wait_ms": 0.7508778909829411, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035161972045898438, "StateBufferConnector_ms": 0.0025560855865478516, "ViewRequirementAgentConnector_ms": 0.0659170150756836}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51725760, "num_agent_steps_trained": 51725760, "num_env_steps_sampled": 51725760, "num_env_steps_trained": 51725760, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 273.09203692479895, "num_env_steps_trained_throughput_per_sec": 273.09203692479895, "timesteps_total": 51725760, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51725760, "timers": {"training_iteration_time_ms": 4388.861, "sample_time_ms": 4355.691, "load_time_ms": 0.589, "load_throughput": 2037553.558, "learn_time_ms": 31.722, "learn_throughput": 37828.696, "synch_weights_time_ms": 0.808}, "counters": {"num_env_steps_sampled": 51725760, "num_env_steps_trained": 51725760, "num_agent_steps_sampled": 51725760, "num_agent_steps_trained": 51725760}, "done": false, "episodes_total": 12561, "training_iteration": 3943, "trial_id": "9f686_00000", "date": "2023-08-08_15-29-20", "timestamp": 1691497760, "time_this_iter_s": 13.185289859771729, "time_total_s": 94181.82178378105, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1097.6485970020294, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 20.02631578947368, "ram_util_percent": 64.9578947368421}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -363.1989559597439, "policy_loss": -8000400.809895833, "vf_loss": 21399031.833333332}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4509.5, "diff_num_grad_updates_vs_sampler_policy": 4508.5}}, "num_env_steps_sampled": 51729360, "num_env_steps_trained": 51729360, "num_agent_steps_sampled": 51729360, "num_agent_steps_trained": 51729360}, "sampler_results": {"episode_reward_max": -10119.054446528804, "episode_reward_min": -10556.796204591585, "episode_reward_mean": -10307.753286794405, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428138522665755, "mean_inference_ms": 0.37200801384913296, "mean_action_processing_ms": 0.091207749688879, "mean_env_wait_ms": 0.7506504055311504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003517627716064453, "StateBufferConnector_ms": 0.002556324005126953, "ViewRequirementAgentConnector_ms": 0.06591582298278809}}, "episode_reward_max": -10119.054446528804, "episode_reward_min": -10556.796204591585, "episode_reward_mean": -10307.753286794405, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10298.220698195126, -10413.67500453584, -10461.752044175439, -10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428138522665755, "mean_inference_ms": 0.37200801384913296, "mean_action_processing_ms": 0.091207749688879, "mean_env_wait_ms": 0.7506504055311504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003517627716064453, "StateBufferConnector_ms": 0.002556324005126953, "ViewRequirementAgentConnector_ms": 0.06591582298278809}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51729360, "num_agent_steps_trained": 51729360, "num_env_steps_sampled": 51729360, "num_env_steps_trained": 51729360, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 272.4353346315282, "num_env_steps_trained_throughput_per_sec": 272.4353346315282, "timesteps_total": 51729360, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51729360, "timers": {"training_iteration_time_ms": 4398.172, "sample_time_ms": 4365.017, "load_time_ms": 0.587, "load_throughput": 2045586.182, "learn_time_ms": 31.714, "learn_throughput": 37838.536, "synch_weights_time_ms": 0.803}, "counters": {"num_env_steps_sampled": 51729360, "num_env_steps_trained": 51729360, "num_agent_steps_sampled": 51729360, "num_agent_steps_trained": 51729360}, "done": false, "episodes_total": 12564, "training_iteration": 3944, "trial_id": "9f686_00000", "date": "2023-08-08_15-29-34", "timestamp": 1691497774, "time_this_iter_s": 13.216951847076416, "time_total_s": 94195.03873562813, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1110.8655488491058, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 21.236842105263158, "ram_util_percent": 65.00526315789475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -361.946056789822, "policy_loss": -6904667.232638889, "vf_loss": 21266456.972222224}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4563.5, "diff_num_grad_updates_vs_sampler_policy": 4562.5}}, "num_env_steps_sampled": 51732960, "num_env_steps_trained": 51732960, "num_agent_steps_sampled": 51732960, "num_agent_steps_trained": 51732960}, "sampler_results": {"episode_reward_max": -10119.054446528804, "episode_reward_min": -10556.796204591585, "episode_reward_mean": -10305.839857561614, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428122921385565, "mean_inference_ms": 0.37201404078437944, "mean_action_processing_ms": 0.09120891148989846, "mean_env_wait_ms": 0.7504230997586496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035223960876464844, "StateBufferConnector_ms": 0.00255584716796875, "ViewRequirementAgentConnector_ms": 0.0659031867980957}}, "episode_reward_max": -10119.054446528804, "episode_reward_min": -10556.796204591585, "episode_reward_mean": -10305.839857561614, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10268.243286872757, -10179.29510402902, -10344.188974904904, -10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428122921385565, "mean_inference_ms": 0.37201404078437944, "mean_action_processing_ms": 0.09120891148989846, "mean_env_wait_ms": 0.7504230997586496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035223960876464844, "StateBufferConnector_ms": 0.00255584716796875, "ViewRequirementAgentConnector_ms": 0.0659031867980957}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51732960, "num_agent_steps_trained": 51732960, "num_env_steps_sampled": 51732960, "num_env_steps_trained": 51732960, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 270.0436535711795, "num_env_steps_trained_throughput_per_sec": 270.0436535711795, "timesteps_total": 51732960, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51732960, "timers": {"training_iteration_time_ms": 4413.193, "sample_time_ms": 4380.078, "load_time_ms": 0.589, "load_throughput": 2038543.864, "learn_time_ms": 31.682, "learn_throughput": 37876.351, "synch_weights_time_ms": 0.794}, "counters": {"num_env_steps_sampled": 51732960, "num_env_steps_trained": 51732960, "num_agent_steps_sampled": 51732960, "num_agent_steps_trained": 51732960}, "done": false, "episodes_total": 12567, "training_iteration": 3945, "trial_id": "9f686_00000", "date": "2023-08-08_15-29-47", "timestamp": 1691497787, "time_this_iter_s": 13.334172248840332, "time_total_s": 94208.37290787697, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1124.1997210979462, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 19.083333333333332, "ram_util_percent": 65.22777777777779}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -361.4498240152995, "policy_loss": -8663475.664930556, "vf_loss": 22349656.777777776}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4617.5, "diff_num_grad_updates_vs_sampler_policy": 4616.5}}, "num_env_steps_sampled": 51736560, "num_env_steps_trained": 51736560, "num_agent_steps_sampled": 51736560, "num_agent_steps_trained": 51736560}, "sampler_results": {"episode_reward_max": -10119.054446528804, "episode_reward_min": -10556.796204591585, "episode_reward_mean": -10308.500724630048, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428105669253375, "mean_inference_ms": 0.3720200887612028, "mean_action_processing_ms": 0.09120999904762211, "mean_env_wait_ms": 0.7502005776031404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003516674041748047, "StateBufferConnector_ms": 0.0025548934936523438, "ViewRequirementAgentConnector_ms": 0.06589508056640625}}, "episode_reward_max": -10119.054446528804, "episode_reward_min": -10556.796204591585, "episode_reward_mean": -10308.500724630048, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10325.213786376711, -10336.632288059292, -10347.537924852917, -10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428105669253375, "mean_inference_ms": 0.3720200887612028, "mean_action_processing_ms": 0.09120999904762211, "mean_env_wait_ms": 0.7502005776031404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003516674041748047, "StateBufferConnector_ms": 0.0025548934936523438, "ViewRequirementAgentConnector_ms": 0.06589508056640625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51736560, "num_agent_steps_trained": 51736560, "num_env_steps_sampled": 51736560, "num_env_steps_trained": 51736560, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 271.6984603196393, "num_env_steps_trained_throughput_per_sec": 271.6984603196393, "timesteps_total": 51736560, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51736560, "timers": {"training_iteration_time_ms": 4412.289, "sample_time_ms": 4379.253, "load_time_ms": 0.595, "load_throughput": 2016007.69, "learn_time_ms": 31.593, "learn_throughput": 37982.538, "synch_weights_time_ms": 0.796}, "counters": {"num_env_steps_sampled": 51736560, "num_env_steps_trained": 51736560, "num_agent_steps_sampled": 51736560, "num_agent_steps_trained": 51736560}, "done": false, "episodes_total": 12570, "training_iteration": 3946, "trial_id": "9f686_00000", "date": "2023-08-08_15-30-00", "timestamp": 1691497800, "time_this_iter_s": 13.252840042114258, "time_total_s": 94221.62574791908, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1137.4525611400604, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 19.452631578947372, "ram_util_percent": 65.23684210526316}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -366.4780748155382, "policy_loss": -5342002.591145833, "vf_loss": 21593593.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4671.5, "diff_num_grad_updates_vs_sampler_policy": 4670.5}}, "num_env_steps_sampled": 51740160, "num_env_steps_trained": 51740160, "num_agent_steps_sampled": 51740160, "num_agent_steps_trained": 51740160}, "sampler_results": {"episode_reward_max": -10119.054446528804, "episode_reward_min": -10556.796204591585, "episode_reward_mean": -10307.826987174461, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4280929891489778, "mean_inference_ms": 0.37202656156059866, "mean_action_processing_ms": 0.09121123240662614, "mean_env_wait_ms": 0.7499830390252558, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003520965576171875, "StateBufferConnector_ms": 0.002560138702392578, "ViewRequirementAgentConnector_ms": 0.06588602066040039}}, "episode_reward_max": -10119.054446528804, "episode_reward_min": -10556.796204591585, "episode_reward_mean": -10307.826987174461, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10255.291974708434, -10276.963304512727, -10286.675144189323, -10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4280929891489778, "mean_inference_ms": 0.37202656156059866, "mean_action_processing_ms": 0.09121123240662614, "mean_env_wait_ms": 0.7499830390252558, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003520965576171875, "StateBufferConnector_ms": 0.002560138702392578, "ViewRequirementAgentConnector_ms": 0.06588602066040039}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51740160, "num_agent_steps_trained": 51740160, "num_env_steps_sampled": 51740160, "num_env_steps_trained": 51740160, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 271.3009048062367, "num_env_steps_trained_throughput_per_sec": 271.3009048062367, "timesteps_total": 51740160, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51740160, "timers": {"training_iteration_time_ms": 4421.102, "sample_time_ms": 4388.112, "load_time_ms": 0.583, "load_throughput": 2057460.164, "learn_time_ms": 31.56, "learn_throughput": 38022.594, "synch_weights_time_ms": 0.797}, "counters": {"num_env_steps_sampled": 51740160, "num_env_steps_trained": 51740160, "num_agent_steps_sampled": 51740160, "num_agent_steps_trained": 51740160}, "done": false, "episodes_total": 12573, "training_iteration": 3947, "trial_id": "9f686_00000", "date": "2023-08-08_15-30-14", "timestamp": 1691497814, "time_this_iter_s": 13.272403955459595, "time_total_s": 94234.89815187454, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1150.72496509552, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 18.157894736842106, "ram_util_percent": 65.26842105263158}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -361.66041395399304, "policy_loss": -7530604.71484375, "vf_loss": 21542186.333333332}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4725.5, "diff_num_grad_updates_vs_sampler_policy": 4724.5}}, "num_env_steps_sampled": 51743760, "num_env_steps_trained": 51743760, "num_agent_steps_sampled": 51743760, "num_agent_steps_trained": 51743760}, "sampler_results": {"episode_reward_max": -10119.054446528804, "episode_reward_min": -10556.796204591585, "episode_reward_mean": -10309.392999491294, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428065576192706, "mean_inference_ms": 0.3720335020691055, "mean_action_processing_ms": 0.0912125373948453, "mean_env_wait_ms": 0.7497745172241921, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034983158111572266, "StateBufferConnector_ms": 0.0025489330291748047, "ViewRequirementAgentConnector_ms": 0.06592082977294922}}, "episode_reward_max": -10119.054446528804, "episode_reward_min": -10556.796204591585, "episode_reward_mean": -10309.392999491294, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10161.403677899181, -10234.867034871337, -10315.215102377533, -10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428065576192706, "mean_inference_ms": 0.3720335020691055, "mean_action_processing_ms": 0.0912125373948453, "mean_env_wait_ms": 0.7497745172241921, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034983158111572266, "StateBufferConnector_ms": 0.0025489330291748047, "ViewRequirementAgentConnector_ms": 0.06592082977294922}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51743760, "num_agent_steps_trained": 51743760, "num_env_steps_sampled": 51743760, "num_env_steps_trained": 51743760, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 273.70822972858036, "num_env_steps_trained_throughput_per_sec": 273.70822972858036, "timesteps_total": 51743760, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51743760, "timers": {"training_iteration_time_ms": 4411.027, "sample_time_ms": 4377.976, "load_time_ms": 0.59, "load_throughput": 2034752.911, "learn_time_ms": 31.609, "learn_throughput": 37964.202, "synch_weights_time_ms": 0.801}, "counters": {"num_env_steps_sampled": 51743760, "num_env_steps_trained": 51743760, "num_agent_steps_sampled": 51743760, "num_agent_steps_trained": 51743760}, "done": false, "episodes_total": 12576, "training_iteration": 3948, "trial_id": "9f686_00000", "date": "2023-08-08_15-30-27", "timestamp": 1691497827, "time_this_iter_s": 13.15555715560913, "time_total_s": 94248.05370903015, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1163.8805222511292, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 17.494736842105265, "ram_util_percent": 64.97368421052632}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -363.9569905598958, "policy_loss": -2456251.832465278, "vf_loss": 21480272.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4779.5, "diff_num_grad_updates_vs_sampler_policy": 4778.5}}, "num_env_steps_sampled": 51747360, "num_env_steps_trained": 51747360, "num_agent_steps_sampled": 51747360, "num_agent_steps_trained": 51747360}, "sampler_results": {"episode_reward_max": -10119.054446528804, "episode_reward_min": -10556.796204591585, "episode_reward_mean": -10311.553168834886, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428042173422445, "mean_inference_ms": 0.37204032045347707, "mean_action_processing_ms": 0.09121373735608305, "mean_env_wait_ms": 0.7495763683042543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034494400024414062, "StateBufferConnector_ms": 0.002547740936279297, "ViewRequirementAgentConnector_ms": 0.06585884094238281}}, "episode_reward_max": -10119.054446528804, "episode_reward_min": -10556.796204591585, "episode_reward_mean": -10311.553168834886, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10298.361469451544, -10375.386211312127, -10289.876461257218, -10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428042173422445, "mean_inference_ms": 0.37204032045347707, "mean_action_processing_ms": 0.09121373735608305, "mean_env_wait_ms": 0.7495763683042543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034494400024414062, "StateBufferConnector_ms": 0.002547740936279297, "ViewRequirementAgentConnector_ms": 0.06585884094238281}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51747360, "num_agent_steps_trained": 51747360, "num_env_steps_sampled": 51747360, "num_env_steps_trained": 51747360, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 271.7629456634091, "num_env_steps_trained_throughput_per_sec": 271.7629456634091, "timesteps_total": 51747360, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51747360, "timers": {"training_iteration_time_ms": 4414.313, "sample_time_ms": 4381.121, "load_time_ms": 0.595, "load_throughput": 2017219.671, "learn_time_ms": 31.74, "learn_throughput": 37806.59, "synch_weights_time_ms": 0.803}, "counters": {"num_env_steps_sampled": 51747360, "num_env_steps_trained": 51747360, "num_agent_steps_sampled": 51747360, "num_agent_steps_trained": 51747360}, "done": false, "episodes_total": 12579, "training_iteration": 3949, "trial_id": "9f686_00000", "date": "2023-08-08_15-30-40", "timestamp": 1691497840, "time_this_iter_s": 13.249815940856934, "time_total_s": 94261.30352497101, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1177.130338191986, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 19.03684210526316, "ram_util_percent": 64.88421052631578}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -362.69915601942273, "policy_loss": -9669326.589409722, "vf_loss": 21885784.861111112}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4833.5, "diff_num_grad_updates_vs_sampler_policy": 4832.5}}, "num_env_steps_sampled": 51750960, "num_env_steps_trained": 51750960, "num_agent_steps_sampled": 51750960, "num_agent_steps_trained": 51750960}, "sampler_results": {"episode_reward_max": -10119.054446528804, "episode_reward_min": -10556.796204591585, "episode_reward_mean": -10311.232022138667, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4280085337665542, "mean_inference_ms": 0.37204680409785795, "mean_action_processing_ms": 0.0912149653854812, "mean_env_wait_ms": 0.74939253786268, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003459453582763672, "StateBufferConnector_ms": 0.0025551319122314453, "ViewRequirementAgentConnector_ms": 0.06596970558166504}}, "episode_reward_max": -10119.054446528804, "episode_reward_min": -10556.796204591585, "episode_reward_mean": -10311.232022138667, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10270.813571508223, -10414.024573508506, -10376.447532657356, -10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4280085337665542, "mean_inference_ms": 0.37204680409785795, "mean_action_processing_ms": 0.0912149653854812, "mean_env_wait_ms": 0.74939253786268, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003459453582763672, "StateBufferConnector_ms": 0.0025551319122314453, "ViewRequirementAgentConnector_ms": 0.06596970558166504}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51750960, "num_agent_steps_trained": 51750960, "num_env_steps_sampled": 51750960, "num_env_steps_trained": 51750960, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 272.9276855871896, "num_env_steps_trained_throughput_per_sec": 272.9276855871896, "timesteps_total": 51750960, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51750960, "timers": {"training_iteration_time_ms": 4402.444, "sample_time_ms": 4369.36, "load_time_ms": 0.588, "load_throughput": 2040031.128, "learn_time_ms": 31.63, "learn_throughput": 37938.676, "synch_weights_time_ms": 0.812}, "counters": {"num_env_steps_sampled": 51750960, "num_env_steps_trained": 51750960, "num_agent_steps_sampled": 51750960, "num_agent_steps_trained": 51750960}, "done": false, "episodes_total": 12582, "training_iteration": 3950, "trial_id": "9f686_00000", "date": "2023-08-08_15-30-53", "timestamp": 1691497853, "time_this_iter_s": 13.193238019943237, "time_total_s": 94274.49676299095, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1190.3235762119293, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 22.044444444444448, "ram_util_percent": 64.99444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -362.1204189724392, "policy_loss": -6915248.160590278, "vf_loss": 21414783.027777776}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4887.5, "diff_num_grad_updates_vs_sampler_policy": 4886.5}}, "num_env_steps_sampled": 51754560, "num_env_steps_trained": 51754560, "num_agent_steps_sampled": 51754560, "num_agent_steps_trained": 51754560}, "sampler_results": {"episode_reward_max": -10119.054446528804, "episode_reward_min": -10556.796204591585, "episode_reward_mean": -10308.153962938042, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4279796984591626, "mean_inference_ms": 0.37205186134504503, "mean_action_processing_ms": 0.09121605347991159, "mean_env_wait_ms": 0.7492023206851672, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034513473510742188, "StateBufferConnector_ms": 0.0025599002838134766, "ViewRequirementAgentConnector_ms": 0.0659646987915039}}, "episode_reward_max": -10119.054446528804, "episode_reward_min": -10556.796204591585, "episode_reward_mean": -10308.153962938042, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10324.661109309292, -10187.20538440295, -10466.34379765293, -10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4279796984591626, "mean_inference_ms": 0.37205186134504503, "mean_action_processing_ms": 0.09121605347991159, "mean_env_wait_ms": 0.7492023206851672, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034513473510742188, "StateBufferConnector_ms": 0.0025599002838134766, "ViewRequirementAgentConnector_ms": 0.0659646987915039}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51754560, "num_agent_steps_trained": 51754560, "num_env_steps_sampled": 51754560, "num_env_steps_trained": 51754560, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 272.78651980456704, "num_env_steps_trained_throughput_per_sec": 272.78651980456704, "timesteps_total": 51754560, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51754560, "timers": {"training_iteration_time_ms": 4405.723, "sample_time_ms": 4372.54, "load_time_ms": 0.578, "load_throughput": 2074847.391, "learn_time_ms": 31.751, "learn_throughput": 37794.325, "synch_weights_time_ms": 0.803}, "counters": {"num_env_steps_sampled": 51754560, "num_env_steps_trained": 51754560, "num_agent_steps_sampled": 51754560, "num_agent_steps_trained": 51754560}, "done": false, "episodes_total": 12585, "training_iteration": 3951, "trial_id": "9f686_00000", "date": "2023-08-08_15-31-06", "timestamp": 1691497866, "time_this_iter_s": 13.200087070465088, "time_total_s": 94287.69685006142, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1203.5236632823944, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 18.74736842105263, "ram_util_percent": 64.97894736842105}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -362.5958489312066, "policy_loss": -6221626.49609375, "vf_loss": 21104382.944444444}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4941.5, "diff_num_grad_updates_vs_sampler_policy": 4940.5}}, "num_env_steps_sampled": 51758160, "num_env_steps_trained": 51758160, "num_agent_steps_sampled": 51758160, "num_agent_steps_trained": 51758160}, "sampler_results": {"episode_reward_max": -10119.054446528804, "episode_reward_min": -10556.796204591585, "episode_reward_mean": -10307.51164343399, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4279509559923635, "mean_inference_ms": 0.37205540008398336, "mean_action_processing_ms": 0.09121713613109877, "mean_env_wait_ms": 0.7490061022519715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003451824188232422, "StateBufferConnector_ms": 0.0025577545166015625, "ViewRequirementAgentConnector_ms": 0.06606101989746094}}, "episode_reward_max": -10119.054446528804, "episode_reward_min": -10556.796204591585, "episode_reward_mean": -10307.51164343399, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10504.383596479624, -10275.76434477153, -10320.40872789731, -10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4279509559923635, "mean_inference_ms": 0.37205540008398336, "mean_action_processing_ms": 0.09121713613109877, "mean_env_wait_ms": 0.7490061022519715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003451824188232422, "StateBufferConnector_ms": 0.0025577545166015625, "ViewRequirementAgentConnector_ms": 0.06606101989746094}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51758160, "num_agent_steps_trained": 51758160, "num_env_steps_sampled": 51758160, "num_env_steps_trained": 51758160, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 272.203217935555, "num_env_steps_trained_throughput_per_sec": 272.203217935555, "timesteps_total": 51758160, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51758160, "timers": {"training_iteration_time_ms": 4399.855, "sample_time_ms": 4366.566, "load_time_ms": 0.578, "load_throughput": 2077502.291, "learn_time_ms": 31.849, "learn_throughput": 37678.014, "synch_weights_time_ms": 0.813}, "counters": {"num_env_steps_sampled": 51758160, "num_env_steps_trained": 51758160, "num_agent_steps_sampled": 51758160, "num_agent_steps_trained": 51758160}, "done": false, "episodes_total": 12588, "training_iteration": 3952, "trial_id": "9f686_00000", "date": "2023-08-08_15-31-20", "timestamp": 1691497880, "time_this_iter_s": 13.228417158126831, "time_total_s": 94300.92526721954, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1216.7520804405212, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 18.584210526315786, "ram_util_percent": 65.01578947368422}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -363.0075378417969, "policy_loss": -10290208.539930556, "vf_loss": 21765359.833333332}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4995.5, "diff_num_grad_updates_vs_sampler_policy": 4994.5}}, "num_env_steps_sampled": 51761760, "num_env_steps_trained": 51761760, "num_agent_steps_sampled": 51761760, "num_agent_steps_trained": 51761760}, "sampler_results": {"episode_reward_max": -10119.054446528804, "episode_reward_min": -10556.796204591585, "episode_reward_mean": -10304.437685704725, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4279148263116412, "mean_inference_ms": 0.3720583775314906, "mean_action_processing_ms": 0.09121819649910297, "mean_env_wait_ms": 0.7488117482481802, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003454446792602539, "StateBufferConnector_ms": 0.0025577545166015625, "ViewRequirementAgentConnector_ms": 0.06603288650512695}}, "episode_reward_max": -10119.054446528804, "episode_reward_min": -10556.796204591585, "episode_reward_mean": -10304.437685704725, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10254.009464476341, -10299.938068239488, -10412.349097198752, -10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4279148263116412, "mean_inference_ms": 0.3720583775314906, "mean_action_processing_ms": 0.09121819649910297, "mean_env_wait_ms": 0.7488117482481802, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003454446792602539, "StateBufferConnector_ms": 0.0025577545166015625, "ViewRequirementAgentConnector_ms": 0.06603288650512695}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51761760, "num_agent_steps_trained": 51761760, "num_env_steps_sampled": 51761760, "num_env_steps_trained": 51761760, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 272.9142382209705, "num_env_steps_trained_throughput_per_sec": 272.9142382209705, "timesteps_total": 51761760, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51761760, "timers": {"training_iteration_time_ms": 4412.484, "sample_time_ms": 4379.099, "load_time_ms": 0.575, "load_throughput": 2087410.75, "learn_time_ms": 31.951, "learn_throughput": 37557.12, "synch_weights_time_ms": 0.807}, "counters": {"num_env_steps_sampled": 51761760, "num_env_steps_trained": 51761760, "num_agent_steps_sampled": 51761760, "num_agent_steps_trained": 51761760}, "done": false, "episodes_total": 12591, "training_iteration": 3953, "trial_id": "9f686_00000", "date": "2023-08-08_15-31-33", "timestamp": 1691497893, "time_this_iter_s": 13.193838834762573, "time_total_s": 94314.1191060543, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1229.9459192752838, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 19.494444444444444, "ram_util_percent": 65.05000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -362.85576883951825, "policy_loss": -9553874.869357638, "vf_loss": 21831950.027777776}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5049.5, "diff_num_grad_updates_vs_sampler_policy": 5048.5}}, "num_env_steps_sampled": 51765360, "num_env_steps_trained": 51765360, "num_agent_steps_sampled": 51765360, "num_agent_steps_trained": 51765360}, "sampler_results": {"episode_reward_max": -10119.054446528804, "episode_reward_min": -10556.796204591585, "episode_reward_mean": -10303.920510321004, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4278718920677522, "mean_inference_ms": 0.37206089748574706, "mean_action_processing_ms": 0.09121920538748936, "mean_env_wait_ms": 0.748624350599714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00345611572265625, "StateBufferConnector_ms": 0.0025625228881835938, "ViewRequirementAgentConnector_ms": 0.06604480743408203}}, "episode_reward_max": -10119.054446528804, "episode_reward_min": -10556.796204591585, "episode_reward_mean": -10303.920510321004, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10309.227487905337, -10136.945992786517, -10283.188498182524, -10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4278718920677522, "mean_inference_ms": 0.37206089748574706, "mean_action_processing_ms": 0.09121920538748936, "mean_env_wait_ms": 0.748624350599714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00345611572265625, "StateBufferConnector_ms": 0.0025625228881835938, "ViewRequirementAgentConnector_ms": 0.06604480743408203}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51765360, "num_agent_steps_trained": 51765360, "num_env_steps_sampled": 51765360, "num_env_steps_trained": 51765360, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 273.3184888065905, "num_env_steps_trained_throughput_per_sec": 273.3184888065905, "timesteps_total": 51765360, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51765360, "timers": {"training_iteration_time_ms": 4403.876, "sample_time_ms": 4370.629, "load_time_ms": 0.576, "load_throughput": 2084816.834, "learn_time_ms": 31.808, "learn_throughput": 37726.421, "synch_weights_time_ms": 0.812}, "counters": {"num_env_steps_sampled": 51765360, "num_env_steps_trained": 51765360, "num_agent_steps_sampled": 51765360, "num_agent_steps_trained": 51765360}, "done": false, "episodes_total": 12594, "training_iteration": 3954, "trial_id": "9f686_00000", "date": "2023-08-08_15-31-46", "timestamp": 1691497906, "time_this_iter_s": 13.174397945404053, "time_total_s": 94327.29350399971, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1243.1203172206879, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 19.321052631578947, "ram_util_percent": 65.23684210526316}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -363.5491722954644, "policy_loss": -14032811.3203125, "vf_loss": 22177660.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5103.5, "diff_num_grad_updates_vs_sampler_policy": 5102.5}}, "num_env_steps_sampled": 51768960, "num_env_steps_trained": 51768960, "num_agent_steps_sampled": 51768960, "num_agent_steps_trained": 51768960}, "sampler_results": {"episode_reward_max": -10119.054446528804, "episode_reward_min": -10556.796204591585, "episode_reward_mean": -10307.603216718742, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.427834469931655, "mean_inference_ms": 0.3720635662338051, "mean_action_processing_ms": 0.0912203282297458, "mean_env_wait_ms": 0.7484503241936444, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034575462341308594, "StateBufferConnector_ms": 0.002567768096923828, "ViewRequirementAgentConnector_ms": 0.06604433059692383}}, "episode_reward_max": -10119.054446528804, "episode_reward_min": -10556.796204591585, "episode_reward_mean": -10307.603216718742, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10465.617986007785, -10373.491841368077, -10302.649256492377, -10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.427834469931655, "mean_inference_ms": 0.3720635662338051, "mean_action_processing_ms": 0.0912203282297458, "mean_env_wait_ms": 0.7484503241936444, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034575462341308594, "StateBufferConnector_ms": 0.002567768096923828, "ViewRequirementAgentConnector_ms": 0.06604433059692383}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51768960, "num_agent_steps_trained": 51768960, "num_env_steps_sampled": 51768960, "num_env_steps_trained": 51768960, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 269.1093200900024, "num_env_steps_trained_throughput_per_sec": 269.1093200900024, "timesteps_total": 51768960, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51768960, "timers": {"training_iteration_time_ms": 4412.143, "sample_time_ms": 4379.318, "load_time_ms": 0.576, "load_throughput": 2085075.935, "learn_time_ms": 31.409, "learn_throughput": 38206.014, "synch_weights_time_ms": 0.79}, "counters": {"num_env_steps_sampled": 51768960, "num_env_steps_trained": 51768960, "num_agent_steps_sampled": 51768960, "num_agent_steps_trained": 51768960}, "done": false, "episodes_total": 12597, "training_iteration": 3955, "trial_id": "9f686_00000", "date": "2023-08-08_15-32-00", "timestamp": 1691497920, "time_this_iter_s": 13.380308389663696, "time_total_s": 94340.67381238937, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1256.5006256103516, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 19.00526315789474, "ram_util_percent": 65.17894736842106}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -362.5737525092231, "policy_loss": -9979547.333333334, "vf_loss": 21503392.833333332}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5157.5, "diff_num_grad_updates_vs_sampler_policy": 5156.5}}, "num_env_steps_sampled": 51772560, "num_env_steps_trained": 51772560, "num_agent_steps_sampled": 51772560, "num_agent_steps_trained": 51772560}, "sampler_results": {"episode_reward_max": -10119.054446528804, "episode_reward_min": -10556.796204591585, "episode_reward_mean": -10305.20519892089, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4278083056370163, "mean_inference_ms": 0.37206534945452624, "mean_action_processing_ms": 0.0912214444877004, "mean_env_wait_ms": 0.7482754956395027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003448486328125, "StateBufferConnector_ms": 0.0025682449340820312, "ViewRequirementAgentConnector_ms": 0.06603550910949707}}, "episode_reward_max": -10119.054446528804, "episode_reward_min": -10556.796204591585, "episode_reward_mean": -10305.20519892089, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10399.474001628021, -10252.773661635209, -10372.55990011768, -10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4278083056370163, "mean_inference_ms": 0.37206534945452624, "mean_action_processing_ms": 0.0912214444877004, "mean_env_wait_ms": 0.7482754956395027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003448486328125, "StateBufferConnector_ms": 0.0025682449340820312, "ViewRequirementAgentConnector_ms": 0.06603550910949707}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51772560, "num_agent_steps_trained": 51772560, "num_env_steps_sampled": 51772560, "num_env_steps_trained": 51772560, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 270.48208453872815, "num_env_steps_trained_throughput_per_sec": 270.48208453872815, "timesteps_total": 51772560, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51772560, "timers": {"training_iteration_time_ms": 4423.996, "sample_time_ms": 4391.109, "load_time_ms": 0.579, "load_throughput": 2073565.196, "learn_time_ms": 31.498, "learn_throughput": 38097.682, "synch_weights_time_ms": 0.763}, "counters": {"num_env_steps_sampled": 51772560, "num_env_steps_trained": 51772560, "num_agent_steps_sampled": 51772560, "num_agent_steps_trained": 51772560}, "done": false, "episodes_total": 12600, "training_iteration": 3956, "trial_id": "9f686_00000", "date": "2023-08-08_15-32-13", "timestamp": 1691497933, "time_this_iter_s": 13.312448978424072, "time_total_s": 94353.9862613678, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1269.8130745887756, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 19.084210526315786, "ram_util_percent": 65.27368421052631}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -364.64067925347223, "policy_loss": -11020333.774305556, "vf_loss": 21787067.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5211.5, "diff_num_grad_updates_vs_sampler_policy": 5210.5}}, "num_env_steps_sampled": 51776160, "num_env_steps_trained": 51776160, "num_agent_steps_sampled": 51776160, "num_agent_steps_trained": 51776160}, "sampler_results": {"episode_reward_max": -10119.054446528804, "episode_reward_min": -10556.796204591585, "episode_reward_mean": -10304.692732638705, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.427800868161753, "mean_inference_ms": 0.37206690688482247, "mean_action_processing_ms": 0.09122247501584743, "mean_env_wait_ms": 0.7481004833080938, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034475326538085938, "StateBufferConnector_ms": 0.002565145492553711, "ViewRequirementAgentConnector_ms": 0.06609535217285156}}, "episode_reward_max": -10119.054446528804, "episode_reward_min": -10556.796204591585, "episode_reward_mean": -10304.692732638705, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10340.902422272391, -10301.146346840287, -10381.623573518495, -10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.427800868161753, "mean_inference_ms": 0.37206690688482247, "mean_action_processing_ms": 0.09122247501584743, "mean_env_wait_ms": 0.7481004833080938, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034475326538085938, "StateBufferConnector_ms": 0.002565145492553711, "ViewRequirementAgentConnector_ms": 0.06609535217285156}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51776160, "num_agent_steps_trained": 51776160, "num_env_steps_sampled": 51776160, "num_env_steps_trained": 51776160, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 270.19596161972265, "num_env_steps_trained_throughput_per_sec": 270.19596161972265, "timesteps_total": 51776160, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51776160, "timers": {"training_iteration_time_ms": 4440.498, "sample_time_ms": 4407.604, "load_time_ms": 0.577, "load_throughput": 2078961.09, "learn_time_ms": 31.5, "learn_throughput": 38095.174, "synch_weights_time_ms": 0.769}, "counters": {"num_env_steps_sampled": 51776160, "num_env_steps_trained": 51776160, "num_agent_steps_sampled": 51776160, "num_agent_steps_trained": 51776160}, "done": false, "episodes_total": 12603, "training_iteration": 3957, "trial_id": "9f686_00000", "date": "2023-08-08_15-32-26", "timestamp": 1691497946, "time_this_iter_s": 13.326479196548462, "time_total_s": 94367.31274056435, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1283.139553785324, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 19.099999999999998, "ram_util_percent": 64.94736842105263}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -363.3650207519531, "policy_loss": -11486333.309461806, "vf_loss": 21617167.111111112}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5265.5, "diff_num_grad_updates_vs_sampler_policy": 5264.5}}, "num_env_steps_sampled": 51779760, "num_env_steps_trained": 51779760, "num_agent_steps_sampled": 51779760, "num_agent_steps_trained": 51779760}, "sampler_results": {"episode_reward_max": -10119.054446528804, "episode_reward_min": -10556.796204591585, "episode_reward_mean": -10304.405659403868, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.427808420818497, "mean_inference_ms": 0.3720680501373459, "mean_action_processing_ms": 0.0912234316172672, "mean_env_wait_ms": 0.7479294370145324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003451824188232422, "StateBufferConnector_ms": 0.002568960189819336, "ViewRequirementAgentConnector_ms": 0.06610465049743652}}, "episode_reward_max": -10119.054446528804, "episode_reward_min": -10556.796204591585, "episode_reward_mean": -10304.405659403868, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10310.79551336749, -10322.931791740371, -10249.211392136822, -10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.427808420818497, "mean_inference_ms": 0.3720680501373459, "mean_action_processing_ms": 0.0912234316172672, "mean_env_wait_ms": 0.7479294370145324, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003451824188232422, "StateBufferConnector_ms": 0.002568960189819336, "ViewRequirementAgentConnector_ms": 0.06610465049743652}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51779760, "num_agent_steps_trained": 51779760, "num_env_steps_sampled": 51779760, "num_env_steps_trained": 51779760, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 270.03530838823383, "num_env_steps_trained_throughput_per_sec": 270.03530838823383, "timesteps_total": 51779760, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51779760, "timers": {"training_iteration_time_ms": 4444.26, "sample_time_ms": 4411.345, "load_time_ms": 0.577, "load_throughput": 2078961.09, "learn_time_ms": 31.536, "learn_throughput": 38052.174, "synch_weights_time_ms": 0.755}, "counters": {"num_env_steps_sampled": 51779760, "num_env_steps_trained": 51779760, "num_agent_steps_sampled": 51779760, "num_agent_steps_trained": 51779760}, "done": false, "episodes_total": 12606, "training_iteration": 3958, "trial_id": "9f686_00000", "date": "2023-08-08_15-32-40", "timestamp": 1691497960, "time_this_iter_s": 13.334635972976685, "time_total_s": 94380.64737653732, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1296.4741897583008, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 16.768421052631577, "ram_util_percent": 64.91052631578945}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -362.2096862792969, "policy_loss": -7141597.621527778, "vf_loss": 21104635.277777776}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5319.5, "diff_num_grad_updates_vs_sampler_policy": 5318.5}}, "num_env_steps_sampled": 51783360, "num_env_steps_trained": 51783360, "num_agent_steps_sampled": 51783360, "num_agent_steps_trained": 51783360}, "sampler_results": {"episode_reward_max": -10119.054446528804, "episode_reward_min": -10556.796204591585, "episode_reward_mean": -10302.735779121711, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.427808202097102, "mean_inference_ms": 0.37206928859020066, "mean_action_processing_ms": 0.09122450432520245, "mean_env_wait_ms": 0.7477581715721416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034554004669189453, "StateBufferConnector_ms": 0.0025691986083984375, "ViewRequirementAgentConnector_ms": 0.06611943244934082}}, "episode_reward_max": -10119.054446528804, "episode_reward_min": -10556.796204591585, "episode_reward_mean": -10302.735779121711, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10353.632411326258, -10285.197442042412, -10192.764275682981, -10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.427808202097102, "mean_inference_ms": 0.37206928859020066, "mean_action_processing_ms": 0.09122450432520245, "mean_env_wait_ms": 0.7477581715721416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034554004669189453, "StateBufferConnector_ms": 0.0025691986083984375, "ViewRequirementAgentConnector_ms": 0.06611943244934082}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51783360, "num_agent_steps_trained": 51783360, "num_env_steps_sampled": 51783360, "num_env_steps_trained": 51783360, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 274.5974271469087, "num_env_steps_trained_throughput_per_sec": 274.5974271469087, "timesteps_total": 51783360, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51783360, "timers": {"training_iteration_time_ms": 4419.074, "sample_time_ms": 4386.011, "load_time_ms": 0.575, "load_throughput": 2088623.454, "learn_time_ms": 31.677, "learn_throughput": 37882.566, "synch_weights_time_ms": 0.763}, "counters": {"num_env_steps_sampled": 51783360, "num_env_steps_trained": 51783360, "num_agent_steps_sampled": 51783360, "num_agent_steps_trained": 51783360}, "done": false, "episodes_total": 12609, "training_iteration": 3959, "trial_id": "9f686_00000", "date": "2023-08-08_15-32-53", "timestamp": 1691497973, "time_this_iter_s": 13.112973690032959, "time_total_s": 94393.76035022736, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1309.5871634483337, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 19.194736842105264, "ram_util_percent": 64.92105263157895}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -364.2842559814453, "policy_loss": -10557926.381076388, "vf_loss": 21905852.361111112}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5373.5, "diff_num_grad_updates_vs_sampler_policy": 5372.5}}, "num_env_steps_sampled": 51786960, "num_env_steps_trained": 51786960, "num_agent_steps_sampled": 51786960, "num_agent_steps_trained": 51786960}, "sampler_results": {"episode_reward_max": -10119.054446528804, "episode_reward_min": -10556.796204591585, "episode_reward_mean": -10303.316913027733, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4278111766154056, "mean_inference_ms": 0.37207042094198073, "mean_action_processing_ms": 0.09122561668347445, "mean_env_wait_ms": 0.7475951626515602, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034554004669189453, "StateBufferConnector_ms": 0.0025701522827148438, "ViewRequirementAgentConnector_ms": 0.06609892845153809}}, "episode_reward_max": -10119.054446528804, "episode_reward_min": -10556.796204591585, "episode_reward_mean": -10303.316913027733, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10301.61564234625, -10324.026417072544, -10140.109015459659, -10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4278111766154056, "mean_inference_ms": 0.37207042094198073, "mean_action_processing_ms": 0.09122561668347445, "mean_env_wait_ms": 0.7475951626515602, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034554004669189453, "StateBufferConnector_ms": 0.0025701522827148438, "ViewRequirementAgentConnector_ms": 0.06609892845153809}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51786960, "num_agent_steps_trained": 51786960, "num_env_steps_sampled": 51786960, "num_env_steps_trained": 51786960, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 269.5801676762663, "num_env_steps_trained_throughput_per_sec": 269.5801676762663, "timesteps_total": 51786960, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51786960, "timers": {"training_iteration_time_ms": 4426.67, "sample_time_ms": 4393.491, "load_time_ms": 0.575, "load_throughput": 2085507.914, "learn_time_ms": 31.801, "learn_throughput": 37734.736, "synch_weights_time_ms": 0.754}, "counters": {"num_env_steps_sampled": 51786960, "num_env_steps_trained": 51786960, "num_agent_steps_sampled": 51786960, "num_agent_steps_trained": 51786960}, "done": false, "episodes_total": 12612, "training_iteration": 3960, "trial_id": "9f686_00000", "date": "2023-08-08_15-33-06", "timestamp": 1691497986, "time_this_iter_s": 13.35696291923523, "time_total_s": 94407.11731314659, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1322.944126367569, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 18.416666666666664, "ram_util_percent": 65.02222222222221}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -363.4341549343533, "policy_loss": -5818199.692708333, "vf_loss": 21436903.972222224}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5427.5, "diff_num_grad_updates_vs_sampler_policy": 5426.5}}, "num_env_steps_sampled": 51790560, "num_env_steps_trained": 51790560, "num_agent_steps_sampled": 51790560, "num_agent_steps_trained": 51790560}, "sampler_results": {"episode_reward_max": -10119.054446528804, "episode_reward_min": -10556.796204591585, "episode_reward_mean": -10304.900991031624, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.42781297525169, "mean_inference_ms": 0.37207107866796946, "mean_action_processing_ms": 0.09122670029402322, "mean_env_wait_ms": 0.747439648299446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003457307815551758, "StateBufferConnector_ms": 0.002569437026977539, "ViewRequirementAgentConnector_ms": 0.06613516807556152}}, "episode_reward_max": -10119.054446528804, "episode_reward_min": -10556.796204591585, "episode_reward_mean": -10304.900991031624, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10492.979054254469, -10285.98794955133, -10446.216166451404, -10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.42781297525169, "mean_inference_ms": 0.37207107866796946, "mean_action_processing_ms": 0.09122670029402322, "mean_env_wait_ms": 0.747439648299446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003457307815551758, "StateBufferConnector_ms": 0.002569437026977539, "ViewRequirementAgentConnector_ms": 0.06613516807556152}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51790560, "num_agent_steps_trained": 51790560, "num_env_steps_sampled": 51790560, "num_env_steps_trained": 51790560, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 272.01712605112016, "num_env_steps_trained_throughput_per_sec": 272.01712605112016, "timesteps_total": 51790560, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51790560, "timers": {"training_iteration_time_ms": 4417.151, "sample_time_ms": 4384.168, "load_time_ms": 0.577, "load_throughput": 2078617.659, "learn_time_ms": 31.592, "learn_throughput": 37984.888, "synch_weights_time_ms": 0.765}, "counters": {"num_env_steps_sampled": 51790560, "num_env_steps_trained": 51790560, "num_agent_steps_sampled": 51790560, "num_agent_steps_trained": 51790560}, "done": false, "episodes_total": 12615, "training_iteration": 3961, "trial_id": "9f686_00000", "date": "2023-08-08_15-33-19", "timestamp": 1691497999, "time_this_iter_s": 13.237560033798218, "time_total_s": 94420.35487318039, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1336.1816864013672, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 19.80526315789474, "ram_util_percent": 64.94210526315788}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -361.71219719780817, "policy_loss": -10467234.999131944, "vf_loss": 21428875.027777776}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5481.5, "diff_num_grad_updates_vs_sampler_policy": 5480.5}}, "num_env_steps_sampled": 51794160, "num_env_steps_trained": 51794160, "num_agent_steps_sampled": 51794160, "num_agent_steps_trained": 51794160}, "sampler_results": {"episode_reward_max": -10119.054446528804, "episode_reward_min": -10556.796204591585, "episode_reward_mean": -10300.668153904742, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4278125986352084, "mean_inference_ms": 0.37207099368454233, "mean_action_processing_ms": 0.09122774912427921, "mean_env_wait_ms": 0.7472831574325515, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034568309783935547, "StateBufferConnector_ms": 0.0025713443756103516, "ViewRequirementAgentConnector_ms": 0.06615638732910156}}, "episode_reward_max": -10119.054446528804, "episode_reward_min": -10556.796204591585, "episode_reward_mean": -10300.668153904742, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10242.999236393094, -10324.108327858858, -10303.192607586747, -10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4278125986352084, "mean_inference_ms": 0.37207099368454233, "mean_action_processing_ms": 0.09122774912427921, "mean_env_wait_ms": 0.7472831574325515, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034568309783935547, "StateBufferConnector_ms": 0.0025713443756103516, "ViewRequirementAgentConnector_ms": 0.06615638732910156}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51794160, "num_agent_steps_trained": 51794160, "num_env_steps_sampled": 51794160, "num_env_steps_trained": 51794160, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 274.05801065809175, "num_env_steps_trained_throughput_per_sec": 274.05801065809175, "timesteps_total": 51794160, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51794160, "timers": {"training_iteration_time_ms": 4411.805, "sample_time_ms": 4379.07, "load_time_ms": 0.575, "load_throughput": 2085680.756, "learn_time_ms": 31.359, "learn_throughput": 38266.608, "synch_weights_time_ms": 0.753}, "counters": {"num_env_steps_sampled": 51794160, "num_env_steps_trained": 51794160, "num_agent_steps_sampled": 51794160, "num_agent_steps_trained": 51794160}, "done": false, "episodes_total": 12618, "training_iteration": 3962, "trial_id": "9f686_00000", "date": "2023-08-08_15-33-33", "timestamp": 1691498013, "time_this_iter_s": 13.138874053955078, "time_total_s": 94433.49374723434, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1349.3205604553223, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 19.736842105263158, "ram_util_percent": 65.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -361.70082092285156, "policy_loss": -12061477.676215278, "vf_loss": 22016067.111111112}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5535.5, "diff_num_grad_updates_vs_sampler_policy": 5534.5}}, "num_env_steps_sampled": 51797760, "num_env_steps_trained": 51797760, "num_agent_steps_sampled": 51797760, "num_agent_steps_trained": 51797760}, "sampler_results": {"episode_reward_max": -10119.054446528804, "episode_reward_min": -10556.796204591585, "episode_reward_mean": -10303.048417018083, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4278224579166583, "mean_inference_ms": 0.37207021565787834, "mean_action_processing_ms": 0.09122879089276986, "mean_env_wait_ms": 0.7471333231975553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003455638885498047, "StateBufferConnector_ms": 0.0025725364685058594, "ViewRequirementAgentConnector_ms": 0.06620001792907715}}, "episode_reward_max": -10119.054446528804, "episode_reward_min": -10556.796204591585, "episode_reward_mean": -10303.048417018083, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10286.593985997995, -10119.054446528804, -10372.08189957597, -10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4278224579166583, "mean_inference_ms": 0.37207021565787834, "mean_action_processing_ms": 0.09122879089276986, "mean_env_wait_ms": 0.7471333231975553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003455638885498047, "StateBufferConnector_ms": 0.0025725364685058594, "ViewRequirementAgentConnector_ms": 0.06620001792907715}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51797760, "num_agent_steps_trained": 51797760, "num_env_steps_sampled": 51797760, "num_env_steps_trained": 51797760, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 268.8468514264272, "num_env_steps_trained_throughput_per_sec": 268.8468514264272, "timesteps_total": 51797760, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51797760, "timers": {"training_iteration_time_ms": 4422.419, "sample_time_ms": 4389.567, "load_time_ms": 0.575, "load_throughput": 2085767.187, "learn_time_ms": 31.466, "learn_throughput": 38136.277, "synch_weights_time_ms": 0.762}, "counters": {"num_env_steps_sampled": 51797760, "num_env_steps_trained": 51797760, "num_agent_steps_sampled": 51797760, "num_agent_steps_trained": 51797760}, "done": false, "episodes_total": 12621, "training_iteration": 3963, "trial_id": "9f686_00000", "date": "2023-08-08_15-33-46", "timestamp": 1691498026, "time_this_iter_s": 13.393380165100098, "time_total_s": 94446.88712739944, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1362.7139406204224, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 18.321052631578947, "ram_util_percent": 65.26315789473684}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -361.7723558213976, "policy_loss": -9711415.323784722, "vf_loss": 21560973.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5589.5, "diff_num_grad_updates_vs_sampler_policy": 5588.5}}, "num_env_steps_sampled": 51801360, "num_env_steps_trained": 51801360, "num_agent_steps_sampled": 51801360, "num_agent_steps_trained": 51801360}, "sampler_results": {"episode_reward_max": -10126.325846916223, "episode_reward_min": -10556.796204591585, "episode_reward_mean": -10305.104594695127, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4278344740502793, "mean_inference_ms": 0.37206914018051535, "mean_action_processing_ms": 0.09122971157904508, "mean_env_wait_ms": 0.7469927740669519, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003427267074584961, "StateBufferConnector_ms": 0.0025713443756103516, "ViewRequirementAgentConnector_ms": 0.06613469123840332}}, "episode_reward_max": -10126.325846916223, "episode_reward_min": -10556.796204591585, "episode_reward_mean": -10305.104594695127, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10253.668652281027, -10264.320493032435, -10471.971487553565, -10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4278344740502793, "mean_inference_ms": 0.37206914018051535, "mean_action_processing_ms": 0.09122971157904508, "mean_env_wait_ms": 0.7469927740669519, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003427267074584961, "StateBufferConnector_ms": 0.0025713443756103516, "ViewRequirementAgentConnector_ms": 0.06613469123840332}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51801360, "num_agent_steps_trained": 51801360, "num_env_steps_sampled": 51801360, "num_env_steps_trained": 51801360, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 271.0468441713158, "num_env_steps_trained_throughput_per_sec": 271.0468441713158, "timesteps_total": 51801360, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51801360, "timers": {"training_iteration_time_ms": 4416.184, "sample_time_ms": 4382.981, "load_time_ms": 0.579, "load_throughput": 2073992.418, "learn_time_ms": 31.802, "learn_throughput": 37733.973, "synch_weights_time_ms": 0.773}, "counters": {"num_env_steps_sampled": 51801360, "num_env_steps_trained": 51801360, "num_agent_steps_sampled": 51801360, "num_agent_steps_trained": 51801360}, "done": false, "episodes_total": 12624, "training_iteration": 3964, "trial_id": "9f686_00000", "date": "2023-08-08_15-33-59", "timestamp": 1691498039, "time_this_iter_s": 13.284731149673462, "time_total_s": 94460.17185854912, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1375.9986717700958, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 18.83157894736842, "ram_util_percent": 65.2578947368421}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -366.5321095784505, "policy_loss": -5562674.928819444, "vf_loss": 21449046.944444444}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5643.5, "diff_num_grad_updates_vs_sampler_policy": 5642.5}}, "num_env_steps_sampled": 51804960, "num_env_steps_trained": 51804960, "num_agent_steps_sampled": 51804960, "num_agent_steps_trained": 51804960}, "sampler_results": {"episode_reward_max": -10126.325846916223, "episode_reward_min": -10556.796204591585, "episode_reward_mean": -10304.417320303088, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.427849392852642, "mean_inference_ms": 0.37206760834921804, "mean_action_processing_ms": 0.09123064124293613, "mean_env_wait_ms": 0.7468488777750971, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034275054931640625, "StateBufferConnector_ms": 0.0025725364685058594, "ViewRequirementAgentConnector_ms": 0.06611418724060059}}, "episode_reward_max": -10126.325846916223, "episode_reward_min": -10556.796204591585, "episode_reward_mean": -10304.417320303088, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10486.624545620794, -10227.110185212108, -10162.602207784801, -10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.427849392852642, "mean_inference_ms": 0.37206760834921804, "mean_action_processing_ms": 0.09123064124293613, "mean_env_wait_ms": 0.7468488777750971, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034275054931640625, "StateBufferConnector_ms": 0.0025725364685058594, "ViewRequirementAgentConnector_ms": 0.06611418724060059}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51804960, "num_agent_steps_trained": 51804960, "num_env_steps_sampled": 51804960, "num_env_steps_trained": 51804960, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 271.5267921489733, "num_env_steps_trained_throughput_per_sec": 271.5267921489733, "timesteps_total": 51804960, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51804960, "timers": {"training_iteration_time_ms": 4426.909, "sample_time_ms": 4393.547, "load_time_ms": 0.578, "load_throughput": 2076816.505, "learn_time_ms": 31.95, "learn_throughput": 37559.053, "synch_weights_time_ms": 0.784}, "counters": {"num_env_steps_sampled": 51804960, "num_env_steps_trained": 51804960, "num_agent_steps_sampled": 51804960, "num_agent_steps_trained": 51804960}, "done": false, "episodes_total": 12627, "training_iteration": 3965, "trial_id": "9f686_00000", "date": "2023-08-08_15-34-13", "timestamp": 1691498053, "time_this_iter_s": 13.261850833892822, "time_total_s": 94473.43370938301, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1389.2605226039886, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 18.273684210526316, "ram_util_percent": 65.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -365.26150851779516, "policy_loss": -5448980.270833333, "vf_loss": 21299529.111111112}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5697.5, "diff_num_grad_updates_vs_sampler_policy": 5696.5}}, "num_env_steps_sampled": 51808560, "num_env_steps_trained": 51808560, "num_agent_steps_sampled": 51808560, "num_agent_steps_trained": 51808560}, "sampler_results": {"episode_reward_max": -10126.325846916223, "episode_reward_min": -10556.796204591585, "episode_reward_mean": -10302.952615672382, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4278687770863776, "mean_inference_ms": 0.3720656637352948, "mean_action_processing_ms": 0.09123157281487171, "mean_env_wait_ms": 0.7467026511052087, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003421306610107422, "StateBufferConnector_ms": 0.002570629119873047, "ViewRequirementAgentConnector_ms": 0.06610727310180664}}, "episode_reward_max": -10126.325846916223, "episode_reward_min": -10556.796204591585, "episode_reward_mean": -10302.952615672382, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10276.96999409543, -10302.055982269105, -10295.570730482099, -10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4278687770863776, "mean_inference_ms": 0.3720656637352948, "mean_action_processing_ms": 0.09123157281487171, "mean_env_wait_ms": 0.7467026511052087, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003421306610107422, "StateBufferConnector_ms": 0.002570629119873047, "ViewRequirementAgentConnector_ms": 0.06610727310180664}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51808560, "num_agent_steps_trained": 51808560, "num_env_steps_sampled": 51808560, "num_env_steps_trained": 51808560, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 272.4426883632133, "num_env_steps_trained_throughput_per_sec": 272.4426883632133, "timesteps_total": 51808560, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51808560, "timers": {"training_iteration_time_ms": 4421.373, "sample_time_ms": 4387.751, "load_time_ms": 0.579, "load_throughput": 2071090.774, "learn_time_ms": 32.189, "learn_throughput": 37279.582, "synch_weights_time_ms": 0.803}, "counters": {"num_env_steps_sampled": 51808560, "num_env_steps_trained": 51808560, "num_agent_steps_sampled": 51808560, "num_agent_steps_trained": 51808560}, "done": false, "episodes_total": 12630, "training_iteration": 3966, "trial_id": "9f686_00000", "date": "2023-08-08_15-34-26", "timestamp": 1691498066, "time_this_iter_s": 13.216882944107056, "time_total_s": 94486.65059232712, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1402.4774055480957, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 19.2, "ram_util_percent": 64.92222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -370.08184983995227, "policy_loss": -2198979.218315972, "vf_loss": 21426146.055555556}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5751.5, "diff_num_grad_updates_vs_sampler_policy": 5750.5}}, "num_env_steps_sampled": 51812160, "num_env_steps_trained": 51812160, "num_agent_steps_sampled": 51812160, "num_agent_steps_trained": 51812160}, "sampler_results": {"episode_reward_max": -10126.325846916223, "episode_reward_min": -10556.796204591585, "episode_reward_mean": -10302.512725603932, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4278956376491942, "mean_inference_ms": 0.372062676624768, "mean_action_processing_ms": 0.09123235415722936, "mean_env_wait_ms": 0.7465662875310483, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003419160842895508, "StateBufferConnector_ms": 0.002568960189819336, "ViewRequirementAgentConnector_ms": 0.06612467765808105}}, "episode_reward_max": -10126.325846916223, "episode_reward_min": -10556.796204591585, "episode_reward_mean": -10302.512725603932, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10281.574692484037, -10339.797552286978, -10247.387368782931, -10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4278956376491942, "mean_inference_ms": 0.372062676624768, "mean_action_processing_ms": 0.09123235415722936, "mean_env_wait_ms": 0.7465662875310483, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003419160842895508, "StateBufferConnector_ms": 0.002568960189819336, "ViewRequirementAgentConnector_ms": 0.06612467765808105}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51812160, "num_agent_steps_trained": 51812160, "num_env_steps_sampled": 51812160, "num_env_steps_trained": 51812160, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 272.30091882095167, "num_env_steps_trained_throughput_per_sec": 272.30091882095167, "timesteps_total": 51812160, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51812160, "timers": {"training_iteration_time_ms": 4410.755, "sample_time_ms": 4377.333, "load_time_ms": 0.574, "load_throughput": 2090445.155, "learn_time_ms": 32.009, "learn_throughput": 37489.924, "synch_weights_time_ms": 0.79}, "counters": {"num_env_steps_sampled": 51812160, "num_env_steps_trained": 51812160, "num_agent_steps_sampled": 51812160, "num_agent_steps_trained": 51812160}, "done": false, "episodes_total": 12633, "training_iteration": 3967, "trial_id": "9f686_00000", "date": "2023-08-08_15-34-39", "timestamp": 1691498079, "time_this_iter_s": 13.223763942718506, "time_total_s": 94499.87435626984, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1415.7011694908142, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 18.47894736842105, "ram_util_percent": 64.84736842105264}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -362.92984347873266, "policy_loss": -4102001.9991319445, "vf_loss": 21089457.611111112}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5805.5, "diff_num_grad_updates_vs_sampler_policy": 5804.5}}, "num_env_steps_sampled": 51815760, "num_env_steps_trained": 51815760, "num_agent_steps_sampled": 51815760, "num_agent_steps_trained": 51815760}, "sampler_results": {"episode_reward_max": -10126.325846916223, "episode_reward_min": -10556.796204591585, "episode_reward_mean": -10303.076086331248, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.427925752023617, "mean_inference_ms": 0.372058742379219, "mean_action_processing_ms": 0.09123301097205776, "mean_env_wait_ms": 0.7464370984419806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003423452377319336, "StateBufferConnector_ms": 0.002568960189819336, "ViewRequirementAgentConnector_ms": 0.0660851001739502}}, "episode_reward_max": -10126.325846916223, "episode_reward_min": -10556.796204591585, "episode_reward_mean": -10303.076086331248, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10299.37616581708, -10389.964047367857, -10280.72202794867, -10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.427925752023617, "mean_inference_ms": 0.372058742379219, "mean_action_processing_ms": 0.09123301097205776, "mean_env_wait_ms": 0.7464370984419806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003423452377319336, "StateBufferConnector_ms": 0.002568960189819336, "ViewRequirementAgentConnector_ms": 0.0660851001739502}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51815760, "num_agent_steps_trained": 51815760, "num_env_steps_sampled": 51815760, "num_env_steps_trained": 51815760, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 271.2131219529263, "num_env_steps_trained_throughput_per_sec": 271.2131219529263, "timesteps_total": 51815760, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51815760, "timers": {"training_iteration_time_ms": 4411.872, "sample_time_ms": 4378.628, "load_time_ms": 0.573, "load_throughput": 2093401.323, "learn_time_ms": 31.82, "learn_throughput": 37711.807, "synch_weights_time_ms": 0.801}, "counters": {"num_env_steps_sampled": 51815760, "num_env_steps_trained": 51815760, "num_agent_steps_sampled": 51815760, "num_agent_steps_trained": 51815760}, "done": false, "episodes_total": 12636, "training_iteration": 3968, "trial_id": "9f686_00000", "date": "2023-08-08_15-34-52", "timestamp": 1691498092, "time_this_iter_s": 13.27652382850647, "time_total_s": 94513.15088009834, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1428.9776933193207, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 18.689473684210526, "ram_util_percent": 65.00000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -362.54689534505206, "policy_loss": -8195307.396701389, "vf_loss": 21452784.111111112}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5859.5, "diff_num_grad_updates_vs_sampler_policy": 5858.5}}, "num_env_steps_sampled": 51819360, "num_env_steps_trained": 51819360, "num_agent_steps_sampled": 51819360, "num_agent_steps_trained": 51819360}, "sampler_results": {"episode_reward_max": -10126.325846916223, "episode_reward_min": -10556.796204591585, "episode_reward_mean": -10300.588204866152, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4279553973562016, "mean_inference_ms": 0.37205422150471096, "mean_action_processing_ms": 0.09123365296492818, "mean_env_wait_ms": 0.7463076996220117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034220218658447266, "StateBufferConnector_ms": 0.0025610923767089844, "ViewRequirementAgentConnector_ms": 0.06611227989196777}}, "episode_reward_max": -10126.325846916223, "episode_reward_min": -10556.796204591585, "episode_reward_mean": -10300.588204866152, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10273.060559476702, -10393.185943441022, -10232.911179896495, -10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4279553973562016, "mean_inference_ms": 0.37205422150471096, "mean_action_processing_ms": 0.09123365296492818, "mean_env_wait_ms": 0.7463076996220117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034220218658447266, "StateBufferConnector_ms": 0.0025610923767089844, "ViewRequirementAgentConnector_ms": 0.06611227989196777}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51819360, "num_agent_steps_trained": 51819360, "num_env_steps_sampled": 51819360, "num_env_steps_trained": 51819360, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 272.10452306382, "num_env_steps_trained_throughput_per_sec": 272.10452306382, "timesteps_total": 51819360, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51819360, "timers": {"training_iteration_time_ms": 4413.335, "sample_time_ms": 4380.189, "load_time_ms": 0.574, "load_throughput": 2091139.973, "learn_time_ms": 31.747, "learn_throughput": 37799.009, "synch_weights_time_ms": 0.777}, "counters": {"num_env_steps_sampled": 51819360, "num_env_steps_trained": 51819360, "num_agent_steps_sampled": 51819360, "num_agent_steps_trained": 51819360}, "done": false, "episodes_total": 12639, "training_iteration": 3969, "trial_id": "9f686_00000", "date": "2023-08-08_15-35-06", "timestamp": 1691498106, "time_this_iter_s": 13.233081102371216, "time_total_s": 94526.38396120071, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1442.210774421692, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 19.010526315789477, "ram_util_percent": 64.96842105263158}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -362.98980712890625, "policy_loss": -4740850.134114583, "vf_loss": 21787904.666666668}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5913.5, "diff_num_grad_updates_vs_sampler_policy": 5912.5}}, "num_env_steps_sampled": 51822960, "num_env_steps_trained": 51822960, "num_agent_steps_sampled": 51822960, "num_agent_steps_trained": 51822960}, "sampler_results": {"episode_reward_max": -10126.325846916223, "episode_reward_min": -10556.796204591585, "episode_reward_mean": -10301.917932630718, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4279761360954653, "mean_inference_ms": 0.37204933396288586, "mean_action_processing_ms": 0.09123437038712817, "mean_env_wait_ms": 0.7461861211640165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034170150756835938, "StateBufferConnector_ms": 0.0025603771209716797, "ViewRequirementAgentConnector_ms": 0.06609916687011719}}, "episode_reward_max": -10126.325846916223, "episode_reward_min": -10556.796204591585, "episode_reward_mean": -10301.917932630718, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10202.02333202503, -10387.73411014681, -10252.429886522892, -10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4279761360954653, "mean_inference_ms": 0.37204933396288586, "mean_action_processing_ms": 0.09123437038712817, "mean_env_wait_ms": 0.7461861211640165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034170150756835938, "StateBufferConnector_ms": 0.0025603771209716797, "ViewRequirementAgentConnector_ms": 0.06609916687011719}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51822960, "num_agent_steps_trained": 51822960, "num_env_steps_sampled": 51822960, "num_env_steps_trained": 51822960, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 273.7282657464738, "num_env_steps_trained_throughput_per_sec": 273.7282657464738, "timesteps_total": 51822960, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51822960, "timers": {"training_iteration_time_ms": 4404.168, "sample_time_ms": 4370.972, "load_time_ms": 0.578, "load_throughput": 2077502.291, "learn_time_ms": 31.786, "learn_throughput": 37752.936, "synch_weights_time_ms": 0.785}, "counters": {"num_env_steps_sampled": 51822960, "num_env_steps_trained": 51822960, "num_agent_steps_sampled": 51822960, "num_agent_steps_trained": 51822960}, "done": false, "episodes_total": 12642, "training_iteration": 3970, "trial_id": "9f686_00000", "date": "2023-08-08_15-35-19", "timestamp": 1691498119, "time_this_iter_s": 13.15478229522705, "time_total_s": 94539.53874349594, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1455.365556716919, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 18.005555555555556, "ram_util_percent": 64.87222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -361.95881822374133, "policy_loss": -12003810.688368056, "vf_loss": 21962380.027777776}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5967.5, "diff_num_grad_updates_vs_sampler_policy": 5966.5}}, "num_env_steps_sampled": 51826560, "num_env_steps_trained": 51826560, "num_agent_steps_sampled": 51826560, "num_agent_steps_trained": 51826560}, "sampler_results": {"episode_reward_max": -10126.325846916223, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10306.220057552928, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4279971835745093, "mean_inference_ms": 0.3720440718022018, "mean_action_processing_ms": 0.09123503160497208, "mean_env_wait_ms": 0.7460765186717986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003412961959838867, "StateBufferConnector_ms": 0.002557039260864258, "ViewRequirementAgentConnector_ms": 0.06605744361877441}}, "episode_reward_max": -10126.325846916223, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10306.220057552928, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10194.744859054174, -10318.800958748157, -10556.796204591585, -10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4279971835745093, "mean_inference_ms": 0.3720440718022018, "mean_action_processing_ms": 0.09123503160497208, "mean_env_wait_ms": 0.7460765186717986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003412961959838867, "StateBufferConnector_ms": 0.002557039260864258, "ViewRequirementAgentConnector_ms": 0.06605744361877441}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51826560, "num_agent_steps_trained": 51826560, "num_env_steps_sampled": 51826560, "num_env_steps_trained": 51826560, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 269.9132659197315, "num_env_steps_trained_throughput_per_sec": 269.9132659197315, "timesteps_total": 51826560, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51826560, "timers": {"training_iteration_time_ms": 4413.395, "sample_time_ms": 4380.141, "load_time_ms": 0.578, "load_throughput": 2076216.814, "learn_time_ms": 31.862, "learn_throughput": 37662.198, "synch_weights_time_ms": 0.766}, "counters": {"num_env_steps_sampled": 51826560, "num_env_steps_trained": 51826560, "num_agent_steps_sampled": 51826560, "num_agent_steps_trained": 51826560}, "done": false, "episodes_total": 12645, "training_iteration": 3971, "trial_id": "9f686_00000", "date": "2023-08-08_15-35-32", "timestamp": 1691498132, "time_this_iter_s": 13.340450048446655, "time_total_s": 94552.87919354439, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1468.7060067653656, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 20.54736842105263, "ram_util_percent": 64.96842105263157}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -361.4105936686198, "policy_loss": -8174642.08203125, "vf_loss": 22041813.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6021.5, "diff_num_grad_updates_vs_sampler_policy": 6020.5}}, "num_env_steps_sampled": 51830160, "num_env_steps_trained": 51830160, "num_agent_steps_sampled": 51830160, "num_agent_steps_trained": 51830160}, "sampler_results": {"episode_reward_max": -10126.325846916223, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10307.265149937877, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428023385785, "mean_inference_ms": 0.37203775843246456, "mean_action_processing_ms": 0.09123556379740266, "mean_env_wait_ms": 0.745969222224882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034072399139404297, "StateBufferConnector_ms": 0.0025556087493896484, "ViewRequirementAgentConnector_ms": 0.06604290008544922}}, "episode_reward_max": -10126.325846916223, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10307.265149937877, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10374.272232640182, -10311.159380715859, -10257.174132752636, -10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428023385785, "mean_inference_ms": 0.37203775843246456, "mean_action_processing_ms": 0.09123556379740266, "mean_env_wait_ms": 0.745969222224882, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034072399139404297, "StateBufferConnector_ms": 0.0025556087493896484, "ViewRequirementAgentConnector_ms": 0.06604290008544922}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51830160, "num_agent_steps_trained": 51830160, "num_env_steps_sampled": 51830160, "num_env_steps_trained": 51830160, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 269.2455812512211, "num_env_steps_trained_throughput_per_sec": 269.2455812512211, "timesteps_total": 51830160, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51830160, "timers": {"training_iteration_time_ms": 4430.329, "sample_time_ms": 4397.032, "load_time_ms": 0.583, "load_throughput": 2058806.725, "learn_time_ms": 31.885, "learn_throughput": 37635.782, "synch_weights_time_ms": 0.781}, "counters": {"num_env_steps_sampled": 51830160, "num_env_steps_trained": 51830160, "num_agent_steps_sampled": 51830160, "num_agent_steps_trained": 51830160}, "done": false, "episodes_total": 12648, "training_iteration": 3972, "trial_id": "9f686_00000", "date": "2023-08-08_15-35-46", "timestamp": 1691498146, "time_this_iter_s": 13.373641014099121, "time_total_s": 94566.25283455849, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1482.0796477794647, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 18.489473684210523, "ram_util_percent": 65.20526315789475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -362.72871738009985, "policy_loss": -4390107.571180556, "vf_loss": 21176721.361111112}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6075.5, "diff_num_grad_updates_vs_sampler_policy": 6074.5}}, "num_env_steps_sampled": 51833760, "num_env_steps_trained": 51833760, "num_agent_steps_sampled": 51833760, "num_agent_steps_trained": 51833760}, "sampler_results": {"episode_reward_max": -10126.325846916223, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10305.91227207029, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4280527145242687, "mean_inference_ms": 0.3720304608188002, "mean_action_processing_ms": 0.09123602140611023, "mean_env_wait_ms": 0.7458544551499072, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00341033935546875, "StateBufferConnector_ms": 0.00255584716796875, "ViewRequirementAgentConnector_ms": 0.06601929664611816}}, "episode_reward_max": -10126.325846916223, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10305.91227207029, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10336.247608061785, -10323.362288061993, -10263.97939942675, -10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4280527145242687, "mean_inference_ms": 0.3720304608188002, "mean_action_processing_ms": 0.09123602140611023, "mean_env_wait_ms": 0.7458544551499072, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00341033935546875, "StateBufferConnector_ms": 0.00255584716796875, "ViewRequirementAgentConnector_ms": 0.06601929664611816}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51833760, "num_agent_steps_trained": 51833760, "num_env_steps_sampled": 51833760, "num_env_steps_trained": 51833760, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 273.05648926822226, "num_env_steps_trained_throughput_per_sec": 273.05648926822226, "timesteps_total": 51833760, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51833760, "timers": {"training_iteration_time_ms": 4423.133, "sample_time_ms": 4389.862, "load_time_ms": 0.582, "load_throughput": 2062518.871, "learn_time_ms": 31.843, "learn_throughput": 37684.982, "synch_weights_time_ms": 0.796}, "counters": {"num_env_steps_sampled": 51833760, "num_env_steps_trained": 51833760, "num_agent_steps_sampled": 51833760, "num_agent_steps_trained": 51833760}, "done": false, "episodes_total": 12651, "training_iteration": 3973, "trial_id": "9f686_00000", "date": "2023-08-08_15-35-59", "timestamp": 1691498159, "time_this_iter_s": 13.186952829360962, "time_total_s": 94579.43978738785, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1495.2666006088257, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 19.878947368421052, "ram_util_percent": 65.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -364.98949347601996, "policy_loss": -5975289.694444444, "vf_loss": 21249544.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6129.5, "diff_num_grad_updates_vs_sampler_policy": 6128.5}}, "num_env_steps_sampled": 51837360, "num_env_steps_trained": 51837360, "num_agent_steps_sampled": 51837360, "num_agent_steps_trained": 51837360}, "sampler_results": {"episode_reward_max": -10126.325846916223, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10304.925836403629, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428080980628071, "mean_inference_ms": 0.3720225016319418, "mean_action_processing_ms": 0.09123650951253716, "mean_env_wait_ms": 0.7457378051207456, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003408193588256836, "StateBufferConnector_ms": 0.002552509307861328, "ViewRequirementAgentConnector_ms": 0.06602811813354492}}, "episode_reward_max": -10126.325846916223, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10304.925836403629, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10259.60312218525, -10264.528082023395, -10262.232862968338, -10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428080980628071, "mean_inference_ms": 0.3720225016319418, "mean_action_processing_ms": 0.09123650951253716, "mean_env_wait_ms": 0.7457378051207456, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003408193588256836, "StateBufferConnector_ms": 0.002552509307861328, "ViewRequirementAgentConnector_ms": 0.06602811813354492}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51837360, "num_agent_steps_trained": 51837360, "num_env_steps_sampled": 51837360, "num_env_steps_trained": 51837360, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 275.42856021301594, "num_env_steps_trained_throughput_per_sec": 275.42856021301594, "timesteps_total": 51837360, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51837360, "timers": {"training_iteration_time_ms": 4403.291, "sample_time_ms": 4370.12, "load_time_ms": 0.585, "load_throughput": 2052509.909, "learn_time_ms": 31.723, "learn_throughput": 37827.19, "synch_weights_time_ms": 0.812}, "counters": {"num_env_steps_sampled": 51837360, "num_env_steps_trained": 51837360, "num_agent_steps_sampled": 51837360, "num_agent_steps_trained": 51837360}, "done": false, "episodes_total": 12654, "training_iteration": 3974, "trial_id": "9f686_00000", "date": "2023-08-08_15-36-12", "timestamp": 1691498172, "time_this_iter_s": 13.073407888412476, "time_total_s": 94592.51319527626, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1508.3400084972382, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 20.494444444444444, "ram_util_percent": 65.18888888888888}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -362.56935119628906, "policy_loss": -1534999.5052083333, "vf_loss": 20880012.083333332}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6183.5, "diff_num_grad_updates_vs_sampler_policy": 6182.5}}, "num_env_steps_sampled": 51840960, "num_env_steps_trained": 51840960, "num_agent_steps_sampled": 51840960, "num_agent_steps_trained": 51840960}, "sampler_results": {"episode_reward_max": -10126.325846916223, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10303.598792870747, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428110884572717, "mean_inference_ms": 0.3720146821557489, "mean_action_processing_ms": 0.09123709801699828, "mean_env_wait_ms": 0.7456222408921146, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003413677215576172, "StateBufferConnector_ms": 0.0025560855865478516, "ViewRequirementAgentConnector_ms": 0.0659935474395752}}, "episode_reward_max": -10126.325846916223, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10303.598792870747, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10211.025874008836, -10283.25097515548, -10345.621418165174, -10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428110884572717, "mean_inference_ms": 0.3720146821557489, "mean_action_processing_ms": 0.09123709801699828, "mean_env_wait_ms": 0.7456222408921146, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003413677215576172, "StateBufferConnector_ms": 0.0025560855865478516, "ViewRequirementAgentConnector_ms": 0.0659935474395752}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51840960, "num_agent_steps_trained": 51840960, "num_env_steps_sampled": 51840960, "num_env_steps_trained": 51840960, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 274.27390635975297, "num_env_steps_trained_throughput_per_sec": 274.27390635975297, "timesteps_total": 51840960, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51840960, "timers": {"training_iteration_time_ms": 4383.98, "sample_time_ms": 4350.798, "load_time_ms": 0.579, "load_throughput": 2074077.884, "learn_time_ms": 31.733, "learn_throughput": 37815.026, "synch_weights_time_ms": 0.82}, "counters": {"num_env_steps_sampled": 51840960, "num_env_steps_trained": 51840960, "num_agent_steps_sampled": 51840960, "num_agent_steps_trained": 51840960}, "done": false, "episodes_total": 12657, "training_iteration": 3975, "trial_id": "9f686_00000", "date": "2023-08-08_15-36-25", "timestamp": 1691498185, "time_this_iter_s": 13.128467798233032, "time_total_s": 94605.6416630745, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1521.4684762954712, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 19.594736842105263, "ram_util_percent": 65.03684210526315}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -366.78160264756946, "policy_loss": -6553005.900173611, "vf_loss": 21238291.416666668}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6237.5, "diff_num_grad_updates_vs_sampler_policy": 6236.5}}, "num_env_steps_sampled": 51844560, "num_env_steps_trained": 51844560, "num_agent_steps_sampled": 51844560, "num_agent_steps_trained": 51844560}, "sampler_results": {"episode_reward_max": -10126.325846916223, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10304.969561979759, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428142774567963, "mean_inference_ms": 0.37200650169429805, "mean_action_processing_ms": 0.09123765639212598, "mean_env_wait_ms": 0.7455123042610782, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034134387969970703, "StateBufferConnector_ms": 0.0025496482849121094, "ViewRequirementAgentConnector_ms": 0.06597137451171875}}, "episode_reward_max": -10126.325846916223, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10304.969561979759, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10249.237524977241, -10217.264438038826, -10302.383447635131, -10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428142774567963, "mean_inference_ms": 0.37200650169429805, "mean_action_processing_ms": 0.09123765639212598, "mean_env_wait_ms": 0.7455123042610782, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034134387969970703, "StateBufferConnector_ms": 0.0025496482849121094, "ViewRequirementAgentConnector_ms": 0.06597137451171875}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51844560, "num_agent_steps_trained": 51844560, "num_env_steps_sampled": 51844560, "num_env_steps_trained": 51844560, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 272.3535314829941, "num_env_steps_trained_throughput_per_sec": 272.3535314829941, "timesteps_total": 51844560, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51844560, "timers": {"training_iteration_time_ms": 4380.259, "sample_time_ms": 4346.951, "load_time_ms": 0.58, "load_throughput": 2069472.801, "learn_time_ms": 31.871, "learn_throughput": 37651.238, "synch_weights_time_ms": 0.806}, "counters": {"num_env_steps_sampled": 51844560, "num_env_steps_trained": 51844560, "num_agent_steps_sampled": 51844560, "num_agent_steps_trained": 51844560}, "done": false, "episodes_total": 12660, "training_iteration": 3976, "trial_id": "9f686_00000", "date": "2023-08-08_15-36-38", "timestamp": 1691498198, "time_this_iter_s": 13.220967054367065, "time_total_s": 94618.86263012886, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1534.6894433498383, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 19.036842105263162, "ram_util_percent": 64.88947368421053}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -361.9476606580946, "policy_loss": -11147566.627604166, "vf_loss": 21784527.222222224}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6291.5, "diff_num_grad_updates_vs_sampler_policy": 6290.5}}, "num_env_steps_sampled": 51848160, "num_env_steps_trained": 51848160, "num_agent_steps_sampled": 51848160, "num_agent_steps_trained": 51848160}, "sampler_results": {"episode_reward_max": -10126.325846916223, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10309.399771591583, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4281759583884934, "mean_inference_ms": 0.3719981312837382, "mean_action_processing_ms": 0.0912381276979302, "mean_env_wait_ms": 0.7454136450203993, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034093856811523438, "StateBufferConnector_ms": 0.0025506019592285156, "ViewRequirementAgentConnector_ms": 0.06601166725158691}}, "episode_reward_max": -10126.325846916223, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10309.399771591583, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10274.335420890091, -10376.17883173548, -10372.981181121295, -10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4281759583884934, "mean_inference_ms": 0.3719981312837382, "mean_action_processing_ms": 0.0912381276979302, "mean_env_wait_ms": 0.7454136450203993, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034093856811523438, "StateBufferConnector_ms": 0.0025506019592285156, "ViewRequirementAgentConnector_ms": 0.06601166725158691}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51848160, "num_agent_steps_trained": 51848160, "num_env_steps_sampled": 51848160, "num_env_steps_trained": 51848160, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 269.94809636060955, "num_env_steps_trained_throughput_per_sec": 269.94809636060955, "timesteps_total": 51848160, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51848160, "timers": {"training_iteration_time_ms": 4406.856, "sample_time_ms": 4373.739, "load_time_ms": 0.573, "load_throughput": 2094446.673, "learn_time_ms": 31.71, "learn_throughput": 37842.775, "synch_weights_time_ms": 0.784}, "counters": {"num_env_steps_sampled": 51848160, "num_env_steps_trained": 51848160, "num_agent_steps_sampled": 51848160, "num_agent_steps_trained": 51848160}, "done": false, "episodes_total": 12663, "training_iteration": 3977, "trial_id": "9f686_00000", "date": "2023-08-08_15-36-52", "timestamp": 1691498212, "time_this_iter_s": 13.33872103691101, "time_total_s": 94632.20135116577, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1548.0281643867493, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 20.089473684210528, "ram_util_percent": 64.9105263157895}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -362.2897372775608, "policy_loss": -6479184.082899306, "vf_loss": 21300746.027777776}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6345.5, "diff_num_grad_updates_vs_sampler_policy": 6344.5}}, "num_env_steps_sampled": 51851760, "num_env_steps_trained": 51851760, "num_agent_steps_sampled": 51851760, "num_agent_steps_trained": 51851760}, "sampler_results": {"episode_reward_max": -10126.325846916223, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10309.553077365392, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428197016710888, "mean_inference_ms": 0.3719895514880979, "mean_action_processing_ms": 0.09123858537624831, "mean_env_wait_ms": 0.745321426370237, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003408670425415039, "StateBufferConnector_ms": 0.0025506019592285156, "ViewRequirementAgentConnector_ms": 0.06598234176635742}}, "episode_reward_max": -10126.325846916223, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10309.553077365392, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10233.144810770324, -10279.868097165107, -10226.814196396464, -10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428197016710888, "mean_inference_ms": 0.3719895514880979, "mean_action_processing_ms": 0.09123858537624831, "mean_env_wait_ms": 0.745321426370237, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003408670425415039, "StateBufferConnector_ms": 0.0025506019592285156, "ViewRequirementAgentConnector_ms": 0.06598234176635742}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51851760, "num_agent_steps_trained": 51851760, "num_env_steps_sampled": 51851760, "num_env_steps_trained": 51851760, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 272.5692829332123, "num_env_steps_trained_throughput_per_sec": 272.5692829332123, "timesteps_total": 51851760, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51851760, "timers": {"training_iteration_time_ms": 4413.555, "sample_time_ms": 4380.325, "load_time_ms": 0.574, "load_throughput": 2090705.658, "learn_time_ms": 31.836, "learn_throughput": 37693.421, "synch_weights_time_ms": 0.771}, "counters": {"num_env_steps_sampled": 51851760, "num_env_steps_trained": 51851760, "num_agent_steps_sampled": 51851760, "num_agent_steps_trained": 51851760}, "done": false, "episodes_total": 12666, "training_iteration": 3978, "trial_id": "9f686_00000", "date": "2023-08-08_15-37-05", "timestamp": 1691498225, "time_this_iter_s": 13.210569858551025, "time_total_s": 94645.41192102432, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1561.2387342453003, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 18.883333333333336, "ram_util_percent": 65.01111111111112}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -364.82246568467883, "policy_loss": -7149664.448784722, "vf_loss": 21322412.472222224}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6399.5, "diff_num_grad_updates_vs_sampler_policy": 6398.5}}, "num_env_steps_sampled": 51855360, "num_env_steps_trained": 51855360, "num_agent_steps_sampled": 51855360, "num_agent_steps_trained": 51855360}, "sampler_results": {"episode_reward_max": -10126.325846916223, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10308.465907959428, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428213112516408, "mean_inference_ms": 0.37198023671693375, "mean_action_processing_ms": 0.09123891433179371, "mean_env_wait_ms": 0.7452245691939727, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003407716751098633, "StateBufferConnector_ms": 0.002550840377807617, "ViewRequirementAgentConnector_ms": 0.06608796119689941}}, "episode_reward_max": -10126.325846916223, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10308.465907959428, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10551.13177908864, -10204.605491497312, -10369.761391364065, -10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428213112516408, "mean_inference_ms": 0.37198023671693375, "mean_action_processing_ms": 0.09123891433179371, "mean_env_wait_ms": 0.7452245691939727, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003407716751098633, "StateBufferConnector_ms": 0.002550840377807617, "ViewRequirementAgentConnector_ms": 0.06608796119689941}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51855360, "num_agent_steps_trained": 51855360, "num_env_steps_sampled": 51855360, "num_env_steps_trained": 51855360, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 274.4478895977314, "num_env_steps_trained_throughput_per_sec": 274.4478895977314, "timesteps_total": 51855360, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51855360, "timers": {"training_iteration_time_ms": 4407.827, "sample_time_ms": 4374.944, "load_time_ms": 0.575, "load_throughput": 2087151.068, "learn_time_ms": 31.484, "learn_throughput": 38114.473, "synch_weights_time_ms": 0.776}, "counters": {"num_env_steps_sampled": 51855360, "num_env_steps_trained": 51855360, "num_agent_steps_sampled": 51855360, "num_agent_steps_trained": 51855360}, "done": false, "episodes_total": 12669, "training_iteration": 3979, "trial_id": "9f686_00000", "date": "2023-08-08_15-37-18", "timestamp": 1691498238, "time_this_iter_s": 13.120203018188477, "time_total_s": 94658.53212404251, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1574.3589372634888, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 19.331578947368417, "ram_util_percent": 64.95789473684209}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -362.90437995062933, "policy_loss": -6531872.256510417, "vf_loss": 21390774.361111112}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6453.5, "diff_num_grad_updates_vs_sampler_policy": 6452.5}}, "num_env_steps_sampled": 51858960, "num_env_steps_trained": 51858960, "num_agent_steps_sampled": 51858960, "num_agent_steps_trained": 51858960}, "sampler_results": {"episode_reward_max": -10126.325846916223, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10306.363574784615, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4282281268240062, "mean_inference_ms": 0.371970379784868, "mean_action_processing_ms": 0.0912391011353607, "mean_env_wait_ms": 0.7451289369599021, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034089088439941406, "StateBufferConnector_ms": 0.0025517940521240234, "ViewRequirementAgentConnector_ms": 0.06606793403625488}}, "episode_reward_max": -10126.325846916223, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10306.363574784615, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10367.64337086892, -10332.546940284145, -10337.107113773736, -10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4282281268240062, "mean_inference_ms": 0.371970379784868, "mean_action_processing_ms": 0.0912391011353607, "mean_env_wait_ms": 0.7451289369599021, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034089088439941406, "StateBufferConnector_ms": 0.0025517940521240234, "ViewRequirementAgentConnector_ms": 0.06606793403625488}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51858960, "num_agent_steps_trained": 51858960, "num_env_steps_sampled": 51858960, "num_env_steps_trained": 51858960, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 271.8841065093936, "num_env_steps_trained_throughput_per_sec": 271.8841065093936, "timesteps_total": 51858960, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51858960, "timers": {"training_iteration_time_ms": 4398.053, "sample_time_ms": 4365.059, "load_time_ms": 0.576, "load_throughput": 2082401.655, "learn_time_ms": 31.597, "learn_throughput": 37978.238, "synch_weights_time_ms": 0.772}, "counters": {"num_env_steps_sampled": 51858960, "num_env_steps_trained": 51858960, "num_agent_steps_sampled": 51858960, "num_agent_steps_trained": 51858960}, "done": false, "episodes_total": 12672, "training_iteration": 3980, "trial_id": "9f686_00000", "date": "2023-08-08_15-37-31", "timestamp": 1691498251, "time_this_iter_s": 13.24370789527893, "time_total_s": 94671.77583193779, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1587.6026451587677, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 19.452631578947365, "ram_util_percent": 65.16315789473684}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -363.49224853515625, "policy_loss": -10069408.585069444, "vf_loss": 21973385.916666668}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6507.5, "diff_num_grad_updates_vs_sampler_policy": 6506.5}}, "num_env_steps_sampled": 51862560, "num_env_steps_trained": 51862560, "num_agent_steps_sampled": 51862560, "num_agent_steps_trained": 51862560}, "sampler_results": {"episode_reward_max": -10126.325846916223, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10306.238828931384, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4282441402431325, "mean_inference_ms": 0.37196010435155086, "mean_action_processing_ms": 0.09123919224152637, "mean_env_wait_ms": 0.7450370965264057, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003409862518310547, "StateBufferConnector_ms": 0.0025794506072998047, "ViewRequirementAgentConnector_ms": 0.06604838371276855}}, "episode_reward_max": -10126.325846916223, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10306.238828931384, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10305.877601035852, -10372.096889196759, -10276.012348664335, -10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4282441402431325, "mean_inference_ms": 0.37196010435155086, "mean_action_processing_ms": 0.09123919224152637, "mean_env_wait_ms": 0.7450370965264057, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003409862518310547, "StateBufferConnector_ms": 0.0025794506072998047, "ViewRequirementAgentConnector_ms": 0.06604838371276855}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51862560, "num_agent_steps_trained": 51862560, "num_env_steps_sampled": 51862560, "num_env_steps_trained": 51862560, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 272.52793410104437, "num_env_steps_trained_throughput_per_sec": 272.52793410104437, "timesteps_total": 51862560, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51862560, "timers": {"training_iteration_time_ms": 4389.802, "sample_time_ms": 4357.159, "load_time_ms": 0.576, "load_throughput": 2081798.734, "learn_time_ms": 31.247, "learn_throughput": 38403.985, "synch_weights_time_ms": 0.771}, "counters": {"num_env_steps_sampled": 51862560, "num_env_steps_trained": 51862560, "num_agent_steps_sampled": 51862560, "num_agent_steps_trained": 51862560}, "done": false, "episodes_total": 12675, "training_iteration": 3981, "trial_id": "9f686_00000", "date": "2023-08-08_15-37-45", "timestamp": 1691498265, "time_this_iter_s": 13.212754964828491, "time_total_s": 94684.98858690262, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1600.8154001235962, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 20.310526315789474, "ram_util_percent": 65.1842105263158}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -365.61991543240015, "policy_loss": -5177589.496527778, "vf_loss": 21174592.861111112}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6561.5, "diff_num_grad_updates_vs_sampler_policy": 6560.5}}, "num_env_steps_sampled": 51866160, "num_env_steps_trained": 51866160, "num_agent_steps_sampled": 51866160, "num_agent_steps_trained": 51866160}, "sampler_results": {"episode_reward_max": -10126.325846916223, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10304.24958384093, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428258767900229, "mean_inference_ms": 0.3719495899355292, "mean_action_processing_ms": 0.09123930365140226, "mean_env_wait_ms": 0.7449453485334497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003412485122680664, "StateBufferConnector_ms": 0.002577543258666992, "ViewRequirementAgentConnector_ms": 0.06603050231933594}}, "episode_reward_max": -10126.325846916223, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10304.24958384093, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10279.393511646082, -10337.803341435152, -10219.360260509073, -10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428258767900229, "mean_inference_ms": 0.3719495899355292, "mean_action_processing_ms": 0.09123930365140226, "mean_env_wait_ms": 0.7449453485334497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003412485122680664, "StateBufferConnector_ms": 0.002577543258666992, "ViewRequirementAgentConnector_ms": 0.06603050231933594}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51866160, "num_agent_steps_trained": 51866160, "num_env_steps_sampled": 51866160, "num_env_steps_trained": 51866160, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 273.5518035874314, "num_env_steps_trained_throughput_per_sec": 273.5518035874314, "timesteps_total": 51866160, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51866160, "timers": {"training_iteration_time_ms": 4392.846, "sample_time_ms": 4359.994, "load_time_ms": 0.574, "load_throughput": 2090445.155, "learn_time_ms": 31.436, "learn_throughput": 38172.489, "synch_weights_time_ms": 0.791}, "counters": {"num_env_steps_sampled": 51866160, "num_env_steps_trained": 51866160, "num_agent_steps_sampled": 51866160, "num_agent_steps_trained": 51866160}, "done": false, "episodes_total": 12678, "training_iteration": 3982, "trial_id": "9f686_00000", "date": "2023-08-08_15-37-58", "timestamp": 1691498278, "time_this_iter_s": 13.1629319190979, "time_total_s": 94698.15151882172, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1613.978332042694, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 19.455555555555556, "ram_util_percent": 65.1888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -364.79334513346356, "policy_loss": -2786045.779079861, "vf_loss": 21654063.166666668}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6615.5, "diff_num_grad_updates_vs_sampler_policy": 6614.5}}, "num_env_steps_sampled": 51869760, "num_env_steps_trained": 51869760, "num_agent_steps_sampled": 51869760, "num_agent_steps_trained": 51869760}, "sampler_results": {"episode_reward_max": -10126.325846916223, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10304.788173164776, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428280549566209, "mean_inference_ms": 0.3719393366620735, "mean_action_processing_ms": 0.09123939411770313, "mean_env_wait_ms": 0.7448491407297791, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034084320068359375, "StateBufferConnector_ms": 0.002577066421508789, "ViewRequirementAgentConnector_ms": 0.06601691246032715}}, "episode_reward_max": -10126.325846916223, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10304.788173164776, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10374.34587045484, -10126.325846916223, -10345.995770730471, -10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428280549566209, "mean_inference_ms": 0.3719393366620735, "mean_action_processing_ms": 0.09123939411770313, "mean_env_wait_ms": 0.7448491407297791, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034084320068359375, "StateBufferConnector_ms": 0.002577066421508789, "ViewRequirementAgentConnector_ms": 0.06601691246032715}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51869760, "num_agent_steps_trained": 51869760, "num_env_steps_sampled": 51869760, "num_env_steps_trained": 51869760, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 272.35762857956195, "num_env_steps_trained_throughput_per_sec": 272.35762857956195, "timesteps_total": 51869760, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51869760, "timers": {"training_iteration_time_ms": 4401.174, "sample_time_ms": 4368.312, "load_time_ms": 0.578, "load_throughput": 2077588.046, "learn_time_ms": 31.446, "learn_throughput": 38160.854, "synch_weights_time_ms": 0.787}, "counters": {"num_env_steps_sampled": 51869760, "num_env_steps_trained": 51869760, "num_agent_steps_sampled": 51869760, "num_agent_steps_trained": 51869760}, "done": false, "episodes_total": 12681, "training_iteration": 3983, "trial_id": "9f686_00000", "date": "2023-08-08_15-38-11", "timestamp": 1691498291, "time_this_iter_s": 13.220762014389038, "time_total_s": 94711.3722808361, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1627.1990940570831, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 19.46315789473684, "ram_util_percent": 65.22631578947369}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -361.8455980088976, "policy_loss": -7072995.751302083, "vf_loss": 21085489.888888888}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6669.5, "diff_num_grad_updates_vs_sampler_policy": 6668.5}}, "num_env_steps_sampled": 51873360, "num_env_steps_trained": 51873360, "num_agent_steps_sampled": 51873360, "num_agent_steps_trained": 51873360}, "sampler_results": {"episode_reward_max": -10149.160586002252, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10304.222697020188, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4283024437869876, "mean_inference_ms": 0.37192936814628363, "mean_action_processing_ms": 0.09123947110187616, "mean_env_wait_ms": 0.7447524488967154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003403186798095703, "StateBufferConnector_ms": 0.0025730133056640625, "ViewRequirementAgentConnector_ms": 0.06599783897399902}}, "episode_reward_max": -10149.160586002252, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10304.222697020188, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10281.158139964962, -10325.032384123082, -10378.877884609792, -10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4283024437869876, "mean_inference_ms": 0.37192936814628363, "mean_action_processing_ms": 0.09123947110187616, "mean_env_wait_ms": 0.7447524488967154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003403186798095703, "StateBufferConnector_ms": 0.0025730133056640625, "ViewRequirementAgentConnector_ms": 0.06599783897399902}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51873360, "num_agent_steps_trained": 51873360, "num_env_steps_sampled": 51873360, "num_env_steps_trained": 51873360, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 273.72995291505873, "num_env_steps_trained_throughput_per_sec": 273.72995291505873, "timesteps_total": 51873360, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51873360, "timers": {"training_iteration_time_ms": 4397.644, "sample_time_ms": 4364.794, "load_time_ms": 0.581, "load_throughput": 2065057.564, "learn_time_ms": 31.414, "learn_throughput": 38199.635, "synch_weights_time_ms": 0.803}, "counters": {"num_env_steps_sampled": 51873360, "num_env_steps_trained": 51873360, "num_agent_steps_sampled": 51873360, "num_agent_steps_trained": 51873360}, "done": false, "episodes_total": 12684, "training_iteration": 3984, "trial_id": "9f686_00000", "date": "2023-08-08_15-38-24", "timestamp": 1691498304, "time_this_iter_s": 13.154495000839233, "time_total_s": 94724.52677583694, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1640.3535890579224, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 19.53684210526316, "ram_util_percent": 65.03157894736842}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -366.4869096544054, "policy_loss": -6130437.326822917, "vf_loss": 21846554.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6723.5, "diff_num_grad_updates_vs_sampler_policy": 6722.5}}, "num_env_steps_sampled": 51876960, "num_env_steps_trained": 51876960, "num_agent_steps_sampled": 51876960, "num_agent_steps_trained": 51876960}, "sampler_results": {"episode_reward_max": -10149.160586002252, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10303.050843224493, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4283299904197095, "mean_inference_ms": 0.37191965528394305, "mean_action_processing_ms": 0.09123954716643715, "mean_env_wait_ms": 0.7446574895522531, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034096240997314453, "StateBufferConnector_ms": 0.0025773048400878906, "ViewRequirementAgentConnector_ms": 0.0659475326538086}}, "episode_reward_max": -10149.160586002252, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10303.050843224493, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10210.06807222715, -10186.925449790331, -10274.517223256671, -10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4283299904197095, "mean_inference_ms": 0.37191965528394305, "mean_action_processing_ms": 0.09123954716643715, "mean_env_wait_ms": 0.7446574895522531, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034096240997314453, "StateBufferConnector_ms": 0.0025773048400878906, "ViewRequirementAgentConnector_ms": 0.0659475326538086}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51876960, "num_agent_steps_trained": 51876960, "num_env_steps_sampled": 51876960, "num_env_steps_trained": 51876960, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 270.72613116033733, "num_env_steps_trained_throughput_per_sec": 270.72613116033733, "timesteps_total": 51876960, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51876960, "timers": {"training_iteration_time_ms": 4406.019, "sample_time_ms": 4373.293, "load_time_ms": 0.583, "load_throughput": 2059817.802, "learn_time_ms": 31.325, "learn_throughput": 38307.586, "synch_weights_time_ms": 0.769}, "counters": {"num_env_steps_sampled": 51876960, "num_env_steps_trained": 51876960, "num_agent_steps_sampled": 51876960, "num_agent_steps_trained": 51876960}, "done": false, "episodes_total": 12687, "training_iteration": 3985, "trial_id": "9f686_00000", "date": "2023-08-08_15-38-37", "timestamp": 1691498317, "time_this_iter_s": 13.300441980361938, "time_total_s": 94737.8272178173, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1653.6540310382843, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 17.933333333333334, "ram_util_percent": 64.84444444444443}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -365.46735127766925, "policy_loss": -8212729.964409722, "vf_loss": 21456300.916666668}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6777.5, "diff_num_grad_updates_vs_sampler_policy": 6776.5}}, "num_env_steps_sampled": 51880560, "num_env_steps_trained": 51880560, "num_agent_steps_sampled": 51880560, "num_agent_steps_trained": 51880560}, "sampler_results": {"episode_reward_max": -10149.160586002252, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10303.389896830275, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4283634584918916, "mean_inference_ms": 0.371910183879977, "mean_action_processing_ms": 0.09123960942476696, "mean_env_wait_ms": 0.7445601679489827, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034101009368896484, "StateBufferConnector_ms": 0.002579927444458008, "ViewRequirementAgentConnector_ms": 0.0660562515258789}}, "episode_reward_max": -10149.160586002252, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10303.389896830275, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10331.718223174646, -10251.697658091482, -10293.55942230832, -10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4283634584918916, "mean_inference_ms": 0.371910183879977, "mean_action_processing_ms": 0.09123960942476696, "mean_env_wait_ms": 0.7445601679489827, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034101009368896484, "StateBufferConnector_ms": 0.002579927444458008, "ViewRequirementAgentConnector_ms": 0.0660562515258789}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51880560, "num_agent_steps_trained": 51880560, "num_env_steps_sampled": 51880560, "num_env_steps_trained": 51880560, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 272.19124025369507, "num_env_steps_trained_throughput_per_sec": 272.19124025369507, "timesteps_total": 51880560, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51880560, "timers": {"training_iteration_time_ms": 4406.874, "sample_time_ms": 4374.12, "load_time_ms": 0.582, "load_throughput": 2062096.362, "learn_time_ms": 31.309, "learn_throughput": 38327.218, "synch_weights_time_ms": 0.812}, "counters": {"num_env_steps_sampled": 51880560, "num_env_steps_trained": 51880560, "num_agent_steps_sampled": 51880560, "num_agent_steps_trained": 51880560}, "done": false, "episodes_total": 12690, "training_iteration": 3986, "trial_id": "9f686_00000", "date": "2023-08-08_15-38-51", "timestamp": 1691498331, "time_this_iter_s": 13.228896141052246, "time_total_s": 94751.05611395836, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1666.8829271793365, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 19.889473684210525, "ram_util_percent": 64.88947368421051}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -366.7296617296007, "policy_loss": -11843911.079861112, "vf_loss": 21826698.138888888}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6831.5, "diff_num_grad_updates_vs_sampler_policy": 6830.5}}, "num_env_steps_sampled": 51884160, "num_env_steps_trained": 51884160, "num_agent_steps_sampled": 51884160, "num_agent_steps_trained": 51884160}, "sampler_results": {"episode_reward_max": -10149.160586002252, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10302.755697149905, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428387914901034, "mean_inference_ms": 0.37190128969341435, "mean_action_processing_ms": 0.09123975272696418, "mean_env_wait_ms": 0.7444632354774342, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003408670425415039, "StateBufferConnector_ms": 0.0025801658630371094, "ViewRequirementAgentConnector_ms": 0.06609225273132324}}, "episode_reward_max": -10149.160586002252, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10302.755697149905, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10369.32201114277, -10258.437013294326, -10417.717231166916, -10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428387914901034, "mean_inference_ms": 0.37190128969341435, "mean_action_processing_ms": 0.09123975272696418, "mean_env_wait_ms": 0.7444632354774342, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003408670425415039, "StateBufferConnector_ms": 0.0025801658630371094, "ViewRequirementAgentConnector_ms": 0.06609225273132324}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51884160, "num_agent_steps_trained": 51884160, "num_env_steps_sampled": 51884160, "num_env_steps_trained": 51884160, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 276.6089327855707, "num_env_steps_trained_throughput_per_sec": 276.6089327855707, "timesteps_total": 51884160, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51884160, "timers": {"training_iteration_time_ms": 4389.999, "sample_time_ms": 4357.212, "load_time_ms": 0.58, "load_throughput": 2069472.801, "learn_time_ms": 31.351, "learn_throughput": 38276.327, "synch_weights_time_ms": 0.806}, "counters": {"num_env_steps_sampled": 51884160, "num_env_steps_trained": 51884160, "num_agent_steps_sampled": 51884160, "num_agent_steps_trained": 51884160}, "done": false, "episodes_total": 12693, "training_iteration": 3987, "trial_id": "9f686_00000", "date": "2023-08-08_15-39-04", "timestamp": 1691498344, "time_this_iter_s": 13.017504215240479, "time_total_s": 94764.0736181736, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1679.900431394577, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 22.026315789473685, "ram_util_percent": 64.97368421052632}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -363.8767835828993, "policy_loss": -8699837.366319444, "vf_loss": 21535258.194444444}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6885.5, "diff_num_grad_updates_vs_sampler_policy": 6884.5}}, "num_env_steps_sampled": 51887760, "num_env_steps_trained": 51887760, "num_agent_steps_sampled": 51887760, "num_agent_steps_trained": 51887760}, "sampler_results": {"episode_reward_max": -10149.160586002252, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10300.159730744686, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428402509084831, "mean_inference_ms": 0.37189209082048846, "mean_action_processing_ms": 0.09123986200442728, "mean_env_wait_ms": 0.7443575401927909, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034003257751464844, "StateBufferConnector_ms": 0.0025675296783447266, "ViewRequirementAgentConnector_ms": 0.06601881980895996}}, "episode_reward_max": -10149.160586002252, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10300.159730744686, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10421.478374187176, -10361.015559322665, -10253.675032351626, -10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428402509084831, "mean_inference_ms": 0.37189209082048846, "mean_action_processing_ms": 0.09123986200442728, "mean_env_wait_ms": 0.7443575401927909, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034003257751464844, "StateBufferConnector_ms": 0.0025675296783447266, "ViewRequirementAgentConnector_ms": 0.06601881980895996}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51887760, "num_agent_steps_trained": 51887760, "num_env_steps_sampled": 51887760, "num_env_steps_trained": 51887760, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 276.3852489827584, "num_env_steps_trained_throughput_per_sec": 276.3852489827584, "timesteps_total": 51887760, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51887760, "timers": {"training_iteration_time_ms": 4372.3, "sample_time_ms": 4339.24, "load_time_ms": 0.575, "load_throughput": 2088016.926, "learn_time_ms": 31.621, "learn_throughput": 37949.66, "synch_weights_time_ms": 0.814}, "counters": {"num_env_steps_sampled": 51887760, "num_env_steps_trained": 51887760, "num_agent_steps_sampled": 51887760, "num_agent_steps_trained": 51887760}, "done": false, "episodes_total": 12696, "training_iteration": 3988, "trial_id": "9f686_00000", "date": "2023-08-08_15-39-17", "timestamp": 1691498357, "time_this_iter_s": 13.028138399124146, "time_total_s": 94777.10175657272, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1692.9285697937012, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 23.283333333333335, "ram_util_percent": 64.89444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -366.43618943956164, "policy_loss": -7352266.730034722, "vf_loss": 21469597.027777776}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6939.5, "diff_num_grad_updates_vs_sampler_policy": 6938.5}}, "num_env_steps_sampled": 51891360, "num_env_steps_trained": 51891360, "num_agent_steps_sampled": 51891360, "num_agent_steps_trained": 51891360}, "sampler_results": {"episode_reward_max": -10149.160586002252, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10300.20352003465, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4284108316867776, "mean_inference_ms": 0.37188294084219103, "mean_action_processing_ms": 0.09123991128755624, "mean_env_wait_ms": 0.7442558757900628, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034067630767822266, "StateBufferConnector_ms": 0.0025687217712402344, "ViewRequirementAgentConnector_ms": 0.06604123115539551}}, "episode_reward_max": -10149.160586002252, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10300.20352003465, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10287.266712408464, -10282.014380309009, -10318.396037526127, -10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4284108316867776, "mean_inference_ms": 0.37188294084219103, "mean_action_processing_ms": 0.09123991128755624, "mean_env_wait_ms": 0.7442558757900628, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034067630767822266, "StateBufferConnector_ms": 0.0025687217712402344, "ViewRequirementAgentConnector_ms": 0.06604123115539551}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51891360, "num_agent_steps_trained": 51891360, "num_env_steps_sampled": 51891360, "num_env_steps_trained": 51891360, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 270.5238762783017, "num_env_steps_trained_throughput_per_sec": 270.5238762783017, "timesteps_total": 51891360, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51891360, "timers": {"training_iteration_time_ms": 4376.903, "sample_time_ms": 4343.883, "load_time_ms": 0.577, "load_throughput": 2079648.294, "learn_time_ms": 31.607, "learn_throughput": 37966.493, "synch_weights_time_ms": 0.786}, "counters": {"num_env_steps_sampled": 51891360, "num_env_steps_trained": 51891360, "num_agent_steps_sampled": 51891360, "num_agent_steps_trained": 51891360}, "done": false, "episodes_total": 12699, "training_iteration": 3989, "trial_id": "9f686_00000", "date": "2023-08-08_15-39-30", "timestamp": 1691498370, "time_this_iter_s": 13.310537099838257, "time_total_s": 94790.41229367256, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1706.2391068935394, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 19.794736842105262, "ram_util_percent": 64.8157894736842}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -363.16697184244794, "policy_loss": -8839567.384548612, "vf_loss": 21907097.611111112}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6993.5, "diff_num_grad_updates_vs_sampler_policy": 6992.5}}, "num_env_steps_sampled": 51894960, "num_env_steps_trained": 51894960, "num_agent_steps_sampled": 51894960, "num_agent_steps_trained": 51894960}, "sampler_results": {"episode_reward_max": -10149.160586002252, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10298.455450327509, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4284181939839224, "mean_inference_ms": 0.37187322254334776, "mean_action_processing_ms": 0.09124000854714547, "mean_env_wait_ms": 0.744149957206549, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003407716751098633, "StateBufferConnector_ms": 0.002567768096923828, "ViewRequirementAgentConnector_ms": 0.06606388092041016}}, "episode_reward_max": -10149.160586002252, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10298.455450327509, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10373.150517327405, -10375.59184218401, -10319.939703114227, -10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4284181939839224, "mean_inference_ms": 0.37187322254334776, "mean_action_processing_ms": 0.09124000854714547, "mean_env_wait_ms": 0.744149957206549, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003407716751098633, "StateBufferConnector_ms": 0.002567768096923828, "ViewRequirementAgentConnector_ms": 0.06606388092041016}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51894960, "num_agent_steps_trained": 51894960, "num_env_steps_sampled": 51894960, "num_env_steps_trained": 51894960, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 272.04697266261576, "num_env_steps_trained_throughput_per_sec": 272.04697266261576, "timesteps_total": 51894960, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51894960, "timers": {"training_iteration_time_ms": 4382.488, "sample_time_ms": 4349.606, "load_time_ms": 0.578, "load_throughput": 2075189.577, "learn_time_ms": 31.489, "learn_throughput": 38108.961, "synch_weights_time_ms": 0.766}, "counters": {"num_env_steps_sampled": 51894960, "num_env_steps_trained": 51894960, "num_agent_steps_sampled": 51894960, "num_agent_steps_trained": 51894960}, "done": false, "episodes_total": 12702, "training_iteration": 3990, "trial_id": "9f686_00000", "date": "2023-08-08_15-39-43", "timestamp": 1691498383, "time_this_iter_s": 13.235764026641846, "time_total_s": 94803.6480576992, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1719.4748709201813, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 20.563157894736843, "ram_util_percent": 65.17368421052632}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -362.13304816351996, "policy_loss": -4699430.849826389, "vf_loss": 20843733.805555556}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7047.5, "diff_num_grad_updates_vs_sampler_policy": 7046.5}}, "num_env_steps_sampled": 51898560, "num_env_steps_trained": 51898560, "num_agent_steps_sampled": 51898560, "num_agent_steps_trained": 51898560}, "sampler_results": {"episode_reward_max": -10143.60145863737, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10294.488837504074, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428419599960252, "mean_inference_ms": 0.37186267445990745, "mean_action_processing_ms": 0.09124010962315866, "mean_env_wait_ms": 0.7440377894588295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034122467041015625, "StateBufferConnector_ms": 0.0025708675384521484, "ViewRequirementAgentConnector_ms": 0.0660238265991211}}, "episode_reward_max": -10143.60145863737, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10294.488837504074, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10299.433473849323, -10275.526341420233, -10233.171658907637, -10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428419599960252, "mean_inference_ms": 0.37186267445990745, "mean_action_processing_ms": 0.09124010962315866, "mean_env_wait_ms": 0.7440377894588295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034122467041015625, "StateBufferConnector_ms": 0.0025708675384521484, "ViewRequirementAgentConnector_ms": 0.0660238265991211}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51898560, "num_agent_steps_trained": 51898560, "num_env_steps_sampled": 51898560, "num_env_steps_trained": 51898560, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 274.1435387378699, "num_env_steps_trained_throughput_per_sec": 274.1435387378699, "timesteps_total": 51898560, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51898560, "timers": {"training_iteration_time_ms": 4409.252, "sample_time_ms": 4376.492, "load_time_ms": 0.581, "load_throughput": 2063872.063, "learn_time_ms": 31.353, "learn_throughput": 38273.388, "synch_weights_time_ms": 0.776}, "counters": {"num_env_steps_sampled": 51898560, "num_env_steps_trained": 51898560, "num_agent_steps_sampled": 51898560, "num_agent_steps_trained": 51898560}, "done": false, "episodes_total": 12705, "training_iteration": 3991, "trial_id": "9f686_00000", "date": "2023-08-08_15-39-57", "timestamp": 1691498397, "time_this_iter_s": 13.134795904159546, "time_total_s": 94816.78285360336, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1732.6096668243408, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 19.816666666666666, "ram_util_percent": 65.21111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -363.27377149793836, "policy_loss": -5917705.855902778, "vf_loss": 21492004.777777776}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7101.5, "diff_num_grad_updates_vs_sampler_policy": 7100.5}}, "num_env_steps_sampled": 51902160, "num_env_steps_trained": 51902160, "num_agent_steps_sampled": 51902160, "num_agent_steps_trained": 51902160}, "sampler_results": {"episode_reward_max": -10143.60145863737, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10294.94017561394, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4284280860006544, "mean_inference_ms": 0.37185161801077826, "mean_action_processing_ms": 0.09124017718644349, "mean_env_wait_ms": 0.7439289132978124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003409147262573242, "StateBufferConnector_ms": 0.002564668655395508, "ViewRequirementAgentConnector_ms": 0.06605124473571777}}, "episode_reward_max": -10143.60145863737, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10294.94017561394, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10207.252668700878, -10354.913626868232, -10162.698152764313, -10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4284280860006544, "mean_inference_ms": 0.37185161801077826, "mean_action_processing_ms": 0.09124017718644349, "mean_env_wait_ms": 0.7439289132978124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003409147262573242, "StateBufferConnector_ms": 0.002564668655395508, "ViewRequirementAgentConnector_ms": 0.06605124473571777}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51902160, "num_agent_steps_trained": 51902160, "num_env_steps_sampled": 51902160, "num_env_steps_trained": 51902160, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 270.8268110015041, "num_env_steps_trained_throughput_per_sec": 270.8268110015041, "timesteps_total": 51902160, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51902160, "timers": {"training_iteration_time_ms": 4405.571, "sample_time_ms": 4373.06, "load_time_ms": 0.58, "load_throughput": 2070664.747, "learn_time_ms": 31.113, "learn_throughput": 38568.756, "synch_weights_time_ms": 0.768}, "counters": {"num_env_steps_sampled": 51902160, "num_env_steps_trained": 51902160, "num_agent_steps_sampled": 51902160, "num_agent_steps_trained": 51902160}, "done": false, "episodes_total": 12708, "training_iteration": 3992, "trial_id": "9f686_00000", "date": "2023-08-08_15-40-10", "timestamp": 1691498410, "time_this_iter_s": 13.295518159866333, "time_total_s": 94830.07837176323, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1745.9051849842072, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 19.052631578947366, "ram_util_percent": 65.22631578947369}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -361.5496588812934, "policy_loss": -5268110.468315972, "vf_loss": 21434041.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7155.5, "diff_num_grad_updates_vs_sampler_policy": 7154.5}}, "num_env_steps_sampled": 51905760, "num_env_steps_trained": 51905760, "num_agent_steps_sampled": 51905760, "num_agent_steps_trained": 51905760}, "sampler_results": {"episode_reward_max": -10143.60145863737, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10297.171751836355, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4284262292754892, "mean_inference_ms": 0.3718409875442049, "mean_action_processing_ms": 0.09124031260540011, "mean_env_wait_ms": 0.7438231198897534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003407716751098633, "StateBufferConnector_ms": 0.002555370330810547, "ViewRequirementAgentConnector_ms": 0.06608390808105469}}, "episode_reward_max": -10143.60145863737, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10297.171751836355, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10372.095740021312, -10390.987738374988, -10246.91925780739, -10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4284262292754892, "mean_inference_ms": 0.3718409875442049, "mean_action_processing_ms": 0.09124031260540011, "mean_env_wait_ms": 0.7438231198897534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003407716751098633, "StateBufferConnector_ms": 0.002555370330810547, "ViewRequirementAgentConnector_ms": 0.06608390808105469}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51905760, "num_agent_steps_trained": 51905760, "num_env_steps_sampled": 51905760, "num_env_steps_trained": 51905760, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 273.74274133673566, "num_env_steps_trained_throughput_per_sec": 273.74274133673566, "timesteps_total": 51905760, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51905760, "timers": {"training_iteration_time_ms": 4398.486, "sample_time_ms": 4365.936, "load_time_ms": 0.582, "load_throughput": 2063279.823, "learn_time_ms": 31.129, "learn_throughput": 38549.584, "synch_weights_time_ms": 0.789}, "counters": {"num_env_steps_sampled": 51905760, "num_env_steps_trained": 51905760, "num_agent_steps_sampled": 51905760, "num_agent_steps_trained": 51905760}, "done": false, "episodes_total": 12711, "training_iteration": 3993, "trial_id": "9f686_00000", "date": "2023-08-08_15-40-23", "timestamp": 1691498423, "time_this_iter_s": 13.153965950012207, "time_total_s": 94843.23233771324, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1759.0591509342194, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 19.836842105263155, "ram_util_percent": 65.01052631578946}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -363.1339094373915, "policy_loss": -1692219.607638889, "vf_loss": 21062170.444444444}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7209.5, "diff_num_grad_updates_vs_sampler_policy": 7208.5}}, "num_env_steps_sampled": 51909360, "num_env_steps_trained": 51909360, "num_agent_steps_sampled": 51909360, "num_agent_steps_trained": 51909360}, "sampler_results": {"episode_reward_max": -10143.60145863737, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10294.659171958383, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4284218139268576, "mean_inference_ms": 0.3718303769906546, "mean_action_processing_ms": 0.0912404581144767, "mean_env_wait_ms": 0.743714051946991, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034074783325195312, "StateBufferConnector_ms": 0.0025682449340820312, "ViewRequirementAgentConnector_ms": 0.06605195999145508}}, "episode_reward_max": -10143.60145863737, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10294.659171958383, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10286.251879085085, -10248.017032794804, -10278.694232690565, -10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4284218139268576, "mean_inference_ms": 0.3718303769906546, "mean_action_processing_ms": 0.0912404581144767, "mean_env_wait_ms": 0.743714051946991, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034074783325195312, "StateBufferConnector_ms": 0.0025682449340820312, "ViewRequirementAgentConnector_ms": 0.06605195999145508}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51909360, "num_agent_steps_trained": 51909360, "num_env_steps_sampled": 51909360, "num_env_steps_trained": 51909360, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 273.36863479423226, "num_env_steps_trained_throughput_per_sec": 273.36863479423226, "timesteps_total": 51909360, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51909360, "timers": {"training_iteration_time_ms": 4396.337, "sample_time_ms": 4363.825, "load_time_ms": 0.58, "load_throughput": 2068112.257, "learn_time_ms": 31.102, "learn_throughput": 38583.184, "synch_weights_time_ms": 0.78}, "counters": {"num_env_steps_sampled": 51909360, "num_env_steps_trained": 51909360, "num_agent_steps_sampled": 51909360, "num_agent_steps_trained": 51909360}, "done": false, "episodes_total": 12714, "training_iteration": 3994, "trial_id": "9f686_00000", "date": "2023-08-08_15-40-36", "timestamp": 1691498436, "time_this_iter_s": 13.171948909759521, "time_total_s": 94856.404286623, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1772.2310998439789, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 18.71578947368421, "ram_util_percent": 64.85263157894735}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -363.2272084554036, "policy_loss": -10133380.724826388, "vf_loss": 21693725.944444444}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7263.5, "diff_num_grad_updates_vs_sampler_policy": 7262.5}}, "num_env_steps_sampled": 51912960, "num_env_steps_trained": 51912960, "num_agent_steps_sampled": 51912960, "num_agent_steps_trained": 51912960}, "sampler_results": {"episode_reward_max": -10143.60145863737, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10297.078779007034, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4284178543169914, "mean_inference_ms": 0.371819977325098, "mean_action_processing_ms": 0.09124067750909468, "mean_env_wait_ms": 0.7436111392158833, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034019947052001953, "StateBufferConnector_ms": 0.0025691986083984375, "ViewRequirementAgentConnector_ms": 0.06603837013244629}}, "episode_reward_max": -10143.60145863737, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10297.078779007034, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10275.188192083853, -10326.409282622915, -10364.20289402347, -10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4284178543169914, "mean_inference_ms": 0.371819977325098, "mean_action_processing_ms": 0.09124067750909468, "mean_env_wait_ms": 0.7436111392158833, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034019947052001953, "StateBufferConnector_ms": 0.0025691986083984375, "ViewRequirementAgentConnector_ms": 0.06603837013244629}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51912960, "num_agent_steps_trained": 51912960, "num_env_steps_sampled": 51912960, "num_env_steps_trained": 51912960, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 272.0596533285406, "num_env_steps_trained_throughput_per_sec": 272.0596533285406, "timesteps_total": 51912960, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51912960, "timers": {"training_iteration_time_ms": 4396.901, "sample_time_ms": 4364.243, "load_time_ms": 0.58, "load_throughput": 2068707.275, "learn_time_ms": 31.245, "learn_throughput": 38405.89, "synch_weights_time_ms": 0.783}, "counters": {"num_env_steps_sampled": 51912960, "num_env_steps_trained": 51912960, "num_agent_steps_sampled": 51912960, "num_agent_steps_trained": 51912960}, "done": false, "episodes_total": 12717, "training_iteration": 3995, "trial_id": "9f686_00000", "date": "2023-08-08_15-40-50", "timestamp": 1691498450, "time_this_iter_s": 13.235265970230103, "time_total_s": 94869.63955259323, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1785.466365814209, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 19.811111111111114, "ram_util_percent": 64.88333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -361.694090101454, "policy_loss": -8050126.018229167, "vf_loss": 21700642.388888888}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7317.5, "diff_num_grad_updates_vs_sampler_policy": 7316.5}}, "num_env_steps_sampled": 51916560, "num_env_steps_trained": 51916560, "num_agent_steps_sampled": 51916560, "num_agent_steps_trained": 51916560}, "sampler_results": {"episode_reward_max": -10143.60145863737, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10298.224171890914, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428410341323304, "mean_inference_ms": 0.37181000762193284, "mean_action_processing_ms": 0.09124087250604966, "mean_env_wait_ms": 0.7435162437507021, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034036636352539062, "StateBufferConnector_ms": 0.002566099166870117, "ViewRequirementAgentConnector_ms": 0.0660409927368164}}, "episode_reward_max": -10143.60145863737, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10298.224171890914, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10417.714306526319, -10345.38340061259, -10335.844718363043, -10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428410341323304, "mean_inference_ms": 0.37181000762193284, "mean_action_processing_ms": 0.09124087250604966, "mean_env_wait_ms": 0.7435162437507021, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034036636352539062, "StateBufferConnector_ms": 0.002566099166870117, "ViewRequirementAgentConnector_ms": 0.0660409927368164}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51916560, "num_agent_steps_trained": 51916560, "num_env_steps_sampled": 51916560, "num_env_steps_trained": 51916560, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 269.02777624848477, "num_env_steps_trained_throughput_per_sec": 269.02777624848477, "timesteps_total": 51916560, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51916560, "timers": {"training_iteration_time_ms": 4421.323, "sample_time_ms": 4388.473, "load_time_ms": 0.578, "load_throughput": 2075959.909, "learn_time_ms": 31.459, "learn_throughput": 38144.369, "synch_weights_time_ms": 0.764}, "counters": {"num_env_steps_sampled": 51916560, "num_env_steps_trained": 51916560, "num_agent_steps_sampled": 51916560, "num_agent_steps_trained": 51916560}, "done": false, "episodes_total": 12720, "training_iteration": 3996, "trial_id": "9f686_00000", "date": "2023-08-08_15-41-03", "timestamp": 1691498463, "time_this_iter_s": 13.384377002716064, "time_total_s": 94883.02392959595, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1798.850742816925, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 18.878947368421056, "ram_util_percent": 64.87894736842104}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -361.7518530951606, "policy_loss": -6999747.954861111, "vf_loss": 21390839.722222224}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7371.5, "diff_num_grad_updates_vs_sampler_policy": 7370.5}}, "num_env_steps_sampled": 51920160, "num_env_steps_trained": 51920160, "num_agent_steps_sampled": 51920160, "num_agent_steps_trained": 51920160}, "sampler_results": {"episode_reward_max": -10143.60145863737, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10296.44869150262, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.42839975164649, "mean_inference_ms": 0.3717997460844623, "mean_action_processing_ms": 0.09124106916583294, "mean_env_wait_ms": 0.7434193274558523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034084320068359375, "StateBufferConnector_ms": 0.0025644302368164062, "ViewRequirementAgentConnector_ms": 0.06607675552368164}}, "episode_reward_max": -10143.60145863737, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10296.44869150262, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10302.119980831523, -10398.187484602873, -10263.923688529176, -10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.42839975164649, "mean_inference_ms": 0.3717997460844623, "mean_action_processing_ms": 0.09124106916583294, "mean_env_wait_ms": 0.7434193274558523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034084320068359375, "StateBufferConnector_ms": 0.0025644302368164062, "ViewRequirementAgentConnector_ms": 0.06607675552368164}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51920160, "num_agent_steps_trained": 51920160, "num_env_steps_sampled": 51920160, "num_env_steps_trained": 51920160, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 272.19311951709665, "num_env_steps_trained_throughput_per_sec": 272.19311951709665, "timesteps_total": 51920160, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51920160, "timers": {"training_iteration_time_ms": 4424.681, "sample_time_ms": 4391.947, "load_time_ms": 0.58, "load_throughput": 2067857.354, "learn_time_ms": 31.343, "learn_throughput": 38286.547, "synch_weights_time_ms": 0.763}, "counters": {"num_env_steps_sampled": 51920160, "num_env_steps_trained": 51920160, "num_agent_steps_sampled": 51920160, "num_agent_steps_trained": 51920160}, "done": false, "episodes_total": 12723, "training_iteration": 3997, "trial_id": "9f686_00000", "date": "2023-08-08_15-41-16", "timestamp": 1691498476, "time_this_iter_s": 13.228930950164795, "time_total_s": 94896.25286054611, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1812.0796737670898, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 19.810526315789474, "ram_util_percent": 64.94210526315787}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -362.76869032118054, "policy_loss": -6893991.208333333, "vf_loss": 21315031.083333332}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7425.5, "diff_num_grad_updates_vs_sampler_policy": 7424.5}}, "num_env_steps_sampled": 51923760, "num_env_steps_trained": 51923760, "num_agent_steps_sampled": 51923760, "num_agent_steps_trained": 51923760}, "sampler_results": {"episode_reward_max": -10143.60145863737, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10297.088158729566, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428392220555394, "mean_inference_ms": 0.37178970837812353, "mean_action_processing_ms": 0.0912413423373101, "mean_env_wait_ms": 0.7433254897390823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003404378890991211, "StateBufferConnector_ms": 0.002560853958129883, "ViewRequirementAgentConnector_ms": 0.06606650352478027}}, "episode_reward_max": -10143.60145863737, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10297.088158729566, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10259.122020530976, -10254.715644708753, -10246.053408024576, -10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428392220555394, "mean_inference_ms": 0.37178970837812353, "mean_action_processing_ms": 0.0912413423373101, "mean_env_wait_ms": 0.7433254897390823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003404378890991211, "StateBufferConnector_ms": 0.002560853958129883, "ViewRequirementAgentConnector_ms": 0.06606650352478027}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51923760, "num_agent_steps_trained": 51923760, "num_env_steps_sampled": 51923760, "num_env_steps_trained": 51923760, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 269.5492478681511, "num_env_steps_trained_throughput_per_sec": 269.5492478681511, "timesteps_total": 51923760, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51923760, "timers": {"training_iteration_time_ms": 4431.146, "sample_time_ms": 4398.17, "load_time_ms": 0.585, "load_throughput": 2050419.522, "learn_time_ms": 31.583, "learn_throughput": 37995.469, "synch_weights_time_ms": 0.759}, "counters": {"num_env_steps_sampled": 51923760, "num_env_steps_trained": 51923760, "num_agent_steps_sampled": 51923760, "num_agent_steps_trained": 51923760}, "done": false, "episodes_total": 12726, "training_iteration": 3998, "trial_id": "9f686_00000", "date": "2023-08-08_15-41-30", "timestamp": 1691498490, "time_this_iter_s": 13.358719110488892, "time_total_s": 94909.6115796566, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1825.4383928775787, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 19.352631578947367, "ram_util_percent": 64.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -361.52527703179254, "policy_loss": -5619993.959201389, "vf_loss": 21512440.611111112}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7479.5, "diff_num_grad_updates_vs_sampler_policy": 7478.5}}, "num_env_steps_sampled": 51927360, "num_env_steps_trained": 51927360, "num_agent_steps_sampled": 51927360, "num_agent_steps_trained": 51927360}, "sampler_results": {"episode_reward_max": -10143.60145863737, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10298.969095955732, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4283753331608033, "mean_inference_ms": 0.3717797213276565, "mean_action_processing_ms": 0.09124164966821838, "mean_env_wait_ms": 0.7432372267956313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034050941467285156, "StateBufferConnector_ms": 0.0025663375854492188, "ViewRequirementAgentConnector_ms": 0.06608033180236816}}, "episode_reward_max": -10143.60145863737, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10298.969095955732, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10229.097422814026, -10330.154299826532, -10231.864627994128, -10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4283753331608033, "mean_inference_ms": 0.3717797213276565, "mean_action_processing_ms": 0.09124164966821838, "mean_env_wait_ms": 0.7432372267956313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034050941467285156, "StateBufferConnector_ms": 0.0025663375854492188, "ViewRequirementAgentConnector_ms": 0.06608033180236816}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51927360, "num_agent_steps_trained": 51927360, "num_env_steps_sampled": 51927360, "num_env_steps_trained": 51927360, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 273.98944862150205, "num_env_steps_trained_throughput_per_sec": 273.98944862150205, "timesteps_total": 51927360, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51927360, "timers": {"training_iteration_time_ms": 4409.86, "sample_time_ms": 4376.668, "load_time_ms": 0.583, "load_throughput": 2057544.273, "learn_time_ms": 31.796, "learn_throughput": 37740.82, "synch_weights_time_ms": 0.764}, "counters": {"num_env_steps_sampled": 51927360, "num_env_steps_trained": 51927360, "num_agent_steps_sampled": 51927360, "num_agent_steps_trained": 51927360}, "done": false, "episodes_total": 12729, "training_iteration": 3999, "trial_id": "9f686_00000", "date": "2023-08-08_15-41-43", "timestamp": 1691498503, "time_this_iter_s": 13.142060041427612, "time_total_s": 94922.75363969803, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1838.5804529190063, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 21.66842105263158, "ram_util_percent": 65.2421052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -364.95817226833765, "policy_loss": -8635899.478298612, "vf_loss": 21574328.555555556}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7533.5, "diff_num_grad_updates_vs_sampler_policy": 7532.5}}, "num_env_steps_sampled": 51930960, "num_env_steps_trained": 51930960, "num_agent_steps_sampled": 51930960, "num_agent_steps_trained": 51930960}, "sampler_results": {"episode_reward_max": -10143.60145863737, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10299.630148544571, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428359463011452, "mean_inference_ms": 0.37177049423546515, "mean_action_processing_ms": 0.09124202735369558, "mean_env_wait_ms": 0.743150685037074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034139156341552734, "StateBufferConnector_ms": 0.0025708675384521484, "ViewRequirementAgentConnector_ms": 0.06615567207336426}}, "episode_reward_max": -10143.60145863737, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10299.630148544571, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10268.588772181052, -10299.911345589568, -10436.667344905638, -10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428359463011452, "mean_inference_ms": 0.37177049423546515, "mean_action_processing_ms": 0.09124202735369558, "mean_env_wait_ms": 0.743150685037074, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034139156341552734, "StateBufferConnector_ms": 0.0025708675384521484, "ViewRequirementAgentConnector_ms": 0.06615567207336426}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51930960, "num_agent_steps_trained": 51930960, "num_env_steps_sampled": 51930960, "num_env_steps_trained": 51930960, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 271.774230199365, "num_env_steps_trained_throughput_per_sec": 271.774230199365, "timesteps_total": 51930960, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51930960, "timers": {"training_iteration_time_ms": 4410.381, "sample_time_ms": 4377.452, "load_time_ms": 0.578, "load_throughput": 2076131.172, "learn_time_ms": 31.515, "learn_throughput": 38077.103, "synch_weights_time_ms": 0.785}, "counters": {"num_env_steps_sampled": 51930960, "num_env_steps_trained": 51930960, "num_agent_steps_sampled": 51930960, "num_agent_steps_trained": 51930960}, "done": false, "episodes_total": 12732, "training_iteration": 4000, "trial_id": "9f686_00000", "date": "2023-08-08_15-41-56", "timestamp": 1691498516, "time_this_iter_s": 13.249170780181885, "time_total_s": 94936.00281047821, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1851.8296236991882, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 19.177777777777777, "ram_util_percent": 65.1888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -366.57232496473523, "policy_loss": -4738757.987413194, "vf_loss": 21129709.277777776}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7587.5, "diff_num_grad_updates_vs_sampler_policy": 7586.5}}, "num_env_steps_sampled": 51934560, "num_env_steps_trained": 51934560, "num_agent_steps_sampled": 51934560, "num_agent_steps_trained": 51934560}, "sampler_results": {"episode_reward_max": -10143.60145863737, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10298.333575486786, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4283410851061276, "mean_inference_ms": 0.37176168390529346, "mean_action_processing_ms": 0.09124239578203061, "mean_env_wait_ms": 0.7430620819598097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034101009368896484, "StateBufferConnector_ms": 0.0025742053985595703, "ViewRequirementAgentConnector_ms": 0.06614232063293457}}, "episode_reward_max": -10143.60145863737, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10298.333575486786, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10188.516995789994, -10271.931721167575, -10149.160586002252, -10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4283410851061276, "mean_inference_ms": 0.37176168390529346, "mean_action_processing_ms": 0.09124239578203061, "mean_env_wait_ms": 0.7430620819598097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034101009368896484, "StateBufferConnector_ms": 0.0025742053985595703, "ViewRequirementAgentConnector_ms": 0.06614232063293457}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51934560, "num_agent_steps_trained": 51934560, "num_env_steps_sampled": 51934560, "num_env_steps_trained": 51934560, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 273.3904278569478, "num_env_steps_trained_throughput_per_sec": 273.3904278569478, "timesteps_total": 51934560, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51934560, "timers": {"training_iteration_time_ms": 4396.225, "sample_time_ms": 4363.277, "load_time_ms": 0.571, "load_throughput": 2103110.814, "learn_time_ms": 31.553, "learn_throughput": 38031.845, "synch_weights_time_ms": 0.774}, "counters": {"num_env_steps_sampled": 51934560, "num_env_steps_trained": 51934560, "num_agent_steps_sampled": 51934560, "num_agent_steps_trained": 51934560}, "done": false, "episodes_total": 12735, "training_iteration": 4001, "trial_id": "9f686_00000", "date": "2023-08-08_15-42-09", "timestamp": 1691498529, "time_this_iter_s": 13.17090892791748, "time_total_s": 94949.17371940613, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1865.0005326271057, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 18.952631578947372, "ram_util_percent": 65.25263157894737}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -361.7216440836589, "policy_loss": -10635756.516601562, "vf_loss": 21827681.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7641.5, "diff_num_grad_updates_vs_sampler_policy": 7640.5}}, "num_env_steps_sampled": 51938160, "num_env_steps_trained": 51938160, "num_agent_steps_sampled": 51938160, "num_agent_steps_trained": 51938160}, "sampler_results": {"episode_reward_max": -10143.60145863737, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10301.510747287759, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4283178201513325, "mean_inference_ms": 0.37175323223620593, "mean_action_processing_ms": 0.09124278937648449, "mean_env_wait_ms": 0.742978650723999, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034127235412597656, "StateBufferConnector_ms": 0.00257110595703125, "ViewRequirementAgentConnector_ms": 0.06615209579467773}}, "episode_reward_max": -10143.60145863737, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10301.510747287759, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10300.181787454356, -10296.267134941434, -10322.239912291683, -10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4283178201513325, "mean_inference_ms": 0.37175323223620593, "mean_action_processing_ms": 0.09124278937648449, "mean_env_wait_ms": 0.742978650723999, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034127235412597656, "StateBufferConnector_ms": 0.00257110595703125, "ViewRequirementAgentConnector_ms": 0.06615209579467773}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51938160, "num_agent_steps_trained": 51938160, "num_env_steps_sampled": 51938160, "num_env_steps_trained": 51938160, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 272.0111624148547, "num_env_steps_trained_throughput_per_sec": 272.0111624148547, "timesteps_total": 51938160, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51938160, "timers": {"training_iteration_time_ms": 4407.021, "sample_time_ms": 4374.106, "load_time_ms": 0.572, "load_throughput": 2099163.699, "learn_time_ms": 31.507, "learn_throughput": 38086.9, "synch_weights_time_ms": 0.786}, "counters": {"num_env_steps_sampled": 51938160, "num_env_steps_trained": 51938160, "num_agent_steps_sampled": 51938160, "num_agent_steps_trained": 51938160}, "done": false, "episodes_total": 12738, "training_iteration": 4002, "trial_id": "9f686_00000", "date": "2023-08-08_15-42-22", "timestamp": 1691498542, "time_this_iter_s": 13.2375009059906, "time_total_s": 94962.41122031212, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1878.2380335330963, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 18.83684210526316, "ram_util_percent": 65.02105263157895}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -362.9920416937934, "policy_loss": -2899467.755642361, "vf_loss": 20757785.722222224}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7695.5, "diff_num_grad_updates_vs_sampler_policy": 7694.5}}, "num_env_steps_sampled": 51941760, "num_env_steps_trained": 51941760, "num_agent_steps_sampled": 51941760, "num_agent_steps_trained": 51941760}, "sampler_results": {"episode_reward_max": -10129.49917156546, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10301.62124815401, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428301204423394, "mean_inference_ms": 0.37174482231507894, "mean_action_processing_ms": 0.09124313244850814, "mean_env_wait_ms": 0.7428971968640211, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003417491912841797, "StateBufferConnector_ms": 0.0025691986083984375, "ViewRequirementAgentConnector_ms": 0.06611943244934082}}, "episode_reward_max": -10129.49917156546, "episode_reward_min": -10579.610279828928, "episode_reward_mean": -10301.62124815401, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10413.623412037632, -10579.610279828928, -10302.990879514378, -10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428301204423394, "mean_inference_ms": 0.37174482231507894, "mean_action_processing_ms": 0.09124313244850814, "mean_env_wait_ms": 0.7428971968640211, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003417491912841797, "StateBufferConnector_ms": 0.0025691986083984375, "ViewRequirementAgentConnector_ms": 0.06611943244934082}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51941760, "num_agent_steps_trained": 51941760, "num_env_steps_sampled": 51941760, "num_env_steps_trained": 51941760, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 271.0501138179333, "num_env_steps_trained_throughput_per_sec": 271.0501138179333, "timesteps_total": 51941760, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51941760, "timers": {"training_iteration_time_ms": 4412.544, "sample_time_ms": 4379.571, "load_time_ms": 0.574, "load_throughput": 2091835.252, "learn_time_ms": 31.585, "learn_throughput": 37992.63, "synch_weights_time_ms": 0.764}, "counters": {"num_env_steps_sampled": 51941760, "num_env_steps_trained": 51941760, "num_agent_steps_sampled": 51941760, "num_agent_steps_trained": 51941760}, "done": false, "episodes_total": 12741, "training_iteration": 4003, "trial_id": "9f686_00000", "date": "2023-08-08_15-42-36", "timestamp": 1691498556, "time_this_iter_s": 13.284704685211182, "time_total_s": 94975.69592499733, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1891.5227382183075, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 17.994736842105265, "ram_util_percent": 64.87894736842104}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -361.6136491563585, "policy_loss": -8943440.761284722, "vf_loss": 21972323.611111112}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7749.5, "diff_num_grad_updates_vs_sampler_policy": 7748.5}}, "num_env_steps_sampled": 51945360, "num_env_steps_trained": 51945360, "num_agent_steps_sampled": 51945360, "num_agent_steps_trained": 51945360}, "sampler_results": {"episode_reward_max": -10129.49917156546, "episode_reward_min": -10490.581499213857, "episode_reward_mean": -10299.57831794594, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428285841953338, "mean_inference_ms": 0.3717364574255388, "mean_action_processing_ms": 0.0912434916138732, "mean_env_wait_ms": 0.7428146787041547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034210681915283203, "StateBufferConnector_ms": 0.002568483352661133, "ViewRequirementAgentConnector_ms": 0.06612515449523926}}, "episode_reward_max": -10129.49917156546, "episode_reward_min": -10490.581499213857, "episode_reward_mean": -10299.57831794594, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10389.798661572664, -10411.68697112087, -10356.956089569854, -10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428285841953338, "mean_inference_ms": 0.3717364574255388, "mean_action_processing_ms": 0.0912434916138732, "mean_env_wait_ms": 0.7428146787041547, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034210681915283203, "StateBufferConnector_ms": 0.002568483352661133, "ViewRequirementAgentConnector_ms": 0.06612515449523926}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51945360, "num_agent_steps_trained": 51945360, "num_env_steps_sampled": 51945360, "num_env_steps_trained": 51945360, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 271.3648796762879, "num_env_steps_trained_throughput_per_sec": 271.3648796762879, "timesteps_total": 51945360, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51945360, "timers": {"training_iteration_time_ms": 4414.283, "sample_time_ms": 4381.371, "load_time_ms": 0.577, "load_throughput": 2079476.45, "learn_time_ms": 31.517, "learn_throughput": 38074.741, "synch_weights_time_ms": 0.768}, "counters": {"num_env_steps_sampled": 51945360, "num_env_steps_trained": 51945360, "num_agent_steps_sampled": 51945360, "num_agent_steps_trained": 51945360}, "done": false, "episodes_total": 12744, "training_iteration": 4004, "trial_id": "9f686_00000", "date": "2023-08-08_15-42-49", "timestamp": 1691498569, "time_this_iter_s": 13.269165992736816, "time_total_s": 94988.96509099007, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1904.7919042110443, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 20.278947368421054, "ram_util_percent": 64.86315789473683}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -362.54993014865454, "policy_loss": -6117196.802083333, "vf_loss": 21397340.777777776}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7803.5, "diff_num_grad_updates_vs_sampler_policy": 7802.5}}, "num_env_steps_sampled": 51948960, "num_env_steps_trained": 51948960, "num_agent_steps_sampled": 51948960, "num_agent_steps_trained": 51948960}, "sampler_results": {"episode_reward_max": -10129.49917156546, "episode_reward_min": -10490.581499213857, "episode_reward_mean": -10296.441280718383, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4282710792719895, "mean_inference_ms": 0.37172805552000815, "mean_action_processing_ms": 0.09124382051253019, "mean_env_wait_ms": 0.7427257393108165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00341796875, "StateBufferConnector_ms": 0.002570629119873047, "ViewRequirementAgentConnector_ms": 0.06615042686462402}}, "episode_reward_max": -10129.49917156546, "episode_reward_min": -10490.581499213857, "episode_reward_mean": -10296.441280718383, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10406.208200197865, -10194.889016696705, -10400.204539400362, -10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4282710792719895, "mean_inference_ms": 0.37172805552000815, "mean_action_processing_ms": 0.09124382051253019, "mean_env_wait_ms": 0.7427257393108165, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00341796875, "StateBufferConnector_ms": 0.002570629119873047, "ViewRequirementAgentConnector_ms": 0.06615042686462402}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51948960, "num_agent_steps_trained": 51948960, "num_env_steps_sampled": 51948960, "num_env_steps_trained": 51948960, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 271.30231845116623, "num_env_steps_trained_throughput_per_sec": 271.30231845116623, "timesteps_total": 51948960, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51948960, "timers": {"training_iteration_time_ms": 4426.62, "sample_time_ms": 4393.924, "load_time_ms": 0.581, "load_throughput": 2065227.032, "learn_time_ms": 31.308, "learn_throughput": 38329.407, "synch_weights_time_ms": 0.757}, "counters": {"num_env_steps_sampled": 51948960, "num_env_steps_trained": 51948960, "num_agent_steps_sampled": 51948960, "num_agent_steps_trained": 51948960}, "done": false, "episodes_total": 12747, "training_iteration": 4005, "trial_id": "9f686_00000", "date": "2023-08-08_15-43-02", "timestamp": 1691498582, "time_this_iter_s": 13.27232813835144, "time_total_s": 95002.23741912842, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1918.0642323493958, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 18.388888888888886, "ram_util_percent": 64.84444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -364.9964328342014, "policy_loss": -5146783.321614583, "vf_loss": 21348987.166666668}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7857.5, "diff_num_grad_updates_vs_sampler_policy": 7856.5}}, "num_env_steps_sampled": 51952560, "num_env_steps_trained": 51952560, "num_agent_steps_sampled": 51952560, "num_agent_steps_trained": 51952560}, "sampler_results": {"episode_reward_max": -10129.49917156546, "episode_reward_min": -10490.581499213857, "episode_reward_mean": -10293.934511106703, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428258722553259, "mean_inference_ms": 0.37172000166673697, "mean_action_processing_ms": 0.09124412393973817, "mean_env_wait_ms": 0.7426346198785657, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034241676330566406, "StateBufferConnector_ms": 0.0025701522827148438, "ViewRequirementAgentConnector_ms": 0.06617426872253418}}, "episode_reward_max": -10129.49917156546, "episode_reward_min": -10490.581499213857, "episode_reward_mean": -10293.934511106703, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10212.224403253074, -10259.110759840032, -10345.120515294317, -10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428258722553259, "mean_inference_ms": 0.37172000166673697, "mean_action_processing_ms": 0.09124412393973817, "mean_env_wait_ms": 0.7426346198785657, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034241676330566406, "StateBufferConnector_ms": 0.0025701522827148438, "ViewRequirementAgentConnector_ms": 0.06617426872253418}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51952560, "num_agent_steps_trained": 51952560, "num_env_steps_sampled": 51952560, "num_env_steps_trained": 51952560, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 272.03584680532384, "num_env_steps_trained_throughput_per_sec": 272.03584680532384, "timesteps_total": 51952560, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51952560, "timers": {"training_iteration_time_ms": 4414.432, "sample_time_ms": 4381.903, "load_time_ms": 0.581, "load_throughput": 2064634.014, "learn_time_ms": 31.13, "learn_throughput": 38548.226, "synch_weights_time_ms": 0.768}, "counters": {"num_env_steps_sampled": 51952560, "num_env_steps_trained": 51952560, "num_agent_steps_sampled": 51952560, "num_agent_steps_trained": 51952560}, "done": false, "episodes_total": 12750, "training_iteration": 4006, "trial_id": "9f686_00000", "date": "2023-08-08_15-43-16", "timestamp": 1691498596, "time_this_iter_s": 13.23642086982727, "time_total_s": 95015.47383999825, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1931.300653219223, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 18.426315789473687, "ram_util_percent": 64.89473684210527}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -362.93939887152777, "policy_loss": -10360469.771267362, "vf_loss": 21626713.777777776}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7911.5, "diff_num_grad_updates_vs_sampler_policy": 7910.5}}, "num_env_steps_sampled": 51956160, "num_env_steps_trained": 51956160, "num_agent_steps_sampled": 51956160, "num_agent_steps_trained": 51956160}, "sampler_results": {"episode_reward_max": -10129.49917156546, "episode_reward_min": -10490.581499213857, "episode_reward_mean": -10294.249700875003, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428249630911056, "mean_inference_ms": 0.3717122653566793, "mean_action_processing_ms": 0.09124443274215796, "mean_env_wait_ms": 0.7425502119853086, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003425121307373047, "StateBufferConnector_ms": 0.0025746822357177734, "ViewRequirementAgentConnector_ms": 0.0662240982055664}}, "episode_reward_max": -10129.49917156546, "episode_reward_min": -10490.581499213857, "episode_reward_mean": -10294.249700875003, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10220.714453749983, -10275.83510055449, -10215.006973102645, -10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428249630911056, "mean_inference_ms": 0.3717122653566793, "mean_action_processing_ms": 0.09124443274215796, "mean_env_wait_ms": 0.7425502119853086, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003425121307373047, "StateBufferConnector_ms": 0.0025746822357177734, "ViewRequirementAgentConnector_ms": 0.0662240982055664}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51956160, "num_agent_steps_trained": 51956160, "num_env_steps_sampled": 51956160, "num_env_steps_trained": 51956160, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 272.1187587653108, "num_env_steps_trained_throughput_per_sec": 272.1187587653108, "timesteps_total": 51956160, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51956160, "timers": {"training_iteration_time_ms": 4414.687, "sample_time_ms": 4382.112, "load_time_ms": 0.576, "load_throughput": 2084644.135, "learn_time_ms": 31.181, "learn_throughput": 38485.09, "synch_weights_time_ms": 0.769}, "counters": {"num_env_steps_sampled": 51956160, "num_env_steps_trained": 51956160, "num_agent_steps_sampled": 51956160, "num_agent_steps_trained": 51956160}, "done": false, "episodes_total": 12753, "training_iteration": 4007, "trial_id": "9f686_00000", "date": "2023-08-08_15-43-29", "timestamp": 1691498609, "time_this_iter_s": 13.23231315612793, "time_total_s": 95028.70615315437, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1944.532966375351, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 19.926315789473687, "ram_util_percent": 64.90526315789474}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -361.6324937608507, "policy_loss": -17183169.168402776, "vf_loss": 21962787.555555556}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7965.5, "diff_num_grad_updates_vs_sampler_policy": 7964.5}}, "num_env_steps_sampled": 51959760, "num_env_steps_trained": 51959760, "num_agent_steps_sampled": 51959760, "num_agent_steps_trained": 51959760}, "sampler_results": {"episode_reward_max": -10129.49917156546, "episode_reward_min": -10490.581499213857, "episode_reward_mean": -10298.14764531688, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428241758494405, "mean_inference_ms": 0.3717045207046059, "mean_action_processing_ms": 0.09124467968950052, "mean_env_wait_ms": 0.7424749690078954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003421783447265625, "StateBufferConnector_ms": 0.0025708675384521484, "ViewRequirementAgentConnector_ms": 0.0661773681640625}}, "episode_reward_max": -10129.49917156546, "episode_reward_min": -10490.581499213857, "episode_reward_mean": -10298.14764531688, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10162.81764023165, -10382.152221758342, -10356.815491893925, -10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428241758494405, "mean_inference_ms": 0.3717045207046059, "mean_action_processing_ms": 0.09124467968950052, "mean_env_wait_ms": 0.7424749690078954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003421783447265625, "StateBufferConnector_ms": 0.0025708675384521484, "ViewRequirementAgentConnector_ms": 0.0661773681640625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51959760, "num_agent_steps_trained": 51959760, "num_env_steps_sampled": 51959760, "num_env_steps_trained": 51959760, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 272.10388560600273, "num_env_steps_trained_throughput_per_sec": 272.10388560600273, "timesteps_total": 51959760, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51959760, "timers": {"training_iteration_time_ms": 4410.254, "sample_time_ms": 4377.399, "load_time_ms": 0.57, "load_throughput": 2106808.204, "learn_time_ms": 31.465, "learn_throughput": 38137.462, "synch_weights_time_ms": 0.772}, "counters": {"num_env_steps_sampled": 51959760, "num_env_steps_trained": 51959760, "num_agent_steps_sampled": 51959760, "num_agent_steps_trained": 51959760}, "done": false, "episodes_total": 12756, "training_iteration": 4008, "trial_id": "9f686_00000", "date": "2023-08-08_15-43-42", "timestamp": 1691498622, "time_this_iter_s": 13.233176946640015, "time_total_s": 95041.93933010101, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1957.766143321991, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 19.573684210526313, "ram_util_percent": 65.07368421052631}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -364.63057793511285, "policy_loss": -4775207.829861111, "vf_loss": 21323663.305555556}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8019.5, "diff_num_grad_updates_vs_sampler_policy": 8018.5}}, "num_env_steps_sampled": 51963360, "num_env_steps_trained": 51963360, "num_agent_steps_sampled": 51963360, "num_agent_steps_trained": 51963360}, "sampler_results": {"episode_reward_max": -10129.49917156546, "episode_reward_min": -10490.581499213857, "episode_reward_mean": -10297.557828350733, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4282365068036853, "mean_inference_ms": 0.37169683341309495, "mean_action_processing_ms": 0.09124485534412885, "mean_env_wait_ms": 0.742399421198422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003421306610107422, "StateBufferConnector_ms": 0.002576589584350586, "ViewRequirementAgentConnector_ms": 0.06617403030395508}}, "episode_reward_max": -10129.49917156546, "episode_reward_min": -10490.581499213857, "episode_reward_mean": -10297.557828350733, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10238.00746457812, -10369.855468229633, -10442.9217268979, -10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4282365068036853, "mean_inference_ms": 0.37169683341309495, "mean_action_processing_ms": 0.09124485534412885, "mean_env_wait_ms": 0.742399421198422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003421306610107422, "StateBufferConnector_ms": 0.002576589584350586, "ViewRequirementAgentConnector_ms": 0.06617403030395508}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51963360, "num_agent_steps_trained": 51963360, "num_env_steps_sampled": 51963360, "num_env_steps_trained": 51963360, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 272.8445511886618, "num_env_steps_trained_throughput_per_sec": 272.8445511886618, "timesteps_total": 51963360, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51963360, "timers": {"training_iteration_time_ms": 4404.843, "sample_time_ms": 4371.623, "load_time_ms": 0.569, "load_throughput": 2109368.761, "learn_time_ms": 31.81, "learn_throughput": 37723.848, "synch_weights_time_ms": 0.792}, "counters": {"num_env_steps_sampled": 51963360, "num_env_steps_trained": 51963360, "num_agent_steps_sampled": 51963360, "num_agent_steps_trained": 51963360}, "done": false, "episodes_total": 12759, "training_iteration": 4009, "trial_id": "9f686_00000", "date": "2023-08-08_15-43-55", "timestamp": 1691498635, "time_this_iter_s": 13.19733476638794, "time_total_s": 95055.1366648674, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1970.963478088379, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 17.894444444444446, "ram_util_percent": 65.13333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -364.6906246609158, "policy_loss": -5585396.894965278, "vf_loss": 21102403.944444444}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8073.5, "diff_num_grad_updates_vs_sampler_policy": 8072.5}}, "num_env_steps_sampled": 51966960, "num_env_steps_trained": 51966960, "num_agent_steps_sampled": 51966960, "num_agent_steps_trained": 51966960}, "sampler_results": {"episode_reward_max": -10129.49917156546, "episode_reward_min": -10490.581499213857, "episode_reward_mean": -10294.250344691496, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4282339875987256, "mean_inference_ms": 0.3716894592943645, "mean_action_processing_ms": 0.09124503517061697, "mean_env_wait_ms": 0.7423185529549338, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034208297729492188, "StateBufferConnector_ms": 0.0025742053985595703, "ViewRequirementAgentConnector_ms": 0.06613516807556152}}, "episode_reward_max": -10129.49917156546, "episode_reward_min": -10490.581499213857, "episode_reward_mean": -10294.250344691496, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10399.129176706183, -10295.425391189296, -10490.581499213857, -10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4282339875987256, "mean_inference_ms": 0.3716894592943645, "mean_action_processing_ms": 0.09124503517061697, "mean_env_wait_ms": 0.7423185529549338, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034208297729492188, "StateBufferConnector_ms": 0.0025742053985595703, "ViewRequirementAgentConnector_ms": 0.06613516807556152}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51966960, "num_agent_steps_trained": 51966960, "num_env_steps_sampled": 51966960, "num_env_steps_trained": 51966960, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 271.67517644184284, "num_env_steps_trained_throughput_per_sec": 271.67517644184284, "timesteps_total": 51966960, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51966960, "timers": {"training_iteration_time_ms": 4409.461, "sample_time_ms": 4376.443, "load_time_ms": 0.572, "load_throughput": 2099601.535, "learn_time_ms": 31.619, "learn_throughput": 37952.121, "synch_weights_time_ms": 0.778}, "counters": {"num_env_steps_sampled": 51966960, "num_env_steps_trained": 51966960, "num_agent_steps_sampled": 51966960, "num_agent_steps_trained": 51966960}, "done": false, "episodes_total": 12762, "training_iteration": 4010, "trial_id": "9f686_00000", "date": "2023-08-08_15-44-09", "timestamp": 1691498649, "time_this_iter_s": 13.25402283668518, "time_total_s": 95068.39068770409, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1984.217500925064, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 17.2, "ram_util_percent": 65.15263157894736}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -363.82804022894965, "policy_loss": -12308865.138020834, "vf_loss": 21861620.638888888}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8127.5, "diff_num_grad_updates_vs_sampler_policy": 8126.5}}, "num_env_steps_sampled": 51970560, "num_env_steps_trained": 51970560, "num_agent_steps_sampled": 51970560, "num_agent_steps_trained": 51970560}, "sampler_results": {"episode_reward_max": -10129.49917156546, "episode_reward_min": -10469.569811396417, "episode_reward_mean": -10290.462215817899, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428235706220981, "mean_inference_ms": 0.3716825326360359, "mean_action_processing_ms": 0.09124526835873781, "mean_env_wait_ms": 0.7422338640932183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003416776657104492, "StateBufferConnector_ms": 0.0025701522827148438, "ViewRequirementAgentConnector_ms": 0.06612563133239746}}, "episode_reward_max": -10129.49917156546, "episode_reward_min": -10469.569811396417, "episode_reward_mean": -10290.462215817899, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10252.81912072471, -10185.636958547606, -10211.752224365018, -10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428235706220981, "mean_inference_ms": 0.3716825326360359, "mean_action_processing_ms": 0.09124526835873781, "mean_env_wait_ms": 0.7422338640932183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003416776657104492, "StateBufferConnector_ms": 0.0025701522827148438, "ViewRequirementAgentConnector_ms": 0.06612563133239746}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51970560, "num_agent_steps_trained": 51970560, "num_env_steps_sampled": 51970560, "num_env_steps_trained": 51970560, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 271.6474345836682, "num_env_steps_trained_throughput_per_sec": 271.6474345836682, "timesteps_total": 51970560, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51970560, "timers": {"training_iteration_time_ms": 4410.417, "sample_time_ms": 4377.335, "load_time_ms": 0.576, "load_throughput": 2084557.797, "learn_time_ms": 31.67, "learn_throughput": 37891.293, "synch_weights_time_ms": 0.788}, "counters": {"num_env_steps_sampled": 51970560, "num_env_steps_trained": 51970560, "num_agent_steps_sampled": 51970560, "num_agent_steps_trained": 51970560}, "done": false, "episodes_total": 12765, "training_iteration": 4011, "trial_id": "9f686_00000", "date": "2023-08-08_15-44-22", "timestamp": 1691498662, "time_this_iter_s": 13.25527811050415, "time_total_s": 95081.64596581459, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1997.4727790355682, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 19.46842105263158, "ram_util_percent": 65.07368421052632}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -362.7560170491536, "policy_loss": -4041959.324652778, "vf_loss": 21142400.416666668}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8181.5, "diff_num_grad_updates_vs_sampler_policy": 8180.5}}, "num_env_steps_sampled": 51974160, "num_env_steps_trained": 51974160, "num_agent_steps_sampled": 51974160, "num_agent_steps_trained": 51974160}, "sampler_results": {"episode_reward_max": -10129.49917156546, "episode_reward_min": -10469.569811396417, "episode_reward_mean": -10293.128232672449, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4282461268704107, "mean_inference_ms": 0.371675958264918, "mean_action_processing_ms": 0.09124555122544672, "mean_env_wait_ms": 0.7421530204739015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034172534942626953, "StateBufferConnector_ms": 0.0025756359100341797, "ViewRequirementAgentConnector_ms": 0.06595325469970703}}, "episode_reward_max": -10129.49917156546, "episode_reward_min": -10469.569811396417, "episode_reward_mean": -10293.128232672449, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10233.720980822904, -10270.263429708868, -10368.18026064685, -10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4282461268704107, "mean_inference_ms": 0.371675958264918, "mean_action_processing_ms": 0.09124555122544672, "mean_env_wait_ms": 0.7421530204739015, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034172534942626953, "StateBufferConnector_ms": 0.0025756359100341797, "ViewRequirementAgentConnector_ms": 0.06595325469970703}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51974160, "num_agent_steps_trained": 51974160, "num_env_steps_sampled": 51974160, "num_env_steps_trained": 51974160, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 269.8862493249043, "num_env_steps_trained_throughput_per_sec": 269.8862493249043, "timesteps_total": 51974160, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51974160, "timers": {"training_iteration_time_ms": 4421.435, "sample_time_ms": 4388.614, "load_time_ms": 0.576, "load_throughput": 2082401.655, "learn_time_ms": 31.399, "learn_throughput": 38218.286, "synch_weights_time_ms": 0.797}, "counters": {"num_env_steps_sampled": 51974160, "num_env_steps_trained": 51974160, "num_agent_steps_sampled": 51974160, "num_agent_steps_trained": 51974160}, "done": false, "episodes_total": 12768, "training_iteration": 4012, "trial_id": "9f686_00000", "date": "2023-08-08_15-44-35", "timestamp": 1691498675, "time_this_iter_s": 13.34197187423706, "time_total_s": 95094.98793768883, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2010.8147509098053, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 18.04736842105263, "ram_util_percent": 64.84210526315789}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -364.7239244249132, "policy_loss": -7071510.490885417, "vf_loss": 21332359.333333332}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8235.5, "diff_num_grad_updates_vs_sampler_policy": 8234.5}}, "num_env_steps_sampled": 51977760, "num_env_steps_trained": 51977760, "num_agent_steps_sampled": 51977760, "num_agent_steps_trained": 51977760}, "sampler_results": {"episode_reward_max": -10129.49917156546, "episode_reward_min": -10469.569811396417, "episode_reward_mean": -10290.417485314698, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428251847854245, "mean_inference_ms": 0.371669411079604, "mean_action_processing_ms": 0.0912458210015352, "mean_env_wait_ms": 0.7420705732456689, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034155845642089844, "StateBufferConnector_ms": 0.002576112747192383, "ViewRequirementAgentConnector_ms": 0.06603717803955078}}, "episode_reward_max": -10129.49917156546, "episode_reward_min": -10469.569811396417, "episode_reward_mean": -10290.417485314698, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10276.821654112939, -10371.411655592354, -10252.588078341696, -10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428251847854245, "mean_inference_ms": 0.371669411079604, "mean_action_processing_ms": 0.0912458210015352, "mean_env_wait_ms": 0.7420705732456689, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034155845642089844, "StateBufferConnector_ms": 0.002576112747192383, "ViewRequirementAgentConnector_ms": 0.06603717803955078}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51977760, "num_agent_steps_trained": 51977760, "num_env_steps_sampled": 51977760, "num_env_steps_trained": 51977760, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 275.6941974981612, "num_env_steps_trained_throughput_per_sec": 275.6941974981612, "timesteps_total": 51977760, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51977760, "timers": {"training_iteration_time_ms": 4405.067, "sample_time_ms": 4372.022, "load_time_ms": 0.577, "load_throughput": 2078360.16, "learn_time_ms": 31.612, "learn_throughput": 37960.279, "synch_weights_time_ms": 0.808}, "counters": {"num_env_steps_sampled": 51977760, "num_env_steps_trained": 51977760, "num_agent_steps_sampled": 51977760, "num_agent_steps_trained": 51977760}, "done": false, "episodes_total": 12771, "training_iteration": 4013, "trial_id": "9f686_00000", "date": "2023-08-08_15-44-48", "timestamp": 1691498688, "time_this_iter_s": 13.060864925384521, "time_total_s": 95108.04880261421, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2023.8756158351898, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 18.783333333333335, "ram_util_percent": 64.8111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -362.4366624620226, "policy_loss": -3450169.4479166665, "vf_loss": 21214737.444444444}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8289.5, "diff_num_grad_updates_vs_sampler_policy": 8288.5}}, "num_env_steps_sampled": 51981360, "num_env_steps_trained": 51981360, "num_agent_steps_sampled": 51981360, "num_agent_steps_trained": 51981360}, "sampler_results": {"episode_reward_max": -10129.49917156546, "episode_reward_min": -10469.569811396417, "episode_reward_mean": -10290.104627920384, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428260830261736, "mean_inference_ms": 0.37166293908412235, "mean_action_processing_ms": 0.09124610279564722, "mean_env_wait_ms": 0.7419868493316076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003417491912841797, "StateBufferConnector_ms": 0.002550363540649414, "ViewRequirementAgentConnector_ms": 0.0660102367401123}}, "episode_reward_max": -10129.49917156546, "episode_reward_min": -10469.569811396417, "episode_reward_mean": -10290.104627920384, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10400.823105669588, -10245.771260442316, -10314.479615990427, -10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428260830261736, "mean_inference_ms": 0.37166293908412235, "mean_action_processing_ms": 0.09124610279564722, "mean_env_wait_ms": 0.7419868493316076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003417491912841797, "StateBufferConnector_ms": 0.002550363540649414, "ViewRequirementAgentConnector_ms": 0.0660102367401123}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51981360, "num_agent_steps_trained": 51981360, "num_env_steps_sampled": 51981360, "num_env_steps_trained": 51981360, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 271.95218697133583, "num_env_steps_trained_throughput_per_sec": 271.95218697133583, "timesteps_total": 51981360, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51981360, "timers": {"training_iteration_time_ms": 4409.821, "sample_time_ms": 4376.786, "load_time_ms": 0.573, "load_throughput": 2092530.994, "learn_time_ms": 31.62, "learn_throughput": 37950.662, "synch_weights_time_ms": 0.793}, "counters": {"num_env_steps_sampled": 51981360, "num_env_steps_trained": 51981360, "num_agent_steps_sampled": 51981360, "num_agent_steps_trained": 51981360}, "done": false, "episodes_total": 12774, "training_iteration": 4014, "trial_id": "9f686_00000", "date": "2023-08-08_15-45-02", "timestamp": 1691498702, "time_this_iter_s": 13.24066710472107, "time_total_s": 95121.28946971893, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2037.116282939911, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 19.257894736842104, "ram_util_percent": 64.9578947368421}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -364.8975524902344, "policy_loss": -7967726.517361111, "vf_loss": 21724654.277777776}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8343.5, "diff_num_grad_updates_vs_sampler_policy": 8342.5}}, "num_env_steps_sampled": 51984960, "num_env_steps_trained": 51984960, "num_agent_steps_sampled": 51984960, "num_agent_steps_trained": 51984960}, "sampler_results": {"episode_reward_max": -10129.49917156546, "episode_reward_min": -10469.569811396417, "episode_reward_mean": -10288.82801326719, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4282729331500272, "mean_inference_ms": 0.37165649464783285, "mean_action_processing_ms": 0.09124639629388274, "mean_env_wait_ms": 0.7419034291432134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003422260284423828, "StateBufferConnector_ms": 0.002550363540649414, "ViewRequirementAgentConnector_ms": 0.06601214408874512}}, "episode_reward_max": -10129.49917156546, "episode_reward_min": -10469.569811396417, "episode_reward_mean": -10288.82801326719, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10194.81145341908, -10362.28727091464, -10200.06557046134, -10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4282729331500272, "mean_inference_ms": 0.37165649464783285, "mean_action_processing_ms": 0.09124639629388274, "mean_env_wait_ms": 0.7419034291432134, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003422260284423828, "StateBufferConnector_ms": 0.002550363540649414, "ViewRequirementAgentConnector_ms": 0.06601214408874512}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51984960, "num_agent_steps_trained": 51984960, "num_env_steps_sampled": 51984960, "num_env_steps_trained": 51984960, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 272.6105458786504, "num_env_steps_trained_throughput_per_sec": 272.6105458786504, "timesteps_total": 51984960, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51984960, "timers": {"training_iteration_time_ms": 4393.786, "sample_time_ms": 4360.895, "load_time_ms": 0.574, "load_throughput": 2091053.095, "learn_time_ms": 31.462, "learn_throughput": 38141.276, "synch_weights_time_ms": 0.806}, "counters": {"num_env_steps_sampled": 51984960, "num_env_steps_trained": 51984960, "num_agent_steps_sampled": 51984960, "num_agent_steps_trained": 51984960}, "done": false, "episodes_total": 12777, "training_iteration": 4015, "trial_id": "9f686_00000", "date": "2023-08-08_15-45-15", "timestamp": 1691498715, "time_this_iter_s": 13.2085440158844, "time_total_s": 95134.49801373482, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2050.3248269557953, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 18.90526315789474, "ram_util_percent": 64.93157894736842}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -362.42930603027344, "policy_loss": -6757758.80859375, "vf_loss": 21231445.277777776}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8397.5, "diff_num_grad_updates_vs_sampler_policy": 8396.5}}, "num_env_steps_sampled": 51988560, "num_env_steps_trained": 51988560, "num_agent_steps_sampled": 51988560, "num_agent_steps_trained": 51988560}, "sampler_results": {"episode_reward_max": -10129.49917156546, "episode_reward_min": -10469.569811396417, "episode_reward_mean": -10289.543901729192, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428278684373217, "mean_inference_ms": 0.3716509318910134, "mean_action_processing_ms": 0.09124688440378327, "mean_env_wait_ms": 0.7418200362186333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003415346145629883, "StateBufferConnector_ms": 0.002547025680541992, "ViewRequirementAgentConnector_ms": 0.06597232818603516}}, "episode_reward_max": -10129.49917156546, "episode_reward_min": -10469.569811396417, "episode_reward_mean": -10289.543901729192, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10328.06320459891, -10321.324076035591, -10260.034968327103, -10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428278684373217, "mean_inference_ms": 0.3716509318910134, "mean_action_processing_ms": 0.09124688440378327, "mean_env_wait_ms": 0.7418200362186333, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003415346145629883, "StateBufferConnector_ms": 0.002547025680541992, "ViewRequirementAgentConnector_ms": 0.06597232818603516}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51988560, "num_agent_steps_trained": 51988560, "num_env_steps_sampled": 51988560, "num_env_steps_trained": 51988560, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 275.3359324821594, "num_env_steps_trained_throughput_per_sec": 275.3359324821594, "timesteps_total": 51988560, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51988560, "timers": {"training_iteration_time_ms": 4384.577, "sample_time_ms": 4351.663, "load_time_ms": 0.573, "load_throughput": 2095929.375, "learn_time_ms": 31.517, "learn_throughput": 38074.453, "synch_weights_time_ms": 0.775}, "counters": {"num_env_steps_sampled": 51988560, "num_env_steps_trained": 51988560, "num_agent_steps_sampled": 51988560, "num_agent_steps_trained": 51988560}, "done": false, "episodes_total": 12780, "training_iteration": 4016, "trial_id": "9f686_00000", "date": "2023-08-08_15-45-28", "timestamp": 1691498728, "time_this_iter_s": 13.077963829040527, "time_total_s": 95147.57597756386, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2063.402790784836, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 24.242105263157892, "ram_util_percent": 65.00526315789473}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -362.0010986328125, "policy_loss": -11996759.176215278, "vf_loss": 21397378.111111112}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8451.5, "diff_num_grad_updates_vs_sampler_policy": 8450.5}}, "num_env_steps_sampled": 51992160, "num_env_steps_trained": 51992160, "num_agent_steps_sampled": 51992160, "num_agent_steps_trained": 51992160}, "sampler_results": {"episode_reward_max": -10129.49917156546, "episode_reward_min": -10469.569811396417, "episode_reward_mean": -10288.528923989912, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428283388693661, "mean_inference_ms": 0.3716452034996324, "mean_action_processing_ms": 0.0912474167406803, "mean_env_wait_ms": 0.7417382369713225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034134387969970703, "StateBufferConnector_ms": 0.002553701400756836, "ViewRequirementAgentConnector_ms": 0.06595087051391602}}, "episode_reward_max": -10129.49917156546, "episode_reward_min": -10469.569811396417, "episode_reward_mean": -10288.528923989912, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10208.7608292798, -10212.623154209854, -10283.01211063671, -10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428283388693661, "mean_inference_ms": 0.3716452034996324, "mean_action_processing_ms": 0.0912474167406803, "mean_env_wait_ms": 0.7417382369713225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034134387969970703, "StateBufferConnector_ms": 0.002553701400756836, "ViewRequirementAgentConnector_ms": 0.06595087051391602}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51992160, "num_agent_steps_trained": 51992160, "num_env_steps_sampled": 51992160, "num_env_steps_trained": 51992160, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 273.8212100887236, "num_env_steps_trained_throughput_per_sec": 273.8212100887236, "timesteps_total": 51992160, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51992160, "timers": {"training_iteration_time_ms": 4379.654, "sample_time_ms": 4346.934, "load_time_ms": 0.572, "load_throughput": 2096365.863, "learn_time_ms": 31.337, "learn_throughput": 38293.742, "synch_weights_time_ms": 0.762}, "counters": {"num_env_steps_sampled": 51992160, "num_env_steps_trained": 51992160, "num_agent_steps_sampled": 51992160, "num_agent_steps_trained": 51992160}, "done": false, "episodes_total": 12783, "training_iteration": 4017, "trial_id": "9f686_00000", "date": "2023-08-08_15-45-41", "timestamp": 1691498741, "time_this_iter_s": 13.150219202041626, "time_total_s": 95160.7261967659, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2076.5530099868774, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 19.633333333333333, "ram_util_percent": 65.33333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -362.4256083170573, "policy_loss": -8271567.64453125, "vf_loss": 21539694.833333332}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8505.5, "diff_num_grad_updates_vs_sampler_policy": 8504.5}}, "num_env_steps_sampled": 51995760, "num_env_steps_trained": 51995760, "num_agent_steps_sampled": 51995760, "num_agent_steps_trained": 51995760}, "sampler_results": {"episode_reward_max": -10129.49917156546, "episode_reward_min": -10469.569811396417, "episode_reward_mean": -10289.35010399372, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4282845015558743, "mean_inference_ms": 0.37163960246513056, "mean_action_processing_ms": 0.09124796074747604, "mean_env_wait_ms": 0.7416573703365438, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034101009368896484, "StateBufferConnector_ms": 0.0025529861450195312, "ViewRequirementAgentConnector_ms": 0.06587624549865723}}, "episode_reward_max": -10129.49917156546, "episode_reward_min": -10469.569811396417, "episode_reward_mean": -10289.35010399372, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10372.24776428221, -10234.466134103453, -10215.99096793148, -10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4282845015558743, "mean_inference_ms": 0.37163960246513056, "mean_action_processing_ms": 0.09124796074747604, "mean_env_wait_ms": 0.7416573703365438, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034101009368896484, "StateBufferConnector_ms": 0.0025529861450195312, "ViewRequirementAgentConnector_ms": 0.06587624549865723}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51995760, "num_agent_steps_trained": 51995760, "num_env_steps_sampled": 51995760, "num_env_steps_trained": 51995760, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 272.9295701002043, "num_env_steps_trained_throughput_per_sec": 272.9295701002043, "timesteps_total": 51995760, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51995760, "timers": {"training_iteration_time_ms": 4384.01, "sample_time_ms": 4351.094, "load_time_ms": 0.573, "load_throughput": 2092530.994, "learn_time_ms": 31.498, "learn_throughput": 38097.423, "synch_weights_time_ms": 0.795}, "counters": {"num_env_steps_sampled": 51995760, "num_env_steps_trained": 51995760, "num_agent_steps_sampled": 51995760, "num_agent_steps_trained": 51995760}, "done": false, "episodes_total": 12786, "training_iteration": 4018, "trial_id": "9f686_00000", "date": "2023-08-08_15-45-54", "timestamp": 1691498754, "time_this_iter_s": 13.19310998916626, "time_total_s": 95173.91930675507, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2089.7461199760437, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 18.026315789473685, "ram_util_percent": 65.30526315789473}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -362.2431945800781, "policy_loss": -5813216.52734375, "vf_loss": 21611961.472222224}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8559.5, "diff_num_grad_updates_vs_sampler_policy": 8558.5}}, "num_env_steps_sampled": 51999360, "num_env_steps_trained": 51999360, "num_agent_steps_sampled": 51999360, "num_agent_steps_trained": 51999360}, "sampler_results": {"episode_reward_max": -10129.49917156546, "episode_reward_min": -10469.569811396417, "episode_reward_mean": -10290.796607414168, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428278880399656, "mean_inference_ms": 0.3716339654932754, "mean_action_processing_ms": 0.09124848712360217, "mean_env_wait_ms": 0.741581291279768, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034008026123046875, "StateBufferConnector_ms": 0.002542257308959961, "ViewRequirementAgentConnector_ms": 0.06586003303527832}}, "episode_reward_max": -10129.49917156546, "episode_reward_min": -10469.569811396417, "episode_reward_mean": -10290.796607414168, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10254.959003817165, -10230.773947588461, -10251.151261532465, -10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428278880399656, "mean_inference_ms": 0.3716339654932754, "mean_action_processing_ms": 0.09124848712360217, "mean_env_wait_ms": 0.741581291279768, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034008026123046875, "StateBufferConnector_ms": 0.002542257308959961, "ViewRequirementAgentConnector_ms": 0.06586003303527832}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 51999360, "num_agent_steps_trained": 51999360, "num_env_steps_sampled": 51999360, "num_env_steps_trained": 51999360, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 272.81105924174886, "num_env_steps_trained_throughput_per_sec": 272.81105924174886, "timesteps_total": 51999360, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 51999360, "timers": {"training_iteration_time_ms": 4398.194, "sample_time_ms": 4365.322, "load_time_ms": 0.573, "load_throughput": 2092617.994, "learn_time_ms": 31.459, "learn_throughput": 38144.514, "synch_weights_time_ms": 0.791}, "counters": {"num_env_steps_sampled": 51999360, "num_env_steps_trained": 51999360, "num_agent_steps_sampled": 51999360, "num_agent_steps_trained": 51999360}, "done": false, "episodes_total": 12789, "training_iteration": 4019, "trial_id": "9f686_00000", "date": "2023-08-08_15-46-08", "timestamp": 1691498768, "time_this_iter_s": 13.199061155319214, "time_total_s": 95187.11836791039, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2102.945181131363, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 17.50526315789474, "ram_util_percent": 65.26842105263158}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -363.14315117730035, "policy_loss": -7264218.268663194, "vf_loss": 21205788.555555556}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8613.5, "diff_num_grad_updates_vs_sampler_policy": 8612.5}}, "num_env_steps_sampled": 52002960, "num_env_steps_trained": 52002960, "num_agent_steps_sampled": 52002960, "num_agent_steps_trained": 52002960}, "sampler_results": {"episode_reward_max": -10129.49917156546, "episode_reward_min": -10469.569811396417, "episode_reward_mean": -10292.3946973715, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428283229635265, "mean_inference_ms": 0.3716284062220269, "mean_action_processing_ms": 0.09124904938683093, "mean_env_wait_ms": 0.741508569475347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003407001495361328, "StateBufferConnector_ms": 0.0025484561920166016, "ViewRequirementAgentConnector_ms": 0.0658559799194336}}, "episode_reward_max": -10129.49917156546, "episode_reward_min": -10469.569811396417, "episode_reward_mean": -10292.3946973715, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10331.630126416474, -10279.94802770308, -10209.914690634485, -10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428283229635265, "mean_inference_ms": 0.3716284062220269, "mean_action_processing_ms": 0.09124904938683093, "mean_env_wait_ms": 0.741508569475347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003407001495361328, "StateBufferConnector_ms": 0.0025484561920166016, "ViewRequirementAgentConnector_ms": 0.0658559799194336}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52002960, "num_agent_steps_trained": 52002960, "num_env_steps_sampled": 52002960, "num_env_steps_trained": 52002960, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 270.93948595424206, "num_env_steps_trained_throughput_per_sec": 270.93948595424206, "timesteps_total": 52002960, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52002960, "timers": {"training_iteration_time_ms": 4407.417, "sample_time_ms": 4374.524, "load_time_ms": 0.573, "load_throughput": 2095667.569, "learn_time_ms": 31.474, "learn_throughput": 38127.235, "synch_weights_time_ms": 0.799}, "counters": {"num_env_steps_sampled": 52002960, "num_env_steps_trained": 52002960, "num_agent_steps_sampled": 52002960, "num_agent_steps_trained": 52002960}, "done": false, "episodes_total": 12792, "training_iteration": 4020, "trial_id": "9f686_00000", "date": "2023-08-08_15-46-21", "timestamp": 1691498781, "time_this_iter_s": 13.289952993392944, "time_total_s": 95200.40832090378, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2116.235134124756, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 19.15555555555556, "ram_util_percent": 65.19999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -361.545886569553, "policy_loss": -10085700.138671875, "vf_loss": 21673321.083333332}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8667.5, "diff_num_grad_updates_vs_sampler_policy": 8666.5}}, "num_env_steps_sampled": 52006560, "num_env_steps_trained": 52006560, "num_agent_steps_sampled": 52006560, "num_agent_steps_trained": 52006560}, "sampler_results": {"episode_reward_max": -10129.49917156546, "episode_reward_min": -10469.569811396417, "episode_reward_mean": -10292.167574317114, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4282999433133097, "mean_inference_ms": 0.37162279300478845, "mean_action_processing_ms": 0.09124958207519145, "mean_env_wait_ms": 0.7414400274053579, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003415346145629883, "StateBufferConnector_ms": 0.002545595169067383, "ViewRequirementAgentConnector_ms": 0.0659325122833252}}, "episode_reward_max": -10129.49917156546, "episode_reward_min": -10469.569811396417, "episode_reward_mean": -10292.167574317114, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10296.016896744602, -10408.720534789381, -10374.263882702728, -10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4282999433133097, "mean_inference_ms": 0.37162279300478845, "mean_action_processing_ms": 0.09124958207519145, "mean_env_wait_ms": 0.7414400274053579, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003415346145629883, "StateBufferConnector_ms": 0.002545595169067383, "ViewRequirementAgentConnector_ms": 0.0659325122833252}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52006560, "num_agent_steps_trained": 52006560, "num_env_steps_sampled": 52006560, "num_env_steps_trained": 52006560, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 271.37633114772217, "num_env_steps_trained_throughput_per_sec": 271.37633114772217, "timesteps_total": 52006560, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52006560, "timers": {"training_iteration_time_ms": 4420.23, "sample_time_ms": 4387.43, "load_time_ms": 0.575, "load_throughput": 2086112.985, "learn_time_ms": 31.39, "learn_throughput": 38228.533, "synch_weights_time_ms": 0.786}, "counters": {"num_env_steps_sampled": 52006560, "num_env_steps_trained": 52006560, "num_agent_steps_sampled": 52006560, "num_agent_steps_trained": 52006560}, "done": false, "episodes_total": 12795, "training_iteration": 4021, "trial_id": "9f686_00000", "date": "2023-08-08_15-46-34", "timestamp": 1691498794, "time_this_iter_s": 13.268599033355713, "time_total_s": 95213.67691993713, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2129.5037331581116, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 18.773684210526316, "ram_util_percent": 65.00526315789475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -364.08121914333765, "policy_loss": -6980591.828559028, "vf_loss": 21832021.888888888}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8721.5, "diff_num_grad_updates_vs_sampler_policy": 8720.5}}, "num_env_steps_sampled": 52010160, "num_env_steps_trained": 52010160, "num_agent_steps_sampled": 52010160, "num_agent_steps_trained": 52010160}, "sampler_results": {"episode_reward_max": -10129.49917156546, "episode_reward_min": -10469.569811396417, "episode_reward_mean": -10293.215918456288, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4283179527620913, "mean_inference_ms": 0.3716172886869666, "mean_action_processing_ms": 0.09125008454419556, "mean_env_wait_ms": 0.7413768332619809, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034210681915283203, "StateBufferConnector_ms": 0.0025517940521240234, "ViewRequirementAgentConnector_ms": 0.06590771675109863}}, "episode_reward_max": -10129.49917156546, "episode_reward_min": -10469.569811396417, "episode_reward_mean": -10293.215918456288, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10257.563477365722, -10179.769858062768, -10162.908833954149, -10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4283179527620913, "mean_inference_ms": 0.3716172886869666, "mean_action_processing_ms": 0.09125008454419556, "mean_env_wait_ms": 0.7413768332619809, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034210681915283203, "StateBufferConnector_ms": 0.0025517940521240234, "ViewRequirementAgentConnector_ms": 0.06590771675109863}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52010160, "num_agent_steps_trained": 52010160, "num_env_steps_sampled": 52010160, "num_env_steps_trained": 52010160, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 270.151037556957, "num_env_steps_trained_throughput_per_sec": 270.151037556957, "timesteps_total": 52010160, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52010160, "timers": {"training_iteration_time_ms": 4428.766, "sample_time_ms": 4395.795, "load_time_ms": 0.574, "load_throughput": 2089664.037, "learn_time_ms": 31.567, "learn_throughput": 38014.467, "synch_weights_time_ms": 0.781}, "counters": {"num_env_steps_sampled": 52010160, "num_env_steps_trained": 52010160, "num_agent_steps_sampled": 52010160, "num_agent_steps_trained": 52010160}, "done": false, "episodes_total": 12798, "training_iteration": 4022, "trial_id": "9f686_00000", "date": "2023-08-08_15-46-48", "timestamp": 1691498808, "time_this_iter_s": 13.328792810440063, "time_total_s": 95227.00571274757, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2142.8325259685516, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 18.915789473684214, "ram_util_percent": 65.02105263157895}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -362.3315700954861, "policy_loss": -9363705.932725694, "vf_loss": 21701494.527777776}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8775.5, "diff_num_grad_updates_vs_sampler_policy": 8774.5}}, "num_env_steps_sampled": 52013760, "num_env_steps_trained": 52013760, "num_agent_steps_sampled": 52013760, "num_agent_steps_trained": 52013760}, "sampler_results": {"episode_reward_max": -10129.49917156546, "episode_reward_min": -10469.569811396417, "episode_reward_mean": -10297.38761230659, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428334521515451, "mean_inference_ms": 0.3716121862375222, "mean_action_processing_ms": 0.09125059784230331, "mean_env_wait_ms": 0.7413183713712196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034170150756835938, "StateBufferConnector_ms": 0.0025472640991210938, "ViewRequirementAgentConnector_ms": 0.06589841842651367}}, "episode_reward_max": -10129.49917156546, "episode_reward_min": -10469.569811396417, "episode_reward_mean": -10297.38761230659, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10370.191467512637, -10206.02539764595, -10322.393923998861, -10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428334521515451, "mean_inference_ms": 0.3716121862375222, "mean_action_processing_ms": 0.09125059784230331, "mean_env_wait_ms": 0.7413183713712196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034170150756835938, "StateBufferConnector_ms": 0.0025472640991210938, "ViewRequirementAgentConnector_ms": 0.06589841842651367}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52013760, "num_agent_steps_trained": 52013760, "num_env_steps_sampled": 52013760, "num_env_steps_trained": 52013760, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 270.120363582019, "num_env_steps_trained_throughput_per_sec": 270.120363582019, "timesteps_total": 52013760, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52013760, "timers": {"training_iteration_time_ms": 4428.916, "sample_time_ms": 4395.781, "load_time_ms": 0.576, "load_throughput": 2081712.631, "learn_time_ms": 31.727, "learn_throughput": 37822.755, "synch_weights_time_ms": 0.781}, "counters": {"num_env_steps_sampled": 52013760, "num_env_steps_trained": 52013760, "num_agent_steps_sampled": 52013760, "num_agent_steps_trained": 52013760}, "done": false, "episodes_total": 12801, "training_iteration": 4023, "trial_id": "9f686_00000", "date": "2023-08-08_15-47-01", "timestamp": 1691498821, "time_this_iter_s": 13.330409049987793, "time_total_s": 95240.33612179756, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2156.1629350185394, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 19.484210526315792, "ram_util_percent": 65.08421052631581}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -363.0231001112196, "policy_loss": -9600150.09375, "vf_loss": 21503430.277777776}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8829.5, "diff_num_grad_updates_vs_sampler_policy": 8828.5}}, "num_env_steps_sampled": 52017360, "num_env_steps_trained": 52017360, "num_agent_steps_sampled": 52017360, "num_agent_steps_trained": 52017360}, "sampler_results": {"episode_reward_max": -10129.49917156546, "episode_reward_min": -10469.569811396417, "episode_reward_mean": -10297.888236759574, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4283456697057995, "mean_inference_ms": 0.3716074265399966, "mean_action_processing_ms": 0.09125105683796962, "mean_env_wait_ms": 0.7412656237388621, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003411531448364258, "StateBufferConnector_ms": 0.0025446414947509766, "ViewRequirementAgentConnector_ms": 0.06582236289978027}}, "episode_reward_max": -10129.49917156546, "episode_reward_min": -10469.569811396417, "episode_reward_mean": -10297.888236759574, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10143.60145863737, -10257.40197722809, -10306.700511410925, -10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4283456697057995, "mean_inference_ms": 0.3716074265399966, "mean_action_processing_ms": 0.09125105683796962, "mean_env_wait_ms": 0.7412656237388621, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003411531448364258, "StateBufferConnector_ms": 0.0025446414947509766, "ViewRequirementAgentConnector_ms": 0.06582236289978027}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52017360, "num_agent_steps_trained": 52017360, "num_env_steps_sampled": 52017360, "num_env_steps_trained": 52017360, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 273.80062922216746, "num_env_steps_trained_throughput_per_sec": 273.80062922216746, "timesteps_total": 52017360, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52017360, "timers": {"training_iteration_time_ms": 4423.344, "sample_time_ms": 4390.19, "load_time_ms": 0.579, "load_throughput": 2073052.762, "learn_time_ms": 31.746, "learn_throughput": 37799.747, "synch_weights_time_ms": 0.778}, "counters": {"num_env_steps_sampled": 52017360, "num_env_steps_trained": 52017360, "num_agent_steps_sampled": 52017360, "num_agent_steps_trained": 52017360}, "done": false, "episodes_total": 12804, "training_iteration": 4024, "trial_id": "9f686_00000", "date": "2023-08-08_15-47-14", "timestamp": 1691498834, "time_this_iter_s": 13.151051044464111, "time_total_s": 95253.48717284203, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2169.3139860630035, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 20.23157894736842, "ram_util_percent": 65.15263157894738}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -362.1707950168186, "policy_loss": -5764740.1450737845, "vf_loss": 21474295.111111112}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8883.5, "diff_num_grad_updates_vs_sampler_policy": 8882.5}}, "num_env_steps_sampled": 52020960, "num_env_steps_trained": 52020960, "num_agent_steps_sampled": 52020960, "num_agent_steps_trained": 52020960}, "sampler_results": {"episode_reward_max": -10129.49917156546, "episode_reward_min": -10469.569811396417, "episode_reward_mean": -10298.698104463558, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4283492407346925, "mean_inference_ms": 0.3716030827369527, "mean_action_processing_ms": 0.09125148547282418, "mean_env_wait_ms": 0.7412142385677777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003409147262573242, "StateBufferConnector_ms": 0.002545595169067383, "ViewRequirementAgentConnector_ms": 0.06576752662658691}}, "episode_reward_max": -10129.49917156546, "episode_reward_min": -10469.569811396417, "episode_reward_mean": -10298.698104463558, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10289.16279652456, -10326.714962127535, -10346.236392728293, -10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4283492407346925, "mean_inference_ms": 0.3716030827369527, "mean_action_processing_ms": 0.09125148547282418, "mean_env_wait_ms": 0.7412142385677777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003409147262573242, "StateBufferConnector_ms": 0.002545595169067383, "ViewRequirementAgentConnector_ms": 0.06576752662658691}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52020960, "num_agent_steps_trained": 52020960, "num_env_steps_sampled": 52020960, "num_env_steps_trained": 52020960, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 274.4762662968469, "num_env_steps_trained_throughput_per_sec": 274.4762662968469, "timesteps_total": 52020960, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52020960, "timers": {"training_iteration_time_ms": 4402.709, "sample_time_ms": 4369.544, "load_time_ms": 0.589, "load_throughput": 2037636.047, "learn_time_ms": 31.751, "learn_throughput": 37793.758, "synch_weights_time_ms": 0.775}, "counters": {"num_env_steps_sampled": 52020960, "num_env_steps_trained": 52020960, "num_agent_steps_sampled": 52020960, "num_agent_steps_trained": 52020960}, "done": false, "episodes_total": 12807, "training_iteration": 4025, "trial_id": "9f686_00000", "date": "2023-08-08_15-47-27", "timestamp": 1691498847, "time_this_iter_s": 13.11894702911377, "time_total_s": 95266.60611987114, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2182.4329330921173, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 19.82222222222222, "ram_util_percent": 65.00000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -362.39539930555554, "policy_loss": -9986890.513888888, "vf_loss": 21542036.916666668}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8937.5, "diff_num_grad_updates_vs_sampler_policy": 8936.5}}, "num_env_steps_sampled": 52024560, "num_env_steps_trained": 52024560, "num_agent_steps_sampled": 52024560, "num_agent_steps_trained": 52024560}, "sampler_results": {"episode_reward_max": -10129.49917156546, "episode_reward_min": -10469.569811396417, "episode_reward_mean": -10299.483815292024, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428353182897557, "mean_inference_ms": 0.37159861789861354, "mean_action_processing_ms": 0.09125186815806063, "mean_env_wait_ms": 0.7411645535298849, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034127235412597656, "StateBufferConnector_ms": 0.0025589466094970703, "ViewRequirementAgentConnector_ms": 0.06574535369873047}}, "episode_reward_max": -10129.49917156546, "episode_reward_min": -10469.569811396417, "episode_reward_mean": -10299.483815292024, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10275.070715719336, -10301.505385352359, -10266.89865530542, -10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428353182897557, "mean_inference_ms": 0.37159861789861354, "mean_action_processing_ms": 0.09125186815806063, "mean_env_wait_ms": 0.7411645535298849, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034127235412597656, "StateBufferConnector_ms": 0.0025589466094970703, "ViewRequirementAgentConnector_ms": 0.06574535369873047}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52024560, "num_agent_steps_trained": 52024560, "num_env_steps_sampled": 52024560, "num_env_steps_trained": 52024560, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 272.3811032908058, "num_env_steps_trained_throughput_per_sec": 272.3811032908058, "timesteps_total": 52024560, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52024560, "timers": {"training_iteration_time_ms": 4395.948, "sample_time_ms": 4363.029, "load_time_ms": 0.59, "load_throughput": 2035575.831, "learn_time_ms": 31.521, "learn_throughput": 38069.529, "synch_weights_time_ms": 0.759}, "counters": {"num_env_steps_sampled": 52024560, "num_env_steps_trained": 52024560, "num_agent_steps_sampled": 52024560, "num_agent_steps_trained": 52024560}, "done": false, "episodes_total": 12810, "training_iteration": 4026, "trial_id": "9f686_00000", "date": "2023-08-08_15-47-41", "timestamp": 1691498861, "time_this_iter_s": 13.21980595588684, "time_total_s": 95279.82592582703, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2195.652739048004, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 20.68421052631579, "ram_util_percent": 65.20526315789475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -362.48328653971356, "policy_loss": -8816022.572916666, "vf_loss": 21284837.361111112}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8991.5, "diff_num_grad_updates_vs_sampler_policy": 8990.5}}, "num_env_steps_sampled": 52028160, "num_env_steps_trained": 52028160, "num_agent_steps_sampled": 52028160, "num_agent_steps_trained": 52028160}, "sampler_results": {"episode_reward_max": -10129.49917156546, "episode_reward_min": -10469.569811396417, "episode_reward_mean": -10301.021449504153, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4283557490687104, "mean_inference_ms": 0.3715943786460485, "mean_action_processing_ms": 0.09125223630002603, "mean_env_wait_ms": 0.7411193119090892, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034046173095703125, "StateBufferConnector_ms": 0.0025539398193359375, "ViewRequirementAgentConnector_ms": 0.06573224067687988}}, "episode_reward_max": -10129.49917156546, "episode_reward_min": -10469.569811396417, "episode_reward_mean": -10301.021449504153, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10190.340707748688, -10322.149913214256, -10408.902766150479, -10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4283557490687104, "mean_inference_ms": 0.3715943786460485, "mean_action_processing_ms": 0.09125223630002603, "mean_env_wait_ms": 0.7411193119090892, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034046173095703125, "StateBufferConnector_ms": 0.0025539398193359375, "ViewRequirementAgentConnector_ms": 0.06573224067687988}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52028160, "num_agent_steps_trained": 52028160, "num_env_steps_sampled": 52028160, "num_env_steps_trained": 52028160, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 272.69196671869116, "num_env_steps_trained_throughput_per_sec": 272.69196671869116, "timesteps_total": 52028160, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52028160, "timers": {"training_iteration_time_ms": 4396.632, "sample_time_ms": 4363.642, "load_time_ms": 0.585, "load_throughput": 2050168.961, "learn_time_ms": 31.577, "learn_throughput": 38002.01, "synch_weights_time_ms": 0.778}, "counters": {"num_env_steps_sampled": 52028160, "num_env_steps_trained": 52028160, "num_agent_steps_sampled": 52028160, "num_agent_steps_trained": 52028160}, "done": false, "episodes_total": 12813, "training_iteration": 4027, "trial_id": "9f686_00000", "date": "2023-08-08_15-47-54", "timestamp": 1691498874, "time_this_iter_s": 13.204589128494263, "time_total_s": 95293.03051495552, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2208.8573281764984, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 19.52105263157895, "ram_util_percent": 65.40526315789474}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -365.3730977376302, "policy_loss": -5307968.908637153, "vf_loss": 21365177.222222224}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9045.5, "diff_num_grad_updates_vs_sampler_policy": 9044.5}}, "num_env_steps_sampled": 52031760, "num_env_steps_trained": 52031760, "num_agent_steps_sampled": 52031760, "num_agent_steps_trained": 52031760}, "sampler_results": {"episode_reward_max": -10129.49917156546, "episode_reward_min": -10469.569811396417, "episode_reward_mean": -10301.010844332992, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4283638397917837, "mean_inference_ms": 0.37159019076150196, "mean_action_processing_ms": 0.09125256159621148, "mean_env_wait_ms": 0.741074360523632, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003412008285522461, "StateBufferConnector_ms": 0.0025565624237060547, "ViewRequirementAgentConnector_ms": 0.0656883716583252}}, "episode_reward_max": -10129.49917156546, "episode_reward_min": -10469.569811396417, "episode_reward_mean": -10301.010844332992, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10323.871170070712, -10428.701993623552, -10300.662755363523, -10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4283638397917837, "mean_inference_ms": 0.37159019076150196, "mean_action_processing_ms": 0.09125256159621148, "mean_env_wait_ms": 0.741074360523632, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003412008285522461, "StateBufferConnector_ms": 0.0025565624237060547, "ViewRequirementAgentConnector_ms": 0.0656883716583252}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52031760, "num_agent_steps_trained": 52031760, "num_env_steps_sampled": 52031760, "num_env_steps_trained": 52031760, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 270.4383004178304, "num_env_steps_trained_throughput_per_sec": 270.4383004178304, "timesteps_total": 52031760, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52031760, "timers": {"training_iteration_time_ms": 4414.184, "sample_time_ms": 4381.154, "load_time_ms": 0.577, "load_throughput": 2080335.951, "learn_time_ms": 31.622, "learn_throughput": 37947.801, "synch_weights_time_ms": 0.782}, "counters": {"num_env_steps_sampled": 52031760, "num_env_steps_trained": 52031760, "num_agent_steps_sampled": 52031760, "num_agent_steps_trained": 52031760}, "done": false, "episodes_total": 12816, "training_iteration": 4028, "trial_id": "9f686_00000", "date": "2023-08-08_15-48-07", "timestamp": 1691498887, "time_this_iter_s": 13.314527988433838, "time_total_s": 95306.34504294395, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2222.1718561649323, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 18.363157894736844, "ram_util_percent": 65.33684210526314}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -362.49913194444446, "policy_loss": -4184965.4166666665, "vf_loss": 21254658.111111112}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9099.5, "diff_num_grad_updates_vs_sampler_policy": 9098.5}}, "num_env_steps_sampled": 52035360, "num_env_steps_trained": 52035360, "num_agent_steps_sampled": 52035360, "num_agent_steps_trained": 52035360}, "sampler_results": {"episode_reward_max": -10129.49917156546, "episode_reward_min": -10469.569811396417, "episode_reward_mean": -10300.165159507424, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428374728823052, "mean_inference_ms": 0.37158591033115884, "mean_action_processing_ms": 0.09125284351762174, "mean_env_wait_ms": 0.741022507081951, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034046173095703125, "StateBufferConnector_ms": 0.0025527477264404297, "ViewRequirementAgentConnector_ms": 0.06569457054138184}}, "episode_reward_max": -10129.49917156546, "episode_reward_min": -10469.569811396417, "episode_reward_mean": -10300.165159507424, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10350.97490813126, -10381.581835773768, -10262.128963084413, -10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428374728823052, "mean_inference_ms": 0.37158591033115884, "mean_action_processing_ms": 0.09125284351762174, "mean_env_wait_ms": 0.741022507081951, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034046173095703125, "StateBufferConnector_ms": 0.0025527477264404297, "ViewRequirementAgentConnector_ms": 0.06569457054138184}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52035360, "num_agent_steps_trained": 52035360, "num_env_steps_sampled": 52035360, "num_env_steps_trained": 52035360, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 271.494560172626, "num_env_steps_trained_throughput_per_sec": 271.494560172626, "timesteps_total": 52035360, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52035360, "timers": {"training_iteration_time_ms": 4415.069, "sample_time_ms": 4381.886, "load_time_ms": 0.573, "load_throughput": 2094359.521, "learn_time_ms": 31.775, "learn_throughput": 37765.06, "synch_weights_time_ms": 0.786}, "counters": {"num_env_steps_sampled": 52035360, "num_env_steps_trained": 52035360, "num_agent_steps_sampled": 52035360, "num_agent_steps_trained": 52035360}, "done": false, "episodes_total": 12819, "training_iteration": 4029, "trial_id": "9f686_00000", "date": "2023-08-08_15-48-20", "timestamp": 1691498900, "time_this_iter_s": 13.262785196304321, "time_total_s": 95319.60782814026, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2235.4346413612366, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 19.616666666666664, "ram_util_percent": 65.18333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -362.8344370524089, "policy_loss": -11552634.404513888, "vf_loss": 21738319.777777776}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9153.5, "diff_num_grad_updates_vs_sampler_policy": 9152.5}}, "num_env_steps_sampled": 52038960, "num_env_steps_trained": 52038960, "num_agent_steps_sampled": 52038960, "num_agent_steps_trained": 52038960}, "sampler_results": {"episode_reward_max": -10129.49917156546, "episode_reward_min": -10469.569811396417, "episode_reward_mean": -10300.423316460488, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4283879194816493, "mean_inference_ms": 0.3715818199299936, "mean_action_processing_ms": 0.0912531068867076, "mean_env_wait_ms": 0.7409694919399645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034084320068359375, "StateBufferConnector_ms": 0.002555370330810547, "ViewRequirementAgentConnector_ms": 0.0656731128692627}}, "episode_reward_max": -10129.49917156546, "episode_reward_min": -10469.569811396417, "episode_reward_mean": -10300.423316460488, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10277.68358781417, -10393.598110759169, -10400.211271850241, -10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4283879194816493, "mean_inference_ms": 0.3715818199299936, "mean_action_processing_ms": 0.0912531068867076, "mean_env_wait_ms": 0.7409694919399645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034084320068359375, "StateBufferConnector_ms": 0.002555370330810547, "ViewRequirementAgentConnector_ms": 0.0656731128692627}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52038960, "num_agent_steps_trained": 52038960, "num_env_steps_sampled": 52038960, "num_env_steps_trained": 52038960, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 270.56761054262034, "num_env_steps_trained_throughput_per_sec": 270.56761054262034, "timesteps_total": 52038960, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52038960, "timers": {"training_iteration_time_ms": 4423.198, "sample_time_ms": 4390.33, "load_time_ms": 0.57, "load_throughput": 2103989.967, "learn_time_ms": 31.486, "learn_throughput": 38111.904, "synch_weights_time_ms": 0.763}, "counters": {"num_env_steps_sampled": 52038960, "num_env_steps_trained": 52038960, "num_agent_steps_sampled": 52038960, "num_agent_steps_trained": 52038960}, "done": false, "episodes_total": 12822, "training_iteration": 4030, "trial_id": "9f686_00000", "date": "2023-08-08_15-48-34", "timestamp": 1691498914, "time_this_iter_s": 13.30817198753357, "time_total_s": 95332.91600012779, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2248.74281334877, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 18.573684210526313, "ram_util_percent": 65.17368421052632}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -363.3466796875, "policy_loss": -9114270.501736112, "vf_loss": 21154708.055555556}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9207.5, "diff_num_grad_updates_vs_sampler_policy": 9206.5}}, "num_env_steps_sampled": 52042560, "num_env_steps_trained": 52042560, "num_agent_steps_sampled": 52042560, "num_agent_steps_trained": 52042560}, "sampler_results": {"episode_reward_max": -10129.49917156546, "episode_reward_min": -10469.569811396417, "episode_reward_mean": -10299.333215543302, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4283998392528336, "mean_inference_ms": 0.37157821079025793, "mean_action_processing_ms": 0.09125328480860201, "mean_env_wait_ms": 0.7409168778208783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034084320068359375, "StateBufferConnector_ms": 0.0025577545166015625, "ViewRequirementAgentConnector_ms": 0.06573987007141113}}, "episode_reward_max": -10129.49917156546, "episode_reward_min": -10469.569811396417, "episode_reward_mean": -10299.333215543302, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10234.368494048827, -10387.349418644428, -10228.049144120956, -10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4283998392528336, "mean_inference_ms": 0.37157821079025793, "mean_action_processing_ms": 0.09125328480860201, "mean_env_wait_ms": 0.7409168778208783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034084320068359375, "StateBufferConnector_ms": 0.0025577545166015625, "ViewRequirementAgentConnector_ms": 0.06573987007141113}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52042560, "num_agent_steps_trained": 52042560, "num_env_steps_sampled": 52042560, "num_env_steps_trained": 52042560, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 270.51887939230323, "num_env_steps_trained_throughput_per_sec": 270.51887939230323, "timesteps_total": 52042560, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52042560, "timers": {"training_iteration_time_ms": 4430.646, "sample_time_ms": 4398.078, "load_time_ms": 0.57, "load_throughput": 2104253.857, "learn_time_ms": 31.185, "learn_throughput": 38479.588, "synch_weights_time_ms": 0.764}, "counters": {"num_env_steps_sampled": 52042560, "num_env_steps_trained": 52042560, "num_agent_steps_sampled": 52042560, "num_agent_steps_trained": 52042560}, "done": false, "episodes_total": 12825, "training_iteration": 4031, "trial_id": "9f686_00000", "date": "2023-08-08_15-48-47", "timestamp": 1691498927, "time_this_iter_s": 13.310667753219604, "time_total_s": 95346.22666788101, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2262.0534811019897, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 18.947368421052634, "ram_util_percent": 65.09473684210528}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -366.4939659966363, "policy_loss": -6325214.486111111, "vf_loss": 21551066.611111112}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9261.5, "diff_num_grad_updates_vs_sampler_policy": 9260.5}}, "num_env_steps_sampled": 52046160, "num_env_steps_trained": 52046160, "num_agent_steps_sampled": 52046160, "num_agent_steps_trained": 52046160}, "sampler_results": {"episode_reward_max": -10129.49917156546, "episode_reward_min": -10469.569811396417, "episode_reward_mean": -10300.554117806223, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4284138189060602, "mean_inference_ms": 0.37157504327040713, "mean_action_processing_ms": 0.09125342082836718, "mean_env_wait_ms": 0.7408624653328683, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003407716751098633, "StateBufferConnector_ms": 0.0025548934936523438, "ViewRequirementAgentConnector_ms": 0.06579923629760742}}, "episode_reward_max": -10129.49917156546, "episode_reward_min": -10469.569811396417, "episode_reward_mean": -10300.554117806223, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10332.586233115539, -10322.561756467738, -10237.788816305563, -10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4284138189060602, "mean_inference_ms": 0.37157504327040713, "mean_action_processing_ms": 0.09125342082836718, "mean_env_wait_ms": 0.7408624653328683, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003407716751098633, "StateBufferConnector_ms": 0.0025548934936523438, "ViewRequirementAgentConnector_ms": 0.06579923629760742}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52046160, "num_agent_steps_trained": 52046160, "num_env_steps_sampled": 52046160, "num_env_steps_trained": 52046160, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 272.56364930829966, "num_env_steps_trained_throughput_per_sec": 272.56364930829966, "timesteps_total": 52046160, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52046160, "timers": {"training_iteration_time_ms": 4418.159, "sample_time_ms": 4385.384, "load_time_ms": 0.571, "load_throughput": 2100740.765, "learn_time_ms": 31.379, "learn_throughput": 38242.417, "synch_weights_time_ms": 0.777}, "counters": {"num_env_steps_sampled": 52046160, "num_env_steps_trained": 52046160, "num_agent_steps_sampled": 52046160, "num_agent_steps_trained": 52046160}, "done": false, "episodes_total": 12828, "training_iteration": 4032, "trial_id": "9f686_00000", "date": "2023-08-08_15-49-00", "timestamp": 1691498940, "time_this_iter_s": 13.210903882980347, "time_total_s": 95359.43757176399, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2275.26438498497, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 19.589473684210525, "ram_util_percent": 65.20526315789473}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -362.56464301215277, "policy_loss": -7375013.78125, "vf_loss": 21511671.916666668}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9315.5, "diff_num_grad_updates_vs_sampler_policy": 9314.5}}, "num_env_steps_sampled": 52049760, "num_env_steps_trained": 52049760, "num_agent_steps_sampled": 52049760, "num_agent_steps_trained": 52049760}, "sampler_results": {"episode_reward_max": -10129.49917156546, "episode_reward_min": -10469.569811396417, "episode_reward_mean": -10297.26437336455, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428428595548294, "mean_inference_ms": 0.3715714229441196, "mean_action_processing_ms": 0.09125351555057247, "mean_env_wait_ms": 0.7408043939400101, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034034252166748047, "StateBufferConnector_ms": 0.0025482177734375, "ViewRequirementAgentConnector_ms": 0.06573319435119629}}, "episode_reward_max": -10129.49917156546, "episode_reward_min": -10469.569811396417, "episode_reward_mean": -10297.26437336455, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10296.871036745524, -10458.185291760306, -10230.433795846191, -10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428428595548294, "mean_inference_ms": 0.3715714229441196, "mean_action_processing_ms": 0.09125351555057247, "mean_env_wait_ms": 0.7408043939400101, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034034252166748047, "StateBufferConnector_ms": 0.0025482177734375, "ViewRequirementAgentConnector_ms": 0.06573319435119629}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52049760, "num_agent_steps_trained": 52049760, "num_env_steps_sampled": 52049760, "num_env_steps_trained": 52049760, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 274.2419852093984, "num_env_steps_trained_throughput_per_sec": 274.2419852093984, "timesteps_total": 52049760, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52049760, "timers": {"training_iteration_time_ms": 4408.804, "sample_time_ms": 4376.012, "load_time_ms": 0.571, "load_throughput": 2102495.844, "learn_time_ms": 31.375, "learn_throughput": 38246.921, "synch_weights_time_ms": 0.798}, "counters": {"num_env_steps_sampled": 52049760, "num_env_steps_trained": 52049760, "num_agent_steps_sampled": 52049760, "num_agent_steps_trained": 52049760}, "done": false, "episodes_total": 12831, "training_iteration": 4033, "trial_id": "9f686_00000", "date": "2023-08-08_15-49-13", "timestamp": 1691498953, "time_this_iter_s": 13.13004183769226, "time_total_s": 95372.56761360168, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2288.3944268226624, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 18.821052631578947, "ram_util_percent": 65.11578947368422}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -364.402599758572, "policy_loss": -12147961.569444444, "vf_loss": 21626709.666666668}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9369.5, "diff_num_grad_updates_vs_sampler_policy": 9368.5}}, "num_env_steps_sampled": 52053360, "num_env_steps_trained": 52053360, "num_agent_steps_sampled": 52053360, "num_agent_steps_trained": 52053360}, "sampler_results": {"episode_reward_max": -10129.49917156546, "episode_reward_min": -10469.569811396417, "episode_reward_mean": -10294.898513622773, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4284418092546636, "mean_inference_ms": 0.3715675104992818, "mean_action_processing_ms": 0.09125359346915751, "mean_env_wait_ms": 0.7407485563802125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003403186798095703, "StateBufferConnector_ms": 0.0025527477264404297, "ViewRequirementAgentConnector_ms": 0.06577157974243164}}, "episode_reward_max": -10129.49917156546, "episode_reward_min": -10469.569811396417, "episode_reward_mean": -10294.898513622773, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10186.891069291149, -10278.257380295581, -10254.634411335672, -10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4284418092546636, "mean_inference_ms": 0.3715675104992818, "mean_action_processing_ms": 0.09125359346915751, "mean_env_wait_ms": 0.7407485563802125, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003403186798095703, "StateBufferConnector_ms": 0.0025527477264404297, "ViewRequirementAgentConnector_ms": 0.06577157974243164}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52053360, "num_agent_steps_trained": 52053360, "num_env_steps_sampled": 52053360, "num_env_steps_trained": 52053360, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 273.0844159684424, "num_env_steps_trained_throughput_per_sec": 273.0844159684424, "timesteps_total": 52053360, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52053360, "timers": {"training_iteration_time_ms": 4396.287, "sample_time_ms": 4363.248, "load_time_ms": 0.57, "load_throughput": 2104605.812, "learn_time_ms": 31.616, "learn_throughput": 37955.384, "synch_weights_time_ms": 0.804}, "counters": {"num_env_steps_sampled": 52053360, "num_env_steps_trained": 52053360, "num_agent_steps_sampled": 52053360, "num_agent_steps_trained": 52053360}, "done": false, "episodes_total": 12834, "training_iteration": 4034, "trial_id": "9f686_00000", "date": "2023-08-08_15-49-27", "timestamp": 1691498967, "time_this_iter_s": 13.185760974884033, "time_total_s": 95385.75337457657, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2301.5801877975464, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 20.061111111111106, "ram_util_percent": 65.07222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -363.76617262098523, "policy_loss": -9852240.142361112, "vf_loss": 21712572.055555556}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9423.5, "diff_num_grad_updates_vs_sampler_policy": 9422.5}}, "num_env_steps_sampled": 52056960, "num_env_steps_trained": 52056960, "num_agent_steps_sampled": 52056960, "num_agent_steps_trained": 52056960}, "sampler_results": {"episode_reward_max": -10129.49917156546, "episode_reward_min": -10469.569811396417, "episode_reward_mean": -10296.897237048524, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4284582466676077, "mean_inference_ms": 0.37156326470347617, "mean_action_processing_ms": 0.09125361160443647, "mean_env_wait_ms": 0.7406935233960721, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034036636352539062, "StateBufferConnector_ms": 0.0025539398193359375, "ViewRequirementAgentConnector_ms": 0.06579947471618652}}, "episode_reward_max": -10129.49917156546, "episode_reward_min": -10469.569811396417, "episode_reward_mean": -10296.897237048524, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10394.434691425768, -10469.569811396417, -10330.669938350666, -10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4284582466676077, "mean_inference_ms": 0.37156326470347617, "mean_action_processing_ms": 0.09125361160443647, "mean_env_wait_ms": 0.7406935233960721, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034036636352539062, "StateBufferConnector_ms": 0.0025539398193359375, "ViewRequirementAgentConnector_ms": 0.06579947471618652}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52056960, "num_agent_steps_trained": 52056960, "num_env_steps_sampled": 52056960, "num_env_steps_trained": 52056960, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 271.22016626460675, "num_env_steps_trained_throughput_per_sec": 271.22016626460675, "timesteps_total": 52056960, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52056960, "timers": {"training_iteration_time_ms": 4394.573, "sample_time_ms": 4361.469, "load_time_ms": 0.572, "load_throughput": 2097152.0, "learn_time_ms": 31.7, "learn_throughput": 37855.384, "synch_weights_time_ms": 0.782}, "counters": {"num_env_steps_sampled": 52056960, "num_env_steps_trained": 52056960, "num_agent_steps_sampled": 52056960, "num_agent_steps_trained": 52056960}, "done": false, "episodes_total": 12837, "training_iteration": 4035, "trial_id": "9f686_00000", "date": "2023-08-08_15-49-40", "timestamp": 1691498980, "time_this_iter_s": 13.276217937469482, "time_total_s": 95399.02959251404, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2314.856405735016, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 19.894736842105264, "ram_util_percent": 65.32105263157894}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -364.32648213704425, "policy_loss": -6269376.289713542, "vf_loss": 21441560.611111112}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9477.5, "diff_num_grad_updates_vs_sampler_policy": 9476.5}}, "num_env_steps_sampled": 52060560, "num_env_steps_trained": 52060560, "num_agent_steps_sampled": 52060560, "num_agent_steps_trained": 52060560}, "sampler_results": {"episode_reward_max": -10129.49917156546, "episode_reward_min": -10466.01553139352, "episode_reward_mean": -10293.65489380895, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4284688547257045, "mean_inference_ms": 0.3715591639150129, "mean_action_processing_ms": 0.09125361966600185, "mean_env_wait_ms": 0.7406361531044875, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034003257751464844, "StateBufferConnector_ms": 0.0025632381439208984, "ViewRequirementAgentConnector_ms": 0.06580781936645508}}, "episode_reward_max": -10129.49917156546, "episode_reward_min": -10466.01553139352, "episode_reward_mean": -10293.65489380895, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10129.49917156546, -10356.149231307232, -10300.634436802582, -10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4284688547257045, "mean_inference_ms": 0.3715591639150129, "mean_action_processing_ms": 0.09125361966600185, "mean_env_wait_ms": 0.7406361531044875, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034003257751464844, "StateBufferConnector_ms": 0.0025632381439208984, "ViewRequirementAgentConnector_ms": 0.06580781936645508}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52060560, "num_agent_steps_trained": 52060560, "num_env_steps_sampled": 52060560, "num_env_steps_trained": 52060560, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 274.8887341490617, "num_env_steps_trained_throughput_per_sec": 274.8887341490617, "timesteps_total": 52060560, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52060560, "timers": {"training_iteration_time_ms": 4392.733, "sample_time_ms": 4359.505, "load_time_ms": 0.574, "load_throughput": 2088970.2, "learn_time_ms": 31.812, "learn_throughput": 37721.982, "synch_weights_time_ms": 0.792}, "counters": {"num_env_steps_sampled": 52060560, "num_env_steps_trained": 52060560, "num_agent_steps_sampled": 52060560, "num_agent_steps_trained": 52060560}, "done": false, "episodes_total": 12840, "training_iteration": 4036, "trial_id": "9f686_00000", "date": "2023-08-08_15-49-53", "timestamp": 1691498993, "time_this_iter_s": 13.099039077758789, "time_total_s": 95412.1286315918, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2327.9554448127747, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 18.72631578947368, "ram_util_percent": 65.45263157894739}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -363.26664564344617, "policy_loss": -8158320.172743056, "vf_loss": 21306362.444444444}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9531.5, "diff_num_grad_updates_vs_sampler_policy": 9530.5}}, "num_env_steps_sampled": 52064160, "num_env_steps_trained": 52064160, "num_agent_steps_sampled": 52064160, "num_agent_steps_trained": 52064160}, "sampler_results": {"episode_reward_max": -10140.323516032824, "episode_reward_min": -10466.01553139352, "episode_reward_mean": -10292.572170654359, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4284775809776944, "mean_inference_ms": 0.3715550323208782, "mean_action_processing_ms": 0.09125358796680168, "mean_env_wait_ms": 0.7405751772038153, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033991336822509766, "StateBufferConnector_ms": 0.0025625228881835938, "ViewRequirementAgentConnector_ms": 0.06579852104187012}}, "episode_reward_max": -10140.323516032824, "episode_reward_min": -10466.01553139352, "episode_reward_mean": -10292.572170654359, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10435.147882464167, -10282.058130490319, -10303.768381253685, -10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4284775809776944, "mean_inference_ms": 0.3715550323208782, "mean_action_processing_ms": 0.09125358796680168, "mean_env_wait_ms": 0.7405751772038153, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033991336822509766, "StateBufferConnector_ms": 0.0025625228881835938, "ViewRequirementAgentConnector_ms": 0.06579852104187012}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52064160, "num_agent_steps_trained": 52064160, "num_env_steps_sampled": 52064160, "num_env_steps_trained": 52064160, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 273.7325978417873, "num_env_steps_trained_throughput_per_sec": 273.7325978417873, "timesteps_total": 52064160, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52064160, "timers": {"training_iteration_time_ms": 4396.283, "sample_time_ms": 4363.071, "load_time_ms": 0.576, "load_throughput": 2082573.982, "learn_time_ms": 31.813, "learn_throughput": 37720.907, "synch_weights_time_ms": 0.775}, "counters": {"num_env_steps_sampled": 52064160, "num_env_steps_trained": 52064160, "num_agent_steps_sampled": 52064160, "num_agent_steps_trained": 52064160}, "done": false, "episodes_total": 12843, "training_iteration": 4037, "trial_id": "9f686_00000", "date": "2023-08-08_15-50-06", "timestamp": 1691499006, "time_this_iter_s": 13.154438972473145, "time_total_s": 95425.28307056427, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2341.109883785248, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 18.566666666666666, "ram_util_percent": 65.37222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -361.9250013563368, "policy_loss": -10461740.609375, "vf_loss": 21618221.416666668}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9585.5, "diff_num_grad_updates_vs_sampler_policy": 9584.5}}, "num_env_steps_sampled": 52067760, "num_env_steps_trained": 52067760, "num_agent_steps_sampled": 52067760, "num_agent_steps_trained": 52067760}, "sampler_results": {"episode_reward_max": -10140.323516032824, "episode_reward_min": -10466.01553139352, "episode_reward_mean": -10290.79257415532, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428480650421964, "mean_inference_ms": 0.37155092583350446, "mean_action_processing_ms": 0.09125353295703027, "mean_env_wait_ms": 0.7405138088834827, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034003257751464844, "StateBufferConnector_ms": 0.0025670528411865234, "ViewRequirementAgentConnector_ms": 0.06579804420471191}}, "episode_reward_max": -10140.323516032824, "episode_reward_min": -10466.01553139352, "episode_reward_mean": -10290.79257415532, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10258.911487763708, -10283.881897725909, -10213.043656733062, -10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428480650421964, "mean_inference_ms": 0.37155092583350446, "mean_action_processing_ms": 0.09125353295703027, "mean_env_wait_ms": 0.7405138088834827, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034003257751464844, "StateBufferConnector_ms": 0.0025670528411865234, "ViewRequirementAgentConnector_ms": 0.06579804420471191}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52067760, "num_agent_steps_trained": 52067760, "num_env_steps_sampled": 52067760, "num_env_steps_trained": 52067760, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 274.0299988688171, "num_env_steps_trained_throughput_per_sec": 274.0299988688171, "timesteps_total": 52067760, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52067760, "timers": {"training_iteration_time_ms": 4381.651, "sample_time_ms": 4348.623, "load_time_ms": 0.574, "load_throughput": 2089924.345, "learn_time_ms": 31.618, "learn_throughput": 37952.837, "synch_weights_time_ms": 0.787}, "counters": {"num_env_steps_sampled": 52067760, "num_env_steps_trained": 52067760, "num_agent_steps_sampled": 52067760, "num_agent_steps_trained": 52067760}, "done": false, "episodes_total": 12846, "training_iteration": 4038, "trial_id": "9f686_00000", "date": "2023-08-08_15-50-19", "timestamp": 1691499019, "time_this_iter_s": 13.140100002288818, "time_total_s": 95438.42317056656, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2354.2499837875366, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 19.33157894736842, "ram_util_percent": 65.26315789473684}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -362.54447597927515, "policy_loss": -8744554.626736112, "vf_loss": 21956960.555555556}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9639.5, "diff_num_grad_updates_vs_sampler_policy": 9638.5}}, "num_env_steps_sampled": 52071360, "num_env_steps_trained": 52071360, "num_agent_steps_sampled": 52071360, "num_agent_steps_trained": 52071360}, "sampler_results": {"episode_reward_max": -10140.323516032824, "episode_reward_min": -10466.01553139352, "episode_reward_mean": -10294.088121291334, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428482477071191, "mean_inference_ms": 0.3715470212505466, "mean_action_processing_ms": 0.09125347360993978, "mean_env_wait_ms": 0.7404579472969632, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003404855728149414, "StateBufferConnector_ms": 0.002566814422607422, "ViewRequirementAgentConnector_ms": 0.06589221954345703}}, "episode_reward_max": -10140.323516032824, "episode_reward_min": -10466.01553139352, "episode_reward_mean": -10294.088121291334, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10253.69924066793, -10260.307534103338, -10277.88115937151, -10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428482477071191, "mean_inference_ms": 0.3715470212505466, "mean_action_processing_ms": 0.09125347360993978, "mean_env_wait_ms": 0.7404579472969632, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003404855728149414, "StateBufferConnector_ms": 0.002566814422607422, "ViewRequirementAgentConnector_ms": 0.06589221954345703}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52071360, "num_agent_steps_trained": 52071360, "num_env_steps_sampled": 52071360, "num_env_steps_trained": 52071360, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 270.0302619277523, "num_env_steps_trained_throughput_per_sec": 270.0302619277523, "timesteps_total": 52071360, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52071360, "timers": {"training_iteration_time_ms": 4403.558, "sample_time_ms": 4370.916, "load_time_ms": 0.578, "load_throughput": 2077159.341, "learn_time_ms": 31.239, "learn_throughput": 38413.188, "synch_weights_time_ms": 0.776}, "counters": {"num_env_steps_sampled": 52071360, "num_env_steps_trained": 52071360, "num_agent_steps_sampled": 52071360, "num_agent_steps_trained": 52071360}, "done": false, "episodes_total": 12849, "training_iteration": 4039, "trial_id": "9f686_00000", "date": "2023-08-08_15-50-33", "timestamp": 1691499033, "time_this_iter_s": 13.335015058517456, "time_total_s": 95451.75818562508, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2367.584998846054, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 19.036842105263162, "ram_util_percent": 65.1578947368421}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -363.9412265353733, "policy_loss": -4910128.799045139, "vf_loss": 21559665.722222224}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9693.5, "diff_num_grad_updates_vs_sampler_policy": 9692.5}}, "num_env_steps_sampled": 52074960, "num_env_steps_trained": 52074960, "num_agent_steps_sampled": 52074960, "num_agent_steps_trained": 52074960}, "sampler_results": {"episode_reward_max": -10140.323516032824, "episode_reward_min": -10466.01553139352, "episode_reward_mean": -10295.41724698005, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4284854117265966, "mean_inference_ms": 0.3715430460848139, "mean_action_processing_ms": 0.091253350144158, "mean_env_wait_ms": 0.7404027934274575, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003409147262573242, "StateBufferConnector_ms": 0.002575397491455078, "ViewRequirementAgentConnector_ms": 0.06591320037841797}}, "episode_reward_max": -10140.323516032824, "episode_reward_min": -10466.01553139352, "episode_reward_mean": -10295.41724698005, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10309.785961742673, -10398.932941315521, -10272.914683748477, -10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4284854117265966, "mean_inference_ms": 0.3715430460848139, "mean_action_processing_ms": 0.091253350144158, "mean_env_wait_ms": 0.7404027934274575, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003409147262573242, "StateBufferConnector_ms": 0.002575397491455078, "ViewRequirementAgentConnector_ms": 0.06591320037841797}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52074960, "num_agent_steps_trained": 52074960, "num_env_steps_sampled": 52074960, "num_env_steps_trained": 52074960, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 271.6281857678795, "num_env_steps_trained_throughput_per_sec": 271.6281857678795, "timesteps_total": 52074960, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52074960, "timers": {"training_iteration_time_ms": 4413.203, "sample_time_ms": 4380.652, "load_time_ms": 0.581, "load_throughput": 2063787.436, "learn_time_ms": 31.136, "learn_throughput": 38541.112, "synch_weights_time_ms": 0.785}, "counters": {"num_env_steps_sampled": 52074960, "num_env_steps_trained": 52074960, "num_agent_steps_sampled": 52074960, "num_agent_steps_trained": 52074960}, "done": false, "episodes_total": 12852, "training_iteration": 4040, "trial_id": "9f686_00000", "date": "2023-08-08_15-50-46", "timestamp": 1691499046, "time_this_iter_s": 13.256227970123291, "time_total_s": 95465.0144135952, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2380.8412268161774, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 18.59473684210526, "ram_util_percent": 65.14736842105263}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -362.7365892198351, "policy_loss": -8450798.182291666, "vf_loss": 21458457.805555556}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9747.5, "diff_num_grad_updates_vs_sampler_policy": 9746.5}}, "num_env_steps_sampled": 52078560, "num_env_steps_trained": 52078560, "num_agent_steps_sampled": 52078560, "num_agent_steps_trained": 52078560}, "sampler_results": {"episode_reward_max": -10138.414807519051, "episode_reward_min": -10466.01553139352, "episode_reward_mean": -10293.492237785043, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4284899509376943, "mean_inference_ms": 0.37153949674132897, "mean_action_processing_ms": 0.09125322467456849, "mean_env_wait_ms": 0.7403489304066508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003416299819946289, "StateBufferConnector_ms": 0.002579927444458008, "ViewRequirementAgentConnector_ms": 0.06597495079040527}}, "episode_reward_max": -10138.414807519051, "episode_reward_min": -10466.01553139352, "episode_reward_mean": -10293.492237785043, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10429.50334653069, -10323.388105640412, -10291.725339222343, -10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4284899509376943, "mean_inference_ms": 0.37153949674132897, "mean_action_processing_ms": 0.09125322467456849, "mean_env_wait_ms": 0.7403489304066508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003416299819946289, "StateBufferConnector_ms": 0.002579927444458008, "ViewRequirementAgentConnector_ms": 0.06597495079040527}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52078560, "num_agent_steps_trained": 52078560, "num_env_steps_sampled": 52078560, "num_env_steps_trained": 52078560, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 270.9280615976829, "num_env_steps_trained_throughput_per_sec": 270.9280615976829, "timesteps_total": 52078560, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52078560, "timers": {"training_iteration_time_ms": 4424.669, "sample_time_ms": 4392.257, "load_time_ms": 0.583, "load_throughput": 2058806.725, "learn_time_ms": 31.002, "learn_throughput": 38707.422, "synch_weights_time_ms": 0.777}, "counters": {"num_env_steps_sampled": 52078560, "num_env_steps_trained": 52078560, "num_agent_steps_sampled": 52078560, "num_agent_steps_trained": 52078560}, "done": false, "episodes_total": 12855, "training_iteration": 4041, "trial_id": "9f686_00000", "date": "2023-08-08_15-50-59", "timestamp": 1691499059, "time_this_iter_s": 13.290618896484375, "time_total_s": 95478.30503249168, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2394.1318457126617, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 19.778947368421058, "ram_util_percent": 65.11052631578949}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -366.7115783691406, "policy_loss": -6775186.391059028, "vf_loss": 21769387.722222224}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9801.5, "diff_num_grad_updates_vs_sampler_policy": 9800.5}}, "num_env_steps_sampled": 52082160, "num_env_steps_trained": 52082160, "num_agent_steps_sampled": 52082160, "num_agent_steps_trained": 52082160}, "sampler_results": {"episode_reward_max": -10138.414807519051, "episode_reward_min": -10466.01553139352, "episode_reward_mean": -10293.04265897209, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4284963606510086, "mean_inference_ms": 0.3715358844465883, "mean_action_processing_ms": 0.09125310431772383, "mean_env_wait_ms": 0.740295976585158, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034170150756835938, "StateBufferConnector_ms": 0.0025794506072998047, "ViewRequirementAgentConnector_ms": 0.06605815887451172}}, "episode_reward_max": -10138.414807519051, "episode_reward_min": -10466.01553139352, "episode_reward_mean": -10293.04265897209, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10227.690212406513, -10330.426917283556, -10202.296282496005, -10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4284963606510086, "mean_inference_ms": 0.3715358844465883, "mean_action_processing_ms": 0.09125310431772383, "mean_env_wait_ms": 0.740295976585158, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034170150756835938, "StateBufferConnector_ms": 0.0025794506072998047, "ViewRequirementAgentConnector_ms": 0.06605815887451172}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52082160, "num_agent_steps_trained": 52082160, "num_env_steps_sampled": 52082160, "num_env_steps_trained": 52082160, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 271.7907453664381, "num_env_steps_trained_throughput_per_sec": 271.7907453664381, "timesteps_total": 52082160, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52082160, "timers": {"training_iteration_time_ms": 4422.737, "sample_time_ms": 4390.309, "load_time_ms": 0.585, "load_throughput": 2052258.838, "learn_time_ms": 31.029, "learn_throughput": 38673.071, "synch_weights_time_ms": 0.764}, "counters": {"num_env_steps_sampled": 52082160, "num_env_steps_trained": 52082160, "num_agent_steps_sampled": 52082160, "num_agent_steps_trained": 52082160}, "done": false, "episodes_total": 12858, "training_iteration": 4042, "trial_id": "9f686_00000", "date": "2023-08-08_15-51-13", "timestamp": 1691499073, "time_this_iter_s": 13.248392105102539, "time_total_s": 95491.55342459679, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2407.3802378177643, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 19.12777777777778, "ram_util_percent": 65.21666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -368.00368245442706, "policy_loss": -3656619.2743055555, "vf_loss": 21238028.055555556}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9855.5, "diff_num_grad_updates_vs_sampler_policy": 9854.5}}, "num_env_steps_sampled": 52085760, "num_env_steps_trained": 52085760, "num_agent_steps_sampled": 52085760, "num_agent_steps_trained": 52085760}, "sampler_results": {"episode_reward_max": -10138.414807519051, "episode_reward_min": -10466.01553139352, "episode_reward_mean": -10294.528784820552, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428502767201828, "mean_inference_ms": 0.37153238403550615, "mean_action_processing_ms": 0.09125297533642239, "mean_env_wait_ms": 0.740245845566196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034122467041015625, "StateBufferConnector_ms": 0.0025784969329833984, "ViewRequirementAgentConnector_ms": 0.06613302230834961}}, "episode_reward_max": -10138.414807519051, "episode_reward_min": -10466.01553139352, "episode_reward_mean": -10294.528784820552, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10187.313094002353, -10276.659832007737, -10184.17284664471, -10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428502767201828, "mean_inference_ms": 0.37153238403550615, "mean_action_processing_ms": 0.09125297533642239, "mean_env_wait_ms": 0.740245845566196, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034122467041015625, "StateBufferConnector_ms": 0.0025784969329833984, "ViewRequirementAgentConnector_ms": 0.06613302230834961}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52085760, "num_agent_steps_trained": 52085760, "num_env_steps_sampled": 52085760, "num_env_steps_trained": 52085760, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 271.0001192260975, "num_env_steps_trained_throughput_per_sec": 271.0001192260975, "timesteps_total": 52085760, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52085760, "timers": {"training_iteration_time_ms": 4421.646, "sample_time_ms": 4389.19, "load_time_ms": 0.585, "load_throughput": 2052342.522, "learn_time_ms": 31.069, "learn_throughput": 38623.925, "synch_weights_time_ms": 0.753}, "counters": {"num_env_steps_sampled": 52085760, "num_env_steps_trained": 52085760, "num_agent_steps_sampled": 52085760, "num_agent_steps_trained": 52085760}, "done": false, "episodes_total": 12861, "training_iteration": 4043, "trial_id": "9f686_00000", "date": "2023-08-08_15-51-26", "timestamp": 1691499086, "time_this_iter_s": 13.28694200515747, "time_total_s": 95504.84036660194, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2420.6671798229218, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 19.2, "ram_util_percent": 65.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -362.825681898329, "policy_loss": -9255230.567708334, "vf_loss": 21896522.388888888}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9909.5, "diff_num_grad_updates_vs_sampler_policy": 9908.5}}, "num_env_steps_sampled": 52089360, "num_env_steps_trained": 52089360, "num_agent_steps_sampled": 52089360, "num_agent_steps_trained": 52089360}, "sampler_results": {"episode_reward_max": -10138.414807519051, "episode_reward_min": -10466.01553139352, "episode_reward_mean": -10297.000194157474, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428503995261036, "mean_inference_ms": 0.37152838227719437, "mean_action_processing_ms": 0.09125275442157696, "mean_env_wait_ms": 0.7401973947839628, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034122467041015625, "StateBufferConnector_ms": 0.002574920654296875, "ViewRequirementAgentConnector_ms": 0.06610393524169922}}, "episode_reward_max": -10138.414807519051, "episode_reward_min": -10466.01553139352, "episode_reward_mean": -10297.000194157474, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10345.490501097203, -10397.329765346074, -10302.72437120281, -10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428503995261036, "mean_inference_ms": 0.37152838227719437, "mean_action_processing_ms": 0.09125275442157696, "mean_env_wait_ms": 0.7401973947839628, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034122467041015625, "StateBufferConnector_ms": 0.002574920654296875, "ViewRequirementAgentConnector_ms": 0.06610393524169922}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52089360, "num_agent_steps_trained": 52089360, "num_env_steps_sampled": 52089360, "num_env_steps_trained": 52089360, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 273.5744238846079, "num_env_steps_trained_throughput_per_sec": 273.5744238846079, "timesteps_total": 52089360, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52089360, "timers": {"training_iteration_time_ms": 4412.128, "sample_time_ms": 4379.2, "load_time_ms": 0.588, "load_throughput": 2039287.225, "learn_time_ms": 31.515, "learn_throughput": 38077.247, "synch_weights_time_ms": 0.773}, "counters": {"num_env_steps_sampled": 52089360, "num_env_steps_trained": 52089360, "num_agent_steps_sampled": 52089360, "num_agent_steps_trained": 52089360}, "done": false, "episodes_total": 12864, "training_iteration": 4044, "trial_id": "9f686_00000", "date": "2023-08-08_15-51-39", "timestamp": 1691499099, "time_this_iter_s": 13.162089824676514, "time_total_s": 95518.00245642662, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2433.8292696475983, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 20.905263157894737, "ram_util_percent": 65.31052631578947}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -362.2275611029731, "policy_loss": -4526138.308159722, "vf_loss": 21272586.444444444}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9963.5, "diff_num_grad_updates_vs_sampler_policy": 9962.5}}, "num_env_steps_sampled": 52092960, "num_env_steps_trained": 52092960, "num_agent_steps_sampled": 52092960, "num_agent_steps_trained": 52092960}, "sampler_results": {"episode_reward_max": -10138.414807519051, "episode_reward_min": -10466.01553139352, "episode_reward_mean": -10295.493452096423, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428497983135221, "mean_inference_ms": 0.3715243956119725, "mean_action_processing_ms": 0.09125252388538901, "mean_env_wait_ms": 0.7401485511863294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003415822982788086, "StateBufferConnector_ms": 0.002570629119873047, "ViewRequirementAgentConnector_ms": 0.06610679626464844}}, "episode_reward_max": -10138.414807519051, "episode_reward_min": -10466.01553139352, "episode_reward_mean": -10295.493452096423, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10216.755852543552, -10146.112045627631, -10225.519119809835, -10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428497983135221, "mean_inference_ms": 0.3715243956119725, "mean_action_processing_ms": 0.09125252388538901, "mean_env_wait_ms": 0.7401485511863294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003415822982788086, "StateBufferConnector_ms": 0.002570629119873047, "ViewRequirementAgentConnector_ms": 0.06610679626464844}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52092960, "num_agent_steps_trained": 52092960, "num_env_steps_sampled": 52092960, "num_env_steps_trained": 52092960, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 273.8332224029844, "num_env_steps_trained_throughput_per_sec": 273.8332224029844, "timesteps_total": 52092960, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52092960, "timers": {"training_iteration_time_ms": 4402.319, "sample_time_ms": 4369.387, "load_time_ms": 0.582, "load_throughput": 2060323.714, "learn_time_ms": 31.506, "learn_throughput": 38087.909, "synch_weights_time_ms": 0.794}, "counters": {"num_env_steps_sampled": 52092960, "num_env_steps_trained": 52092960, "num_agent_steps_sampled": 52092960, "num_agent_steps_trained": 52092960}, "done": false, "episodes_total": 12867, "training_iteration": 4045, "trial_id": "9f686_00000", "date": "2023-08-08_15-51-52", "timestamp": 1691499112, "time_this_iter_s": 13.14951777458191, "time_total_s": 95531.1519742012, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2446.97878742218, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 20.03684210526316, "ram_util_percent": 65.48947368421054}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -364.04959445529516, "policy_loss": -10832759.389756944, "vf_loss": 21745780.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10017.5, "diff_num_grad_updates_vs_sampler_policy": 10016.5}}, "num_env_steps_sampled": 52096560, "num_env_steps_trained": 52096560, "num_agent_steps_sampled": 52096560, "num_agent_steps_trained": 52096560}, "sampler_results": {"episode_reward_max": -10138.414807519051, "episode_reward_min": -10466.01553139352, "episode_reward_mean": -10299.85697232315, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428494711119326, "mean_inference_ms": 0.3715203243837598, "mean_action_processing_ms": 0.09125225602574005, "mean_env_wait_ms": 0.7401035129759878, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00341796875, "StateBufferConnector_ms": 0.0025687217712402344, "ViewRequirementAgentConnector_ms": 0.06606602668762207}}, "episode_reward_max": -10138.414807519051, "episode_reward_min": -10466.01553139352, "episode_reward_mean": -10299.85697232315, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10229.458769966075, -10304.308749510825, -10326.700893534284, -10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428494711119326, "mean_inference_ms": 0.3715203243837598, "mean_action_processing_ms": 0.09125225602574005, "mean_env_wait_ms": 0.7401035129759878, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00341796875, "StateBufferConnector_ms": 0.0025687217712402344, "ViewRequirementAgentConnector_ms": 0.06606602668762207}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52096560, "num_agent_steps_trained": 52096560, "num_env_steps_sampled": 52096560, "num_env_steps_trained": 52096560, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 271.38079397176574, "num_env_steps_trained_throughput_per_sec": 271.38079397176574, "timesteps_total": 52096560, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52096560, "timers": {"training_iteration_time_ms": 4398.455, "sample_time_ms": 4365.285, "load_time_ms": 0.584, "load_throughput": 2054772.321, "learn_time_ms": 31.727, "learn_throughput": 37822.499, "synch_weights_time_ms": 0.807}, "counters": {"num_env_steps_sampled": 52096560, "num_env_steps_trained": 52096560, "num_agent_steps_sampled": 52096560, "num_agent_steps_trained": 52096560}, "done": false, "episodes_total": 12870, "training_iteration": 4046, "trial_id": "9f686_00000", "date": "2023-08-08_15-52-06", "timestamp": 1691499126, "time_this_iter_s": 13.268379926681519, "time_total_s": 95544.42035412788, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2460.2471673488617, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 18.727777777777774, "ram_util_percent": 65.31666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -361.8517761230469, "policy_loss": -7787692.333767361, "vf_loss": 21340227.194444444}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10071.5, "diff_num_grad_updates_vs_sampler_policy": 10070.5}}, "num_env_steps_sampled": 52100160, "num_env_steps_trained": 52100160, "num_agent_steps_sampled": 52100160, "num_agent_steps_trained": 52100160}, "sampler_results": {"episode_reward_max": -10138.414807519051, "episode_reward_min": -10497.83942215756, "episode_reward_mean": -10302.292011023888, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4284866544236197, "mean_inference_ms": 0.37151625362948093, "mean_action_processing_ms": 0.09125197709309538, "mean_env_wait_ms": 0.7400637902585321, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00341033935546875, "StateBufferConnector_ms": 0.002574443817138672, "ViewRequirementAgentConnector_ms": 0.06603550910949707}}, "episode_reward_max": -10138.414807519051, "episode_reward_min": -10497.83942215756, "episode_reward_mean": -10302.292011023888, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10238.526005570517, -10214.00158887768, -10254.60196323298, -10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4284866544236197, "mean_inference_ms": 0.37151625362948093, "mean_action_processing_ms": 0.09125197709309538, "mean_env_wait_ms": 0.7400637902585321, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00341033935546875, "StateBufferConnector_ms": 0.002574443817138672, "ViewRequirementAgentConnector_ms": 0.06603550910949707}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52100160, "num_agent_steps_trained": 52100160, "num_env_steps_sampled": 52100160, "num_env_steps_trained": 52100160, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 273.4406002479302, "num_env_steps_trained_throughput_per_sec": 273.4406002479302, "timesteps_total": 52100160, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52100160, "timers": {"training_iteration_time_ms": 4400.96, "sample_time_ms": 4368.135, "load_time_ms": 0.585, "load_throughput": 2051422.376, "learn_time_ms": 31.389, "learn_throughput": 38230.449, "synch_weights_time_ms": 0.799}, "counters": {"num_env_steps_sampled": 52100160, "num_env_steps_trained": 52100160, "num_agent_steps_sampled": 52100160, "num_agent_steps_trained": 52100160}, "done": false, "episodes_total": 12873, "training_iteration": 4047, "trial_id": "9f686_00000", "date": "2023-08-08_15-52-19", "timestamp": 1691499139, "time_this_iter_s": 13.168385982513428, "time_total_s": 95557.5887401104, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2473.415553331375, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 20.489473684210523, "ram_util_percent": 65.37368421052629}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -361.9797075059679, "policy_loss": -12025385.588541666, "vf_loss": 21730857.027777776}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10125.5, "diff_num_grad_updates_vs_sampler_policy": 10124.5}}, "num_env_steps_sampled": 52103760, "num_env_steps_trained": 52103760, "num_agent_steps_sampled": 52103760, "num_agent_steps_trained": 52103760}, "sampler_results": {"episode_reward_max": -10138.414807519051, "episode_reward_min": -10497.83942215756, "episode_reward_mean": -10306.58826449197, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4284791994996975, "mean_inference_ms": 0.3715122620529063, "mean_action_processing_ms": 0.09125166807674832, "mean_env_wait_ms": 0.7400282297092062, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034110546112060547, "StateBufferConnector_ms": 0.002569437026977539, "ViewRequirementAgentConnector_ms": 0.06599926948547363}}, "episode_reward_max": -10138.414807519051, "episode_reward_min": -10497.83942215756, "episode_reward_mean": -10306.58826449197, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10364.808964672131, -10293.64638986135, -10300.704381793672, -10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4284791994996975, "mean_inference_ms": 0.3715122620529063, "mean_action_processing_ms": 0.09125166807674832, "mean_env_wait_ms": 0.7400282297092062, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034110546112060547, "StateBufferConnector_ms": 0.002569437026977539, "ViewRequirementAgentConnector_ms": 0.06599926948547363}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52103760, "num_agent_steps_trained": 52103760, "num_env_steps_sampled": 52103760, "num_env_steps_trained": 52103760, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 270.43513269881396, "num_env_steps_trained_throughput_per_sec": 270.43513269881396, "timesteps_total": 52103760, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52103760, "timers": {"training_iteration_time_ms": 4410.806, "sample_time_ms": 4377.982, "load_time_ms": 0.581, "load_throughput": 2064972.84, "learn_time_ms": 31.41, "learn_throughput": 38203.897, "synch_weights_time_ms": 0.782}, "counters": {"num_env_steps_sampled": 52103760, "num_env_steps_trained": 52103760, "num_agent_steps_sampled": 52103760, "num_agent_steps_trained": 52103760}, "done": false, "episodes_total": 12876, "training_iteration": 4048, "trial_id": "9f686_00000", "date": "2023-08-08_15-52-32", "timestamp": 1691499152, "time_this_iter_s": 13.314755201339722, "time_total_s": 95570.90349531174, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2486.730308532715, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 19.457894736842103, "ram_util_percent": 65.14736842105262}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -362.9191250271267, "policy_loss": -10320400.683159722, "vf_loss": 21834328.166666668}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10179.5, "diff_num_grad_updates_vs_sampler_policy": 10178.5}}, "num_env_steps_sampled": 52107360, "num_env_steps_trained": 52107360, "num_agent_steps_sampled": 52107360, "num_agent_steps_trained": 52107360}, "sampler_results": {"episode_reward_max": -10138.414807519051, "episode_reward_min": -10497.83942215756, "episode_reward_mean": -10305.133392373491, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4284769683486163, "mean_inference_ms": 0.3715075173861141, "mean_action_processing_ms": 0.09125120711373487, "mean_env_wait_ms": 0.7399955904984001, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003407001495361328, "StateBufferConnector_ms": 0.0025904178619384766, "ViewRequirementAgentConnector_ms": 0.06601572036743164}}, "episode_reward_max": -10138.414807519051, "episode_reward_min": -10497.83942215756, "episode_reward_mean": -10305.133392373491, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10234.402369340367, -10324.82185684691, -10182.202730711304, -10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4284769683486163, "mean_inference_ms": 0.3715075173861141, "mean_action_processing_ms": 0.09125120711373487, "mean_env_wait_ms": 0.7399955904984001, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003407001495361328, "StateBufferConnector_ms": 0.0025904178619384766, "ViewRequirementAgentConnector_ms": 0.06601572036743164}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52107360, "num_agent_steps_trained": 52107360, "num_env_steps_sampled": 52107360, "num_env_steps_trained": 52107360, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 271.73115638795656, "num_env_steps_trained_throughput_per_sec": 271.73115638795656, "timesteps_total": 52107360, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52107360, "timers": {"training_iteration_time_ms": 4413.987, "sample_time_ms": 4381.084, "load_time_ms": 0.576, "load_throughput": 2084039.916, "learn_time_ms": 31.504, "learn_throughput": 38090.244, "synch_weights_time_ms": 0.774}, "counters": {"num_env_steps_sampled": 52107360, "num_env_steps_trained": 52107360, "num_agent_steps_sampled": 52107360, "num_agent_steps_trained": 52107360}, "done": false, "episodes_total": 12879, "training_iteration": 4049, "trial_id": "9f686_00000", "date": "2023-08-08_15-52-45", "timestamp": 1691499165, "time_this_iter_s": 13.251436948776245, "time_total_s": 95584.15493226051, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2499.981745481491, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 18.66842105263158, "ram_util_percent": 65.14210526315792}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -362.25720553927954, "policy_loss": -10725682.407986112, "vf_loss": 21640860.222222224}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10233.5, "diff_num_grad_updates_vs_sampler_policy": 10232.5}}, "num_env_steps_sampled": 52110960, "num_env_steps_trained": 52110960, "num_agent_steps_sampled": 52110960, "num_agent_steps_trained": 52110960}, "sampler_results": {"episode_reward_max": -10119.50262254747, "episode_reward_min": -10497.83942215756, "episode_reward_mean": -10306.186476540643, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428479664441579, "mean_inference_ms": 0.3715025947819502, "mean_action_processing_ms": 0.09125070087951932, "mean_env_wait_ms": 0.739963148710364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003414154052734375, "StateBufferConnector_ms": 0.002590656280517578, "ViewRequirementAgentConnector_ms": 0.06606554985046387}}, "episode_reward_max": -10119.50262254747, "episode_reward_min": -10497.83942215756, "episode_reward_mean": -10306.186476540643, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10300.899887475334, -10256.671137796695, -10233.237749196089, -10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428479664441579, "mean_inference_ms": 0.3715025947819502, "mean_action_processing_ms": 0.09125070087951932, "mean_env_wait_ms": 0.739963148710364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003414154052734375, "StateBufferConnector_ms": 0.002590656280517578, "ViewRequirementAgentConnector_ms": 0.06606554985046387}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52110960, "num_agent_steps_trained": 52110960, "num_env_steps_sampled": 52110960, "num_env_steps_trained": 52110960, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 272.69496098642884, "num_env_steps_trained_throughput_per_sec": 272.69496098642884, "timesteps_total": 52110960, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52110960, "timers": {"training_iteration_time_ms": 4412.952, "sample_time_ms": 4380.224, "load_time_ms": 0.575, "load_throughput": 2087670.496, "learn_time_ms": 31.338, "learn_throughput": 38292.489, "synch_weights_time_ms": 0.767}, "counters": {"num_env_steps_sampled": 52110960, "num_env_steps_trained": 52110960, "num_agent_steps_sampled": 52110960, "num_agent_steps_trained": 52110960}, "done": false, "episodes_total": 12882, "training_iteration": 4050, "trial_id": "9f686_00000", "date": "2023-08-08_15-52-59", "timestamp": 1691499179, "time_this_iter_s": 13.204424142837524, "time_total_s": 95597.35935640335, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2513.1861696243286, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 20.633333333333333, "ram_util_percent": 65.07777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -361.95679728190106, "policy_loss": -1928471.9184027778, "vf_loss": 20867609.055555556}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10287.5, "diff_num_grad_updates_vs_sampler_policy": 10286.5}}, "num_env_steps_sampled": 52114560, "num_env_steps_trained": 52114560, "num_agent_steps_sampled": 52114560, "num_agent_steps_trained": 52114560}, "sampler_results": {"episode_reward_max": -10119.50262254747, "episode_reward_min": -10497.83942215756, "episode_reward_mean": -10305.714119333576, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4284825596351456, "mean_inference_ms": 0.3714976265279006, "mean_action_processing_ms": 0.09125015610965359, "mean_env_wait_ms": 0.7399297678490016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003415822982788086, "StateBufferConnector_ms": 0.002588987350463867, "ViewRequirementAgentConnector_ms": 0.06612157821655273}}, "episode_reward_max": -10119.50262254747, "episode_reward_min": -10497.83942215756, "episode_reward_mean": -10305.714119333576, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10296.605207514232, -10394.907241544031, -10253.220243659955, -10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4284825596351456, "mean_inference_ms": 0.3714976265279006, "mean_action_processing_ms": 0.09125015610965359, "mean_env_wait_ms": 0.7399297678490016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003415822982788086, "StateBufferConnector_ms": 0.002588987350463867, "ViewRequirementAgentConnector_ms": 0.06612157821655273}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52114560, "num_agent_steps_trained": 52114560, "num_env_steps_sampled": 52114560, "num_env_steps_trained": 52114560, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 274.08398835398106, "num_env_steps_trained_throughput_per_sec": 274.08398835398106, "timesteps_total": 52114560, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52114560, "timers": {"training_iteration_time_ms": 4398.411, "sample_time_ms": 4365.733, "load_time_ms": 0.571, "load_throughput": 2100565.419, "learn_time_ms": 31.296, "learn_throughput": 38343.803, "synch_weights_time_ms": 0.762}, "counters": {"num_env_steps_sampled": 52114560, "num_env_steps_trained": 52114560, "num_agent_steps_sampled": 52114560, "num_agent_steps_trained": 52114560}, "done": false, "episodes_total": 12885, "training_iteration": 4051, "trial_id": "9f686_00000", "date": "2023-08-08_15-53-12", "timestamp": 1691499192, "time_this_iter_s": 13.137594938278198, "time_total_s": 95610.49695134163, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2526.323764562607, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 20.010526315789473, "ram_util_percent": 65.2421052631579}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -362.7189687093099, "policy_loss": -7281144.474392361, "vf_loss": 21537062.611111112}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10341.5, "diff_num_grad_updates_vs_sampler_policy": 10340.5}}, "num_env_steps_sampled": 52118160, "num_env_steps_trained": 52118160, "num_agent_steps_sampled": 52118160, "num_agent_steps_trained": 52118160}, "sampler_results": {"episode_reward_max": -10119.50262254747, "episode_reward_min": -10497.83942215756, "episode_reward_mean": -10304.45504455013, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428486743790685, "mean_inference_ms": 0.37149269505530674, "mean_action_processing_ms": 0.09124960407855572, "mean_env_wait_ms": 0.7398949514286448, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003423929214477539, "StateBufferConnector_ms": 0.002588033676147461, "ViewRequirementAgentConnector_ms": 0.06607460975646973}}, "episode_reward_max": -10119.50262254747, "episode_reward_min": -10497.83942215756, "episode_reward_mean": -10304.45504455013, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10319.227723158081, -10275.116513172792, -10387.496927626249, -10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428486743790685, "mean_inference_ms": 0.37149269505530674, "mean_action_processing_ms": 0.09124960407855572, "mean_env_wait_ms": 0.7398949514286448, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003423929214477539, "StateBufferConnector_ms": 0.002588033676147461, "ViewRequirementAgentConnector_ms": 0.06607460975646973}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52118160, "num_agent_steps_trained": 52118160, "num_env_steps_sampled": 52118160, "num_env_steps_trained": 52118160, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 273.2251042203202, "num_env_steps_trained_throughput_per_sec": 273.2251042203202, "timesteps_total": 52118160, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52118160, "timers": {"training_iteration_time_ms": 4397.664, "sample_time_ms": 4364.982, "load_time_ms": 0.574, "load_throughput": 2091661.389, "learn_time_ms": 31.287, "learn_throughput": 38354.497, "synch_weights_time_ms": 0.772}, "counters": {"num_env_steps_sampled": 52118160, "num_env_steps_trained": 52118160, "num_agent_steps_sampled": 52118160, "num_agent_steps_trained": 52118160}, "done": false, "episodes_total": 12888, "training_iteration": 4052, "trial_id": "9f686_00000", "date": "2023-08-08_15-53-25", "timestamp": 1691499205, "time_this_iter_s": 13.179074048995972, "time_total_s": 95623.67602539062, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2539.502838611603, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 19.742105263157892, "ram_util_percent": 65.07368421052631}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -362.2345954047309, "policy_loss": -4558932.664930556, "vf_loss": 21412467.638888888}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10395.5, "diff_num_grad_updates_vs_sampler_policy": 10394.5}}, "num_env_steps_sampled": 52121760, "num_env_steps_trained": 52121760, "num_agent_steps_sampled": 52121760, "num_agent_steps_trained": 52121760}, "sampler_results": {"episode_reward_max": -10119.50262254747, "episode_reward_min": -10497.83942215756, "episode_reward_mean": -10303.24881932193, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428489668556927, "mean_inference_ms": 0.3714877892597951, "mean_action_processing_ms": 0.09124904557072122, "mean_env_wait_ms": 0.7398594746474048, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034198760986328125, "StateBufferConnector_ms": 0.0025849342346191406, "ViewRequirementAgentConnector_ms": 0.0660858154296875}}, "episode_reward_max": -10119.50262254747, "episode_reward_min": -10497.83942215756, "episode_reward_mean": -10303.24881932193, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10234.07976787237, -10218.200888279822, -10261.468995597797, -10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428489668556927, "mean_inference_ms": 0.3714877892597951, "mean_action_processing_ms": 0.09124904557072122, "mean_env_wait_ms": 0.7398594746474048, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034198760986328125, "StateBufferConnector_ms": 0.0025849342346191406, "ViewRequirementAgentConnector_ms": 0.0660858154296875}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52121760, "num_agent_steps_trained": 52121760, "num_env_steps_sampled": 52121760, "num_env_steps_trained": 52121760, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 272.51889855507085, "num_env_steps_trained_throughput_per_sec": 272.51889855507085, "timesteps_total": 52121760, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52121760, "timers": {"training_iteration_time_ms": 4396.646, "sample_time_ms": 4363.837, "load_time_ms": 0.574, "load_throughput": 2090271.523, "learn_time_ms": 31.418, "learn_throughput": 38194.736, "synch_weights_time_ms": 0.767}, "counters": {"num_env_steps_sampled": 52121760, "num_env_steps_trained": 52121760, "num_agent_steps_sampled": 52121760, "num_agent_steps_trained": 52121760}, "done": false, "episodes_total": 12891, "training_iteration": 4053, "trial_id": "9f686_00000", "date": "2023-08-08_15-53-38", "timestamp": 1691499218, "time_this_iter_s": 13.213053226470947, "time_total_s": 95636.8890786171, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2552.7158918380737, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 21.172222222222224, "ram_util_percent": 65.26111111111112}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -364.463621351454, "policy_loss": -4519631.260416667, "vf_loss": 21383804.888888888}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10449.5, "diff_num_grad_updates_vs_sampler_policy": 10448.5}}, "num_env_steps_sampled": 52125360, "num_env_steps_trained": 52125360, "num_agent_steps_sampled": 52125360, "num_agent_steps_trained": 52125360}, "sampler_results": {"episode_reward_max": -10119.50262254747, "episode_reward_min": -10497.83942215756, "episode_reward_mean": -10304.585804325416, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4284874411795463, "mean_inference_ms": 0.3714833064023138, "mean_action_processing_ms": 0.09124853365681278, "mean_env_wait_ms": 0.7398252198731583, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003420591354370117, "StateBufferConnector_ms": 0.0025894641876220703, "ViewRequirementAgentConnector_ms": 0.066192626953125}}, "episode_reward_max": -10119.50262254747, "episode_reward_min": -10497.83942215756, "episode_reward_mean": -10304.585804325416, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10319.110655437838, -10364.793483388386, -10465.68563298721, -10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4284874411795463, "mean_inference_ms": 0.3714833064023138, "mean_action_processing_ms": 0.09124853365681278, "mean_env_wait_ms": 0.7398252198731583, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003420591354370117, "StateBufferConnector_ms": 0.0025894641876220703, "ViewRequirementAgentConnector_ms": 0.066192626953125}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52125360, "num_agent_steps_trained": 52125360, "num_env_steps_sampled": 52125360, "num_env_steps_trained": 52125360, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 272.81624961000426, "num_env_steps_trained_throughput_per_sec": 272.81624961000426, "timesteps_total": 52125360, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52125360, "timers": {"training_iteration_time_ms": 4387.967, "sample_time_ms": 4354.792, "load_time_ms": 0.575, "load_throughput": 2088103.551, "learn_time_ms": 31.764, "learn_throughput": 37778.978, "synch_weights_time_ms": 0.786}, "counters": {"num_env_steps_sampled": 52125360, "num_env_steps_trained": 52125360, "num_agent_steps_sampled": 52125360, "num_agent_steps_trained": 52125360}, "done": false, "episodes_total": 12894, "training_iteration": 4054, "trial_id": "9f686_00000", "date": "2023-08-08_15-53-52", "timestamp": 1691499232, "time_this_iter_s": 13.198681116104126, "time_total_s": 95650.0877597332, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2565.914572954178, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 19.710526315789476, "ram_util_percent": 65.47368421052633}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -363.81590270996094, "policy_loss": -7018838.558159722, "vf_loss": 21297424.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10503.5, "diff_num_grad_updates_vs_sampler_policy": 10502.5}}, "num_env_steps_sampled": 52128960, "num_env_steps_trained": 52128960, "num_agent_steps_sampled": 52128960, "num_agent_steps_trained": 52128960}, "sampler_results": {"episode_reward_max": -10119.50262254747, "episode_reward_min": -10497.83942215756, "episode_reward_mean": -10301.449400764513, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4284868562233832, "mean_inference_ms": 0.3714787401352304, "mean_action_processing_ms": 0.09124803721555935, "mean_env_wait_ms": 0.7397892098943154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003409862518310547, "StateBufferConnector_ms": 0.0025904178619384766, "ViewRequirementAgentConnector_ms": 0.06615161895751953}}, "episode_reward_max": -10119.50262254747, "episode_reward_min": -10497.83942215756, "episode_reward_mean": -10301.449400764513, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10353.356611778327, -10298.053603714625, -10378.893095539293, -10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4284868562233832, "mean_inference_ms": 0.3714787401352304, "mean_action_processing_ms": 0.09124803721555935, "mean_env_wait_ms": 0.7397892098943154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003409862518310547, "StateBufferConnector_ms": 0.0025904178619384766, "ViewRequirementAgentConnector_ms": 0.06615161895751953}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52128960, "num_agent_steps_trained": 52128960, "num_env_steps_sampled": 52128960, "num_env_steps_trained": 52128960, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 270.5409136060477, "num_env_steps_trained_throughput_per_sec": 270.5409136060477, "timesteps_total": 52128960, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52128960, "timers": {"training_iteration_time_ms": 4411.271, "sample_time_ms": 4378.264, "load_time_ms": 0.573, "load_throughput": 2095580.315, "learn_time_ms": 31.621, "learn_throughput": 37949.203, "synch_weights_time_ms": 0.763}, "counters": {"num_env_steps_sampled": 52128960, "num_env_steps_trained": 52128960, "num_agent_steps_sampled": 52128960, "num_agent_steps_trained": 52128960}, "done": false, "episodes_total": 12897, "training_iteration": 4055, "trial_id": "9f686_00000", "date": "2023-08-08_15-54-05", "timestamp": 1691499245, "time_this_iter_s": 13.30955696105957, "time_total_s": 95663.39731669426, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2579.2241299152374, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 19.094736842105263, "ram_util_percent": 65.44210526315788}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -362.88018798828125, "policy_loss": -10167318.775173612, "vf_loss": 21611850.972222224}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10557.5, "diff_num_grad_updates_vs_sampler_policy": 10556.5}}, "num_env_steps_sampled": 52132560, "num_env_steps_trained": 52132560, "num_agent_steps_sampled": 52132560, "num_agent_steps_trained": 52132560}, "sampler_results": {"episode_reward_max": -10119.50262254747, "episode_reward_min": -10497.83942215756, "episode_reward_mean": -10300.858274812323, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.42848241704184, "mean_inference_ms": 0.37147399771370615, "mean_action_processing_ms": 0.09124749984382072, "mean_env_wait_ms": 0.7397528816808762, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003411531448364258, "StateBufferConnector_ms": 0.002599954605102539, "ViewRequirementAgentConnector_ms": 0.06624507904052734}}, "episode_reward_max": -10119.50262254747, "episode_reward_min": -10497.83942215756, "episode_reward_mean": -10300.858274812323, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10340.464855158712, -10355.286797274652, -10307.47969449215, -10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.42848241704184, "mean_inference_ms": 0.37147399771370615, "mean_action_processing_ms": 0.09124749984382072, "mean_env_wait_ms": 0.7397528816808762, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003411531448364258, "StateBufferConnector_ms": 0.002599954605102539, "ViewRequirementAgentConnector_ms": 0.06624507904052734}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52132560, "num_agent_steps_trained": 52132560, "num_env_steps_sampled": 52132560, "num_env_steps_trained": 52132560, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 272.059942541899, "num_env_steps_trained_throughput_per_sec": 272.059942541899, "timesteps_total": 52132560, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52132560, "timers": {"training_iteration_time_ms": 4412.99, "sample_time_ms": 4379.813, "load_time_ms": 0.578, "load_throughput": 2075703.068, "learn_time_ms": 31.767, "learn_throughput": 37774.527, "synch_weights_time_ms": 0.781}, "counters": {"num_env_steps_sampled": 52132560, "num_env_steps_trained": 52132560, "num_agent_steps_sampled": 52132560, "num_agent_steps_trained": 52132560}, "done": false, "episodes_total": 12900, "training_iteration": 4056, "trial_id": "9f686_00000", "date": "2023-08-08_15-54-18", "timestamp": 1691499258, "time_this_iter_s": 13.235323190689087, "time_total_s": 95676.63263988495, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2592.4594531059265, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 19.95263157894737, "ram_util_percent": 65.38947368421054}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -362.62423366970484, "policy_loss": -5589758.404947917, "vf_loss": 21002486.972222224}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10611.5, "diff_num_grad_updates_vs_sampler_policy": 10610.5}}, "num_env_steps_sampled": 52136160, "num_env_steps_trained": 52136160, "num_agent_steps_sampled": 52136160, "num_agent_steps_trained": 52136160}, "sampler_results": {"episode_reward_max": -10119.50262254747, "episode_reward_min": -10497.83942215756, "episode_reward_mean": -10297.056862656189, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4284799526701004, "mean_inference_ms": 0.3714691059752199, "mean_action_processing_ms": 0.0912469534316224, "mean_env_wait_ms": 0.7397135298885612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034134387969970703, "StateBufferConnector_ms": 0.0025963783264160156, "ViewRequirementAgentConnector_ms": 0.0662529468536377}}, "episode_reward_max": -10119.50262254747, "episode_reward_min": -10497.83942215756, "episode_reward_mean": -10297.056862656189, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10285.906742689343, -10264.178006439288, -10246.712448130462, -10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4284799526701004, "mean_inference_ms": 0.3714691059752199, "mean_action_processing_ms": 0.0912469534316224, "mean_env_wait_ms": 0.7397135298885612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034134387969970703, "StateBufferConnector_ms": 0.0025963783264160156, "ViewRequirementAgentConnector_ms": 0.0662529468536377}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52136160, "num_agent_steps_trained": 52136160, "num_env_steps_sampled": 52136160, "num_env_steps_trained": 52136160, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 273.45543171030533, "num_env_steps_trained_throughput_per_sec": 273.45543171030533, "timesteps_total": 52136160, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52136160, "timers": {"training_iteration_time_ms": 4409.674, "sample_time_ms": 4376.817, "load_time_ms": 0.579, "load_throughput": 2073992.418, "learn_time_ms": 31.463, "learn_throughput": 38139.542, "synch_weights_time_ms": 0.765}, "counters": {"num_env_steps_sampled": 52136160, "num_env_steps_trained": 52136160, "num_agent_steps_sampled": 52136160, "num_agent_steps_trained": 52136160}, "done": false, "episodes_total": 12903, "training_iteration": 4057, "trial_id": "9f686_00000", "date": "2023-08-08_15-54-31", "timestamp": 1691499271, "time_this_iter_s": 13.16837191581726, "time_total_s": 95689.80101180077, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2605.627825021744, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 19.23333333333333, "ram_util_percent": 65.25}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -361.85483805338544, "policy_loss": -7145296.341145833, "vf_loss": 21806375.722222224}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10665.5, "diff_num_grad_updates_vs_sampler_policy": 10664.5}}, "num_env_steps_sampled": 52139760, "num_env_steps_trained": 52139760, "num_agent_steps_sampled": 52139760, "num_agent_steps_trained": 52139760}, "sampler_results": {"episode_reward_max": -10119.50262254747, "episode_reward_min": -10497.83942215756, "episode_reward_mean": -10299.841304884314, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428486159805179, "mean_inference_ms": 0.3714640133161891, "mean_action_processing_ms": 0.09124640553220621, "mean_env_wait_ms": 0.7396790487419048, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003413677215576172, "StateBufferConnector_ms": 0.0025992393493652344, "ViewRequirementAgentConnector_ms": 0.06632804870605469}}, "episode_reward_max": -10119.50262254747, "episode_reward_min": -10497.83942215756, "episode_reward_mean": -10299.841304884314, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10277.800263105057, -10384.777951115293, -10349.366237247388, -10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428486159805179, "mean_inference_ms": 0.3714640133161891, "mean_action_processing_ms": 0.09124640553220621, "mean_env_wait_ms": 0.7396790487419048, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003413677215576172, "StateBufferConnector_ms": 0.0025992393493652344, "ViewRequirementAgentConnector_ms": 0.06632804870605469}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52139760, "num_agent_steps_trained": 52139760, "num_env_steps_sampled": 52139760, "num_env_steps_trained": 52139760, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 268.443759860305, "num_env_steps_trained_throughput_per_sec": 268.443759860305, "timesteps_total": 52139760, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52139760, "timers": {"training_iteration_time_ms": 4427.791, "sample_time_ms": 4395.034, "load_time_ms": 0.581, "load_throughput": 2066753.501, "learn_time_ms": 31.361, "learn_throughput": 38264.106, "synch_weights_time_ms": 0.767}, "counters": {"num_env_steps_sampled": 52139760, "num_env_steps_trained": 52139760, "num_agent_steps_sampled": 52139760, "num_agent_steps_trained": 52139760}, "done": false, "episodes_total": 12906, "training_iteration": 4058, "trial_id": "9f686_00000", "date": "2023-08-08_15-54-45", "timestamp": 1691499285, "time_this_iter_s": 13.413522005081177, "time_total_s": 95703.21453380585, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2619.041347026825, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 18.710526315789476, "ram_util_percent": 65.1842105263158}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -364.428465101454, "policy_loss": -10070938.286892362, "vf_loss": 21846292.833333332}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10719.5, "diff_num_grad_updates_vs_sampler_policy": 10718.5}}, "num_env_steps_sampled": 52143360, "num_env_steps_trained": 52143360, "num_agent_steps_sampled": 52143360, "num_agent_steps_trained": 52143360}, "sampler_results": {"episode_reward_max": -10119.50262254747, "episode_reward_min": -10497.83942215756, "episode_reward_mean": -10297.353353080884, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.42849313426762, "mean_inference_ms": 0.37145886743278844, "mean_action_processing_ms": 0.09124585019211275, "mean_env_wait_ms": 0.7396422110749044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003417491912841797, "StateBufferConnector_ms": 0.002600431442260742, "ViewRequirementAgentConnector_ms": 0.06631350517272949}}, "episode_reward_max": -10119.50262254747, "episode_reward_min": -10497.83942215756, "episode_reward_mean": -10297.353353080884, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10306.541045864189, -10466.01553139352, -10280.181765191574, -10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.42849313426762, "mean_inference_ms": 0.37145886743278844, "mean_action_processing_ms": 0.09124585019211275, "mean_env_wait_ms": 0.7396422110749044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003417491912841797, "StateBufferConnector_ms": 0.002600431442260742, "ViewRequirementAgentConnector_ms": 0.06631350517272949}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52143360, "num_agent_steps_trained": 52143360, "num_env_steps_sampled": 52143360, "num_env_steps_trained": 52143360, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 274.29869421274867, "num_env_steps_trained_throughput_per_sec": 274.29869421274867, "timesteps_total": 52143360, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52143360, "timers": {"training_iteration_time_ms": 4405.896, "sample_time_ms": 4373.455, "load_time_ms": 0.589, "load_throughput": 2037223.67, "learn_time_ms": 31.054, "learn_throughput": 38642.844, "synch_weights_time_ms": 0.751}, "counters": {"num_env_steps_sampled": 52143360, "num_env_steps_trained": 52143360, "num_agent_steps_sampled": 52143360, "num_agent_steps_trained": 52143360}, "done": false, "episodes_total": 12909, "training_iteration": 4059, "trial_id": "9f686_00000", "date": "2023-08-08_15-54-58", "timestamp": 1691499298, "time_this_iter_s": 13.127256155014038, "time_total_s": 95716.34178996086, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2632.168603181839, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 19.310526315789474, "ram_util_percent": 65.19473684210526}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -365.018068101671, "policy_loss": -6517464.047743056, "vf_loss": 21727108.083333332}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10773.5, "diff_num_grad_updates_vs_sampler_policy": 10772.5}}, "num_env_steps_sampled": 52146960, "num_env_steps_trained": 52146960, "num_agent_steps_sampled": 52146960, "num_agent_steps_trained": 52146960}, "sampler_results": {"episode_reward_max": -10119.50262254747, "episode_reward_min": -10497.83942215756, "episode_reward_mean": -10296.047608416176, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428501832998309, "mean_inference_ms": 0.3714535599059405, "mean_action_processing_ms": 0.09124522518255042, "mean_env_wait_ms": 0.7396032698247255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034198760986328125, "StateBufferConnector_ms": 0.0025916099548339844, "ViewRequirementAgentConnector_ms": 0.06632280349731445}}, "episode_reward_max": -10119.50262254747, "episode_reward_min": -10497.83942215756, "episode_reward_mean": -10296.047608416176, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10251.040881004878, -10298.183667043584, -10369.65312421011, -10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428501832998309, "mean_inference_ms": 0.3714535599059405, "mean_action_processing_ms": 0.09124522518255042, "mean_env_wait_ms": 0.7396032698247255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034198760986328125, "StateBufferConnector_ms": 0.0025916099548339844, "ViewRequirementAgentConnector_ms": 0.06632280349731445}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52146960, "num_agent_steps_trained": 52146960, "num_env_steps_sampled": 52146960, "num_env_steps_trained": 52146960, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 273.17663192002874, "num_env_steps_trained_throughput_per_sec": 273.17663192002874, "timesteps_total": 52146960, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52146960, "timers": {"training_iteration_time_ms": 4405.183, "sample_time_ms": 4372.467, "load_time_ms": 0.585, "load_throughput": 2051255.166, "learn_time_ms": 31.336, "learn_throughput": 38294.558, "synch_weights_time_ms": 0.746}, "counters": {"num_env_steps_sampled": 52146960, "num_env_steps_trained": 52146960, "num_agent_steps_sampled": 52146960, "num_agent_steps_trained": 52146960}, "done": false, "episodes_total": 12912, "training_iteration": 4060, "trial_id": "9f686_00000", "date": "2023-08-08_15-55-11", "timestamp": 1691499311, "time_this_iter_s": 13.181174993515015, "time_total_s": 95729.52296495438, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2645.349778175354, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 18.694736842105264, "ram_util_percent": 65.23157894736842}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -361.5932854546441, "policy_loss": -10490918.528645834, "vf_loss": 21926014.222222224}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10827.5, "diff_num_grad_updates_vs_sampler_policy": 10826.5}}, "num_env_steps_sampled": 52150560, "num_env_steps_trained": 52150560, "num_agent_steps_sampled": 52150560, "num_agent_steps_trained": 52150560}, "sampler_results": {"episode_reward_max": -10119.50262254747, "episode_reward_min": -10497.83942215756, "episode_reward_mean": -10296.716364700984, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4285087972469857, "mean_inference_ms": 0.37144833838139035, "mean_action_processing_ms": 0.09124460360088436, "mean_env_wait_ms": 0.7395631320575197, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034193992614746094, "StateBufferConnector_ms": 0.002594470977783203, "ViewRequirementAgentConnector_ms": 0.06634831428527832}}, "episode_reward_max": -10119.50262254747, "episode_reward_min": -10497.83942215756, "episode_reward_mean": -10296.716364700984, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10252.496078743514, -10318.858942061666, -10383.660100679637, -10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4285087972469857, "mean_inference_ms": 0.37144833838139035, "mean_action_processing_ms": 0.09124460360088436, "mean_env_wait_ms": 0.7395631320575197, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034193992614746094, "StateBufferConnector_ms": 0.002594470977783203, "ViewRequirementAgentConnector_ms": 0.06634831428527832}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52150560, "num_agent_steps_trained": 52150560, "num_env_steps_sampled": 52150560, "num_env_steps_trained": 52150560, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 272.58701684138697, "num_env_steps_trained_throughput_per_sec": 272.58701684138697, "timesteps_total": 52150560, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52150560, "timers": {"training_iteration_time_ms": 4397.524, "sample_time_ms": 4364.795, "load_time_ms": 0.587, "load_throughput": 2045669.322, "learn_time_ms": 31.336, "learn_throughput": 38294.733, "synch_weights_time_ms": 0.758}, "counters": {"num_env_steps_sampled": 52150560, "num_env_steps_trained": 52150560, "num_agent_steps_sampled": 52150560, "num_agent_steps_trained": 52150560}, "done": false, "episodes_total": 12915, "training_iteration": 4061, "trial_id": "9f686_00000", "date": "2023-08-08_15-55-24", "timestamp": 1691499324, "time_this_iter_s": 13.209614753723145, "time_total_s": 95742.7325797081, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2658.559392929077, "iterations_since_restore": 201, "perf": {"cpu_util_percent": 20.226315789473684, "ram_util_percent": 65.17894736842105}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -363.47488572862414, "policy_loss": -3053791.4270833335, "vf_loss": 21270485.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10881.5, "diff_num_grad_updates_vs_sampler_policy": 10880.5}}, "num_env_steps_sampled": 52154160, "num_env_steps_trained": 52154160, "num_agent_steps_sampled": 52154160, "num_agent_steps_trained": 52154160}, "sampler_results": {"episode_reward_max": -10119.50262254747, "episode_reward_min": -10497.83942215756, "episode_reward_mean": -10296.743020829514, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4285067263571603, "mean_inference_ms": 0.37144319654331115, "mean_action_processing_ms": 0.09124396289175313, "mean_env_wait_ms": 0.739522834233209, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003419160842895508, "StateBufferConnector_ms": 0.002597332000732422, "ViewRequirementAgentConnector_ms": 0.06636834144592285}}, "episode_reward_max": -10119.50262254747, "episode_reward_min": -10497.83942215756, "episode_reward_mean": -10296.743020829514, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10266.148393759844, -10437.273063807706, -10182.898318138665, -10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4285067263571603, "mean_inference_ms": 0.37144319654331115, "mean_action_processing_ms": 0.09124396289175313, "mean_env_wait_ms": 0.739522834233209, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003419160842895508, "StateBufferConnector_ms": 0.002597332000732422, "ViewRequirementAgentConnector_ms": 0.06636834144592285}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52154160, "num_agent_steps_trained": 52154160, "num_env_steps_sampled": 52154160, "num_env_steps_trained": 52154160, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 275.7289197406403, "num_env_steps_trained_throughput_per_sec": 275.7289197406403, "timesteps_total": 52154160, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52154160, "timers": {"training_iteration_time_ms": 4388.654, "sample_time_ms": 4355.73, "load_time_ms": 0.587, "load_throughput": 2043178.047, "learn_time_ms": 31.535, "learn_throughput": 38052.49, "synch_weights_time_ms": 0.752}, "counters": {"num_env_steps_sampled": 52154160, "num_env_steps_trained": 52154160, "num_agent_steps_sampled": 52154160, "num_agent_steps_trained": 52154160}, "done": false, "episodes_total": 12918, "training_iteration": 4062, "trial_id": "9f686_00000", "date": "2023-08-08_15-55-37", "timestamp": 1691499337, "time_this_iter_s": 13.059307098388672, "time_total_s": 95755.79188680649, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2671.618700027466, "iterations_since_restore": 202, "perf": {"cpu_util_percent": 21.54444444444444, "ram_util_percent": 65.33888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -361.98414611816406, "policy_loss": -11766056.288194444, "vf_loss": 21680910.222222224}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10935.5, "diff_num_grad_updates_vs_sampler_policy": 10934.5}}, "num_env_steps_sampled": 52157760, "num_env_steps_trained": 52157760, "num_agent_steps_sampled": 52157760, "num_agent_steps_trained": 52157760}, "sampler_results": {"episode_reward_max": -10119.50262254747, "episode_reward_min": -10497.83942215756, "episode_reward_mean": -10297.181400457246, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428505175162462, "mean_inference_ms": 0.3714385271818538, "mean_action_processing_ms": 0.09124337260589216, "mean_env_wait_ms": 0.7394811842841511, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034503936767578125, "StateBufferConnector_ms": 0.0026061534881591797, "ViewRequirementAgentConnector_ms": 0.06636571884155273}}, "episode_reward_max": -10119.50262254747, "episode_reward_min": -10497.83942215756, "episode_reward_mean": -10297.181400457246, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10400.330020349504, -10349.246821258233, -10402.044890631496, -10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428505175162462, "mean_inference_ms": 0.3714385271818538, "mean_action_processing_ms": 0.09124337260589216, "mean_env_wait_ms": 0.7394811842841511, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034503936767578125, "StateBufferConnector_ms": 0.0026061534881591797, "ViewRequirementAgentConnector_ms": 0.06636571884155273}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52157760, "num_agent_steps_trained": 52157760, "num_env_steps_sampled": 52157760, "num_env_steps_trained": 52157760, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 270.9766631031743, "num_env_steps_trained_throughput_per_sec": 270.9766631031743, "timesteps_total": 52157760, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52157760, "timers": {"training_iteration_time_ms": 4396.783, "sample_time_ms": 4363.895, "load_time_ms": 0.586, "load_throughput": 2049501.099, "learn_time_ms": 31.479, "learn_throughput": 38120.16, "synch_weights_time_ms": 0.774}, "counters": {"num_env_steps_sampled": 52157760, "num_env_steps_trained": 52157760, "num_agent_steps_sampled": 52157760, "num_agent_steps_trained": 52157760}, "done": false, "episodes_total": 12921, "training_iteration": 4063, "trial_id": "9f686_00000", "date": "2023-08-08_15-55-51", "timestamp": 1691499351, "time_this_iter_s": 13.28812313079834, "time_total_s": 95769.08000993729, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2684.906823158264, "iterations_since_restore": 203, "perf": {"cpu_util_percent": 19.50526315789474, "ram_util_percent": 65.44736842105263}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -361.49271477593317, "policy_loss": -5504608.059461806, "vf_loss": 21418957.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10989.5, "diff_num_grad_updates_vs_sampler_policy": 10988.5}}, "num_env_steps_sampled": 52161360, "num_env_steps_trained": 52161360, "num_agent_steps_sampled": 52161360, "num_agent_steps_trained": 52161360}, "sampler_results": {"episode_reward_max": -10119.50262254747, "episode_reward_min": -10497.83942215756, "episode_reward_mean": -10294.049951142013, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4285032631404944, "mean_inference_ms": 0.37143377359785373, "mean_action_processing_ms": 0.09124281998250167, "mean_env_wait_ms": 0.7394383743421645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003449678421020508, "StateBufferConnector_ms": 0.002608060836791992, "ViewRequirementAgentConnector_ms": 0.06634831428527832}}, "episode_reward_max": -10119.50262254747, "episode_reward_min": -10497.83942215756, "episode_reward_mean": -10294.049951142013, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10211.191166815213, -10318.066658551703, -10304.904321503893, -10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4285032631404944, "mean_inference_ms": 0.37143377359785373, "mean_action_processing_ms": 0.09124281998250167, "mean_env_wait_ms": 0.7394383743421645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003449678421020508, "StateBufferConnector_ms": 0.002608060836791992, "ViewRequirementAgentConnector_ms": 0.06634831428527832}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52161360, "num_agent_steps_trained": 52161360, "num_env_steps_sampled": 52161360, "num_env_steps_trained": 52161360, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 271.195897570298, "num_env_steps_trained_throughput_per_sec": 271.195897570298, "timesteps_total": 52161360, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52161360, "timers": {"training_iteration_time_ms": 4406.459, "sample_time_ms": 4373.834, "load_time_ms": 0.585, "load_throughput": 2052761.042, "learn_time_ms": 31.229, "learn_throughput": 38425.271, "synch_weights_time_ms": 0.761}, "counters": {"num_env_steps_sampled": 52161360, "num_env_steps_trained": 52161360, "num_agent_steps_sampled": 52161360, "num_agent_steps_trained": 52161360}, "done": false, "episodes_total": 12924, "training_iteration": 4064, "trial_id": "9f686_00000", "date": "2023-08-08_15-56-04", "timestamp": 1691499364, "time_this_iter_s": 13.27743411064148, "time_total_s": 95782.35744404793, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2698.1842572689056, "iterations_since_restore": 204, "perf": {"cpu_util_percent": 19.147368421052633, "ram_util_percent": 65.43157894736841}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -361.9192301432292, "policy_loss": -7006631.109375, "vf_loss": 21545980.944444444}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11043.5, "diff_num_grad_updates_vs_sampler_policy": 11042.5}}, "num_env_steps_sampled": 52164960, "num_env_steps_trained": 52164960, "num_agent_steps_sampled": 52164960, "num_agent_steps_trained": 52164960}, "sampler_results": {"episode_reward_max": -10119.50262254747, "episode_reward_min": -10497.83942215756, "episode_reward_mean": -10294.037465985788, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4284988981834816, "mean_inference_ms": 0.3714285958415033, "mean_action_processing_ms": 0.0912422785934183, "mean_env_wait_ms": 0.7393952917583279, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034537315368652344, "StateBufferConnector_ms": 0.0026051998138427734, "ViewRequirementAgentConnector_ms": 0.06621527671813965}}, "episode_reward_max": -10119.50262254747, "episode_reward_min": -10497.83942215756, "episode_reward_mean": -10294.037465985788, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10348.886303050727, -10142.512142323763, -10140.323516032824, -10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4284988981834816, "mean_inference_ms": 0.3714285958415033, "mean_action_processing_ms": 0.0912422785934183, "mean_env_wait_ms": 0.7393952917583279, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034537315368652344, "StateBufferConnector_ms": 0.0026051998138427734, "ViewRequirementAgentConnector_ms": 0.06621527671813965}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52164960, "num_agent_steps_trained": 52164960, "num_env_steps_sampled": 52164960, "num_env_steps_trained": 52164960, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 273.6406360164998, "num_env_steps_trained_throughput_per_sec": 273.6406360164998, "timesteps_total": 52164960, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52164960, "timers": {"training_iteration_time_ms": 4403.404, "sample_time_ms": 4370.877, "load_time_ms": 0.583, "load_throughput": 2058722.513, "learn_time_ms": 31.129, "learn_throughput": 38549.378, "synch_weights_time_ms": 0.765}, "counters": {"num_env_steps_sampled": 52164960, "num_env_steps_trained": 52164960, "num_agent_steps_sampled": 52164960, "num_agent_steps_trained": 52164960}, "done": false, "episodes_total": 12927, "training_iteration": 4065, "trial_id": "9f686_00000", "date": "2023-08-08_15-56-17", "timestamp": 1691499377, "time_this_iter_s": 13.158730030059814, "time_total_s": 95795.51617407799, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2711.3429872989655, "iterations_since_restore": 205, "perf": {"cpu_util_percent": 19.427777777777777, "ram_util_percent": 65.32222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -361.6327904595269, "policy_loss": -9710874.686631944, "vf_loss": 21443436.583333332}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11097.5, "diff_num_grad_updates_vs_sampler_policy": 11096.5}}, "num_env_steps_sampled": 52168560, "num_env_steps_trained": 52168560, "num_agent_steps_sampled": 52168560, "num_agent_steps_trained": 52168560}, "sampler_results": {"episode_reward_max": -10119.50262254747, "episode_reward_min": -10497.83942215756, "episode_reward_mean": -10296.675929467114, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428495422789958, "mean_inference_ms": 0.371423493479187, "mean_action_processing_ms": 0.0912417253350962, "mean_env_wait_ms": 0.7393572353489176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034570693969726562, "StateBufferConnector_ms": 0.0026111602783203125, "ViewRequirementAgentConnector_ms": 0.06625652313232422}}, "episode_reward_max": -10119.50262254747, "episode_reward_min": -10497.83942215756, "episode_reward_mean": -10296.675929467114, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10281.126703364815, -10142.354127685881, -10305.401128993552, -10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428495422789958, "mean_inference_ms": 0.371423493479187, "mean_action_processing_ms": 0.0912417253350962, "mean_env_wait_ms": 0.7393572353489176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034570693969726562, "StateBufferConnector_ms": 0.0026111602783203125, "ViewRequirementAgentConnector_ms": 0.06625652313232422}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52168560, "num_agent_steps_trained": 52168560, "num_env_steps_sampled": 52168560, "num_env_steps_trained": 52168560, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 271.14820095764134, "num_env_steps_trained_throughput_per_sec": 271.14820095764134, "timesteps_total": 52168560, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52168560, "timers": {"training_iteration_time_ms": 4413.36, "sample_time_ms": 4380.609, "load_time_ms": 0.574, "load_throughput": 2090531.982, "learn_time_ms": 31.368, "learn_throughput": 38255.09, "synch_weights_time_ms": 0.76}, "counters": {"num_env_steps_sampled": 52168560, "num_env_steps_trained": 52168560, "num_agent_steps_sampled": 52168560, "num_agent_steps_trained": 52168560}, "done": false, "episodes_total": 12930, "training_iteration": 4066, "trial_id": "9f686_00000", "date": "2023-08-08_15-56-31", "timestamp": 1691499391, "time_this_iter_s": 13.279720306396484, "time_total_s": 95808.79589438438, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2724.622707605362, "iterations_since_restore": 206, "perf": {"cpu_util_percent": 19.43157894736842, "ram_util_percent": 65.18947368421054}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -362.40611267089844, "policy_loss": -7894864.704427083, "vf_loss": 21308710.555555556}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11151.5, "diff_num_grad_updates_vs_sampler_policy": 11150.5}}, "num_env_steps_sampled": 52172160, "num_env_steps_trained": 52172160, "num_agent_steps_sampled": 52172160, "num_agent_steps_trained": 52172160}, "sampler_results": {"episode_reward_max": -10119.50262254747, "episode_reward_min": -10497.83942215756, "episode_reward_mean": -10296.069004956975, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4284917193941107, "mean_inference_ms": 0.3714184457976735, "mean_action_processing_ms": 0.09124119142747882, "mean_env_wait_ms": 0.7393195413398733, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003458261489868164, "StateBufferConnector_ms": 0.0026025772094726562, "ViewRequirementAgentConnector_ms": 0.06623244285583496}}, "episode_reward_max": -10119.50262254747, "episode_reward_min": -10497.83942215756, "episode_reward_mean": -10296.069004956975, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10301.148893495028, -10250.342486480517, -10338.028078775926, -10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4284917193941107, "mean_inference_ms": 0.3714184457976735, "mean_action_processing_ms": 0.09124119142747882, "mean_env_wait_ms": 0.7393195413398733, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003458261489868164, "StateBufferConnector_ms": 0.0026025772094726562, "ViewRequirementAgentConnector_ms": 0.06623244285583496}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52172160, "num_agent_steps_trained": 52172160, "num_env_steps_sampled": 52172160, "num_env_steps_trained": 52172160, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 273.8524721118619, "num_env_steps_trained_throughput_per_sec": 273.8524721118619, "timesteps_total": 52172160, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52172160, "timers": {"training_iteration_time_ms": 4400.017, "sample_time_ms": 4367.129, "load_time_ms": 0.581, "load_throughput": 2064634.014, "learn_time_ms": 31.505, "learn_throughput": 38089.581, "synch_weights_time_ms": 0.754}, "counters": {"num_env_steps_sampled": 52172160, "num_env_steps_trained": 52172160, "num_agent_steps_sampled": 52172160, "num_agent_steps_trained": 52172160}, "done": false, "episodes_total": 12933, "training_iteration": 4067, "trial_id": "9f686_00000", "date": "2023-08-08_15-56-44", "timestamp": 1691499404, "time_this_iter_s": 13.148580074310303, "time_total_s": 95821.9444744587, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2737.7712876796722, "iterations_since_restore": 207, "perf": {"cpu_util_percent": 18.88947368421053, "ram_util_percent": 65.23684210526316}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -362.1731245252821, "policy_loss": -9339554.970486112, "vf_loss": 21977163.916666668}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11205.5, "diff_num_grad_updates_vs_sampler_policy": 11204.5}}, "num_env_steps_sampled": 52175760, "num_env_steps_trained": 52175760, "num_agent_steps_sampled": 52175760, "num_agent_steps_trained": 52175760}, "sampler_results": {"episode_reward_max": -10119.50262254747, "episode_reward_min": -10497.83942215756, "episode_reward_mean": -10296.114994137728, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4284822305433256, "mean_inference_ms": 0.37141346788814145, "mean_action_processing_ms": 0.09124070753651267, "mean_env_wait_ms": 0.7392825119988373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034568309783935547, "StateBufferConnector_ms": 0.002605915069580078, "ViewRequirementAgentConnector_ms": 0.06615638732910156}}, "episode_reward_max": -10119.50262254747, "episode_reward_min": -10497.83942215756, "episode_reward_mean": -10296.114994137728, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10331.284638241117, -10198.761811874932, -10387.852074527536, -10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4284822305433256, "mean_inference_ms": 0.37141346788814145, "mean_action_processing_ms": 0.09124070753651267, "mean_env_wait_ms": 0.7392825119988373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034568309783935547, "StateBufferConnector_ms": 0.002605915069580078, "ViewRequirementAgentConnector_ms": 0.06615638732910156}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52175760, "num_agent_steps_trained": 52175760, "num_env_steps_sampled": 52175760, "num_env_steps_trained": 52175760, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 274.5905159115711, "num_env_steps_trained_throughput_per_sec": 274.5905159115711, "timesteps_total": 52175760, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52175760, "timers": {"training_iteration_time_ms": 4394.944, "sample_time_ms": 4361.938, "load_time_ms": 0.579, "load_throughput": 2073821.508, "learn_time_ms": 31.611, "learn_throughput": 37960.938, "synch_weights_time_ms": 0.768}, "counters": {"num_env_steps_sampled": 52175760, "num_env_steps_trained": 52175760, "num_agent_steps_sampled": 52175760, "num_agent_steps_trained": 52175760}, "done": false, "episodes_total": 12936, "training_iteration": 4068, "trial_id": "9f686_00000", "date": "2023-08-08_15-56-57", "timestamp": 1691499417, "time_this_iter_s": 13.113219976425171, "time_total_s": 95835.05769443512, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2750.8845076560974, "iterations_since_restore": 208, "perf": {"cpu_util_percent": 19.644444444444446, "ram_util_percent": 65.1111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -362.3085530598958, "policy_loss": -6559323.162326389, "vf_loss": 21707335.666666668}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11259.5, "diff_num_grad_updates_vs_sampler_policy": 11258.5}}, "num_env_steps_sampled": 52179360, "num_env_steps_trained": 52179360, "num_agent_steps_sampled": 52179360, "num_agent_steps_trained": 52179360}, "sampler_results": {"episode_reward_max": -10119.50262254747, "episode_reward_min": -10497.83942215756, "episode_reward_mean": -10296.20597901626, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4284762502525914, "mean_inference_ms": 0.37140881358241346, "mean_action_processing_ms": 0.09124028003421998, "mean_env_wait_ms": 0.7392474242075024, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003452777862548828, "StateBufferConnector_ms": 0.0026040077209472656, "ViewRequirementAgentConnector_ms": 0.0662088394165039}}, "episode_reward_max": -10119.50262254747, "episode_reward_min": -10497.83942215756, "episode_reward_mean": -10296.20597901626, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10283.82623081288, -10212.510555435954, -10231.489582403015, -10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4284762502525914, "mean_inference_ms": 0.37140881358241346, "mean_action_processing_ms": 0.09124028003421998, "mean_env_wait_ms": 0.7392474242075024, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003452777862548828, "StateBufferConnector_ms": 0.0026040077209472656, "ViewRequirementAgentConnector_ms": 0.0662088394165039}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52179360, "num_agent_steps_trained": 52179360, "num_env_steps_sampled": 52179360, "num_env_steps_trained": 52179360, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 271.1966330690682, "num_env_steps_trained_throughput_per_sec": 271.1966330690682, "timesteps_total": 52179360, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52179360, "timers": {"training_iteration_time_ms": 4399.342, "sample_time_ms": 4366.434, "load_time_ms": 0.586, "load_throughput": 2049501.099, "learn_time_ms": 31.515, "learn_throughput": 38076.556, "synch_weights_time_ms": 0.759}, "counters": {"num_env_steps_sampled": 52179360, "num_env_steps_trained": 52179360, "num_agent_steps_sampled": 52179360, "num_agent_steps_trained": 52179360}, "done": false, "episodes_total": 12939, "training_iteration": 4069, "trial_id": "9f686_00000", "date": "2023-08-08_15-57-10", "timestamp": 1691499430, "time_this_iter_s": 13.27736520767212, "time_total_s": 95848.33505964279, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2764.1618728637695, "iterations_since_restore": 209, "perf": {"cpu_util_percent": 20.426315789473687, "ram_util_percent": 65.31578947368422}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -361.86212666829425, "policy_loss": -7082196.772569444, "vf_loss": 21438501.444444444}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11313.5, "diff_num_grad_updates_vs_sampler_policy": 11312.5}}, "num_env_steps_sampled": 52182960, "num_env_steps_trained": 52182960, "num_agent_steps_sampled": 52182960, "num_agent_steps_trained": 52182960}, "sampler_results": {"episode_reward_max": -10119.50262254747, "episode_reward_min": -10497.83942215756, "episode_reward_mean": -10296.790490857413, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4284688139996824, "mean_inference_ms": 0.371404068020492, "mean_action_processing_ms": 0.09123986143396037, "mean_env_wait_ms": 0.7392136194350714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003448486328125, "StateBufferConnector_ms": 0.002602100372314453, "ViewRequirementAgentConnector_ms": 0.06626367568969727}}, "episode_reward_max": -10119.50262254747, "episode_reward_min": -10497.83942215756, "episode_reward_mean": -10296.790490857413, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10234.01038637714, -10229.171231282395, -10282.55554834403, -10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4284688139996824, "mean_inference_ms": 0.371404068020492, "mean_action_processing_ms": 0.09123986143396037, "mean_env_wait_ms": 0.7392136194350714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003448486328125, "StateBufferConnector_ms": 0.002602100372314453, "ViewRequirementAgentConnector_ms": 0.06626367568969727}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52182960, "num_agent_steps_trained": 52182960, "num_env_steps_sampled": 52182960, "num_env_steps_trained": 52182960, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 274.8537478810296, "num_env_steps_trained_throughput_per_sec": 274.8537478810296, "timesteps_total": 52182960, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52182960, "timers": {"training_iteration_time_ms": 4386.167, "sample_time_ms": 4353.408, "load_time_ms": 0.587, "load_throughput": 2042597.622, "learn_time_ms": 31.35, "learn_throughput": 38276.939, "synch_weights_time_ms": 0.772}, "counters": {"num_env_steps_sampled": 52182960, "num_env_steps_trained": 52182960, "num_agent_steps_sampled": 52182960, "num_agent_steps_trained": 52182960}, "done": false, "episodes_total": 12942, "training_iteration": 4070, "trial_id": "9f686_00000", "date": "2023-08-08_15-57-23", "timestamp": 1691499443, "time_this_iter_s": 13.100697755813599, "time_total_s": 95861.4357573986, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2777.262570619583, "iterations_since_restore": 210, "perf": {"cpu_util_percent": 19.710526315789473, "ram_util_percent": 65.43157894736842}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -369.62217881944446, "policy_loss": -5048223.344618056, "vf_loss": 21394630.333333332}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11367.5, "diff_num_grad_updates_vs_sampler_policy": 11366.5}}, "num_env_steps_sampled": 52186560, "num_env_steps_trained": 52186560, "num_agent_steps_sampled": 52186560, "num_agent_steps_trained": 52186560}, "sampler_results": {"episode_reward_max": -10119.50262254747, "episode_reward_min": -10497.83942215756, "episode_reward_mean": -10299.062649139076, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4284584164394794, "mean_inference_ms": 0.37139943082630766, "mean_action_processing_ms": 0.09123949437097442, "mean_env_wait_ms": 0.7391817708034206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034470558166503906, "StateBufferConnector_ms": 0.0026023387908935547, "ViewRequirementAgentConnector_ms": 0.06624293327331543}}, "episode_reward_max": -10119.50262254747, "episode_reward_min": -10497.83942215756, "episode_reward_mean": -10299.062649139076, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10331.287964677875, -10322.199113577042, -10347.305898953518, -10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4284584164394794, "mean_inference_ms": 0.37139943082630766, "mean_action_processing_ms": 0.09123949437097442, "mean_env_wait_ms": 0.7391817708034206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034470558166503906, "StateBufferConnector_ms": 0.0026023387908935547, "ViewRequirementAgentConnector_ms": 0.06624293327331543}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52186560, "num_agent_steps_trained": 52186560, "num_env_steps_sampled": 52186560, "num_env_steps_trained": 52186560, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 274.95826776755143, "num_env_steps_trained_throughput_per_sec": 274.95826776755143, "timesteps_total": 52186560, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52186560, "timers": {"training_iteration_time_ms": 4390.05, "sample_time_ms": 4357.353, "load_time_ms": 0.579, "load_throughput": 2073052.762, "learn_time_ms": 31.316, "learn_throughput": 38319.019, "synch_weights_time_ms": 0.753}, "counters": {"num_env_steps_sampled": 52186560, "num_env_steps_trained": 52186560, "num_agent_steps_sampled": 52186560, "num_agent_steps_trained": 52186560}, "done": false, "episodes_total": 12945, "training_iteration": 4071, "trial_id": "9f686_00000", "date": "2023-08-08_15-57-36", "timestamp": 1691499456, "time_this_iter_s": 13.095828771591187, "time_total_s": 95874.5315861702, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2790.3583993911743, "iterations_since_restore": 211, "perf": {"cpu_util_percent": 21.983333333333334, "ram_util_percent": 65.4388888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -361.74855550130206, "policy_loss": -9836402.413194444, "vf_loss": 21142089.861111112}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11421.5, "diff_num_grad_updates_vs_sampler_policy": 11420.5}}, "num_env_steps_sampled": 52190160, "num_env_steps_trained": 52190160, "num_agent_steps_sampled": 52190160, "num_agent_steps_trained": 52190160}, "sampler_results": {"episode_reward_max": -10119.50262254747, "episode_reward_min": -10497.83942215756, "episode_reward_mean": -10298.12980883526, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428446852690473, "mean_inference_ms": 0.3713950602101905, "mean_action_processing_ms": 0.09123916675652173, "mean_env_wait_ms": 0.7391500802812814, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003443479537963867, "StateBufferConnector_ms": 0.0026023387908935547, "ViewRequirementAgentConnector_ms": 0.06625699996948242}}, "episode_reward_max": -10119.50262254747, "episode_reward_min": -10497.83942215756, "episode_reward_mean": -10298.12980883526, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10415.886743293568, -10344.516379563216, -10252.166657614225, -10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428446852690473, "mean_inference_ms": 0.3713950602101905, "mean_action_processing_ms": 0.09123916675652173, "mean_env_wait_ms": 0.7391500802812814, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003443479537963867, "StateBufferConnector_ms": 0.0026023387908935547, "ViewRequirementAgentConnector_ms": 0.06625699996948242}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52190160, "num_agent_steps_trained": 52190160, "num_env_steps_sampled": 52190160, "num_env_steps_trained": 52190160, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 271.7654695614822, "num_env_steps_trained_throughput_per_sec": 271.7654695614822, "timesteps_total": 52190160, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52190160, "timers": {"training_iteration_time_ms": 4382.426, "sample_time_ms": 4349.727, "load_time_ms": 0.578, "load_throughput": 2074334.322, "learn_time_ms": 31.309, "learn_throughput": 38327.452, "synch_weights_time_ms": 0.763}, "counters": {"num_env_steps_sampled": 52190160, "num_env_steps_trained": 52190160, "num_agent_steps_sampled": 52190160, "num_agent_steps_trained": 52190160}, "done": false, "episodes_total": 12948, "training_iteration": 4072, "trial_id": "9f686_00000", "date": "2023-08-08_15-57-50", "timestamp": 1691499470, "time_this_iter_s": 13.249751091003418, "time_total_s": 95887.7813372612, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2803.6081504821777, "iterations_since_restore": 212, "perf": {"cpu_util_percent": 20.44736842105263, "ram_util_percent": 65.44736842105263}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -362.75218370225696, "policy_loss": -8408747.420138888, "vf_loss": 21622721.722222224}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11475.5, "diff_num_grad_updates_vs_sampler_policy": 11474.5}}, "num_env_steps_sampled": 52193760, "num_env_steps_trained": 52193760, "num_agent_steps_sampled": 52193760, "num_agent_steps_trained": 52193760}, "sampler_results": {"episode_reward_max": -10119.50262254747, "episode_reward_min": -10497.83942215756, "episode_reward_mean": -10296.13102934384, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428425421839869, "mean_inference_ms": 0.37139079055195295, "mean_action_processing_ms": 0.09123891343384495, "mean_env_wait_ms": 0.7391146962691295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034372806549072266, "StateBufferConnector_ms": 0.0025899410247802734, "ViewRequirementAgentConnector_ms": 0.066070556640625}}, "episode_reward_max": -10119.50262254747, "episode_reward_min": -10497.83942215756, "episode_reward_mean": -10296.13102934384, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10328.117465837022, -10138.414807519051, -10367.775570479927, -10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428425421839869, "mean_inference_ms": 0.37139079055195295, "mean_action_processing_ms": 0.09123891343384495, "mean_env_wait_ms": 0.7391146962691295, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034372806549072266, "StateBufferConnector_ms": 0.0025899410247802734, "ViewRequirementAgentConnector_ms": 0.066070556640625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52193760, "num_agent_steps_trained": 52193760, "num_env_steps_sampled": 52193760, "num_env_steps_trained": 52193760, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 278.23826749712947, "num_env_steps_trained_throughput_per_sec": 278.23826749712947, "timesteps_total": 52193760, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52193760, "timers": {"training_iteration_time_ms": 4367.942, "sample_time_ms": 4335.555, "load_time_ms": 0.576, "load_throughput": 2083694.804, "learn_time_ms": 31.009, "learn_throughput": 38697.958, "synch_weights_time_ms": 0.753}, "counters": {"num_env_steps_sampled": 52193760, "num_env_steps_trained": 52193760, "num_agent_steps_sampled": 52193760, "num_agent_steps_trained": 52193760}, "done": false, "episodes_total": 12951, "training_iteration": 4073, "trial_id": "9f686_00000", "date": "2023-08-08_15-58-03", "timestamp": 1691499483, "time_this_iter_s": 12.941411972045898, "time_total_s": 95900.72274923325, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2816.5495624542236, "iterations_since_restore": 213, "perf": {"cpu_util_percent": 23.35789473684211, "ram_util_percent": 65.57894736842107}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -363.3298848470052, "policy_loss": -8390095.634982638, "vf_loss": 21533178.916666668}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11529.5, "diff_num_grad_updates_vs_sampler_policy": 11528.5}}, "num_env_steps_sampled": 52197360, "num_env_steps_trained": 52197360, "num_agent_steps_sampled": 52197360, "num_agent_steps_trained": 52197360}, "sampler_results": {"episode_reward_max": -10119.50262254747, "episode_reward_min": -10497.83942215756, "episode_reward_mean": -10295.609935591769, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4284039990347024, "mean_inference_ms": 0.3713862424061447, "mean_action_processing_ms": 0.0912386633394474, "mean_env_wait_ms": 0.7390755589186061, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034351348876953125, "StateBufferConnector_ms": 0.0025866031646728516, "ViewRequirementAgentConnector_ms": 0.06613445281982422}}, "episode_reward_max": -10119.50262254747, "episode_reward_min": -10497.83942215756, "episode_reward_mean": -10295.609935591769, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10282.942289306842, -10453.076665629485, -10229.361223277423, -10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4284039990347024, "mean_inference_ms": 0.3713862424061447, "mean_action_processing_ms": 0.0912386633394474, "mean_env_wait_ms": 0.7390755589186061, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034351348876953125, "StateBufferConnector_ms": 0.0025866031646728516, "ViewRequirementAgentConnector_ms": 0.06613445281982422}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52197360, "num_agent_steps_trained": 52197360, "num_env_steps_sampled": 52197360, "num_env_steps_trained": 52197360, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 273.32299594769705, "num_env_steps_trained_throughput_per_sec": 273.32299594769705, "timesteps_total": 52197360, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52197360, "timers": {"training_iteration_time_ms": 4365.081, "sample_time_ms": 4332.521, "load_time_ms": 0.583, "load_throughput": 2058975.169, "learn_time_ms": 31.162, "learn_throughput": 38508.175, "synch_weights_time_ms": 0.766}, "counters": {"num_env_steps_sampled": 52197360, "num_env_steps_trained": 52197360, "num_agent_steps_sampled": 52197360, "num_agent_steps_trained": 52197360}, "done": false, "episodes_total": 12954, "training_iteration": 4074, "trial_id": "9f686_00000", "date": "2023-08-08_15-58-16", "timestamp": 1691499496, "time_this_iter_s": 13.17402172088623, "time_total_s": 95913.89677095413, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2829.72358417511, "iterations_since_restore": 214, "perf": {"cpu_util_percent": 19.22222222222222, "ram_util_percent": 65.37777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -362.610102335612, "policy_loss": -5596594.078993056, "vf_loss": 21158458.888888888}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11583.5, "diff_num_grad_updates_vs_sampler_policy": 11582.5}}, "num_env_steps_sampled": 52200960, "num_env_steps_trained": 52200960, "num_agent_steps_sampled": 52200960, "num_agent_steps_trained": 52200960}, "sampler_results": {"episode_reward_max": -10119.50262254747, "episode_reward_min": -10497.83942215756, "episode_reward_mean": -10293.658801902391, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.42838051116742, "mean_inference_ms": 0.37138178711776, "mean_action_processing_ms": 0.09123842641668035, "mean_env_wait_ms": 0.7390341580878139, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003431081771850586, "StateBufferConnector_ms": 0.0025849342346191406, "ViewRequirementAgentConnector_ms": 0.06614327430725098}}, "episode_reward_max": -10119.50262254747, "episode_reward_min": -10497.83942215756, "episode_reward_mean": -10293.658801902391, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10317.2210211912, -10346.213598346996, -10347.127699227145, -10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.42838051116742, "mean_inference_ms": 0.37138178711776, "mean_action_processing_ms": 0.09123842641668035, "mean_env_wait_ms": 0.7390341580878139, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003431081771850586, "StateBufferConnector_ms": 0.0025849342346191406, "ViewRequirementAgentConnector_ms": 0.06614327430725098}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52200960, "num_agent_steps_trained": 52200960, "num_env_steps_sampled": 52200960, "num_env_steps_trained": 52200960, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 273.8206887016767, "num_env_steps_trained_throughput_per_sec": 273.8206887016767, "timesteps_total": 52200960, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52200960, "timers": {"training_iteration_time_ms": 4362.517, "sample_time_ms": 4329.841, "load_time_ms": 0.582, "load_throughput": 2060408.056, "learn_time_ms": 31.284, "learn_throughput": 38358.356, "synch_weights_time_ms": 0.761}, "counters": {"num_env_steps_sampled": 52200960, "num_env_steps_trained": 52200960, "num_agent_steps_sampled": 52200960, "num_agent_steps_trained": 52200960}, "done": false, "episodes_total": 12957, "training_iteration": 4075, "trial_id": "9f686_00000", "date": "2023-08-08_15-58-29", "timestamp": 1691499509, "time_this_iter_s": 13.150131940841675, "time_total_s": 95927.04690289497, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2842.8737161159515, "iterations_since_restore": 215, "perf": {"cpu_util_percent": 18.8, "ram_util_percent": 65.13684210526317}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -364.3088209364149, "policy_loss": -6633778.095486111, "vf_loss": 21809399.388888888}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11637.5, "diff_num_grad_updates_vs_sampler_policy": 11636.5}}, "num_env_steps_sampled": 52204560, "num_env_steps_trained": 52204560, "num_agent_steps_sampled": 52204560, "num_agent_steps_trained": 52204560}, "sampler_results": {"episode_reward_max": -10119.50262254747, "episode_reward_min": -10505.853789586594, "episode_reward_mean": -10296.750087798282, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4283540089067723, "mean_inference_ms": 0.3713774361056758, "mean_action_processing_ms": 0.09123819460090714, "mean_env_wait_ms": 0.7389945344939461, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034339427947998047, "StateBufferConnector_ms": 0.0025854110717773438, "ViewRequirementAgentConnector_ms": 0.06605410575866699}}, "episode_reward_max": -10119.50262254747, "episode_reward_min": -10505.853789586594, "episode_reward_mean": -10296.750087798282, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10215.684699458028, -10281.035965276013, -10236.866286081924, -10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4283540089067723, "mean_inference_ms": 0.3713774361056758, "mean_action_processing_ms": 0.09123819460090714, "mean_env_wait_ms": 0.7389945344939461, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034339427947998047, "StateBufferConnector_ms": 0.0025854110717773438, "ViewRequirementAgentConnector_ms": 0.06605410575866699}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52204560, "num_agent_steps_trained": 52204560, "num_env_steps_sampled": 52204560, "num_env_steps_trained": 52204560, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 271.9607784123922, "num_env_steps_trained_throughput_per_sec": 271.9607784123922, "timesteps_total": 52204560, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52204560, "timers": {"training_iteration_time_ms": 4390.546, "sample_time_ms": 4357.883, "load_time_ms": 0.585, "load_throughput": 2050085.455, "learn_time_ms": 31.274, "learn_throughput": 38370.257, "synch_weights_time_ms": 0.754}, "counters": {"num_env_steps_sampled": 52204560, "num_env_steps_trained": 52204560, "num_agent_steps_sampled": 52204560, "num_agent_steps_trained": 52204560}, "done": false, "episodes_total": 12960, "training_iteration": 4076, "trial_id": "9f686_00000", "date": "2023-08-08_15-58-42", "timestamp": 1691499522, "time_this_iter_s": 13.240104913711548, "time_total_s": 95940.28700780869, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2856.113821029663, "iterations_since_restore": 216, "perf": {"cpu_util_percent": 19.08947368421052, "ram_util_percent": 65.19999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -363.69502597384985, "policy_loss": -6940231.21484375, "vf_loss": 21312201.277777776}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11691.5, "diff_num_grad_updates_vs_sampler_policy": 11690.5}}, "num_env_steps_sampled": 52208160, "num_env_steps_trained": 52208160, "num_agent_steps_sampled": 52208160, "num_agent_steps_trained": 52208160}, "sampler_results": {"episode_reward_max": -10119.50262254747, "episode_reward_min": -10505.853789586594, "episode_reward_mean": -10295.352088945532, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4283312749586123, "mean_inference_ms": 0.37137338896409366, "mean_action_processing_ms": 0.09123803255015975, "mean_env_wait_ms": 0.7389507832797375, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034303665161132812, "StateBufferConnector_ms": 0.002576589584350586, "ViewRequirementAgentConnector_ms": 0.06605696678161621}}, "episode_reward_max": -10119.50262254747, "episode_reward_min": -10505.853789586594, "episode_reward_mean": -10295.352088945532, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10377.384454989238, -10412.100490739085, -10235.542502091856, -10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4283312749586123, "mean_inference_ms": 0.37137338896409366, "mean_action_processing_ms": 0.09123803255015975, "mean_env_wait_ms": 0.7389507832797375, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034303665161132812, "StateBufferConnector_ms": 0.002576589584350586, "ViewRequirementAgentConnector_ms": 0.06605696678161621}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52208160, "num_agent_steps_trained": 52208160, "num_env_steps_sampled": 52208160, "num_env_steps_trained": 52208160, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 273.0812847331237, "num_env_steps_trained_throughput_per_sec": 273.0812847331237, "timesteps_total": 52208160, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52208160, "timers": {"training_iteration_time_ms": 4401.91, "sample_time_ms": 4368.924, "load_time_ms": 0.575, "load_throughput": 2085680.756, "learn_time_ms": 31.599, "learn_throughput": 37975.602, "synch_weights_time_ms": 0.763}, "counters": {"num_env_steps_sampled": 52208160, "num_env_steps_trained": 52208160, "num_agent_steps_sampled": 52208160, "num_agent_steps_trained": 52208160}, "done": false, "episodes_total": 12963, "training_iteration": 4077, "trial_id": "9f686_00000", "date": "2023-08-08_15-58-55", "timestamp": 1691499535, "time_this_iter_s": 13.185878038406372, "time_total_s": 95953.47288584709, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2869.2996990680695, "iterations_since_restore": 217, "perf": {"cpu_util_percent": 19.68333333333333, "ram_util_percent": 65.18888888888888}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -362.76148478190106, "policy_loss": -5661011.088107639, "vf_loss": 21250421.166666668}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11745.5, "diff_num_grad_updates_vs_sampler_policy": 11744.5}}, "num_env_steps_sampled": 52211760, "num_env_steps_trained": 52211760, "num_agent_steps_sampled": 52211760, "num_agent_steps_trained": 52211760}, "sampler_results": {"episode_reward_max": -10119.50262254747, "episode_reward_min": -10505.853789586594, "episode_reward_mean": -10293.786555282013, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4283140207875396, "mean_inference_ms": 0.3713694842885755, "mean_action_processing_ms": 0.09123788257590056, "mean_env_wait_ms": 0.738908487978504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034332275390625, "StateBufferConnector_ms": 0.0025780200958251953, "ViewRequirementAgentConnector_ms": 0.0660712718963623}}, "episode_reward_max": -10119.50262254747, "episode_reward_min": -10505.853789586594, "episode_reward_mean": -10293.786555282013, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10247.227438710319, -10336.034410889431, -10323.551020412675, -10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4283140207875396, "mean_inference_ms": 0.3713694842885755, "mean_action_processing_ms": 0.09123788257590056, "mean_env_wait_ms": 0.738908487978504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034332275390625, "StateBufferConnector_ms": 0.0025780200958251953, "ViewRequirementAgentConnector_ms": 0.0660712718963623}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52211760, "num_agent_steps_trained": 52211760, "num_env_steps_sampled": 52211760, "num_env_steps_trained": 52211760, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 270.5074371702599, "num_env_steps_trained_throughput_per_sec": 270.5074371702599, "timesteps_total": 52211760, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52211760, "timers": {"training_iteration_time_ms": 4405.031, "sample_time_ms": 4372.208, "load_time_ms": 0.583, "load_throughput": 2057880.775, "learn_time_ms": 31.434, "learn_throughput": 38175.616, "synch_weights_time_ms": 0.756}, "counters": {"num_env_steps_sampled": 52211760, "num_env_steps_trained": 52211760, "num_agent_steps_sampled": 52211760, "num_agent_steps_trained": 52211760}, "done": false, "episodes_total": 12966, "training_iteration": 4078, "trial_id": "9f686_00000", "date": "2023-08-08_15-59-09", "timestamp": 1691499549, "time_this_iter_s": 13.311425685882568, "time_total_s": 95966.78431153297, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2882.611124753952, "iterations_since_restore": 218, "perf": {"cpu_util_percent": 18.936842105263157, "ram_util_percent": 65.27368421052631}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -365.13372633192273, "policy_loss": -7142736.0703125, "vf_loss": 21554417.055555556}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11799.5, "diff_num_grad_updates_vs_sampler_policy": 11798.5}}, "num_env_steps_sampled": 52215360, "num_env_steps_trained": 52215360, "num_agent_steps_sampled": 52215360, "num_agent_steps_trained": 52215360}, "sampler_results": {"episode_reward_max": -10119.50262254747, "episode_reward_min": -10505.853789586594, "episode_reward_mean": -10295.025744919085, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428297304175819, "mean_inference_ms": 0.3713658620994073, "mean_action_processing_ms": 0.09123783628086433, "mean_env_wait_ms": 0.7388671124351214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034389495849609375, "StateBufferConnector_ms": 0.002583742141723633, "ViewRequirementAgentConnector_ms": 0.06614136695861816}}, "episode_reward_max": -10119.50262254747, "episode_reward_min": -10505.853789586594, "episode_reward_mean": -10295.025744919085, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10365.153609351362, -10497.83942215756, -10344.408360396079, -10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428297304175819, "mean_inference_ms": 0.3713658620994073, "mean_action_processing_ms": 0.09123783628086433, "mean_env_wait_ms": 0.7388671124351214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034389495849609375, "StateBufferConnector_ms": 0.002583742141723633, "ViewRequirementAgentConnector_ms": 0.06614136695861816}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52215360, "num_agent_steps_trained": 52215360, "num_env_steps_sampled": 52215360, "num_env_steps_trained": 52215360, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 271.42752343158577, "num_env_steps_trained_throughput_per_sec": 271.42752343158577, "timesteps_total": 52215360, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52215360, "timers": {"training_iteration_time_ms": 4412.888, "sample_time_ms": 4379.965, "load_time_ms": 0.582, "load_throughput": 2061842.94, "learn_time_ms": 31.487, "learn_throughput": 38110.692, "synch_weights_time_ms": 0.803}, "counters": {"num_env_steps_sampled": 52215360, "num_env_steps_trained": 52215360, "num_agent_steps_sampled": 52215360, "num_agent_steps_trained": 52215360}, "done": false, "episodes_total": 12969, "training_iteration": 4079, "trial_id": "9f686_00000", "date": "2023-08-08_15-59-22", "timestamp": 1691499562, "time_this_iter_s": 13.266025066375732, "time_total_s": 95980.05033659935, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2895.8771498203278, "iterations_since_restore": 219, "perf": {"cpu_util_percent": 20.010526315789473, "ram_util_percent": 65.25263157894737}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -362.10779656304254, "policy_loss": -4806845.577256944, "vf_loss": 21220459.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11853.5, "diff_num_grad_updates_vs_sampler_policy": 11852.5}}, "num_env_steps_sampled": 52218960, "num_env_steps_trained": 52218960, "num_agent_steps_sampled": 52218960, "num_agent_steps_trained": 52218960}, "sampler_results": {"episode_reward_max": -10119.50262254747, "episode_reward_min": -10505.853789586594, "episode_reward_mean": -10291.094617061635, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4282847678920882, "mean_inference_ms": 0.3713623886380802, "mean_action_processing_ms": 0.09123779542547035, "mean_env_wait_ms": 0.7388228124304984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034418106079101562, "StateBufferConnector_ms": 0.0025780200958251953, "ViewRequirementAgentConnector_ms": 0.06620430946350098}}, "episode_reward_max": -10119.50262254747, "episode_reward_min": -10505.853789586594, "episode_reward_mean": -10291.094617061635, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10261.724500531487, -10342.225791860195, -10446.20356029765, -10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4282847678920882, "mean_inference_ms": 0.3713623886380802, "mean_action_processing_ms": 0.09123779542547035, "mean_env_wait_ms": 0.7388228124304984, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034418106079101562, "StateBufferConnector_ms": 0.0025780200958251953, "ViewRequirementAgentConnector_ms": 0.06620430946350098}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52218960, "num_agent_steps_trained": 52218960, "num_env_steps_sampled": 52218960, "num_env_steps_trained": 52218960, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 272.3493509995258, "num_env_steps_trained_throughput_per_sec": 272.3493509995258, "timesteps_total": 52218960, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52218960, "timers": {"training_iteration_time_ms": 4423.955, "sample_time_ms": 4391.063, "load_time_ms": 0.583, "load_throughput": 2057544.273, "learn_time_ms": 31.458, "learn_throughput": 38145.584, "synch_weights_time_ms": 0.8}, "counters": {"num_env_steps_sampled": 52218960, "num_env_steps_trained": 52218960, "num_agent_steps_sampled": 52218960, "num_agent_steps_trained": 52218960}, "done": false, "episodes_total": 12972, "training_iteration": 4080, "trial_id": "9f686_00000", "date": "2023-08-08_15-59-35", "timestamp": 1691499575, "time_this_iter_s": 13.221155643463135, "time_total_s": 95993.27149224281, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2909.098305463791, "iterations_since_restore": 220, "perf": {"cpu_util_percent": 19.757894736842108, "ram_util_percent": 65.3157894736842}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -362.31238810221356, "policy_loss": -8642602.737847222, "vf_loss": 21689140.916666668}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11907.5, "diff_num_grad_updates_vs_sampler_policy": 11906.5}}, "num_env_steps_sampled": 52222560, "num_env_steps_trained": 52222560, "num_agent_steps_sampled": 52222560, "num_agent_steps_trained": 52222560}, "sampler_results": {"episode_reward_max": -10119.50262254747, "episode_reward_min": -10505.853789586594, "episode_reward_mean": -10291.00544689441, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4282717998251697, "mean_inference_ms": 0.37135873257157526, "mean_action_processing_ms": 0.09123776985665198, "mean_env_wait_ms": 0.738776972108667, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034351348876953125, "StateBufferConnector_ms": 0.0025773048400878906, "ViewRequirementAgentConnector_ms": 0.0662837028503418}}, "episode_reward_max": -10119.50262254747, "episode_reward_min": -10505.853789586594, "episode_reward_mean": -10291.00544689441, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10348.325552331502, -10276.138757604258, -10185.754682703613, -10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4282717998251697, "mean_inference_ms": 0.37135873257157526, "mean_action_processing_ms": 0.09123776985665198, "mean_env_wait_ms": 0.738776972108667, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034351348876953125, "StateBufferConnector_ms": 0.0025773048400878906, "ViewRequirementAgentConnector_ms": 0.0662837028503418}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52222560, "num_agent_steps_trained": 52222560, "num_env_steps_sampled": 52222560, "num_env_steps_trained": 52222560, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 272.6655924245689, "num_env_steps_trained_throughput_per_sec": 272.6655924245689, "timesteps_total": 52222560, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52222560, "timers": {"training_iteration_time_ms": 4410.576, "sample_time_ms": 4377.788, "load_time_ms": 0.576, "load_throughput": 2084471.465, "learn_time_ms": 31.335, "learn_throughput": 38295.461, "synch_weights_time_ms": 0.827}, "counters": {"num_env_steps_sampled": 52222560, "num_env_steps_trained": 52222560, "num_agent_steps_sampled": 52222560, "num_agent_steps_trained": 52222560}, "done": false, "episodes_total": 12975, "training_iteration": 4081, "trial_id": "9f686_00000", "date": "2023-08-08_15-59-49", "timestamp": 1691499589, "time_this_iter_s": 13.206127166748047, "time_total_s": 96006.47761940956, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2922.304432630539, "iterations_since_restore": 221, "perf": {"cpu_util_percent": 19.710526315789473, "ram_util_percent": 65.46315789473684}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -363.48435974121094, "policy_loss": -11759867.159722222, "vf_loss": 21731164.527777776}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11961.5, "diff_num_grad_updates_vs_sampler_policy": 11960.5}}, "num_env_steps_sampled": 52226160, "num_env_steps_trained": 52226160, "num_agent_steps_sampled": 52226160, "num_agent_steps_trained": 52226160}, "sampler_results": {"episode_reward_max": -10119.50262254747, "episode_reward_min": -10505.853789586594, "episode_reward_mean": -10289.629548660265, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4282499136608977, "mean_inference_ms": 0.3713553530251164, "mean_action_processing_ms": 0.09123775661134997, "mean_env_wait_ms": 0.7387261262317183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034368038177490234, "StateBufferConnector_ms": 0.0025551319122314453, "ViewRequirementAgentConnector_ms": 0.06626415252685547}}, "episode_reward_max": -10119.50262254747, "episode_reward_min": -10505.853789586594, "episode_reward_mean": -10289.629548660265, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10351.77908417115, -10119.50262254747, -10405.195539181645, -10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4282499136608977, "mean_inference_ms": 0.3713553530251164, "mean_action_processing_ms": 0.09123775661134997, "mean_env_wait_ms": 0.7387261262317183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034368038177490234, "StateBufferConnector_ms": 0.0025551319122314453, "ViewRequirementAgentConnector_ms": 0.06626415252685547}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52226160, "num_agent_steps_trained": 52226160, "num_env_steps_sampled": 52226160, "num_env_steps_trained": 52226160, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 278.9945490584829, "num_env_steps_trained_throughput_per_sec": 278.9945490584829, "timesteps_total": 52226160, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52226160, "timers": {"training_iteration_time_ms": 4379.19, "sample_time_ms": 4346.339, "load_time_ms": 0.578, "load_throughput": 2075446.291, "learn_time_ms": 31.436, "learn_throughput": 38173.068, "synch_weights_time_ms": 0.788}, "counters": {"num_env_steps_sampled": 52226160, "num_env_steps_trained": 52226160, "num_agent_steps_sampled": 52226160, "num_agent_steps_trained": 52226160}, "done": false, "episodes_total": 12978, "training_iteration": 4082, "trial_id": "9f686_00000", "date": "2023-08-08_16-00-02", "timestamp": 1691499602, "time_this_iter_s": 12.906280994415283, "time_total_s": 96019.38390040398, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2935.210713624954, "iterations_since_restore": 222, "perf": {"cpu_util_percent": 18.68888888888889, "ram_util_percent": 65.31666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -363.30953131781683, "policy_loss": -10865997.666666666, "vf_loss": 22133545.333333332}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12015.5, "diff_num_grad_updates_vs_sampler_policy": 12014.5}}, "num_env_steps_sampled": 52229760, "num_env_steps_trained": 52229760, "num_agent_steps_sampled": 52229760, "num_agent_steps_trained": 52229760}, "sampler_results": {"episode_reward_max": -10142.37363757697, "episode_reward_min": -10505.853789586594, "episode_reward_mean": -10292.857867155195, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428228698147331, "mean_inference_ms": 0.3713520261212029, "mean_action_processing_ms": 0.09123771085140778, "mean_env_wait_ms": 0.7386781532117318, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034437179565429688, "StateBufferConnector_ms": 0.0025510787963867188, "ViewRequirementAgentConnector_ms": 0.06627011299133301}}, "episode_reward_max": -10142.37363757697, "episode_reward_min": -10505.853789586594, "episode_reward_mean": -10292.857867155195, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10322.037211884748, -10323.467360887189, -10263.296964904963, -10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428228698147331, "mean_inference_ms": 0.3713520261212029, "mean_action_processing_ms": 0.09123771085140778, "mean_env_wait_ms": 0.7386781532117318, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034437179565429688, "StateBufferConnector_ms": 0.0025510787963867188, "ViewRequirementAgentConnector_ms": 0.06627011299133301}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52229760, "num_agent_steps_trained": 52229760, "num_env_steps_sampled": 52229760, "num_env_steps_trained": 52229760, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 270.69431706296655, "num_env_steps_trained_throughput_per_sec": 270.69431706296655, "timesteps_total": 52229760, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52229760, "timers": {"training_iteration_time_ms": 4379.787, "sample_time_ms": 4346.751, "load_time_ms": 0.577, "load_throughput": 2078617.659, "learn_time_ms": 31.63, "learn_throughput": 37938.619, "synch_weights_time_ms": 0.78}, "counters": {"num_env_steps_sampled": 52229760, "num_env_steps_trained": 52229760, "num_agent_steps_sampled": 52229760, "num_agent_steps_trained": 52229760}, "done": false, "episodes_total": 12981, "training_iteration": 4083, "trial_id": "9f686_00000", "date": "2023-08-08_16-00-15", "timestamp": 1691499615, "time_this_iter_s": 13.302063941955566, "time_total_s": 96032.68596434593, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2948.51277756691, "iterations_since_restore": 223, "perf": {"cpu_util_percent": 19.215789473684207, "ram_util_percent": 65.43157894736842}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -362.4049258761936, "policy_loss": -5598656.613715278, "vf_loss": 21266454.416666668}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12069.5, "diff_num_grad_updates_vs_sampler_policy": 12068.5}}, "num_env_steps_sampled": 52233360, "num_env_steps_trained": 52233360, "num_agent_steps_sampled": 52233360, "num_agent_steps_trained": 52233360}, "sampler_results": {"episode_reward_max": -10142.37363757697, "episode_reward_min": -10505.853789586594, "episode_reward_mean": -10292.181003084967, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4282037124204363, "mean_inference_ms": 0.37134892706851935, "mean_action_processing_ms": 0.09123770017241416, "mean_env_wait_ms": 0.7386316453196511, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003445148468017578, "StateBufferConnector_ms": 0.002550363540649414, "ViewRequirementAgentConnector_ms": 0.06623291969299316}}, "episode_reward_max": -10142.37363757697, "episode_reward_min": -10505.853789586594, "episode_reward_mean": -10292.181003084967, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10156.808727969144, -10223.465878906429, -10254.177034879925, -10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4282037124204363, "mean_inference_ms": 0.37134892706851935, "mean_action_processing_ms": 0.09123770017241416, "mean_env_wait_ms": 0.7386316453196511, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003445148468017578, "StateBufferConnector_ms": 0.002550363540649414, "ViewRequirementAgentConnector_ms": 0.06623291969299316}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52233360, "num_agent_steps_trained": 52233360, "num_env_steps_sampled": 52233360, "num_env_steps_trained": 52233360, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 275.23804878198166, "num_env_steps_trained_throughput_per_sec": 275.23804878198166, "timesteps_total": 52233360, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52233360, "timers": {"training_iteration_time_ms": 4363.585, "sample_time_ms": 4330.566, "load_time_ms": 0.577, "load_throughput": 2080335.951, "learn_time_ms": 31.605, "learn_throughput": 37968.24, "synch_weights_time_ms": 0.788}, "counters": {"num_env_steps_sampled": 52233360, "num_env_steps_trained": 52233360, "num_agent_steps_sampled": 52233360, "num_agent_steps_trained": 52233360}, "done": false, "episodes_total": 12984, "training_iteration": 4084, "trial_id": "9f686_00000", "date": "2023-08-08_16-00-28", "timestamp": 1691499628, "time_this_iter_s": 13.082962036132812, "time_total_s": 96045.76892638206, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2961.5957396030426, "iterations_since_restore": 224, "perf": {"cpu_util_percent": 19.144444444444442, "ram_util_percent": 65.09444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -363.12691073947485, "policy_loss": -5732891.556857639, "vf_loss": 21314290.055555556}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12123.5, "diff_num_grad_updates_vs_sampler_policy": 12122.5}}, "num_env_steps_sampled": 52236960, "num_env_steps_trained": 52236960, "num_agent_steps_sampled": 52236960, "num_agent_steps_trained": 52236960}, "sampler_results": {"episode_reward_max": -10142.37363757697, "episode_reward_min": -10505.853789586594, "episode_reward_mean": -10294.26942427696, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4281775901892164, "mean_inference_ms": 0.37134604871386073, "mean_action_processing_ms": 0.09123770402274373, "mean_env_wait_ms": 0.7385856265793211, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034432411193847656, "StateBufferConnector_ms": 0.0025544166564941406, "ViewRequirementAgentConnector_ms": 0.0662078857421875}}, "episode_reward_max": -10142.37363757697, "episode_reward_min": -10505.853789586594, "episode_reward_mean": -10294.26942427696, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10341.182300587414, -10286.308535513417, -10299.923995540641, -10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4281775901892164, "mean_inference_ms": 0.37134604871386073, "mean_action_processing_ms": 0.09123770402274373, "mean_env_wait_ms": 0.7385856265793211, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034432411193847656, "StateBufferConnector_ms": 0.0025544166564941406, "ViewRequirementAgentConnector_ms": 0.0662078857421875}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52236960, "num_agent_steps_trained": 52236960, "num_env_steps_sampled": 52236960, "num_env_steps_trained": 52236960, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 274.25265465479737, "num_env_steps_trained_throughput_per_sec": 274.25265465479737, "timesteps_total": 52236960, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52236960, "timers": {"training_iteration_time_ms": 4380.998, "sample_time_ms": 4348.109, "load_time_ms": 0.574, "load_throughput": 2091226.857, "learn_time_ms": 31.477, "learn_throughput": 38123.018, "synch_weights_time_ms": 0.788}, "counters": {"num_env_steps_sampled": 52236960, "num_env_steps_trained": 52236960, "num_agent_steps_sampled": 52236960, "num_agent_steps_trained": 52236960}, "done": false, "episodes_total": 12987, "training_iteration": 4085, "trial_id": "9f686_00000", "date": "2023-08-08_16-00-41", "timestamp": 1691499641, "time_this_iter_s": 13.129822969436646, "time_total_s": 96058.8987493515, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2974.7255625724792, "iterations_since_restore": 225, "perf": {"cpu_util_percent": 18.889473684210525, "ram_util_percent": 65.14736842105263}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -361.8368157280816, "policy_loss": -7218489.212673611, "vf_loss": 21362542.472222224}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12177.5, "diff_num_grad_updates_vs_sampler_policy": 12176.5}}, "num_env_steps_sampled": 52240560, "num_env_steps_trained": 52240560, "num_agent_steps_sampled": 52240560, "num_agent_steps_trained": 52240560}, "sampler_results": {"episode_reward_max": -10142.37363757697, "episode_reward_min": -10505.853789586594, "episode_reward_mean": -10293.174951220826, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4281494438053937, "mean_inference_ms": 0.37134307996197036, "mean_action_processing_ms": 0.09123769251292767, "mean_env_wait_ms": 0.7385438306997787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003447294235229492, "StateBufferConnector_ms": 0.0025479793548583984, "ViewRequirementAgentConnector_ms": 0.06614136695861816}}, "episode_reward_max": -10142.37363757697, "episode_reward_min": -10505.853789586594, "episode_reward_mean": -10293.174951220826, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10274.986110083062, -10306.139553450725, -10256.734287714082, -10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4281494438053937, "mean_inference_ms": 0.37134307996197036, "mean_action_processing_ms": 0.09123769251292767, "mean_env_wait_ms": 0.7385438306997787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003447294235229492, "StateBufferConnector_ms": 0.0025479793548583984, "ViewRequirementAgentConnector_ms": 0.06614136695861816}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52240560, "num_agent_steps_trained": 52240560, "num_env_steps_sampled": 52240560, "num_env_steps_trained": 52240560, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 271.9651919007423, "num_env_steps_trained_throughput_per_sec": 271.9651919007423, "timesteps_total": 52240560, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52240560, "timers": {"training_iteration_time_ms": 4389.368, "sample_time_ms": 4356.544, "load_time_ms": 0.575, "load_throughput": 2088103.551, "learn_time_ms": 31.395, "learn_throughput": 38222.697, "synch_weights_time_ms": 0.804}, "counters": {"num_env_steps_sampled": 52240560, "num_env_steps_trained": 52240560, "num_agent_steps_sampled": 52240560, "num_agent_steps_trained": 52240560}, "done": false, "episodes_total": 12990, "training_iteration": 4086, "trial_id": "9f686_00000", "date": "2023-08-08_16-00-54", "timestamp": 1691499654, "time_this_iter_s": 13.239938020706177, "time_total_s": 96072.13868737221, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2987.9655005931854, "iterations_since_restore": 226, "perf": {"cpu_util_percent": 20.284210526315793, "ram_util_percent": 65.11052631578949}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -362.46502176920575, "policy_loss": -5264398.184027778, "vf_loss": 21143122.194444444}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12231.5, "diff_num_grad_updates_vs_sampler_policy": 12230.5}}, "num_env_steps_sampled": 52244160, "num_env_steps_trained": 52244160, "num_agent_steps_sampled": 52244160, "num_agent_steps_trained": 52244160}, "sampler_results": {"episode_reward_max": -10142.37363757697, "episode_reward_min": -10505.853789586594, "episode_reward_mean": -10292.677988856718, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4281211712463904, "mean_inference_ms": 0.3713397798447564, "mean_action_processing_ms": 0.0912376467349116, "mean_env_wait_ms": 0.738502126475203, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003451824188232422, "StateBufferConnector_ms": 0.002546072006225586, "ViewRequirementAgentConnector_ms": 0.06607365608215332}}, "episode_reward_max": -10142.37363757697, "episode_reward_min": -10505.853789586594, "episode_reward_mean": -10292.677988856718, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10284.57431093375, -10347.72448074825, -10256.562701556204, -10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4281211712463904, "mean_inference_ms": 0.3713397798447564, "mean_action_processing_ms": 0.0912376467349116, "mean_env_wait_ms": 0.738502126475203, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003451824188232422, "StateBufferConnector_ms": 0.002546072006225586, "ViewRequirementAgentConnector_ms": 0.06607365608215332}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52244160, "num_agent_steps_trained": 52244160, "num_env_steps_sampled": 52244160, "num_env_steps_trained": 52244160, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 273.32977920314676, "num_env_steps_trained_throughput_per_sec": 273.32977920314676, "timesteps_total": 52244160, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52244160, "timers": {"training_iteration_time_ms": 4392.465, "sample_time_ms": 4359.662, "load_time_ms": 0.576, "load_throughput": 2084039.916, "learn_time_ms": 31.388, "learn_throughput": 38230.972, "synch_weights_time_ms": 0.789}, "counters": {"num_env_steps_sampled": 52244160, "num_env_steps_trained": 52244160, "num_agent_steps_sampled": 52244160, "num_agent_steps_trained": 52244160}, "done": false, "episodes_total": 12993, "training_iteration": 4087, "trial_id": "9f686_00000", "date": "2023-08-08_16-01-08", "timestamp": 1691499668, "time_this_iter_s": 13.173794984817505, "time_total_s": 96085.31248235703, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3001.139295578003, "iterations_since_restore": 227, "perf": {"cpu_util_percent": 19.488888888888887, "ram_util_percent": 65.08333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -363.35429043240015, "policy_loss": -8690435.640625, "vf_loss": 21578620.916666668}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12285.5, "diff_num_grad_updates_vs_sampler_policy": 12284.5}}, "num_env_steps_sampled": 52247760, "num_env_steps_trained": 52247760, "num_agent_steps_sampled": 52247760, "num_agent_steps_trained": 52247760}, "sampler_results": {"episode_reward_max": -10142.37363757697, "episode_reward_min": -10505.853789586594, "episode_reward_mean": -10293.704717458262, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428094142781602, "mean_inference_ms": 0.3713364911746933, "mean_action_processing_ms": 0.09123758278601488, "mean_env_wait_ms": 0.7384624927759657, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034554004669189453, "StateBufferConnector_ms": 0.0025429725646972656, "ViewRequirementAgentConnector_ms": 0.06610918045043945}}, "episode_reward_max": -10142.37363757697, "episode_reward_min": -10505.853789586594, "episode_reward_mean": -10293.704717458262, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10231.6622334189, -10325.711792520611, -10341.66546805172, -10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.428094142781602, "mean_inference_ms": 0.3713364911746933, "mean_action_processing_ms": 0.09123758278601488, "mean_env_wait_ms": 0.7384624927759657, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034554004669189453, "StateBufferConnector_ms": 0.0025429725646972656, "ViewRequirementAgentConnector_ms": 0.06610918045043945}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52247760, "num_agent_steps_trained": 52247760, "num_env_steps_sampled": 52247760, "num_env_steps_trained": 52247760, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 269.61494108189527, "num_env_steps_trained_throughput_per_sec": 269.61494108189527, "timesteps_total": 52247760, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52247760, "timers": {"training_iteration_time_ms": 4413.712, "sample_time_ms": 4381.003, "load_time_ms": 0.577, "load_throughput": 2078274.341, "learn_time_ms": 31.301, "learn_throughput": 38337.348, "synch_weights_time_ms": 0.782}, "counters": {"num_env_steps_sampled": 52247760, "num_env_steps_trained": 52247760, "num_agent_steps_sampled": 52247760, "num_agent_steps_trained": 52247760}, "done": false, "episodes_total": 12996, "training_iteration": 4088, "trial_id": "9f686_00000", "date": "2023-08-08_16-01-21", "timestamp": 1691499681, "time_this_iter_s": 13.355199098587036, "time_total_s": 96098.66768145561, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3014.49449467659, "iterations_since_restore": 228, "perf": {"cpu_util_percent": 19.400000000000002, "ram_util_percent": 65.03684210526315}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -361.49920484754773, "policy_loss": -8855062.5625, "vf_loss": 21842825.833333332}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12339.5, "diff_num_grad_updates_vs_sampler_policy": 12338.5}}, "num_env_steps_sampled": 52251360, "num_env_steps_trained": 52251360, "num_agent_steps_sampled": 52251360, "num_agent_steps_trained": 52251360}, "sampler_results": {"episode_reward_max": -10142.37363757697, "episode_reward_min": -10505.853789586594, "episode_reward_mean": -10296.916966488872, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105, -10347.865590442256, -10494.127652948591, -10378.271153661508], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4280662995654554, "mean_inference_ms": 0.3713332681834182, "mean_action_processing_ms": 0.09123751319096446, "mean_env_wait_ms": 0.7384235910955236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034592151641845703, "StateBufferConnector_ms": 0.002530813217163086, "ViewRequirementAgentConnector_ms": 0.06606531143188477}}, "episode_reward_max": -10142.37363757697, "episode_reward_min": -10505.853789586594, "episode_reward_mean": -10296.916966488872, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10303.813455240686, -10210.108887877886, -10230.631841983735, -10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105, -10347.865590442256, -10494.127652948591, -10378.271153661508], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4280662995654554, "mean_inference_ms": 0.3713332681834182, "mean_action_processing_ms": 0.09123751319096446, "mean_env_wait_ms": 0.7384235910955236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034592151641845703, "StateBufferConnector_ms": 0.002530813217163086, "ViewRequirementAgentConnector_ms": 0.06606531143188477}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52251360, "num_agent_steps_trained": 52251360, "num_env_steps_sampled": 52251360, "num_env_steps_trained": 52251360, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 271.7365013567394, "num_env_steps_trained_throughput_per_sec": 271.7365013567394, "timesteps_total": 52251360, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52251360, "timers": {"training_iteration_time_ms": 4431.491, "sample_time_ms": 4398.812, "load_time_ms": 0.583, "load_throughput": 2058554.11, "learn_time_ms": 31.279, "learn_throughput": 38364.32, "synch_weights_time_ms": 0.769}, "counters": {"num_env_steps_sampled": 52251360, "num_env_steps_trained": 52251360, "num_agent_steps_sampled": 52251360, "num_agent_steps_trained": 52251360}, "done": false, "episodes_total": 12999, "training_iteration": 4089, "trial_id": "9f686_00000", "date": "2023-08-08_16-01-34", "timestamp": 1691499694, "time_this_iter_s": 13.251008987426758, "time_total_s": 96111.91869044304, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3027.7455036640167, "iterations_since_restore": 229, "perf": {"cpu_util_percent": 21.405263157894737, "ram_util_percent": 65.2263157894737}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -365.65525309244794, "policy_loss": -4441873.103298611, "vf_loss": 21036263.361111112}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12393.5, "diff_num_grad_updates_vs_sampler_policy": 12392.5}}, "num_env_steps_sampled": 52254960, "num_env_steps_trained": 52254960, "num_agent_steps_sampled": 52254960, "num_agent_steps_trained": 52254960}, "sampler_results": {"episode_reward_max": -10142.37363757697, "episode_reward_min": -10505.853789586594, "episode_reward_mean": -10298.36756047207, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105, -10347.865590442256, -10494.127652948591, -10378.271153661508, -10486.215376611912, -10237.404043560799, -10165.994163249294], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4280387563709542, "mean_inference_ms": 0.3713304219536759, "mean_action_processing_ms": 0.09123746027196163, "mean_env_wait_ms": 0.738387030064953, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003461122512817383, "StateBufferConnector_ms": 0.0025305747985839844, "ViewRequirementAgentConnector_ms": 0.06601905822753906}}, "episode_reward_max": -10142.37363757697, "episode_reward_min": -10505.853789586594, "episode_reward_mean": -10298.36756047207, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10182.349401450529, -10236.32588044145, -10443.019600634656, -10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105, -10347.865590442256, -10494.127652948591, -10378.271153661508, -10486.215376611912, -10237.404043560799, -10165.994163249294], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4280387563709542, "mean_inference_ms": 0.3713304219536759, "mean_action_processing_ms": 0.09123746027196163, "mean_env_wait_ms": 0.738387030064953, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003461122512817383, "StateBufferConnector_ms": 0.0025305747985839844, "ViewRequirementAgentConnector_ms": 0.06601905822753906}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52254960, "num_agent_steps_trained": 52254960, "num_env_steps_sampled": 52254960, "num_env_steps_trained": 52254960, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 271.6294562326881, "num_env_steps_trained_throughput_per_sec": 271.6294562326881, "timesteps_total": 52254960, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52254960, "timers": {"training_iteration_time_ms": 4419.057, "sample_time_ms": 4386.388, "load_time_ms": 0.606, "load_throughput": 1980937.028, "learn_time_ms": 31.231, "learn_throughput": 38423.95, "synch_weights_time_ms": 0.784}, "counters": {"num_env_steps_sampled": 52254960, "num_env_steps_trained": 52254960, "num_agent_steps_sampled": 52254960, "num_agent_steps_trained": 52254960}, "done": false, "episodes_total": 13002, "training_iteration": 4090, "trial_id": "9f686_00000", "date": "2023-08-08_16-01-48", "timestamp": 1691499708, "time_this_iter_s": 13.2564218044281, "time_total_s": 96125.17511224747, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3041.001925468445, "iterations_since_restore": 230, "perf": {"cpu_util_percent": 17.926315789473687, "ram_util_percent": 65.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -364.99605984157984, "policy_loss": -9881576.241319444, "vf_loss": 21595680.777777776}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12447.5, "diff_num_grad_updates_vs_sampler_policy": 12446.5}}, "num_env_steps_sampled": 52258560, "num_env_steps_trained": 52258560, "num_agent_steps_sampled": 52258560, "num_agent_steps_trained": 52258560}, "sampler_results": {"episode_reward_max": -10142.37363757697, "episode_reward_min": -10505.853789586594, "episode_reward_mean": -10297.408256061726, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105, -10347.865590442256, -10494.127652948591, -10378.271153661508, -10486.215376611912, -10237.404043560799, -10165.994163249294, -10256.549219118442, -10222.763270961514, -10286.451951412399], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4280062037952455, "mean_inference_ms": 0.37132746970405456, "mean_action_processing_ms": 0.09123739733094353, "mean_env_wait_ms": 0.7383482498821706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034646987915039062, "StateBufferConnector_ms": 0.002534627914428711, "ViewRequirementAgentConnector_ms": 0.06602859497070312}}, "episode_reward_max": -10142.37363757697, "episode_reward_min": -10505.853789586594, "episode_reward_mean": -10297.408256061726, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10395.89593899529, -10208.398544332273, -10205.022079342301, -10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105, -10347.865590442256, -10494.127652948591, -10378.271153661508, -10486.215376611912, -10237.404043560799, -10165.994163249294, -10256.549219118442, -10222.763270961514, -10286.451951412399], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4280062037952455, "mean_inference_ms": 0.37132746970405456, "mean_action_processing_ms": 0.09123739733094353, "mean_env_wait_ms": 0.7383482498821706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034646987915039062, "StateBufferConnector_ms": 0.002534627914428711, "ViewRequirementAgentConnector_ms": 0.06602859497070312}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52258560, "num_agent_steps_trained": 52258560, "num_env_steps_sampled": 52258560, "num_env_steps_trained": 52258560, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 274.1716583769936, "num_env_steps_trained_throughput_per_sec": 274.1716583769936, "timesteps_total": 52258560, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52258560, "timers": {"training_iteration_time_ms": 4402.618, "sample_time_ms": 4369.977, "load_time_ms": 0.603, "load_throughput": 1990258.531, "learn_time_ms": 31.212, "learn_throughput": 38446.404, "synch_weights_time_ms": 0.775}, "counters": {"num_env_steps_sampled": 52258560, "num_env_steps_trained": 52258560, "num_agent_steps_sampled": 52258560, "num_agent_steps_trained": 52258560}, "done": false, "episodes_total": 13005, "training_iteration": 4091, "trial_id": "9f686_00000", "date": "2023-08-08_16-02-01", "timestamp": 1691499721, "time_this_iter_s": 13.133372068405151, "time_total_s": 96138.30848431587, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3054.13529753685, "iterations_since_restore": 231, "perf": {"cpu_util_percent": 18.352631578947367, "ram_util_percent": 65.49473684210527}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -370.0326114230686, "policy_loss": -2847802.387152778, "vf_loss": 20989827.305555556}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12501.5, "diff_num_grad_updates_vs_sampler_policy": 12500.5}}, "num_env_steps_sampled": 52262160, "num_env_steps_trained": 52262160, "num_agent_steps_sampled": 52262160, "num_agent_steps_trained": 52262160}, "sampler_results": {"episode_reward_max": -10142.37363757697, "episode_reward_min": -10505.853789586594, "episode_reward_mean": -10294.890533717653, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105, -10347.865590442256, -10494.127652948591, -10378.271153661508, -10486.215376611912, -10237.404043560799, -10165.994163249294, -10256.549219118442, -10222.763270961514, -10286.451951412399, -10213.13161281437, -10188.66885631587, -10155.743859132162], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4279740624635955, "mean_inference_ms": 0.3713247413545384, "mean_action_processing_ms": 0.09123735258611218, "mean_env_wait_ms": 0.738306198294879, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034618377685546875, "StateBufferConnector_ms": 0.002535581588745117, "ViewRequirementAgentConnector_ms": 0.06600236892700195}}, "episode_reward_max": -10142.37363757697, "episode_reward_min": -10505.853789586594, "episode_reward_mean": -10294.890533717653, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10349.728647450282, -10377.408010865604, -10192.98347552002, -10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105, -10347.865590442256, -10494.127652948591, -10378.271153661508, -10486.215376611912, -10237.404043560799, -10165.994163249294, -10256.549219118442, -10222.763270961514, -10286.451951412399, -10213.13161281437, -10188.66885631587, -10155.743859132162], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4279740624635955, "mean_inference_ms": 0.3713247413545384, "mean_action_processing_ms": 0.09123735258611218, "mean_env_wait_ms": 0.738306198294879, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034618377685546875, "StateBufferConnector_ms": 0.002535581588745117, "ViewRequirementAgentConnector_ms": 0.06600236892700195}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52262160, "num_agent_steps_trained": 52262160, "num_env_steps_sampled": 52262160, "num_env_steps_trained": 52262160, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 274.07439165336757, "num_env_steps_trained_throughput_per_sec": 274.07439165336757, "timesteps_total": 52262160, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52262160, "timers": {"training_iteration_time_ms": 4399.528, "sample_time_ms": 4366.685, "load_time_ms": 0.599, "load_throughput": 2001974.782, "learn_time_ms": 31.412, "learn_throughput": 38202.389, "synch_weights_time_ms": 0.782}, "counters": {"num_env_steps_sampled": 52262160, "num_env_steps_trained": 52262160, "num_agent_steps_sampled": 52262160, "num_agent_steps_trained": 52262160}, "done": false, "episodes_total": 13008, "training_iteration": 4092, "trial_id": "9f686_00000", "date": "2023-08-08_16-02-14", "timestamp": 1691499734, "time_this_iter_s": 13.13810682296753, "time_total_s": 96151.44659113884, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3067.2734043598175, "iterations_since_restore": 232, "perf": {"cpu_util_percent": 18.916666666666668, "ram_util_percent": 65.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -362.5148688422309, "policy_loss": -4310022.110243056, "vf_loss": 21357777.388888888}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12555.5, "diff_num_grad_updates_vs_sampler_policy": 12554.5}}, "num_env_steps_sampled": 52265760, "num_env_steps_trained": 52265760, "num_agent_steps_sampled": 52265760, "num_agent_steps_trained": 52265760}, "sampler_results": {"episode_reward_max": -10142.37363757697, "episode_reward_min": -10505.853789586594, "episode_reward_mean": -10293.940416982834, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105, -10347.865590442256, -10494.127652948591, -10378.271153661508, -10486.215376611912, -10237.404043560799, -10165.994163249294, -10256.549219118442, -10222.763270961514, -10286.451951412399, -10213.13161281437, -10188.66885631587, -10155.743859132162, -10230.185848561938, -10307.940138040069, -10286.982473752038], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.427942032672184, "mean_inference_ms": 0.3713229487747365, "mean_action_processing_ms": 0.09123771195632849, "mean_env_wait_ms": 0.7382635049995023, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034685134887695312, "StateBufferConnector_ms": 0.002527952194213867, "ViewRequirementAgentConnector_ms": 0.06604361534118652}}, "episode_reward_max": -10142.37363757697, "episode_reward_min": -10505.853789586594, "episode_reward_mean": -10293.940416982834, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10351.772389592912, -10236.337630819384, -10278.934528862286, -10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105, -10347.865590442256, -10494.127652948591, -10378.271153661508, -10486.215376611912, -10237.404043560799, -10165.994163249294, -10256.549219118442, -10222.763270961514, -10286.451951412399, -10213.13161281437, -10188.66885631587, -10155.743859132162, -10230.185848561938, -10307.940138040069, -10286.982473752038], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.427942032672184, "mean_inference_ms": 0.3713229487747365, "mean_action_processing_ms": 0.09123771195632849, "mean_env_wait_ms": 0.7382635049995023, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034685134887695312, "StateBufferConnector_ms": 0.002527952194213867, "ViewRequirementAgentConnector_ms": 0.06604361534118652}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52265760, "num_agent_steps_trained": 52265760, "num_env_steps_sampled": 52265760, "num_env_steps_trained": 52265760, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 273.55691810384576, "num_env_steps_trained_throughput_per_sec": 273.55691810384576, "timesteps_total": 52265760, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52265760, "timers": {"training_iteration_time_ms": 4380.12, "sample_time_ms": 4347.198, "load_time_ms": 0.596, "load_throughput": 2015039.154, "learn_time_ms": 31.492, "learn_throughput": 38104.835, "synch_weights_time_ms": 0.781}, "counters": {"num_env_steps_sampled": 52265760, "num_env_steps_trained": 52265760, "num_agent_steps_sampled": 52265760, "num_agent_steps_trained": 52265760}, "done": false, "episodes_total": 13011, "training_iteration": 4093, "trial_id": "9f686_00000", "date": "2023-08-08_16-02-27", "timestamp": 1691499747, "time_this_iter_s": 13.163142919540405, "time_total_s": 96164.60973405838, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3080.436547279358, "iterations_since_restore": 233, "perf": {"cpu_util_percent": 20.900000000000002, "ram_util_percent": 65.17894736842105}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -364.05995178222656, "policy_loss": -9434604.294270834, "vf_loss": 21883338.055555556}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12609.5, "diff_num_grad_updates_vs_sampler_policy": 12608.5}}, "num_env_steps_sampled": 52269360, "num_env_steps_trained": 52269360, "num_agent_steps_sampled": 52269360, "num_agent_steps_trained": 52269360}, "sampler_results": {"episode_reward_max": -10142.37363757697, "episode_reward_min": -10505.853789586594, "episode_reward_mean": -10294.81474070731, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105, -10347.865590442256, -10494.127652948591, -10378.271153661508, -10486.215376611912, -10237.404043560799, -10165.994163249294, -10256.549219118442, -10222.763270961514, -10286.451951412399, -10213.13161281437, -10188.66885631587, -10155.743859132162, -10230.185848561938, -10307.940138040069, -10286.982473752038, -10348.818747929152, -10255.97201849884, -10349.686155294161], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4279017933527705, "mean_inference_ms": 0.37132130208977543, "mean_action_processing_ms": 0.09123810615213973, "mean_env_wait_ms": 0.7382214187173135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034744739532470703, "StateBufferConnector_ms": 0.002522706985473633, "ViewRequirementAgentConnector_ms": 0.06601214408874512}}, "episode_reward_max": -10142.37363757697, "episode_reward_min": -10505.853789586594, "episode_reward_mean": -10294.81474070731, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10470.481141057684, -10388.653388481733, -10343.068564452773, -10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105, -10347.865590442256, -10494.127652948591, -10378.271153661508, -10486.215376611912, -10237.404043560799, -10165.994163249294, -10256.549219118442, -10222.763270961514, -10286.451951412399, -10213.13161281437, -10188.66885631587, -10155.743859132162, -10230.185848561938, -10307.940138040069, -10286.982473752038, -10348.818747929152, -10255.97201849884, -10349.686155294161], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4279017933527705, "mean_inference_ms": 0.37132130208977543, "mean_action_processing_ms": 0.09123810615213973, "mean_env_wait_ms": 0.7382214187173135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034744739532470703, "StateBufferConnector_ms": 0.002522706985473633, "ViewRequirementAgentConnector_ms": 0.06601214408874512}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52269360, "num_agent_steps_trained": 52269360, "num_env_steps_sampled": 52269360, "num_env_steps_trained": 52269360, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 277.5862329825439, "num_env_steps_trained_throughput_per_sec": 277.5862329825439, "timesteps_total": 52269360, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52269360, "timers": {"training_iteration_time_ms": 4367.231, "sample_time_ms": 4334.498, "load_time_ms": 0.575, "load_throughput": 2087151.068, "learn_time_ms": 31.337, "learn_throughput": 38293.684, "synch_weights_time_ms": 0.768}, "counters": {"num_env_steps_sampled": 52269360, "num_env_steps_trained": 52269360, "num_agent_steps_sampled": 52269360, "num_agent_steps_trained": 52269360}, "done": false, "episodes_total": 13014, "training_iteration": 4094, "trial_id": "9f686_00000", "date": "2023-08-08_16-02-40", "timestamp": 1691499760, "time_this_iter_s": 12.971763849258423, "time_total_s": 96177.58149790764, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3093.4083111286163, "iterations_since_restore": 234, "perf": {"cpu_util_percent": 21.416666666666664, "ram_util_percent": 64.88888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -362.06931559244794, "policy_loss": -6161601.909722222, "vf_loss": 21472184.111111112}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12663.5, "diff_num_grad_updates_vs_sampler_policy": 12662.5}}, "num_env_steps_sampled": 52272960, "num_env_steps_trained": 52272960, "num_agent_steps_sampled": 52272960, "num_agent_steps_trained": 52272960}, "sampler_results": {"episode_reward_max": -10142.37363757697, "episode_reward_min": -10505.853789586594, "episode_reward_mean": -10291.4075511847, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105, -10347.865590442256, -10494.127652948591, -10378.271153661508, -10486.215376611912, -10237.404043560799, -10165.994163249294, -10256.549219118442, -10222.763270961514, -10286.451951412399, -10213.13161281437, -10188.66885631587, -10155.743859132162, -10230.185848561938, -10307.940138040069, -10286.982473752038, -10348.818747929152, -10255.97201849884, -10349.686155294161, -10285.86594895591, -10258.61654528074, -10317.001647494477], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.427855903906803, "mean_inference_ms": 0.3713202806881749, "mean_action_processing_ms": 0.09123856196799458, "mean_env_wait_ms": 0.7381792150011887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034749507904052734, "StateBufferConnector_ms": 0.0025167465209960938, "ViewRequirementAgentConnector_ms": 0.0659785270690918}}, "episode_reward_max": -10142.37363757697, "episode_reward_min": -10505.853789586594, "episode_reward_mean": -10291.4075511847, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10225.958781403277, -10324.3125006272, -10284.772631425041, -10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105, -10347.865590442256, -10494.127652948591, -10378.271153661508, -10486.215376611912, -10237.404043560799, -10165.994163249294, -10256.549219118442, -10222.763270961514, -10286.451951412399, -10213.13161281437, -10188.66885631587, -10155.743859132162, -10230.185848561938, -10307.940138040069, -10286.982473752038, -10348.818747929152, -10255.97201849884, -10349.686155294161, -10285.86594895591, -10258.61654528074, -10317.001647494477], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.427855903906803, "mean_inference_ms": 0.3713202806881749, "mean_action_processing_ms": 0.09123856196799458, "mean_env_wait_ms": 0.7381792150011887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034749507904052734, "StateBufferConnector_ms": 0.0025167465209960938, "ViewRequirementAgentConnector_ms": 0.0659785270690918}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52272960, "num_agent_steps_trained": 52272960, "num_env_steps_sampled": 52272960, "num_env_steps_trained": 52272960, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 278.3997313112945, "num_env_steps_trained_throughput_per_sec": 278.3997313112945, "timesteps_total": 52272960, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52272960, "timers": {"training_iteration_time_ms": 4339.609, "sample_time_ms": 4306.969, "load_time_ms": 0.575, "load_throughput": 2087583.907, "learn_time_ms": 31.216, "learn_throughput": 38441.823, "synch_weights_time_ms": 0.796}, "counters": {"num_env_steps_sampled": 52272960, "num_env_steps_trained": 52272960, "num_agent_steps_sampled": 52272960, "num_agent_steps_trained": 52272960}, "done": false, "episodes_total": 13017, "training_iteration": 4095, "trial_id": "9f686_00000", "date": "2023-08-08_16-02-53", "timestamp": 1691499773, "time_this_iter_s": 12.933919906616211, "time_total_s": 96190.51541781425, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3106.3422310352325, "iterations_since_restore": 235, "perf": {"cpu_util_percent": 22.826315789473682, "ram_util_percent": 65.13684210526316}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -361.84175788031683, "policy_loss": -6364449.940972222, "vf_loss": 21318038.305555556}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12717.5, "diff_num_grad_updates_vs_sampler_policy": 12716.5}}, "num_env_steps_sampled": 52276560, "num_env_steps_trained": 52276560, "num_agent_steps_sampled": 52276560, "num_agent_steps_trained": 52276560}, "sampler_results": {"episode_reward_max": -10142.37363757697, "episode_reward_min": -10505.853789586594, "episode_reward_mean": -10293.643867952029, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105, -10347.865590442256, -10494.127652948591, -10378.271153661508, -10486.215376611912, -10237.404043560799, -10165.994163249294, -10256.549219118442, -10222.763270961514, -10286.451951412399, -10213.13161281437, -10188.66885631587, -10155.743859132162, -10230.185848561938, -10307.940138040069, -10286.982473752038, -10348.818747929152, -10255.97201849884, -10349.686155294161, -10285.86594895591, -10258.61654528074, -10317.001647494477, -10442.974334206052, -10359.67668416925, -10256.024571813316], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.427800082073134, "mean_inference_ms": 0.3713191758738922, "mean_action_processing_ms": 0.09123904943623039, "mean_env_wait_ms": 0.7381381049404865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003477811813354492, "StateBufferConnector_ms": 0.0025131702423095703, "ViewRequirementAgentConnector_ms": 0.065887451171875}}, "episode_reward_max": -10142.37363757697, "episode_reward_min": -10505.853789586594, "episode_reward_mean": -10293.643867952029, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10321.072606427248, -10256.321805816653, -10300.254406161012, -10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105, -10347.865590442256, -10494.127652948591, -10378.271153661508, -10486.215376611912, -10237.404043560799, -10165.994163249294, -10256.549219118442, -10222.763270961514, -10286.451951412399, -10213.13161281437, -10188.66885631587, -10155.743859132162, -10230.185848561938, -10307.940138040069, -10286.982473752038, -10348.818747929152, -10255.97201849884, -10349.686155294161, -10285.86594895591, -10258.61654528074, -10317.001647494477, -10442.974334206052, -10359.67668416925, -10256.024571813316], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.427800082073134, "mean_inference_ms": 0.3713191758738922, "mean_action_processing_ms": 0.09123904943623039, "mean_env_wait_ms": 0.7381381049404865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003477811813354492, "StateBufferConnector_ms": 0.0025131702423095703, "ViewRequirementAgentConnector_ms": 0.065887451171875}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52276560, "num_agent_steps_trained": 52276560, "num_env_steps_sampled": 52276560, "num_env_steps_trained": 52276560, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 278.15932239446533, "num_env_steps_trained_throughput_per_sec": 278.15932239446533, "timesteps_total": 52276560, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52276560, "timers": {"training_iteration_time_ms": 4315.172, "sample_time_ms": 4282.35, "load_time_ms": 0.578, "load_throughput": 2076131.172, "learn_time_ms": 31.404, "learn_throughput": 38211.438, "synch_weights_time_ms": 0.787}, "counters": {"num_env_steps_sampled": 52276560, "num_env_steps_trained": 52276560, "num_agent_steps_sampled": 52276560, "num_agent_steps_trained": 52276560}, "done": false, "episodes_total": 13020, "training_iteration": 4096, "trial_id": "9f686_00000", "date": "2023-08-08_16-03-06", "timestamp": 1691499786, "time_this_iter_s": 12.945103883743286, "time_total_s": 96203.460521698, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3119.287334918976, "iterations_since_restore": 236, "perf": {"cpu_util_percent": 21.777777777777775, "ram_util_percent": 65.0611111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -364.3678266737196, "policy_loss": -9319686.034722222, "vf_loss": 21794249.333333332}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12771.5, "diff_num_grad_updates_vs_sampler_policy": 12770.5}}, "num_env_steps_sampled": 52280160, "num_env_steps_trained": 52280160, "num_agent_steps_sampled": 52280160, "num_agent_steps_trained": 52280160}, "sampler_results": {"episode_reward_max": -10142.37363757697, "episode_reward_min": -10505.853789586594, "episode_reward_mean": -10293.89850286742, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105, -10347.865590442256, -10494.127652948591, -10378.271153661508, -10486.215376611912, -10237.404043560799, -10165.994163249294, -10256.549219118442, -10222.763270961514, -10286.451951412399, -10213.13161281437, -10188.66885631587, -10155.743859132162, -10230.185848561938, -10307.940138040069, -10286.982473752038, -10348.818747929152, -10255.97201849884, -10349.686155294161, -10285.86594895591, -10258.61654528074, -10317.001647494477, -10442.974334206052, -10359.67668416925, -10256.024571813316, -10310.665713289325, -10227.407575045285, -10365.03902160944], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4277372597138624, "mean_inference_ms": 0.37131790653545443, "mean_action_processing_ms": 0.09123950373638365, "mean_env_wait_ms": 0.7380963540551154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034482479095458984, "StateBufferConnector_ms": 0.0025124549865722656, "ViewRequirementAgentConnector_ms": 0.06600141525268555}}, "episode_reward_max": -10142.37363757697, "episode_reward_min": -10505.853789586594, "episode_reward_mean": -10293.89850286742, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10281.90058873829, -10271.848028012044, -10250.162430354589, -10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105, -10347.865590442256, -10494.127652948591, -10378.271153661508, -10486.215376611912, -10237.404043560799, -10165.994163249294, -10256.549219118442, -10222.763270961514, -10286.451951412399, -10213.13161281437, -10188.66885631587, -10155.743859132162, -10230.185848561938, -10307.940138040069, -10286.982473752038, -10348.818747929152, -10255.97201849884, -10349.686155294161, -10285.86594895591, -10258.61654528074, -10317.001647494477, -10442.974334206052, -10359.67668416925, -10256.024571813316, -10310.665713289325, -10227.407575045285, -10365.03902160944], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4277372597138624, "mean_inference_ms": 0.37131790653545443, "mean_action_processing_ms": 0.09123950373638365, "mean_env_wait_ms": 0.7380963540551154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034482479095458984, "StateBufferConnector_ms": 0.0025124549865722656, "ViewRequirementAgentConnector_ms": 0.06600141525268555}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52280160, "num_agent_steps_trained": 52280160, "num_env_steps_sampled": 52280160, "num_env_steps_trained": 52280160, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 275.8098211896109, "num_env_steps_trained_throughput_per_sec": 275.8098211896109, "timesteps_total": 52280160, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52280160, "timers": {"training_iteration_time_ms": 4326.155, "sample_time_ms": 4293.054, "load_time_ms": 0.58, "load_throughput": 2070664.747, "learn_time_ms": 31.679, "learn_throughput": 37879.914, "synch_weights_time_ms": 0.794}, "counters": {"num_env_steps_sampled": 52280160, "num_env_steps_trained": 52280160, "num_agent_steps_sampled": 52280160, "num_agent_steps_trained": 52280160}, "done": false, "episodes_total": 13023, "training_iteration": 4097, "trial_id": "9f686_00000", "date": "2023-08-08_16-03-19", "timestamp": 1691499799, "time_this_iter_s": 13.055303812026978, "time_total_s": 96216.51582551003, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3132.342638731003, "iterations_since_restore": 237, "perf": {"cpu_util_percent": 20.200000000000003, "ram_util_percent": 65.07222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -366.4122568766276, "policy_loss": -3861604.925347222, "vf_loss": 21335240.055555556}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12825.5, "diff_num_grad_updates_vs_sampler_policy": 12824.5}}, "num_env_steps_sampled": 52283760, "num_env_steps_trained": 52283760, "num_agent_steps_sampled": 52283760, "num_agent_steps_trained": 52283760}, "sampler_results": {"episode_reward_max": -10142.37363757697, "episode_reward_min": -10505.853789586594, "episode_reward_mean": -10292.539633913515, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105, -10347.865590442256, -10494.127652948591, -10378.271153661508, -10486.215376611912, -10237.404043560799, -10165.994163249294, -10256.549219118442, -10222.763270961514, -10286.451951412399, -10213.13161281437, -10188.66885631587, -10155.743859132162, -10230.185848561938, -10307.940138040069, -10286.982473752038, -10348.818747929152, -10255.97201849884, -10349.686155294161, -10285.86594895591, -10258.61654528074, -10317.001647494477, -10442.974334206052, -10359.67668416925, -10256.024571813316, -10310.665713289325, -10227.407575045285, -10365.03902160944, -10233.641164649478, -10200.106943486699, -10234.276043578178], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.427670014379169, "mean_inference_ms": 0.3713167118937474, "mean_action_processing_ms": 0.09123993637906214, "mean_env_wait_ms": 0.7380530066125638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034461021423339844, "StateBufferConnector_ms": 0.0025072097778320312, "ViewRequirementAgentConnector_ms": 0.06605100631713867}}, "episode_reward_max": -10142.37363757697, "episode_reward_min": -10505.853789586594, "episode_reward_mean": -10292.539633913515, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10310.90317288181, -10235.9820594951, -10373.360650170625, -10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105, -10347.865590442256, -10494.127652948591, -10378.271153661508, -10486.215376611912, -10237.404043560799, -10165.994163249294, -10256.549219118442, -10222.763270961514, -10286.451951412399, -10213.13161281437, -10188.66885631587, -10155.743859132162, -10230.185848561938, -10307.940138040069, -10286.982473752038, -10348.818747929152, -10255.97201849884, -10349.686155294161, -10285.86594895591, -10258.61654528074, -10317.001647494477, -10442.974334206052, -10359.67668416925, -10256.024571813316, -10310.665713289325, -10227.407575045285, -10365.03902160944, -10233.641164649478, -10200.106943486699, -10234.276043578178], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.427670014379169, "mean_inference_ms": 0.3713167118937474, "mean_action_processing_ms": 0.09123993637906214, "mean_env_wait_ms": 0.7380530066125638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034461021423339844, "StateBufferConnector_ms": 0.0025072097778320312, "ViewRequirementAgentConnector_ms": 0.06605100631713867}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52283760, "num_agent_steps_trained": 52283760, "num_env_steps_sampled": 52283760, "num_env_steps_trained": 52283760, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 276.7671509869068, "num_env_steps_trained_throughput_per_sec": 276.7671509869068, "timesteps_total": 52283760, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52283760, "timers": {"training_iteration_time_ms": 4327.921, "sample_time_ms": 4294.632, "load_time_ms": 0.579, "load_throughput": 2072113.956, "learn_time_ms": 31.867, "learn_throughput": 37656.647, "synch_weights_time_ms": 0.792}, "counters": {"num_env_steps_sampled": 52283760, "num_env_steps_trained": 52283760, "num_agent_steps_sampled": 52283760, "num_agent_steps_trained": 52283760}, "done": false, "episodes_total": 13026, "training_iteration": 4098, "trial_id": "9f686_00000", "date": "2023-08-08_16-03-32", "timestamp": 1691499812, "time_this_iter_s": 13.010334968566895, "time_total_s": 96229.52616047859, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3145.3529736995697, "iterations_since_restore": 238, "perf": {"cpu_util_percent": 20.826315789473682, "ram_util_percent": 65.26842105263157}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -365.9984402126736, "policy_loss": -7339073.036458333, "vf_loss": 21638345.166666668}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12879.5, "diff_num_grad_updates_vs_sampler_policy": 12878.5}}, "num_env_steps_sampled": 52287360, "num_env_steps_trained": 52287360, "num_agent_steps_sampled": 52287360, "num_agent_steps_trained": 52287360}, "sampler_results": {"episode_reward_max": -10142.37363757697, "episode_reward_min": -10505.853789586594, "episode_reward_mean": -10291.903892627872, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105, -10347.865590442256, -10494.127652948591, -10378.271153661508, -10486.215376611912, -10237.404043560799, -10165.994163249294, -10256.549219118442, -10222.763270961514, -10286.451951412399, -10213.13161281437, -10188.66885631587, -10155.743859132162, -10230.185848561938, -10307.940138040069, -10286.982473752038, -10348.818747929152, -10255.97201849884, -10349.686155294161, -10285.86594895591, -10258.61654528074, -10317.001647494477, -10442.974334206052, -10359.67668416925, -10256.024571813316, -10310.665713289325, -10227.407575045285, -10365.03902160944, -10233.641164649478, -10200.106943486699, -10234.276043578178, -10252.52206434896, -10296.427550620718, -10307.722139013475], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.427595422144059, "mean_inference_ms": 0.3713154850589379, "mean_action_processing_ms": 0.0912403464811729, "mean_env_wait_ms": 0.738008494588669, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003437519073486328, "StateBufferConnector_ms": 0.0024938583374023438, "ViewRequirementAgentConnector_ms": 0.0659642219543457}}, "episode_reward_max": -10142.37363757697, "episode_reward_min": -10505.853789586594, "episode_reward_mean": -10291.903892627872, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10286.225599874191, -10168.395935876208, -10239.181569617083, -10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105, -10347.865590442256, -10494.127652948591, -10378.271153661508, -10486.215376611912, -10237.404043560799, -10165.994163249294, -10256.549219118442, -10222.763270961514, -10286.451951412399, -10213.13161281437, -10188.66885631587, -10155.743859132162, -10230.185848561938, -10307.940138040069, -10286.982473752038, -10348.818747929152, -10255.97201849884, -10349.686155294161, -10285.86594895591, -10258.61654528074, -10317.001647494477, -10442.974334206052, -10359.67668416925, -10256.024571813316, -10310.665713289325, -10227.407575045285, -10365.03902160944, -10233.641164649478, -10200.106943486699, -10234.276043578178, -10252.52206434896, -10296.427550620718, -10307.722139013475], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.427595422144059, "mean_inference_ms": 0.3713154850589379, "mean_action_processing_ms": 0.0912403464811729, "mean_env_wait_ms": 0.738008494588669, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003437519073486328, "StateBufferConnector_ms": 0.0024938583374023438, "ViewRequirementAgentConnector_ms": 0.0659642219543457}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52287360, "num_agent_steps_trained": 52287360, "num_env_steps_sampled": 52287360, "num_env_steps_trained": 52287360, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 277.42806095434554, "num_env_steps_trained_throughput_per_sec": 277.42806095434554, "timesteps_total": 52287360, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52287360, "timers": {"training_iteration_time_ms": 4333.99, "sample_time_ms": 4300.633, "load_time_ms": 0.578, "load_throughput": 2076131.172, "learn_time_ms": 31.936, "learn_throughput": 37575.485, "synch_weights_time_ms": 0.793}, "counters": {"num_env_steps_sampled": 52287360, "num_env_steps_trained": 52287360, "num_agent_steps_sampled": 52287360, "num_agent_steps_trained": 52287360}, "done": false, "episodes_total": 13029, "training_iteration": 4099, "trial_id": "9f686_00000", "date": "2023-08-08_16-03-45", "timestamp": 1691499825, "time_this_iter_s": 12.97920823097229, "time_total_s": 96242.50536870956, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3158.332181930542, "iterations_since_restore": 239, "perf": {"cpu_util_percent": 21.6, "ram_util_percent": 65.34444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -361.54034254286023, "policy_loss": -17743293.46875, "vf_loss": 22164452.833333332}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12933.5, "diff_num_grad_updates_vs_sampler_policy": 12932.5}}, "num_env_steps_sampled": 52290960, "num_env_steps_trained": 52290960, "num_agent_steps_sampled": 52290960, "num_agent_steps_trained": 52290960}, "sampler_results": {"episode_reward_max": -10142.37363757697, "episode_reward_min": -10505.853789586594, "episode_reward_mean": -10295.876995433222, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105, -10347.865590442256, -10494.127652948591, -10378.271153661508, -10486.215376611912, -10237.404043560799, -10165.994163249294, -10256.549219118442, -10222.763270961514, -10286.451951412399, -10213.13161281437, -10188.66885631587, -10155.743859132162, -10230.185848561938, -10307.940138040069, -10286.982473752038, -10348.818747929152, -10255.97201849884, -10349.686155294161, -10285.86594895591, -10258.61654528074, -10317.001647494477, -10442.974334206052, -10359.67668416925, -10256.024571813316, -10310.665713289325, -10227.407575045285, -10365.03902160944, -10233.641164649478, -10200.106943486699, -10234.276043578178, -10252.52206434896, -10296.427550620718, -10307.722139013475, -10323.550039613632, -10302.736835020347, -10464.826511268471], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4275187048499918, "mean_inference_ms": 0.3713142231080739, "mean_action_processing_ms": 0.09124074616472798, "mean_env_wait_ms": 0.7379680296745825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00344085693359375, "StateBufferConnector_ms": 0.002497434616088867, "ViewRequirementAgentConnector_ms": 0.0659945011138916}}, "episode_reward_max": -10142.37363757697, "episode_reward_min": -10505.853789586594, "episode_reward_mean": -10295.876995433222, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10260.612003536844, -10207.027992242096, -10264.773598248037, -10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105, -10347.865590442256, -10494.127652948591, -10378.271153661508, -10486.215376611912, -10237.404043560799, -10165.994163249294, -10256.549219118442, -10222.763270961514, -10286.451951412399, -10213.13161281437, -10188.66885631587, -10155.743859132162, -10230.185848561938, -10307.940138040069, -10286.982473752038, -10348.818747929152, -10255.97201849884, -10349.686155294161, -10285.86594895591, -10258.61654528074, -10317.001647494477, -10442.974334206052, -10359.67668416925, -10256.024571813316, -10310.665713289325, -10227.407575045285, -10365.03902160944, -10233.641164649478, -10200.106943486699, -10234.276043578178, -10252.52206434896, -10296.427550620718, -10307.722139013475, -10323.550039613632, -10302.736835020347, -10464.826511268471], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4275187048499918, "mean_inference_ms": 0.3713142231080739, "mean_action_processing_ms": 0.09124074616472798, "mean_env_wait_ms": 0.7379680296745825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00344085693359375, "StateBufferConnector_ms": 0.002497434616088867, "ViewRequirementAgentConnector_ms": 0.0659945011138916}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52290960, "num_agent_steps_trained": 52290960, "num_env_steps_sampled": 52290960, "num_env_steps_trained": 52290960, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 272.2692637720614, "num_env_steps_trained_throughput_per_sec": 272.2692637720614, "timesteps_total": 52290960, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52290960, "timers": {"training_iteration_time_ms": 4357.21, "sample_time_ms": 4323.895, "load_time_ms": 0.579, "load_throughput": 2072540.581, "learn_time_ms": 31.894, "learn_throughput": 37624.612, "synch_weights_time_ms": 0.793}, "counters": {"num_env_steps_sampled": 52290960, "num_env_steps_trained": 52290960, "num_agent_steps_sampled": 52290960, "num_agent_steps_trained": 52290960}, "done": false, "episodes_total": 13032, "training_iteration": 4100, "trial_id": "9f686_00000", "date": "2023-08-08_16-03-58", "timestamp": 1691499838, "time_this_iter_s": 13.225076913833618, "time_total_s": 96255.7304456234, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3171.5572588443756, "iterations_since_restore": 240, "perf": {"cpu_util_percent": 20.49473684210526, "ram_util_percent": 65.47368421052632}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -361.96280076768664, "policy_loss": -6311627.540798611, "vf_loss": 21316781.833333332}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12987.5, "diff_num_grad_updates_vs_sampler_policy": 12986.5}}, "num_env_steps_sampled": 52294560, "num_env_steps_trained": 52294560, "num_agent_steps_sampled": 52294560, "num_agent_steps_trained": 52294560}, "sampler_results": {"episode_reward_max": -10142.37363757697, "episode_reward_min": -10505.853789586594, "episode_reward_mean": -10296.208729364545, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105, -10347.865590442256, -10494.127652948591, -10378.271153661508, -10486.215376611912, -10237.404043560799, -10165.994163249294, -10256.549219118442, -10222.763270961514, -10286.451951412399, -10213.13161281437, -10188.66885631587, -10155.743859132162, -10230.185848561938, -10307.940138040069, -10286.982473752038, -10348.818747929152, -10255.97201849884, -10349.686155294161, -10285.86594895591, -10258.61654528074, -10317.001647494477, -10442.974334206052, -10359.67668416925, -10256.024571813316, -10310.665713289325, -10227.407575045285, -10365.03902160944, -10233.641164649478, -10200.106943486699, -10234.276043578178, -10252.52206434896, -10296.427550620718, -10307.722139013475, -10323.550039613632, -10302.736835020347, -10464.826511268471, -10186.453274958129, -10327.645199561208, -10251.488512639846], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.42743362006245, "mean_inference_ms": 0.3713130579041321, "mean_action_processing_ms": 0.09124115763201747, "mean_env_wait_ms": 0.7379263484334169, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00344085693359375, "StateBufferConnector_ms": 0.0024957656860351562, "ViewRequirementAgentConnector_ms": 0.06604957580566406}}, "episode_reward_max": -10142.37363757697, "episode_reward_min": -10505.853789586594, "episode_reward_mean": -10296.208729364545, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10422.31678633658, -10291.461271938982, -10288.44666315535, -10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105, -10347.865590442256, -10494.127652948591, -10378.271153661508, -10486.215376611912, -10237.404043560799, -10165.994163249294, -10256.549219118442, -10222.763270961514, -10286.451951412399, -10213.13161281437, -10188.66885631587, -10155.743859132162, -10230.185848561938, -10307.940138040069, -10286.982473752038, -10348.818747929152, -10255.97201849884, -10349.686155294161, -10285.86594895591, -10258.61654528074, -10317.001647494477, -10442.974334206052, -10359.67668416925, -10256.024571813316, -10310.665713289325, -10227.407575045285, -10365.03902160944, -10233.641164649478, -10200.106943486699, -10234.276043578178, -10252.52206434896, -10296.427550620718, -10307.722139013475, -10323.550039613632, -10302.736835020347, -10464.826511268471, -10186.453274958129, -10327.645199561208, -10251.488512639846], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.42743362006245, "mean_inference_ms": 0.3713130579041321, "mean_action_processing_ms": 0.09124115763201747, "mean_env_wait_ms": 0.7379263484334169, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00344085693359375, "StateBufferConnector_ms": 0.0024957656860351562, "ViewRequirementAgentConnector_ms": 0.06604957580566406}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52294560, "num_agent_steps_trained": 52294560, "num_env_steps_sampled": 52294560, "num_env_steps_trained": 52294560, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 280.96678959964555, "num_env_steps_trained_throughput_per_sec": 280.96678959964555, "timesteps_total": 52294560, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52294560, "timers": {"training_iteration_time_ms": 4326.778, "sample_time_ms": 4293.67, "load_time_ms": 0.579, "load_throughput": 2071687.508, "learn_time_ms": 31.715, "learn_throughput": 37836.659, "synch_weights_time_ms": 0.764}, "counters": {"num_env_steps_sampled": 52294560, "num_env_steps_trained": 52294560, "num_agent_steps_sampled": 52294560, "num_agent_steps_trained": 52294560}, "done": false, "episodes_total": 13035, "training_iteration": 4101, "trial_id": "9f686_00000", "date": "2023-08-08_16-04-11", "timestamp": 1691499851, "time_this_iter_s": 12.815804243087769, "time_total_s": 96268.54624986649, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3184.3730630874634, "iterations_since_restore": 241, "perf": {"cpu_util_percent": 22.261111111111113, "ram_util_percent": 65.23888888888888}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -361.5599483913845, "policy_loss": -8658624.532986112, "vf_loss": 21993877.166666668}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13041.5, "diff_num_grad_updates_vs_sampler_policy": 13040.5}}, "num_env_steps_sampled": 52298160, "num_env_steps_trained": 52298160, "num_agent_steps_sampled": 52298160, "num_agent_steps_trained": 52298160}, "sampler_results": {"episode_reward_max": -10142.37363757697, "episode_reward_min": -10505.853789586594, "episode_reward_mean": -10295.270362234447, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105, -10347.865590442256, -10494.127652948591, -10378.271153661508, -10486.215376611912, -10237.404043560799, -10165.994163249294, -10256.549219118442, -10222.763270961514, -10286.451951412399, -10213.13161281437, -10188.66885631587, -10155.743859132162, -10230.185848561938, -10307.940138040069, -10286.982473752038, -10348.818747929152, -10255.97201849884, -10349.686155294161, -10285.86594895591, -10258.61654528074, -10317.001647494477, -10442.974334206052, -10359.67668416925, -10256.024571813316, -10310.665713289325, -10227.407575045285, -10365.03902160944, -10233.641164649478, -10200.106943486699, -10234.276043578178, -10252.52206434896, -10296.427550620718, -10307.722139013475, -10323.550039613632, -10302.736835020347, -10464.826511268471, -10186.453274958129, -10327.645199561208, -10251.488512639846, -10299.11150545407, -10186.978301361063, -10422.298201606058], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4273508376250637, "mean_inference_ms": 0.37131159029216065, "mean_action_processing_ms": 0.09124154292482346, "mean_env_wait_ms": 0.7378846890734765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034494400024414062, "StateBufferConnector_ms": 0.002493143081665039, "ViewRequirementAgentConnector_ms": 0.06608057022094727}}, "episode_reward_max": -10142.37363757697, "episode_reward_min": -10505.853789586594, "episode_reward_mean": -10295.270362234447, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10347.08907740264, -10255.586561996452, -10233.30285068095, -10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105, -10347.865590442256, -10494.127652948591, -10378.271153661508, -10486.215376611912, -10237.404043560799, -10165.994163249294, -10256.549219118442, -10222.763270961514, -10286.451951412399, -10213.13161281437, -10188.66885631587, -10155.743859132162, -10230.185848561938, -10307.940138040069, -10286.982473752038, -10348.818747929152, -10255.97201849884, -10349.686155294161, -10285.86594895591, -10258.61654528074, -10317.001647494477, -10442.974334206052, -10359.67668416925, -10256.024571813316, -10310.665713289325, -10227.407575045285, -10365.03902160944, -10233.641164649478, -10200.106943486699, -10234.276043578178, -10252.52206434896, -10296.427550620718, -10307.722139013475, -10323.550039613632, -10302.736835020347, -10464.826511268471, -10186.453274958129, -10327.645199561208, -10251.488512639846, -10299.11150545407, -10186.978301361063, -10422.298201606058], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4273508376250637, "mean_inference_ms": 0.37131159029216065, "mean_action_processing_ms": 0.09124154292482346, "mean_env_wait_ms": 0.7378846890734765, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034494400024414062, "StateBufferConnector_ms": 0.002493143081665039, "ViewRequirementAgentConnector_ms": 0.06608057022094727}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52298160, "num_agent_steps_trained": 52298160, "num_env_steps_sampled": 52298160, "num_env_steps_trained": 52298160, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 271.5242385036564, "num_env_steps_trained_throughput_per_sec": 271.5242385036564, "timesteps_total": 52298160, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52298160, "timers": {"training_iteration_time_ms": 4365.515, "sample_time_ms": 4332.606, "load_time_ms": 0.577, "load_throughput": 2078531.819, "learn_time_ms": 31.501, "learn_throughput": 38093.905, "synch_weights_time_ms": 0.781}, "counters": {"num_env_steps_sampled": 52298160, "num_env_steps_trained": 52298160, "num_agent_steps_sampled": 52298160, "num_agent_steps_trained": 52298160}, "done": false, "episodes_total": 13038, "training_iteration": 4102, "trial_id": "9f686_00000", "date": "2023-08-08_16-04-24", "timestamp": 1691499864, "time_this_iter_s": 13.261425256729126, "time_total_s": 96281.80767512321, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3197.6344883441925, "iterations_since_restore": 242, "perf": {"cpu_util_percent": 19.821052631578947, "ram_util_percent": 65.1736842105263}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -363.7091132269965, "policy_loss": -10819817.612847222, "vf_loss": 21264792.527777776}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13095.5, "diff_num_grad_updates_vs_sampler_policy": 13094.5}}, "num_env_steps_sampled": 52301760, "num_env_steps_trained": 52301760, "num_agent_steps_sampled": 52301760, "num_agent_steps_trained": 52301760}, "sampler_results": {"episode_reward_max": -10142.37363757697, "episode_reward_min": -10505.853789586594, "episode_reward_mean": -10294.071908342696, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105, -10347.865590442256, -10494.127652948591, -10378.271153661508, -10486.215376611912, -10237.404043560799, -10165.994163249294, -10256.549219118442, -10222.763270961514, -10286.451951412399, -10213.13161281437, -10188.66885631587, -10155.743859132162, -10230.185848561938, -10307.940138040069, -10286.982473752038, -10348.818747929152, -10255.97201849884, -10349.686155294161, -10285.86594895591, -10258.61654528074, -10317.001647494477, -10442.974334206052, -10359.67668416925, -10256.024571813316, -10310.665713289325, -10227.407575045285, -10365.03902160944, -10233.641164649478, -10200.106943486699, -10234.276043578178, -10252.52206434896, -10296.427550620718, -10307.722139013475, -10323.550039613632, -10302.736835020347, -10464.826511268471, -10186.453274958129, -10327.645199561208, -10251.488512639846, -10299.11150545407, -10186.978301361063, -10422.298201606058, -10203.978862128635, -10279.326384951695, -10232.82785382455], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.427268419648255, "mean_inference_ms": 0.37131023623470405, "mean_action_processing_ms": 0.09124194443171862, "mean_env_wait_ms": 0.737842306479505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003453969955444336, "StateBufferConnector_ms": 0.002497434616088867, "ViewRequirementAgentConnector_ms": 0.06609964370727539}}, "episode_reward_max": -10142.37363757697, "episode_reward_min": -10505.853789586594, "episode_reward_mean": -10294.071908342696, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10297.388140089704, -10324.812967375336, -10371.799281373178, -10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105, -10347.865590442256, -10494.127652948591, -10378.271153661508, -10486.215376611912, -10237.404043560799, -10165.994163249294, -10256.549219118442, -10222.763270961514, -10286.451951412399, -10213.13161281437, -10188.66885631587, -10155.743859132162, -10230.185848561938, -10307.940138040069, -10286.982473752038, -10348.818747929152, -10255.97201849884, -10349.686155294161, -10285.86594895591, -10258.61654528074, -10317.001647494477, -10442.974334206052, -10359.67668416925, -10256.024571813316, -10310.665713289325, -10227.407575045285, -10365.03902160944, -10233.641164649478, -10200.106943486699, -10234.276043578178, -10252.52206434896, -10296.427550620718, -10307.722139013475, -10323.550039613632, -10302.736835020347, -10464.826511268471, -10186.453274958129, -10327.645199561208, -10251.488512639846, -10299.11150545407, -10186.978301361063, -10422.298201606058, -10203.978862128635, -10279.326384951695, -10232.82785382455], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.427268419648255, "mean_inference_ms": 0.37131023623470405, "mean_action_processing_ms": 0.09124194443171862, "mean_env_wait_ms": 0.737842306479505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003453969955444336, "StateBufferConnector_ms": 0.002497434616088867, "ViewRequirementAgentConnector_ms": 0.06609964370727539}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52301760, "num_agent_steps_trained": 52301760, "num_env_steps_sampled": 52301760, "num_env_steps_trained": 52301760, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 274.37855401403556, "num_env_steps_trained_throughput_per_sec": 274.37855401403556, "timesteps_total": 52301760, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52301760, "timers": {"training_iteration_time_ms": 4361.366, "sample_time_ms": 4328.924, "load_time_ms": 0.572, "load_throughput": 2099601.535, "learn_time_ms": 31.065, "learn_throughput": 38628.401, "synch_weights_time_ms": 0.756}, "counters": {"num_env_steps_sampled": 52301760, "num_env_steps_trained": 52301760, "num_agent_steps_sampled": 52301760, "num_agent_steps_trained": 52301760}, "done": false, "episodes_total": 13041, "training_iteration": 4103, "trial_id": "9f686_00000", "date": "2023-08-08_16-04-38", "timestamp": 1691499878, "time_this_iter_s": 13.123430967330933, "time_total_s": 96294.93110609055, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3210.7579193115234, "iterations_since_restore": 243, "perf": {"cpu_util_percent": 17.652631578947368, "ram_util_percent": 65.11052631578947}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -363.03800116644965, "policy_loss": -10705325.055555556, "vf_loss": 21684613.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13149.5, "diff_num_grad_updates_vs_sampler_policy": 13148.5}}, "num_env_steps_sampled": 52305360, "num_env_steps_trained": 52305360, "num_agent_steps_sampled": 52305360, "num_agent_steps_trained": 52305360}, "sampler_results": {"episode_reward_max": -10142.37363757697, "episode_reward_min": -10505.853789586594, "episode_reward_mean": -10290.991839371336, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105, -10347.865590442256, -10494.127652948591, -10378.271153661508, -10486.215376611912, -10237.404043560799, -10165.994163249294, -10256.549219118442, -10222.763270961514, -10286.451951412399, -10213.13161281437, -10188.66885631587, -10155.743859132162, -10230.185848561938, -10307.940138040069, -10286.982473752038, -10348.818747929152, -10255.97201849884, -10349.686155294161, -10285.86594895591, -10258.61654528074, -10317.001647494477, -10442.974334206052, -10359.67668416925, -10256.024571813316, -10310.665713289325, -10227.407575045285, -10365.03902160944, -10233.641164649478, -10200.106943486699, -10234.276043578178, -10252.52206434896, -10296.427550620718, -10307.722139013475, -10323.550039613632, -10302.736835020347, -10464.826511268471, -10186.453274958129, -10327.645199561208, -10251.488512639846, -10299.11150545407, -10186.978301361063, -10422.298201606058, -10203.978862128635, -10279.326384951695, -10232.82785382455, -10186.647753279978, -10189.651316755044, -10309.69442166719], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.427189744749478, "mean_inference_ms": 0.3713088312089152, "mean_action_processing_ms": 0.09124230003018757, "mean_env_wait_ms": 0.7377977096255607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034532546997070312, "StateBufferConnector_ms": 0.0024950504302978516, "ViewRequirementAgentConnector_ms": 0.06613349914550781}}, "episode_reward_max": -10142.37363757697, "episode_reward_min": -10505.853789586594, "episode_reward_mean": -10290.991839371336, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10276.340745421232, -10442.414104946272, -10233.8384955808, -10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105, -10347.865590442256, -10494.127652948591, -10378.271153661508, -10486.215376611912, -10237.404043560799, -10165.994163249294, -10256.549219118442, -10222.763270961514, -10286.451951412399, -10213.13161281437, -10188.66885631587, -10155.743859132162, -10230.185848561938, -10307.940138040069, -10286.982473752038, -10348.818747929152, -10255.97201849884, -10349.686155294161, -10285.86594895591, -10258.61654528074, -10317.001647494477, -10442.974334206052, -10359.67668416925, -10256.024571813316, -10310.665713289325, -10227.407575045285, -10365.03902160944, -10233.641164649478, -10200.106943486699, -10234.276043578178, -10252.52206434896, -10296.427550620718, -10307.722139013475, -10323.550039613632, -10302.736835020347, -10464.826511268471, -10186.453274958129, -10327.645199561208, -10251.488512639846, -10299.11150545407, -10186.978301361063, -10422.298201606058, -10203.978862128635, -10279.326384951695, -10232.82785382455, -10186.647753279978, -10189.651316755044, -10309.69442166719], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.427189744749478, "mean_inference_ms": 0.3713088312089152, "mean_action_processing_ms": 0.09124230003018757, "mean_env_wait_ms": 0.7377977096255607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034532546997070312, "StateBufferConnector_ms": 0.0024950504302978516, "ViewRequirementAgentConnector_ms": 0.06613349914550781}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52305360, "num_agent_steps_trained": 52305360, "num_env_steps_sampled": 52305360, "num_env_steps_trained": 52305360, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 274.80819201895343, "num_env_steps_trained_throughput_per_sec": 274.80819201895343, "timesteps_total": 52305360, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52305360, "timers": {"training_iteration_time_ms": 4376.285, "sample_time_ms": 4343.732, "load_time_ms": 0.571, "load_throughput": 2101881.233, "learn_time_ms": 31.162, "learn_throughput": 38508.529, "synch_weights_time_ms": 0.769}, "counters": {"num_env_steps_sampled": 52305360, "num_env_steps_trained": 52305360, "num_agent_steps_sampled": 52305360, "num_agent_steps_trained": 52305360}, "done": false, "episodes_total": 13044, "training_iteration": 4104, "trial_id": "9f686_00000", "date": "2023-08-08_16-04-51", "timestamp": 1691499891, "time_this_iter_s": 13.102883100509644, "time_total_s": 96308.03398919106, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3223.860802412033, "iterations_since_restore": 244, "perf": {"cpu_util_percent": 21.349999999999998, "ram_util_percent": 65.15555555555554}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -365.58232964409723, "policy_loss": -5461723.033854167, "vf_loss": 21165163.333333332}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13203.5, "diff_num_grad_updates_vs_sampler_policy": 13202.5}}, "num_env_steps_sampled": 52308960, "num_env_steps_trained": 52308960, "num_agent_steps_sampled": 52308960, "num_agent_steps_trained": 52308960}, "sampler_results": {"episode_reward_max": -10142.37363757697, "episode_reward_min": -10505.853789586594, "episode_reward_mean": -10288.74455797214, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105, -10347.865590442256, -10494.127652948591, -10378.271153661508, -10486.215376611912, -10237.404043560799, -10165.994163249294, -10256.549219118442, -10222.763270961514, -10286.451951412399, -10213.13161281437, -10188.66885631587, -10155.743859132162, -10230.185848561938, -10307.940138040069, -10286.982473752038, -10348.818747929152, -10255.97201849884, -10349.686155294161, -10285.86594895591, -10258.61654528074, -10317.001647494477, -10442.974334206052, -10359.67668416925, -10256.024571813316, -10310.665713289325, -10227.407575045285, -10365.03902160944, -10233.641164649478, -10200.106943486699, -10234.276043578178, -10252.52206434896, -10296.427550620718, -10307.722139013475, -10323.550039613632, -10302.736835020347, -10464.826511268471, -10186.453274958129, -10327.645199561208, -10251.488512639846, -10299.11150545407, -10186.978301361063, -10422.298201606058, -10203.978862128635, -10279.326384951695, -10232.82785382455, -10186.647753279978, -10189.651316755044, -10309.69442166719, -10253.631727034488, -10282.965828822144, -10191.267650172329], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.427110315725811, "mean_inference_ms": 0.37130742811846046, "mean_action_processing_ms": 0.0912426718149349, "mean_env_wait_ms": 0.7377511066339423, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003451824188232422, "StateBufferConnector_ms": 0.0024962425231933594, "ViewRequirementAgentConnector_ms": 0.06619381904602051}}, "episode_reward_max": -10142.37363757697, "episode_reward_min": -10505.853789586594, "episode_reward_mean": -10288.74455797214, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10231.256346299715, -10170.787737299044, -10319.548664601638, -10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105, -10347.865590442256, -10494.127652948591, -10378.271153661508, -10486.215376611912, -10237.404043560799, -10165.994163249294, -10256.549219118442, -10222.763270961514, -10286.451951412399, -10213.13161281437, -10188.66885631587, -10155.743859132162, -10230.185848561938, -10307.940138040069, -10286.982473752038, -10348.818747929152, -10255.97201849884, -10349.686155294161, -10285.86594895591, -10258.61654528074, -10317.001647494477, -10442.974334206052, -10359.67668416925, -10256.024571813316, -10310.665713289325, -10227.407575045285, -10365.03902160944, -10233.641164649478, -10200.106943486699, -10234.276043578178, -10252.52206434896, -10296.427550620718, -10307.722139013475, -10323.550039613632, -10302.736835020347, -10464.826511268471, -10186.453274958129, -10327.645199561208, -10251.488512639846, -10299.11150545407, -10186.978301361063, -10422.298201606058, -10203.978862128635, -10279.326384951695, -10232.82785382455, -10186.647753279978, -10189.651316755044, -10309.69442166719, -10253.631727034488, -10282.965828822144, -10191.267650172329], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.427110315725811, "mean_inference_ms": 0.37130742811846046, "mean_action_processing_ms": 0.0912426718149349, "mean_env_wait_ms": 0.7377511066339423, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003451824188232422, "StateBufferConnector_ms": 0.0024962425231933594, "ViewRequirementAgentConnector_ms": 0.06619381904602051}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52308960, "num_agent_steps_trained": 52308960, "num_env_steps_sampled": 52308960, "num_env_steps_trained": 52308960, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 274.9129925863861, "num_env_steps_trained_throughput_per_sec": 274.9129925863861, "timesteps_total": 52308960, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52308960, "timers": {"training_iteration_time_ms": 4377.745, "sample_time_ms": 4344.992, "load_time_ms": 0.569, "load_throughput": 2107425.7, "learn_time_ms": 31.361, "learn_throughput": 38263.553, "synch_weights_time_ms": 0.772}, "counters": {"num_env_steps_sampled": 52308960, "num_env_steps_trained": 52308960, "num_agent_steps_sampled": 52308960, "num_agent_steps_trained": 52308960}, "done": false, "episodes_total": 13047, "training_iteration": 4105, "trial_id": "9f686_00000", "date": "2023-08-08_16-05-04", "timestamp": 1691499904, "time_this_iter_s": 13.097953081130981, "time_total_s": 96321.13194227219, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3236.958755493164, "iterations_since_restore": 245, "perf": {"cpu_util_percent": 19.136842105263156, "ram_util_percent": 65.19999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -362.49338785807294, "policy_loss": -5613332.142361111, "vf_loss": 21511682.666666668}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13257.5, "diff_num_grad_updates_vs_sampler_policy": 13256.5}}, "num_env_steps_sampled": 52312560, "num_env_steps_trained": 52312560, "num_agent_steps_sampled": 52312560, "num_agent_steps_trained": 52312560}, "sampler_results": {"episode_reward_max": -10142.37363757697, "episode_reward_min": -10505.853789586594, "episode_reward_mean": -10291.153665672886, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105, -10347.865590442256, -10494.127652948591, -10378.271153661508, -10486.215376611912, -10237.404043560799, -10165.994163249294, -10256.549219118442, -10222.763270961514, -10286.451951412399, -10213.13161281437, -10188.66885631587, -10155.743859132162, -10230.185848561938, -10307.940138040069, -10286.982473752038, -10348.818747929152, -10255.97201849884, -10349.686155294161, -10285.86594895591, -10258.61654528074, -10317.001647494477, -10442.974334206052, -10359.67668416925, -10256.024571813316, -10310.665713289325, -10227.407575045285, -10365.03902160944, -10233.641164649478, -10200.106943486699, -10234.276043578178, -10252.52206434896, -10296.427550620718, -10307.722139013475, -10323.550039613632, -10302.736835020347, -10464.826511268471, -10186.453274958129, -10327.645199561208, -10251.488512639846, -10299.11150545407, -10186.978301361063, -10422.298201606058, -10203.978862128635, -10279.326384951695, -10232.82785382455, -10186.647753279978, -10189.651316755044, -10309.69442166719, -10253.631727034488, -10282.965828822144, -10191.267650172329, -10401.440520576993, -10259.825908429244, -10301.237089268665], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.427029138264787, "mean_inference_ms": 0.37130605928896016, "mean_action_processing_ms": 0.091243038427285, "mean_env_wait_ms": 0.7377059178471189, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034530162811279297, "StateBufferConnector_ms": 0.0024979114532470703, "ViewRequirementAgentConnector_ms": 0.06621146202087402}}, "episode_reward_max": -10142.37363757697, "episode_reward_min": -10505.853789586594, "episode_reward_mean": -10291.153665672886, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10322.355429428671, -10357.453558207035, -10142.37363757697, -10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105, -10347.865590442256, -10494.127652948591, -10378.271153661508, -10486.215376611912, -10237.404043560799, -10165.994163249294, -10256.549219118442, -10222.763270961514, -10286.451951412399, -10213.13161281437, -10188.66885631587, -10155.743859132162, -10230.185848561938, -10307.940138040069, -10286.982473752038, -10348.818747929152, -10255.97201849884, -10349.686155294161, -10285.86594895591, -10258.61654528074, -10317.001647494477, -10442.974334206052, -10359.67668416925, -10256.024571813316, -10310.665713289325, -10227.407575045285, -10365.03902160944, -10233.641164649478, -10200.106943486699, -10234.276043578178, -10252.52206434896, -10296.427550620718, -10307.722139013475, -10323.550039613632, -10302.736835020347, -10464.826511268471, -10186.453274958129, -10327.645199561208, -10251.488512639846, -10299.11150545407, -10186.978301361063, -10422.298201606058, -10203.978862128635, -10279.326384951695, -10232.82785382455, -10186.647753279978, -10189.651316755044, -10309.69442166719, -10253.631727034488, -10282.965828822144, -10191.267650172329, -10401.440520576993, -10259.825908429244, -10301.237089268665], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.427029138264787, "mean_inference_ms": 0.37130605928896016, "mean_action_processing_ms": 0.091243038427285, "mean_env_wait_ms": 0.7377059178471189, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034530162811279297, "StateBufferConnector_ms": 0.0024979114532470703, "ViewRequirementAgentConnector_ms": 0.06621146202087402}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52312560, "num_agent_steps_trained": 52312560, "num_env_steps_sampled": 52312560, "num_env_steps_trained": 52312560, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 277.1911380604584, "num_env_steps_trained_throughput_per_sec": 277.1911380604584, "timesteps_total": 52312560, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52312560, "timers": {"training_iteration_time_ms": 4349.311, "sample_time_ms": 4316.343, "load_time_ms": 0.576, "load_throughput": 2083349.808, "learn_time_ms": 31.541, "learn_throughput": 38045.961, "synch_weights_time_ms": 0.801}, "counters": {"num_env_steps_sampled": 52312560, "num_env_steps_trained": 52312560, "num_agent_steps_sampled": 52312560, "num_agent_steps_trained": 52312560}, "done": false, "episodes_total": 13050, "training_iteration": 4106, "trial_id": "9f686_00000", "date": "2023-08-08_16-05-17", "timestamp": 1691499917, "time_this_iter_s": 12.990267992019653, "time_total_s": 96334.1222102642, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3249.9490234851837, "iterations_since_restore": 246, "perf": {"cpu_util_percent": 21.505555555555556, "ram_util_percent": 64.92222222222223}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -362.4049292670356, "policy_loss": -5846977.190972222, "vf_loss": 21353047.666666668}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13311.5, "diff_num_grad_updates_vs_sampler_policy": 13310.5}}, "num_env_steps_sampled": 52316160, "num_env_steps_trained": 52316160, "num_agent_steps_sampled": 52316160, "num_agent_steps_trained": 52316160}, "sampler_results": {"episode_reward_max": -10155.743859132162, "episode_reward_min": -10513.272457180254, "episode_reward_mean": -10293.022459155885, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105, -10347.865590442256, -10494.127652948591, -10378.271153661508, -10486.215376611912, -10237.404043560799, -10165.994163249294, -10256.549219118442, -10222.763270961514, -10286.451951412399, -10213.13161281437, -10188.66885631587, -10155.743859132162, -10230.185848561938, -10307.940138040069, -10286.982473752038, -10348.818747929152, -10255.97201849884, -10349.686155294161, -10285.86594895591, -10258.61654528074, -10317.001647494477, -10442.974334206052, -10359.67668416925, -10256.024571813316, -10310.665713289325, -10227.407575045285, -10365.03902160944, -10233.641164649478, -10200.106943486699, -10234.276043578178, -10252.52206434896, -10296.427550620718, -10307.722139013475, -10323.550039613632, -10302.736835020347, -10464.826511268471, -10186.453274958129, -10327.645199561208, -10251.488512639846, -10299.11150545407, -10186.978301361063, -10422.298201606058, -10203.978862128635, -10279.326384951695, -10232.82785382455, -10186.647753279978, -10189.651316755044, -10309.69442166719, -10253.631727034488, -10282.965828822144, -10191.267650172329, -10401.440520576993, -10259.825908429244, -10301.237089268665, -10243.32511920505, -10513.272457180254, -10252.464397127396], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4269453705418655, "mean_inference_ms": 0.37130501911497255, "mean_action_processing_ms": 0.09124347351262047, "mean_env_wait_ms": 0.737664138981392, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003452777862548828, "StateBufferConnector_ms": 0.002501249313354492, "ViewRequirementAgentConnector_ms": 0.06613802909851074}}, "episode_reward_max": -10155.743859132162, "episode_reward_min": -10513.272457180254, "episode_reward_mean": -10293.022459155885, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10282.371272844573, -10234.737227365125, -10331.847155152254, -10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105, -10347.865590442256, -10494.127652948591, -10378.271153661508, -10486.215376611912, -10237.404043560799, -10165.994163249294, -10256.549219118442, -10222.763270961514, -10286.451951412399, -10213.13161281437, -10188.66885631587, -10155.743859132162, -10230.185848561938, -10307.940138040069, -10286.982473752038, -10348.818747929152, -10255.97201849884, -10349.686155294161, -10285.86594895591, -10258.61654528074, -10317.001647494477, -10442.974334206052, -10359.67668416925, -10256.024571813316, -10310.665713289325, -10227.407575045285, -10365.03902160944, -10233.641164649478, -10200.106943486699, -10234.276043578178, -10252.52206434896, -10296.427550620718, -10307.722139013475, -10323.550039613632, -10302.736835020347, -10464.826511268471, -10186.453274958129, -10327.645199561208, -10251.488512639846, -10299.11150545407, -10186.978301361063, -10422.298201606058, -10203.978862128635, -10279.326384951695, -10232.82785382455, -10186.647753279978, -10189.651316755044, -10309.69442166719, -10253.631727034488, -10282.965828822144, -10191.267650172329, -10401.440520576993, -10259.825908429244, -10301.237089268665, -10243.32511920505, -10513.272457180254, -10252.464397127396], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4269453705418655, "mean_inference_ms": 0.37130501911497255, "mean_action_processing_ms": 0.09124347351262047, "mean_env_wait_ms": 0.737664138981392, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003452777862548828, "StateBufferConnector_ms": 0.002501249313354492, "ViewRequirementAgentConnector_ms": 0.06613802909851074}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52316160, "num_agent_steps_trained": 52316160, "num_env_steps_sampled": 52316160, "num_env_steps_trained": 52316160, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 274.94959604545875, "num_env_steps_trained_throughput_per_sec": 274.94959604545875, "timesteps_total": 52316160, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52316160, "timers": {"training_iteration_time_ms": 4359.454, "sample_time_ms": 4326.402, "load_time_ms": 0.577, "load_throughput": 2078961.09, "learn_time_ms": 31.63, "learn_throughput": 37939.048, "synch_weights_time_ms": 0.796}, "counters": {"num_env_steps_sampled": 52316160, "num_env_steps_trained": 52316160, "num_agent_steps_sampled": 52316160, "num_agent_steps_trained": 52316160}, "done": false, "episodes_total": 13053, "training_iteration": 4107, "trial_id": "9f686_00000", "date": "2023-08-08_16-05-30", "timestamp": 1691499930, "time_this_iter_s": 13.096082925796509, "time_total_s": 96347.21829319, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3263.04510641098, "iterations_since_restore": 247, "perf": {"cpu_util_percent": 21.821052631578947, "ram_util_percent": 64.94736842105263}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -363.20067003038196, "policy_loss": -10817346.470052084, "vf_loss": 22146612.166666668}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13365.5, "diff_num_grad_updates_vs_sampler_policy": 13364.5}}, "num_env_steps_sampled": 52319760, "num_env_steps_trained": 52319760, "num_agent_steps_sampled": 52319760, "num_agent_steps_trained": 52319760}, "sampler_results": {"episode_reward_max": -10155.743859132162, "episode_reward_min": -10513.272457180254, "episode_reward_mean": -10294.819642336895, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105, -10347.865590442256, -10494.127652948591, -10378.271153661508, -10486.215376611912, -10237.404043560799, -10165.994163249294, -10256.549219118442, -10222.763270961514, -10286.451951412399, -10213.13161281437, -10188.66885631587, -10155.743859132162, -10230.185848561938, -10307.940138040069, -10286.982473752038, -10348.818747929152, -10255.97201849884, -10349.686155294161, -10285.86594895591, -10258.61654528074, -10317.001647494477, -10442.974334206052, -10359.67668416925, -10256.024571813316, -10310.665713289325, -10227.407575045285, -10365.03902160944, -10233.641164649478, -10200.106943486699, -10234.276043578178, -10252.52206434896, -10296.427550620718, -10307.722139013475, -10323.550039613632, -10302.736835020347, -10464.826511268471, -10186.453274958129, -10327.645199561208, -10251.488512639846, -10299.11150545407, -10186.978301361063, -10422.298201606058, -10203.978862128635, -10279.326384951695, -10232.82785382455, -10186.647753279978, -10189.651316755044, -10309.69442166719, -10253.631727034488, -10282.965828822144, -10191.267650172329, -10401.440520576993, -10259.825908429244, -10301.237089268665, -10243.32511920505, -10513.272457180254, -10252.464397127396, -10344.271634009863, -10266.593382856892, -10417.80895659611], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4268632508706336, "mean_inference_ms": 0.37130401025646104, "mean_action_processing_ms": 0.09124390966964686, "mean_env_wait_ms": 0.7376257770127641, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003459453582763672, "StateBufferConnector_ms": 0.0025026798248291016, "ViewRequirementAgentConnector_ms": 0.0661478042602539}}, "episode_reward_max": -10155.743859132162, "episode_reward_min": -10513.272457180254, "episode_reward_mean": -10294.819642336895, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10203.682426758523, -10379.816728447735, -10505.853789586594, -10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105, -10347.865590442256, -10494.127652948591, -10378.271153661508, -10486.215376611912, -10237.404043560799, -10165.994163249294, -10256.549219118442, -10222.763270961514, -10286.451951412399, -10213.13161281437, -10188.66885631587, -10155.743859132162, -10230.185848561938, -10307.940138040069, -10286.982473752038, -10348.818747929152, -10255.97201849884, -10349.686155294161, -10285.86594895591, -10258.61654528074, -10317.001647494477, -10442.974334206052, -10359.67668416925, -10256.024571813316, -10310.665713289325, -10227.407575045285, -10365.03902160944, -10233.641164649478, -10200.106943486699, -10234.276043578178, -10252.52206434896, -10296.427550620718, -10307.722139013475, -10323.550039613632, -10302.736835020347, -10464.826511268471, -10186.453274958129, -10327.645199561208, -10251.488512639846, -10299.11150545407, -10186.978301361063, -10422.298201606058, -10203.978862128635, -10279.326384951695, -10232.82785382455, -10186.647753279978, -10189.651316755044, -10309.69442166719, -10253.631727034488, -10282.965828822144, -10191.267650172329, -10401.440520576993, -10259.825908429244, -10301.237089268665, -10243.32511920505, -10513.272457180254, -10252.464397127396, -10344.271634009863, -10266.593382856892, -10417.80895659611], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4268632508706336, "mean_inference_ms": 0.37130401025646104, "mean_action_processing_ms": 0.09124390966964686, "mean_env_wait_ms": 0.7376257770127641, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003459453582763672, "StateBufferConnector_ms": 0.0025026798248291016, "ViewRequirementAgentConnector_ms": 0.0661478042602539}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52319760, "num_agent_steps_trained": 52319760, "num_env_steps_sampled": 52319760, "num_env_steps_trained": 52319760, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 271.15094230352236, "num_env_steps_trained_throughput_per_sec": 271.15094230352236, "timesteps_total": 52319760, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52319760, "timers": {"training_iteration_time_ms": 4368.054, "sample_time_ms": 4335.235, "load_time_ms": 0.579, "load_throughput": 2071516.977, "learn_time_ms": 31.422, "learn_throughput": 38189.664, "synch_weights_time_ms": 0.769}, "counters": {"num_env_steps_sampled": 52319760, "num_env_steps_trained": 52319760, "num_agent_steps_sampled": 52319760, "num_agent_steps_trained": 52319760}, "done": false, "episodes_total": 13056, "training_iteration": 4108, "trial_id": "9f686_00000", "date": "2023-08-08_16-05-43", "timestamp": 1691499943, "time_this_iter_s": 13.279691934585571, "time_total_s": 96360.49798512459, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3276.324798345566, "iterations_since_restore": 248, "perf": {"cpu_util_percent": 20.94736842105263, "ram_util_percent": 65.43684210526315}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -364.3147718641493, "policy_loss": -8443679.418402778, "vf_loss": 21351534.555555556}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13419.5, "diff_num_grad_updates_vs_sampler_policy": 13418.5}}, "num_env_steps_sampled": 52323360, "num_env_steps_trained": 52323360, "num_agent_steps_sampled": 52323360, "num_agent_steps_trained": 52323360}, "sampler_results": {"episode_reward_max": -10155.743859132162, "episode_reward_min": -10513.272457180254, "episode_reward_mean": -10291.744803510148, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105, -10347.865590442256, -10494.127652948591, -10378.271153661508, -10486.215376611912, -10237.404043560799, -10165.994163249294, -10256.549219118442, -10222.763270961514, -10286.451951412399, -10213.13161281437, -10188.66885631587, -10155.743859132162, -10230.185848561938, -10307.940138040069, -10286.982473752038, -10348.818747929152, -10255.97201849884, -10349.686155294161, -10285.86594895591, -10258.61654528074, -10317.001647494477, -10442.974334206052, -10359.67668416925, -10256.024571813316, -10310.665713289325, -10227.407575045285, -10365.03902160944, -10233.641164649478, -10200.106943486699, -10234.276043578178, -10252.52206434896, -10296.427550620718, -10307.722139013475, -10323.550039613632, -10302.736835020347, -10464.826511268471, -10186.453274958129, -10327.645199561208, -10251.488512639846, -10299.11150545407, -10186.978301361063, -10422.298201606058, -10203.978862128635, -10279.326384951695, -10232.82785382455, -10186.647753279978, -10189.651316755044, -10309.69442166719, -10253.631727034488, -10282.965828822144, -10191.267650172329, -10401.440520576993, -10259.825908429244, -10301.237089268665, -10243.32511920505, -10513.272457180254, -10252.464397127396, -10344.271634009863, -10266.593382856892, -10417.80895659611, -10280.01355759318, -10263.210234223949, -10238.645270301078], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4267774096166725, "mean_inference_ms": 0.37130311117000764, "mean_action_processing_ms": 0.09124439482738564, "mean_env_wait_ms": 0.7375861112829537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003457784652709961, "StateBufferConnector_ms": 0.002499818801879883, "ViewRequirementAgentConnector_ms": 0.06609368324279785}}, "episode_reward_max": -10155.743859132162, "episode_reward_min": -10513.272457180254, "episode_reward_mean": -10291.744803510148, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10434.02039032034, -10168.908763439635, -10190.112768329871, -10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105, -10347.865590442256, -10494.127652948591, -10378.271153661508, -10486.215376611912, -10237.404043560799, -10165.994163249294, -10256.549219118442, -10222.763270961514, -10286.451951412399, -10213.13161281437, -10188.66885631587, -10155.743859132162, -10230.185848561938, -10307.940138040069, -10286.982473752038, -10348.818747929152, -10255.97201849884, -10349.686155294161, -10285.86594895591, -10258.61654528074, -10317.001647494477, -10442.974334206052, -10359.67668416925, -10256.024571813316, -10310.665713289325, -10227.407575045285, -10365.03902160944, -10233.641164649478, -10200.106943486699, -10234.276043578178, -10252.52206434896, -10296.427550620718, -10307.722139013475, -10323.550039613632, -10302.736835020347, -10464.826511268471, -10186.453274958129, -10327.645199561208, -10251.488512639846, -10299.11150545407, -10186.978301361063, -10422.298201606058, -10203.978862128635, -10279.326384951695, -10232.82785382455, -10186.647753279978, -10189.651316755044, -10309.69442166719, -10253.631727034488, -10282.965828822144, -10191.267650172329, -10401.440520576993, -10259.825908429244, -10301.237089268665, -10243.32511920505, -10513.272457180254, -10252.464397127396, -10344.271634009863, -10266.593382856892, -10417.80895659611, -10280.01355759318, -10263.210234223949, -10238.645270301078], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4267774096166725, "mean_inference_ms": 0.37130311117000764, "mean_action_processing_ms": 0.09124439482738564, "mean_env_wait_ms": 0.7375861112829537, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003457784652709961, "StateBufferConnector_ms": 0.002499818801879883, "ViewRequirementAgentConnector_ms": 0.06609368324279785}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52323360, "num_agent_steps_trained": 52323360, "num_env_steps_sampled": 52323360, "num_env_steps_trained": 52323360, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 275.9776630456149, "num_env_steps_trained_throughput_per_sec": 275.9776630456149, "timesteps_total": 52323360, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52323360, "timers": {"training_iteration_time_ms": 4373.472, "sample_time_ms": 4340.613, "load_time_ms": 0.576, "load_throughput": 2081884.844, "learn_time_ms": 31.45, "learn_throughput": 38156.225, "synch_weights_time_ms": 0.782}, "counters": {"num_env_steps_sampled": 52323360, "num_env_steps_trained": 52323360, "num_agent_steps_sampled": 52323360, "num_agent_steps_trained": 52323360}, "done": false, "episodes_total": 13059, "training_iteration": 4109, "trial_id": "9f686_00000", "date": "2023-08-08_16-05-56", "timestamp": 1691499956, "time_this_iter_s": 13.047408103942871, "time_total_s": 96373.54539322853, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3289.3722064495087, "iterations_since_restore": 249, "perf": {"cpu_util_percent": 20.28333333333333, "ram_util_percent": 65.17222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -363.56858317057294, "policy_loss": -6556717.78515625, "vf_loss": 21328773.888888888}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13473.5, "diff_num_grad_updates_vs_sampler_policy": 13472.5}}, "num_env_steps_sampled": 52326960, "num_env_steps_trained": 52326960, "num_agent_steps_sampled": 52326960, "num_agent_steps_trained": 52326960}, "sampler_results": {"episode_reward_max": -10155.743859132162, "episode_reward_min": -10513.272457180254, "episode_reward_mean": -10293.159958614931, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105, -10347.865590442256, -10494.127652948591, -10378.271153661508, -10486.215376611912, -10237.404043560799, -10165.994163249294, -10256.549219118442, -10222.763270961514, -10286.451951412399, -10213.13161281437, -10188.66885631587, -10155.743859132162, -10230.185848561938, -10307.940138040069, -10286.982473752038, -10348.818747929152, -10255.97201849884, -10349.686155294161, -10285.86594895591, -10258.61654528074, -10317.001647494477, -10442.974334206052, -10359.67668416925, -10256.024571813316, -10310.665713289325, -10227.407575045285, -10365.03902160944, -10233.641164649478, -10200.106943486699, -10234.276043578178, -10252.52206434896, -10296.427550620718, -10307.722139013475, -10323.550039613632, -10302.736835020347, -10464.826511268471, -10186.453274958129, -10327.645199561208, -10251.488512639846, -10299.11150545407, -10186.978301361063, -10422.298201606058, -10203.978862128635, -10279.326384951695, -10232.82785382455, -10186.647753279978, -10189.651316755044, -10309.69442166719, -10253.631727034488, -10282.965828822144, -10191.267650172329, -10401.440520576993, -10259.825908429244, -10301.237089268665, -10243.32511920505, -10513.272457180254, -10252.464397127396, -10344.271634009863, -10266.593382856892, -10417.80895659611, -10280.01355759318, -10263.210234223949, -10238.645270301078, -10350.896136537418, -10347.172765046675, -10236.488530983775], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.426692844731783, "mean_inference_ms": 0.37130222933902884, "mean_action_processing_ms": 0.09124486706855194, "mean_env_wait_ms": 0.7375493196899179, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034589767456054688, "StateBufferConnector_ms": 0.0024983882904052734, "ViewRequirementAgentConnector_ms": 0.06610488891601562}}, "episode_reward_max": -10155.743859132162, "episode_reward_min": -10513.272457180254, "episode_reward_mean": -10293.159958614931, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10234.765533771404, -10306.152075508655, -10330.732855058955, -10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105, -10347.865590442256, -10494.127652948591, -10378.271153661508, -10486.215376611912, -10237.404043560799, -10165.994163249294, -10256.549219118442, -10222.763270961514, -10286.451951412399, -10213.13161281437, -10188.66885631587, -10155.743859132162, -10230.185848561938, -10307.940138040069, -10286.982473752038, -10348.818747929152, -10255.97201849884, -10349.686155294161, -10285.86594895591, -10258.61654528074, -10317.001647494477, -10442.974334206052, -10359.67668416925, -10256.024571813316, -10310.665713289325, -10227.407575045285, -10365.03902160944, -10233.641164649478, -10200.106943486699, -10234.276043578178, -10252.52206434896, -10296.427550620718, -10307.722139013475, -10323.550039613632, -10302.736835020347, -10464.826511268471, -10186.453274958129, -10327.645199561208, -10251.488512639846, -10299.11150545407, -10186.978301361063, -10422.298201606058, -10203.978862128635, -10279.326384951695, -10232.82785382455, -10186.647753279978, -10189.651316755044, -10309.69442166719, -10253.631727034488, -10282.965828822144, -10191.267650172329, -10401.440520576993, -10259.825908429244, -10301.237089268665, -10243.32511920505, -10513.272457180254, -10252.464397127396, -10344.271634009863, -10266.593382856892, -10417.80895659611, -10280.01355759318, -10263.210234223949, -10238.645270301078, -10350.896136537418, -10347.172765046675, -10236.488530983775], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.426692844731783, "mean_inference_ms": 0.37130222933902884, "mean_action_processing_ms": 0.09124486706855194, "mean_env_wait_ms": 0.7375493196899179, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034589767456054688, "StateBufferConnector_ms": 0.0024983882904052734, "ViewRequirementAgentConnector_ms": 0.06610488891601562}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52326960, "num_agent_steps_trained": 52326960, "num_env_steps_sampled": 52326960, "num_env_steps_trained": 52326960, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 270.60051508651077, "num_env_steps_trained_throughput_per_sec": 270.60051508651077, "timesteps_total": 52326960, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52326960, "timers": {"training_iteration_time_ms": 4397.493, "sample_time_ms": 4364.955, "load_time_ms": 0.575, "load_throughput": 2087670.496, "learn_time_ms": 31.151, "learn_throughput": 38521.939, "synch_weights_time_ms": 0.764}, "counters": {"num_env_steps_sampled": 52326960, "num_env_steps_trained": 52326960, "num_agent_steps_sampled": 52326960, "num_agent_steps_trained": 52326960}, "done": false, "episodes_total": 13062, "training_iteration": 4110, "trial_id": "9f686_00000", "date": "2023-08-08_16-06-10", "timestamp": 1691499970, "time_this_iter_s": 13.306591987609863, "time_total_s": 96386.85198521614, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3302.6787984371185, "iterations_since_restore": 250, "perf": {"cpu_util_percent": 19.184210526315788, "ram_util_percent": 65.50526315789473}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -363.27055019802515, "policy_loss": -7107493.835069444, "vf_loss": 21118520.166666668}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13527.5, "diff_num_grad_updates_vs_sampler_policy": 13526.5}}, "num_env_steps_sampled": 52330560, "num_env_steps_trained": 52330560, "num_agent_steps_sampled": 52330560, "num_agent_steps_trained": 52330560}, "sampler_results": {"episode_reward_max": -10155.743859132162, "episode_reward_min": -10513.272457180254, "episode_reward_mean": -10292.02895818895, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105, -10347.865590442256, -10494.127652948591, -10378.271153661508, -10486.215376611912, -10237.404043560799, -10165.994163249294, -10256.549219118442, -10222.763270961514, -10286.451951412399, -10213.13161281437, -10188.66885631587, -10155.743859132162, -10230.185848561938, -10307.940138040069, -10286.982473752038, -10348.818747929152, -10255.97201849884, -10349.686155294161, -10285.86594895591, -10258.61654528074, -10317.001647494477, -10442.974334206052, -10359.67668416925, -10256.024571813316, -10310.665713289325, -10227.407575045285, -10365.03902160944, -10233.641164649478, -10200.106943486699, -10234.276043578178, -10252.52206434896, -10296.427550620718, -10307.722139013475, -10323.550039613632, -10302.736835020347, -10464.826511268471, -10186.453274958129, -10327.645199561208, -10251.488512639846, -10299.11150545407, -10186.978301361063, -10422.298201606058, -10203.978862128635, -10279.326384951695, -10232.82785382455, -10186.647753279978, -10189.651316755044, -10309.69442166719, -10253.631727034488, -10282.965828822144, -10191.267650172329, -10401.440520576993, -10259.825908429244, -10301.237089268665, -10243.32511920505, -10513.272457180254, -10252.464397127396, -10344.271634009863, -10266.593382856892, -10417.80895659611, -10280.01355759318, -10263.210234223949, -10238.645270301078, -10350.896136537418, -10347.172765046675, -10236.488530983775, -10244.897898459949, -10297.801423193558, -10215.851100087631], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.426597724336662, "mean_inference_ms": 0.3713014547060534, "mean_action_processing_ms": 0.09124535227830524, "mean_env_wait_ms": 0.7375117276897286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034656524658203125, "StateBufferConnector_ms": 0.0025043487548828125, "ViewRequirementAgentConnector_ms": 0.06623244285583496}}, "episode_reward_max": -10155.743859132162, "episode_reward_min": -10513.272457180254, "episode_reward_mean": -10292.02895818895, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10231.589150900736, -10349.580642900457, -10359.610690501375, -10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105, -10347.865590442256, -10494.127652948591, -10378.271153661508, -10486.215376611912, -10237.404043560799, -10165.994163249294, -10256.549219118442, -10222.763270961514, -10286.451951412399, -10213.13161281437, -10188.66885631587, -10155.743859132162, -10230.185848561938, -10307.940138040069, -10286.982473752038, -10348.818747929152, -10255.97201849884, -10349.686155294161, -10285.86594895591, -10258.61654528074, -10317.001647494477, -10442.974334206052, -10359.67668416925, -10256.024571813316, -10310.665713289325, -10227.407575045285, -10365.03902160944, -10233.641164649478, -10200.106943486699, -10234.276043578178, -10252.52206434896, -10296.427550620718, -10307.722139013475, -10323.550039613632, -10302.736835020347, -10464.826511268471, -10186.453274958129, -10327.645199561208, -10251.488512639846, -10299.11150545407, -10186.978301361063, -10422.298201606058, -10203.978862128635, -10279.326384951695, -10232.82785382455, -10186.647753279978, -10189.651316755044, -10309.69442166719, -10253.631727034488, -10282.965828822144, -10191.267650172329, -10401.440520576993, -10259.825908429244, -10301.237089268665, -10243.32511920505, -10513.272457180254, -10252.464397127396, -10344.271634009863, -10266.593382856892, -10417.80895659611, -10280.01355759318, -10263.210234223949, -10238.645270301078, -10350.896136537418, -10347.172765046675, -10236.488530983775, -10244.897898459949, -10297.801423193558, -10215.851100087631], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.426597724336662, "mean_inference_ms": 0.3713014547060534, "mean_action_processing_ms": 0.09124535227830524, "mean_env_wait_ms": 0.7375117276897286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034656524658203125, "StateBufferConnector_ms": 0.0025043487548828125, "ViewRequirementAgentConnector_ms": 0.06623244285583496}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52330560, "num_agent_steps_trained": 52330560, "num_env_steps_sampled": 52330560, "num_env_steps_trained": 52330560, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 278.71001524078, "num_env_steps_trained_throughput_per_sec": 278.71001524078, "timesteps_total": 52330560, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52330560, "timers": {"training_iteration_time_ms": 4367.899, "sample_time_ms": 4335.191, "load_time_ms": 0.579, "load_throughput": 2073223.545, "learn_time_ms": 31.3, "learn_throughput": 38338.517, "synch_weights_time_ms": 0.779}, "counters": {"num_env_steps_sampled": 52330560, "num_env_steps_trained": 52330560, "num_agent_steps_sampled": 52330560, "num_agent_steps_trained": 52330560}, "done": false, "episodes_total": 13065, "training_iteration": 4111, "trial_id": "9f686_00000", "date": "2023-08-08_16-06-23", "timestamp": 1691499983, "time_this_iter_s": 12.919628858566284, "time_total_s": 96399.7716140747, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3315.598427295685, "iterations_since_restore": 251, "perf": {"cpu_util_percent": 20.494444444444444, "ram_util_percent": 65.19444444444443}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -363.4123823377821, "policy_loss": -3625903.622829861, "vf_loss": 20969378.916666668}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13581.5, "diff_num_grad_updates_vs_sampler_policy": 13580.5}}, "num_env_steps_sampled": 52334160, "num_env_steps_trained": 52334160, "num_agent_steps_sampled": 52334160, "num_agent_steps_trained": 52334160}, "sampler_results": {"episode_reward_max": -10155.743859132162, "episode_reward_min": -10513.272457180254, "episode_reward_mean": -10290.921638904481, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105, -10347.865590442256, -10494.127652948591, -10378.271153661508, -10486.215376611912, -10237.404043560799, -10165.994163249294, -10256.549219118442, -10222.763270961514, -10286.451951412399, -10213.13161281437, -10188.66885631587, -10155.743859132162, -10230.185848561938, -10307.940138040069, -10286.982473752038, -10348.818747929152, -10255.97201849884, -10349.686155294161, -10285.86594895591, -10258.61654528074, -10317.001647494477, -10442.974334206052, -10359.67668416925, -10256.024571813316, -10310.665713289325, -10227.407575045285, -10365.03902160944, -10233.641164649478, -10200.106943486699, -10234.276043578178, -10252.52206434896, -10296.427550620718, -10307.722139013475, -10323.550039613632, -10302.736835020347, -10464.826511268471, -10186.453274958129, -10327.645199561208, -10251.488512639846, -10299.11150545407, -10186.978301361063, -10422.298201606058, -10203.978862128635, -10279.326384951695, -10232.82785382455, -10186.647753279978, -10189.651316755044, -10309.69442166719, -10253.631727034488, -10282.965828822144, -10191.267650172329, -10401.440520576993, -10259.825908429244, -10301.237089268665, -10243.32511920505, -10513.272457180254, -10252.464397127396, -10344.271634009863, -10266.593382856892, -10417.80895659611, -10280.01355759318, -10263.210234223949, -10238.645270301078, -10350.896136537418, -10347.172765046675, -10236.488530983775, -10244.897898459949, -10297.801423193558, -10215.851100087631, -10264.62527435672, -10398.938248705777, -10166.485032793184], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4264980294278895, "mean_inference_ms": 0.37130085445604294, "mean_action_processing_ms": 0.09124583610481739, "mean_env_wait_ms": 0.737474835591629, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003459930419921875, "StateBufferConnector_ms": 0.002506256103515625, "ViewRequirementAgentConnector_ms": 0.06623125076293945}}, "episode_reward_max": -10155.743859132162, "episode_reward_min": -10513.272457180254, "episode_reward_mean": -10290.921638904481, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10321.540500317647, -10321.446246322806, -10261.60830279109, -10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105, -10347.865590442256, -10494.127652948591, -10378.271153661508, -10486.215376611912, -10237.404043560799, -10165.994163249294, -10256.549219118442, -10222.763270961514, -10286.451951412399, -10213.13161281437, -10188.66885631587, -10155.743859132162, -10230.185848561938, -10307.940138040069, -10286.982473752038, -10348.818747929152, -10255.97201849884, -10349.686155294161, -10285.86594895591, -10258.61654528074, -10317.001647494477, -10442.974334206052, -10359.67668416925, -10256.024571813316, -10310.665713289325, -10227.407575045285, -10365.03902160944, -10233.641164649478, -10200.106943486699, -10234.276043578178, -10252.52206434896, -10296.427550620718, -10307.722139013475, -10323.550039613632, -10302.736835020347, -10464.826511268471, -10186.453274958129, -10327.645199561208, -10251.488512639846, -10299.11150545407, -10186.978301361063, -10422.298201606058, -10203.978862128635, -10279.326384951695, -10232.82785382455, -10186.647753279978, -10189.651316755044, -10309.69442166719, -10253.631727034488, -10282.965828822144, -10191.267650172329, -10401.440520576993, -10259.825908429244, -10301.237089268665, -10243.32511920505, -10513.272457180254, -10252.464397127396, -10344.271634009863, -10266.593382856892, -10417.80895659611, -10280.01355759318, -10263.210234223949, -10238.645270301078, -10350.896136537418, -10347.172765046675, -10236.488530983775, -10244.897898459949, -10297.801423193558, -10215.851100087631, -10264.62527435672, -10398.938248705777, -10166.485032793184], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4264980294278895, "mean_inference_ms": 0.37130085445604294, "mean_action_processing_ms": 0.09124583610481739, "mean_env_wait_ms": 0.737474835591629, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003459930419921875, "StateBufferConnector_ms": 0.002506256103515625, "ViewRequirementAgentConnector_ms": 0.06623125076293945}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52334160, "num_agent_steps_trained": 52334160, "num_env_steps_sampled": 52334160, "num_env_steps_trained": 52334160, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 273.6484318703955, "num_env_steps_trained_throughput_per_sec": 273.6484318703955, "timesteps_total": 52334160, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52334160, "timers": {"training_iteration_time_ms": 4376.536, "sample_time_ms": 4343.778, "load_time_ms": 0.576, "load_throughput": 2085075.935, "learn_time_ms": 31.391, "learn_throughput": 38227.255, "synch_weights_time_ms": 0.743}, "counters": {"num_env_steps_sampled": 52334160, "num_env_steps_trained": 52334160, "num_agent_steps_sampled": 52334160, "num_agent_steps_trained": 52334160}, "done": false, "episodes_total": 13068, "training_iteration": 4112, "trial_id": "9f686_00000", "date": "2023-08-08_16-06-36", "timestamp": 1691499996, "time_this_iter_s": 13.15864896774292, "time_total_s": 96412.93026304245, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3328.7570762634277, "iterations_since_restore": 252, "perf": {"cpu_util_percent": 20.073684210526316, "ram_util_percent": 65.10526315789473}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -362.98295254177515, "policy_loss": -4996262.9375, "vf_loss": 21830170.055555556}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13635.5, "diff_num_grad_updates_vs_sampler_policy": 13634.5}}, "num_env_steps_sampled": 52337760, "num_env_steps_trained": 52337760, "num_agent_steps_sampled": 52337760, "num_agent_steps_trained": 52337760}, "sampler_results": {"episode_reward_max": -10155.743859132162, "episode_reward_min": -10513.272457180254, "episode_reward_mean": -10293.326861033353, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105, -10347.865590442256, -10494.127652948591, -10378.271153661508, -10486.215376611912, -10237.404043560799, -10165.994163249294, -10256.549219118442, -10222.763270961514, -10286.451951412399, -10213.13161281437, -10188.66885631587, -10155.743859132162, -10230.185848561938, -10307.940138040069, -10286.982473752038, -10348.818747929152, -10255.97201849884, -10349.686155294161, -10285.86594895591, -10258.61654528074, -10317.001647494477, -10442.974334206052, -10359.67668416925, -10256.024571813316, -10310.665713289325, -10227.407575045285, -10365.03902160944, -10233.641164649478, -10200.106943486699, -10234.276043578178, -10252.52206434896, -10296.427550620718, -10307.722139013475, -10323.550039613632, -10302.736835020347, -10464.826511268471, -10186.453274958129, -10327.645199561208, -10251.488512639846, -10299.11150545407, -10186.978301361063, -10422.298201606058, -10203.978862128635, -10279.326384951695, -10232.82785382455, -10186.647753279978, -10189.651316755044, -10309.69442166719, -10253.631727034488, -10282.965828822144, -10191.267650172329, -10401.440520576993, -10259.825908429244, -10301.237089268665, -10243.32511920505, -10513.272457180254, -10252.464397127396, -10344.271634009863, -10266.593382856892, -10417.80895659611, -10280.01355759318, -10263.210234223949, -10238.645270301078, -10350.896136537418, -10347.172765046675, -10236.488530983775, -10244.897898459949, -10297.801423193558, -10215.851100087631, -10264.62527435672, -10398.938248705777, -10166.485032793184, -10320.901707805173, -10387.48365046927, -10436.73190404413], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.426389900952642, "mean_inference_ms": 0.37130036553479684, "mean_action_processing_ms": 0.09124633247535009, "mean_env_wait_ms": 0.737439117874603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003453493118286133, "StateBufferConnector_ms": 0.0025048255920410156, "ViewRequirementAgentConnector_ms": 0.0662074089050293}}, "episode_reward_max": -10155.743859132162, "episode_reward_min": -10513.272457180254, "episode_reward_mean": -10293.326861033353, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10231.234057046076, -10374.039700441912, -10301.138706277852, -10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105, -10347.865590442256, -10494.127652948591, -10378.271153661508, -10486.215376611912, -10237.404043560799, -10165.994163249294, -10256.549219118442, -10222.763270961514, -10286.451951412399, -10213.13161281437, -10188.66885631587, -10155.743859132162, -10230.185848561938, -10307.940138040069, -10286.982473752038, -10348.818747929152, -10255.97201849884, -10349.686155294161, -10285.86594895591, -10258.61654528074, -10317.001647494477, -10442.974334206052, -10359.67668416925, -10256.024571813316, -10310.665713289325, -10227.407575045285, -10365.03902160944, -10233.641164649478, -10200.106943486699, -10234.276043578178, -10252.52206434896, -10296.427550620718, -10307.722139013475, -10323.550039613632, -10302.736835020347, -10464.826511268471, -10186.453274958129, -10327.645199561208, -10251.488512639846, -10299.11150545407, -10186.978301361063, -10422.298201606058, -10203.978862128635, -10279.326384951695, -10232.82785382455, -10186.647753279978, -10189.651316755044, -10309.69442166719, -10253.631727034488, -10282.965828822144, -10191.267650172329, -10401.440520576993, -10259.825908429244, -10301.237089268665, -10243.32511920505, -10513.272457180254, -10252.464397127396, -10344.271634009863, -10266.593382856892, -10417.80895659611, -10280.01355759318, -10263.210234223949, -10238.645270301078, -10350.896136537418, -10347.172765046675, -10236.488530983775, -10244.897898459949, -10297.801423193558, -10215.851100087631, -10264.62527435672, -10398.938248705777, -10166.485032793184, -10320.901707805173, -10387.48365046927, -10436.73190404413], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.426389900952642, "mean_inference_ms": 0.37130036553479684, "mean_action_processing_ms": 0.09124633247535009, "mean_env_wait_ms": 0.737439117874603, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003453493118286133, "StateBufferConnector_ms": 0.0025048255920410156, "ViewRequirementAgentConnector_ms": 0.0662074089050293}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52337760, "num_agent_steps_trained": 52337760, "num_env_steps_sampled": 52337760, "num_env_steps_trained": 52337760, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 276.967904049676, "num_env_steps_trained_throughput_per_sec": 276.967904049676, "timesteps_total": 52337760, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52337760, "timers": {"training_iteration_time_ms": 4350.149, "sample_time_ms": 4317.59, "load_time_ms": 0.573, "load_throughput": 2092792.017, "learn_time_ms": 31.169, "learn_throughput": 38499.574, "synch_weights_time_ms": 0.768}, "counters": {"num_env_steps_sampled": 52337760, "num_env_steps_trained": 52337760, "num_agent_steps_sampled": 52337760, "num_agent_steps_trained": 52337760}, "done": false, "episodes_total": 13071, "training_iteration": 4113, "trial_id": "9f686_00000", "date": "2023-08-08_16-06-49", "timestamp": 1691500009, "time_this_iter_s": 13.000724077224731, "time_total_s": 96425.93098711967, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3341.7578003406525, "iterations_since_restore": 253, "perf": {"cpu_util_percent": 21.63157894736842, "ram_util_percent": 64.9736842105263}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -362.0779758029514, "policy_loss": -5432994.444444444, "vf_loss": 21794348.944444444}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13689.5, "diff_num_grad_updates_vs_sampler_policy": 13688.5}}, "num_env_steps_sampled": 52341360, "num_env_steps_trained": 52341360, "num_agent_steps_sampled": 52341360, "num_agent_steps_trained": 52341360}, "sampler_results": {"episode_reward_max": -10155.743859132162, "episode_reward_min": -10513.272457180254, "episode_reward_mean": -10293.942798638773, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105, -10347.865590442256, -10494.127652948591, -10378.271153661508, -10486.215376611912, -10237.404043560799, -10165.994163249294, -10256.549219118442, -10222.763270961514, -10286.451951412399, -10213.13161281437, -10188.66885631587, -10155.743859132162, -10230.185848561938, -10307.940138040069, -10286.982473752038, -10348.818747929152, -10255.97201849884, -10349.686155294161, -10285.86594895591, -10258.61654528074, -10317.001647494477, -10442.974334206052, -10359.67668416925, -10256.024571813316, -10310.665713289325, -10227.407575045285, -10365.03902160944, -10233.641164649478, -10200.106943486699, -10234.276043578178, -10252.52206434896, -10296.427550620718, -10307.722139013475, -10323.550039613632, -10302.736835020347, -10464.826511268471, -10186.453274958129, -10327.645199561208, -10251.488512639846, -10299.11150545407, -10186.978301361063, -10422.298201606058, -10203.978862128635, -10279.326384951695, -10232.82785382455, -10186.647753279978, -10189.651316755044, -10309.69442166719, -10253.631727034488, -10282.965828822144, -10191.267650172329, -10401.440520576993, -10259.825908429244, -10301.237089268665, -10243.32511920505, -10513.272457180254, -10252.464397127396, -10344.271634009863, -10266.593382856892, -10417.80895659611, -10280.01355759318, -10263.210234223949, -10238.645270301078, -10350.896136537418, -10347.172765046675, -10236.488530983775, -10244.897898459949, -10297.801423193558, -10215.851100087631, -10264.62527435672, -10398.938248705777, -10166.485032793184, -10320.901707805173, -10387.48365046927, -10436.73190404413, -10366.644575619715, -10252.515418741035, -10348.8462299472], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4262813251277047, "mean_inference_ms": 0.3712999808015915, "mean_action_processing_ms": 0.09124682389029248, "mean_env_wait_ms": 0.7374042520856616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003454446792602539, "StateBufferConnector_ms": 0.0025053024291992188, "ViewRequirementAgentConnector_ms": 0.06619954109191895}}, "episode_reward_max": -10155.743859132162, "episode_reward_min": -10513.272457180254, "episode_reward_mean": -10293.942798638773, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10366.058429247207, -10187.79320525658, -10162.16514027147, -10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105, -10347.865590442256, -10494.127652948591, -10378.271153661508, -10486.215376611912, -10237.404043560799, -10165.994163249294, -10256.549219118442, -10222.763270961514, -10286.451951412399, -10213.13161281437, -10188.66885631587, -10155.743859132162, -10230.185848561938, -10307.940138040069, -10286.982473752038, -10348.818747929152, -10255.97201849884, -10349.686155294161, -10285.86594895591, -10258.61654528074, -10317.001647494477, -10442.974334206052, -10359.67668416925, -10256.024571813316, -10310.665713289325, -10227.407575045285, -10365.03902160944, -10233.641164649478, -10200.106943486699, -10234.276043578178, -10252.52206434896, -10296.427550620718, -10307.722139013475, -10323.550039613632, -10302.736835020347, -10464.826511268471, -10186.453274958129, -10327.645199561208, -10251.488512639846, -10299.11150545407, -10186.978301361063, -10422.298201606058, -10203.978862128635, -10279.326384951695, -10232.82785382455, -10186.647753279978, -10189.651316755044, -10309.69442166719, -10253.631727034488, -10282.965828822144, -10191.267650172329, -10401.440520576993, -10259.825908429244, -10301.237089268665, -10243.32511920505, -10513.272457180254, -10252.464397127396, -10344.271634009863, -10266.593382856892, -10417.80895659611, -10280.01355759318, -10263.210234223949, -10238.645270301078, -10350.896136537418, -10347.172765046675, -10236.488530983775, -10244.897898459949, -10297.801423193558, -10215.851100087631, -10264.62527435672, -10398.938248705777, -10166.485032793184, -10320.901707805173, -10387.48365046927, -10436.73190404413, -10366.644575619715, -10252.515418741035, -10348.8462299472], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4262813251277047, "mean_inference_ms": 0.3712999808015915, "mean_action_processing_ms": 0.09124682389029248, "mean_env_wait_ms": 0.7374042520856616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003454446792602539, "StateBufferConnector_ms": 0.0025053024291992188, "ViewRequirementAgentConnector_ms": 0.06619954109191895}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52341360, "num_agent_steps_trained": 52341360, "num_env_steps_sampled": 52341360, "num_env_steps_trained": 52341360, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 272.6811032006664, "num_env_steps_trained_throughput_per_sec": 272.6811032006664, "timesteps_total": 52341360, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52341360, "timers": {"training_iteration_time_ms": 4365.814, "sample_time_ms": 4332.951, "load_time_ms": 0.574, "load_throughput": 2089143.616, "learn_time_ms": 31.467, "learn_throughput": 38135.294, "synch_weights_time_ms": 0.772}, "counters": {"num_env_steps_sampled": 52341360, "num_env_steps_trained": 52341360, "num_agent_steps_sampled": 52341360, "num_agent_steps_trained": 52341360}, "done": false, "episodes_total": 13074, "training_iteration": 4114, "trial_id": "9f686_00000", "date": "2023-08-08_16-07-02", "timestamp": 1691500022, "time_this_iter_s": 13.205127954483032, "time_total_s": 96439.13611507416, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3354.9629282951355, "iterations_since_restore": 254, "perf": {"cpu_util_percent": 19.694444444444443, "ram_util_percent": 65.21111111111112}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -363.7370876736111, "policy_loss": -3320807.605034722, "vf_loss": 21071262.555555556}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13743.5, "diff_num_grad_updates_vs_sampler_policy": 13742.5}}, "num_env_steps_sampled": 52344960, "num_env_steps_trained": 52344960, "num_agent_steps_sampled": 52344960, "num_agent_steps_trained": 52344960}, "sampler_results": {"episode_reward_max": -10155.743859132162, "episode_reward_min": -10513.272457180254, "episode_reward_mean": -10292.6307967227, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105, -10347.865590442256, -10494.127652948591, -10378.271153661508, -10486.215376611912, -10237.404043560799, -10165.994163249294, -10256.549219118442, -10222.763270961514, -10286.451951412399, -10213.13161281437, -10188.66885631587, -10155.743859132162, -10230.185848561938, -10307.940138040069, -10286.982473752038, -10348.818747929152, -10255.97201849884, -10349.686155294161, -10285.86594895591, -10258.61654528074, -10317.001647494477, -10442.974334206052, -10359.67668416925, -10256.024571813316, -10310.665713289325, -10227.407575045285, -10365.03902160944, -10233.641164649478, -10200.106943486699, -10234.276043578178, -10252.52206434896, -10296.427550620718, -10307.722139013475, -10323.550039613632, -10302.736835020347, -10464.826511268471, -10186.453274958129, -10327.645199561208, -10251.488512639846, -10299.11150545407, -10186.978301361063, -10422.298201606058, -10203.978862128635, -10279.326384951695, -10232.82785382455, -10186.647753279978, -10189.651316755044, -10309.69442166719, -10253.631727034488, -10282.965828822144, -10191.267650172329, -10401.440520576993, -10259.825908429244, -10301.237089268665, -10243.32511920505, -10513.272457180254, -10252.464397127396, -10344.271634009863, -10266.593382856892, -10417.80895659611, -10280.01355759318, -10263.210234223949, -10238.645270301078, -10350.896136537418, -10347.172765046675, -10236.488530983775, -10244.897898459949, -10297.801423193558, -10215.851100087631, -10264.62527435672, -10398.938248705777, -10166.485032793184, -10320.901707805173, -10387.48365046927, -10436.73190404413, -10366.644575619715, -10252.515418741035, -10348.8462299472, -10184.95877743203, -10210.283214415536, -10189.5745913205], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4261770776344544, "mean_inference_ms": 0.37129961259584476, "mean_action_processing_ms": 0.09124730845719611, "mean_env_wait_ms": 0.7373676425577336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034558773040771484, "StateBufferConnector_ms": 0.0025038719177246094, "ViewRequirementAgentConnector_ms": 0.06613492965698242}}, "episode_reward_max": -10155.743859132162, "episode_reward_min": -10513.272457180254, "episode_reward_mean": -10292.6307967227, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10322.670823696764, -10343.204275409102, -10361.904996845074, -10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105, -10347.865590442256, -10494.127652948591, -10378.271153661508, -10486.215376611912, -10237.404043560799, -10165.994163249294, -10256.549219118442, -10222.763270961514, -10286.451951412399, -10213.13161281437, -10188.66885631587, -10155.743859132162, -10230.185848561938, -10307.940138040069, -10286.982473752038, -10348.818747929152, -10255.97201849884, -10349.686155294161, -10285.86594895591, -10258.61654528074, -10317.001647494477, -10442.974334206052, -10359.67668416925, -10256.024571813316, -10310.665713289325, -10227.407575045285, -10365.03902160944, -10233.641164649478, -10200.106943486699, -10234.276043578178, -10252.52206434896, -10296.427550620718, -10307.722139013475, -10323.550039613632, -10302.736835020347, -10464.826511268471, -10186.453274958129, -10327.645199561208, -10251.488512639846, -10299.11150545407, -10186.978301361063, -10422.298201606058, -10203.978862128635, -10279.326384951695, -10232.82785382455, -10186.647753279978, -10189.651316755044, -10309.69442166719, -10253.631727034488, -10282.965828822144, -10191.267650172329, -10401.440520576993, -10259.825908429244, -10301.237089268665, -10243.32511920505, -10513.272457180254, -10252.464397127396, -10344.271634009863, -10266.593382856892, -10417.80895659611, -10280.01355759318, -10263.210234223949, -10238.645270301078, -10350.896136537418, -10347.172765046675, -10236.488530983775, -10244.897898459949, -10297.801423193558, -10215.851100087631, -10264.62527435672, -10398.938248705777, -10166.485032793184, -10320.901707805173, -10387.48365046927, -10436.73190404413, -10366.644575619715, -10252.515418741035, -10348.8462299472, -10184.95877743203, -10210.283214415536, -10189.5745913205], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4261770776344544, "mean_inference_ms": 0.37129961259584476, "mean_action_processing_ms": 0.09124730845719611, "mean_env_wait_ms": 0.7373676425577336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034558773040771484, "StateBufferConnector_ms": 0.0025038719177246094, "ViewRequirementAgentConnector_ms": 0.06613492965698242}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52344960, "num_agent_steps_trained": 52344960, "num_env_steps_sampled": 52344960, "num_env_steps_trained": 52344960, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 276.29648139470646, "num_env_steps_trained_throughput_per_sec": 276.29648139470646, "timesteps_total": 52344960, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52344960, "timers": {"training_iteration_time_ms": 4355.893, "sample_time_ms": 4323.019, "load_time_ms": 0.576, "load_throughput": 2084212.514, "learn_time_ms": 31.461, "learn_throughput": 38142.028, "synch_weights_time_ms": 0.787}, "counters": {"num_env_steps_sampled": 52344960, "num_env_steps_trained": 52344960, "num_agent_steps_sampled": 52344960, "num_agent_steps_trained": 52344960}, "done": false, "episodes_total": 13077, "training_iteration": 4115, "trial_id": "9f686_00000", "date": "2023-08-08_16-07-15", "timestamp": 1691500035, "time_this_iter_s": 13.032336235046387, "time_total_s": 96452.1684513092, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3367.995264530182, "iterations_since_restore": 255, "perf": {"cpu_util_percent": 19.873684210526317, "ram_util_percent": 65.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -361.9036509195964, "policy_loss": -3008714.373263889, "vf_loss": 20923430.638888888}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13797.5, "diff_num_grad_updates_vs_sampler_policy": 13796.5}}, "num_env_steps_sampled": 52348560, "num_env_steps_trained": 52348560, "num_agent_steps_sampled": 52348560, "num_agent_steps_trained": 52348560}, "sampler_results": {"episode_reward_max": -10155.743859132162, "episode_reward_min": -10513.272457180254, "episode_reward_mean": -10291.56612971895, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105, -10347.865590442256, -10494.127652948591, -10378.271153661508, -10486.215376611912, -10237.404043560799, -10165.994163249294, -10256.549219118442, -10222.763270961514, -10286.451951412399, -10213.13161281437, -10188.66885631587, -10155.743859132162, -10230.185848561938, -10307.940138040069, -10286.982473752038, -10348.818747929152, -10255.97201849884, -10349.686155294161, -10285.86594895591, -10258.61654528074, -10317.001647494477, -10442.974334206052, -10359.67668416925, -10256.024571813316, -10310.665713289325, -10227.407575045285, -10365.03902160944, -10233.641164649478, -10200.106943486699, -10234.276043578178, -10252.52206434896, -10296.427550620718, -10307.722139013475, -10323.550039613632, -10302.736835020347, -10464.826511268471, -10186.453274958129, -10327.645199561208, -10251.488512639846, -10299.11150545407, -10186.978301361063, -10422.298201606058, -10203.978862128635, -10279.326384951695, -10232.82785382455, -10186.647753279978, -10189.651316755044, -10309.69442166719, -10253.631727034488, -10282.965828822144, -10191.267650172329, -10401.440520576993, -10259.825908429244, -10301.237089268665, -10243.32511920505, -10513.272457180254, -10252.464397127396, -10344.271634009863, -10266.593382856892, -10417.80895659611, -10280.01355759318, -10263.210234223949, -10238.645270301078, -10350.896136537418, -10347.172765046675, -10236.488530983775, -10244.897898459949, -10297.801423193558, -10215.851100087631, -10264.62527435672, -10398.938248705777, -10166.485032793184, -10320.901707805173, -10387.48365046927, -10436.73190404413, -10366.644575619715, -10252.515418741035, -10348.8462299472, -10184.95877743203, -10210.283214415536, -10189.5745913205, -10275.603794926321, -10459.757430440155, -10185.952170209552], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4260737834616184, "mean_inference_ms": 0.3712995148105488, "mean_action_processing_ms": 0.09124783481110744, "mean_env_wait_ms": 0.7373317179740121, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003453969955444336, "StateBufferConnector_ms": 0.0025072097778320312, "ViewRequirementAgentConnector_ms": 0.06615257263183594}}, "episode_reward_max": -10155.743859132162, "episode_reward_min": -10513.272457180254, "episode_reward_mean": -10291.56612971895, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10494.199823139123, -10254.405129662768, -10321.449504687525, -10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105, -10347.865590442256, -10494.127652948591, -10378.271153661508, -10486.215376611912, -10237.404043560799, -10165.994163249294, -10256.549219118442, -10222.763270961514, -10286.451951412399, -10213.13161281437, -10188.66885631587, -10155.743859132162, -10230.185848561938, -10307.940138040069, -10286.982473752038, -10348.818747929152, -10255.97201849884, -10349.686155294161, -10285.86594895591, -10258.61654528074, -10317.001647494477, -10442.974334206052, -10359.67668416925, -10256.024571813316, -10310.665713289325, -10227.407575045285, -10365.03902160944, -10233.641164649478, -10200.106943486699, -10234.276043578178, -10252.52206434896, -10296.427550620718, -10307.722139013475, -10323.550039613632, -10302.736835020347, -10464.826511268471, -10186.453274958129, -10327.645199561208, -10251.488512639846, -10299.11150545407, -10186.978301361063, -10422.298201606058, -10203.978862128635, -10279.326384951695, -10232.82785382455, -10186.647753279978, -10189.651316755044, -10309.69442166719, -10253.631727034488, -10282.965828822144, -10191.267650172329, -10401.440520576993, -10259.825908429244, -10301.237089268665, -10243.32511920505, -10513.272457180254, -10252.464397127396, -10344.271634009863, -10266.593382856892, -10417.80895659611, -10280.01355759318, -10263.210234223949, -10238.645270301078, -10350.896136537418, -10347.172765046675, -10236.488530983775, -10244.897898459949, -10297.801423193558, -10215.851100087631, -10264.62527435672, -10398.938248705777, -10166.485032793184, -10320.901707805173, -10387.48365046927, -10436.73190404413, -10366.644575619715, -10252.515418741035, -10348.8462299472, -10184.95877743203, -10210.283214415536, -10189.5745913205, -10275.603794926321, -10459.757430440155, -10185.952170209552], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.4260737834616184, "mean_inference_ms": 0.3712995148105488, "mean_action_processing_ms": 0.09124783481110744, "mean_env_wait_ms": 0.7373317179740121, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003453969955444336, "StateBufferConnector_ms": 0.0025072097778320312, "ViewRequirementAgentConnector_ms": 0.06615257263183594}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52348560, "num_agent_steps_trained": 52348560, "num_env_steps_sampled": 52348560, "num_env_steps_trained": 52348560, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 272.80134446785513, "num_env_steps_trained_throughput_per_sec": 272.80134446785513, "timesteps_total": 52348560, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52348560, "timers": {"training_iteration_time_ms": 4379.206, "sample_time_ms": 4346.255, "load_time_ms": 0.577, "load_throughput": 2078360.16, "learn_time_ms": 31.536, "learn_throughput": 38051.857, "synch_weights_time_ms": 0.788}, "counters": {"num_env_steps_sampled": 52348560, "num_env_steps_trained": 52348560, "num_agent_steps_sampled": 52348560, "num_agent_steps_trained": 52348560}, "done": false, "episodes_total": 13080, "training_iteration": 4116, "trial_id": "9f686_00000", "date": "2023-08-08_16-07-28", "timestamp": 1691500048, "time_this_iter_s": 13.199352025985718, "time_total_s": 96465.36780333519, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3381.1946165561676, "iterations_since_restore": 256, "perf": {"cpu_util_percent": 19.805555555555557, "ram_util_percent": 65.08888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -364.09448581271704, "policy_loss": -6554418.246961806, "vf_loss": 21428481.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13851.5, "diff_num_grad_updates_vs_sampler_policy": 13850.5}}, "num_env_steps_sampled": 52352160, "num_env_steps_trained": 52352160, "num_agent_steps_sampled": 52352160, "num_agent_steps_trained": 52352160}, "sampler_results": {"episode_reward_max": -10155.743859132162, "episode_reward_min": -10513.272457180254, "episode_reward_mean": -10289.171294619578, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105, -10347.865590442256, -10494.127652948591, -10378.271153661508, -10486.215376611912, -10237.404043560799, -10165.994163249294, -10256.549219118442, -10222.763270961514, -10286.451951412399, -10213.13161281437, -10188.66885631587, -10155.743859132162, -10230.185848561938, -10307.940138040069, -10286.982473752038, -10348.818747929152, -10255.97201849884, -10349.686155294161, -10285.86594895591, -10258.61654528074, -10317.001647494477, -10442.974334206052, -10359.67668416925, -10256.024571813316, -10310.665713289325, -10227.407575045285, -10365.03902160944, -10233.641164649478, -10200.106943486699, -10234.276043578178, -10252.52206434896, -10296.427550620718, -10307.722139013475, -10323.550039613632, -10302.736835020347, -10464.826511268471, -10186.453274958129, -10327.645199561208, -10251.488512639846, -10299.11150545407, -10186.978301361063, -10422.298201606058, -10203.978862128635, -10279.326384951695, -10232.82785382455, -10186.647753279978, -10189.651316755044, -10309.69442166719, -10253.631727034488, -10282.965828822144, -10191.267650172329, -10401.440520576993, -10259.825908429244, -10301.237089268665, -10243.32511920505, -10513.272457180254, -10252.464397127396, -10344.271634009863, -10266.593382856892, -10417.80895659611, -10280.01355759318, -10263.210234223949, -10238.645270301078, -10350.896136537418, -10347.172765046675, -10236.488530983775, -10244.897898459949, -10297.801423193558, -10215.851100087631, -10264.62527435672, -10398.938248705777, -10166.485032793184, -10320.901707805173, -10387.48365046927, -10436.73190404413, -10366.644575619715, -10252.515418741035, -10348.8462299472, -10184.95877743203, -10210.283214415536, -10189.5745913205, -10275.603794926321, -10459.757430440155, -10185.952170209552, -10266.182887458435, -10308.748291316311, -10255.63976877728], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.425971080552441, "mean_inference_ms": 0.37129929775704523, "mean_action_processing_ms": 0.09124832340104166, "mean_env_wait_ms": 0.7372954722266648, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034503936767578125, "StateBufferConnector_ms": 0.002510547637939453, "ViewRequirementAgentConnector_ms": 0.06614398956298828}}, "episode_reward_max": -10155.743859132162, "episode_reward_min": -10513.272457180254, "episode_reward_mean": -10289.171294619578, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10265.260496303801, -10290.193383268528, -10274.525317049509, -10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105, -10347.865590442256, -10494.127652948591, -10378.271153661508, -10486.215376611912, -10237.404043560799, -10165.994163249294, -10256.549219118442, -10222.763270961514, -10286.451951412399, -10213.13161281437, -10188.66885631587, -10155.743859132162, -10230.185848561938, -10307.940138040069, -10286.982473752038, -10348.818747929152, -10255.97201849884, -10349.686155294161, -10285.86594895591, -10258.61654528074, -10317.001647494477, -10442.974334206052, -10359.67668416925, -10256.024571813316, -10310.665713289325, -10227.407575045285, -10365.03902160944, -10233.641164649478, -10200.106943486699, -10234.276043578178, -10252.52206434896, -10296.427550620718, -10307.722139013475, -10323.550039613632, -10302.736835020347, -10464.826511268471, -10186.453274958129, -10327.645199561208, -10251.488512639846, -10299.11150545407, -10186.978301361063, -10422.298201606058, -10203.978862128635, -10279.326384951695, -10232.82785382455, -10186.647753279978, -10189.651316755044, -10309.69442166719, -10253.631727034488, -10282.965828822144, -10191.267650172329, -10401.440520576993, -10259.825908429244, -10301.237089268665, -10243.32511920505, -10513.272457180254, -10252.464397127396, -10344.271634009863, -10266.593382856892, -10417.80895659611, -10280.01355759318, -10263.210234223949, -10238.645270301078, -10350.896136537418, -10347.172765046675, -10236.488530983775, -10244.897898459949, -10297.801423193558, -10215.851100087631, -10264.62527435672, -10398.938248705777, -10166.485032793184, -10320.901707805173, -10387.48365046927, -10436.73190404413, -10366.644575619715, -10252.515418741035, -10348.8462299472, -10184.95877743203, -10210.283214415536, -10189.5745913205, -10275.603794926321, -10459.757430440155, -10185.952170209552, -10266.182887458435, -10308.748291316311, -10255.63976877728], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.425971080552441, "mean_inference_ms": 0.37129929775704523, "mean_action_processing_ms": 0.09124832340104166, "mean_env_wait_ms": 0.7372954722266648, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034503936767578125, "StateBufferConnector_ms": 0.002510547637939453, "ViewRequirementAgentConnector_ms": 0.06614398956298828}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52352160, "num_agent_steps_trained": 52352160, "num_env_steps_sampled": 52352160, "num_env_steps_trained": 52352160, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 274.2225960410992, "num_env_steps_trained_throughput_per_sec": 274.2225960410992, "timesteps_total": 52352160, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52352160, "timers": {"training_iteration_time_ms": 4372.436, "sample_time_ms": 4339.583, "load_time_ms": 0.581, "load_throughput": 2065905.184, "learn_time_ms": 31.439, "learn_throughput": 38169.131, "synch_weights_time_ms": 0.782}, "counters": {"num_env_steps_sampled": 52352160, "num_env_steps_trained": 52352160, "num_agent_steps_sampled": 52352160, "num_agent_steps_trained": 52352160}, "done": false, "episodes_total": 13083, "training_iteration": 4117, "trial_id": "9f686_00000", "date": "2023-08-08_16-07-42", "timestamp": 1691500062, "time_this_iter_s": 13.130846977233887, "time_total_s": 96478.49865031242, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3394.3254635334015, "iterations_since_restore": 257, "perf": {"cpu_util_percent": 20.178947368421053, "ram_util_percent": 65.43684210526317}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -362.6780022515191, "policy_loss": -13279569.9140625, "vf_loss": 22146897.944444444}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13905.5, "diff_num_grad_updates_vs_sampler_policy": 13904.5}}, "num_env_steps_sampled": 52355760, "num_env_steps_trained": 52355760, "num_agent_steps_sampled": 52355760, "num_agent_steps_trained": 52355760}, "sampler_results": {"episode_reward_max": -10155.743859132162, "episode_reward_min": -10513.272457180254, "episode_reward_mean": -10291.860741082868, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105, -10347.865590442256, -10494.127652948591, -10378.271153661508, -10486.215376611912, -10237.404043560799, -10165.994163249294, -10256.549219118442, -10222.763270961514, -10286.451951412399, -10213.13161281437, -10188.66885631587, -10155.743859132162, -10230.185848561938, -10307.940138040069, -10286.982473752038, -10348.818747929152, -10255.97201849884, -10349.686155294161, -10285.86594895591, -10258.61654528074, -10317.001647494477, -10442.974334206052, -10359.67668416925, -10256.024571813316, -10310.665713289325, -10227.407575045285, -10365.03902160944, -10233.641164649478, -10200.106943486699, -10234.276043578178, -10252.52206434896, -10296.427550620718, -10307.722139013475, -10323.550039613632, -10302.736835020347, -10464.826511268471, -10186.453274958129, -10327.645199561208, -10251.488512639846, -10299.11150545407, -10186.978301361063, -10422.298201606058, -10203.978862128635, -10279.326384951695, -10232.82785382455, -10186.647753279978, -10189.651316755044, -10309.69442166719, -10253.631727034488, -10282.965828822144, -10191.267650172329, -10401.440520576993, -10259.825908429244, -10301.237089268665, -10243.32511920505, -10513.272457180254, -10252.464397127396, -10344.271634009863, -10266.593382856892, -10417.80895659611, -10280.01355759318, -10263.210234223949, -10238.645270301078, -10350.896136537418, -10347.172765046675, -10236.488530983775, -10244.897898459949, -10297.801423193558, -10215.851100087631, -10264.62527435672, -10398.938248705777, -10166.485032793184, -10320.901707805173, -10387.48365046927, -10436.73190404413, -10366.644575619715, -10252.515418741035, -10348.8462299472, -10184.95877743203, -10210.283214415536, -10189.5745913205, -10275.603794926321, -10459.757430440155, -10185.952170209552, -10266.182887458435, -10308.748291316311, -10255.63976877728, -10271.795778587028, -10349.58867578712, -10477.53938857672], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.42587031735247, "mean_inference_ms": 0.3712992881783403, "mean_action_processing_ms": 0.09124882955873352, "mean_env_wait_ms": 0.7372621284987316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003450155258178711, "StateBufferConnector_ms": 0.00251007080078125, "ViewRequirementAgentConnector_ms": 0.06619834899902344}}, "episode_reward_max": -10155.743859132162, "episode_reward_min": -10513.272457180254, "episode_reward_mean": -10291.860741082868, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10278.575060636702, -10230.714941285949, -10299.620577860658, -10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105, -10347.865590442256, -10494.127652948591, -10378.271153661508, -10486.215376611912, -10237.404043560799, -10165.994163249294, -10256.549219118442, -10222.763270961514, -10286.451951412399, -10213.13161281437, -10188.66885631587, -10155.743859132162, -10230.185848561938, -10307.940138040069, -10286.982473752038, -10348.818747929152, -10255.97201849884, -10349.686155294161, -10285.86594895591, -10258.61654528074, -10317.001647494477, -10442.974334206052, -10359.67668416925, -10256.024571813316, -10310.665713289325, -10227.407575045285, -10365.03902160944, -10233.641164649478, -10200.106943486699, -10234.276043578178, -10252.52206434896, -10296.427550620718, -10307.722139013475, -10323.550039613632, -10302.736835020347, -10464.826511268471, -10186.453274958129, -10327.645199561208, -10251.488512639846, -10299.11150545407, -10186.978301361063, -10422.298201606058, -10203.978862128635, -10279.326384951695, -10232.82785382455, -10186.647753279978, -10189.651316755044, -10309.69442166719, -10253.631727034488, -10282.965828822144, -10191.267650172329, -10401.440520576993, -10259.825908429244, -10301.237089268665, -10243.32511920505, -10513.272457180254, -10252.464397127396, -10344.271634009863, -10266.593382856892, -10417.80895659611, -10280.01355759318, -10263.210234223949, -10238.645270301078, -10350.896136537418, -10347.172765046675, -10236.488530983775, -10244.897898459949, -10297.801423193558, -10215.851100087631, -10264.62527435672, -10398.938248705777, -10166.485032793184, -10320.901707805173, -10387.48365046927, -10436.73190404413, -10366.644575619715, -10252.515418741035, -10348.8462299472, -10184.95877743203, -10210.283214415536, -10189.5745913205, -10275.603794926321, -10459.757430440155, -10185.952170209552, -10266.182887458435, -10308.748291316311, -10255.63976877728, -10271.795778587028, -10349.58867578712, -10477.53938857672], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.42587031735247, "mean_inference_ms": 0.3712992881783403, "mean_action_processing_ms": 0.09124882955873352, "mean_env_wait_ms": 0.7372621284987316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003450155258178711, "StateBufferConnector_ms": 0.00251007080078125, "ViewRequirementAgentConnector_ms": 0.06619834899902344}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52355760, "num_agent_steps_trained": 52355760, "num_env_steps_sampled": 52355760, "num_env_steps_trained": 52355760, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 272.01153482819905, "num_env_steps_trained_throughput_per_sec": 272.01153482819905, "timesteps_total": 52355760, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52355760, "timers": {"training_iteration_time_ms": 4387.535, "sample_time_ms": 4354.453, "load_time_ms": 0.578, "load_throughput": 2075617.469, "learn_time_ms": 31.672, "learn_throughput": 37888.925, "synch_weights_time_ms": 0.783}, "counters": {"num_env_steps_sampled": 52355760, "num_env_steps_trained": 52355760, "num_agent_steps_sampled": 52355760, "num_agent_steps_trained": 52355760}, "done": false, "episodes_total": 13086, "training_iteration": 4118, "trial_id": "9f686_00000", "date": "2023-08-08_16-07-55", "timestamp": 1691500075, "time_this_iter_s": 13.238036155700684, "time_total_s": 96491.73668646812, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3407.563499689102, "iterations_since_restore": 258, "perf": {"cpu_util_percent": 19.589473684210525, "ram_util_percent": 65.4736842105263}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -362.57015652126734, "policy_loss": -5341490.522569444, "vf_loss": 21224441.583333332}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13959.5, "diff_num_grad_updates_vs_sampler_policy": 13958.5}}, "num_env_steps_sampled": 52359360, "num_env_steps_trained": 52359360, "num_agent_steps_sampled": 52359360, "num_agent_steps_trained": 52359360}, "sampler_results": {"episode_reward_max": -10155.743859132162, "episode_reward_min": -10513.272457180254, "episode_reward_mean": -10291.814770671674, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105, -10347.865590442256, -10494.127652948591, -10378.271153661508, -10486.215376611912, -10237.404043560799, -10165.994163249294, -10256.549219118442, -10222.763270961514, -10286.451951412399, -10213.13161281437, -10188.66885631587, -10155.743859132162, -10230.185848561938, -10307.940138040069, -10286.982473752038, -10348.818747929152, -10255.97201849884, -10349.686155294161, -10285.86594895591, -10258.61654528074, -10317.001647494477, -10442.974334206052, -10359.67668416925, -10256.024571813316, -10310.665713289325, -10227.407575045285, -10365.03902160944, -10233.641164649478, -10200.106943486699, -10234.276043578178, -10252.52206434896, -10296.427550620718, -10307.722139013475, -10323.550039613632, -10302.736835020347, -10464.826511268471, -10186.453274958129, -10327.645199561208, -10251.488512639846, -10299.11150545407, -10186.978301361063, -10422.298201606058, -10203.978862128635, -10279.326384951695, -10232.82785382455, -10186.647753279978, -10189.651316755044, -10309.69442166719, -10253.631727034488, -10282.965828822144, -10191.267650172329, -10401.440520576993, -10259.825908429244, -10301.237089268665, -10243.32511920505, -10513.272457180254, -10252.464397127396, -10344.271634009863, -10266.593382856892, -10417.80895659611, -10280.01355759318, -10263.210234223949, -10238.645270301078, -10350.896136537418, -10347.172765046675, -10236.488530983775, -10244.897898459949, -10297.801423193558, -10215.851100087631, -10264.62527435672, -10398.938248705777, -10166.485032793184, -10320.901707805173, -10387.48365046927, -10436.73190404413, -10366.644575619715, -10252.515418741035, -10348.8462299472, -10184.95877743203, -10210.283214415536, -10189.5745913205, -10275.603794926321, -10459.757430440155, -10185.952170209552, -10266.182887458435, -10308.748291316311, -10255.63976877728, -10271.795778587028, -10349.58867578712, -10477.53938857672, -10283.123302488544, -10284.612283249233, -10236.577952925905], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.425771180926084, "mean_inference_ms": 0.37129943111685876, "mean_action_processing_ms": 0.0912493485979574, "mean_env_wait_ms": 0.7372254827973238, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034542083740234375, "StateBufferConnector_ms": 0.002510547637939453, "ViewRequirementAgentConnector_ms": 0.06626534461975098}}, "episode_reward_max": -10155.743859132162, "episode_reward_min": -10513.272457180254, "episode_reward_mean": -10291.814770671674, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10287.632006881617, -10326.009223682035, -10254.713142856472, -10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105, -10347.865590442256, -10494.127652948591, -10378.271153661508, -10486.215376611912, -10237.404043560799, -10165.994163249294, -10256.549219118442, -10222.763270961514, -10286.451951412399, -10213.13161281437, -10188.66885631587, -10155.743859132162, -10230.185848561938, -10307.940138040069, -10286.982473752038, -10348.818747929152, -10255.97201849884, -10349.686155294161, -10285.86594895591, -10258.61654528074, -10317.001647494477, -10442.974334206052, -10359.67668416925, -10256.024571813316, -10310.665713289325, -10227.407575045285, -10365.03902160944, -10233.641164649478, -10200.106943486699, -10234.276043578178, -10252.52206434896, -10296.427550620718, -10307.722139013475, -10323.550039613632, -10302.736835020347, -10464.826511268471, -10186.453274958129, -10327.645199561208, -10251.488512639846, -10299.11150545407, -10186.978301361063, -10422.298201606058, -10203.978862128635, -10279.326384951695, -10232.82785382455, -10186.647753279978, -10189.651316755044, -10309.69442166719, -10253.631727034488, -10282.965828822144, -10191.267650172329, -10401.440520576993, -10259.825908429244, -10301.237089268665, -10243.32511920505, -10513.272457180254, -10252.464397127396, -10344.271634009863, -10266.593382856892, -10417.80895659611, -10280.01355759318, -10263.210234223949, -10238.645270301078, -10350.896136537418, -10347.172765046675, -10236.488530983775, -10244.897898459949, -10297.801423193558, -10215.851100087631, -10264.62527435672, -10398.938248705777, -10166.485032793184, -10320.901707805173, -10387.48365046927, -10436.73190404413, -10366.644575619715, -10252.515418741035, -10348.8462299472, -10184.95877743203, -10210.283214415536, -10189.5745913205, -10275.603794926321, -10459.757430440155, -10185.952170209552, -10266.182887458435, -10308.748291316311, -10255.63976877728, -10271.795778587028, -10349.58867578712, -10477.53938857672, -10283.123302488544, -10284.612283249233, -10236.577952925905], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.425771180926084, "mean_inference_ms": 0.37129943111685876, "mean_action_processing_ms": 0.0912493485979574, "mean_env_wait_ms": 0.7372254827973238, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034542083740234375, "StateBufferConnector_ms": 0.002510547637939453, "ViewRequirementAgentConnector_ms": 0.06626534461975098}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52359360, "num_agent_steps_trained": 52359360, "num_env_steps_sampled": 52359360, "num_env_steps_trained": 52359360, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 274.130090739009, "num_env_steps_trained_throughput_per_sec": 274.130090739009, "timesteps_total": 52359360, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52359360, "timers": {"training_iteration_time_ms": 4387.787, "sample_time_ms": 4354.741, "load_time_ms": 0.579, "load_throughput": 2073992.418, "learn_time_ms": 31.648, "learn_throughput": 37917.297, "synch_weights_time_ms": 0.77}, "counters": {"num_env_steps_sampled": 52359360, "num_env_steps_trained": 52359360, "num_agent_steps_sampled": 52359360, "num_agent_steps_trained": 52359360}, "done": false, "episodes_total": 13089, "training_iteration": 4119, "trial_id": "9f686_00000", "date": "2023-08-08_16-08-08", "timestamp": 1691500088, "time_this_iter_s": 13.135273933410645, "time_total_s": 96504.87196040154, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3420.698773622513, "iterations_since_restore": 259, "perf": {"cpu_util_percent": 20.58333333333333, "ram_util_percent": 65.32777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-11, "entropy_coeff": 0.15, "policy_entropy": -362.54034593370227, "policy_loss": -6247662.258680556, "vf_loss": 21660200.388888888}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14013.5, "diff_num_grad_updates_vs_sampler_policy": 14012.5}}, "num_env_steps_sampled": 52362960, "num_env_steps_trained": 52362960, "num_agent_steps_sampled": 52362960, "num_agent_steps_trained": 52362960}, "sampler_results": {"episode_reward_max": -10155.743859132162, "episode_reward_min": -10556.890621581106, "episode_reward_mean": -10295.392546221505, "episode_len_mean": 1200.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105, -10347.865590442256, -10494.127652948591, -10378.271153661508, -10486.215376611912, -10237.404043560799, -10165.994163249294, -10256.549219118442, -10222.763270961514, -10286.451951412399, -10213.13161281437, -10188.66885631587, -10155.743859132162, -10230.185848561938, -10307.940138040069, -10286.982473752038, -10348.818747929152, -10255.97201849884, -10349.686155294161, -10285.86594895591, -10258.61654528074, -10317.001647494477, -10442.974334206052, -10359.67668416925, -10256.024571813316, -10310.665713289325, -10227.407575045285, -10365.03902160944, -10233.641164649478, -10200.106943486699, -10234.276043578178, -10252.52206434896, -10296.427550620718, -10307.722139013475, -10323.550039613632, -10302.736835020347, -10464.826511268471, -10186.453274958129, -10327.645199561208, -10251.488512639846, -10299.11150545407, -10186.978301361063, -10422.298201606058, -10203.978862128635, -10279.326384951695, -10232.82785382455, -10186.647753279978, -10189.651316755044, -10309.69442166719, -10253.631727034488, -10282.965828822144, -10191.267650172329, -10401.440520576993, -10259.825908429244, -10301.237089268665, -10243.32511920505, -10513.272457180254, -10252.464397127396, -10344.271634009863, -10266.593382856892, -10417.80895659611, -10280.01355759318, -10263.210234223949, -10238.645270301078, -10350.896136537418, -10347.172765046675, -10236.488530983775, -10244.897898459949, -10297.801423193558, -10215.851100087631, -10264.62527435672, -10398.938248705777, -10166.485032793184, -10320.901707805173, -10387.48365046927, -10436.73190404413, -10366.644575619715, -10252.515418741035, -10348.8462299472, -10184.95877743203, -10210.283214415536, -10189.5745913205, -10275.603794926321, -10459.757430440155, -10185.952170209552, -10266.182887458435, -10308.748291316311, -10255.63976877728, -10271.795778587028, -10349.58867578712, -10477.53938857672, -10283.123302488544, -10284.612283249233, -10236.577952925905, -10335.346056141196, -10556.890621581106, -10333.895250681142], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.425673051525196, "mean_inference_ms": 0.37129979886764625, "mean_action_processing_ms": 0.09124986649425652, "mean_env_wait_ms": 0.7371918110092595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003447294235229492, "StateBufferConnector_ms": 0.0025169849395751953, "ViewRequirementAgentConnector_ms": 0.06627464294433594}}, "episode_reward_max": -10155.743859132162, "episode_reward_min": -10556.890621581106, "episode_reward_mean": -10295.392546221505, "episode_len_mean": 1200.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-10207.441348298567, -10381.427471216624, -10325.782622879786, -10284.324259296105, -10347.865590442256, -10494.127652948591, -10378.271153661508, -10486.215376611912, -10237.404043560799, -10165.994163249294, -10256.549219118442, -10222.763270961514, -10286.451951412399, -10213.13161281437, -10188.66885631587, -10155.743859132162, -10230.185848561938, -10307.940138040069, -10286.982473752038, -10348.818747929152, -10255.97201849884, -10349.686155294161, -10285.86594895591, -10258.61654528074, -10317.001647494477, -10442.974334206052, -10359.67668416925, -10256.024571813316, -10310.665713289325, -10227.407575045285, -10365.03902160944, -10233.641164649478, -10200.106943486699, -10234.276043578178, -10252.52206434896, -10296.427550620718, -10307.722139013475, -10323.550039613632, -10302.736835020347, -10464.826511268471, -10186.453274958129, -10327.645199561208, -10251.488512639846, -10299.11150545407, -10186.978301361063, -10422.298201606058, -10203.978862128635, -10279.326384951695, -10232.82785382455, -10186.647753279978, -10189.651316755044, -10309.69442166719, -10253.631727034488, -10282.965828822144, -10191.267650172329, -10401.440520576993, -10259.825908429244, -10301.237089268665, -10243.32511920505, -10513.272457180254, -10252.464397127396, -10344.271634009863, -10266.593382856892, -10417.80895659611, -10280.01355759318, -10263.210234223949, -10238.645270301078, -10350.896136537418, -10347.172765046675, -10236.488530983775, -10244.897898459949, -10297.801423193558, -10215.851100087631, -10264.62527435672, -10398.938248705777, -10166.485032793184, -10320.901707805173, -10387.48365046927, -10436.73190404413, -10366.644575619715, -10252.515418741035, -10348.8462299472, -10184.95877743203, -10210.283214415536, -10189.5745913205, -10275.603794926321, -10459.757430440155, -10185.952170209552, -10266.182887458435, -10308.748291316311, -10255.63976877728, -10271.795778587028, -10349.58867578712, -10477.53938857672, -10283.123302488544, -10284.612283249233, -10236.577952925905, -10335.346056141196, -10556.890621581106, -10333.895250681142], "episode_lengths": [1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200, 1200]}, "sampler_perf": {"mean_raw_obs_processing_ms": 2.425673051525196, "mean_inference_ms": 0.37129979886764625, "mean_action_processing_ms": 0.09124986649425652, "mean_env_wait_ms": 0.7371918110092595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003447294235229492, "StateBufferConnector_ms": 0.0025169849395751953, "ViewRequirementAgentConnector_ms": 0.06627464294433594}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52362960, "num_agent_steps_trained": 52362960, "num_env_steps_sampled": 52362960, "num_env_steps_trained": 52362960, "num_env_steps_sampled_this_iter": 3600, "num_env_steps_trained_this_iter": 3600, "num_env_steps_sampled_throughput_per_sec": 270.6489506239304, "num_env_steps_trained_throughput_per_sec": 270.6489506239304, "timesteps_total": 52362960, "num_steps_trained_this_iter": 3600, "agent_timesteps_total": 52362960, "timers": {"training_iteration_time_ms": 4408.519, "sample_time_ms": 4375.357, "load_time_ms": 0.574, "load_throughput": 2089403.794, "learn_time_ms": 31.756, "learn_throughput": 37787.828, "synch_weights_time_ms": 0.782}, "counters": {"num_env_steps_sampled": 52362960, "num_env_steps_trained": 52362960, "num_agent_steps_sampled": 52362960, "num_agent_steps_trained": 52362960}, "done": true, "episodes_total": 13092, "training_iteration": 4120, "trial_id": "9f686_00000", "date": "2023-08-08_16-08-21", "timestamp": 1691500101, "time_this_iter_s": 13.304301977157593, "time_total_s": 96518.17626237869, "pid": 26622, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 10, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[51434160, 5e-08], [51446160, 5e-08], [51458160, 5e-08], [51470160, 2.5e-08], [51482160, 2.5e-08], [51494160, 2.5e-08], [51506160, 2.5e-08], [51518160, 1e-08], [51530160, 1e-08], [51542160, 1e-08], [51554160, 1e-08], [51566160, 1e-08], [51578160, 5e-09], [51590160, 5e-09], [51602160, 5e-09], [51614160, 5e-09], [51626160, 2.5e-09], [51638160, 2.5e-09], [51650160, 2.5e-09], [51662160, 2.5e-10], [51674160, 1e-10], [51686160, 1e-10], [51698160, 1e-10], [51710160, 5e-11], [51722160, 5e-11], [51734160, 5e-11]], "grad_clip": 15, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.27, "final_epsilon": 0.01, "epsilon_timesteps": 51746160}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 1200, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.15, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x14dd7b820>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3434.0030755996704, "iterations_since_restore": 260, "perf": {"cpu_util_percent": 20.173684210526318, "ram_util_percent": 65.28421052631579}}
