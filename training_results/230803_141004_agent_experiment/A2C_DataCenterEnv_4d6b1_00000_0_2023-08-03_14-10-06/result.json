{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.999999999999999e-11, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1561.5742119880877, "policy_loss": -2.838567001555026e+18, "vf_loss": 307094173.2827988}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 343.5, "diff_num_grad_updates_vs_sampler_policy": 342.5}}, "num_env_steps_sampled": 1291920, "num_env_steps_trained": 1291920, "num_agent_steps_sampled": 1291920, "num_agent_steps_trained": 1291920}, "sampler_results": {"episode_reward_max": -1360631.741058933, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1360631.741058933, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933], "episode_lengths": [43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21456452368799692, "mean_inference_ms": 0.36975294701027817, "mean_action_processing_ms": 0.09060639918837098, "mean_env_wait_ms": 0.7709399079780338, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031232833862304688, "StateBufferConnector_ms": 0.00247955322265625, "ViewRequirementAgentConnector_ms": 0.06465911865234375}}, "episode_reward_max": -1360631.741058933, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1360631.741058933, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933], "episode_lengths": [43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21456452368799692, "mean_inference_ms": 0.36975294701027817, "mean_action_processing_ms": 0.09060639918837098, "mean_env_wait_ms": 0.7709399079780338, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031232833862304688, "StateBufferConnector_ms": 0.00247955322265625, "ViewRequirementAgentConnector_ms": 0.06465911865234375}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1291920, "num_agent_steps_trained": 1291920, "num_env_steps_sampled": 1291920, "num_env_steps_trained": 1291920, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 670.9887054599442, "num_env_steps_trained_throughput_per_sec": 670.9887054599442, "timesteps_total": 1291920, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 1291920, "timers": {"training_iteration_time_ms": 65455.621, "sample_time_ms": 64325.233, "load_time_ms": 0.632, "load_throughput": 69514653.464, "learn_time_ms": 1128.699, "learn_throughput": 38912.047, "synch_weights_time_ms": 0.889}, "counters": {"num_env_steps_sampled": 1291920, "num_env_steps_trained": 1291920, "num_agent_steps_sampled": 1291920, "num_agent_steps_trained": 1291920}, "done": false, "episodes_total": 1220, "training_iteration": 341, "trial_id": "4d6b1_00000", "date": "2023-08-03_14-11-18", "timestamp": 1691061078, "time_this_iter_s": 65.45830202102661, "time_total_s": 4733.003059864044, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 65.45830202102661, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 18.486170212765956, "ram_util_percent": 60.89255319148937}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1593.0515287972053, "policy_loss": -8.638359710069383e+18, "vf_loss": 306550967.393586}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1029.5, "diff_num_grad_updates_vs_sampler_policy": 1028.5}}, "num_env_steps_sampled": 1335840, "num_env_steps_trained": 1335840, "num_agent_steps_sampled": 1335840, "num_agent_steps_trained": 1335840}, "sampler_results": {"episode_reward_max": -1359507.1590278465, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1360069.4500433898, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465], "episode_lengths": [43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2149718811716075, "mean_inference_ms": 0.3699437134347073, "mean_action_processing_ms": 0.09080673749749349, "mean_env_wait_ms": 0.7534893724499865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031709671020507812, "StateBufferConnector_ms": 0.0025510787963867188, "ViewRequirementAgentConnector_ms": 0.06455183029174805}}, "episode_reward_max": -1359507.1590278465, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1360069.4500433898, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465], "episode_lengths": [43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2149718811716075, "mean_inference_ms": 0.3699437134347073, "mean_action_processing_ms": 0.09080673749749349, "mean_env_wait_ms": 0.7534893724499865, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031709671020507812, "StateBufferConnector_ms": 0.0025510787963867188, "ViewRequirementAgentConnector_ms": 0.06455183029174805}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1335840, "num_agent_steps_trained": 1335840, "num_env_steps_sampled": 1335840, "num_env_steps_trained": 1335840, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 701.6750891319467, "num_env_steps_trained_throughput_per_sec": 701.6750891319467, "timesteps_total": 1335840, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 1335840, "timers": {"training_iteration_time_ms": 64024.337, "sample_time_ms": 62883.103, "load_time_ms": 9.58, "load_throughput": 4584600.475, "learn_time_ms": 1130.56, "learn_throughput": 38848.003, "synch_weights_time_ms": 0.93}, "counters": {"num_env_steps_sampled": 1335840, "num_env_steps_trained": 1335840, "num_agent_steps_sampled": 1335840, "num_agent_steps_trained": 1335840}, "done": false, "episodes_total": 1221, "training_iteration": 342, "trial_id": "4d6b1_00000", "date": "2023-08-03_14-12-21", "timestamp": 1691061141, "time_this_iter_s": 62.5958468914032, "time_total_s": 4795.598906755447, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 128.0541489124298, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 17.72247191011236, "ram_util_percent": 61.35168539325843}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.3e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1607.9170548241618, "policy_loss": -1.0681374325468326e+19, "vf_loss": 303772344.50145775}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 1715.5, "diff_num_grad_updates_vs_sampler_policy": 1714.5}}, "num_env_steps_sampled": 1379760, "num_env_steps_trained": 1379760, "num_agent_steps_sampled": 1379760, "num_agent_steps_trained": 1379760}, "sampler_results": {"episode_reward_max": -1353493.764670114, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1357877.5549189646, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114], "episode_lengths": [43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21629547033711505, "mean_inference_ms": 0.3732997856148183, "mean_action_processing_ms": 0.09156753776123046, "mean_env_wait_ms": 0.7447518956601128, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032186508178710938, "StateBufferConnector_ms": 0.0026384989420572915, "ViewRequirementAgentConnector_ms": 0.06461143493652344}}, "episode_reward_max": -1353493.764670114, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1357877.5549189646, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114], "episode_lengths": [43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21629547033711505, "mean_inference_ms": 0.3732997856148183, "mean_action_processing_ms": 0.09156753776123046, "mean_env_wait_ms": 0.7447518956601128, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032186508178710938, "StateBufferConnector_ms": 0.0026384989420572915, "ViewRequirementAgentConnector_ms": 0.06461143493652344}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1379760, "num_agent_steps_trained": 1379760, "num_env_steps_sampled": 1379760, "num_env_steps_trained": 1379760, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 675.854023938537, "num_env_steps_trained_throughput_per_sec": 675.854023938537, "timesteps_total": 1379760, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 1379760, "timers": {"training_iteration_time_ms": 64344.359, "sample_time_ms": 63204.498, "load_time_ms": 17.958, "load_throughput": 2445770.874, "learn_time_ms": 1120.791, "learn_throughput": 39186.623, "synch_weights_time_ms": 0.934}, "counters": {"num_env_steps_sampled": 1379760, "num_env_steps_trained": 1379760, "num_agent_steps_sampled": 1379760, "num_agent_steps_trained": 1379760}, "done": false, "episodes_total": 1222, "training_iteration": 343, "trial_id": "4d6b1_00000", "date": "2023-08-03_14-13-26", "timestamp": 1691061206, "time_this_iter_s": 64.98732304573059, "time_total_s": 4860.586229801178, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 193.0414719581604, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 23.590217391304346, "ram_util_percent": 61.748913043478254}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.600000000000001e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1615.879583864796, "policy_loss": -1.2931051790392056e+19, "vf_loss": 302464643.93002915}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 2401.5, "diff_num_grad_updates_vs_sampler_policy": 2400.5}}, "num_env_steps_sampled": 1423680, "num_env_steps_trained": 1423680, "num_agent_steps_sampled": 1423680, "num_agent_steps_trained": 1423680}, "sampler_results": {"episode_reward_max": -1350513.5260616252, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1356036.5477046296, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252], "episode_lengths": [43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21699469836801183, "mean_inference_ms": 0.37482555431468306, "mean_action_processing_ms": 0.09193334798460057, "mean_env_wait_ms": 0.7372428513693267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003230571746826172, "StateBufferConnector_ms": 0.002664327621459961, "ViewRequirementAgentConnector_ms": 0.06452798843383789}}, "episode_reward_max": -1350513.5260616252, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1356036.5477046296, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252], "episode_lengths": [43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21699469836801183, "mean_inference_ms": 0.37482555431468306, "mean_action_processing_ms": 0.09193334798460057, "mean_env_wait_ms": 0.7372428513693267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003230571746826172, "StateBufferConnector_ms": 0.002664327621459961, "ViewRequirementAgentConnector_ms": 0.06452798843383789}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1423680, "num_agent_steps_trained": 1423680, "num_env_steps_sampled": 1423680, "num_env_steps_trained": 1423680, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 707.8931226664265, "num_env_steps_trained_throughput_per_sec": 707.8931226664265, "timesteps_total": 1423680, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 1423680, "timers": {"training_iteration_time_ms": 63769.08, "sample_time_ms": 62631.797, "load_time_ms": 18.256, "load_throughput": 2405838.247, "learn_time_ms": 1117.91, "learn_throughput": 39287.6, "synch_weights_time_ms": 0.941}, "counters": {"num_env_steps_sampled": 1423680, "num_env_steps_trained": 1423680, "num_agent_steps_sampled": 1423680, "num_agent_steps_trained": 1423680}, "done": false, "episodes_total": 1223, "training_iteration": 344, "trial_id": "4d6b1_00000", "date": "2023-08-03_14-14-28", "timestamp": 1691061268, "time_this_iter_s": 62.04583191871643, "time_total_s": 4922.632061719894, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 255.08730387687683, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 19.817045454545454, "ram_util_percent": 62.22840909090908}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.899999999999999e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1621.4709477994602, "policy_loss": -1.5846150471348484e+19, "vf_loss": 302817956.4373178}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3087.5, "diff_num_grad_updates_vs_sampler_policy": 3086.5}}, "num_env_steps_sampled": 1467600, "num_env_steps_trained": 1467600, "num_agent_steps_sampled": 1467600, "num_agent_steps_trained": 1467600}, "sampler_results": {"episode_reward_max": -1350513.5260616252, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1355078.4412639525, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438], "episode_lengths": [43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21744062672955938, "mean_inference_ms": 0.3753510942189989, "mean_action_processing_ms": 0.09208772351711017, "mean_env_wait_ms": 0.7313070336002966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038242340087890625, "StateBufferConnector_ms": 0.002689361572265625, "ViewRequirementAgentConnector_ms": 0.06550312042236328}}, "episode_reward_max": -1350513.5260616252, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1355078.4412639525, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438], "episode_lengths": [43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21744062672955938, "mean_inference_ms": 0.3753510942189989, "mean_action_processing_ms": 0.09208772351711017, "mean_env_wait_ms": 0.7313070336002966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038242340087890625, "StateBufferConnector_ms": 0.002689361572265625, "ViewRequirementAgentConnector_ms": 0.06550312042236328}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1467600, "num_agent_steps_trained": 1467600, "num_env_steps_sampled": 1467600, "num_env_steps_trained": 1467600, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 709.8348252456805, "num_env_steps_trained_throughput_per_sec": 709.8348252456805, "timesteps_total": 1467600, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 1467600, "timers": {"training_iteration_time_ms": 63389.97, "sample_time_ms": 62228.34, "load_time_ms": 18.6, "load_throughput": 2361310.13, "learn_time_ms": 1141.856, "learn_throughput": 38463.696, "synch_weights_time_ms": 0.989}, "counters": {"num_env_steps_sampled": 1467600, "num_env_steps_trained": 1467600, "num_agent_steps_sampled": 1467600, "num_agent_steps_trained": 1467600}, "done": false, "episodes_total": 1224, "training_iteration": 345, "trial_id": "4d6b1_00000", "date": "2023-08-03_14-15-30", "timestamp": 1691061330, "time_this_iter_s": 61.8774311542511, "time_total_s": 4984.5094928741455, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 316.96473503112793, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 18.823863636363637, "ram_util_percent": 62.4215909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.200000000000001e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1625.6668261647571, "policy_loss": -1.8233647649450527e+19, "vf_loss": 305100632.9912537}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3773.5, "diff_num_grad_updates_vs_sampler_policy": 3772.5}}, "num_env_steps_sampled": 1511520, "num_env_steps_trained": 1511520, "num_agent_steps_sampled": 1511520, "num_agent_steps_trained": 1511520}, "sampler_results": {"episode_reward_max": -1350513.5260616252, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1355334.7502497763, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2182147531261384, "mean_inference_ms": 0.37603904376726827, "mean_action_processing_ms": 0.09226822613132564, "mean_env_wait_ms": 0.7269239712163053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003723303476969401, "StateBufferConnector_ms": 0.0027736028035481772, "ViewRequirementAgentConnector_ms": 0.06583929061889648}}, "episode_reward_max": -1350513.5260616252, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1355334.7502497763, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2182147531261384, "mean_inference_ms": 0.37603904376726827, "mean_action_processing_ms": 0.09226822613132564, "mean_env_wait_ms": 0.7269239712163053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003723303476969401, "StateBufferConnector_ms": 0.0027736028035481772, "ViewRequirementAgentConnector_ms": 0.06583929061889648}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1511520, "num_agent_steps_trained": 1511520, "num_env_steps_sampled": 1511520, "num_env_steps_trained": 1511520, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 685.192224893019, "num_env_steps_trained_throughput_per_sec": 685.192224893019, "timesteps_total": 1511520, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 1511520, "timers": {"training_iteration_time_ms": 63508.105, "sample_time_ms": 62352.738, "load_time_ms": 18.339, "load_throughput": 2394911.931, "learn_time_ms": 1135.851, "learn_throughput": 38667.029, "synch_weights_time_ms": 0.997}, "counters": {"num_env_steps_sampled": 1511520, "num_env_steps_trained": 1511520, "num_agent_steps_sampled": 1511520, "num_agent_steps_trained": 1511520}, "done": false, "episodes_total": 1225, "training_iteration": 346, "trial_id": "4d6b1_00000", "date": "2023-08-03_14-16-34", "timestamp": 1691061394, "time_this_iter_s": 64.10119199752808, "time_total_s": 5048.610684871674, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 381.065927028656, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 23.084615384615383, "ram_util_percent": 62.487912087912086}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.5000000000000004e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1629.2187437719228, "policy_loss": -1.9613891954380173e+19, "vf_loss": 303395004.6472303}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 4459.5, "diff_num_grad_updates_vs_sampler_policy": 4458.5}}, "num_env_steps_sampled": 1555440, "num_env_steps_trained": 1555440, "num_agent_steps_sampled": 1555440, "num_agent_steps_trained": 1555440}, "sampler_results": {"episode_reward_max": -1350513.5260616252, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1354941.664969042, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21903477143792613, "mean_inference_ms": 0.37701245827555085, "mean_action_processing_ms": 0.09250627221343302, "mean_env_wait_ms": 0.7238458897238099, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036273683820452008, "StateBufferConnector_ms": 0.0027622495378766742, "ViewRequirementAgentConnector_ms": 0.066202027457101}}, "episode_reward_max": -1350513.5260616252, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1354941.664969042, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21903477143792613, "mean_inference_ms": 0.37701245827555085, "mean_action_processing_ms": 0.09250627221343302, "mean_env_wait_ms": 0.7238458897238099, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036273683820452008, "StateBufferConnector_ms": 0.0027622495378766742, "ViewRequirementAgentConnector_ms": 0.066202027457101}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1555440, "num_agent_steps_trained": 1555440, "num_env_steps_sampled": 1555440, "num_env_steps_trained": 1555440, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 664.3822613791859, "num_env_steps_trained_throughput_per_sec": 664.3822613791859, "timesteps_total": 1555440, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 1555440, "timers": {"training_iteration_time_ms": 63879.304, "sample_time_ms": 62645.065, "load_time_ms": 18.936, "load_throughput": 2319368.205, "learn_time_ms": 1214.131, "learn_throughput": 36174.006, "synch_weights_time_ms": 0.987}, "counters": {"num_env_steps_sampled": 1555440, "num_env_steps_trained": 1555440, "num_agent_steps_sampled": 1555440, "num_agent_steps_trained": 1555440}, "done": false, "episodes_total": 1226, "training_iteration": 347, "trial_id": "4d6b1_00000", "date": "2023-08-03_14-17-40", "timestamp": 1691061460, "time_this_iter_s": 66.1091377735138, "time_total_s": 5114.719822645187, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 447.1750648021698, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 25.555319148936178, "ram_util_percent": 62.727659574468085}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.8e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1633.9210665955836, "policy_loss": -2.226585240334584e+19, "vf_loss": 301788308.05247813}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5145.5, "diff_num_grad_updates_vs_sampler_policy": 5144.5}}, "num_env_steps_sampled": 1599360, "num_env_steps_trained": 1599360, "num_agent_steps_sampled": 1599360, "num_agent_steps_trained": 1599360}, "sampler_results": {"episode_reward_max": -1349043.6249094796, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1354204.4099615966, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21967958946118152, "mean_inference_ms": 0.37810918854486386, "mean_action_processing_ms": 0.0927510219129791, "mean_env_wait_ms": 0.7213709510332356, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003567337989807129, "StateBufferConnector_ms": 0.002709031105041504, "ViewRequirementAgentConnector_ms": 0.06607174873352051}}, "episode_reward_max": -1349043.6249094796, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1354204.4099615966, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21967958946118152, "mean_inference_ms": 0.37810918854486386, "mean_action_processing_ms": 0.0927510219129791, "mean_env_wait_ms": 0.7213709510332356, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003567337989807129, "StateBufferConnector_ms": 0.002709031105041504, "ViewRequirementAgentConnector_ms": 0.06607174873352051}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1599360, "num_agent_steps_trained": 1599360, "num_env_steps_sampled": 1599360, "num_env_steps_trained": 1599360, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 672.2640612612106, "num_env_steps_trained_throughput_per_sec": 672.2640612612106, "timesteps_total": 1599360, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 1599360, "timers": {"training_iteration_time_ms": 64060.823, "sample_time_ms": 62790.314, "load_time_ms": 19.317, "load_throughput": 2273627.307, "learn_time_ms": 1250.02, "learn_throughput": 35135.43, "synch_weights_time_ms": 0.986}, "counters": {"num_env_steps_sampled": 1599360, "num_env_steps_trained": 1599360, "num_agent_steps_sampled": 1599360, "num_agent_steps_trained": 1599360}, "done": false, "episodes_total": 1227, "training_iteration": 348, "trial_id": "4d6b1_00000", "date": "2023-08-03_14-18-45", "timestamp": 1691061525, "time_this_iter_s": 65.33435988426208, "time_total_s": 5180.0541825294495, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 512.5094246864319, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 26.851612903225803, "ram_util_percent": 63.406451612903226}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.099999999999997e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1637.1129447558878, "policy_loss": -2.5524248154223735e+19, "vf_loss": 300609789.9008746}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 5831.5, "diff_num_grad_updates_vs_sampler_policy": 5830.5}}, "num_env_steps_sampled": 1643280, "num_env_steps_trained": 1643280, "num_agent_steps_sampled": 1643280, "num_agent_steps_trained": 1643280}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1353333.3148720714, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22009068075066182, "mean_inference_ms": 0.37883436940805815, "mean_action_processing_ms": 0.09291267353383209, "mean_env_wait_ms": 0.7190105863164075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035418404473198783, "StateBufferConnector_ms": 0.0026755862765842015, "ViewRequirementAgentConnector_ms": 0.06593598259819879}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1353333.3148720714, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22009068075066182, "mean_inference_ms": 0.37883436940805815, "mean_action_processing_ms": 0.09291267353383209, "mean_env_wait_ms": 0.7190105863164075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035418404473198783, "StateBufferConnector_ms": 0.0026755862765842015, "ViewRequirementAgentConnector_ms": 0.06593598259819879}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1643280, "num_agent_steps_trained": 1643280, "num_env_steps_sampled": 1643280, "num_env_steps_trained": 1643280, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 714.7762874746297, "num_env_steps_trained_throughput_per_sec": 714.7762874746297, "timesteps_total": 1643280, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 1643280, "timers": {"training_iteration_time_ms": 63770.262, "sample_time_ms": 62513.779, "load_time_ms": 19.19, "load_throughput": 2288648.566, "learn_time_ms": 1236.137, "learn_throughput": 35530.032, "synch_weights_time_ms": 0.974}, "counters": {"num_env_steps_sampled": 1643280, "num_env_steps_trained": 1643280, "num_agent_steps_sampled": 1643280, "num_agent_steps_trained": 1643280}, "done": false, "episodes_total": 1228, "training_iteration": 349, "trial_id": "4d6b1_00000", "date": "2023-08-03_14-19-47", "timestamp": 1691061587, "time_this_iter_s": 61.448354721069336, "time_total_s": 5241.502537250519, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 573.9577794075012, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 19.622727272727275, "ram_util_percent": 63.23409090909092}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.400000000000001e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1641.5307665232667, "policy_loss": -2.9147002404072333e+19, "vf_loss": 304735580.06997085}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 6517.5, "diff_num_grad_updates_vs_sampler_policy": 6516.5}}, "num_env_steps_sampled": 1687200, "num_env_steps_trained": 1687200, "num_agent_steps_sampled": 1687200, "num_agent_steps_trained": 1687200}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1353558.6495121927, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2203456053649672, "mean_inference_ms": 0.3792569292479847, "mean_action_processing_ms": 0.09301377001533527, "mean_env_wait_ms": 0.7169592137022106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038385391235351562, "StateBufferConnector_ms": 0.0026726722717285156, "ViewRequirementAgentConnector_ms": 0.06607532501220703}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1353558.6495121927, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2203456053649672, "mean_inference_ms": 0.3792569292479847, "mean_action_processing_ms": 0.09301377001533527, "mean_env_wait_ms": 0.7169592137022106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038385391235351562, "StateBufferConnector_ms": 0.0026726722717285156, "ViewRequirementAgentConnector_ms": 0.06607532501220703}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1687200, "num_agent_steps_trained": 1687200, "num_env_steps_sampled": 1687200, "num_env_steps_trained": 1687200, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 711.5898233886323, "num_env_steps_trained_throughput_per_sec": 711.5898233886323, "timesteps_total": 1687200, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 1687200, "timers": {"training_iteration_time_ms": 63565.329, "sample_time_ms": 62321.301, "load_time_ms": 18.976, "load_throughput": 2314499.991, "learn_time_ms": 1223.901, "learn_throughput": 35885.252, "synch_weights_time_ms": 0.972}, "counters": {"num_env_steps_sampled": 1687200, "num_env_steps_trained": 1687200, "num_agent_steps_sampled": 1687200, "num_agent_steps_trained": 1687200}, "done": false, "episodes_total": 1229, "training_iteration": 350, "trial_id": "4d6b1_00000", "date": "2023-08-03_14-20-48", "timestamp": 1691061648, "time_this_iter_s": 61.723676919937134, "time_total_s": 5303.226214170456, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 635.6814563274384, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 17.594318181818185, "ram_util_percent": 63.09772727272727}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.699999999999999e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1645.2861509628963, "policy_loss": -3.301121415748022e+19, "vf_loss": 303847304.38483965}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7203.5, "diff_num_grad_updates_vs_sampler_policy": 7202.5}}, "num_env_steps_sampled": 1731120, "num_env_steps_trained": 1731120, "num_agent_steps_sampled": 1731120, "num_agent_steps_trained": 1731120}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1353561.6511722347, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2205117825429129, "mean_inference_ms": 0.37949902576197375, "mean_action_processing_ms": 0.09307613453604589, "mean_env_wait_ms": 0.7151387628607329, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037648461081764913, "StateBufferConnector_ms": 0.002687627618963068, "ViewRequirementAgentConnector_ms": 0.06625652313232422}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1353561.6511722347, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2205117825429129, "mean_inference_ms": 0.37949902576197375, "mean_action_processing_ms": 0.09307613453604589, "mean_env_wait_ms": 0.7151387628607329, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037648461081764913, "StateBufferConnector_ms": 0.002687627618963068, "ViewRequirementAgentConnector_ms": 0.06625652313232422}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1731120, "num_agent_steps_trained": 1731120, "num_env_steps_sampled": 1731120, "num_env_steps_trained": 1731120, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 711.0297671104233, "num_env_steps_trained_throughput_per_sec": 711.0297671104233, "timesteps_total": 1731120, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 1731120, "timers": {"training_iteration_time_ms": 63196.722, "sample_time_ms": 61951.845, "load_time_ms": 20.606, "load_throughput": 2131453.256, "learn_time_ms": 1223.12, "learn_throughput": 35908.17, "synch_weights_time_ms": 0.973}, "counters": {"num_env_steps_sampled": 1731120, "num_env_steps_trained": 1731120, "num_agent_steps_sampled": 1731120, "num_agent_steps_trained": 1731120}, "done": false, "episodes_total": 1230, "training_iteration": 351, "trial_id": "4d6b1_00000", "date": "2023-08-03_14-21-50", "timestamp": 1691061710, "time_this_iter_s": 61.772149085998535, "time_total_s": 5364.9983632564545, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 697.4536054134369, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 16.93333333333333, "ram_util_percent": 63.279310344827586}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.000000000000001e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1649.3927087366756, "policy_loss": -3.5729000447738294e+19, "vf_loss": 303109438.64139944}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7889.5, "diff_num_grad_updates_vs_sampler_policy": 7888.5}}, "num_env_steps_sampled": 1775040, "num_env_steps_trained": 1775040, "num_agent_steps_sampled": 1775040, "num_agent_steps_trained": 1775040}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1353436.9005487263, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2205865089044509, "mean_inference_ms": 0.3796127600844308, "mean_action_processing_ms": 0.09310990218306014, "mean_env_wait_ms": 0.7134653809848789, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036895275115966797, "StateBufferConnector_ms": 0.002674261728922526, "ViewRequirementAgentConnector_ms": 0.06619493166605632}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1353436.9005487263, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2205865089044509, "mean_inference_ms": 0.3796127600844308, "mean_action_processing_ms": 0.09310990218306014, "mean_env_wait_ms": 0.7134653809848789, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036895275115966797, "StateBufferConnector_ms": 0.002674261728922526, "ViewRequirementAgentConnector_ms": 0.06619493166605632}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1775040, "num_agent_steps_trained": 1775040, "num_env_steps_sampled": 1775040, "num_env_steps_trained": 1775040, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 717.7250208543464, "num_env_steps_trained_throughput_per_sec": 717.7250208543464, "timesteps_total": 1775040, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 1775040, "timers": {"training_iteration_time_ms": 63056.75, "sample_time_ms": 61813.958, "load_time_ms": 20.444, "load_throughput": 2148311.354, "learn_time_ms": 1221.203, "learn_throughput": 35964.548, "synch_weights_time_ms": 0.967}, "counters": {"num_env_steps_sampled": 1775040, "num_env_steps_trained": 1775040, "num_agent_steps_sampled": 1775040, "num_agent_steps_trained": 1775040}, "done": false, "episodes_total": 1231, "training_iteration": 352, "trial_id": "4d6b1_00000", "date": "2023-08-03_14-22-51", "timestamp": 1691061771, "time_this_iter_s": 61.196155071258545, "time_total_s": 5426.194518327713, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 758.6497604846954, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 17.816091954022987, "ram_util_percent": 63.2735632183908}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.449999999999999e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1652.4767673147662, "policy_loss": -4.084662018592254e+19, "vf_loss": 304539443.44023323}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 8575.5, "diff_num_grad_updates_vs_sampler_policy": 8574.5}}, "num_env_steps_sampled": 1818960, "num_env_steps_trained": 1818960, "num_agent_steps_sampled": 1818960, "num_agent_steps_trained": 1818960}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1353578.5911986965, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22061779390044417, "mean_inference_ms": 0.3796408872917723, "mean_action_processing_ms": 0.09312620368335518, "mean_env_wait_ms": 0.7119635884609193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036679781400240385, "StateBufferConnector_ms": 0.0026904619657076322, "ViewRequirementAgentConnector_ms": 0.06623084728534405}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1353578.5911986965, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22061779390044417, "mean_inference_ms": 0.3796408872917723, "mean_action_processing_ms": 0.09312620368335518, "mean_env_wait_ms": 0.7119635884609193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036679781400240385, "StateBufferConnector_ms": 0.0026904619657076322, "ViewRequirementAgentConnector_ms": 0.06623084728534405}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1818960, "num_agent_steps_trained": 1818960, "num_env_steps_sampled": 1818960, "num_env_steps_trained": 1818960, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 712.5915006131424, "num_env_steps_trained_throughput_per_sec": 712.5915006131424, "timesteps_total": 1818960, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 1818960, "timers": {"training_iteration_time_ms": 62721.726, "sample_time_ms": 61476.748, "load_time_ms": 18.784, "load_throughput": 2338154.389, "learn_time_ms": 1225.057, "learn_throughput": 35851.392, "synch_weights_time_ms": 0.964}, "counters": {"num_env_steps_sampled": 1818960, "num_env_steps_trained": 1818960, "num_agent_steps_sampled": 1818960, "num_agent_steps_trained": 1818960}, "done": false, "episodes_total": 1232, "training_iteration": 353, "trial_id": "4d6b1_00000", "date": "2023-08-03_14-23-53", "timestamp": 1691061833, "time_this_iter_s": 61.63696098327637, "time_total_s": 5487.831479310989, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 820.2867214679718, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 17.226136363636364, "ram_util_percent": 63.30454545454545}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.900000000000001e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1654.11075336245, "policy_loss": -3.984256750765208e+19, "vf_loss": 304536606.64139944}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9261.5, "diff_num_grad_updates_vs_sampler_policy": 9260.5}}, "num_env_steps_sampled": 1862880, "num_env_steps_trained": 1862880, "num_agent_steps_sampled": 1862880, "num_agent_steps_trained": 1862880}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1353686.855197915, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22062260899186967, "mean_inference_ms": 0.37961760985368215, "mean_action_processing_ms": 0.09313120097486186, "mean_env_wait_ms": 0.7105676946896768, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003630774361746652, "StateBufferConnector_ms": 0.0026805060250418527, "ViewRequirementAgentConnector_ms": 0.06611858095441546}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1353686.855197915, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22062260899186967, "mean_inference_ms": 0.37961760985368215, "mean_action_processing_ms": 0.09313120097486186, "mean_env_wait_ms": 0.7105676946896768, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003630774361746652, "StateBufferConnector_ms": 0.0026805060250418527, "ViewRequirementAgentConnector_ms": 0.06611858095441546}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1862880, "num_agent_steps_trained": 1862880, "num_env_steps_sampled": 1862880, "num_env_steps_trained": 1862880, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 715.6004310465753, "num_env_steps_trained_throughput_per_sec": 715.6004310465753, "timesteps_total": 1862880, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 1862880, "timers": {"training_iteration_time_ms": 62654.903, "sample_time_ms": 61407.973, "load_time_ms": 18.585, "load_throughput": 2363188.239, "learn_time_ms": 1227.217, "learn_throughput": 35788.29, "synch_weights_time_ms": 0.957}, "counters": {"num_env_steps_sampled": 1862880, "num_env_steps_trained": 1862880, "num_agent_steps_sampled": 1862880, "num_agent_steps_trained": 1862880}, "done": false, "episodes_total": 1233, "training_iteration": 354, "trial_id": "4d6b1_00000", "date": "2023-08-03_14-24-54", "timestamp": 1691061894, "time_this_iter_s": 61.37753701210022, "time_total_s": 5549.20901632309, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 881.664258480072, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 17.70919540229885, "ram_util_percent": 60.27816091954024}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.350000000000001e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1655.9234165380717, "policy_loss": -4.0633805484798484e+19, "vf_loss": 300751867.13702625}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 9947.5, "diff_num_grad_updates_vs_sampler_policy": 9946.5}}, "num_env_steps_sampled": 1906800, "num_env_steps_trained": 1906800, "num_agent_steps_sampled": 1906800, "num_agent_steps_trained": 1906800}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1353225.9036822866, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22060667092651276, "mean_inference_ms": 0.37955300786591883, "mean_action_processing_ms": 0.09312764233015654, "mean_env_wait_ms": 0.7092774350610164, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035953521728515625, "StateBufferConnector_ms": 0.002673467000325521, "ViewRequirementAgentConnector_ms": 0.06640275319417317}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1353225.9036822866, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22060667092651276, "mean_inference_ms": 0.37955300786591883, "mean_action_processing_ms": 0.09312764233015654, "mean_env_wait_ms": 0.7092774350610164, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035953521728515625, "StateBufferConnector_ms": 0.002673467000325521, "ViewRequirementAgentConnector_ms": 0.06640275319417317}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1906800, "num_agent_steps_trained": 1906800, "num_env_steps_sampled": 1906800, "num_env_steps_trained": 1906800, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 715.8623038645703, "num_env_steps_trained_throughput_per_sec": 715.8623038645703, "timesteps_total": 1906800, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 1906800, "timers": {"training_iteration_time_ms": 62602.807, "sample_time_ms": 61367.214, "load_time_ms": 18.168, "load_throughput": 2417374.284, "learn_time_ms": 1216.329, "learn_throughput": 36108.653, "synch_weights_time_ms": 0.929}, "counters": {"num_env_steps_sampled": 1906800, "num_env_steps_trained": 1906800, "num_agent_steps_sampled": 1906800, "num_agent_steps_trained": 1906800}, "done": false, "episodes_total": 1234, "training_iteration": 355, "trial_id": "4d6b1_00000", "date": "2023-08-03_14-25-56", "timestamp": 1691061956, "time_this_iter_s": 61.35511088371277, "time_total_s": 5610.564127206802, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 943.0193693637848, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 17.30454545454545, "ram_util_percent": 60.0125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.799999999999999e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1658.0552051421853, "policy_loss": -4.842930608739099e+19, "vf_loss": 303088870.2915452}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 10633.5, "diff_num_grad_updates_vs_sampler_policy": 10632.5}}, "num_env_steps_sampled": 1950720, "num_env_steps_trained": 1950720, "num_agent_steps_sampled": 1950720, "num_agent_steps_trained": 1950720}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1353153.5068106335, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22057727740113878, "mean_inference_ms": 0.3794579166491666, "mean_action_processing_ms": 0.09311755817220126, "mean_env_wait_ms": 0.7080771147626221, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035494565963745117, "StateBufferConnector_ms": 0.0026747584342956543, "ViewRequirementAgentConnector_ms": 0.06641298532485962}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1353153.5068106335, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22057727740113878, "mean_inference_ms": 0.3794579166491666, "mean_action_processing_ms": 0.09311755817220126, "mean_env_wait_ms": 0.7080771147626221, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035494565963745117, "StateBufferConnector_ms": 0.0026747584342956543, "ViewRequirementAgentConnector_ms": 0.06641298532485962}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1950720, "num_agent_steps_trained": 1950720, "num_env_steps_sampled": 1950720, "num_env_steps_trained": 1950720, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 716.9081294122514, "num_env_steps_trained_throughput_per_sec": 716.9081294122514, "timesteps_total": 1950720, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 1950720, "timers": {"training_iteration_time_ms": 62319.235, "sample_time_ms": 61083.346, "load_time_ms": 18.261, "load_throughput": 2405144.059, "learn_time_ms": 1216.553, "learn_throughput": 36102.013, "synch_weights_time_ms": 0.908}, "counters": {"num_env_steps_sampled": 1950720, "num_env_steps_trained": 1950720, "num_agent_steps_sampled": 1950720, "num_agent_steps_trained": 1950720}, "done": false, "episodes_total": 1235, "training_iteration": 356, "trial_id": "4d6b1_00000", "date": "2023-08-03_14-26-57", "timestamp": 1691062017, "time_this_iter_s": 61.26568603515625, "time_total_s": 5671.829813241959, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1004.285055398941, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 17.65287356321839, "ram_util_percent": 60.1183908045977}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.25e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1660.9337537226106, "policy_loss": -5.447094191440921e+19, "vf_loss": 304068299.3527697}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11319.5, "diff_num_grad_updates_vs_sampler_policy": 11318.5}}, "num_env_steps_sampled": 1994640, "num_env_steps_trained": 1994640, "num_agent_steps_sampled": 1994640, "num_agent_steps_trained": 1994640}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1353206.2725023823, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2205390198431866, "mean_inference_ms": 0.37934144297917594, "mean_action_processing_ms": 0.0931028085443123, "mean_env_wait_ms": 0.7069888577239544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035257900462431066, "StateBufferConnector_ms": 0.0026787028593175553, "ViewRequirementAgentConnector_ms": 0.06633926840389476}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1353206.2725023823, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2205390198431866, "mean_inference_ms": 0.37934144297917594, "mean_action_processing_ms": 0.0931028085443123, "mean_env_wait_ms": 0.7069888577239544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035257900462431066, "StateBufferConnector_ms": 0.0026787028593175553, "ViewRequirementAgentConnector_ms": 0.06633926840389476}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 1994640, "num_agent_steps_trained": 1994640, "num_env_steps_sampled": 1994640, "num_env_steps_trained": 1994640, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 712.5872914523948, "num_env_steps_trained_throughput_per_sec": 712.5872914523948, "timesteps_total": 1994640, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 1994640, "timers": {"training_iteration_time_ms": 61872.038, "sample_time_ms": 60693.946, "load_time_ms": 18.003, "load_throughput": 2439572.56, "learn_time_ms": 1159.014, "learn_throughput": 37894.283, "synch_weights_time_ms": 0.914}, "counters": {"num_env_steps_sampled": 1994640, "num_env_steps_trained": 1994640, "num_agent_steps_sampled": 1994640, "num_agent_steps_trained": 1994640}, "done": false, "episodes_total": 1236, "training_iteration": 357, "trial_id": "4d6b1_00000", "date": "2023-08-03_14-27-59", "timestamp": 1691062079, "time_this_iter_s": 61.63716101646423, "time_total_s": 5733.466974258423, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1065.9222164154053, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 17.24367816091954, "ram_util_percent": 60.12988505747126}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.699999999999999e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1664.7149400182784, "policy_loss": -5.4559476168797045e+19, "vf_loss": 303579138.12827986}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12005.5, "diff_num_grad_updates_vs_sampler_policy": 12004.5}}, "num_env_steps_sampled": 2038560, "num_env_steps_trained": 2038560, "num_agent_steps_sampled": 2038560, "num_agent_steps_trained": 2038560}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1353192.1414555134, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22048113888161888, "mean_inference_ms": 0.3792170364995441, "mean_action_processing_ms": 0.09308566438380661, "mean_env_wait_ms": 0.7059268348190416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035100513034396702, "StateBufferConnector_ms": 0.0026610162523057726, "ViewRequirementAgentConnector_ms": 0.0662366549173991}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1353192.1414555134, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22048113888161888, "mean_inference_ms": 0.3792170364995441, "mean_action_processing_ms": 0.09308566438380661, "mean_env_wait_ms": 0.7059268348190416, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035100513034396702, "StateBufferConnector_ms": 0.0026610162523057726, "ViewRequirementAgentConnector_ms": 0.0662366549173991}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2038560, "num_agent_steps_trained": 2038560, "num_env_steps_sampled": 2038560, "num_env_steps_trained": 2038560, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 725.0439175758124, "num_env_steps_trained_throughput_per_sec": 725.0439175758124, "timesteps_total": 2038560, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2038560, "timers": {"training_iteration_time_ms": 61396.455, "sample_time_ms": 60256.338, "load_time_ms": 17.41, "load_throughput": 2522720.33, "learn_time_ms": 1121.637, "learn_throughput": 39157.064, "synch_weights_time_ms": 0.913}, "counters": {"num_env_steps_sampled": 2038560, "num_env_steps_trained": 2038560, "num_agent_steps_sampled": 2038560, "num_agent_steps_trained": 2038560}, "done": false, "episodes_total": 1237, "training_iteration": 358, "trial_id": "4d6b1_00000", "date": "2023-08-03_14-28-59", "timestamp": 1691062139, "time_this_iter_s": 60.57828688621521, "time_total_s": 5794.045261144638, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1126.5005033016205, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 19.555813953488375, "ram_util_percent": 60.49767441860463}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.15e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1666.2807223928912, "policy_loss": -6.348839575472986e+19, "vf_loss": 304675876.4548105}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 12691.5, "diff_num_grad_updates_vs_sampler_policy": 12690.5}}, "num_env_steps_sampled": 2082480, "num_env_steps_trained": 2082480, "num_agent_steps_sampled": 2082480, "num_agent_steps_trained": 2082480}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1353309.297862919, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2204200481489074, "mean_inference_ms": 0.37909038710642623, "mean_action_processing_ms": 0.09306644489108014, "mean_env_wait_ms": 0.7049251011323666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003489695097270765, "StateBufferConnector_ms": 0.002653975235788446, "ViewRequirementAgentConnector_ms": 0.0661561363621762}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1353309.297862919, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2204200481489074, "mean_inference_ms": 0.37909038710642623, "mean_action_processing_ms": 0.09306644489108014, "mean_env_wait_ms": 0.7049251011323666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003489695097270765, "StateBufferConnector_ms": 0.002653975235788446, "ViewRequirementAgentConnector_ms": 0.0661561363621762}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2082480, "num_agent_steps_trained": 2082480, "num_env_steps_sampled": 2082480, "num_env_steps_trained": 2082480, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 716.7093660834597, "num_env_steps_trained_throughput_per_sec": 716.7093660834597, "timesteps_total": 2082480, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2082480, "timers": {"training_iteration_time_ms": 61379.882, "sample_time_ms": 60234.249, "load_time_ms": 17.195, "load_throughput": 2554190.411, "learn_time_ms": 1127.361, "learn_throughput": 38958.225, "synch_weights_time_ms": 0.919}, "counters": {"num_env_steps_sampled": 2082480, "num_env_steps_trained": 2082480, "num_agent_steps_sampled": 2082480, "num_agent_steps_trained": 2082480}, "done": false, "episodes_total": 1238, "training_iteration": 359, "trial_id": "4d6b1_00000", "date": "2023-08-03_14-30-01", "timestamp": 1691062201, "time_this_iter_s": 61.28261685371399, "time_total_s": 5855.327877998352, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1187.7831201553345, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 18.809195402298847, "ram_util_percent": 61.97471264367816}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.6e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1668.364559607325, "policy_loss": -7.038678676936527e+19, "vf_loss": 303192071.4460641}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 13377.5, "diff_num_grad_updates_vs_sampler_policy": 13376.5}}, "num_env_steps_sampled": 2126400, "num_env_steps_trained": 2126400, "num_agent_steps_sampled": 2126400, "num_agent_steps_trained": 2126400}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1353252.3461198066, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22035160091705555, "mean_inference_ms": 0.37895451665128765, "mean_action_processing_ms": 0.09304573911830306, "mean_env_wait_ms": 0.7039899716942359, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034809112548828125, "StateBufferConnector_ms": 0.0026535987854003906, "ViewRequirementAgentConnector_ms": 0.06618976593017578}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1353252.3461198066, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22035160091705555, "mean_inference_ms": 0.37895451665128765, "mean_action_processing_ms": 0.09304573911830306, "mean_env_wait_ms": 0.7039899716942359, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034809112548828125, "StateBufferConnector_ms": 0.0026535987854003906, "ViewRequirementAgentConnector_ms": 0.06618976593017578}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2126400, "num_agent_steps_trained": 2126400, "num_env_steps_sampled": 2126400, "num_env_steps_trained": 2126400, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 718.0259016385392, "num_env_steps_trained_throughput_per_sec": 718.0259016385392, "timesteps_total": 2126400, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2126400, "timers": {"training_iteration_time_ms": 61324.558, "sample_time_ms": 60177.313, "load_time_ms": 17.168, "load_throughput": 2558223.428, "learn_time_ms": 1129.01, "learn_throughput": 38901.334, "synch_weights_time_ms": 0.91}, "counters": {"num_env_steps_sampled": 2126400, "num_env_steps_trained": 2126400, "num_agent_steps_sampled": 2126400, "num_agent_steps_trained": 2126400}, "done": false, "episodes_total": 1239, "training_iteration": 360, "trial_id": "4d6b1_00000", "date": "2023-08-03_14-31-02", "timestamp": 1691062262, "time_this_iter_s": 61.17029094696045, "time_total_s": 5916.4981689453125, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1248.953411102295, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 18.947674418604652, "ram_util_percent": 62.383720930232556}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.0499999999999996e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1671.015073904143, "policy_loss": -6.770956913046106e+19, "vf_loss": 302493095.35860056}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14063.5, "diff_num_grad_updates_vs_sampler_policy": 14062.5}}, "num_env_steps_sampled": 2170320, "num_env_steps_trained": 2170320, "num_agent_steps_sampled": 2170320, "num_agent_steps_trained": 2170320}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1353120.240630602, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2202845277940833, "mean_inference_ms": 0.3788138911269154, "mean_action_processing_ms": 0.09302447344671731, "mean_env_wait_ms": 0.7031093606704079, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034752346220470612, "StateBufferConnector_ms": 0.0026396342686244418, "ViewRequirementAgentConnector_ms": 0.06613958449590773}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1353120.240630602, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2202845277940833, "mean_inference_ms": 0.3788138911269154, "mean_action_processing_ms": 0.09302447344671731, "mean_env_wait_ms": 0.7031093606704079, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034752346220470612, "StateBufferConnector_ms": 0.0026396342686244418, "ViewRequirementAgentConnector_ms": 0.06613958449590773}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2170320, "num_agent_steps_trained": 2170320, "num_env_steps_sampled": 2170320, "num_env_steps_trained": 2170320, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 717.5331575921975, "num_env_steps_trained_throughput_per_sec": 717.5331575921975, "timesteps_total": 2170320, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2170320, "timers": {"training_iteration_time_ms": 61268.573, "sample_time_ms": 60120.208, "load_time_ms": 17.107, "load_throughput": 2567332.818, "learn_time_ms": 1130.185, "learn_throughput": 38860.906, "synch_weights_time_ms": 0.916}, "counters": {"num_env_steps_sampled": 2170320, "num_env_steps_trained": 2170320, "num_agent_steps_sampled": 2170320, "num_agent_steps_trained": 2170320}, "done": false, "episodes_total": 1240, "training_iteration": 361, "trial_id": "4d6b1_00000", "date": "2023-08-03_14-32-03", "timestamp": 1691062323, "time_this_iter_s": 61.21241092681885, "time_total_s": 5977.710579872131, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1310.1658220291138, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 17.848275862068967, "ram_util_percent": 62.73218390804596}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1673.0095923065096, "policy_loss": -7.568243984930347e+19, "vf_loss": 304433209.7434402}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 14749.5, "diff_num_grad_updates_vs_sampler_policy": 14748.5}}, "num_env_steps_sampled": 2214240, "num_env_steps_trained": 2214240, "num_agent_steps_sampled": 2214240, "num_agent_steps_trained": 2214240}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1353197.1761885881, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2202171683266364, "mean_inference_ms": 0.37866842926865485, "mean_action_processing_ms": 0.09300197902402334, "mean_env_wait_ms": 0.7022968744435222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003458153117786754, "StateBufferConnector_ms": 0.0026518648320978336, "ViewRequirementAgentConnector_ms": 0.06617307662963867}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1353197.1761885881, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2202171683266364, "mean_inference_ms": 0.37866842926865485, "mean_action_processing_ms": 0.09300197902402334, "mean_env_wait_ms": 0.7022968744435222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003458153117786754, "StateBufferConnector_ms": 0.0026518648320978336, "ViewRequirementAgentConnector_ms": 0.06617307662963867}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2214240, "num_agent_steps_trained": 2214240, "num_env_steps_sampled": 2214240, "num_env_steps_trained": 2214240, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 714.6202825151265, "num_env_steps_trained_throughput_per_sec": 714.6202825151265, "timesteps_total": 2214240, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2214240, "timers": {"training_iteration_time_ms": 61295.16, "sample_time_ms": 60147.344, "load_time_ms": 17.041, "load_throughput": 2577336.416, "learn_time_ms": 1129.694, "learn_throughput": 38877.772, "synch_weights_time_ms": 0.918}, "counters": {"num_env_steps_sampled": 2214240, "num_env_steps_trained": 2214240, "num_agent_steps_sampled": 2214240, "num_agent_steps_trained": 2214240}, "done": false, "episodes_total": 1241, "training_iteration": 362, "trial_id": "4d6b1_00000", "date": "2023-08-03_14-33-05", "timestamp": 1691062385, "time_this_iter_s": 61.46192789077759, "time_total_s": 6039.172507762909, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1371.6277499198914, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 17.183908045977013, "ram_util_percent": 62.83678160919539}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1674.90566117979, "policy_loss": -8.362093677074612e+19, "vf_loss": 302930784.909621}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 15435.5, "diff_num_grad_updates_vs_sampler_policy": 15434.5}}, "num_env_steps_sampled": 2258160, "num_env_steps_trained": 2258160, "num_agent_steps_sampled": 2258160, "num_agent_steps_trained": 2258160}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1353124.6287019143, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2201523532485411, "mean_inference_ms": 0.3785237627550256, "mean_action_processing_ms": 0.09297953248055815, "mean_env_wait_ms": 0.7015525218303801, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034384105516516643, "StateBufferConnector_ms": 0.0026464462280273438, "ViewRequirementAgentConnector_ms": 0.06620572960895041}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1353124.6287019143, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2201523532485411, "mean_inference_ms": 0.3785237627550256, "mean_action_processing_ms": 0.09297953248055815, "mean_env_wait_ms": 0.7015525218303801, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034384105516516643, "StateBufferConnector_ms": 0.0026464462280273438, "ViewRequirementAgentConnector_ms": 0.06620572960895041}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2258160, "num_agent_steps_trained": 2258160, "num_env_steps_sampled": 2258160, "num_env_steps_trained": 2258160, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 710.4829060465933, "num_env_steps_trained_throughput_per_sec": 710.4829060465933, "timesteps_total": 2258160, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2258160, "timers": {"training_iteration_time_ms": 61313.452, "sample_time_ms": 60167.454, "load_time_ms": 16.87, "load_throughput": 2603467.803, "learn_time_ms": 1128.051, "learn_throughput": 38934.425, "synch_weights_time_ms": 0.914}, "counters": {"num_env_steps_sampled": 2258160, "num_env_steps_trained": 2258160, "num_agent_steps_sampled": 2258160, "num_agent_steps_trained": 2258160}, "done": false, "episodes_total": 1242, "training_iteration": 363, "trial_id": "4d6b1_00000", "date": "2023-08-03_14-34-06", "timestamp": 1691062446, "time_this_iter_s": 61.81970191001892, "time_total_s": 6100.992209672928, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1433.4474518299103, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 17.125287356321834, "ram_util_percent": 62.92988505747128}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1676.035946326075, "policy_loss": -8.326136300615174e+19, "vf_loss": 302515977.5218659}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16121.5, "diff_num_grad_updates_vs_sampler_policy": 16120.5}}, "num_env_steps_sampled": 2302080, "num_env_steps_trained": 2302080, "num_agent_steps_sampled": 2302080, "num_agent_steps_trained": 2302080}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1353021.5274483163, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22008266271148172, "mean_inference_ms": 0.37837930950284776, "mean_action_processing_ms": 0.09295685221801113, "mean_env_wait_ms": 0.7008575868440907, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035524368286132812, "StateBufferConnector_ms": 0.0026394923528035483, "ViewRequirementAgentConnector_ms": 0.06611943244934082}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1353021.5274483163, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22008266271148172, "mean_inference_ms": 0.37837930950284776, "mean_action_processing_ms": 0.09295685221801113, "mean_env_wait_ms": 0.7008575868440907, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035524368286132812, "StateBufferConnector_ms": 0.0026394923528035483, "ViewRequirementAgentConnector_ms": 0.06611943244934082}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2302080, "num_agent_steps_trained": 2302080, "num_env_steps_sampled": 2302080, "num_env_steps_trained": 2302080, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 716.3448437313842, "num_env_steps_trained_throughput_per_sec": 716.3448437313842, "timesteps_total": 2302080, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2302080, "timers": {"training_iteration_time_ms": 61307.073, "sample_time_ms": 60162.766, "load_time_ms": 16.908, "load_throughput": 2597568.335, "learn_time_ms": 1126.306, "learn_throughput": 38994.729, "synch_weights_time_ms": 0.929}, "counters": {"num_env_steps_sampled": 2302080, "num_env_steps_trained": 2302080, "num_agent_steps_sampled": 2302080, "num_agent_steps_trained": 2302080}, "done": false, "episodes_total": 1243, "training_iteration": 364, "trial_id": "4d6b1_00000", "date": "2023-08-03_14-35-08", "timestamp": 1691062508, "time_this_iter_s": 61.31400394439697, "time_total_s": 6162.306213617325, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1494.7614557743073, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 17.55862068965517, "ram_util_percent": 62.99195402298851}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1678.1843911218225, "policy_loss": -9.07977970873519e+19, "vf_loss": 303610039.5801749}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 16807.5, "diff_num_grad_updates_vs_sampler_policy": 16806.5}}, "num_env_steps_sampled": 2346000, "num_env_steps_trained": 2346000, "num_agent_steps_sampled": 2346000, "num_agent_steps_trained": 2346000}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1353026.0652400362, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22001446604692923, "mean_inference_ms": 0.37823618875948917, "mean_action_processing_ms": 0.09293445913086902, "mean_env_wait_ms": 0.7002055598998043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035371780395507812, "StateBufferConnector_ms": 0.0026397705078125, "ViewRequirementAgentConnector_ms": 0.06614208221435547}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1353026.0652400362, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.22001446604692923, "mean_inference_ms": 0.37823618875948917, "mean_action_processing_ms": 0.09293445913086902, "mean_env_wait_ms": 0.7002055598998043, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035371780395507812, "StateBufferConnector_ms": 0.0026397705078125, "ViewRequirementAgentConnector_ms": 0.06614208221435547}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2346000, "num_agent_steps_trained": 2346000, "num_env_steps_sampled": 2346000, "num_env_steps_trained": 2346000, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 714.7541616928311, "num_env_steps_trained_throughput_per_sec": 714.7541616928311, "timesteps_total": 2346000, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2346000, "timers": {"training_iteration_time_ms": 61316.585, "sample_time_ms": 60171.02, "load_time_ms": 17.259, "load_throughput": 2544723.847, "learn_time_ms": 1127.214, "learn_throughput": 38963.311, "synch_weights_time_ms": 0.928}, "counters": {"num_env_steps_sampled": 2346000, "num_env_steps_trained": 2346000, "num_agent_steps_sampled": 2346000, "num_agent_steps_trained": 2346000}, "done": false, "episodes_total": 1244, "training_iteration": 365, "trial_id": "4d6b1_00000", "date": "2023-08-03_14-36-09", "timestamp": 1691062569, "time_this_iter_s": 61.45042896270752, "time_total_s": 6223.756642580032, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1556.2118847370148, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 16.548275862068966, "ram_util_percent": 62.601149425287346}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1679.7759814026058, "policy_loss": -9.196856454209785e+19, "vf_loss": 302364544.18658894}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 17493.5, "diff_num_grad_updates_vs_sampler_policy": 17492.5}}, "num_env_steps_sampled": 2389920, "num_env_steps_trained": 2389920, "num_agent_steps_sampled": 2389920, "num_agent_steps_trained": 2389920}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352922.7149786467, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2199471341647685, "mean_inference_ms": 0.37809542690243786, "mean_action_processing_ms": 0.0929121729606537, "mean_env_wait_ms": 0.6995902141609356, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003528594970703125, "StateBufferConnector_ms": 0.0026308573209322416, "ViewRequirementAgentConnector_ms": 0.06602910848764273}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352922.7149786467, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2199471341647685, "mean_inference_ms": 0.37809542690243786, "mean_action_processing_ms": 0.0929121729606537, "mean_env_wait_ms": 0.6995902141609356, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003528594970703125, "StateBufferConnector_ms": 0.0026308573209322416, "ViewRequirementAgentConnector_ms": 0.06602910848764273}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2389920, "num_agent_steps_trained": 2389920, "num_env_steps_sampled": 2389920, "num_env_steps_trained": 2389920, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 716.1348666824746, "num_env_steps_trained_throughput_per_sec": 716.1348666824746, "timesteps_total": 2389920, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2389920, "timers": {"training_iteration_time_ms": 61323.2, "sample_time_ms": 60177.849, "load_time_ms": 17.094, "load_throughput": 2569330.904, "learn_time_ms": 1127.161, "learn_throughput": 38965.138, "synch_weights_time_ms": 0.932}, "counters": {"num_env_steps_sampled": 2389920, "num_env_steps_trained": 2389920, "num_agent_steps_sampled": 2389920, "num_agent_steps_trained": 2389920}, "done": false, "episodes_total": 1245, "training_iteration": 366, "trial_id": "4d6b1_00000", "date": "2023-08-03_14-37-11", "timestamp": 1691062631, "time_this_iter_s": 61.33188724517822, "time_total_s": 6285.088529825211, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1617.543771982193, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 17.275862068965516, "ram_util_percent": 62.81264367816092}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1681.050927876731, "policy_loss": -9.899961711177068e+19, "vf_loss": 303382736.4198251}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18179.5, "diff_num_grad_updates_vs_sampler_policy": 18178.5}}, "num_env_steps_sampled": 2433840, "num_env_steps_trained": 2433840, "num_agent_steps_sampled": 2433840, "num_agent_steps_trained": 2433840}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352910.1693798536, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2198809213803479, "mean_inference_ms": 0.37795686726934874, "mean_action_processing_ms": 0.09289024467505763, "mean_env_wait_ms": 0.6990166694218503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035224137482819736, "StateBufferConnector_ms": 0.0026411480373806423, "ViewRequirementAgentConnector_ms": 0.0660278179027416}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352910.1693798536, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2198809213803479, "mean_inference_ms": 0.37795686726934874, "mean_action_processing_ms": 0.09289024467505763, "mean_env_wait_ms": 0.6990166694218503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035224137482819736, "StateBufferConnector_ms": 0.0026411480373806423, "ViewRequirementAgentConnector_ms": 0.0660278179027416}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2433840, "num_agent_steps_trained": 2433840, "num_env_steps_sampled": 2433840, "num_env_steps_trained": 2433840, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 712.8642013855322, "num_env_steps_trained_throughput_per_sec": 712.8642013855322, "timesteps_total": 2433840, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2433840, "timers": {"training_iteration_time_ms": 61320.806, "sample_time_ms": 60173.405, "load_time_ms": 16.782, "load_throughput": 2617145.873, "learn_time_ms": 1129.534, "learn_throughput": 38883.305, "synch_weights_time_ms": 0.922}, "counters": {"num_env_steps_sampled": 2433840, "num_env_steps_trained": 2433840, "num_agent_steps_sampled": 2433840, "num_agent_steps_trained": 2433840}, "done": false, "episodes_total": 1246, "training_iteration": 367, "trial_id": "4d6b1_00000", "date": "2023-08-03_14-38-12", "timestamp": 1691062692, "time_this_iter_s": 61.6134307384491, "time_total_s": 6346.70196056366, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1679.157202720642, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 17.126436781609197, "ram_util_percent": 62.85287356321838}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1683.08139954503, "policy_loss": -1.0877007781283987e+20, "vf_loss": 304833818.55976677}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 18865.5, "diff_num_grad_updates_vs_sampler_policy": 18864.5}}, "num_env_steps_sampled": 2477760, "num_env_steps_trained": 2477760, "num_agent_steps_sampled": 2477760, "num_agent_steps_trained": 2477760}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1353015.7881734932, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21981723410135864, "mean_inference_ms": 0.37782164708472704, "mean_action_processing_ms": 0.09286862731997725, "mean_env_wait_ms": 0.6984777055671565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035209315163748606, "StateBufferConnector_ms": 0.0026336738041469027, "ViewRequirementAgentConnector_ms": 0.06598149027143206}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1353015.7881734932, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21981723410135864, "mean_inference_ms": 0.37782164708472704, "mean_action_processing_ms": 0.09286862731997725, "mean_env_wait_ms": 0.6984777055671565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035209315163748606, "StateBufferConnector_ms": 0.0026336738041469027, "ViewRequirementAgentConnector_ms": 0.06598149027143206}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2477760, "num_agent_steps_trained": 2477760, "num_env_steps_sampled": 2477760, "num_env_steps_trained": 2477760, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 713.554081196156, "num_env_steps_trained_throughput_per_sec": 713.554081196156, "timesteps_total": 2477760, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2477760, "timers": {"training_iteration_time_ms": 61418.346, "sample_time_ms": 60272.625, "load_time_ms": 16.797, "load_throughput": 2614809.208, "learn_time_ms": 1127.847, "learn_throughput": 38941.466, "synch_weights_time_ms": 0.914}, "counters": {"num_env_steps_sampled": 2477760, "num_env_steps_trained": 2477760, "num_agent_steps_sampled": 2477760, "num_agent_steps_trained": 2477760}, "done": false, "episodes_total": 1247, "training_iteration": 368, "trial_id": "4d6b1_00000", "date": "2023-08-03_14-39-14", "timestamp": 1691062754, "time_this_iter_s": 61.55360794067383, "time_total_s": 6408.2555685043335, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1740.710810661316, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 17.134482758620692, "ram_util_percent": 62.847126436781586}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1684.0447154587282, "policy_loss": -1.148597260348278e+20, "vf_loss": 302070905.02040815}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 19551.5, "diff_num_grad_updates_vs_sampler_policy": 19550.5}}, "num_env_steps_sampled": 2521680, "num_env_steps_trained": 2521680, "num_agent_steps_sampled": 2521680, "num_agent_steps_trained": 2521680}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352900.4353088944, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21975633216423288, "mean_inference_ms": 0.3776920431409661, "mean_action_processing_ms": 0.09284732274315001, "mean_env_wait_ms": 0.6979737984975595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036140968059671335, "StateBufferConnector_ms": 0.002637402764682112, "ViewRequirementAgentConnector_ms": 0.06608305306270204}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352900.4353088944, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21975633216423288, "mean_inference_ms": 0.3776920431409661, "mean_action_processing_ms": 0.09284732274315001, "mean_env_wait_ms": 0.6979737984975595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036140968059671335, "StateBufferConnector_ms": 0.002637402764682112, "ViewRequirementAgentConnector_ms": 0.06608305306270204}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2521680, "num_agent_steps_trained": 2521680, "num_env_steps_sampled": 2521680, "num_env_steps_trained": 2521680, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 710.8416582610421, "num_env_steps_trained_throughput_per_sec": 710.8416582610421, "timesteps_total": 2521680, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2521680, "timers": {"training_iteration_time_ms": 61468.93, "sample_time_ms": 60330.113, "load_time_ms": 16.995, "load_throughput": 2584285.744, "learn_time_ms": 1120.735, "learn_throughput": 39188.573, "synch_weights_time_ms": 0.922}, "counters": {"num_env_steps_sampled": 2521680, "num_env_steps_trained": 2521680, "num_agent_steps_sampled": 2521680, "num_agent_steps_trained": 2521680}, "done": false, "episodes_total": 1248, "training_iteration": 369, "trial_id": "4d6b1_00000", "date": "2023-08-03_14-40-16", "timestamp": 1691062816, "time_this_iter_s": 61.78869104385376, "time_total_s": 6470.044259548187, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1802.4995017051697, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 16.594318181818185, "ram_util_percent": 62.906818181818174}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1685.0490019773256, "policy_loss": -1.1823516294287919e+20, "vf_loss": 302783766.2390671}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 20237.5, "diff_num_grad_updates_vs_sampler_policy": 20236.5}}, "num_env_steps_sampled": 2565600, "num_env_steps_trained": 2565600, "num_agent_steps_sampled": 2565600, "num_agent_steps_trained": 2565600}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352842.1695851637, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21969370282583447, "mean_inference_ms": 0.37756594065959936, "mean_action_processing_ms": 0.0928263988751418, "mean_env_wait_ms": 0.6974981556116698, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003600915273030599, "StateBufferConnector_ms": 0.002628167470296224, "ViewRequirementAgentConnector_ms": 0.06611347198486328}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352842.1695851637, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21969370282583447, "mean_inference_ms": 0.37756594065959936, "mean_action_processing_ms": 0.0928263988751418, "mean_env_wait_ms": 0.6974981556116698, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003600915273030599, "StateBufferConnector_ms": 0.002628167470296224, "ViewRequirementAgentConnector_ms": 0.06611347198486328}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2565600, "num_agent_steps_trained": 2565600, "num_env_steps_sampled": 2565600, "num_env_steps_trained": 2565600, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 715.3056093335201, "num_env_steps_trained_throughput_per_sec": 715.3056093335201, "timesteps_total": 2565600, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2565600, "timers": {"training_iteration_time_ms": 61492.192, "sample_time_ms": 60355.315, "load_time_ms": 17.143, "load_throughput": 2561916.421, "learn_time_ms": 1118.634, "learn_throughput": 39262.181, "synch_weights_time_ms": 0.935}, "counters": {"num_env_steps_sampled": 2565600, "num_env_steps_trained": 2565600, "num_agent_steps_sampled": 2565600, "num_agent_steps_trained": 2565600}, "done": false, "episodes_total": 1249, "training_iteration": 370, "trial_id": "4d6b1_00000", "date": "2023-08-03_14-41-17", "timestamp": 1691062877, "time_this_iter_s": 61.40325593948364, "time_total_s": 6531.447515487671, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1863.9027576446533, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 17.237931034482756, "ram_util_percent": 62.85977011494251}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1686.417193087475, "policy_loss": -1.1545124597138455e+20, "vf_loss": 303364537.95335275}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 20923.5, "diff_num_grad_updates_vs_sampler_policy": 20922.5}}, "num_env_steps_sampled": 2609520, "num_env_steps_trained": 2609520, "num_agent_steps_sampled": 2609520, "num_agent_steps_trained": 2609520}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352829.700372177, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21963319272066742, "mean_inference_ms": 0.3774425916956779, "mean_action_processing_ms": 0.0928059109791112, "mean_env_wait_ms": 0.6970435528204983, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003592429622527092, "StateBufferConnector_ms": 0.002621835277926537, "ViewRequirementAgentConnector_ms": 0.06606040462370842}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352829.700372177, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21963319272066742, "mean_inference_ms": 0.3774425916956779, "mean_action_processing_ms": 0.0928059109791112, "mean_env_wait_ms": 0.6970435528204983, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003592429622527092, "StateBufferConnector_ms": 0.002621835277926537, "ViewRequirementAgentConnector_ms": 0.06606040462370842}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2609520, "num_agent_steps_trained": 2609520, "num_env_steps_sampled": 2609520, "num_env_steps_trained": 2609520, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 716.2102984373134, "num_env_steps_trained_throughput_per_sec": 716.2102984373134, "timesteps_total": 2609520, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2609520, "timers": {"training_iteration_time_ms": 61503.497, "sample_time_ms": 60367.42, "load_time_ms": 17.129, "load_throughput": 2564045.26, "learn_time_ms": 1117.839, "learn_throughput": 39290.078, "synch_weights_time_ms": 0.943}, "counters": {"num_env_steps_sampled": 2609520, "num_env_steps_trained": 2609520, "num_agent_steps_sampled": 2609520, "num_agent_steps_trained": 2609520}, "done": false, "episodes_total": 1250, "training_iteration": 371, "trial_id": "4d6b1_00000", "date": "2023-08-03_14-42-18", "timestamp": 1691062938, "time_this_iter_s": 61.325348138809204, "time_total_s": 6592.77286362648, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1925.2281057834625, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 17.205747126436783, "ram_util_percent": 62.89425287356323}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1687.273015770203, "policy_loss": -1.1962262107657622e+20, "vf_loss": 303062622.122449}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 21609.5, "diff_num_grad_updates_vs_sampler_policy": 21608.5}}, "num_env_steps_sampled": 2653440, "num_env_steps_trained": 2653440, "num_agent_steps_sampled": 2653440, "num_agent_steps_trained": 2653440}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352807.3443056527, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21957523028324993, "mean_inference_ms": 0.3773222004951931, "mean_action_processing_ms": 0.09278601133611097, "mean_env_wait_ms": 0.6966131521456111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035800039768218994, "StateBufferConnector_ms": 0.0026166439056396484, "ViewRequirementAgentConnector_ms": 0.06603449583053589}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352807.3443056527, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21957523028324993, "mean_inference_ms": 0.3773222004951931, "mean_action_processing_ms": 0.09278601133611097, "mean_env_wait_ms": 0.6966131521456111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035800039768218994, "StateBufferConnector_ms": 0.0026166439056396484, "ViewRequirementAgentConnector_ms": 0.06603449583053589}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2653440, "num_agent_steps_trained": 2653440, "num_env_steps_sampled": 2653440, "num_env_steps_trained": 2653440, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 713.4968607836887, "num_env_steps_trained_throughput_per_sec": 713.4968607836887, "timesteps_total": 2653440, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2653440, "timers": {"training_iteration_time_ms": 61513.174, "sample_time_ms": 60376.485, "load_time_ms": 17.166, "load_throughput": 2558489.905, "learn_time_ms": 1118.426, "learn_throughput": 39269.484, "synch_weights_time_ms": 0.937}, "counters": {"num_env_steps_sampled": 2653440, "num_env_steps_trained": 2653440, "num_agent_steps_sampled": 2653440, "num_agent_steps_trained": 2653440}, "done": false, "episodes_total": 1251, "training_iteration": 372, "trial_id": "4d6b1_00000", "date": "2023-08-03_14-43-20", "timestamp": 1691063000, "time_this_iter_s": 61.558892011642456, "time_total_s": 6654.331755638123, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1986.786997795105, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 17.227586206896554, "ram_util_percent": 62.933333333333344}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1688.7802027933103, "policy_loss": -1.3190606764144651e+20, "vf_loss": 304969708.04664725}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22295.5, "diff_num_grad_updates_vs_sampler_policy": 22294.5}}, "num_env_steps_sampled": 2697360, "num_env_steps_trained": 2697360, "num_agent_steps_sampled": 2697360, "num_agent_steps_trained": 2697360}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352908.1766545388, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21952072410049123, "mean_inference_ms": 0.3772037290537312, "mean_action_processing_ms": 0.09276674857416718, "mean_env_wait_ms": 0.6962055853072172, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035683314005533853, "StateBufferConnector_ms": 0.0026247718117453837, "ViewRequirementAgentConnector_ms": 0.06608023787989761}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352908.1766545388, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21952072410049123, "mean_inference_ms": 0.3772037290537312, "mean_action_processing_ms": 0.09276674857416718, "mean_env_wait_ms": 0.6962055853072172, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035683314005533853, "StateBufferConnector_ms": 0.0026247718117453837, "ViewRequirementAgentConnector_ms": 0.06608023787989761}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2697360, "num_agent_steps_trained": 2697360, "num_env_steps_sampled": 2697360, "num_env_steps_trained": 2697360, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 713.0612597033306, "num_env_steps_trained_throughput_per_sec": 713.0612597033306, "timesteps_total": 2697360, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2697360, "timers": {"training_iteration_time_ms": 61490.822, "sample_time_ms": 60353.952, "load_time_ms": 17.196, "load_throughput": 2554073.548, "learn_time_ms": 1118.572, "learn_throughput": 39264.345, "synch_weights_time_ms": 0.942}, "counters": {"num_env_steps_sampled": 2697360, "num_env_steps_trained": 2697360, "num_agent_steps_sampled": 2697360, "num_agent_steps_trained": 2697360}, "done": false, "episodes_total": 1252, "training_iteration": 373, "trial_id": "4d6b1_00000", "date": "2023-08-03_14-44-22", "timestamp": 1691063062, "time_this_iter_s": 61.596246004104614, "time_total_s": 6715.928001642227, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2048.3832437992096, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 17.098850574712646, "ram_util_percent": 62.82413793103448}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1690.5324484599923, "policy_loss": -1.280111939382237e+20, "vf_loss": 303428624.79883385}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 22981.5, "diff_num_grad_updates_vs_sampler_policy": 22980.5}}, "num_env_steps_sampled": 2741280, "num_env_steps_trained": 2741280, "num_agent_steps_sampled": 2741280, "num_agent_steps_trained": 2741280}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352905.9484962707, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21946861480349167, "mean_inference_ms": 0.37708918336633945, "mean_action_processing_ms": 0.09274806807518321, "mean_env_wait_ms": 0.695817800678068, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035594491397633273, "StateBufferConnector_ms": 0.0026162932900821462, "ViewRequirementAgentConnector_ms": 0.06614572861615349}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352905.9484962707, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21946861480349167, "mean_inference_ms": 0.37708918336633945, "mean_action_processing_ms": 0.09274806807518321, "mean_env_wait_ms": 0.695817800678068, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035594491397633273, "StateBufferConnector_ms": 0.0026162932900821462, "ViewRequirementAgentConnector_ms": 0.06614572861615349}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2741280, "num_agent_steps_trained": 2741280, "num_env_steps_sampled": 2741280, "num_env_steps_trained": 2741280, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 713.0131039955802, "num_env_steps_trained_throughput_per_sec": 713.0131039955802, "timesteps_total": 2741280, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2741280, "timers": {"training_iteration_time_ms": 61519.471, "sample_time_ms": 60380.811, "load_time_ms": 17.127, "load_throughput": 2564380.776, "learn_time_ms": 1120.438, "learn_throughput": 39198.959, "synch_weights_time_ms": 0.936}, "counters": {"num_env_steps_sampled": 2741280, "num_env_steps_trained": 2741280, "num_agent_steps_sampled": 2741280, "num_agent_steps_trained": 2741280}, "done": false, "episodes_total": 1253, "training_iteration": 374, "trial_id": "4d6b1_00000", "date": "2023-08-03_14-45-23", "timestamp": 1691063123, "time_this_iter_s": 61.60035824775696, "time_total_s": 6777.528359889984, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2109.9836020469666, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 16.522988505747122, "ram_util_percent": 62.91609195402299}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1692.1299153764464, "policy_loss": -1.4125893400065942e+20, "vf_loss": 302573759.18367344}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23667.5, "diff_num_grad_updates_vs_sampler_policy": 23666.5}}, "num_env_steps_sampled": 2785200, "num_env_steps_trained": 2785200, "num_agent_steps_sampled": 2785200, "num_agent_steps_trained": 2785200}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352845.248163182, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2194186744488067, "mean_inference_ms": 0.37697718778961964, "mean_action_processing_ms": 0.0927298032437305, "mean_env_wait_ms": 0.6954490515862779, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035497120448521207, "StateBufferConnector_ms": 0.0026226043701171875, "ViewRequirementAgentConnector_ms": 0.06616183689662389}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352845.248163182, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2194186744488067, "mean_inference_ms": 0.37697718778961964, "mean_action_processing_ms": 0.0927298032437305, "mean_env_wait_ms": 0.6954490515862779, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035497120448521207, "StateBufferConnector_ms": 0.0026226043701171875, "ViewRequirementAgentConnector_ms": 0.06616183689662389}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2785200, "num_agent_steps_trained": 2785200, "num_env_steps_sampled": 2785200, "num_env_steps_trained": 2785200, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 713.626241635312, "num_env_steps_trained_throughput_per_sec": 713.626241635312, "timesteps_total": 2785200, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2785200, "timers": {"training_iteration_time_ms": 61529.183, "sample_time_ms": 60392.36, "load_time_ms": 16.82, "load_throughput": 2611217.636, "learn_time_ms": 1118.9, "learn_throughput": 39252.848, "synch_weights_time_ms": 0.945}, "counters": {"num_env_steps_sampled": 2785200, "num_env_steps_trained": 2785200, "num_agent_steps_sampled": 2785200, "num_agent_steps_trained": 2785200}, "done": false, "episodes_total": 1254, "training_iteration": 375, "trial_id": "4d6b1_00000", "date": "2023-08-03_14-46-25", "timestamp": 1691063185, "time_this_iter_s": 61.547637939453125, "time_total_s": 6839.075997829437, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2171.5312399864197, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 16.96551724137931, "ram_util_percent": 62.83793103448274}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1693.329110281808, "policy_loss": -1.6208279824565243e+20, "vf_loss": 304089498.4897959}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 24353.5, "diff_num_grad_updates_vs_sampler_policy": 24352.5}}, "num_env_steps_sampled": 2829120, "num_env_steps_trained": 2829120, "num_agent_steps_sampled": 2829120, "num_agent_steps_trained": 2829120}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352880.7357130426, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21936679983409021, "mean_inference_ms": 0.3768681950072555, "mean_action_processing_ms": 0.0927120485337556, "mean_env_wait_ms": 0.6951016681168933, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035312440660264757, "StateBufferConnector_ms": 0.002629227108425564, "ViewRequirementAgentConnector_ms": 0.06611678335401747}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352880.7357130426, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21936679983409021, "mean_inference_ms": 0.3768681950072555, "mean_action_processing_ms": 0.0927120485337556, "mean_env_wait_ms": 0.6951016681168933, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035312440660264757, "StateBufferConnector_ms": 0.002629227108425564, "ViewRequirementAgentConnector_ms": 0.06611678335401747}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2829120, "num_agent_steps_trained": 2829120, "num_env_steps_sampled": 2829120, "num_env_steps_trained": 2829120, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 713.4470353162646, "num_env_steps_trained_throughput_per_sec": 713.4470353162646, "timesteps_total": 2829120, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2829120, "timers": {"training_iteration_time_ms": 61552.288, "sample_time_ms": 60414.572, "load_time_ms": 16.791, "load_throughput": 2615759.716, "learn_time_ms": 1119.811, "learn_throughput": 39220.887, "synch_weights_time_ms": 0.956}, "counters": {"num_env_steps_sampled": 2829120, "num_env_steps_trained": 2829120, "num_agent_steps_sampled": 2829120, "num_agent_steps_trained": 2829120}, "done": false, "episodes_total": 1255, "training_iteration": 376, "trial_id": "4d6b1_00000", "date": "2023-08-03_14-47-26", "timestamp": 1691063246, "time_this_iter_s": 61.56306290626526, "time_total_s": 6900.6390607357025, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2233.094302892685, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 17.478160919540226, "ram_util_percent": 62.92183908045977}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1694.4834993323502, "policy_loss": -1.3276297748941437e+20, "vf_loss": 301845071.57434404}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 25039.5, "diff_num_grad_updates_vs_sampler_policy": 25038.5}}, "num_env_steps_sampled": 2873040, "num_env_steps_trained": 2873040, "num_agent_steps_sampled": 2873040, "num_agent_steps_trained": 2873040}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352782.0447320638, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2193171461143582, "mean_inference_ms": 0.37676184549074154, "mean_action_processing_ms": 0.09269478841626308, "mean_env_wait_ms": 0.694763093908582, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003528594970703125, "StateBufferConnector_ms": 0.002625826242807749, "ViewRequirementAgentConnector_ms": 0.06610445074132971}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352782.0447320638, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2193171461143582, "mean_inference_ms": 0.37676184549074154, "mean_action_processing_ms": 0.09269478841626308, "mean_env_wait_ms": 0.694763093908582, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003528594970703125, "StateBufferConnector_ms": 0.002625826242807749, "ViewRequirementAgentConnector_ms": 0.06610445074132971}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2873040, "num_agent_steps_trained": 2873040, "num_env_steps_sampled": 2873040, "num_env_steps_trained": 2873040, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 718.420392203668, "num_env_steps_trained_throughput_per_sec": 718.420392203668, "timesteps_total": 2873040, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2873040, "timers": {"training_iteration_time_ms": 61504.64, "sample_time_ms": 60367.356, "load_time_ms": 16.762, "load_throughput": 2620269.172, "learn_time_ms": 1119.393, "learn_throughput": 39235.539, "synch_weights_time_ms": 0.971}, "counters": {"num_env_steps_sampled": 2873040, "num_env_steps_trained": 2873040, "num_agent_steps_sampled": 2873040, "num_agent_steps_trained": 2873040}, "done": false, "episodes_total": 1256, "training_iteration": 377, "trial_id": "4d6b1_00000", "date": "2023-08-03_14-48-27", "timestamp": 1691063307, "time_this_iter_s": 61.13682508468628, "time_total_s": 6961.775885820389, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2294.231127977371, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 17.298850574712645, "ram_util_percent": 62.95862068965517}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1695.632329912992, "policy_loss": -1.6391638093075454e+20, "vf_loss": 302865261.2069971}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 25725.5, "diff_num_grad_updates_vs_sampler_policy": 25724.5}}, "num_env_steps_sampled": 2916960, "num_env_steps_trained": 2916960, "num_agent_steps_sampled": 2916960, "num_agent_steps_trained": 2916960}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352750.1287942969, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2192688819838904, "mean_inference_ms": 0.37665839676449997, "mean_action_processing_ms": 0.09267796761340746, "mean_env_wait_ms": 0.6944414965736341, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003521065962942023, "StateBufferConnector_ms": 0.0026263688739977383, "ViewRequirementAgentConnector_ms": 0.0660890027096397}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352750.1287942969, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2192688819838904, "mean_inference_ms": 0.37665839676449997, "mean_action_processing_ms": 0.09267796761340746, "mean_env_wait_ms": 0.6944414965736341, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003521065962942023, "StateBufferConnector_ms": 0.0026263688739977383, "ViewRequirementAgentConnector_ms": 0.0660890027096397}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2916960, "num_agent_steps_trained": 2916960, "num_env_steps_sampled": 2916960, "num_env_steps_trained": 2916960, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 712.0263663742758, "num_env_steps_trained_throughput_per_sec": 712.0263663742758, "timesteps_total": 2916960, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2916960, "timers": {"training_iteration_time_ms": 61517.846, "sample_time_ms": 60374.021, "load_time_ms": 16.975, "load_throughput": 2587327.425, "learn_time_ms": 1125.726, "learn_throughput": 39014.82, "synch_weights_time_ms": 0.966}, "counters": {"num_env_steps_sampled": 2916960, "num_env_steps_trained": 2916960, "num_agent_steps_sampled": 2916960, "num_agent_steps_trained": 2916960}, "done": false, "episodes_total": 1257, "training_iteration": 378, "trial_id": "4d6b1_00000", "date": "2023-08-03_14-49-29", "timestamp": 1691063369, "time_this_iter_s": 61.685879945755005, "time_total_s": 7023.461765766144, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2355.917007923126, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 16.57126436781609, "ram_util_percent": 62.92298850574714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1696.2910426726494, "policy_loss": -1.6860700828993913e+20, "vf_loss": 303167609.3994169}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 26411.5, "diff_num_grad_updates_vs_sampler_policy": 26410.5}}, "num_env_steps_sampled": 2960880, "num_env_steps_trained": 2960880, "num_agent_steps_sampled": 2960880, "num_agent_steps_trained": 2960880}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352731.326357924, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2192224725036351, "mean_inference_ms": 0.3765589578447574, "mean_action_processing_ms": 0.09266160036959725, "mean_env_wait_ms": 0.6941342470570072, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003515145717523037, "StateBufferConnector_ms": 0.0026213817107371795, "ViewRequirementAgentConnector_ms": 0.06619416750394382}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352731.326357924, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2192224725036351, "mean_inference_ms": 0.3765589578447574, "mean_action_processing_ms": 0.09266160036959725, "mean_env_wait_ms": 0.6941342470570072, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003515145717523037, "StateBufferConnector_ms": 0.0026213817107371795, "ViewRequirementAgentConnector_ms": 0.06619416750394382}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 2960880, "num_agent_steps_trained": 2960880, "num_env_steps_sampled": 2960880, "num_env_steps_trained": 2960880, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 712.5678588402454, "num_env_steps_trained_throughput_per_sec": 712.5678588402454, "timesteps_total": 2960880, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 2960880, "timers": {"training_iteration_time_ms": 61502.878, "sample_time_ms": 60359.161, "load_time_ms": 16.811, "load_throughput": 2612598.982, "learn_time_ms": 1125.784, "learn_throughput": 39012.828, "synch_weights_time_ms": 0.965}, "counters": {"num_env_steps_sampled": 2960880, "num_env_steps_trained": 2960880, "num_agent_steps_sampled": 2960880, "num_agent_steps_trained": 2960880}, "done": false, "episodes_total": 1258, "training_iteration": 379, "trial_id": "4d6b1_00000", "date": "2023-08-03_14-50-31", "timestamp": 1691063431, "time_this_iter_s": 61.638893127441406, "time_total_s": 7085.100658893585, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2417.5559010505676, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 17.487356321839076, "ram_util_percent": 62.72988505747126}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1697.3151154365205, "policy_loss": -1.5493763836337842e+20, "vf_loss": 302056955.5801749}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 27097.5, "diff_num_grad_updates_vs_sampler_policy": 27096.5}}, "num_env_steps_sampled": 3004800, "num_env_steps_trained": 3004800, "num_agent_steps_sampled": 3004800, "num_agent_steps_trained": 3004800}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352657.5581136087, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2191776038995525, "mean_inference_ms": 0.37646199387429086, "mean_action_processing_ms": 0.0926456283023952, "mean_env_wait_ms": 0.6938361464284364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003510713577270508, "StateBufferConnector_ms": 0.002620220184326172, "ViewRequirementAgentConnector_ms": 0.06620049476623535}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352657.5581136087, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2191776038995525, "mean_inference_ms": 0.37646199387429086, "mean_action_processing_ms": 0.0926456283023952, "mean_env_wait_ms": 0.6938361464284364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003510713577270508, "StateBufferConnector_ms": 0.002620220184326172, "ViewRequirementAgentConnector_ms": 0.06620049476623535}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3004800, "num_agent_steps_trained": 3004800, "num_env_steps_sampled": 3004800, "num_env_steps_trained": 3004800, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 717.1358883667232, "num_env_steps_trained_throughput_per_sec": 717.1358883667232, "timesteps_total": 3004800, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3004800, "timers": {"training_iteration_time_ms": 61487.207, "sample_time_ms": 60342.383, "load_time_ms": 16.765, "load_throughput": 2619699.051, "learn_time_ms": 1126.94, "learn_throughput": 38972.794, "synch_weights_time_ms": 0.962}, "counters": {"num_env_steps_sampled": 3004800, "num_env_steps_trained": 3004800, "num_agent_steps_sampled": 3004800, "num_agent_steps_trained": 3004800}, "done": false, "episodes_total": 1259, "training_iteration": 380, "trial_id": "4d6b1_00000", "date": "2023-08-03_14-51-32", "timestamp": 1691063492, "time_this_iter_s": 61.246413707733154, "time_total_s": 7146.347072601318, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2478.802314758301, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 17.285057471264366, "ram_util_percent": 62.803448275862074}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1698.2215202487246, "policy_loss": -1.768447982057077e+20, "vf_loss": 303597376.36151606}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 27783.5, "diff_num_grad_updates_vs_sampler_policy": 27782.5}}, "num_env_steps_sampled": 3048720, "num_env_steps_trained": 3048720, "num_agent_steps_sampled": 3048720, "num_agent_steps_trained": 3048720}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352667.7899603161, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21913372018887042, "mean_inference_ms": 0.37636762153561093, "mean_action_processing_ms": 0.09263001119879694, "mean_env_wait_ms": 0.6935518940837163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035030085866044206, "StateBufferConnector_ms": 0.0026185338090105753, "ViewRequirementAgentConnector_ms": 0.06619255717207746}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352667.7899603161, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21913372018887042, "mean_inference_ms": 0.37636762153561093, "mean_action_processing_ms": 0.09263001119879694, "mean_env_wait_ms": 0.6935518940837163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035030085866044206, "StateBufferConnector_ms": 0.0026185338090105753, "ViewRequirementAgentConnector_ms": 0.06619255717207746}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3048720, "num_agent_steps_trained": 3048720, "num_env_steps_sampled": 3048720, "num_env_steps_trained": 3048720, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 712.9881344769599, "num_env_steps_trained_throughput_per_sec": 712.9881344769599, "timesteps_total": 3048720, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3048720, "timers": {"training_iteration_time_ms": 61514.921, "sample_time_ms": 60370.302, "load_time_ms": 16.782, "load_throughput": 2617134.718, "learn_time_ms": 1126.737, "learn_throughput": 38979.804, "synch_weights_time_ms": 0.943}, "counters": {"num_env_steps_sampled": 3048720, "num_env_steps_trained": 3048720, "num_agent_steps_sampled": 3048720, "num_agent_steps_trained": 3048720}, "done": false, "episodes_total": 1260, "training_iteration": 381, "trial_id": "4d6b1_00000", "date": "2023-08-03_14-52-34", "timestamp": 1691063554, "time_this_iter_s": 61.60265803337097, "time_total_s": 7207.949730634689, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2540.4049727916718, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 17.2, "ram_util_percent": 62.75057471264367}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1699.0787490533323, "policy_loss": -1.6111921275933744e+20, "vf_loss": 301622010.68804663}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 28469.5, "diff_num_grad_updates_vs_sampler_policy": 28468.5}}, "num_env_steps_sampled": 3092640, "num_env_steps_trained": 3092640, "num_agent_steps_sampled": 3092640, "num_agent_steps_trained": 3092640}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352576.2830766635, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2190889874839201, "mean_inference_ms": 0.376275297683677, "mean_action_processing_ms": 0.09261485697934198, "mean_env_wait_ms": 0.6932755934981956, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034979411533900668, "StateBufferConnector_ms": 0.0026174954005650113, "ViewRequirementAgentConnector_ms": 0.06619010652814593}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352576.2830766635, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2190889874839201, "mean_inference_ms": 0.376275297683677, "mean_action_processing_ms": 0.09261485697934198, "mean_env_wait_ms": 0.6932755934981956, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034979411533900668, "StateBufferConnector_ms": 0.0026174954005650113, "ViewRequirementAgentConnector_ms": 0.06619010652814593}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3092640, "num_agent_steps_trained": 3092640, "num_env_steps_sampled": 3092640, "num_env_steps_trained": 3092640, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 719.4264750364147, "num_env_steps_trained_throughput_per_sec": 719.4264750364147, "timesteps_total": 3092640, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3092640, "timers": {"training_iteration_time_ms": 61464.186, "sample_time_ms": 60318.487, "load_time_ms": 16.821, "load_throughput": 2611080.692, "learn_time_ms": 1127.769, "learn_throughput": 38944.154, "synch_weights_time_ms": 0.951}, "counters": {"num_env_steps_sampled": 3092640, "num_env_steps_trained": 3092640, "num_agent_steps_sampled": 3092640, "num_agent_steps_trained": 3092640}, "done": false, "episodes_total": 1261, "training_iteration": 382, "trial_id": "4d6b1_00000", "date": "2023-08-03_14-53-35", "timestamp": 1691063615, "time_this_iter_s": 61.05162501335144, "time_total_s": 7269.001355648041, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2601.456597805023, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 17.608045977011496, "ram_util_percent": 62.875862068965525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1699.747150387778, "policy_loss": -1.785971008470633e+20, "vf_loss": 303785504.3090379}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 29155.5, "diff_num_grad_updates_vs_sampler_policy": 29154.5}}, "num_env_steps_sampled": 3136560, "num_env_steps_trained": 3136560, "num_agent_steps_sampled": 3136560, "num_agent_steps_trained": 3136560}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352599.6268564917, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21904603434029504, "mean_inference_ms": 0.37618505759662724, "mean_action_processing_ms": 0.09260014831960993, "mean_env_wait_ms": 0.6930090361296991, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00355631806129633, "StateBufferConnector_ms": 0.002621495446493459, "ViewRequirementAgentConnector_ms": 0.06617113601329715}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352599.6268564917, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21904603434029504, "mean_inference_ms": 0.37618505759662724, "mean_action_processing_ms": 0.09260014831960993, "mean_env_wait_ms": 0.6930090361296991, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00355631806129633, "StateBufferConnector_ms": 0.002621495446493459, "ViewRequirementAgentConnector_ms": 0.06617113601329715}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3136560, "num_agent_steps_trained": 3136560, "num_env_steps_sampled": 3136560, "num_env_steps_trained": 3136560, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 715.1610423681069, "num_env_steps_trained_throughput_per_sec": 715.1610423681069, "timesteps_total": 3136560, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3136560, "timers": {"training_iteration_time_ms": 61446.101, "sample_time_ms": 60301.079, "load_time_ms": 16.776, "load_throughput": 2618098.08, "learn_time_ms": 1127.132, "learn_throughput": 38966.143, "synch_weights_time_ms": 0.955}, "counters": {"num_env_steps_sampled": 3136560, "num_env_steps_trained": 3136560, "num_agent_steps_sampled": 3136560, "num_agent_steps_trained": 3136560}, "done": false, "episodes_total": 1262, "training_iteration": 383, "trial_id": "4d6b1_00000", "date": "2023-08-03_14-54-36", "timestamp": 1691063676, "time_this_iter_s": 61.4159049987793, "time_total_s": 7330.41726064682, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2662.8725028038025, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 17.114942528735632, "ram_util_percent": 62.65862068965519}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1700.9981495493007, "policy_loss": -1.991384685642732e+20, "vf_loss": 302544775.9766764}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 29841.5, "diff_num_grad_updates_vs_sampler_policy": 29840.5}}, "num_env_steps_sampled": 3180480, "num_env_steps_trained": 3180480, "num_agent_steps_sampled": 3180480, "num_agent_steps_trained": 3180480}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352557.8846375113, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2190044332344571, "mean_inference_ms": 0.3760970337453759, "mean_action_processing_ms": 0.09258584607460381, "mean_env_wait_ms": 0.6927523168680475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003544308922507546, "StateBufferConnector_ms": 0.0026155601848255505, "ViewRequirementAgentConnector_ms": 0.06616386500271884}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352557.8846375113, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2190044332344571, "mean_inference_ms": 0.3760970337453759, "mean_action_processing_ms": 0.09258584607460381, "mean_env_wait_ms": 0.6927523168680475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003544308922507546, "StateBufferConnector_ms": 0.0026155601848255505, "ViewRequirementAgentConnector_ms": 0.06616386500271884}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3180480, "num_agent_steps_trained": 3180480, "num_env_steps_sampled": 3180480, "num_env_steps_trained": 3180480, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 714.7387953696583, "num_env_steps_trained_throughput_per_sec": 714.7387953696583, "timesteps_total": 3180480, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3180480, "timers": {"training_iteration_time_ms": 61431.229, "sample_time_ms": 60288.541, "load_time_ms": 16.699, "load_throughput": 2630029.363, "learn_time_ms": 1124.885, "learn_throughput": 39043.98, "synch_weights_time_ms": 0.943}, "counters": {"num_env_steps_sampled": 3180480, "num_env_steps_trained": 3180480, "num_agent_steps_sampled": 3180480, "num_agent_steps_trained": 3180480}, "done": false, "episodes_total": 1263, "training_iteration": 384, "trial_id": "4d6b1_00000", "date": "2023-08-03_14-55-38", "timestamp": 1691063738, "time_this_iter_s": 61.451733112335205, "time_total_s": 7391.868993759155, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2724.3242359161377, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 17.19080459770115, "ram_util_percent": 62.77586206896551}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1702.5147253097668, "policy_loss": -2.004651130914558e+20, "vf_loss": 305200382.5131195}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 30527.5, "diff_num_grad_updates_vs_sampler_policy": 30526.5}}, "num_env_steps_sampled": 3224400, "num_env_steps_trained": 3224400, "num_agent_steps_sampled": 3224400, "num_agent_steps_trained": 3224400}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352646.3147189922, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21896435746720186, "mean_inference_ms": 0.3760106270561471, "mean_action_processing_ms": 0.0925719273904876, "mean_env_wait_ms": 0.6925059362846893, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003532833523220486, "StateBufferConnector_ms": 0.0026135974460177952, "ViewRequirementAgentConnector_ms": 0.06613095601399739}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352646.3147189922, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21896435746720186, "mean_inference_ms": 0.3760106270561471, "mean_action_processing_ms": 0.0925719273904876, "mean_env_wait_ms": 0.6925059362846893, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003532833523220486, "StateBufferConnector_ms": 0.0026135974460177952, "ViewRequirementAgentConnector_ms": 0.06613095601399739}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3224400, "num_agent_steps_trained": 3224400, "num_env_steps_sampled": 3224400, "num_env_steps_trained": 3224400, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 713.7724648197138, "num_env_steps_trained_throughput_per_sec": 713.7724648197138, "timesteps_total": 3224400, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3224400, "timers": {"training_iteration_time_ms": 61429.968, "sample_time_ms": 60286.718, "load_time_ms": 16.786, "load_throughput": 2616491.632, "learn_time_ms": 1125.374, "learn_throughput": 39027.035, "synch_weights_time_ms": 0.93}, "counters": {"num_env_steps_sampled": 3224400, "num_env_steps_trained": 3224400, "num_agent_steps_sampled": 3224400, "num_agent_steps_trained": 3224400}, "done": false, "episodes_total": 1264, "training_iteration": 385, "trial_id": "4d6b1_00000", "date": "2023-08-03_14-56-39", "timestamp": 1691063799, "time_this_iter_s": 61.53501319885254, "time_total_s": 7453.404006958008, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2785.8592491149902, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 17.136781609195406, "ram_util_percent": 62.84942528735634}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1704.0591631741981, "policy_loss": -2.0124544997291966e+20, "vf_loss": 303096418.11078715}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 31213.5, "diff_num_grad_updates_vs_sampler_policy": 31212.5}}, "num_env_steps_sampled": 3268320, "num_env_steps_trained": 3268320, "num_agent_steps_sampled": 3268320, "num_agent_steps_trained": 3268320}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352628.9556747845, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21892593169482358, "mean_inference_ms": 0.3759268161643116, "mean_action_processing_ms": 0.09255830747134287, "mean_env_wait_ms": 0.6922686845220192, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035337779832922893, "StateBufferConnector_ms": 0.0026143115499745245, "ViewRequirementAgentConnector_ms": 0.06616737531579059}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352628.9556747845, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21892593169482358, "mean_inference_ms": 0.3759268161643116, "mean_action_processing_ms": 0.09255830747134287, "mean_env_wait_ms": 0.6922686845220192, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035337779832922893, "StateBufferConnector_ms": 0.0026143115499745245, "ViewRequirementAgentConnector_ms": 0.06616737531579059}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3268320, "num_agent_steps_trained": 3268320, "num_env_steps_sampled": 3268320, "num_env_steps_trained": 3268320, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 713.2742351399368, "num_env_steps_trained_throughput_per_sec": 713.2742351399368, "timesteps_total": 3268320, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3268320, "timers": {"training_iteration_time_ms": 61431.46, "sample_time_ms": 60287.931, "load_time_ms": 17.028, "load_throughput": 2579241.767, "learn_time_ms": 1125.403, "learn_throughput": 39026.019, "synch_weights_time_ms": 0.935}, "counters": {"num_env_steps_sampled": 3268320, "num_env_steps_trained": 3268320, "num_agent_steps_sampled": 3268320, "num_agent_steps_trained": 3268320}, "done": false, "episodes_total": 1265, "training_iteration": 386, "trial_id": "4d6b1_00000", "date": "2023-08-03_14-57-41", "timestamp": 1691063861, "time_this_iter_s": 61.577842712402344, "time_total_s": 7514.98184967041, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2847.4370918273926, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 17.19655172413793, "ram_util_percent": 62.80344827586209}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1705.2106949608806, "policy_loss": -2.1171281399198777e+20, "vf_loss": 302345282.7755102}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 31899.5, "diff_num_grad_updates_vs_sampler_policy": 31898.5}}, "num_env_steps_sampled": 3312240, "num_env_steps_trained": 3312240, "num_agent_steps_sampled": 3312240, "num_agent_steps_trained": 3312240}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352578.62360441, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21888898437918447, "mean_inference_ms": 0.3758446882409272, "mean_action_processing_ms": 0.09254494154890669, "mean_env_wait_ms": 0.6920385693140959, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035225076878324466, "StateBufferConnector_ms": 0.0026089079836581616, "ViewRequirementAgentConnector_ms": 0.06618246119073097}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352578.62360441, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21888898437918447, "mean_inference_ms": 0.3758446882409272, "mean_action_processing_ms": 0.09254494154890669, "mean_env_wait_ms": 0.6920385693140959, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035225076878324466, "StateBufferConnector_ms": 0.0026089079836581616, "ViewRequirementAgentConnector_ms": 0.06618246119073097}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3312240, "num_agent_steps_trained": 3312240, "num_env_steps_sampled": 3312240, "num_env_steps_trained": 3312240, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 715.8279077010853, "num_env_steps_trained_throughput_per_sec": 715.8279077010853, "timesteps_total": 3312240, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3312240, "timers": {"training_iteration_time_ms": 61453.6, "sample_time_ms": 60310.007, "load_time_ms": 17.043, "load_throughput": 2577004.711, "learn_time_ms": 1125.464, "learn_throughput": 39023.89, "synch_weights_time_ms": 0.924}, "counters": {"num_env_steps_sampled": 3312240, "num_env_steps_trained": 3312240, "num_agent_steps_sampled": 3312240, "num_agent_steps_trained": 3312240}, "done": false, "episodes_total": 1266, "training_iteration": 387, "trial_id": "4d6b1_00000", "date": "2023-08-03_14-58-42", "timestamp": 1691063922, "time_this_iter_s": 61.35850715637207, "time_total_s": 7576.340356826782, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2908.7955989837646, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 16.99655172413793, "ram_util_percent": 62.82298850574714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1706.2528353766172, "policy_loss": -2.0943348194700005e+20, "vf_loss": 303089943.5102041}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 32585.5, "diff_num_grad_updates_vs_sampler_policy": 32584.5}}, "num_env_steps_sampled": 3356160, "num_env_steps_trained": 3356160, "num_agent_steps_sampled": 3356160, "num_agent_steps_trained": 3356160}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352560.560414023, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2188535943306574, "mean_inference_ms": 0.3757646605721155, "mean_action_processing_ms": 0.09253196792893707, "mean_env_wait_ms": 0.6918130396514545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003576775391896566, "StateBufferConnector_ms": 0.0026126702626546225, "ViewRequirementAgentConnector_ms": 0.06614774465560913}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352560.560414023, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2188535943306574, "mean_inference_ms": 0.3757646605721155, "mean_action_processing_ms": 0.09253196792893707, "mean_env_wait_ms": 0.6918130396514545, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003576775391896566, "StateBufferConnector_ms": 0.0026126702626546225, "ViewRequirementAgentConnector_ms": 0.06614774465560913}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3356160, "num_agent_steps_trained": 3356160, "num_env_steps_sampled": 3356160, "num_env_steps_trained": 3356160, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 716.7286376267253, "num_env_steps_trained_throughput_per_sec": 716.7286376267253, "timesteps_total": 3356160, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3356160, "timers": {"training_iteration_time_ms": 61413.131, "sample_time_ms": 60266.593, "load_time_ms": 16.909, "load_throughput": 2597399.858, "learn_time_ms": 1128.539, "learn_throughput": 38917.578, "synch_weights_time_ms": 0.929}, "counters": {"num_env_steps_sampled": 3356160, "num_env_steps_trained": 3356160, "num_agent_steps_sampled": 3356160, "num_agent_steps_trained": 3356160}, "done": false, "episodes_total": 1267, "training_iteration": 388, "trial_id": "4d6b1_00000", "date": "2023-08-03_14-59-44", "timestamp": 1691063984, "time_this_iter_s": 61.28118085861206, "time_total_s": 7637.621537685394, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2970.0767798423767, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 18.029885057471265, "ram_util_percent": 62.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1707.415389614272, "policy_loss": -2.3083452039872335e+20, "vf_loss": 302885469.3877551}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 33271.5, "diff_num_grad_updates_vs_sampler_policy": 33270.5}}, "num_env_steps_sampled": 3400080, "num_env_steps_trained": 3400080, "num_agent_steps_sampled": 3400080, "num_agent_steps_trained": 3400080}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352538.855782522, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21881889764759682, "mean_inference_ms": 0.37568830584928, "mean_action_processing_ms": 0.09251931224461629, "mean_env_wait_ms": 0.6915948209758485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035684935900629784, "StateBufferConnector_ms": 0.0026055744716099332, "ViewRequirementAgentConnector_ms": 0.06613244815748565}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352538.855782522, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21881889764759682, "mean_inference_ms": 0.37568830584928, "mean_action_processing_ms": 0.09251931224461629, "mean_env_wait_ms": 0.6915948209758485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035684935900629784, "StateBufferConnector_ms": 0.0026055744716099332, "ViewRequirementAgentConnector_ms": 0.06613244815748565}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3400080, "num_agent_steps_trained": 3400080, "num_env_steps_sampled": 3400080, "num_env_steps_trained": 3400080, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 713.0937425357233, "num_env_steps_trained_throughput_per_sec": 713.0937425357233, "timesteps_total": 3400080, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3400080, "timers": {"training_iteration_time_ms": 61408.586, "sample_time_ms": 60259.692, "load_time_ms": 16.938, "load_throughput": 2592939.509, "learn_time_ms": 1130.876, "learn_throughput": 38837.156, "synch_weights_time_ms": 0.918}, "counters": {"num_env_steps_sampled": 3400080, "num_env_steps_trained": 3400080, "num_agent_steps_sampled": 3400080, "num_agent_steps_trained": 3400080}, "done": false, "episodes_total": 1268, "training_iteration": 389, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-00-45", "timestamp": 1691064045, "time_this_iter_s": 61.594197034835815, "time_total_s": 7699.21573472023, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3031.6709768772125, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 17.17471264367816, "ram_util_percent": 62.80459770114941}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1707.6688006431646, "policy_loss": -2.128032725143345e+20, "vf_loss": 302255815.3702624}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 33957.5, "diff_num_grad_updates_vs_sampler_policy": 33956.5}}, "num_env_steps_sampled": 3444000, "num_env_steps_trained": 3444000, "num_agent_steps_sampled": 3444000, "num_agent_steps_trained": 3444000}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352491.1987557209, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2187854455085909, "mean_inference_ms": 0.37561401286323925, "mean_action_processing_ms": 0.09250701684188155, "mean_env_wait_ms": 0.6913820793367426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035581588745117188, "StateBufferConnector_ms": 0.0026040077209472656, "ViewRequirementAgentConnector_ms": 0.06612110137939453}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352491.1987557209, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2187854455085909, "mean_inference_ms": 0.37561401286323925, "mean_action_processing_ms": 0.09250701684188155, "mean_env_wait_ms": 0.6913820793367426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035581588745117188, "StateBufferConnector_ms": 0.0026040077209472656, "ViewRequirementAgentConnector_ms": 0.06612110137939453}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3444000, "num_agent_steps_trained": 3444000, "num_env_steps_sampled": 3444000, "num_env_steps_trained": 3444000, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 716.0781947343338, "num_env_steps_trained_throughput_per_sec": 716.0781947343338, "timesteps_total": 3444000, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3444000, "timers": {"training_iteration_time_ms": 61417.632, "sample_time_ms": 60268.944, "load_time_ms": 16.799, "load_throughput": 2614464.078, "learn_time_ms": 1130.82, "learn_throughput": 38839.084, "synch_weights_time_ms": 0.908}, "counters": {"num_env_steps_sampled": 3444000, "num_env_steps_trained": 3444000, "num_agent_steps_sampled": 3444000, "num_agent_steps_trained": 3444000}, "done": false, "episodes_total": 1269, "training_iteration": 390, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-01-47", "timestamp": 1691064107, "time_this_iter_s": 61.33697009086609, "time_total_s": 7760.552704811096, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3093.0079469680786, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 17.137931034482754, "ram_util_percent": 62.795402298850576}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1709.242911202567, "policy_loss": -2.487057270655459e+20, "vf_loss": 302424193.7434402}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 34643.5, "diff_num_grad_updates_vs_sampler_policy": 34642.5}}, "num_env_steps_sampled": 3487920, "num_env_steps_trained": 3487920, "num_agent_steps_sampled": 3487920, "num_agent_steps_trained": 3487920}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352449.7543545947, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.218753882198869, "mean_inference_ms": 0.3755415551706503, "mean_action_processing_ms": 0.09249491680056082, "mean_env_wait_ms": 0.6911756813678529, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003550099391563266, "StateBufferConnector_ms": 0.002598295024797028, "ViewRequirementAgentConnector_ms": 0.06609757741292317}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352449.7543545947, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.218753882198869, "mean_inference_ms": 0.3755415551706503, "mean_action_processing_ms": 0.09249491680056082, "mean_env_wait_ms": 0.6911756813678529, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003550099391563266, "StateBufferConnector_ms": 0.002598295024797028, "ViewRequirementAgentConnector_ms": 0.06609757741292317}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3487920, "num_agent_steps_trained": 3487920, "num_env_steps_sampled": 3487920, "num_env_steps_trained": 3487920, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 714.0300536638182, "num_env_steps_trained_throughput_per_sec": 714.0300536638182, "timesteps_total": 3487920, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3487920, "timers": {"training_iteration_time_ms": 61408.643, "sample_time_ms": 60259.174, "load_time_ms": 16.87, "load_throughput": 2603383.178, "learn_time_ms": 1131.525, "learn_throughput": 38814.858, "synch_weights_time_ms": 0.91}, "counters": {"num_env_steps_sampled": 3487920, "num_env_steps_trained": 3487920, "num_agent_steps_sampled": 3487920, "num_agent_steps_trained": 3487920}, "done": false, "episodes_total": 1270, "training_iteration": 391, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-02-48", "timestamp": 1691064168, "time_this_iter_s": 61.51272702217102, "time_total_s": 7822.065431833267, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3154.5206739902496, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 17.18505747126437, "ram_util_percent": 62.834482758620695}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1710.213373567898, "policy_loss": -2.4706260194336584e+20, "vf_loss": 302406143.8833819}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 35329.5, "diff_num_grad_updates_vs_sampler_policy": 35328.5}}, "num_env_steps_sampled": 3531840, "num_env_steps_trained": 3531840, "num_agent_steps_sampled": 3531840, "num_agent_steps_trained": 3531840}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352413.0823234222, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21872317647876974, "mean_inference_ms": 0.3754708898955371, "mean_action_processing_ms": 0.09248312951728724, "mean_env_wait_ms": 0.6909754490639863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035460178668682393, "StateBufferConnector_ms": 0.00260013800400954, "ViewRequirementAgentConnector_ms": 0.06615886321434608}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352413.0823234222, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21872317647876974, "mean_inference_ms": 0.3754708898955371, "mean_action_processing_ms": 0.09248312951728724, "mean_env_wait_ms": 0.6909754490639863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035460178668682393, "StateBufferConnector_ms": 0.00260013800400954, "ViewRequirementAgentConnector_ms": 0.06615886321434608}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3531840, "num_agent_steps_trained": 3531840, "num_env_steps_sampled": 3531840, "num_env_steps_trained": 3531840, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 715.1216859772162, "num_env_steps_trained_throughput_per_sec": 715.1216859772162, "timesteps_total": 3531840, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3531840, "timers": {"training_iteration_time_ms": 61445.393, "sample_time_ms": 60297.544, "load_time_ms": 16.883, "load_throughput": 2601412.617, "learn_time_ms": 1129.898, "learn_throughput": 38870.759, "synch_weights_time_ms": 0.905}, "counters": {"num_env_steps_sampled": 3531840, "num_env_steps_trained": 3531840, "num_agent_steps_sampled": 3531840, "num_agent_steps_trained": 3531840}, "done": false, "episodes_total": 1271, "training_iteration": 392, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-03-50", "timestamp": 1691064230, "time_this_iter_s": 61.419257164001465, "time_total_s": 7883.484688997269, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3215.939931154251, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 16.639080459770117, "ram_util_percent": 62.84942528735632}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.3499999999999995e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1710.6770774018312, "policy_loss": -2.516731033331042e+20, "vf_loss": 302635959.41690964}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 36015.5, "diff_num_grad_updates_vs_sampler_policy": 36014.5}}, "num_env_steps_sampled": 3575760, "num_env_steps_trained": 3575760, "num_agent_steps_sampled": 3575760, "num_agent_steps_trained": 3575760}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352383.3513831943, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21869174344689812, "mean_inference_ms": 0.3754016687390127, "mean_action_processing_ms": 0.09247161805448945, "mean_env_wait_ms": 0.6907815447609127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003541190669221698, "StateBufferConnector_ms": 0.0025978628194557045, "ViewRequirementAgentConnector_ms": 0.06613686399639777}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352383.3513831943, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21869174344689812, "mean_inference_ms": 0.3754016687390127, "mean_action_processing_ms": 0.09247161805448945, "mean_env_wait_ms": 0.6907815447609127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003541190669221698, "StateBufferConnector_ms": 0.0025978628194557045, "ViewRequirementAgentConnector_ms": 0.06613686399639777}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3575760, "num_agent_steps_trained": 3575760, "num_env_steps_sampled": 3575760, "num_env_steps_trained": 3575760, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 716.98985514514, "num_env_steps_trained_throughput_per_sec": 716.98985514514, "timesteps_total": 3575760, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3575760, "timers": {"training_iteration_time_ms": 61429.728, "sample_time_ms": 60281.354, "load_time_ms": 16.91, "load_throughput": 2597352.249, "learn_time_ms": 1130.406, "learn_throughput": 38853.283, "synch_weights_time_ms": 0.898}, "counters": {"num_env_steps_sampled": 3575760, "num_env_steps_trained": 3575760, "num_agent_steps_sampled": 3575760, "num_agent_steps_trained": 3575760}, "done": false, "episodes_total": 1272, "training_iteration": 393, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-04-51", "timestamp": 1691064291, "time_this_iter_s": 61.259584188461304, "time_total_s": 7944.74427318573, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3277.1995153427124, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 17.180459770114936, "ram_util_percent": 62.74597701149426}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.1999999999999993e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1711.6690214729865, "policy_loss": -2.693001484527118e+20, "vf_loss": 304090746.7113703}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 36701.5, "diff_num_grad_updates_vs_sampler_policy": 36700.5}}, "num_env_steps_sampled": 3619680, "num_env_steps_trained": 3619680, "num_agent_steps_sampled": 3619680, "num_agent_steps_trained": 3619680}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352417.9205732753, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.218661208724943, "mean_inference_ms": 0.37533376327366064, "mean_action_processing_ms": 0.09246038826034658, "mean_env_wait_ms": 0.6905936888125617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035365422566731772, "StateBufferConnector_ms": 0.002600970091643157, "ViewRequirementAgentConnector_ms": 0.06611258895308883}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352417.9205732753, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.218661208724943, "mean_inference_ms": 0.37533376327366064, "mean_action_processing_ms": 0.09246038826034658, "mean_env_wait_ms": 0.6905936888125617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035365422566731772, "StateBufferConnector_ms": 0.002600970091643157, "ViewRequirementAgentConnector_ms": 0.06611258895308883}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3619680, "num_agent_steps_trained": 3619680, "num_env_steps_sampled": 3619680, "num_env_steps_trained": 3619680, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 714.9967659111164, "num_env_steps_trained_throughput_per_sec": 714.9967659111164, "timesteps_total": 3619680, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3619680, "timers": {"training_iteration_time_ms": 61427.511, "sample_time_ms": 60278.898, "load_time_ms": 16.947, "load_throughput": 2591542.41, "learn_time_ms": 1130.597, "learn_throughput": 38846.741, "synch_weights_time_ms": 0.91}, "counters": {"num_env_steps_sampled": 3619680, "num_env_steps_trained": 3619680, "num_agent_steps_sampled": 3619680, "num_agent_steps_trained": 3619680}, "done": false, "episodes_total": 1273, "training_iteration": 394, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-05-52", "timestamp": 1691064352, "time_this_iter_s": 61.42984485626221, "time_total_s": 8006.174118041992, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3338.6293601989746, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 17.906896551724138, "ram_util_percent": 62.89885057471263}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.0500000000000003e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1712.534070963067, "policy_loss": -2.8317563549676316e+20, "vf_loss": 304918203.2478134}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 37387.5, "diff_num_grad_updates_vs_sampler_policy": 37386.5}}, "num_env_steps_sampled": 3663600, "num_env_steps_trained": 3663600, "num_agent_steps_sampled": 3663600, "num_agent_steps_trained": 3663600}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352482.420867882, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21863169388777773, "mean_inference_ms": 0.375267106962312, "mean_action_processing_ms": 0.09244942097469792, "mean_env_wait_ms": 0.6904136044461303, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00353119590065696, "StateBufferConnector_ms": 0.0026004964655095882, "ViewRequirementAgentConnector_ms": 0.06609396501020952}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352482.420867882, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21863169388777773, "mean_inference_ms": 0.375267106962312, "mean_action_processing_ms": 0.09244942097469792, "mean_env_wait_ms": 0.6904136044461303, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00353119590065696, "StateBufferConnector_ms": 0.0026004964655095882, "ViewRequirementAgentConnector_ms": 0.06609396501020952}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3663600, "num_agent_steps_trained": 3663600, "num_env_steps_sampled": 3663600, "num_env_steps_trained": 3663600, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 711.4652410499034, "num_env_steps_trained_throughput_per_sec": 711.4652410499034, "timesteps_total": 3663600, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3663600, "timers": {"training_iteration_time_ms": 61447.466, "sample_time_ms": 60298.606, "load_time_ms": 16.83, "load_throughput": 2609571.559, "learn_time_ms": 1130.957, "learn_throughput": 38834.359, "synch_weights_time_ms": 0.911}, "counters": {"num_env_steps_sampled": 3663600, "num_env_steps_trained": 3663600, "num_agent_steps_sampled": 3663600, "num_agent_steps_trained": 3663600}, "done": false, "episodes_total": 1274, "training_iteration": 395, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-06-54", "timestamp": 1691064414, "time_this_iter_s": 61.73470592498779, "time_total_s": 8067.90882396698, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3400.3640661239624, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 16.726436781609195, "ram_util_percent": 62.85402298850576}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.9000000000000002e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1712.8742350141786, "policy_loss": -2.8971178545047578e+20, "vf_loss": 303757818.83381927}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 38073.5, "diff_num_grad_updates_vs_sampler_policy": 38072.5}}, "num_env_steps_sampled": 3707520, "num_env_steps_trained": 3707520, "num_agent_steps_sampled": 3707520, "num_agent_steps_trained": 3707520}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352505.0694764333, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21860346788170873, "mean_inference_ms": 0.3752020697728154, "mean_action_processing_ms": 0.09243882610382924, "mean_env_wait_ms": 0.690240925687441, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035247632435389926, "StateBufferConnector_ms": 0.002599614007132394, "ViewRequirementAgentConnector_ms": 0.0660811151776995}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352505.0694764333, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21860346788170873, "mean_inference_ms": 0.3752020697728154, "mean_action_processing_ms": 0.09243882610382924, "mean_env_wait_ms": 0.690240925687441, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035247632435389926, "StateBufferConnector_ms": 0.002599614007132394, "ViewRequirementAgentConnector_ms": 0.0660811151776995}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3707520, "num_agent_steps_trained": 3707520, "num_env_steps_sampled": 3707520, "num_env_steps_trained": 3707520, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 709.902301347409, "num_env_steps_trained_throughput_per_sec": 709.902301347409, "timesteps_total": 3707520, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3707520, "timers": {"training_iteration_time_ms": 61476.713, "sample_time_ms": 60326.0, "load_time_ms": 16.805, "load_throughput": 2613455.186, "learn_time_ms": 1132.856, "learn_throughput": 38769.27, "synch_weights_time_ms": 0.893}, "counters": {"num_env_steps_sampled": 3707520, "num_env_steps_trained": 3707520, "num_agent_steps_sampled": 3707520, "num_agent_steps_trained": 3707520}, "done": false, "episodes_total": 1275, "training_iteration": 396, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-07-56", "timestamp": 1691064476, "time_this_iter_s": 61.87099289894104, "time_total_s": 8129.779816865921, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3462.2350590229034, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 17.25632183908046, "ram_util_percent": 62.825287356321844}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.7500000000000006e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1713.9355166243395, "policy_loss": -2.849265111676412e+20, "vf_loss": 304795831.47521865}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 38759.5, "diff_num_grad_updates_vs_sampler_policy": 38758.5}}, "num_env_steps_sampled": 3751440, "num_env_steps_trained": 3751440, "num_agent_steps_sampled": 3751440, "num_agent_steps_trained": 3751440}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352565.056598053, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21857621901177354, "mean_inference_ms": 0.3751383780095137, "mean_action_processing_ms": 0.09242846594831022, "mean_env_wait_ms": 0.6900760463088527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003517301459061472, "StateBufferConnector_ms": 0.002597925955789131, "ViewRequirementAgentConnector_ms": 0.06606746138187877}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352565.056598053, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21857621901177354, "mean_inference_ms": 0.3751383780095137, "mean_action_processing_ms": 0.09242846594831022, "mean_env_wait_ms": 0.6900760463088527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003517301459061472, "StateBufferConnector_ms": 0.002597925955789131, "ViewRequirementAgentConnector_ms": 0.06606746138187877}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3751440, "num_agent_steps_trained": 3751440, "num_env_steps_sampled": 3751440, "num_env_steps_trained": 3751440, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 709.7495403724678, "num_env_steps_trained_throughput_per_sec": 709.7495403724678, "timesteps_total": 3751440, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3751440, "timers": {"training_iteration_time_ms": 61529.258, "sample_time_ms": 60379.895, "load_time_ms": 16.88, "load_throughput": 2601886.603, "learn_time_ms": 1131.434, "learn_throughput": 38818.007, "synch_weights_time_ms": 0.892}, "counters": {"num_env_steps_sampled": 3751440, "num_env_steps_trained": 3751440, "num_agent_steps_sampled": 3751440, "num_agent_steps_trained": 3751440}, "done": false, "episodes_total": 1276, "training_iteration": 397, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-08-58", "timestamp": 1691064538, "time_this_iter_s": 61.884385108947754, "time_total_s": 8191.664201974869, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3524.119444131851, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 17.151136363636365, "ram_util_percent": 62.82840909090908}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.6000000000000004e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1714.6559042527447, "policy_loss": -3.118926968208494e+20, "vf_loss": 305767804.2157434}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 39445.5, "diff_num_grad_updates_vs_sampler_policy": 39444.5}}, "num_env_steps_sampled": 3795360, "num_env_steps_trained": 3795360, "num_agent_steps_sampled": 3795360, "num_agent_steps_trained": 3795360}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352658.9018829048, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21854982822096086, "mean_inference_ms": 0.37507645150000113, "mean_action_processing_ms": 0.09241836675553458, "mean_env_wait_ms": 0.6899185768870592, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003512152310075431, "StateBufferConnector_ms": 0.002597118246144262, "ViewRequirementAgentConnector_ms": 0.06611264985183189}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352658.9018829048, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21854982822096086, "mean_inference_ms": 0.37507645150000113, "mean_action_processing_ms": 0.09241836675553458, "mean_env_wait_ms": 0.6899185768870592, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003512152310075431, "StateBufferConnector_ms": 0.002597118246144262, "ViewRequirementAgentConnector_ms": 0.06611264985183189}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3795360, "num_agent_steps_trained": 3795360, "num_env_steps_sampled": 3795360, "num_env_steps_trained": 3795360, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 707.8964441403853, "num_env_steps_trained_throughput_per_sec": 707.8964441403853, "timesteps_total": 3795360, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3795360, "timers": {"training_iteration_time_ms": 61605.714, "sample_time_ms": 60456.363, "load_time_ms": 16.813, "load_throughput": 2612287.774, "learn_time_ms": 1131.483, "learn_throughput": 38816.306, "synch_weights_time_ms": 0.895}, "counters": {"num_env_steps_sampled": 3795360, "num_env_steps_trained": 3795360, "num_agent_steps_sampled": 3795360, "num_agent_steps_trained": 3795360}, "done": false, "episodes_total": 1277, "training_iteration": 398, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-10-00", "timestamp": 1691064600, "time_this_iter_s": 62.04588794708252, "time_total_s": 8253.710089921951, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3586.1653320789337, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 17.010227272727274, "ram_util_percent": 62.88522727272727}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.4499999999999997e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1715.3523739294826, "policy_loss": -2.992709306998156e+20, "vf_loss": 304990164.6180758}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 40131.5, "diff_num_grad_updates_vs_sampler_policy": 40130.5}}, "num_env_steps_sampled": 3839280, "num_env_steps_trained": 3839280, "num_agent_steps_sampled": 3839280, "num_agent_steps_trained": 3839280}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352719.419794312, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.218523314610345, "mean_inference_ms": 0.37501595374238295, "mean_action_processing_ms": 0.09240849036176813, "mean_env_wait_ms": 0.6897658993053101, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035027326163599047, "StateBufferConnector_ms": 0.0026019953064999337, "ViewRequirementAgentConnector_ms": 0.06610943099199715}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352719.419794312, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.218523314610345, "mean_inference_ms": 0.37501595374238295, "mean_action_processing_ms": 0.09240849036176813, "mean_env_wait_ms": 0.6897658993053101, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035027326163599047, "StateBufferConnector_ms": 0.0026019953064999337, "ViewRequirementAgentConnector_ms": 0.06610943099199715}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3839280, "num_agent_steps_trained": 3839280, "num_env_steps_sampled": 3839280, "num_env_steps_trained": 3839280, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 714.8072875052535, "num_env_steps_trained_throughput_per_sec": 714.8072875052535, "timesteps_total": 3839280, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3839280, "timers": {"training_iteration_time_ms": 61590.949, "sample_time_ms": 60442.196, "load_time_ms": 16.786, "load_throughput": 2616458.185, "learn_time_ms": 1130.896, "learn_throughput": 38836.468, "synch_weights_time_ms": 0.912}, "counters": {"num_env_steps_sampled": 3839280, "num_env_steps_trained": 3839280, "num_agent_steps_sampled": 3839280, "num_agent_steps_trained": 3839280}, "done": false, "episodes_total": 1278, "training_iteration": 399, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-11-01", "timestamp": 1691064661, "time_this_iter_s": 61.44592809677124, "time_total_s": 8315.156018018723, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3647.611260175705, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 17.442528735632184, "ram_util_percent": 62.91609195402299}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.2999999999999996e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1716.0384980582635, "policy_loss": -3.191816097603096e+20, "vf_loss": 303220112.3731778}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 40817.5, "diff_num_grad_updates_vs_sampler_policy": 40816.5}}, "num_env_steps_sampled": 3883200, "num_env_steps_trained": 3883200, "num_agent_steps_sampled": 3883200, "num_agent_steps_trained": 3883200}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352711.7287197371, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2184972086961644, "mean_inference_ms": 0.3749567607857862, "mean_action_processing_ms": 0.09239879926822545, "mean_env_wait_ms": 0.689619046477574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003499587376912435, "StateBufferConnector_ms": 0.002597173055013021, "ViewRequirementAgentConnector_ms": 0.06612261136372884}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352711.7287197371, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2184972086961644, "mean_inference_ms": 0.3749567607857862, "mean_action_processing_ms": 0.09239879926822545, "mean_env_wait_ms": 0.689619046477574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003499587376912435, "StateBufferConnector_ms": 0.002597173055013021, "ViewRequirementAgentConnector_ms": 0.06612261136372884}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3883200, "num_agent_steps_trained": 3883200, "num_env_steps_sampled": 3883200, "num_env_steps_trained": 3883200, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 711.8049790906952, "num_env_steps_trained_throughput_per_sec": 711.8049790906952, "timesteps_total": 3883200, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3883200, "timers": {"training_iteration_time_ms": 61627.77, "sample_time_ms": 60478.008, "load_time_ms": 16.828, "load_throughput": 2609919.097, "learn_time_ms": 1131.851, "learn_throughput": 38803.703, "synch_weights_time_ms": 0.924}, "counters": {"num_env_steps_sampled": 3883200, "num_env_steps_trained": 3883200, "num_agent_steps_sampled": 3883200, "num_agent_steps_trained": 3883200}, "done": false, "episodes_total": 1279, "training_iteration": 400, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-12-03", "timestamp": 1691064723, "time_this_iter_s": 61.705496072769165, "time_total_s": 8376.861514091492, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3709.316756248474, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 17.089655172413792, "ram_util_percent": 62.70574712643679}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.1500000000000002e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1716.6768795269224, "policy_loss": -3.058734936429326e+20, "vf_loss": 302020138.06997085}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 41503.5, "diff_num_grad_updates_vs_sampler_policy": 41502.5}}, "num_env_steps_sampled": 3927120, "num_env_steps_trained": 3927120, "num_agent_steps_sampled": 3927120, "num_agent_steps_trained": 3927120}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352661.182937057, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21847166491397352, "mean_inference_ms": 0.37489912614360626, "mean_action_processing_ms": 0.09238930860432083, "mean_env_wait_ms": 0.689475649086834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003494200159291752, "StateBufferConnector_ms": 0.0025971991116883323, "ViewRequirementAgentConnector_ms": 0.06610057393058402}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352661.182937057, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21847166491397352, "mean_inference_ms": 0.37489912614360626, "mean_action_processing_ms": 0.09238930860432083, "mean_env_wait_ms": 0.689475649086834, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003494200159291752, "StateBufferConnector_ms": 0.0025971991116883323, "ViewRequirementAgentConnector_ms": 0.06610057393058402}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3927120, "num_agent_steps_trained": 3927120, "num_env_steps_sampled": 3927120, "num_env_steps_trained": 3927120, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 715.0304327988292, "num_env_steps_trained_throughput_per_sec": 715.0304327988292, "timesteps_total": 3927120, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3927120, "timers": {"training_iteration_time_ms": 61619.165, "sample_time_ms": 60471.766, "load_time_ms": 16.884, "load_throughput": 2601320.78, "learn_time_ms": 1129.434, "learn_throughput": 38886.718, "synch_weights_time_ms": 0.921}, "counters": {"num_env_steps_sampled": 3927120, "num_env_steps_trained": 3927120, "num_agent_steps_sampled": 3927120, "num_agent_steps_trained": 3927120}, "done": false, "episodes_total": 1280, "training_iteration": 401, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-13-05", "timestamp": 1691064785, "time_this_iter_s": 61.426701068878174, "time_total_s": 8438.28821516037, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3770.7434573173523, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 17.29770114942529, "ram_util_percent": 62.91379310344826}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1717.4508766641422, "policy_loss": -3.16642931682506e+20, "vf_loss": 303005023.696793}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 42189.5, "diff_num_grad_updates_vs_sampler_policy": 42188.5}}, "num_env_steps_sampled": 3971040, "num_env_steps_trained": 3971040, "num_agent_steps_sampled": 3971040, "num_agent_steps_trained": 3971040}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352647.8344886838, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21844695844961087, "mean_inference_ms": 0.37484233570656167, "mean_action_processing_ms": 0.09237996559494431, "mean_env_wait_ms": 0.6893359201923471, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035301331550844253, "StateBufferConnector_ms": 0.0025991470583023564, "ViewRequirementAgentConnector_ms": 0.0660815546589513}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352647.8344886838, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21844695844961087, "mean_inference_ms": 0.37484233570656167, "mean_action_processing_ms": 0.09237996559494431, "mean_env_wait_ms": 0.6893359201923471, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035301331550844253, "StateBufferConnector_ms": 0.0025991470583023564, "ViewRequirementAgentConnector_ms": 0.0660815546589513}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 3971040, "num_agent_steps_trained": 3971040, "num_env_steps_sampled": 3971040, "num_env_steps_trained": 3971040, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 714.7867767608124, "num_env_steps_trained_throughput_per_sec": 714.7867767608124, "timesteps_total": 3971040, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 3971040, "timers": {"training_iteration_time_ms": 61622.042, "sample_time_ms": 60472.097, "load_time_ms": 16.923, "load_throughput": 2595354.238, "learn_time_ms": 1131.937, "learn_throughput": 38800.738, "synch_weights_time_ms": 0.926}, "counters": {"num_env_steps_sampled": 3971040, "num_env_steps_trained": 3971040, "num_agent_steps_sampled": 3971040, "num_agent_steps_trained": 3971040}, "done": false, "episodes_total": 1281, "training_iteration": 402, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-14-06", "timestamp": 1691064846, "time_this_iter_s": 61.447649002075195, "time_total_s": 8499.735864162445, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3832.1911063194275, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 16.743678160919544, "ram_util_percent": 62.82988505747127}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1717.9980329952853, "policy_loss": -3.2607608084908756e+20, "vf_loss": 303788949.83090377}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 42875.5, "diff_num_grad_updates_vs_sampler_policy": 42874.5}}, "num_env_steps_sampled": 4014960, "num_env_steps_trained": 4014960, "num_agent_steps_sampled": 4014960, "num_agent_steps_trained": 4014960}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352660.3140389172, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21842256468236806, "mean_inference_ms": 0.3747866607866747, "mean_action_processing_ms": 0.09237081471642287, "mean_env_wait_ms": 0.6892006414236787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035225398956783235, "StateBufferConnector_ms": 0.0026006547231522815, "ViewRequirementAgentConnector_ms": 0.06612331148177858}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352660.3140389172, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21842256468236806, "mean_inference_ms": 0.3747866607866747, "mean_action_processing_ms": 0.09237081471642287, "mean_env_wait_ms": 0.6892006414236787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035225398956783235, "StateBufferConnector_ms": 0.0026006547231522815, "ViewRequirementAgentConnector_ms": 0.06612331148177858}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4014960, "num_agent_steps_trained": 4014960, "num_env_steps_sampled": 4014960, "num_env_steps_trained": 4014960, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 713.3271522226177, "num_env_steps_trained_throughput_per_sec": 713.3271522226177, "timesteps_total": 4014960, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4014960, "timers": {"training_iteration_time_ms": 61653.495, "sample_time_ms": 60502.939, "load_time_ms": 16.898, "load_throughput": 2599052.612, "learn_time_ms": 1132.567, "learn_throughput": 38779.178, "synch_weights_time_ms": 0.932}, "counters": {"num_env_steps_sampled": 4014960, "num_env_steps_trained": 4014960, "num_agent_steps_sampled": 4014960, "num_agent_steps_trained": 4014960}, "done": false, "episodes_total": 1282, "training_iteration": 403, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-15-08", "timestamp": 1691064908, "time_this_iter_s": 61.57350015640259, "time_total_s": 8561.309364318848, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3893.76460647583, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 17.576136363636365, "ram_util_percent": 62.85}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1718.7019204898756, "policy_loss": -3.6643203723288864e+20, "vf_loss": 303632079.92419827}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 43561.5, "diff_num_grad_updates_vs_sampler_policy": 43560.5}}, "num_env_steps_sampled": 4058880, "num_env_steps_trained": 4058880, "num_agent_steps_sampled": 4058880, "num_agent_steps_trained": 4058880}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352667.5243998081, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21839880631514938, "mean_inference_ms": 0.3747320396461134, "mean_action_processing_ms": 0.09236183998208988, "mean_env_wait_ms": 0.6890710395499988, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003515183925628662, "StateBufferConnector_ms": 0.002600252628326416, "ViewRequirementAgentConnector_ms": 0.0661604106426239}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352667.5243998081, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21839880631514938, "mean_inference_ms": 0.3747320396461134, "mean_action_processing_ms": 0.09236183998208988, "mean_env_wait_ms": 0.6890710395499988, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003515183925628662, "StateBufferConnector_ms": 0.002600252628326416, "ViewRequirementAgentConnector_ms": 0.0661604106426239}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4058880, "num_agent_steps_trained": 4058880, "num_env_steps_sampled": 4058880, "num_env_steps_trained": 4058880, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 709.900569627768, "num_env_steps_trained_throughput_per_sec": 709.900569627768, "timesteps_total": 4058880, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4058880, "timers": {"training_iteration_time_ms": 61697.591, "sample_time_ms": 60546.074, "load_time_ms": 16.857, "load_throughput": 2605434.11, "learn_time_ms": 1133.579, "learn_throughput": 38744.558, "synch_weights_time_ms": 0.923}, "counters": {"num_env_steps_sampled": 4058880, "num_env_steps_trained": 4058880, "num_agent_steps_sampled": 4058880, "num_agent_steps_trained": 4058880}, "done": false, "episodes_total": 1283, "training_iteration": 404, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-16-10", "timestamp": 1691064970, "time_this_iter_s": 61.87070393562317, "time_total_s": 8623.18006825447, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 3955.6353104114532, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 17.26896551724138, "ram_util_percent": 62.89310344827587}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1719.4712830479568, "policy_loss": -3.342574875382431e+20, "vf_loss": 303549930.67638487}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 44247.5, "diff_num_grad_updates_vs_sampler_policy": 44246.5}}, "num_env_steps_sampled": 4102800, "num_env_steps_trained": 4102800, "num_agent_steps_sampled": 4102800, "num_agent_steps_trained": 4102800}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352673.636690391, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21837457848323713, "mean_inference_ms": 0.3746786647885891, "mean_action_processing_ms": 0.09235308853948372, "mean_env_wait_ms": 0.6889455032999177, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035117222712590145, "StateBufferConnector_ms": 0.002593994140625, "ViewRequirementAgentConnector_ms": 0.06617509401761569}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352673.636690391, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21837457848323713, "mean_inference_ms": 0.3746786647885891, "mean_action_processing_ms": 0.09235308853948372, "mean_env_wait_ms": 0.6889455032999177, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035117222712590145, "StateBufferConnector_ms": 0.002593994140625, "ViewRequirementAgentConnector_ms": 0.06617509401761569}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4102800, "num_agent_steps_trained": 4102800, "num_env_steps_sampled": 4102800, "num_env_steps_trained": 4102800, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 714.3678331396787, "num_env_steps_trained_throughput_per_sec": 714.3678331396787, "timesteps_total": 4102800, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4102800, "timers": {"training_iteration_time_ms": 61672.509, "sample_time_ms": 60521.14, "load_time_ms": 16.902, "load_throughput": 2598455.032, "learn_time_ms": 1133.387, "learn_throughput": 38751.1, "synch_weights_time_ms": 0.921}, "counters": {"num_env_steps_sampled": 4102800, "num_env_steps_trained": 4102800, "num_agent_steps_sampled": 4102800, "num_agent_steps_trained": 4102800}, "done": false, "episodes_total": 1284, "training_iteration": 405, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-17-11", "timestamp": 1691065031, "time_this_iter_s": 61.48413968086243, "time_total_s": 8684.664207935333, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4017.1194500923157, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 18.073563218390806, "ram_util_percent": 62.89425287356322}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1719.8789489568148, "policy_loss": -3.468971924319291e+20, "vf_loss": 301367037.33527696}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 44933.5, "diff_num_grad_updates_vs_sampler_policy": 44932.5}}, "num_env_steps_sampled": 4146720, "num_env_steps_trained": 4146720, "num_agent_steps_sampled": 4146720, "num_agent_steps_trained": 4146720}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352608.4600221894, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21835083990957796, "mean_inference_ms": 0.3746261906634092, "mean_action_processing_ms": 0.09234450174255504, "mean_env_wait_ms": 0.6888227312958304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003506559314149799, "StateBufferConnector_ms": 0.0025958725900361032, "ViewRequirementAgentConnector_ms": 0.06621353554003166}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352608.4600221894, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21835083990957796, "mean_inference_ms": 0.3746261906634092, "mean_action_processing_ms": 0.09234450174255504, "mean_env_wait_ms": 0.6888227312958304, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003506559314149799, "StateBufferConnector_ms": 0.0025958725900361032, "ViewRequirementAgentConnector_ms": 0.06621353554003166}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4146720, "num_agent_steps_trained": 4146720, "num_env_steps_sampled": 4146720, "num_env_steps_trained": 4146720, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 715.6237879789389, "num_env_steps_trained_throughput_per_sec": 715.6237879789389, "timesteps_total": 4146720, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4146720, "timers": {"training_iteration_time_ms": 61623.045, "sample_time_ms": 60472.722, "load_time_ms": 16.822, "load_throughput": 2610799.447, "learn_time_ms": 1132.418, "learn_throughput": 38784.26, "synch_weights_time_ms": 0.923}, "counters": {"num_env_steps_sampled": 4146720, "num_env_steps_trained": 4146720, "num_agent_steps_sampled": 4146720, "num_agent_steps_trained": 4146720}, "done": false, "episodes_total": 1285, "training_iteration": 406, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-18-12", "timestamp": 1691065092, "time_this_iter_s": 61.3763267993927, "time_total_s": 8746.040534734726, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4078.4957768917084, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 17.294318181818184, "ram_util_percent": 62.65340909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1720.4698194498224, "policy_loss": -3.152416513691336e+20, "vf_loss": 301108583.5860058}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 45619.5, "diff_num_grad_updates_vs_sampler_policy": 45618.5}}, "num_env_steps_sampled": 4190640, "num_env_steps_trained": 4190640, "num_agent_steps_sampled": 4190640, "num_agent_steps_trained": 4190640}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352532.266466826, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21832767742521586, "mean_inference_ms": 0.37457453719997663, "mean_action_processing_ms": 0.09233604052861703, "mean_env_wait_ms": 0.6887018417929097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00354176136984754, "StateBufferConnector_ms": 0.0025973391177049323, "ViewRequirementAgentConnector_ms": 0.06619104698522767}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352532.266466826, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21832767742521586, "mean_inference_ms": 0.37457453719997663, "mean_action_processing_ms": 0.09233604052861703, "mean_env_wait_ms": 0.6887018417929097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00354176136984754, "StateBufferConnector_ms": 0.0025973391177049323, "ViewRequirementAgentConnector_ms": 0.06619104698522767}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4190640, "num_agent_steps_trained": 4190640, "num_env_steps_sampled": 4190640, "num_env_steps_trained": 4190640, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 717.3209806695693, "num_env_steps_trained_throughput_per_sec": 717.3209806695693, "timesteps_total": 4190640, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4190640, "timers": {"training_iteration_time_ms": 61557.729, "sample_time_ms": 60404.81, "load_time_ms": 16.698, "load_throughput": 2630265.944, "learn_time_ms": 1135.138, "learn_throughput": 38691.33, "synch_weights_time_ms": 0.923}, "counters": {"num_env_steps_sampled": 4190640, "num_env_steps_trained": 4190640, "num_agent_steps_sampled": 4190640, "num_agent_steps_trained": 4190640}, "done": false, "episodes_total": 1286, "training_iteration": 407, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-19-14", "timestamp": 1691065154, "time_this_iter_s": 61.23059606552124, "time_total_s": 8807.271130800247, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4139.72637295723, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 16.955172413793104, "ram_util_percent": 62.69310344827588}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1721.0641694805713, "policy_loss": -3.5183850104777546e+20, "vf_loss": 303638466.5889213}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 46305.5, "diff_num_grad_updates_vs_sampler_policy": 46304.5}}, "num_env_steps_sampled": 4234560, "num_env_steps_trained": 4234560, "num_agent_steps_sampled": 4234560, "num_agent_steps_trained": 4234560}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352544.5240761656, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2183055478143739, "mean_inference_ms": 0.37452445280184327, "mean_action_processing_ms": 0.092327788025719, "mean_env_wait_ms": 0.6885848390063518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003534204819623162, "StateBufferConnector_ms": 0.0025945551255170036, "ViewRequirementAgentConnector_ms": 0.06619060740751379}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352544.5240761656, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2183055478143739, "mean_inference_ms": 0.37452445280184327, "mean_action_processing_ms": 0.092327788025719, "mean_env_wait_ms": 0.6885848390063518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003534204819623162, "StateBufferConnector_ms": 0.0025945551255170036, "ViewRequirementAgentConnector_ms": 0.06619060740751379}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4234560, "num_agent_steps_trained": 4234560, "num_env_steps_sampled": 4234560, "num_env_steps_trained": 4234560, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 709.4795475524159, "num_env_steps_trained_throughput_per_sec": 709.4795475524159, "timesteps_total": 4234560, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4234560, "timers": {"training_iteration_time_ms": 61543.884, "sample_time_ms": 60398.68, "load_time_ms": 16.722, "load_throughput": 2626504.483, "learn_time_ms": 1127.405, "learn_throughput": 38956.704, "synch_weights_time_ms": 0.919}, "counters": {"num_env_steps_sampled": 4234560, "num_env_steps_trained": 4234560, "num_agent_steps_sampled": 4234560, "num_agent_steps_trained": 4234560}, "done": false, "episodes_total": 1287, "training_iteration": 408, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-20-16", "timestamp": 1691065216, "time_this_iter_s": 61.90738081932068, "time_total_s": 8869.178511619568, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4201.63375377655, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 17.331818181818182, "ram_util_percent": 62.82727272727273}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1721.7107430060473, "policy_loss": -3.7060706911251104e+20, "vf_loss": 304091907.77842563}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 46991.5, "diff_num_grad_updates_vs_sampler_policy": 46990.5}}, "num_env_steps_sampled": 4278480, "num_env_steps_trained": 4278480, "num_agent_steps_sampled": 4278480, "num_agent_steps_trained": 4278480}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352565.8807604061, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21828397591517898, "mean_inference_ms": 0.3744755094226045, "mean_action_processing_ms": 0.09231972638091335, "mean_env_wait_ms": 0.6884712738227359, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003527903902357903, "StateBufferConnector_ms": 0.002592888431272645, "ViewRequirementAgentConnector_ms": 0.06617877794348676}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352565.8807604061, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21828397591517898, "mean_inference_ms": 0.3744755094226045, "mean_action_processing_ms": 0.09231972638091335, "mean_env_wait_ms": 0.6884712738227359, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003527903902357903, "StateBufferConnector_ms": 0.002592888431272645, "ViewRequirementAgentConnector_ms": 0.06617877794348676}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4278480, "num_agent_steps_trained": 4278480, "num_env_steps_sampled": 4278480, "num_env_steps_trained": 4278480, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 711.9725771847384, "num_env_steps_trained_throughput_per_sec": 711.9725771847384, "timesteps_total": 4278480, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4278480, "timers": {"training_iteration_time_ms": 61568.348, "sample_time_ms": 60423.408, "load_time_ms": 16.749, "load_throughput": 2622264.682, "learn_time_ms": 1127.133, "learn_throughput": 38966.114, "synch_weights_time_ms": 0.899}, "counters": {"num_env_steps_sampled": 4278480, "num_env_steps_trained": 4278480, "num_agent_steps_sampled": 4278480, "num_agent_steps_trained": 4278480}, "done": false, "episodes_total": 1288, "training_iteration": 409, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-21-17", "timestamp": 1691065277, "time_this_iter_s": 61.690672874450684, "time_total_s": 8930.869184494019, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4263.324426651001, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 17.14367816091954, "ram_util_percent": 62.89080459770115}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1722.2663196975218, "policy_loss": -3.5385136189386555e+20, "vf_loss": 303143764.2157434}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 47677.5, "diff_num_grad_updates_vs_sampler_policy": 47676.5}}, "num_env_steps_sampled": 4322400, "num_env_steps_trained": 4322400, "num_agent_steps_sampled": 4322400, "num_agent_steps_trained": 4322400}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352561.4911957046, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21826308923515614, "mean_inference_ms": 0.37442767546114264, "mean_action_processing_ms": 0.09231183058408787, "mean_env_wait_ms": 0.6883599196584684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003523486001150949, "StateBufferConnector_ms": 0.002590247562953404, "ViewRequirementAgentConnector_ms": 0.06617001124790736}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352561.4911957046, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21826308923515614, "mean_inference_ms": 0.37442767546114264, "mean_action_processing_ms": 0.09231183058408787, "mean_env_wait_ms": 0.6883599196584684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003523486001150949, "StateBufferConnector_ms": 0.002590247562953404, "ViewRequirementAgentConnector_ms": 0.06617001124790736}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4322400, "num_agent_steps_trained": 4322400, "num_env_steps_sampled": 4322400, "num_env_steps_trained": 4322400, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 714.3681683420788, "num_env_steps_trained_throughput_per_sec": 714.3681683420788, "timesteps_total": 4322400, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4322400, "timers": {"training_iteration_time_ms": 61546.208, "sample_time_ms": 60402.035, "load_time_ms": 16.733, "load_throughput": 2624775.503, "learn_time_ms": 1126.39, "learn_throughput": 38991.811, "synch_weights_time_ms": 0.891}, "counters": {"num_env_steps_sampled": 4322400, "num_env_steps_trained": 4322400, "num_agent_steps_sampled": 4322400, "num_agent_steps_trained": 4322400}, "done": false, "episodes_total": 1289, "training_iteration": 410, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-22-19", "timestamp": 1691065339, "time_this_iter_s": 61.48370409011841, "time_total_s": 8992.352888584137, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4324.808130741119, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 17.59659090909091, "ram_util_percent": 62.8625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1722.9170599845686, "policy_loss": -3.958808962403769e+20, "vf_loss": 304388451.8542274}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 48363.5, "diff_num_grad_updates_vs_sampler_policy": 48362.5}}, "num_env_steps_sampled": 4366320, "num_env_steps_trained": 4366320, "num_agent_steps_sampled": 4366320, "num_agent_steps_trained": 4366320}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352594.7724848934, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2182417363182119, "mean_inference_ms": 0.3743806926213892, "mean_action_processing_ms": 0.09230410480656985, "mean_env_wait_ms": 0.6882538300028901, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003519528348680953, "StateBufferConnector_ms": 0.002588016886106679, "ViewRequirementAgentConnector_ms": 0.06617693833901848}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352594.7724848934, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2182417363182119, "mean_inference_ms": 0.3743806926213892, "mean_action_processing_ms": 0.09230410480656985, "mean_env_wait_ms": 0.6882538300028901, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003519528348680953, "StateBufferConnector_ms": 0.002588016886106679, "ViewRequirementAgentConnector_ms": 0.06617693833901848}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4366320, "num_agent_steps_trained": 4366320, "num_env_steps_sampled": 4366320, "num_env_steps_trained": 4366320, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 710.1091699307167, "num_env_steps_trained_throughput_per_sec": 710.1091699307167, "timesteps_total": 4366320, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4366320, "timers": {"training_iteration_time_ms": 61588.777, "sample_time_ms": 60444.603, "load_time_ms": 16.573, "load_throughput": 2650085.908, "learn_time_ms": 1126.539, "learn_throughput": 38986.654, "synch_weights_time_ms": 0.902}, "counters": {"num_env_steps_sampled": 4366320, "num_env_steps_trained": 4366320, "num_agent_steps_sampled": 4366320, "num_agent_steps_trained": 4366320}, "done": false, "episodes_total": 1290, "training_iteration": 411, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-23-21", "timestamp": 1691065401, "time_this_iter_s": 61.85265111923218, "time_total_s": 9054.20553970337, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4386.660781860352, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 17.644827586206898, "ram_util_percent": 62.85402298850575}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1723.374123798515, "policy_loss": -4.110566315653511e+20, "vf_loss": 302581325.87172014}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 49049.5, "diff_num_grad_updates_vs_sampler_policy": 49048.5}}, "num_env_steps_sampled": 4410240, "num_env_steps_trained": 4410240, "num_agent_steps_sampled": 4410240, "num_agent_steps_trained": 4410240}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352573.3075965096, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21822098356188382, "mean_inference_ms": 0.3743346349735656, "mean_action_processing_ms": 0.0922965116402066, "mean_env_wait_ms": 0.6881512875111614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035160117679172093, "StateBufferConnector_ms": 0.0025828679402669272, "ViewRequirementAgentConnector_ms": 0.06615883774227566}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352573.3075965096, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21822098356188382, "mean_inference_ms": 0.3743346349735656, "mean_action_processing_ms": 0.0922965116402066, "mean_env_wait_ms": 0.6881512875111614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035160117679172093, "StateBufferConnector_ms": 0.0025828679402669272, "ViewRequirementAgentConnector_ms": 0.06615883774227566}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4410240, "num_agent_steps_trained": 4410240, "num_env_steps_sampled": 4410240, "num_env_steps_trained": 4410240, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 710.5331706712542, "num_env_steps_trained_throughput_per_sec": 710.5331706712542, "timesteps_total": 4410240, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4410240, "timers": {"training_iteration_time_ms": 61625.561, "sample_time_ms": 60480.56, "load_time_ms": 16.787, "load_throughput": 2616305.827, "learn_time_ms": 1127.16, "learn_throughput": 38965.184, "synch_weights_time_ms": 0.893}, "counters": {"num_env_steps_sampled": 4410240, "num_env_steps_trained": 4410240, "num_agent_steps_sampled": 4410240, "num_agent_steps_trained": 4410240}, "done": false, "episodes_total": 1291, "training_iteration": 412, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-24-23", "timestamp": 1691065463, "time_this_iter_s": 61.81588292121887, "time_total_s": 9116.021422624588, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4448.47666478157, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 17.067045454545454, "ram_util_percent": 62.86818181818182}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1724.0321972015647, "policy_loss": -4.4578757717578305e+20, "vf_loss": 304707828.4373178}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 49735.5, "diff_num_grad_updates_vs_sampler_policy": 49734.5}}, "num_env_steps_sampled": 4454160, "num_env_steps_trained": 4454160, "num_agent_steps_sampled": 4454160, "num_agent_steps_trained": 4454160}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352612.728632355, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21820071227575705, "mean_inference_ms": 0.3742894224895319, "mean_action_processing_ms": 0.09228904767157076, "mean_env_wait_ms": 0.6880525692494752, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003515204338178243, "StateBufferConnector_ms": 0.002581452670162671, "ViewRequirementAgentConnector_ms": 0.06616997392210242}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352612.728632355, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21820071227575705, "mean_inference_ms": 0.3742894224895319, "mean_action_processing_ms": 0.09228904767157076, "mean_env_wait_ms": 0.6880525692494752, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003515204338178243, "StateBufferConnector_ms": 0.002581452670162671, "ViewRequirementAgentConnector_ms": 0.06616997392210242}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4454160, "num_agent_steps_trained": 4454160, "num_env_steps_sampled": 4454160, "num_env_steps_trained": 4454160, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 710.078562366168, "num_env_steps_trained_throughput_per_sec": 710.078562366168, "timesteps_total": 4454160, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4454160, "timers": {"training_iteration_time_ms": 61653.729, "sample_time_ms": 60509.593, "load_time_ms": 16.89, "load_throughput": 2600292.641, "learn_time_ms": 1126.182, "learn_throughput": 38999.012, "synch_weights_time_ms": 0.902}, "counters": {"num_env_steps_sampled": 4454160, "num_env_steps_trained": 4454160, "num_agent_steps_sampled": 4454160, "num_agent_steps_trained": 4454160}, "done": false, "episodes_total": 1292, "training_iteration": 413, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-25-24", "timestamp": 1691065524, "time_this_iter_s": 61.85561180114746, "time_total_s": 9177.877034425735, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4510.332276582718, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 17.044827586206896, "ram_util_percent": 62.71724137931034}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1724.351459113919, "policy_loss": -3.825775717043191e+20, "vf_loss": 302596711.6618076}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 50421.5, "diff_num_grad_updates_vs_sampler_policy": 50420.5}}, "num_env_steps_sampled": 4498080, "num_env_steps_trained": 4498080, "num_agent_steps_sampled": 4498080, "num_agent_steps_trained": 4498080}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352587.5969756364, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21818118874699596, "mean_inference_ms": 0.3742449697140463, "mean_action_processing_ms": 0.09228172352728399, "mean_env_wait_ms": 0.6879569371426066, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003509585921828811, "StateBufferConnector_ms": 0.002578786901525549, "ViewRequirementAgentConnector_ms": 0.0661714656932934}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352587.5969756364, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21818118874699596, "mean_inference_ms": 0.3742449697140463, "mean_action_processing_ms": 0.09228172352728399, "mean_env_wait_ms": 0.6879569371426066, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003509585921828811, "StateBufferConnector_ms": 0.002578786901525549, "ViewRequirementAgentConnector_ms": 0.0661714656932934}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4498080, "num_agent_steps_trained": 4498080, "num_env_steps_sampled": 4498080, "num_env_steps_trained": 4498080, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 710.8526907198145, "num_env_steps_trained_throughput_per_sec": 710.8526907198145, "timesteps_total": 4498080, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4498080, "timers": {"training_iteration_time_ms": 61645.443, "sample_time_ms": 60501.612, "load_time_ms": 16.93, "load_throughput": 2594257.737, "learn_time_ms": 1125.836, "learn_throughput": 39010.993, "synch_weights_time_ms": 0.904}, "counters": {"num_env_steps_sampled": 4498080, "num_env_steps_trained": 4498080, "num_agent_steps_sampled": 4498080, "num_agent_steps_trained": 4498080}, "done": false, "episodes_total": 1293, "training_iteration": 414, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-26-26", "timestamp": 1691065586, "time_this_iter_s": 61.78780198097229, "time_total_s": 9239.664836406708, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4572.12007856369, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 17.432954545454546, "ram_util_percent": 62.78863636363637}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1724.7793410053753, "policy_loss": -3.734209392664734e+20, "vf_loss": 302407980.16909623}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 51107.5, "diff_num_grad_updates_vs_sampler_policy": 51106.5}}, "num_env_steps_sampled": 4542000, "num_env_steps_trained": 4542000, "num_agent_steps_sampled": 4542000, "num_agent_steps_trained": 4542000}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352558.8563348397, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.218162212265214, "mean_inference_ms": 0.3742012685320389, "mean_action_processing_ms": 0.09227452662321725, "mean_env_wait_ms": 0.6878629216928648, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035053888956705728, "StateBufferConnector_ms": 0.0025765101114908853, "ViewRequirementAgentConnector_ms": 0.06615479787190755}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352558.8563348397, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.218162212265214, "mean_inference_ms": 0.3742012685320389, "mean_action_processing_ms": 0.09227452662321725, "mean_env_wait_ms": 0.6878629216928648, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035053888956705728, "StateBufferConnector_ms": 0.0025765101114908853, "ViewRequirementAgentConnector_ms": 0.06615479787190755}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4542000, "num_agent_steps_trained": 4542000, "num_env_steps_sampled": 4542000, "num_env_steps_trained": 4542000, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 715.0693044992664, "num_env_steps_trained_throughput_per_sec": 715.0693044992664, "timesteps_total": 4542000, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4542000, "timers": {"training_iteration_time_ms": 61639.412, "sample_time_ms": 60494.805, "load_time_ms": 16.968, "load_throughput": 2588356.246, "learn_time_ms": 1126.558, "learn_throughput": 38986.025, "synch_weights_time_ms": 0.92}, "counters": {"num_env_steps_sampled": 4542000, "num_env_steps_trained": 4542000, "num_agent_steps_sampled": 4542000, "num_agent_steps_trained": 4542000}, "done": false, "episodes_total": 1294, "training_iteration": 415, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-27-28", "timestamp": 1691065648, "time_this_iter_s": 61.423484802246094, "time_total_s": 9301.088321208954, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4633.543563365936, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 16.786206896551725, "ram_util_percent": 62.77471264367816}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1725.4102555433446, "policy_loss": -4.2677035831688836e+20, "vf_loss": 304277778.6705539}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 51793.5, "diff_num_grad_updates_vs_sampler_policy": 51792.5}}, "num_env_steps_sampled": 4585920, "num_env_steps_trained": 4585920, "num_agent_steps_sampled": 4585920, "num_agent_steps_trained": 4585920}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352585.2812282958, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21814377089320494, "mean_inference_ms": 0.37415853524564946, "mean_action_processing_ms": 0.09226745104475735, "mean_env_wait_ms": 0.6877719451333254, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003501616026225843, "StateBufferConnector_ms": 0.0025774303235505756, "ViewRequirementAgentConnector_ms": 0.06614672510247481}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352585.2812282958, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21814377089320494, "mean_inference_ms": 0.37415853524564946, "mean_action_processing_ms": 0.09226745104475735, "mean_env_wait_ms": 0.6877719451333254, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003501616026225843, "StateBufferConnector_ms": 0.0025774303235505756, "ViewRequirementAgentConnector_ms": 0.06614672510247481}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4585920, "num_agent_steps_trained": 4585920, "num_env_steps_sampled": 4585920, "num_env_steps_trained": 4585920, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 710.1561265488009, "num_env_steps_trained_throughput_per_sec": 710.1561265488009, "timesteps_total": 4585920, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4585920, "timers": {"training_iteration_time_ms": 61686.664, "sample_time_ms": 60542.182, "load_time_ms": 16.85, "load_throughput": 2606451.568, "learn_time_ms": 1126.543, "learn_throughput": 38986.524, "synch_weights_time_ms": 0.928}, "counters": {"num_env_steps_sampled": 4585920, "num_env_steps_trained": 4585920, "num_agent_steps_sampled": 4585920, "num_agent_steps_trained": 4585920}, "done": false, "episodes_total": 1295, "training_iteration": 416, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-28-30", "timestamp": 1691065710, "time_this_iter_s": 61.84863901138306, "time_total_s": 9362.936960220337, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4695.392202377319, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 17.278160919540227, "ram_util_percent": 62.74942528735631}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1725.6979564077305, "policy_loss": -4.089465521627288e+20, "vf_loss": 301720504.1632653}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 52479.5, "diff_num_grad_updates_vs_sampler_policy": 52478.5}}, "num_env_steps_sampled": 4629840, "num_env_steps_trained": 4629840, "num_agent_steps_sampled": 4629840, "num_agent_steps_trained": 4629840}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352539.839877799, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21812498218039217, "mean_inference_ms": 0.37411667352272854, "mean_action_processing_ms": 0.09226049577385385, "mean_env_wait_ms": 0.6876834048945762, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034973218843534397, "StateBufferConnector_ms": 0.0025786362685166395, "ViewRequirementAgentConnector_ms": 0.06621069722361379}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352539.839877799, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21812498218039217, "mean_inference_ms": 0.37411667352272854, "mean_action_processing_ms": 0.09226049577385385, "mean_env_wait_ms": 0.6876834048945762, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034973218843534397, "StateBufferConnector_ms": 0.0025786362685166395, "ViewRequirementAgentConnector_ms": 0.06621069722361379}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4629840, "num_agent_steps_trained": 4629840, "num_env_steps_sampled": 4629840, "num_env_steps_trained": 4629840, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 713.5516351010723, "num_env_steps_trained_throughput_per_sec": 713.5516351010723, "timesteps_total": 4629840, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4629840, "timers": {"training_iteration_time_ms": 61719.008, "sample_time_ms": 60569.836, "load_time_ms": 16.9, "load_throughput": 2598891.275, "learn_time_ms": 1131.16, "learn_throughput": 38827.405, "synch_weights_time_ms": 0.946}, "counters": {"num_env_steps_sampled": 4629840, "num_env_steps_trained": 4629840, "num_agent_steps_sampled": 4629840, "num_agent_steps_trained": 4629840}, "done": false, "episodes_total": 1296, "training_iteration": 417, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-29-31", "timestamp": 1691065771, "time_this_iter_s": 61.559972047805786, "time_total_s": 9424.496932268143, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4756.952174425125, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 17.970454545454544, "ram_util_percent": 62.74545454545455}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1725.9690962810905, "policy_loss": -3.852247151290152e+20, "vf_loss": 303048842.22157437}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 53165.5, "diff_num_grad_updates_vs_sampler_policy": 53164.5}}, "num_env_steps_sampled": 4673760, "num_env_steps_trained": 4673760, "num_agent_steps_sampled": 4673760, "num_agent_steps_trained": 4673760}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352531.8302615238, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21810755925577857, "mean_inference_ms": 0.3740798501649163, "mean_action_processing_ms": 0.0922544579685661, "mean_env_wait_ms": 0.6875987023260564, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003493443513527895, "StateBufferConnector_ms": 0.0025791999621269032, "ViewRequirementAgentConnector_ms": 0.06622626231266902}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352531.8302615238, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21810755925577857, "mean_inference_ms": 0.3740798501649163, "mean_action_processing_ms": 0.0922544579685661, "mean_env_wait_ms": 0.6875987023260564, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003493443513527895, "StateBufferConnector_ms": 0.0025791999621269032, "ViewRequirementAgentConnector_ms": 0.06622626231266902}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4673760, "num_agent_steps_trained": 4673760, "num_env_steps_sampled": 4673760, "num_env_steps_trained": 4673760, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 696.3465025842665, "num_env_steps_trained_throughput_per_sec": 696.3465025842665, "timesteps_total": 4673760, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4673760, "timers": {"training_iteration_time_ms": 61835.76, "sample_time_ms": 60728.851, "load_time_ms": 16.469, "load_throughput": 2666762.67, "learn_time_ms": 1089.352, "learn_throughput": 40317.547, "synch_weights_time_ms": 0.924}, "counters": {"num_env_steps_sampled": 4673760, "num_env_steps_trained": 4673760, "num_agent_steps_sampled": 4673760, "num_agent_steps_trained": 4673760}, "done": false, "episodes_total": 1297, "training_iteration": 418, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-30-34", "timestamp": 1691065834, "time_this_iter_s": 63.07416820526123, "time_total_s": 9487.571100473404, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4820.026342630386, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 23.435955056179772, "ram_util_percent": 62.688764044943824}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1726.2940901597804, "policy_loss": -4.135484131796835e+20, "vf_loss": 304932089.49271137}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 53851.5, "diff_num_grad_updates_vs_sampler_policy": 53850.5}}, "num_env_steps_sampled": 4717680, "num_env_steps_trained": 4717680, "num_agent_steps_sampled": 4717680, "num_agent_steps_trained": 4717680}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352575.1291855685, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21807739653236743, "mean_inference_ms": 0.37402188104212847, "mean_action_processing_ms": 0.09224301767978309, "mean_env_wait_ms": 0.6874758852829481, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034745735458180872, "StateBufferConnector_ms": 0.0025643578058556667, "ViewRequirementAgentConnector_ms": 0.06594024127042747}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352575.1291855685, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21807739653236743, "mean_inference_ms": 0.37402188104212847, "mean_action_processing_ms": 0.09224301767978309, "mean_env_wait_ms": 0.6874758852829481, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034745735458180872, "StateBufferConnector_ms": 0.0025643578058556667, "ViewRequirementAgentConnector_ms": 0.06594024127042747}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4717680, "num_agent_steps_trained": 4717680, "num_env_steps_sampled": 4717680, "num_env_steps_trained": 4717680, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1131.4191503470122, "num_env_steps_trained_throughput_per_sec": 1131.4191503470122, "timesteps_total": 4717680, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4717680, "timers": {"training_iteration_time_ms": 59548.834, "sample_time_ms": 58485.219, "load_time_ms": 16.104, "load_throughput": 2727206.979, "learn_time_ms": 1046.439, "learn_throughput": 41970.905, "synch_weights_time_ms": 0.914}, "counters": {"num_env_steps_sampled": 4717680, "num_env_steps_trained": 4717680, "num_agent_steps_sampled": 4717680, "num_agent_steps_trained": 4717680}, "done": false, "episodes_total": 1298, "training_iteration": 419, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-31-13", "timestamp": 1691065873, "time_this_iter_s": 38.820720195770264, "time_total_s": 9526.391820669174, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4858.847062826157, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 42.31071428571429, "ram_util_percent": 62.533928571428575}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1726.7515415380717, "policy_loss": -4.610606418810765e+20, "vf_loss": 303395102.2915452}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 54537.5, "diff_num_grad_updates_vs_sampler_policy": 54536.5}}, "num_env_steps_sampled": 4761600, "num_env_steps_trained": 4761600, "num_agent_steps_sampled": 4761600, "num_agent_steps_trained": 4761600}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352576.1212286656, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2180350384134285, "mean_inference_ms": 0.3739440918408017, "mean_action_processing_ms": 0.09222650776490299, "mean_env_wait_ms": 0.6873195800969105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003458559513092041, "StateBufferConnector_ms": 0.0025540590286254883, "ViewRequirementAgentConnector_ms": 0.06567060947418213}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352576.1212286656, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2180350384134285, "mean_inference_ms": 0.3739440918408017, "mean_action_processing_ms": 0.09222650776490299, "mean_env_wait_ms": 0.6873195800969105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003458559513092041, "StateBufferConnector_ms": 0.0025540590286254883, "ViewRequirementAgentConnector_ms": 0.06567060947418213}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4761600, "num_agent_steps_trained": 4761600, "num_env_steps_sampled": 4761600, "num_env_steps_trained": 4761600, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1115.7447483984631, "num_env_steps_trained_throughput_per_sec": 1115.7447483984631, "timesteps_total": 4761600, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4761600, "timers": {"training_iteration_time_ms": 57337.128, "sample_time_ms": 56315.616, "load_time_ms": 15.803, "load_throughput": 2779218.553, "learn_time_ms": 1004.665, "learn_throughput": 43716.043, "synch_weights_time_ms": 0.892}, "counters": {"num_env_steps_sampled": 4761600, "num_env_steps_trained": 4761600, "num_agent_steps_sampled": 4761600, "num_agent_steps_trained": 4761600}, "done": false, "episodes_total": 1299, "training_iteration": 420, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-31-52", "timestamp": 1691065912, "time_this_iter_s": 39.365931034088135, "time_total_s": 9565.757751703262, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4898.212993860245, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 20.721818181818183, "ram_util_percent": 62.83636363636363}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1727.2786630346893, "policy_loss": -4.453873576605575e+20, "vf_loss": 304480286.7696793}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 55223.5, "diff_num_grad_updates_vs_sampler_policy": 55222.5}}, "num_env_steps_sampled": 4805520, "num_env_steps_trained": 4805520, "num_agent_steps_sampled": 4805520, "num_agent_steps_trained": 4805520}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352607.1686095165, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2179814889517618, "mean_inference_ms": 0.3738480013017132, "mean_action_processing_ms": 0.09220523485500216, "mean_env_wait_ms": 0.687131817166746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035026927053192517, "StateBufferConnector_ms": 0.002541659790792583, "ViewRequirementAgentConnector_ms": 0.06534081918221933}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352607.1686095165, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2179814889517618, "mean_inference_ms": 0.3738480013017132, "mean_action_processing_ms": 0.09220523485500216, "mean_env_wait_ms": 0.687131817166746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035026927053192517, "StateBufferConnector_ms": 0.002541659790792583, "ViewRequirementAgentConnector_ms": 0.06534081918221933}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4805520, "num_agent_steps_trained": 4805520, "num_env_steps_sampled": 4805520, "num_env_steps_trained": 4805520, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1112.596270054046, "num_env_steps_trained_throughput_per_sec": 1112.596270054046, "timesteps_total": 4805520, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4805520, "timers": {"training_iteration_time_ms": 55099.687, "sample_time_ms": 54119.297, "load_time_ms": 15.499, "load_throughput": 2833766.853, "learn_time_ms": 963.885, "learn_throughput": 45565.606, "synch_weights_time_ms": 0.859}, "counters": {"num_env_steps_sampled": 4805520, "num_env_steps_trained": 4805520, "num_agent_steps_sampled": 4805520, "num_agent_steps_trained": 4805520}, "done": false, "episodes_total": 1300, "training_iteration": 421, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-32-32", "timestamp": 1691065952, "time_this_iter_s": 39.47747206687927, "time_total_s": 9605.235223770142, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4937.690465927124, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 23.566666666666666, "ram_util_percent": 63.17368421052631}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-06, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1727.876927856801, "policy_loss": -4.308343544391532e+20, "vf_loss": 303987831.3061224}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 55909.5, "diff_num_grad_updates_vs_sampler_policy": 55908.5}}, "num_env_steps_sampled": 4849440, "num_env_steps_trained": 4849440, "num_agent_steps_sampled": 4849440, "num_agent_steps_trained": 4849440}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352620.7850314258, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2179171887681802, "mean_inference_ms": 0.3737345698643185, "mean_action_processing_ms": 0.09217951500568093, "mean_env_wait_ms": 0.6869137977825422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034878893596370047, "StateBufferConnector_ms": 0.0025353780606897866, "ViewRequirementAgentConnector_ms": 0.06508623681417326}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352620.7850314258, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2179171887681802, "mean_inference_ms": 0.3737345698643185, "mean_action_processing_ms": 0.09217951500568093, "mean_env_wait_ms": 0.6869137977825422, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034878893596370047, "StateBufferConnector_ms": 0.0025353780606897866, "ViewRequirementAgentConnector_ms": 0.06508623681417326}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4849440, "num_agent_steps_trained": 4849440, "num_env_steps_sampled": 4849440, "num_env_steps_trained": 4849440, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1122.664953339618, "num_env_steps_trained_throughput_per_sec": 1122.664953339618, "timesteps_total": 4849440, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4849440, "timers": {"training_iteration_time_ms": 52830.534, "sample_time_ms": 51893.452, "load_time_ms": 14.727, "load_throughput": 2982191.271, "learn_time_ms": 921.374, "learn_throughput": 47667.924, "synch_weights_time_ms": 0.84}, "counters": {"num_env_steps_sampled": 4849440, "num_env_steps_trained": 4849440, "num_agent_steps_sampled": 4849440, "num_agent_steps_trained": 4849440}, "done": false, "episodes_total": 1301, "training_iteration": 422, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-33-11", "timestamp": 1691065991, "time_this_iter_s": 39.12333369255066, "time_total_s": 9644.358557462692, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 4976.813799619675, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 24.73090909090909, "ram_util_percent": 62.42909090909091}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.500000000000001e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1728.304954595538, "policy_loss": -4.522338887801602e+20, "vf_loss": 302455512.9329446}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 56595.5, "diff_num_grad_updates_vs_sampler_policy": 56594.5}}, "num_env_steps_sampled": 4893360, "num_env_steps_trained": 4893360, "num_agent_steps_sampled": 4893360, "num_agent_steps_trained": 4893360}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352595.5666061519, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21784282674965708, "mean_inference_ms": 0.37360492287170266, "mean_action_processing_ms": 0.0921495946073833, "mean_env_wait_ms": 0.6866675516272285, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034722937158791416, "StateBufferConnector_ms": 0.0025240771741752164, "ViewRequirementAgentConnector_ms": 0.06482716066291533}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352595.5666061519, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21784282674965708, "mean_inference_ms": 0.37360492287170266, "mean_action_processing_ms": 0.0921495946073833, "mean_env_wait_ms": 0.6866675516272285, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034722937158791416, "StateBufferConnector_ms": 0.0025240771741752164, "ViewRequirementAgentConnector_ms": 0.06482716066291533}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4893360, "num_agent_steps_trained": 4893360, "num_env_steps_sampled": 4893360, "num_env_steps_trained": 4893360, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1121.9972438946402, "num_env_steps_trained_throughput_per_sec": 1121.9972438946402, "timesteps_total": 4893360, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4893360, "timers": {"training_iteration_time_ms": 50559.751, "sample_time_ms": 49664.843, "load_time_ms": 14.242, "load_throughput": 3083938.635, "learn_time_ms": 879.725, "learn_throughput": 49924.681, "synch_weights_time_ms": 0.806}, "counters": {"num_env_steps_sampled": 4893360, "num_env_steps_trained": 4893360, "num_agent_steps_sampled": 4893360, "num_agent_steps_trained": 4893360}, "done": false, "episodes_total": 1302, "training_iteration": 423, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-33-50", "timestamp": 1691066030, "time_this_iter_s": 39.14668607711792, "time_total_s": 9683.50524353981, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5015.960485696793, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 21.298214285714284, "ram_util_percent": 62.916071428571435}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1728.8723797589628, "policy_loss": -4.158827680313917e+20, "vf_loss": 304979525.67346936}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 57281.5, "diff_num_grad_updates_vs_sampler_policy": 57280.5}}, "num_env_steps_sampled": 4937280, "num_env_steps_trained": 4937280, "num_agent_steps_sampled": 4937280, "num_agent_steps_trained": 4937280}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352635.90734969, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2177590478975548, "mean_inference_ms": 0.37346022332404033, "mean_action_processing_ms": 0.09211576832241211, "mean_env_wait_ms": 0.6863954084206402, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034570693969726562, "StateBufferConnector_ms": 0.002513613019670759, "ViewRequirementAgentConnector_ms": 0.06457595598129999}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352635.90734969, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2177590478975548, "mean_inference_ms": 0.37346022332404033, "mean_action_processing_ms": 0.09211576832241211, "mean_env_wait_ms": 0.6863954084206402, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034570693969726562, "StateBufferConnector_ms": 0.002513613019670759, "ViewRequirementAgentConnector_ms": 0.06457595598129999}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4937280, "num_agent_steps_trained": 4937280, "num_env_steps_sampled": 4937280, "num_env_steps_trained": 4937280, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1115.3701050834068, "num_env_steps_trained_throughput_per_sec": 1115.3701050834068, "timesteps_total": 4937280, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4937280, "timers": {"training_iteration_time_ms": 48318.963, "sample_time_ms": 47464.653, "load_time_ms": 13.88, "load_throughput": 3164191.185, "learn_time_ms": 839.517, "learn_throughput": 52315.82, "synch_weights_time_ms": 0.781}, "counters": {"num_env_steps_sampled": 4937280, "num_env_steps_trained": 4937280, "num_agent_steps_sampled": 4937280, "num_agent_steps_trained": 4937280}, "done": false, "episodes_total": 1303, "training_iteration": 424, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-34-30", "timestamp": 1691066070, "time_this_iter_s": 39.379146099090576, "time_total_s": 9722.8843896389, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5055.339631795883, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 18.192857142857143, "ram_util_percent": 63.03035714285715}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.5e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1729.3684210151694, "policy_loss": -4.485438828263788e+20, "vf_loss": 302114032.26822156}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 57967.5, "diff_num_grad_updates_vs_sampler_policy": 57966.5}}, "num_env_steps_sampled": 4981200, "num_env_steps_trained": 4981200, "num_agent_steps_sampled": 4981200, "num_agent_steps_trained": 4981200}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352601.8781999045, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21766646080782776, "mean_inference_ms": 0.3733012874962411, "mean_action_processing_ms": 0.09207826335643715, "mean_env_wait_ms": 0.6860993455669875, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034410813275505513, "StateBufferConnector_ms": 0.0025014316334443934, "ViewRequirementAgentConnector_ms": 0.06432561313404757}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352601.8781999045, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21766646080782776, "mean_inference_ms": 0.3733012874962411, "mean_action_processing_ms": 0.09207826335643715, "mean_env_wait_ms": 0.6860993455669875, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034410813275505513, "StateBufferConnector_ms": 0.0025014316334443934, "ViewRequirementAgentConnector_ms": 0.06432561313404757}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4981200, "num_agent_steps_trained": 4981200, "num_env_steps_sampled": 4981200, "num_env_steps_trained": 4981200, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1113.9579779356611, "num_env_steps_trained_throughput_per_sec": 1113.9579779356611, "timesteps_total": 4981200, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 4981200, "timers": {"training_iteration_time_ms": 46119.599, "sample_time_ms": 45308.716, "load_time_ms": 13.434, "load_throughput": 3269286.484, "learn_time_ms": 796.576, "learn_throughput": 55136.012, "synch_weights_time_ms": 0.747}, "counters": {"num_env_steps_sampled": 4981200, "num_env_steps_trained": 4981200, "num_agent_steps_sampled": 4981200, "num_agent_steps_trained": 4981200}, "done": false, "episodes_total": 1304, "training_iteration": 425, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-35-09", "timestamp": 1691066109, "time_this_iter_s": 39.42928194999695, "time_total_s": 9762.313671588898, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5094.76891374588, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 18.04285714285714, "ram_util_percent": 62.862500000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.000000000000002e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1729.886515180849, "policy_loss": -4.476951347096261e+20, "vf_loss": 301860114.98542273}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 58653.5, "diff_num_grad_updates_vs_sampler_policy": 58652.5}}, "num_env_steps_sampled": 5025120, "num_env_steps_trained": 5025120, "num_agent_steps_sampled": 5025120, "num_agent_steps_trained": 5025120}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352563.2561144067, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21756559450000212, "mean_inference_ms": 0.3731289590807279, "mean_action_processing_ms": 0.0920373117232896, "mean_env_wait_ms": 0.6857808401925933, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034526337024777436, "StateBufferConnector_ms": 0.002490919689799464, "ViewRequirementAgentConnector_ms": 0.06414873655452284}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352563.2561144067, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21756559450000212, "mean_inference_ms": 0.3731289590807279, "mean_action_processing_ms": 0.0920373117232896, "mean_env_wait_ms": 0.6857808401925933, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034526337024777436, "StateBufferConnector_ms": 0.002490919689799464, "ViewRequirementAgentConnector_ms": 0.06414873655452284}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5025120, "num_agent_steps_trained": 5025120, "num_env_steps_sampled": 5025120, "num_env_steps_trained": 5025120, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1114.9673219565534, "num_env_steps_trained_throughput_per_sec": 1114.9673219565534, "timesteps_total": 5025120, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 5025120, "timers": {"training_iteration_time_ms": 43874.173, "sample_time_ms": 43105.054, "load_time_ms": 13.116, "load_throughput": 3348550.919, "learn_time_ms": 755.161, "learn_throughput": 58159.807, "synch_weights_time_ms": 0.721}, "counters": {"num_env_steps_sampled": 5025120, "num_env_steps_trained": 5025120, "num_agent_steps_sampled": 5025120, "num_agent_steps_trained": 5025120}, "done": false, "episodes_total": 1305, "training_iteration": 426, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-35-49", "timestamp": 1691066149, "time_this_iter_s": 39.39352893829346, "time_total_s": 9801.707200527191, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5134.162442684174, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 17.55, "ram_util_percent": 62.88392857142857}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.5e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1730.2212940805507, "policy_loss": -5.3034615813187056e+20, "vf_loss": 304360746.6530612}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 59339.5, "diff_num_grad_updates_vs_sampler_policy": 59338.5}}, "num_env_steps_sampled": 5069040, "num_env_steps_trained": 5069040, "num_agent_steps_sampled": 5069040, "num_agent_steps_trained": 5069040}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352589.7630180866, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21745700760817727, "mean_inference_ms": 0.37294412427198553, "mean_action_processing_ms": 0.09199314065053331, "mean_env_wait_ms": 0.6854419447300232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003439530558969783, "StateBufferConnector_ms": 0.002482019621750404, "ViewRequirementAgentConnector_ms": 0.06391919892409752}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352589.7630180866, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21745700760817727, "mean_inference_ms": 0.37294412427198553, "mean_action_processing_ms": 0.09199314065053331, "mean_env_wait_ms": 0.6854419447300232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003439530558969783, "StateBufferConnector_ms": 0.002482019621750404, "ViewRequirementAgentConnector_ms": 0.06391919892409752}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5069040, "num_agent_steps_trained": 5069040, "num_env_steps_sampled": 5069040, "num_env_steps_trained": 5069040, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1107.099019957387, "num_env_steps_trained_throughput_per_sec": 1107.099019957387, "timesteps_total": 5069040, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 5069040, "timers": {"training_iteration_time_ms": 41686.172, "sample_time_ms": 40959.726, "load_time_ms": 12.717, "load_throughput": 3453674.769, "learn_time_ms": 712.93, "learn_throughput": 61604.952, "synch_weights_time_ms": 0.685}, "counters": {"num_env_steps_sampled": 5069040, "num_env_steps_trained": 5069040, "num_agent_steps_sampled": 5069040, "num_agent_steps_trained": 5069040}, "done": false, "episodes_total": 1306, "training_iteration": 427, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-36-28", "timestamp": 1691066188, "time_this_iter_s": 39.67344093322754, "time_total_s": 9841.380641460419, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5173.835883617401, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 18.482142857142858, "ram_util_percent": 62.925000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1730.671547581086, "policy_loss": -4.608376080347985e+20, "vf_loss": 304388134.3090379}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 60025.5, "diff_num_grad_updates_vs_sampler_policy": 60024.5}}, "num_env_steps_sampled": 5112960, "num_env_steps_trained": 5112960, "num_agent_steps_sampled": 5112960, "num_agent_steps_trained": 5112960}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352615.2703618042, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21734109543674052, "mean_inference_ms": 0.37274788392965924, "mean_action_processing_ms": 0.09194594744679639, "mean_env_wait_ms": 0.6850830836161049, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003430518237027255, "StateBufferConnector_ms": 0.002474676478992809, "ViewRequirementAgentConnector_ms": 0.06374256177382036}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352615.2703618042, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21734109543674052, "mean_inference_ms": 0.37274788392965924, "mean_action_processing_ms": 0.09194594744679639, "mean_env_wait_ms": 0.6850830836161049, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003430518237027255, "StateBufferConnector_ms": 0.002474676478992809, "ViewRequirementAgentConnector_ms": 0.06374256177382036}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5112960, "num_agent_steps_trained": 5112960, "num_env_steps_sampled": 5112960, "num_env_steps_trained": 5112960, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1114.92424171401, "num_env_steps_trained_throughput_per_sec": 1114.92424171401, "timesteps_total": 5112960, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 5112960, "timers": {"training_iteration_time_ms": 39318.249, "sample_time_ms": 38590.456, "load_time_ms": 12.735, "load_throughput": 3448683.284, "learn_time_ms": 714.249, "learn_throughput": 61491.122, "synch_weights_time_ms": 0.694}, "counters": {"num_env_steps_sampled": 5112960, "num_env_steps_trained": 5112960, "num_agent_steps_sampled": 5112960, "num_agent_steps_trained": 5112960}, "done": false, "episodes_total": 1307, "training_iteration": 428, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-37-08", "timestamp": 1691066228, "time_this_iter_s": 39.39521813392639, "time_total_s": 9880.775859594345, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5213.2311017513275, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 17.978571428571428, "ram_util_percent": 62.78750000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.499999999999998e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1731.044962446474, "policy_loss": -4.737003828072904e+20, "vf_loss": 303211769.0553936}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 60711.5, "diff_num_grad_updates_vs_sampler_policy": 60710.5}}, "num_env_steps_sampled": 5156880, "num_env_steps_trained": 5156880, "num_agent_steps_sampled": 5156880, "num_agent_steps_trained": 5156880}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352613.2567078795, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21721836258762717, "mean_inference_ms": 0.37254075442268086, "mean_action_processing_ms": 0.09189593279145739, "mean_env_wait_ms": 0.6847057270915176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00341902957873398, "StateBufferConnector_ms": 0.0024674983506792047, "ViewRequirementAgentConnector_ms": 0.0635104232959533}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352613.2567078795, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21721836258762717, "mean_inference_ms": 0.37254075442268086, "mean_action_processing_ms": 0.09189593279145739, "mean_env_wait_ms": 0.6847057270915176, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00341902957873398, "StateBufferConnector_ms": 0.0024674983506792047, "ViewRequirementAgentConnector_ms": 0.0635104232959533}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5156880, "num_agent_steps_trained": 5156880, "num_env_steps_sampled": 5156880, "num_env_steps_trained": 5156880, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1115.1609272204673, "num_env_steps_trained_throughput_per_sec": 1115.1609272204673, "timesteps_total": 5156880, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 5156880, "timers": {"training_iteration_time_ms": 39374.844, "sample_time_ms": 38646.274, "load_time_ms": 12.717, "load_throughput": 3453590.596, "learn_time_ms": 715.048, "learn_throughput": 61422.474, "synch_weights_time_ms": 0.69}, "counters": {"num_env_steps_sampled": 5156880, "num_env_steps_trained": 5156880, "num_agent_steps_sampled": 5156880, "num_agent_steps_trained": 5156880}, "done": false, "episodes_total": 1308, "training_iteration": 429, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-37-47", "timestamp": 1691066267, "time_this_iter_s": 39.38674187660217, "time_total_s": 9920.162601470947, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5252.61784362793, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 17.71964285714286, "ram_util_percent": 62.957142857142856}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.000000000000001e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1731.391339805314, "policy_loss": -4.709716336006311e+20, "vf_loss": 302086539.5102041}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 61397.5, "diff_num_grad_updates_vs_sampler_policy": 61396.5}}, "num_env_steps_sampled": 5200800, "num_env_steps_trained": 5200800, "num_agent_steps_sampled": 5200800, "num_agent_steps_trained": 5200800}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352582.2667795944, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2170891924437605, "mean_inference_ms": 0.37232347890871775, "mean_action_processing_ms": 0.09184327306415958, "mean_env_wait_ms": 0.6843111915786019, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034040874905056423, "StateBufferConnector_ms": 0.002460479736328125, "ViewRequirementAgentConnector_ms": 0.0632831785413954}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352582.2667795944, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2170891924437605, "mean_inference_ms": 0.37232347890871775, "mean_action_processing_ms": 0.09184327306415958, "mean_env_wait_ms": 0.6843111915786019, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0034040874905056423, "StateBufferConnector_ms": 0.002460479736328125, "ViewRequirementAgentConnector_ms": 0.0632831785413954}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5200800, "num_agent_steps_trained": 5200800, "num_env_steps_sampled": 5200800, "num_env_steps_trained": 5200800, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1113.64506802999, "num_env_steps_trained_throughput_per_sec": 1113.64506802999, "timesteps_total": 5200800, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 5200800, "timers": {"training_iteration_time_ms": 39382.266, "sample_time_ms": 38652.003, "load_time_ms": 12.623, "load_throughput": 3479257.884, "learn_time_ms": 716.833, "learn_throughput": 61269.54, "synch_weights_time_ms": 0.691}, "counters": {"num_env_steps_sampled": 5200800, "num_env_steps_trained": 5200800, "num_agent_steps_sampled": 5200800, "num_agent_steps_trained": 5200800}, "done": false, "episodes_total": 1309, "training_iteration": 430, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-38-26", "timestamp": 1691066306, "time_this_iter_s": 39.44090795516968, "time_total_s": 9959.603509426117, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5292.058751583099, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 17.25357142857143, "ram_util_percent": 62.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.499999999999998e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1731.7197400863247, "policy_loss": -4.956204029123138e+20, "vf_loss": 303594055.74927115}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 62083.5, "diff_num_grad_updates_vs_sampler_policy": 62082.5}}, "num_env_steps_sampled": 5244720, "num_env_steps_trained": 5244720, "num_agent_steps_sampled": 5244720, "num_agent_steps_trained": 5244720}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352589.540075906, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21695407252366478, "mean_inference_ms": 0.37209654884932986, "mean_action_processing_ms": 0.09178813005505593, "mean_env_wait_ms": 0.6839005774502505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033907837920136505, "StateBufferConnector_ms": 0.0024512573912903505, "ViewRequirementAgentConnector_ms": 0.06307481409429194}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352589.540075906, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21695407252366478, "mean_inference_ms": 0.37209654884932986, "mean_action_processing_ms": 0.09178813005505593, "mean_env_wait_ms": 0.6839005774502505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033907837920136505, "StateBufferConnector_ms": 0.0024512573912903505, "ViewRequirementAgentConnector_ms": 0.06307481409429194}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5244720, "num_agent_steps_trained": 5244720, "num_env_steps_sampled": 5244720, "num_env_steps_trained": 5244720, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1115.172943707845, "num_env_steps_trained_throughput_per_sec": 1115.172943707845, "timesteps_total": 5244720, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 5244720, "timers": {"training_iteration_time_ms": 39373.145, "sample_time_ms": 38641.874, "load_time_ms": 12.633, "load_throughput": 3476703.526, "learn_time_ms": 717.82, "learn_throughput": 61185.251, "synch_weights_time_ms": 0.701}, "counters": {"num_env_steps_sampled": 5244720, "num_env_steps_trained": 5244720, "num_agent_steps_sampled": 5244720, "num_agent_steps_trained": 5244720}, "done": false, "episodes_total": 1310, "training_iteration": 431, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-39-06", "timestamp": 1691066346, "time_this_iter_s": 39.38626480102539, "time_total_s": 9998.989774227142, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5331.445016384125, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 17.94736842105263, "ram_util_percent": 62.93684210526316}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1731.9949828389783, "policy_loss": -5.019217138945398e+20, "vf_loss": 303083114.3148688}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 62769.5, "diff_num_grad_updates_vs_sampler_policy": 62768.5}}, "num_env_steps_sampled": 5288640, "num_env_steps_trained": 5288640, "num_agent_steps_sampled": 5288640, "num_agent_steps_trained": 5288640}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352581.8669218004, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21681335581853273, "mean_inference_ms": 0.3718605294977742, "mean_action_processing_ms": 0.09173065375004777, "mean_env_wait_ms": 0.6834754489663604, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033775101537289825, "StateBufferConnector_ms": 0.002443012983902641, "ViewRequirementAgentConnector_ms": 0.06287642147230066}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352581.8669218004, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21681335581853273, "mean_inference_ms": 0.3718605294977742, "mean_action_processing_ms": 0.09173065375004777, "mean_env_wait_ms": 0.6834754489663604, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033775101537289825, "StateBufferConnector_ms": 0.002443012983902641, "ViewRequirementAgentConnector_ms": 0.06287642147230066}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5288640, "num_agent_steps_trained": 5288640, "num_env_steps_sampled": 5288640, "num_env_steps_trained": 5288640, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1111.0953386825722, "num_env_steps_trained_throughput_per_sec": 1111.0953386825722, "timesteps_total": 5288640, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 5288640, "timers": {"training_iteration_time_ms": 39413.881, "sample_time_ms": 38683.694, "load_time_ms": 12.719, "load_throughput": 3453143.9, "learn_time_ms": 716.648, "learn_throughput": 61285.347, "synch_weights_time_ms": 0.704}, "counters": {"num_env_steps_sampled": 5288640, "num_env_steps_trained": 5288640, "num_agent_steps_sampled": 5288640, "num_agent_steps_trained": 5288640}, "done": false, "episodes_total": 1311, "training_iteration": 432, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-39-45", "timestamp": 1691066385, "time_this_iter_s": 39.53081703186035, "time_total_s": 10038.520591259003, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5370.975833415985, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 17.4875, "ram_util_percent": 62.73392857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1732.3584626756674, "policy_loss": -5.3489508682071625e+20, "vf_loss": 302962257.90670556}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 63455.5, "diff_num_grad_updates_vs_sampler_policy": 63454.5}}, "num_env_steps_sampled": 5332560, "num_env_steps_trained": 5332560, "num_agent_steps_sampled": 5332560, "num_agent_steps_trained": 5332560}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352571.709714584, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21666739340055302, "mean_inference_ms": 0.37161603320421877, "mean_action_processing_ms": 0.09167100316378074, "mean_env_wait_ms": 0.683036230159343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033675983387936826, "StateBufferConnector_ms": 0.0024367404240433887, "ViewRequirementAgentConnector_ms": 0.06267280988795783}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352571.709714584, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21666739340055302, "mean_inference_ms": 0.37161603320421877, "mean_action_processing_ms": 0.09167100316378074, "mean_env_wait_ms": 0.683036230159343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033675983387936826, "StateBufferConnector_ms": 0.0024367404240433887, "ViewRequirementAgentConnector_ms": 0.06267280988795783}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5332560, "num_agent_steps_trained": 5332560, "num_env_steps_sampled": 5332560, "num_env_steps_trained": 5332560, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1116.6554604177, "num_env_steps_trained_throughput_per_sec": 1116.6554604177, "timesteps_total": 5332560, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 5332560, "timers": {"training_iteration_time_ms": 39432.607, "sample_time_ms": 38702.193, "load_time_ms": 12.718, "load_throughput": 3453474.056, "learn_time_ms": 716.882, "learn_throughput": 61265.277, "synch_weights_time_ms": 0.697}, "counters": {"num_env_steps_sampled": 5332560, "num_env_steps_trained": 5332560, "num_agent_steps_sampled": 5332560, "num_agent_steps_trained": 5332560}, "done": false, "episodes_total": 1312, "training_iteration": 433, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-40-25", "timestamp": 1691066425, "time_this_iter_s": 39.3337881565094, "time_total_s": 10077.854379415512, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5410.3096215724945, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 21.12545454545454, "ram_util_percent": 62.81272727272726}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1732.6466754879966, "policy_loss": -4.9734586226448905e+20, "vf_loss": 302346686.0116618}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 64141.5, "diff_num_grad_updates_vs_sampler_policy": 64140.5}}, "num_env_steps_sampled": 5376480, "num_env_steps_trained": 5376480, "num_agent_steps_sampled": 5376480, "num_agent_steps_trained": 5376480}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352547.1155304804, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21651657734460733, "mean_inference_ms": 0.3713634432473232, "mean_action_processing_ms": 0.09160928609164418, "mean_env_wait_ms": 0.682581776530913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003352571041026014, "StateBufferConnector_ms": 0.0024295867757594333, "ViewRequirementAgentConnector_ms": 0.06245932680495242}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352547.1155304804, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21651657734460733, "mean_inference_ms": 0.3713634432473232, "mean_action_processing_ms": 0.09160928609164418, "mean_env_wait_ms": 0.682581776530913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003352571041026014, "StateBufferConnector_ms": 0.0024295867757594333, "ViewRequirementAgentConnector_ms": 0.06245932680495242}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5376480, "num_agent_steps_trained": 5376480, "num_env_steps_sampled": 5376480, "num_env_steps_trained": 5376480, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1141.9012462984442, "num_env_steps_trained_throughput_per_sec": 1141.9012462984442, "timesteps_total": 5376480, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 5376480, "timers": {"training_iteration_time_ms": 39341.118, "sample_time_ms": 38611.187, "load_time_ms": 12.655, "load_throughput": 3470611.884, "learn_time_ms": 716.458, "learn_throughput": 61301.536, "synch_weights_time_ms": 0.701}, "counters": {"num_env_steps_sampled": 5376480, "num_env_steps_trained": 5376480, "num_agent_steps_sampled": 5376480, "num_agent_steps_trained": 5376480}, "done": false, "episodes_total": 1313, "training_iteration": 434, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-41-03", "timestamp": 1691066463, "time_this_iter_s": 38.46459603309631, "time_total_s": 10116.318975448608, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5448.774217605591, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 30.53636363636363, "ram_util_percent": 62.740000000000016}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1732.8630871119374, "policy_loss": -4.875598183687531e+20, "vf_loss": 303799881.5218659}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 64827.5, "diff_num_grad_updates_vs_sampler_policy": 64826.5}}, "num_env_steps_sampled": 5420400, "num_env_steps_trained": 5420400, "num_agent_steps_sampled": 5420400, "num_agent_steps_trained": 5420400}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352557.391753981, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21636200193153463, "mean_inference_ms": 0.3711049295069215, "mean_action_processing_ms": 0.09154596051405388, "mean_env_wait_ms": 0.6821155487692858, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003337358173571135, "StateBufferConnector_ms": 0.0024175643920898438, "ViewRequirementAgentConnector_ms": 0.062255859375}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352557.391753981, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21636200193153463, "mean_inference_ms": 0.3711049295069215, "mean_action_processing_ms": 0.09154596051405388, "mean_env_wait_ms": 0.6821155487692858, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003337358173571135, "StateBufferConnector_ms": 0.0024175643920898438, "ViewRequirementAgentConnector_ms": 0.062255859375}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5420400, "num_agent_steps_trained": 5420400, "num_env_steps_sampled": 5420400, "num_env_steps_trained": 5420400, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1081.7393718381281, "num_env_steps_trained_throughput_per_sec": 1081.7393718381281, "timesteps_total": 5420400, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 5420400, "timers": {"training_iteration_time_ms": 39458.547, "sample_time_ms": 38723.79, "load_time_ms": 12.735, "load_throughput": 3448864.07, "learn_time_ms": 721.202, "learn_throughput": 60898.358, "synch_weights_time_ms": 0.702}, "counters": {"num_env_steps_sampled": 5420400, "num_env_steps_trained": 5420400, "num_agent_steps_sampled": 5420400, "num_agent_steps_trained": 5420400}, "done": false, "episodes_total": 1314, "training_iteration": 435, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-41-44", "timestamp": 1691066504, "time_this_iter_s": 40.60406303405762, "time_total_s": 10156.923038482666, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5489.378280639648, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 38.840350877192975, "ram_util_percent": 63.22105263157894}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1733.1837508754897, "policy_loss": -4.998367848824689e+20, "vf_loss": 303556458.9912537}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 65513.5, "diff_num_grad_updates_vs_sampler_policy": 65512.5}}, "num_env_steps_sampled": 5464320, "num_env_steps_trained": 5464320, "num_agent_steps_sampled": 5464320, "num_agent_steps_trained": 5464320}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352562.9309170833, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2162036762870649, "mean_inference_ms": 0.3708404536016709, "mean_action_processing_ms": 0.09148104138891029, "mean_env_wait_ms": 0.6816384768990359, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033229589462280273, "StateBufferConnector_ms": 0.002405792474746704, "ViewRequirementAgentConnector_ms": 0.06207972764968872}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352562.9309170833, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2162036762870649, "mean_inference_ms": 0.3708404536016709, "mean_action_processing_ms": 0.09148104138891029, "mean_env_wait_ms": 0.6816384768990359, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033229589462280273, "StateBufferConnector_ms": 0.002405792474746704, "ViewRequirementAgentConnector_ms": 0.06207972764968872}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5464320, "num_agent_steps_trained": 5464320, "num_env_steps_sampled": 5464320, "num_env_steps_trained": 5464320, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1090.7469479985648, "num_env_steps_trained_throughput_per_sec": 1090.7469479985648, "timesteps_total": 5464320, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 5464320, "timers": {"training_iteration_time_ms": 39546.017, "sample_time_ms": 38811.102, "load_time_ms": 12.719, "load_throughput": 3453169.792, "learn_time_ms": 721.377, "learn_throughput": 60883.519, "synch_weights_time_ms": 0.7}, "counters": {"num_env_steps_sampled": 5464320, "num_env_steps_trained": 5464320, "num_agent_steps_sampled": 5464320, "num_agent_steps_trained": 5464320}, "done": false, "episodes_total": 1315, "training_iteration": 436, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-42-24", "timestamp": 1691066544, "time_this_iter_s": 40.26830792427063, "time_total_s": 10197.191346406937, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5529.646588563919, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 23.835087719298244, "ram_util_percent": 63.28771929824563}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1733.5468241077124, "policy_loss": -5.017301814405587e+20, "vf_loss": 302470343.148688}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 66199.5, "diff_num_grad_updates_vs_sampler_policy": 66198.5}}, "num_env_steps_sampled": 5508240, "num_env_steps_trained": 5508240, "num_agent_steps_sampled": 5508240, "num_agent_steps_trained": 5508240}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352542.9403524604, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21604139063159566, "mean_inference_ms": 0.3705695547480996, "mean_action_processing_ms": 0.09141444731228657, "mean_env_wait_ms": 0.6811507998059392, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033135266648125403, "StateBufferConnector_ms": 0.002399670709039747, "ViewRequirementAgentConnector_ms": 0.061909439637488926}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352542.9403524604, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21604139063159566, "mean_inference_ms": 0.3705695547480996, "mean_action_processing_ms": 0.09141444731228657, "mean_env_wait_ms": 0.6811507998059392, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0033135266648125403, "StateBufferConnector_ms": 0.002399670709039747, "ViewRequirementAgentConnector_ms": 0.061909439637488926}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5508240, "num_agent_steps_trained": 5508240, "num_env_steps_sampled": 5508240, "num_env_steps_trained": 5508240, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1114.5926609475293, "num_env_steps_trained_throughput_per_sec": 1114.5926609475293, "timesteps_total": 5508240, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 5508240, "timers": {"training_iteration_time_ms": 39519.345, "sample_time_ms": 38789.927, "load_time_ms": 12.719, "load_throughput": 3453027.389, "learn_time_ms": 715.884, "learn_throughput": 61350.747, "synch_weights_time_ms": 0.7}, "counters": {"num_env_steps_sampled": 5508240, "num_env_steps_trained": 5508240, "num_agent_steps_sampled": 5508240, "num_agent_steps_trained": 5508240}, "done": false, "episodes_total": 1316, "training_iteration": 437, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-43-04", "timestamp": 1691066584, "time_this_iter_s": 39.406699895858765, "time_total_s": 10236.598046302795, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5569.053288459778, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 17.48392857142857, "ram_util_percent": 62.84107142857143}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1733.9797181777287, "policy_loss": -5.202489709616641e+20, "vf_loss": 302494890.62390673}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 66885.5, "diff_num_grad_updates_vs_sampler_policy": 66884.5}}, "num_env_steps_sampled": 5552160, "num_env_steps_trained": 5552160, "num_agent_steps_sampled": 5552160, "num_agent_steps_trained": 5552160}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352522.3404224936, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21587543297074763, "mean_inference_ms": 0.37029265187698884, "mean_action_processing_ms": 0.09134629370369256, "mean_env_wait_ms": 0.680653233754427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003303800310407366, "StateBufferConnector_ms": 0.002391241034682916, "ViewRequirementAgentConnector_ms": 0.06174360002790179}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352522.3404224936, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21587543297074763, "mean_inference_ms": 0.37029265187698884, "mean_action_processing_ms": 0.09134629370369256, "mean_env_wait_ms": 0.680653233754427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003303800310407366, "StateBufferConnector_ms": 0.002391241034682916, "ViewRequirementAgentConnector_ms": 0.06174360002790179}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5552160, "num_agent_steps_trained": 5552160, "num_env_steps_sampled": 5552160, "num_env_steps_trained": 5552160, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1114.4798741499433, "num_env_steps_trained_throughput_per_sec": 1114.4798741499433, "timesteps_total": 5552160, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 5552160, "timers": {"training_iteration_time_ms": 39520.915, "sample_time_ms": 38792.003, "load_time_ms": 12.736, "load_throughput": 3448360.498, "learn_time_ms": 715.363, "learn_throughput": 61395.438, "synch_weights_time_ms": 0.698}, "counters": {"num_env_steps_sampled": 5552160, "num_env_steps_trained": 5552160, "num_agent_steps_sampled": 5552160, "num_agent_steps_trained": 5552160}, "done": false, "episodes_total": 1317, "training_iteration": 438, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-43-43", "timestamp": 1691066623, "time_this_iter_s": 39.41089487075806, "time_total_s": 10276.008941173553, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5608.464183330536, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 17.532142857142855, "ram_util_percent": 62.926785714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1734.1470505961872, "policy_loss": -5.201342657873442e+20, "vf_loss": 303697551.9825073}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 67571.5, "diff_num_grad_updates_vs_sampler_policy": 67570.5}}, "num_env_steps_sampled": 5596080, "num_env_steps_trained": 5596080, "num_agent_steps_sampled": 5596080, "num_agent_steps_trained": 5596080}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352530.1205516034, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21570611816931604, "mean_inference_ms": 0.3700100789918476, "mean_action_processing_ms": 0.09127668426345702, "mean_env_wait_ms": 0.6801446105263405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032940296211628, "StateBufferConnector_ms": 0.002381295868844697, "ViewRequirementAgentConnector_ms": 0.06156088125826133}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352530.1205516034, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21570611816931604, "mean_inference_ms": 0.3700100789918476, "mean_action_processing_ms": 0.09127668426345702, "mean_env_wait_ms": 0.6801446105263405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032940296211628, "StateBufferConnector_ms": 0.002381295868844697, "ViewRequirementAgentConnector_ms": 0.06156088125826133}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5596080, "num_agent_steps_trained": 5596080, "num_env_steps_sampled": 5596080, "num_env_steps_trained": 5596080, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1138.2014749316231, "num_env_steps_trained_throughput_per_sec": 1138.2014749316231, "timesteps_total": 5596080, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 5596080, "timers": {"training_iteration_time_ms": 39441.19, "sample_time_ms": 38712.469, "load_time_ms": 12.762, "load_throughput": 3441499.493, "learn_time_ms": 715.154, "learn_throughput": 61413.337, "synch_weights_time_ms": 0.69}, "counters": {"num_env_steps_sampled": 5596080, "num_env_steps_trained": 5596080, "num_agent_steps_sampled": 5596080, "num_agent_steps_trained": 5596080}, "done": false, "episodes_total": 1318, "training_iteration": 439, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-44-22", "timestamp": 1691066662, "time_this_iter_s": 38.58935809135437, "time_total_s": 10314.598299264908, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5647.05354142189, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 32.67090909090909, "ram_util_percent": 63.100000000000016}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1734.5290701729912, "policy_loss": -5.090454192741267e+20, "vf_loss": 302283211.76676387}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 68257.5, "diff_num_grad_updates_vs_sampler_policy": 68256.5}}, "num_env_steps_sampled": 5640000, "num_env_steps_trained": 5640000, "num_agent_steps_sampled": 5640000, "num_agent_steps_trained": 5640000}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352505.699194427, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2155334964698958, "mean_inference_ms": 0.3697221011904845, "mean_action_processing_ms": 0.09120567865004077, "mean_env_wait_ms": 0.679625584702669, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032806396484375, "StateBufferConnector_ms": 0.0023751258850097656, "ViewRequirementAgentConnector_ms": 0.06137824058532715}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1360631.741058933, "episode_reward_mean": -1352505.699194427, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1360631.741058933, -1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2155334964698958, "mean_inference_ms": 0.3697221011904845, "mean_action_processing_ms": 0.09120567865004077, "mean_env_wait_ms": 0.679625584702669, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032806396484375, "StateBufferConnector_ms": 0.0023751258850097656, "ViewRequirementAgentConnector_ms": 0.06137824058532715}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5640000, "num_agent_steps_trained": 5640000, "num_env_steps_sampled": 5640000, "num_env_steps_trained": 5640000, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1144.0328209177737, "num_env_steps_trained_throughput_per_sec": 1144.0328209177737, "timesteps_total": 5640000, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 5640000, "timers": {"training_iteration_time_ms": 39336.435, "sample_time_ms": 38609.056, "load_time_ms": 12.807, "load_throughput": 3429301.229, "learn_time_ms": 713.764, "learn_throughput": 61532.909, "synch_weights_time_ms": 0.693}, "counters": {"num_env_steps_sampled": 5640000, "num_env_steps_trained": 5640000, "num_agent_steps_sampled": 5640000, "num_agent_steps_trained": 5640000}, "done": false, "episodes_total": 1319, "training_iteration": 440, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-45-00", "timestamp": 1691066700, "time_this_iter_s": 38.39263105392456, "time_total_s": 10352.990930318832, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5685.446172475815, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 34.20740740740741, "ram_util_percent": 63.37222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1734.8023197630057, "policy_loss": -5.41855076922695e+20, "vf_loss": 303385834.6705539}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 68943.5, "diff_num_grad_updates_vs_sampler_policy": 68942.5}}, "num_env_steps_sampled": 5683920, "num_env_steps_trained": 5683920, "num_agent_steps_sampled": 5683920, "num_agent_steps_trained": 5683920}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1359507.1590278465, "episode_reward_mean": -1352426.1985162308, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21536588134159948, "mean_inference_ms": 0.3694258477909697, "mean_action_processing_ms": 0.0911386674066943, "mean_env_wait_ms": 0.6781785002702472, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032701492309570312, "StateBufferConnector_ms": 0.0023658275604248047, "ViewRequirementAgentConnector_ms": 0.06116604804992676}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1359507.1590278465, "episode_reward_mean": -1352426.1985162308, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1359507.1590278465, -1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21536588134159948, "mean_inference_ms": 0.3694258477909697, "mean_action_processing_ms": 0.0911386674066943, "mean_env_wait_ms": 0.6781785002702472, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032701492309570312, "StateBufferConnector_ms": 0.0023658275604248047, "ViewRequirementAgentConnector_ms": 0.06116604804992676}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5683920, "num_agent_steps_trained": 5683920, "num_env_steps_sampled": 5683920, "num_env_steps_trained": 5683920, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1140.8618318718754, "num_env_steps_trained_throughput_per_sec": 1140.8618318718754, "timesteps_total": 5683920, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 5683920, "timers": {"training_iteration_time_ms": 39247.753, "sample_time_ms": 38519.97, "load_time_ms": 12.807, "load_throughput": 3429243.774, "learn_time_ms": 714.181, "learn_throughput": 61497.049, "synch_weights_time_ms": 0.683}, "counters": {"num_env_steps_sampled": 5683920, "num_env_steps_trained": 5683920, "num_agent_steps_sampled": 5683920, "num_agent_steps_trained": 5683920}, "done": false, "episodes_total": 1320, "training_iteration": 441, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-45-39", "timestamp": 1691066739, "time_this_iter_s": 38.499409914016724, "time_total_s": 10391.49034023285, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5723.9455823898315, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 40.28727272727272, "ram_util_percent": 62.91818181818182}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1734.9919244971984, "policy_loss": -5.488569596866866e+20, "vf_loss": 305192455.8250729}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 69629.5, "diff_num_grad_updates_vs_sampler_policy": 69628.5}}, "num_env_steps_sampled": 5727840, "num_env_steps_trained": 5727840, "num_agent_steps_sampled": 5727840, "num_agent_steps_trained": 5727840}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352396.515761857, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21518377690244855, "mean_inference_ms": 0.369115106087352, "mean_action_processing_ms": 0.09106499140709352, "mean_env_wait_ms": 0.6770607376618344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003262042999267578, "StateBufferConnector_ms": 0.0023581981658935547, "ViewRequirementAgentConnector_ms": 0.06095290184020996}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352396.515761857, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1353493.764670114, -1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21518377690244855, "mean_inference_ms": 0.369115106087352, "mean_action_processing_ms": 0.09106499140709352, "mean_env_wait_ms": 0.6770607376618344, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003262042999267578, "StateBufferConnector_ms": 0.0023581981658935547, "ViewRequirementAgentConnector_ms": 0.06095290184020996}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5727840, "num_agent_steps_trained": 5727840, "num_env_steps_sampled": 5727840, "num_env_steps_trained": 5727840, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1140.439929373314, "num_env_steps_trained_throughput_per_sec": 1140.439929373314, "timesteps_total": 5727840, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 5727840, "timers": {"training_iteration_time_ms": 39146.043, "sample_time_ms": 38412.376, "load_time_ms": 12.778, "load_throughput": 3437126.608, "learn_time_ms": 720.088, "learn_throughput": 60992.575, "synch_weights_time_ms": 0.685}, "counters": {"num_env_steps_sampled": 5727840, "num_env_steps_trained": 5727840, "num_agent_steps_sampled": 5727840, "num_agent_steps_trained": 5727840}, "done": false, "episodes_total": 1321, "training_iteration": 442, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-46-17", "timestamp": 1691066777, "time_this_iter_s": 38.51362371444702, "time_total_s": 10430.003963947296, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5762.459206104279, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 38.757407407407406, "ram_util_percent": 62.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1735.3125868371903, "policy_loss": -5.516781801067846e+20, "vf_loss": 303183504.16909623}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 70315.5, "diff_num_grad_updates_vs_sampler_policy": 70314.5}}, "num_env_steps_sampled": 5771760, "num_env_steps_trained": 5771760, "num_agent_steps_sampled": 5771760, "num_agent_steps_trained": 5771760}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352383.4966115889, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21495994074191266, "mean_inference_ms": 0.3686954028680363, "mean_action_processing_ms": 0.09096788664058324, "mean_env_wait_ms": 0.6760114320919509, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032525062561035156, "StateBufferConnector_ms": 0.002347230911254883, "ViewRequirementAgentConnector_ms": 0.060745954513549805}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352383.4966115889, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1350513.5260616252, -1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21495994074191266, "mean_inference_ms": 0.3686954028680363, "mean_action_processing_ms": 0.09096788664058324, "mean_env_wait_ms": 0.6760114320919509, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032525062561035156, "StateBufferConnector_ms": 0.002347230911254883, "ViewRequirementAgentConnector_ms": 0.060745954513549805}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5771760, "num_agent_steps_trained": 5771760, "num_env_steps_sampled": 5771760, "num_env_steps_trained": 5771760, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1134.4373655955083, "num_env_steps_trained_throughput_per_sec": 1134.4373655955083, "timesteps_total": 5771760, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 5771760, "timers": {"training_iteration_time_ms": 39084.392, "sample_time_ms": 38350.019, "load_time_ms": 12.735, "load_throughput": 3448651.003, "learn_time_ms": 720.825, "learn_throughput": 60930.143, "synch_weights_time_ms": 0.696}, "counters": {"num_env_steps_sampled": 5771760, "num_env_steps_trained": 5771760, "num_agent_steps_sampled": 5771760, "num_agent_steps_trained": 5771760}, "done": false, "episodes_total": 1322, "training_iteration": 443, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-46-56", "timestamp": 1691066816, "time_this_iter_s": 38.717747926712036, "time_total_s": 10468.721711874008, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5801.176954030991, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 43.30909090909091, "ram_util_percent": 63.74}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1735.6585714712783, "policy_loss": -5.641976972032747e+20, "vf_loss": 303240872.851312}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 71001.5, "diff_num_grad_updates_vs_sampler_policy": 71000.5}}, "num_env_steps_sampled": 5815680, "num_env_steps_trained": 5815680, "num_agent_steps_sampled": 5815680, "num_agent_steps_trained": 5815680}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352401.1715608907, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21472849834466576, "mean_inference_ms": 0.36827169649898006, "mean_action_processing_ms": 0.09086881552790516, "mean_env_wait_ms": 0.6750696469585687, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032427310943603516, "StateBufferConnector_ms": 0.0023369789123535156, "ViewRequirementAgentConnector_ms": 0.06053328514099121}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352401.1715608907, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1351246.0155012438, -1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21472849834466576, "mean_inference_ms": 0.36827169649898006, "mean_action_processing_ms": 0.09086881552790516, "mean_env_wait_ms": 0.6750696469585687, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032427310943603516, "StateBufferConnector_ms": 0.0023369789123535156, "ViewRequirementAgentConnector_ms": 0.06053328514099121}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5815680, "num_agent_steps_trained": 5815680, "num_env_steps_sampled": 5815680, "num_env_steps_trained": 5815680, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1128.3916199605599, "num_env_steps_trained_throughput_per_sec": 1128.3916199605599, "timesteps_total": 5815680, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 5815680, "timers": {"training_iteration_time_ms": 39130.44, "sample_time_ms": 38396.469, "load_time_ms": 12.824, "load_throughput": 3424876.488, "learn_time_ms": 720.339, "learn_throughput": 60971.278, "synch_weights_time_ms": 0.692}, "counters": {"num_env_steps_sampled": 5815680, "num_env_steps_trained": 5815680, "num_agent_steps_sampled": 5815680, "num_agent_steps_trained": 5815680}, "done": false, "episodes_total": 1323, "training_iteration": 444, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-47-35", "timestamp": 1691066855, "time_this_iter_s": 38.924919843673706, "time_total_s": 10507.646631717682, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5840.101873874664, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 29.827272727272724, "ram_util_percent": 61.30000000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1736.109021779052, "policy_loss": -5.4113952455023487e+20, "vf_loss": 302306735.45189506}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 71687.5, "diff_num_grad_updates_vs_sampler_policy": 71686.5}}, "num_env_steps_sampled": 5859600, "num_env_steps_trained": 5859600, "num_agent_steps_sampled": 5859600, "num_agent_steps_trained": 5859600}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352390.0101729091, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21448972216148804, "mean_inference_ms": 0.3678575979096573, "mean_action_processing_ms": 0.09077049872873416, "mean_env_wait_ms": 0.6741821788469501, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032265186309814453, "StateBufferConnector_ms": 0.0023262500762939453, "ViewRequirementAgentConnector_ms": 0.06029939651489258}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352390.0101729091, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1356616.295178895, -1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21448972216148804, "mean_inference_ms": 0.3678575979096573, "mean_action_processing_ms": 0.09077049872873416, "mean_env_wait_ms": 0.6741821788469501, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032265186309814453, "StateBufferConnector_ms": 0.0023262500762939453, "ViewRequirementAgentConnector_ms": 0.06029939651489258}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5859600, "num_agent_steps_trained": 5859600, "num_env_steps_sampled": 5859600, "num_env_steps_trained": 5859600, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1121.4459873754874, "num_env_steps_trained_throughput_per_sec": 1121.4459873754874, "timesteps_total": 5859600, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 5859600, "timers": {"training_iteration_time_ms": 38986.685, "sample_time_ms": 38257.932, "load_time_ms": 12.824, "load_throughput": 3424908.326, "learn_time_ms": 715.117, "learn_throughput": 61416.55, "synch_weights_time_ms": 0.698}, "counters": {"num_env_steps_sampled": 5859600, "num_env_steps_trained": 5859600, "num_agent_steps_sampled": 5859600, "num_agent_steps_trained": 5859600}, "done": false, "episodes_total": 1324, "training_iteration": 445, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-48-14", "timestamp": 1691066894, "time_this_iter_s": 39.16587996482849, "time_total_s": 10546.81251168251, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5879.267753839493, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 17.967857142857145, "ram_util_percent": 60.53035714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1736.4030119337076, "policy_loss": -5.49598052140728e+20, "vf_loss": 304320807.2069971}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 72373.5, "diff_num_grad_updates_vs_sampler_policy": 72372.5}}, "num_env_steps_sampled": 5903520, "num_env_steps_trained": 5903520, "num_agent_steps_sampled": 5903520, "num_agent_steps_trained": 5903520}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352370.0863267693, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21421649035879045, "mean_inference_ms": 0.3674135533404285, "mean_action_processing_ms": 0.09066508191666198, "mean_env_wait_ms": 0.6733035880213275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032181739807128906, "StateBufferConnector_ms": 0.002312898635864258, "ViewRequirementAgentConnector_ms": 0.06008625030517578}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352370.0863267693, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1352583.1532846363, -1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21421649035879045, "mean_inference_ms": 0.3674135533404285, "mean_action_processing_ms": 0.09066508191666198, "mean_env_wait_ms": 0.6733035880213275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032181739807128906, "StateBufferConnector_ms": 0.002312898635864258, "ViewRequirementAgentConnector_ms": 0.06008625030517578}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5903520, "num_agent_steps_trained": 5903520, "num_env_steps_sampled": 5903520, "num_env_steps_trained": 5903520, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1117.3514562299788, "num_env_steps_trained_throughput_per_sec": 1117.3514562299788, "timesteps_total": 5903520, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 5903520, "timers": {"training_iteration_time_ms": 38890.809, "sample_time_ms": 38162.466, "load_time_ms": 12.751, "load_throughput": 3444305.015, "learn_time_ms": 714.776, "learn_throughput": 61445.835, "synch_weights_time_ms": 0.702}, "counters": {"num_env_steps_sampled": 5903520, "num_env_steps_trained": 5903520, "num_agent_steps_sampled": 5903520, "num_agent_steps_trained": 5903520}, "done": false, "episodes_total": 1325, "training_iteration": 446, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-48-53", "timestamp": 1691066933, "time_this_iter_s": 39.30939507484436, "time_total_s": 10586.121906757355, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5918.577148914337, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 17.734545454545458, "ram_util_percent": 60.78545454545455}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1736.6449625888301, "policy_loss": -6.203370955397996e+20, "vf_loss": 303750299.8425656}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 73059.5, "diff_num_grad_updates_vs_sampler_policy": 73058.5}}, "num_env_steps_sampled": 5947440, "num_env_steps_trained": 5947440, "num_agent_steps_sampled": 5947440, "num_agent_steps_trained": 5947440}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352378.102670277, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2139187757771152, "mean_inference_ms": 0.36692627488662366, "mean_action_processing_ms": 0.0905496276111612, "mean_env_wait_ms": 0.6724054366080887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032088756561279297, "StateBufferConnector_ms": 0.0023033618927001953, "ViewRequirementAgentConnector_ms": 0.05984187126159668}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352378.102670277, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1349043.6249094796, -1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2139187757771152, "mean_inference_ms": 0.36692627488662366, "mean_action_processing_ms": 0.0905496276111612, "mean_env_wait_ms": 0.6724054366080887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0032088756561279297, "StateBufferConnector_ms": 0.0023033618927001953, "ViewRequirementAgentConnector_ms": 0.05984187126159668}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5947440, "num_agent_steps_trained": 5947440, "num_env_steps_sampled": 5947440, "num_env_steps_trained": 5947440, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1111.2984083576976, "num_env_steps_trained_throughput_per_sec": 1111.2984083576976, "timesteps_total": 5947440, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 5947440, "timers": {"training_iteration_time_ms": 38902.49, "sample_time_ms": 38173.726, "load_time_ms": 12.717, "load_throughput": 3453681.244, "learn_time_ms": 715.236, "learn_throughput": 61406.342, "synch_weights_time_ms": 0.697}, "counters": {"num_env_steps_sampled": 5947440, "num_env_steps_trained": 5947440, "num_agent_steps_sampled": 5947440, "num_agent_steps_trained": 5947440}, "done": false, "episodes_total": 1326, "training_iteration": 447, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-49-33", "timestamp": 1691066973, "time_this_iter_s": 39.52352690696716, "time_total_s": 10625.645433664322, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5958.100675821304, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 18.683928571428574, "ram_util_percent": 60.783928571428575}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1736.9413642549655, "policy_loss": -5.88520561414891e+20, "vf_loss": 302235554.07580173}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 73745.5, "diff_num_grad_updates_vs_sampler_policy": 73744.5}}, "num_env_steps_sampled": 5991360, "num_env_steps_trained": 5991360, "num_agent_steps_sampled": 5991360, "num_agent_steps_trained": 5991360}, "sampler_results": {"episode_reward_max": -1346364.554155869, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352388.874379043, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2136130024286592, "mean_inference_ms": 0.3664003207463831, "mean_action_processing_ms": 0.09042651143366967, "mean_env_wait_ms": 0.6715044566645493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003201723098754883, "StateBufferConnector_ms": 0.002295970916748047, "ViewRequirementAgentConnector_ms": 0.059627532958984375}}, "episode_reward_max": -1346364.554155869, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352388.874379043, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1346364.554155869, -1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2136130024286592, "mean_inference_ms": 0.3664003207463831, "mean_action_processing_ms": 0.09042651143366967, "mean_env_wait_ms": 0.6715044566645493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003201723098754883, "StateBufferConnector_ms": 0.002295970916748047, "ViewRequirementAgentConnector_ms": 0.059627532958984375}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 5991360, "num_agent_steps_trained": 5991360, "num_env_steps_sampled": 5991360, "num_env_steps_trained": 5991360, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1119.3967019045572, "num_env_steps_trained_throughput_per_sec": 1119.3967019045572, "timesteps_total": 5991360, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 5991360, "timers": {"training_iteration_time_ms": 38885.18, "sample_time_ms": 38157.32, "load_time_ms": 12.691, "load_throughput": 3460733.983, "learn_time_ms": 714.36, "learn_throughput": 61481.627, "synch_weights_time_ms": 0.695}, "counters": {"num_env_steps_sampled": 5991360, "num_env_steps_trained": 5991360, "num_agent_steps_sampled": 5991360, "num_agent_steps_trained": 5991360}, "done": false, "episodes_total": 1327, "training_iteration": 448, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-50-12", "timestamp": 1691067012, "time_this_iter_s": 39.238260984420776, "time_total_s": 10664.883694648743, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 5997.338936805725, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 17.323214285714286, "ram_util_percent": 60.89821428571429}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1737.2857546792434, "policy_loss": -6.480218840794622e+20, "vf_loss": 305219644.06413996}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 74431.5, "diff_num_grad_updates_vs_sampler_policy": 74430.5}}, "num_env_steps_sampled": 6035280, "num_env_steps_trained": 6035280, "num_agent_steps_sampled": 6035280, "num_agent_steps_trained": 6035280}, "sampler_results": {"episode_reward_max": -1346772.5824634864, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352493.925776922, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21330977142765437, "mean_inference_ms": 0.3658766631726379, "mean_action_processing_ms": 0.09030365028594498, "mean_env_wait_ms": 0.6706270097127558, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003190755844116211, "StateBufferConnector_ms": 0.0022919178009033203, "ViewRequirementAgentConnector_ms": 0.05944371223449707}}, "episode_reward_max": -1346772.5824634864, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352493.925776922, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1355586.661273286, -1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21330977142765437, "mean_inference_ms": 0.3658766631726379, "mean_action_processing_ms": 0.09030365028594498, "mean_env_wait_ms": 0.6706270097127558, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003190755844116211, "StateBufferConnector_ms": 0.0022919178009033203, "ViewRequirementAgentConnector_ms": 0.05944371223449707}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6035280, "num_agent_steps_trained": 6035280, "num_env_steps_sampled": 6035280, "num_env_steps_trained": 6035280, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1118.0884187246472, "num_env_steps_trained_throughput_per_sec": 1118.0884187246472, "timesteps_total": 6035280, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6035280, "timers": {"training_iteration_time_ms": 38954.594, "sample_time_ms": 38227.164, "load_time_ms": 12.589, "load_throughput": 3488634.037, "learn_time_ms": 714.024, "learn_throughput": 61510.497, "synch_weights_time_ms": 0.702}, "counters": {"num_env_steps_sampled": 6035280, "num_env_steps_trained": 6035280, "num_agent_steps_sampled": 6035280, "num_agent_steps_trained": 6035280}, "done": false, "episodes_total": 1328, "training_iteration": 449, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-50-51", "timestamp": 1691067051, "time_this_iter_s": 39.28364610671997, "time_total_s": 10704.167340755463, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6036.622582912445, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 20.285454545454545, "ram_util_percent": 61.08363636363636}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1737.4657409490023, "policy_loss": -6.283247794895099e+20, "vf_loss": 303597193.271137}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 75117.5, "diff_num_grad_updates_vs_sampler_policy": 75116.5}}, "num_env_steps_sampled": 6079200, "num_env_steps_trained": 6079200, "num_agent_steps_sampled": 6079200, "num_agent_steps_trained": 6079200}, "sampler_results": {"episode_reward_max": -1346772.5824634864, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352469.9082815559, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21300846858901054, "mean_inference_ms": 0.3653598037317458, "mean_action_processing_ms": 0.0901813337451405, "mean_env_wait_ms": 0.6697503341460009, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031669139862060547, "StateBufferConnector_ms": 0.002283811569213867, "ViewRequirementAgentConnector_ms": 0.05919909477233887}}, "episode_reward_max": -1346772.5824634864, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352469.9082815559, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1353591.6677726523, -1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21300846858901054, "mean_inference_ms": 0.3653598037317458, "mean_action_processing_ms": 0.0901813337451405, "mean_env_wait_ms": 0.6697503341460009, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031669139862060547, "StateBufferConnector_ms": 0.002283811569213867, "ViewRequirementAgentConnector_ms": 0.05919909477233887}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6079200, "num_agent_steps_trained": 6079200, "num_env_steps_sampled": 6079200, "num_env_steps_trained": 6079200, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1118.157900702906, "num_env_steps_trained_throughput_per_sec": 1118.157900702906, "timesteps_total": 6079200, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6079200, "timers": {"training_iteration_time_ms": 39043.432, "sample_time_ms": 38315.67, "load_time_ms": 12.485, "load_throughput": 3517833.843, "learn_time_ms": 714.457, "learn_throughput": 61473.252, "synch_weights_time_ms": 0.704}, "counters": {"num_env_steps_sampled": 6079200, "num_env_steps_trained": 6079200, "num_agent_steps_sampled": 6079200, "num_agent_steps_trained": 6079200}, "done": false, "episodes_total": 1329, "training_iteration": 450, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-51-31", "timestamp": 1691067091, "time_this_iter_s": 39.281519174575806, "time_total_s": 10743.448859930038, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6075.904102087021, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 17.405357142857145, "ram_util_percent": 61.11785714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1737.7662921160372, "policy_loss": -5.81652157368703e+20, "vf_loss": 304995601.02623904}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 75803.5, "diff_num_grad_updates_vs_sampler_policy": 75802.5}}, "num_env_steps_sampled": 6123120, "num_env_steps_trained": 6123120, "num_agent_steps_sampled": 6123120, "num_agent_steps_trained": 6123120}, "sampler_results": {"episode_reward_max": -1346772.5824634864, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352494.5051918172, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21270645719716785, "mean_inference_ms": 0.36484547240511295, "mean_action_processing_ms": 0.09005902119891802, "mean_env_wait_ms": 0.668873807146472, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003158092498779297, "StateBufferConnector_ms": 0.0022721290588378906, "ViewRequirementAgentConnector_ms": 0.05896615982055664}}, "episode_reward_max": -1346772.5824634864, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352494.5051918172, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1352064.6436901344, -1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21270645719716785, "mean_inference_ms": 0.36484547240511295, "mean_action_processing_ms": 0.09005902119891802, "mean_env_wait_ms": 0.668873807146472, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003158092498779297, "StateBufferConnector_ms": 0.0022721290588378906, "ViewRequirementAgentConnector_ms": 0.05896615982055664}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6123120, "num_agent_steps_trained": 6123120, "num_env_steps_sampled": 6123120, "num_env_steps_trained": 6123120, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1122.577315165481, "num_env_steps_trained_throughput_per_sec": 1122.577315165481, "timesteps_total": 6123120, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6123120, "timers": {"training_iteration_time_ms": 39106.136, "sample_time_ms": 38379.136, "load_time_ms": 12.403, "load_throughput": 3541177.645, "learn_time_ms": 713.776, "learn_throughput": 61531.947, "synch_weights_time_ms": 0.705}, "counters": {"num_env_steps_sampled": 6123120, "num_env_steps_trained": 6123120, "num_agent_steps_sampled": 6123120, "num_agent_steps_trained": 6123120}, "done": false, "episodes_total": 1330, "training_iteration": 451, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-52-10", "timestamp": 1691067130, "time_this_iter_s": 39.126424074172974, "time_total_s": 10782.575284004211, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6115.030526161194, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 18.22, "ram_util_percent": 61.127272727272725}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1738.0624407442945, "policy_loss": -6.526999248371374e+20, "vf_loss": 302659898.4373178}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 76489.5, "diff_num_grad_updates_vs_sampler_policy": 76488.5}}, "num_env_steps_sampled": 6167040, "num_env_steps_trained": 6167040, "num_agent_steps_sampled": 6167040, "num_agent_steps_trained": 6167040}, "sampler_results": {"episode_reward_max": -1346772.5824634864, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352483.210850793, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21240679372988347, "mean_inference_ms": 0.364332952675986, "mean_action_processing_ms": 0.08993667891117287, "mean_env_wait_ms": 0.6680012364628308, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031502246856689453, "StateBufferConnector_ms": 0.002264261245727539, "ViewRequirementAgentConnector_ms": 0.058747291564941406}}, "episode_reward_max": -1346772.5824634864, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352483.210850793, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1355278.87899834, -1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21240679372988347, "mean_inference_ms": 0.364332952675986, "mean_action_processing_ms": 0.08993667891117287, "mean_env_wait_ms": 0.6680012364628308, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031502246856689453, "StateBufferConnector_ms": 0.002264261245727539, "ViewRequirementAgentConnector_ms": 0.058747291564941406}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6167040, "num_agent_steps_trained": 6167040, "num_env_steps_sampled": 6167040, "num_env_steps_trained": 6167040, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1118.212274778637, "num_env_steps_trained_throughput_per_sec": 1118.212274778637, "timesteps_total": 6167040, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6167040, "timers": {"training_iteration_time_ms": 39182.688, "sample_time_ms": 38460.78, "load_time_ms": 12.451, "load_throughput": 3527358.561, "learn_time_ms": 708.637, "learn_throughput": 61978.123, "synch_weights_time_ms": 0.706}, "counters": {"num_env_steps_sampled": 6167040, "num_env_steps_trained": 6167040, "num_agent_steps_sampled": 6167040, "num_agent_steps_trained": 6167040}, "done": false, "episodes_total": 1331, "training_iteration": 452, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-52-49", "timestamp": 1691067169, "time_this_iter_s": 39.27919268608093, "time_total_s": 10821.854476690292, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6154.309718847275, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 18.055357142857144, "ram_util_percent": 61.15535714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1738.4484493155521, "policy_loss": -6.637945489082357e+20, "vf_loss": 303126275.8017493}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 77175.5, "diff_num_grad_updates_vs_sampler_policy": 77174.5}}, "num_env_steps_sampled": 6210960, "num_env_steps_trained": 6210960, "num_agent_steps_sampled": 6210960, "num_agent_steps_trained": 6210960}, "sampler_results": {"episode_reward_max": -1346772.5824634864, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352450.1137972698, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21210611826947512, "mean_inference_ms": 0.3638208328895288, "mean_action_processing_ms": 0.08981378669470957, "mean_env_wait_ms": 0.6671257517983463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031380653381347656, "StateBufferConnector_ms": 0.0022492408752441406, "ViewRequirementAgentConnector_ms": 0.05852699279785156}}, "episode_reward_max": -1346772.5824634864, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352450.1137972698, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1355094.287187754, -1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21210611826947512, "mean_inference_ms": 0.3638208328895288, "mean_action_processing_ms": 0.08981378669470957, "mean_env_wait_ms": 0.6671257517983463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031380653381347656, "StateBufferConnector_ms": 0.0022492408752441406, "ViewRequirementAgentConnector_ms": 0.05852699279785156}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6210960, "num_agent_steps_trained": 6210960, "num_env_steps_sampled": 6210960, "num_env_steps_trained": 6210960, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1108.7879441690986, "num_env_steps_trained_throughput_per_sec": 1108.7879441690986, "timesteps_total": 6210960, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6210960, "timers": {"training_iteration_time_ms": 39272.247, "sample_time_ms": 38551.388, "load_time_ms": 12.475, "load_throughput": 3520745.067, "learn_time_ms": 707.57, "learn_throughput": 62071.595, "synch_weights_time_ms": 0.701}, "counters": {"num_env_steps_sampled": 6210960, "num_env_steps_trained": 6210960, "num_agent_steps_sampled": 6210960, "num_agent_steps_trained": 6210960}, "done": false, "episodes_total": 1332, "training_iteration": 453, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-53-29", "timestamp": 1691067209, "time_this_iter_s": 39.61314105987549, "time_total_s": 10861.467617750168, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6193.92285990715, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 17.235714285714288, "ram_util_percent": 61.30714285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1738.5996494126389, "policy_loss": -6.385594176435898e+20, "vf_loss": 304431419.60932946}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 77861.5, "diff_num_grad_updates_vs_sampler_policy": 77860.5}}, "num_env_steps_sampled": 6254880, "num_env_steps_trained": 6254880, "num_agent_steps_sampled": 6254880, "num_agent_steps_trained": 6254880}, "sampler_results": {"episode_reward_max": -1346772.5824634864, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352447.3108791993, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21180343256107748, "mean_inference_ms": 0.363306952395525, "mean_action_processing_ms": 0.08969003142128702, "mean_env_wait_ms": 0.6662513433079066, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003129243850708008, "StateBufferConnector_ms": 0.002240896224975586, "ViewRequirementAgentConnector_ms": 0.058344364166259766}}, "episode_reward_max": -1346772.5824634864, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352447.3108791993, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1346772.5824634864, -1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21180343256107748, "mean_inference_ms": 0.363306952395525, "mean_action_processing_ms": 0.08969003142128702, "mean_env_wait_ms": 0.6662513433079066, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003129243850708008, "StateBufferConnector_ms": 0.002240896224975586, "ViewRequirementAgentConnector_ms": 0.058344364166259766}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6254880, "num_agent_steps_trained": 6254880, "num_env_steps_sampled": 6254880, "num_env_steps_trained": 6254880, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1114.1847580626943, "num_env_steps_trained_throughput_per_sec": 1114.1847580626943, "timesteps_total": 6254880, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6254880, "timers": {"training_iteration_time_ms": 39321.878, "sample_time_ms": 38599.833, "load_time_ms": 12.383, "load_throughput": 3546672.821, "learn_time_ms": 708.847, "learn_throughput": 61959.737, "synch_weights_time_ms": 0.699}, "counters": {"num_env_steps_sampled": 6254880, "num_env_steps_trained": 6254880, "num_agent_steps_sampled": 6254880, "num_agent_steps_trained": 6254880}, "done": false, "episodes_total": 1333, "training_iteration": 454, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-54-08", "timestamp": 1691067248, "time_this_iter_s": 39.42114996910095, "time_total_s": 10900.888767719269, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6233.344009876251, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 17.667857142857144, "ram_util_percent": 61.38214285714286}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1738.9669983088102, "policy_loss": -6.203319699291797e+20, "vf_loss": 302695446.8862974}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 78547.5, "diff_num_grad_updates_vs_sampler_policy": 78546.5}}, "num_env_steps_sampled": 6298800, "num_env_steps_trained": 6298800, "num_agent_steps_sampled": 6298800, "num_agent_steps_trained": 6298800}, "sampler_results": {"episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352492.4766718913, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2114987553182128, "mean_inference_ms": 0.3627915053590059, "mean_action_processing_ms": 0.08956537409566223, "mean_env_wait_ms": 0.6653746195504585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031228065490722656, "StateBufferConnector_ms": 0.0022330284118652344, "ViewRequirementAgentConnector_ms": 0.05807757377624512}}, "episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352492.4766718913, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1352067.5537358373, -1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2114987553182128, "mean_inference_ms": 0.3627915053590059, "mean_action_processing_ms": 0.08956537409566223, "mean_env_wait_ms": 0.6653746195504585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031228065490722656, "StateBufferConnector_ms": 0.0022330284118652344, "ViewRequirementAgentConnector_ms": 0.05807757377624512}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6298800, "num_agent_steps_trained": 6298800, "num_env_steps_sampled": 6298800, "num_env_steps_trained": 6298800, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1121.5149723548443, "num_env_steps_trained_throughput_per_sec": 1121.5149723548443, "timesteps_total": 6298800, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6298800, "timers": {"training_iteration_time_ms": 39321.637, "sample_time_ms": 38598.558, "load_time_ms": 12.309, "load_throughput": 3568078.586, "learn_time_ms": 709.961, "learn_throughput": 61862.544, "synch_weights_time_ms": 0.694}, "counters": {"num_env_steps_sampled": 6298800, "num_env_steps_trained": 6298800, "num_agent_steps_sampled": 6298800, "num_agent_steps_trained": 6298800}, "done": false, "episodes_total": 1334, "training_iteration": 455, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-54-47", "timestamp": 1691067287, "time_this_iter_s": 39.16356801986694, "time_total_s": 10940.052335739136, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6272.507577896118, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 19.36, "ram_util_percent": 61.227272727272734}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1739.177177584901, "policy_loss": -7.217929918909822e+20, "vf_loss": 304795190.0174927}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 79233.5, "diff_num_grad_updates_vs_sampler_policy": 79232.5}}, "num_env_steps_sampled": 6342720, "num_env_steps_trained": 6342720, "num_agent_steps_sampled": 6342720, "num_agent_steps_trained": 6342720}, "sampler_results": {"episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352527.993472227, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21119164293285858, "mean_inference_ms": 0.3622741134029329, "mean_action_processing_ms": 0.08943979783783307, "mean_env_wait_ms": 0.6644959425116558, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003114938735961914, "StateBufferConnector_ms": 0.0022225379943847656, "ViewRequirementAgentConnector_ms": 0.05785632133483887}}, "episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352527.993472227, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1354050.523570361, -1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21119164293285858, "mean_inference_ms": 0.3622741134029329, "mean_action_processing_ms": 0.08943979783783307, "mean_env_wait_ms": 0.6644959425116558, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003114938735961914, "StateBufferConnector_ms": 0.0022225379943847656, "ViewRequirementAgentConnector_ms": 0.05785632133483887}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6342720, "num_agent_steps_trained": 6342720, "num_env_steps_sampled": 6342720, "num_env_steps_trained": 6342720, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1110.4933225841794, "num_env_steps_trained_throughput_per_sec": 1110.4933225841794, "timesteps_total": 6342720, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6342720, "timers": {"training_iteration_time_ms": 39345.913, "sample_time_ms": 38623.127, "load_time_ms": 12.406, "load_throughput": 3540122.832, "learn_time_ms": 709.572, "learn_throughput": 61896.473, "synch_weights_time_ms": 0.695}, "counters": {"num_env_steps_sampled": 6342720, "num_env_steps_trained": 6342720, "num_agent_steps_sampled": 6342720, "num_agent_steps_trained": 6342720}, "done": false, "episodes_total": 1335, "training_iteration": 456, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-55-27", "timestamp": 1691067327, "time_this_iter_s": 39.552207231521606, "time_total_s": 10979.604542970657, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6312.05978512764, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 16.958928571428572, "ram_util_percent": 61.294642857142854}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1739.4230981943558, "policy_loss": -6.731058835580335e+20, "vf_loss": 304387840.5131195}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 79919.5, "diff_num_grad_updates_vs_sampler_policy": 79918.5}}, "num_env_steps_sampled": 6386640, "num_env_steps_trained": 6386640, "num_agent_steps_sampled": 6386640, "num_agent_steps_trained": 6386640}, "sampler_results": {"episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352535.5869259846, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21088228094668984, "mean_inference_ms": 0.36175434850781707, "mean_action_processing_ms": 0.08931321348547602, "mean_env_wait_ms": 0.6636088582810102, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031120777130126953, "StateBufferConnector_ms": 0.0022132396697998047, "ViewRequirementAgentConnector_ms": 0.05772733688354492}}, "episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352535.5869259846, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1352951.9136587447, -1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21088228094668984, "mean_inference_ms": 0.36175434850781707, "mean_action_processing_ms": 0.08931321348547602, "mean_env_wait_ms": 0.6636088582810102, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031120777130126953, "StateBufferConnector_ms": 0.0022132396697998047, "ViewRequirementAgentConnector_ms": 0.05772733688354492}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6386640, "num_agent_steps_trained": 6386640, "num_env_steps_sampled": 6386640, "num_env_steps_trained": 6386640, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1100.2674254222823, "num_env_steps_trained_throughput_per_sec": 1100.2674254222823, "timesteps_total": 6386640, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6386640, "timers": {"training_iteration_time_ms": 39385.536, "sample_time_ms": 38647.47, "load_time_ms": 12.594, "load_throughput": 3487247.169, "learn_time_ms": 724.649, "learn_throughput": 60608.665, "synch_weights_time_ms": 0.706}, "counters": {"num_env_steps_sampled": 6386640, "num_env_steps_trained": 6386640, "num_agent_steps_sampled": 6386640, "num_agent_steps_trained": 6386640}, "done": false, "episodes_total": 1336, "training_iteration": 457, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-56-07", "timestamp": 1691067367, "time_this_iter_s": 39.91996383666992, "time_total_s": 11019.524506807327, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6351.97974896431, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 17.92280701754386, "ram_util_percent": 61.347368421052636}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1739.7571190480935, "policy_loss": -6.572346852895376e+20, "vf_loss": 302658287.5102041}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 80605.5, "diff_num_grad_updates_vs_sampler_policy": 80604.5}}, "num_env_steps_sampled": 6430560, "num_env_steps_trained": 6430560, "num_agent_steps_sampled": 6430560, "num_agent_steps_trained": 6430560}, "sampler_results": {"episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352516.5498926565, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.210574329008318, "mean_inference_ms": 0.3612331558025662, "mean_action_processing_ms": 0.08918603429568085, "mean_env_wait_ms": 0.6627291365009172, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003105640411376953, "StateBufferConnector_ms": 0.0022084712982177734, "ViewRequirementAgentConnector_ms": 0.05756521224975586}}, "episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352516.5498926565, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1355418.1131962182, -1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.210574329008318, "mean_inference_ms": 0.3612331558025662, "mean_action_processing_ms": 0.08918603429568085, "mean_env_wait_ms": 0.6627291365009172, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003105640411376953, "StateBufferConnector_ms": 0.0022084712982177734, "ViewRequirementAgentConnector_ms": 0.05756521224975586}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6430560, "num_agent_steps_trained": 6430560, "num_env_steps_sampled": 6430560, "num_env_steps_trained": 6430560, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 995.034436247448, "num_env_steps_trained_throughput_per_sec": 995.034436247448, "timesteps_total": 6430560, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6430560, "timers": {"training_iteration_time_ms": 39875.912, "sample_time_ms": 39122.724, "load_time_ms": 12.833, "load_throughput": 3422541.217, "learn_time_ms": 739.521, "learn_throughput": 59389.771, "synch_weights_time_ms": 0.716}, "counters": {"num_env_steps_sampled": 6430560, "num_env_steps_trained": 6430560, "num_agent_steps_sampled": 6430560, "num_agent_steps_trained": 6430560}, "done": false, "episodes_total": 1337, "training_iteration": 458, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-56-51", "timestamp": 1691067411, "time_this_iter_s": 44.14150381088257, "time_total_s": 11063.66601061821, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6396.121252775192, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 18.006451612903223, "ram_util_percent": 61.414516129032265}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1740.0712963582475, "policy_loss": -6.708718373180687e+20, "vf_loss": 302765825.9941691}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 81291.5, "diff_num_grad_updates_vs_sampler_policy": 81290.5}}, "num_env_steps_sampled": 6474480, "num_env_steps_trained": 6474480, "num_agent_steps_sampled": 6474480, "num_agent_steps_trained": 6474480}, "sampler_results": {"episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352477.4425275368, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235, -1351507.3766842408], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21026543114687546, "mean_inference_ms": 0.36071001032194033, "mean_action_processing_ms": 0.08905840307520523, "mean_env_wait_ms": 0.6618505214294097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031015872955322266, "StateBufferConnector_ms": 0.0022068023681640625, "ViewRequirementAgentConnector_ms": 0.05747222900390625}}, "episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352477.4425275368, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1352170.263000676, -1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235, -1351507.3766842408], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.21026543114687546, "mean_inference_ms": 0.36071001032194033, "mean_action_processing_ms": 0.08905840307520523, "mean_env_wait_ms": 0.6618505214294097, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031015872955322266, "StateBufferConnector_ms": 0.0022068023681640625, "ViewRequirementAgentConnector_ms": 0.05747222900390625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6474480, "num_agent_steps_trained": 6474480, "num_env_steps_sampled": 6474480, "num_env_steps_trained": 6474480, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 980.2304788348372, "num_env_steps_trained_throughput_per_sec": 980.2304788348372, "timesteps_total": 6474480, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6474480, "timers": {"training_iteration_time_ms": 40428.358, "sample_time_ms": 39660.693, "load_time_ms": 13.08, "load_throughput": 3357804.06, "learn_time_ms": 753.746, "learn_throughput": 58268.982, "synch_weights_time_ms": 0.719}, "counters": {"num_env_steps_sampled": 6474480, "num_env_steps_trained": 6474480, "num_agent_steps_sampled": 6474480, "num_agent_steps_trained": 6474480}, "done": false, "episodes_total": 1338, "training_iteration": 459, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-57-36", "timestamp": 1691067456, "time_this_iter_s": 44.80835580825806, "time_total_s": 11108.474366426468, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6440.92960858345, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 18.5375, "ram_util_percent": 61.517187500000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1740.3491936953353, "policy_loss": -6.688928620792893e+20, "vf_loss": 303471139.7609329}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 81977.5, "diff_num_grad_updates_vs_sampler_policy": 81976.5}}, "num_env_steps_sampled": 6518400, "num_env_steps_trained": 6518400, "num_agent_steps_sampled": 6518400, "num_agent_steps_trained": 6518400}, "sampler_results": {"episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352483.1775849795, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235, -1351507.3766842408, -1352743.768744965], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20995631295377706, "mean_inference_ms": 0.3601860906242098, "mean_action_processing_ms": 0.08893017473608256, "mean_env_wait_ms": 0.6609692959592173, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030918121337890625, "StateBufferConnector_ms": 0.0022003650665283203, "ViewRequirementAgentConnector_ms": 0.057318687438964844}}, "episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352483.1775849795, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1350478.1308465083, -1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235, -1351507.3766842408, -1352743.768744965], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20995631295377706, "mean_inference_ms": 0.3601860906242098, "mean_action_processing_ms": 0.08893017473608256, "mean_env_wait_ms": 0.6609692959592173, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030918121337890625, "StateBufferConnector_ms": 0.0022003650665283203, "ViewRequirementAgentConnector_ms": 0.057318687438964844}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6518400, "num_agent_steps_trained": 6518400, "num_env_steps_sampled": 6518400, "num_env_steps_trained": 6518400, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 996.7560282613982, "num_env_steps_trained_throughput_per_sec": 996.7560282613982, "timesteps_total": 6518400, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6518400, "timers": {"training_iteration_time_ms": 40906.762, "sample_time_ms": 40123.605, "load_time_ms": 13.341, "load_throughput": 3292113.49, "learn_time_ms": 768.975, "learn_throughput": 57115.0, "synch_weights_time_ms": 0.72}, "counters": {"num_env_steps_sampled": 6518400, "num_env_steps_trained": 6518400, "num_agent_steps_sampled": 6518400, "num_agent_steps_trained": 6518400}, "done": false, "episodes_total": 1339, "training_iteration": 460, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-58-20", "timestamp": 1691067500, "time_this_iter_s": 44.06532025337219, "time_total_s": 11152.53968667984, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6484.9949288368225, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 18.690322580645162, "ram_util_percent": 61.44516129032258}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1740.4887058269178, "policy_loss": -7.364531645304042e+20, "vf_loss": 305131607.81341106}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 82663.5, "diff_num_grad_updates_vs_sampler_policy": 82662.5}}, "num_env_steps_sampled": 6562320, "num_env_steps_trained": 6562320, "num_agent_steps_sampled": 6562320, "num_agent_steps_trained": 6562320}, "sampler_results": {"episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352541.9030962375, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235, -1351507.3766842408, -1352743.768744965, -1356350.681972289], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2096456737861415, "mean_inference_ms": 0.3596609548740227, "mean_action_processing_ms": 0.08880126127594877, "mean_env_wait_ms": 0.660086679012504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030808448791503906, "StateBufferConnector_ms": 0.0021944046020507812, "ViewRequirementAgentConnector_ms": 0.05718231201171875}}, "episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352541.9030962375, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1354812.8229062976, -1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235, -1351507.3766842408, -1352743.768744965, -1356350.681972289], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2096456737861415, "mean_inference_ms": 0.3596609548740227, "mean_action_processing_ms": 0.08880126127594877, "mean_env_wait_ms": 0.660086679012504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030808448791503906, "StateBufferConnector_ms": 0.0021944046020507812, "ViewRequirementAgentConnector_ms": 0.05718231201171875}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6562320, "num_agent_steps_trained": 6562320, "num_env_steps_sampled": 6562320, "num_env_steps_trained": 6562320, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 986.5452755122753, "num_env_steps_trained_throughput_per_sec": 986.5452755122753, "timesteps_total": 6562320, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6562320, "timers": {"training_iteration_time_ms": 41446.236, "sample_time_ms": 40649.026, "load_time_ms": 13.497, "load_throughput": 3253988.693, "learn_time_ms": 782.857, "learn_throughput": 56102.18, "synch_weights_time_ms": 0.734}, "counters": {"num_env_steps_sampled": 6562320, "num_env_steps_trained": 6562320, "num_agent_steps_sampled": 6562320, "num_agent_steps_trained": 6562320}, "done": false, "episodes_total": 1340, "training_iteration": 461, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-59-04", "timestamp": 1691067544, "time_this_iter_s": 44.52134084701538, "time_total_s": 11197.061027526855, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6529.516269683838, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 19.68253968253968, "ram_util_percent": 61.52539682539683}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.000000000000001e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1740.9335282662173, "policy_loss": -6.60937720693123e+20, "vf_loss": 302851820.4664723}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 83349.5, "diff_num_grad_updates_vs_sampler_policy": 83348.5}}, "num_env_steps_sampled": 6606240, "num_env_steps_trained": 6606240, "num_agent_steps_sampled": 6606240, "num_agent_steps_trained": 6606240}, "sampler_results": {"episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352509.3237606625, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235, -1351507.3766842408, -1352743.768744965, -1356350.681972289, -1351554.8893488187], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20933355378868154, "mean_inference_ms": 0.3591346362494741, "mean_action_processing_ms": 0.08867179879158069, "mean_env_wait_ms": 0.6591979178835078, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003082752227783203, "StateBufferConnector_ms": 0.0021839141845703125, "ViewRequirementAgentConnector_ms": 0.05700492858886719}}, "episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352509.3237606625, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1351528.5839950922, -1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235, -1351507.3766842408, -1352743.768744965, -1356350.681972289, -1351554.8893488187], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20933355378868154, "mean_inference_ms": 0.3591346362494741, "mean_action_processing_ms": 0.08867179879158069, "mean_env_wait_ms": 0.6591979178835078, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003082752227783203, "StateBufferConnector_ms": 0.0021839141845703125, "ViewRequirementAgentConnector_ms": 0.05700492858886719}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6606240, "num_agent_steps_trained": 6606240, "num_env_steps_sampled": 6606240, "num_env_steps_trained": 6606240, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 996.8681894007133, "num_env_steps_trained_throughput_per_sec": 996.8681894007133, "timesteps_total": 6606240, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6606240, "timers": {"training_iteration_time_ms": 41924.336, "sample_time_ms": 41114.517, "load_time_ms": 13.565, "load_throughput": 3237632.306, "learn_time_ms": 795.386, "learn_throughput": 55218.482, "synch_weights_time_ms": 0.746}, "counters": {"num_env_steps_sampled": 6606240, "num_env_steps_trained": 6606240, "num_agent_steps_sampled": 6606240, "num_agent_steps_trained": 6606240}, "done": false, "episodes_total": 1341, "training_iteration": 462, "trial_id": "4d6b1_00000", "date": "2023-08-03_15-59-49", "timestamp": 1691067589, "time_this_iter_s": 44.06042003631592, "time_total_s": 11241.121447563171, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6573.576689720154, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 17.674603174603174, "ram_util_percent": 61.560317460317464}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.5999999999999994e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1741.2159795733305, "policy_loss": -6.99925094203409e+20, "vf_loss": 302965304.4314869}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 84035.5, "diff_num_grad_updates_vs_sampler_policy": 84034.5}}, "num_env_steps_sampled": 6650160, "num_env_steps_trained": 6650160, "num_agent_steps_sampled": 6650160, "num_agent_steps_trained": 6650160}, "sampler_results": {"episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352510.8348908052, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235, -1351507.3766842408, -1352743.768744965, -1356350.681972289, -1351554.8893488187, -1351679.6970093274], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20901946660053666, "mean_inference_ms": 0.358606123285766, "mean_action_processing_ms": 0.08854154717042195, "mean_env_wait_ms": 0.6583009292770328, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030753612518310547, "StateBufferConnector_ms": 0.0021796226501464844, "ViewRequirementAgentConnector_ms": 0.05681037902832031}}, "episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352510.8348908052, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1350650.1986155633, -1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235, -1351507.3766842408, -1352743.768744965, -1356350.681972289, -1351554.8893488187, -1351679.6970093274], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20901946660053666, "mean_inference_ms": 0.358606123285766, "mean_action_processing_ms": 0.08854154717042195, "mean_env_wait_ms": 0.6583009292770328, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030753612518310547, "StateBufferConnector_ms": 0.0021796226501464844, "ViewRequirementAgentConnector_ms": 0.05681037902832031}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6650160, "num_agent_steps_trained": 6650160, "num_env_steps_sampled": 6650160, "num_env_steps_trained": 6650160, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 996.6437252035183, "num_env_steps_trained_throughput_per_sec": 996.6437252035183, "timesteps_total": 6650160, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6650160, "timers": {"training_iteration_time_ms": 42370.044, "sample_time_ms": 41545.459, "load_time_ms": 13.754, "load_throughput": 3193145.336, "learn_time_ms": 809.946, "learn_throughput": 54225.833, "synch_weights_time_ms": 0.761}, "counters": {"num_env_steps_sampled": 6650160, "num_env_steps_trained": 6650160, "num_agent_steps_sampled": 6650160, "num_agent_steps_trained": 6650160}, "done": false, "episodes_total": 1342, "training_iteration": 463, "trial_id": "4d6b1_00000", "date": "2023-08-03_16-00-33", "timestamp": 1691067633, "time_this_iter_s": 44.07027220726013, "time_total_s": 11285.191719770432, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6617.646961927414, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 17.82903225806452, "ram_util_percent": 61.61290322580645}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.2000000000000016e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1741.4102749393562, "policy_loss": -7.43683337615906e+20, "vf_loss": 303109796.7172012}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 84721.5, "diff_num_grad_updates_vs_sampler_policy": 84720.5}}, "num_env_steps_sampled": 6694080, "num_env_steps_trained": 6694080, "num_agent_steps_sampled": 6694080, "num_agent_steps_trained": 6694080}, "sampler_results": {"episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352524.508327894, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235, -1351507.3766842408, -1352743.768744965, -1356350.681972289, -1351554.8893488187, -1351679.6970093274, -1352017.542324443], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2087049585205351, "mean_inference_ms": 0.3580753738842738, "mean_action_processing_ms": 0.08841053946981865, "mean_env_wait_ms": 0.6573980663449005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003058195114135742, "StateBufferConnector_ms": 0.002176046371459961, "ViewRequirementAgentConnector_ms": 0.05663800239562988}}, "episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352524.508327894, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1353134.9722413102, -1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235, -1351507.3766842408, -1352743.768744965, -1356350.681972289, -1351554.8893488187, -1351679.6970093274, -1352017.542324443], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2087049585205351, "mean_inference_ms": 0.3580753738842738, "mean_action_processing_ms": 0.08841053946981865, "mean_env_wait_ms": 0.6573980663449005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003058195114135742, "StateBufferConnector_ms": 0.002176046371459961, "ViewRequirementAgentConnector_ms": 0.05663800239562988}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6694080, "num_agent_steps_trained": 6694080, "num_env_steps_sampled": 6694080, "num_env_steps_trained": 6694080, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1005.8498976100393, "num_env_steps_trained_throughput_per_sec": 1005.8498976100393, "timesteps_total": 6694080, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6694080, "timers": {"training_iteration_time_ms": 42794.605, "sample_time_ms": 41957.081, "load_time_ms": 13.885, "load_throughput": 3163044.806, "learn_time_ms": 822.734, "learn_throughput": 53382.958, "synch_weights_time_ms": 0.777}, "counters": {"num_env_steps_sampled": 6694080, "num_env_steps_trained": 6694080, "num_agent_steps_sampled": 6694080, "num_agent_steps_trained": 6694080}, "done": false, "episodes_total": 1343, "training_iteration": 464, "trial_id": "4d6b1_00000", "date": "2023-08-03_16-01-16", "timestamp": 1691067676, "time_this_iter_s": 43.66708707809448, "time_total_s": 11328.858806848526, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6661.314049005508, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 17.712903225806453, "ram_util_percent": 61.66612903225806}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.799999999999999e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1741.5933567414131, "policy_loss": -6.073468006452669e+20, "vf_loss": 302031456.48396504}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 85407.5, "diff_num_grad_updates_vs_sampler_policy": 85406.5}}, "num_env_steps_sampled": 6738000, "num_env_steps_trained": 6738000, "num_agent_steps_sampled": 6738000, "num_agent_steps_trained": 6738000}, "sampler_results": {"episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352489.9598155436, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235, -1351507.3766842408, -1352743.768744965, -1356350.681972289, -1351554.8893488187, -1351679.6970093274, -1352017.542324443, -1349680.1210062886], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20838873400299288, "mean_inference_ms": 0.35754222255766094, "mean_action_processing_ms": 0.0882786995067632, "mean_env_wait_ms": 0.6564892008579829, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030508041381835938, "StateBufferConnector_ms": 0.0021691322326660156, "ViewRequirementAgentConnector_ms": 0.05645275115966797}}, "episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352489.9598155436, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1350338.958443912, -1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235, -1351507.3766842408, -1352743.768744965, -1356350.681972289, -1351554.8893488187, -1351679.6970093274, -1352017.542324443, -1349680.1210062886], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20838873400299288, "mean_inference_ms": 0.35754222255766094, "mean_action_processing_ms": 0.0882786995067632, "mean_env_wait_ms": 0.6564892008579829, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030508041381835938, "StateBufferConnector_ms": 0.0021691322326660156, "ViewRequirementAgentConnector_ms": 0.05645275115966797}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6738000, "num_agent_steps_trained": 6738000, "num_env_steps_sampled": 6738000, "num_env_steps_trained": 6738000, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1007.3339984082037, "num_env_steps_trained_throughput_per_sec": 1007.3339984082037, "timesteps_total": 6738000, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6738000, "timers": {"training_iteration_time_ms": 43238.497, "sample_time_ms": 42380.314, "load_time_ms": 14.098, "load_throughput": 3115409.153, "learn_time_ms": 843.171, "learn_throughput": 52089.06, "synch_weights_time_ms": 0.784}, "counters": {"num_env_steps_sampled": 6738000, "num_env_steps_trained": 6738000, "num_agent_steps_sampled": 6738000, "num_agent_steps_trained": 6738000}, "done": false, "episodes_total": 1344, "training_iteration": 465, "trial_id": "4d6b1_00000", "date": "2023-08-03_16-02-00", "timestamp": 1691067720, "time_this_iter_s": 43.602954149246216, "time_total_s": 11372.461760997772, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6704.917003154755, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 17.85737704918033, "ram_util_percent": 61.88196721311475}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.400000000000001e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1741.763548203182, "policy_loss": -6.952929360190751e+20, "vf_loss": 302335831.8833819}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 86093.5, "diff_num_grad_updates_vs_sampler_policy": 86092.5}}, "num_env_steps_sampled": 6781920, "num_env_steps_trained": 6781920, "num_agent_steps_sampled": 6781920, "num_agent_steps_trained": 6781920}, "sampler_results": {"episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352488.162175153, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235, -1351507.3766842408, -1352743.768744965, -1356350.681972289, -1351554.8893488187, -1351679.6970093274, -1352017.542324443, -1349680.1210062886, -1350159.1944048286], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20807115028028647, "mean_inference_ms": 0.35700695375058294, "mean_action_processing_ms": 0.088146221927006, "mean_env_wait_ms": 0.6555756062502275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030405521392822266, "StateBufferConnector_ms": 0.002162456512451172, "ViewRequirementAgentConnector_ms": 0.05629253387451172}}, "episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352488.162175153, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1352583.983811229, -1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235, -1351507.3766842408, -1352743.768744965, -1356350.681972289, -1351554.8893488187, -1351679.6970093274, -1352017.542324443, -1349680.1210062886, -1350159.1944048286], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20807115028028647, "mean_inference_ms": 0.35700695375058294, "mean_action_processing_ms": 0.088146221927006, "mean_env_wait_ms": 0.6555756062502275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0030405521392822266, "StateBufferConnector_ms": 0.002162456512451172, "ViewRequirementAgentConnector_ms": 0.05629253387451172}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6781920, "num_agent_steps_trained": 6781920, "num_env_steps_sampled": 6781920, "num_env_steps_trained": 6781920, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 987.9662288942657, "num_env_steps_trained_throughput_per_sec": 987.9662288942657, "timesteps_total": 6781920, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6781920, "timers": {"training_iteration_time_ms": 43728.994, "sample_time_ms": 42855.787, "load_time_ms": 14.145, "load_throughput": 3105032.77, "learn_time_ms": 858.136, "learn_throughput": 51180.682, "synch_weights_time_ms": 0.793}, "counters": {"num_env_steps_sampled": 6781920, "num_env_steps_trained": 6781920, "num_agent_steps_sampled": 6781920, "num_agent_steps_trained": 6781920}, "done": false, "episodes_total": 1345, "training_iteration": 466, "trial_id": "4d6b1_00000", "date": "2023-08-03_16-02-44", "timestamp": 1691067764, "time_this_iter_s": 44.457422971725464, "time_total_s": 11416.919183969498, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6749.37442612648, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 19.414285714285715, "ram_util_percent": 61.88095238095237}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.0000000000000004e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1741.959983892413, "policy_loss": -7.233544099181891e+20, "vf_loss": 304058433.0728863}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 86779.5, "diff_num_grad_updates_vs_sampler_policy": 86778.5}}, "num_env_steps_sampled": 6825840, "num_env_steps_trained": 6825840, "num_agent_steps_sampled": 6825840, "num_agent_steps_trained": 6825840}, "sampler_results": {"episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352504.4234466879, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235, -1351507.3766842408, -1352743.768744965, -1356350.681972289, -1351554.8893488187, -1351679.6970093274, -1352017.542324443, -1349680.1210062886, -1350159.1944048286, -1354210.1109647385], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20775227672006122, "mean_inference_ms": 0.35646972251104164, "mean_action_processing_ms": 0.08801305423475295, "mean_env_wait_ms": 0.6546555028875934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003032684326171875, "StateBufferConnector_ms": 0.002151966094970703, "ViewRequirementAgentConnector_ms": 0.05613517761230469}}, "episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352504.4234466879, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1355867.4956017635, -1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235, -1351507.3766842408, -1352743.768744965, -1356350.681972289, -1351554.8893488187, -1351679.6970093274, -1352017.542324443, -1349680.1210062886, -1350159.1944048286, -1354210.1109647385], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20775227672006122, "mean_inference_ms": 0.35646972251104164, "mean_action_processing_ms": 0.08801305423475295, "mean_env_wait_ms": 0.6546555028875934, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003032684326171875, "StateBufferConnector_ms": 0.002151966094970703, "ViewRequirementAgentConnector_ms": 0.05613517761230469}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6825840, "num_agent_steps_trained": 6825840, "num_env_steps_sampled": 6825840, "num_env_steps_trained": 6825840, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 977.8453894412932, "num_env_steps_trained_throughput_per_sec": 977.8453894412932, "timesteps_total": 6825840, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6825840, "timers": {"training_iteration_time_ms": 44228.745, "sample_time_ms": 43356.03, "load_time_ms": 14.054, "load_throughput": 3125027.892, "learn_time_ms": 857.744, "learn_throughput": 51204.109, "synch_weights_time_ms": 0.786}, "counters": {"num_env_steps_sampled": 6825840, "num_env_steps_trained": 6825840, "num_agent_steps_sampled": 6825840, "num_agent_steps_trained": 6825840}, "done": false, "episodes_total": 1346, "training_iteration": 467, "trial_id": "4d6b1_00000", "date": "2023-08-03_16-03-29", "timestamp": 1691067809, "time_this_iter_s": 44.91754388809204, "time_total_s": 11461.83672785759, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6794.291970014572, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 17.31875, "ram_util_percent": 61.890625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.6000000000000005e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1742.1407365715538, "policy_loss": -7.304067026612115e+20, "vf_loss": 303938270.37900877}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 87465.5, "diff_num_grad_updates_vs_sampler_policy": 87464.5}}, "num_env_steps_sampled": 6869760, "num_env_steps_trained": 6869760, "num_agent_steps_sampled": 6869760, "num_agent_steps_trained": 6869760}, "sampler_results": {"episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352482.6983625456, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235, -1351507.3766842408, -1352743.768744965, -1356350.681972289, -1351554.8893488187, -1351679.6970093274, -1352017.542324443, -1349680.1210062886, -1350159.1944048286, -1354210.1109647385, -1353694.987187547], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20743210289154793, "mean_inference_ms": 0.35593026750914336, "mean_action_processing_ms": 0.08787922548816705, "mean_env_wait_ms": 0.6537297260577862, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003025054931640625, "StateBufferConnector_ms": 0.0021500587463378906, "ViewRequirementAgentConnector_ms": 0.05603313446044922}}, "episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352482.6983625456, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1349670.5551001302, -1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235, -1351507.3766842408, -1352743.768744965, -1356350.681972289, -1351554.8893488187, -1351679.6970093274, -1352017.542324443, -1349680.1210062886, -1350159.1944048286, -1354210.1109647385, -1353694.987187547], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20743210289154793, "mean_inference_ms": 0.35593026750914336, "mean_action_processing_ms": 0.08787922548816705, "mean_env_wait_ms": 0.6537297260577862, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003025054931640625, "StateBufferConnector_ms": 0.0021500587463378906, "ViewRequirementAgentConnector_ms": 0.05603313446044922}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6869760, "num_agent_steps_trained": 6869760, "num_env_steps_sampled": 6869760, "num_env_steps_trained": 6869760, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 957.82416160685, "num_env_steps_trained_throughput_per_sec": 957.82416160685, "timesteps_total": 6869760, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6869760, "timers": {"training_iteration_time_ms": 44400.22, "sample_time_ms": 43477.041, "load_time_ms": 14.382, "load_throughput": 3053821.328, "learn_time_ms": 907.859, "learn_throughput": 48377.581, "synch_weights_time_ms": 0.8}, "counters": {"num_env_steps_sampled": 6869760, "num_env_steps_trained": 6869760, "num_agent_steps_sampled": 6869760, "num_agent_steps_trained": 6869760}, "done": false, "episodes_total": 1347, "training_iteration": 468, "trial_id": "4d6b1_00000", "date": "2023-08-03_16-04-15", "timestamp": 1691067855, "time_this_iter_s": 45.85731601715088, "time_total_s": 11507.69404387474, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6840.149286031723, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 19.119999999999997, "ram_util_percent": 61.744615384615386}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.1999999999999998e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1742.4133968075232, "policy_loss": -7.730194157109082e+20, "vf_loss": 303605946.7172012}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 88151.5, "diff_num_grad_updates_vs_sampler_policy": 88150.5}}, "num_env_steps_sampled": 6913680, "num_env_steps_trained": 6913680, "num_agent_steps_sampled": 6913680, "num_agent_steps_trained": 6913680}, "sampler_results": {"episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352515.2667298985, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235, -1351507.3766842408, -1352743.768744965, -1356350.681972289, -1351554.8893488187, -1351679.6970093274, -1352017.542324443, -1349680.1210062886, -1350159.1944048286, -1354210.1109647385, -1353694.987187547, -1352927.3918354292], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20711061879151113, "mean_inference_ms": 0.35538836269842583, "mean_action_processing_ms": 0.08774485786478119, "mean_env_wait_ms": 0.6527980183667391, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003014087677001953, "StateBufferConnector_ms": 0.0021431446075439453, "ViewRequirementAgentConnector_ms": 0.05585670471191406}}, "episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352515.2667298985, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1351152.4635969675, -1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235, -1351507.3766842408, -1352743.768744965, -1356350.681972289, -1351554.8893488187, -1351679.6970093274, -1352017.542324443, -1349680.1210062886, -1350159.1944048286, -1354210.1109647385, -1353694.987187547, -1352927.3918354292], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20711061879151113, "mean_inference_ms": 0.35538836269842583, "mean_action_processing_ms": 0.08774485786478119, "mean_env_wait_ms": 0.6527980183667391, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003014087677001953, "StateBufferConnector_ms": 0.0021431446075439453, "ViewRequirementAgentConnector_ms": 0.05585670471191406}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6913680, "num_agent_steps_trained": 6913680, "num_env_steps_sampled": 6913680, "num_env_steps_trained": 6913680, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 938.2387492458364, "num_env_steps_trained_throughput_per_sec": 938.2387492458364, "timesteps_total": 6913680, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6913680, "timers": {"training_iteration_time_ms": 44600.752, "sample_time_ms": 43622.06, "load_time_ms": 14.801, "load_throughput": 2967347.64, "learn_time_ms": 962.915, "learn_throughput": 45611.505, "synch_weights_time_ms": 0.828}, "counters": {"num_env_steps_sampled": 6913680, "num_env_steps_trained": 6913680, "num_agent_steps_sampled": 6913680, "num_agent_steps_trained": 6913680}, "done": false, "episodes_total": 1348, "training_iteration": 469, "trial_id": "4d6b1_00000", "date": "2023-08-03_16-05-02", "timestamp": 1691067902, "time_this_iter_s": 46.8145272731781, "time_total_s": 11554.508571147919, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6886.963813304901, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 20.674242424242426, "ram_util_percent": 61.883333333333326}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.7999999999999997e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1742.4844568547285, "policy_loss": -7.62974319942977e+20, "vf_loss": 304369488.97959185}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 88837.5, "diff_num_grad_updates_vs_sampler_policy": 88836.5}}, "num_env_steps_sampled": 6957600, "num_env_steps_trained": 6957600, "num_agent_steps_sampled": 6957600, "num_agent_steps_trained": 6957600}, "sampler_results": {"episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352550.8807375259, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235, -1351507.3766842408, -1352743.768744965, -1356350.681972289, -1351554.8893488187, -1351679.6970093274, -1352017.542324443, -1349680.1210062886, -1350159.1944048286, -1354210.1109647385, -1353694.987187547, -1352927.3918354292, -1354713.8643596715], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20678884086211138, "mean_inference_ms": 0.35484447463455837, "mean_action_processing_ms": 0.08760992131508992, "mean_env_wait_ms": 0.6518615043962714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003006458282470703, "StateBufferConnector_ms": 0.0021414756774902344, "ViewRequirementAgentConnector_ms": 0.055676937103271484}}, "episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352550.8807375259, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1352455.623982579, -1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235, -1351507.3766842408, -1352743.768744965, -1356350.681972289, -1351554.8893488187, -1351679.6970093274, -1352017.542324443, -1349680.1210062886, -1350159.1944048286, -1354210.1109647385, -1353694.987187547, -1352927.3918354292, -1354713.8643596715], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20678884086211138, "mean_inference_ms": 0.35484447463455837, "mean_action_processing_ms": 0.08760992131508992, "mean_env_wait_ms": 0.6518615043962714, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003006458282470703, "StateBufferConnector_ms": 0.0021414756774902344, "ViewRequirementAgentConnector_ms": 0.055676937103271484}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 6957600, "num_agent_steps_trained": 6957600, "num_env_steps_sampled": 6957600, "num_env_steps_trained": 6957600, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 957.8860150687556, "num_env_steps_trained_throughput_per_sec": 957.8860150687556, "timesteps_total": 6957600, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 6957600, "timers": {"training_iteration_time_ms": 44779.554, "sample_time_ms": 43800.973, "load_time_ms": 14.773, "load_throughput": 2972907.448, "learn_time_ms": 962.833, "learn_throughput": 45615.366, "synch_weights_time_ms": 0.828}, "counters": {"num_env_steps_sampled": 6957600, "num_env_steps_trained": 6957600, "num_agent_steps_sampled": 6957600, "num_agent_steps_trained": 6957600}, "done": false, "episodes_total": 1349, "training_iteration": 470, "trial_id": "4d6b1_00000", "date": "2023-08-03_16-05-48", "timestamp": 1691067948, "time_this_iter_s": 45.8537118434906, "time_total_s": 11600.36228299141, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6932.817525148392, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 19.18, "ram_util_percent": 61.97692307692308}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.3999999999999996e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1742.6437006024507, "policy_loss": -6.861863519707676e+20, "vf_loss": 302307718.99708456}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 89523.5, "diff_num_grad_updates_vs_sampler_policy": 89522.5}}, "num_env_steps_sampled": 7001520, "num_env_steps_trained": 7001520, "num_agent_steps_sampled": 7001520, "num_agent_steps_trained": 7001520}, "sampler_results": {"episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352528.379846655, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235, -1351507.3766842408, -1352743.768744965, -1356350.681972289, -1351554.8893488187, -1351679.6970093274, -1352017.542324443, -1349680.1210062886, -1350159.1944048286, -1354210.1109647385, -1353694.987187547, -1352927.3918354292, -1354713.8643596715, -1350205.5348955018], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20646572891287807, "mean_inference_ms": 0.35429822459609134, "mean_action_processing_ms": 0.08747428288854879, "mean_env_wait_ms": 0.6509203965830908, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002997159957885742, "StateBufferConnector_ms": 0.002137422561645508, "ViewRequirementAgentConnector_ms": 0.05552387237548828}}, "episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352528.379846655, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1352114.3062434022, -1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235, -1351507.3766842408, -1352743.768744965, -1356350.681972289, -1351554.8893488187, -1351679.6970093274, -1352017.542324443, -1349680.1210062886, -1350159.1944048286, -1354210.1109647385, -1353694.987187547, -1352927.3918354292, -1354713.8643596715, -1350205.5348955018], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20646572891287807, "mean_inference_ms": 0.35429822459609134, "mean_action_processing_ms": 0.08747428288854879, "mean_env_wait_ms": 0.6509203965830908, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002997159957885742, "StateBufferConnector_ms": 0.002137422561645508, "ViewRequirementAgentConnector_ms": 0.05552387237548828}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7001520, "num_agent_steps_trained": 7001520, "num_env_steps_sampled": 7001520, "num_env_steps_trained": 7001520, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 981.0314904718, "num_env_steps_trained_throughput_per_sec": 981.0314904718, "timesteps_total": 7001520, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7001520, "timers": {"training_iteration_time_ms": 44804.576, "sample_time_ms": 43823.213, "load_time_ms": 14.795, "load_throughput": 2968586.139, "learn_time_ms": 965.59, "learn_throughput": 45485.122, "synch_weights_time_ms": 0.83}, "counters": {"num_env_steps_sampled": 7001520, "num_env_steps_trained": 7001520, "num_agent_steps_sampled": 7001520, "num_agent_steps_trained": 7001520}, "done": false, "episodes_total": 1350, "training_iteration": 471, "trial_id": "4d6b1_00000", "date": "2023-08-03_16-06-33", "timestamp": 1691067993, "time_this_iter_s": 44.77183723449707, "time_total_s": 11645.134120225906, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 6977.589362382889, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 19.535937499999996, "ram_util_percent": 62.415625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1742.7925000427067, "policy_loss": -7.259029403183268e+20, "vf_loss": 304656581.4285714}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 90209.5, "diff_num_grad_updates_vs_sampler_policy": 90208.5}}, "num_env_steps_sampled": 7045440, "num_env_steps_trained": 7045440, "num_agent_steps_sampled": 7045440, "num_agent_steps_trained": 7045440}, "sampler_results": {"episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352562.2247686975, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235, -1351507.3766842408, -1352743.768744965, -1356350.681972289, -1351554.8893488187, -1351679.6970093274, -1352017.542324443, -1349680.1210062886, -1350159.1944048286, -1354210.1109647385, -1353694.987187547, -1352927.3918354292, -1354713.8643596715, -1350205.5348955018, -1355498.798447667], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2061408147585508, "mean_inference_ms": 0.35374979667491774, "mean_action_processing_ms": 0.08733791642821663, "mean_env_wait_ms": 0.6499734984760959, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002991199493408203, "StateBufferConnector_ms": 0.002130270004272461, "ViewRequirementAgentConnector_ms": 0.05539965629577637}}, "episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352562.2247686975, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1356134.8118188963, -1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235, -1351507.3766842408, -1352743.768744965, -1356350.681972289, -1351554.8893488187, -1351679.6970093274, -1352017.542324443, -1349680.1210062886, -1350159.1944048286, -1354210.1109647385, -1353694.987187547, -1352927.3918354292, -1354713.8643596715, -1350205.5348955018, -1355498.798447667], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2061408147585508, "mean_inference_ms": 0.35374979667491774, "mean_action_processing_ms": 0.08733791642821663, "mean_env_wait_ms": 0.6499734984760959, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002991199493408203, "StateBufferConnector_ms": 0.002130270004272461, "ViewRequirementAgentConnector_ms": 0.05539965629577637}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7045440, "num_agent_steps_trained": 7045440, "num_env_steps_sampled": 7045440, "num_env_steps_trained": 7045440, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 976.9254265080933, "num_env_steps_trained_throughput_per_sec": 976.9254265080933, "timesteps_total": 7045440, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7045440, "timers": {"training_iteration_time_ms": 44894.515, "sample_time_ms": 43905.94, "load_time_ms": 14.832, "load_throughput": 2961222.975, "learn_time_ms": 972.771, "learn_throughput": 45149.393, "synch_weights_time_ms": 0.821}, "counters": {"num_env_steps_sampled": 7045440, "num_env_steps_trained": 7045440, "num_agent_steps_sampled": 7045440, "num_agent_steps_trained": 7045440}, "done": false, "episodes_total": 1351, "training_iteration": 472, "trial_id": "4d6b1_00000", "date": "2023-08-03_16-07-18", "timestamp": 1691068038, "time_this_iter_s": 44.96063470840454, "time_total_s": 11690.094754934311, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7022.549997091293, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 17.85714285714286, "ram_util_percent": 62.17777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1742.9644035139167, "policy_loss": -7.351305165266535e+20, "vf_loss": 304049186.24489796}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 90895.5, "diff_num_grad_updates_vs_sampler_policy": 90894.5}}, "num_env_steps_sampled": 7089360, "num_env_steps_trained": 7089360, "num_agent_steps_sampled": 7089360, "num_agent_steps_trained": 7089360}, "sampler_results": {"episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352543.2613593293, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235, -1351507.3766842408, -1352743.768744965, -1356350.681972289, -1351554.8893488187, -1351679.6970093274, -1352017.542324443, -1349680.1210062886, -1350159.1944048286, -1354210.1109647385, -1353694.987187547, -1352927.3918354292, -1354713.8643596715, -1350205.5348955018, -1355498.798447667, -1354238.4708820614], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2058137919134239, "mean_inference_ms": 0.3531990673576363, "mean_action_processing_ms": 0.08720074666983393, "mean_env_wait_ms": 0.6490203073187114, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029823780059814453, "StateBufferConnector_ms": 0.0021173954010009766, "ViewRequirementAgentConnector_ms": 0.05520367622375488}}, "episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352543.2613593293, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1352832.4192734186, -1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235, -1351507.3766842408, -1352743.768744965, -1356350.681972289, -1351554.8893488187, -1351679.6970093274, -1352017.542324443, -1349680.1210062886, -1350159.1944048286, -1354210.1109647385, -1353694.987187547, -1352927.3918354292, -1354713.8643596715, -1350205.5348955018, -1355498.798447667, -1354238.4708820614], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2058137919134239, "mean_inference_ms": 0.3531990673576363, "mean_action_processing_ms": 0.08720074666983393, "mean_env_wait_ms": 0.6490203073187114, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029823780059814453, "StateBufferConnector_ms": 0.0021173954010009766, "ViewRequirementAgentConnector_ms": 0.05520367622375488}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7089360, "num_agent_steps_trained": 7089360, "num_env_steps_sampled": 7089360, "num_env_steps_trained": 7089360, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 987.165521868391, "num_env_steps_trained_throughput_per_sec": 987.165521868391, "timesteps_total": 7089360, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7089360, "timers": {"training_iteration_time_ms": 44936.826, "sample_time_ms": 43948.266, "load_time_ms": 14.848, "load_throughput": 2958070.36, "learn_time_ms": 972.745, "learn_throughput": 45150.599, "synch_weights_time_ms": 0.815}, "counters": {"num_env_steps_sampled": 7089360, "num_env_steps_trained": 7089360, "num_agent_steps_sampled": 7089360, "num_agent_steps_trained": 7089360}, "done": false, "episodes_total": 1352, "training_iteration": 473, "trial_id": "4d6b1_00000", "date": "2023-08-03_16-08-02", "timestamp": 1691068082, "time_this_iter_s": 44.493569135665894, "time_total_s": 11734.588324069977, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7067.043566226959, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 16.993650793650797, "ram_util_percent": 62.21746031746032}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1743.0773023599786, "policy_loss": -7.463445922517016e+20, "vf_loss": 303825396.40233237}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 91581.5, "diff_num_grad_updates_vs_sampler_policy": 91580.5}}, "num_env_steps_sampled": 7133280, "num_env_steps_trained": 7133280, "num_agent_steps_sampled": 7133280, "num_agent_steps_trained": 7133280}, "sampler_results": {"episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352550.27106177, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235, -1351507.3766842408, -1352743.768744965, -1356350.681972289, -1351554.8893488187, -1351679.6970093274, -1352017.542324443, -1349680.1210062886, -1350159.1944048286, -1354210.1109647385, -1353694.987187547, -1352927.3918354292, -1354713.8643596715, -1350205.5348955018, -1355498.798447667, -1354238.4708820614, -1353533.3895175112], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20548472155088063, "mean_inference_ms": 0.352645297689714, "mean_action_processing_ms": 0.0870627444454136, "mean_env_wait_ms": 0.6480610267222096, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029730796813964844, "StateBufferConnector_ms": 0.0021123886108398438, "ViewRequirementAgentConnector_ms": 0.05502605438232422}}, "episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352550.27106177, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1350781.436838167, -1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235, -1351507.3766842408, -1352743.768744965, -1356350.681972289, -1351554.8893488187, -1351679.6970093274, -1352017.542324443, -1349680.1210062886, -1350159.1944048286, -1354210.1109647385, -1353694.987187547, -1352927.3918354292, -1354713.8643596715, -1350205.5348955018, -1355498.798447667, -1354238.4708820614, -1353533.3895175112], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20548472155088063, "mean_inference_ms": 0.352645297689714, "mean_action_processing_ms": 0.0870627444454136, "mean_env_wait_ms": 0.6480610267222096, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029730796813964844, "StateBufferConnector_ms": 0.0021123886108398438, "ViewRequirementAgentConnector_ms": 0.05502605438232422}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7133280, "num_agent_steps_trained": 7133280, "num_env_steps_sampled": 7133280, "num_env_steps_trained": 7133280, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 994.6913049654058, "num_env_steps_trained_throughput_per_sec": 994.6913049654058, "timesteps_total": 7133280, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7133280, "timers": {"training_iteration_time_ms": 44985.81, "sample_time_ms": 43991.41, "load_time_ms": 14.985, "load_throughput": 2930905.071, "learn_time_ms": 978.442, "learn_throughput": 44887.682, "synch_weights_time_ms": 0.819}, "counters": {"num_env_steps_sampled": 7133280, "num_env_steps_trained": 7133280, "num_agent_steps_sampled": 7133280, "num_agent_steps_trained": 7133280}, "done": false, "episodes_total": 1353, "training_iteration": 474, "trial_id": "4d6b1_00000", "date": "2023-08-03_16-08-46", "timestamp": 1691068126, "time_this_iter_s": 44.15713405609131, "time_total_s": 11778.745458126068, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7111.2007002830505, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 18.099999999999994, "ram_util_percent": 62.10634920634921}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1743.2166609249728, "policy_loss": -7.296382925889837e+20, "vf_loss": 304387615.5510204}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 92267.5, "diff_num_grad_updates_vs_sampler_policy": 92266.5}}, "num_env_steps_sampled": 7177200, "num_env_steps_trained": 7177200, "num_agent_steps_sampled": 7177200, "num_agent_steps_trained": 7177200}, "sampler_results": {"episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352590.2700684727, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235, -1351507.3766842408, -1352743.768744965, -1356350.681972289, -1351554.8893488187, -1351679.6970093274, -1352017.542324443, -1349680.1210062886, -1350159.1944048286, -1354210.1109647385, -1353694.987187547, -1352927.3918354292, -1354713.8643596715, -1350205.5348955018, -1355498.798447667, -1354238.4708820614, -1353533.3895175112, -1354781.3375084153], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2051543814317973, "mean_inference_ms": 0.35208974058098497, "mean_action_processing_ms": 0.08692418873433079, "mean_env_wait_ms": 0.6470964948996667, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002969503402709961, "StateBufferConnector_ms": 0.0021049976348876953, "ViewRequirementAgentConnector_ms": 0.05488443374633789}}, "episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352590.2700684727, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1354122.7999581613, -1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235, -1351507.3766842408, -1352743.768744965, -1356350.681972289, -1351554.8893488187, -1351679.6970093274, -1352017.542324443, -1349680.1210062886, -1350159.1944048286, -1354210.1109647385, -1353694.987187547, -1352927.3918354292, -1354713.8643596715, -1350205.5348955018, -1355498.798447667, -1354238.4708820614, -1353533.3895175112, -1354781.3375084153], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2051543814317973, "mean_inference_ms": 0.35208974058098497, "mean_action_processing_ms": 0.08692418873433079, "mean_env_wait_ms": 0.6470964948996667, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002969503402709961, "StateBufferConnector_ms": 0.0021049976348876953, "ViewRequirementAgentConnector_ms": 0.05488443374633789}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7177200, "num_agent_steps_trained": 7177200, "num_env_steps_sampled": 7177200, "num_env_steps_trained": 7177200, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 956.8575343304523, "num_env_steps_trained_throughput_per_sec": 956.8575343304523, "timesteps_total": 7177200, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7177200, "timers": {"training_iteration_time_ms": 45215.811, "sample_time_ms": 44223.418, "load_time_ms": 14.931, "load_throughput": 2941481.867, "learn_time_ms": 976.49, "learn_throughput": 44977.431, "synch_weights_time_ms": 0.819}, "counters": {"num_env_steps_sampled": 7177200, "num_env_steps_trained": 7177200, "num_agent_steps_sampled": 7177200, "num_agent_steps_trained": 7177200}, "done": false, "episodes_total": 1354, "training_iteration": 475, "trial_id": "4d6b1_00000", "date": "2023-08-03_16-09-32", "timestamp": 1691068172, "time_this_iter_s": 45.902827978134155, "time_total_s": 11824.648286104202, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7157.103528261185, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 20.227692307692312, "ram_util_percent": 62.09538461538461}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1743.3775462158915, "policy_loss": -7.228501244437076e+20, "vf_loss": 303463462.20408165}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 92953.5, "diff_num_grad_updates_vs_sampler_policy": 92952.5}}, "num_env_steps_sampled": 7221120, "num_env_steps_trained": 7221120, "num_agent_steps_sampled": 7221120, "num_agent_steps_trained": 7221120}, "sampler_results": {"episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352577.6172460688, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235, -1351507.3766842408, -1352743.768744965, -1356350.681972289, -1351554.8893488187, -1351679.6970093274, -1352017.542324443, -1349680.1210062886, -1350159.1944048286, -1354210.1109647385, -1353694.987187547, -1352927.3918354292, -1354713.8643596715, -1350205.5348955018, -1355498.798447667, -1354238.4708820614, -1353533.3895175112, -1354781.3375084153, -1352857.5177177642], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20482468177936106, "mean_inference_ms": 0.3515332266826032, "mean_action_processing_ms": 0.08678529734387601, "mean_env_wait_ms": 0.646127596068282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029647350311279297, "StateBufferConnector_ms": 0.0020923614501953125, "ViewRequirementAgentConnector_ms": 0.05475139617919922}}, "episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352577.6172460688, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1349229.1694168285, -1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235, -1351507.3766842408, -1352743.768744965, -1356350.681972289, -1351554.8893488187, -1351679.6970093274, -1352017.542324443, -1349680.1210062886, -1350159.1944048286, -1354210.1109647385, -1353694.987187547, -1352927.3918354292, -1354713.8643596715, -1350205.5348955018, -1355498.798447667, -1354238.4708820614, -1353533.3895175112, -1354781.3375084153, -1352857.5177177642], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20482468177936106, "mean_inference_ms": 0.3515332266826032, "mean_action_processing_ms": 0.08678529734387601, "mean_env_wait_ms": 0.646127596068282, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029647350311279297, "StateBufferConnector_ms": 0.0020923614501953125, "ViewRequirementAgentConnector_ms": 0.05475139617919922}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7221120, "num_agent_steps_trained": 7221120, "num_env_steps_sampled": 7221120, "num_env_steps_trained": 7221120, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 909.9634458279515, "num_env_steps_trained_throughput_per_sec": 909.9634458279515, "timesteps_total": 7221120, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7221120, "timers": {"training_iteration_time_ms": 45596.883, "sample_time_ms": 44598.003, "load_time_ms": 15.006, "load_throughput": 2926895.574, "learn_time_ms": 982.9, "learn_throughput": 44684.11, "synch_weights_time_ms": 0.821}, "counters": {"num_env_steps_sampled": 7221120, "num_env_steps_trained": 7221120, "num_agent_steps_sampled": 7221120, "num_agent_steps_trained": 7221120}, "done": false, "episodes_total": 1355, "training_iteration": 476, "trial_id": "4d6b1_00000", "date": "2023-08-03_16-10-21", "timestamp": 1691068221, "time_this_iter_s": 48.26827073097229, "time_total_s": 11872.916556835175, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7205.371798992157, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 17.60588235294117, "ram_util_percent": 62.26911764705883}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1743.4638696787308, "policy_loss": -6.658474711872828e+20, "vf_loss": 303786456.93877554}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 93639.5, "diff_num_grad_updates_vs_sampler_policy": 93638.5}}, "num_env_steps_sampled": 7265040, "num_env_steps_trained": 7265040, "num_agent_steps_sampled": 7265040, "num_agent_steps_trained": 7265040}, "sampler_results": {"episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352621.2813189768, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235, -1351507.3766842408, -1352743.768744965, -1356350.681972289, -1351554.8893488187, -1351679.6970093274, -1352017.542324443, -1349680.1210062886, -1350159.1944048286, -1354210.1109647385, -1353694.987187547, -1352927.3918354292, -1354713.8643596715, -1350205.5348955018, -1355498.798447667, -1354238.4708820614, -1353533.3895175112, -1354781.3375084153, -1352857.5177177642, -1353595.5767076404], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2044938462837132, "mean_inference_ms": 0.35097592398376426, "mean_action_processing_ms": 0.08664607942374204, "mean_env_wait_ms": 0.6451581425998881, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029544830322265625, "StateBufferConnector_ms": 0.0020847320556640625, "ViewRequirementAgentConnector_ms": 0.05460476875305176}}, "episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352621.2813189768, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1351569.2390969165, -1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235, -1351507.3766842408, -1352743.768744965, -1356350.681972289, -1351554.8893488187, -1351679.6970093274, -1352017.542324443, -1349680.1210062886, -1350159.1944048286, -1354210.1109647385, -1353694.987187547, -1352927.3918354292, -1354713.8643596715, -1350205.5348955018, -1355498.798447667, -1354238.4708820614, -1353533.3895175112, -1354781.3375084153, -1352857.5177177642, -1353595.5767076404], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2044938462837132, "mean_inference_ms": 0.35097592398376426, "mean_action_processing_ms": 0.08664607942374204, "mean_env_wait_ms": 0.6451581425998881, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029544830322265625, "StateBufferConnector_ms": 0.0020847320556640625, "ViewRequirementAgentConnector_ms": 0.05460476875305176}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7265040, "num_agent_steps_trained": 7265040, "num_env_steps_sampled": 7265040, "num_env_steps_trained": 7265040, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 916.3218506664119, "num_env_steps_trained_throughput_per_sec": 916.3218506664119, "timesteps_total": 7265040, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7265040, "timers": {"training_iteration_time_ms": 45898.45, "sample_time_ms": 44898.066, "load_time_ms": 15.154, "load_throughput": 2898175.509, "learn_time_ms": 984.247, "learn_throughput": 44622.963, "synch_weights_time_ms": 0.83}, "counters": {"num_env_steps_sampled": 7265040, "num_env_steps_trained": 7265040, "num_agent_steps_sampled": 7265040, "num_agent_steps_trained": 7265040}, "done": false, "episodes_total": 1356, "training_iteration": 477, "trial_id": "4d6b1_00000", "date": "2023-08-03_16-11-09", "timestamp": 1691068269, "time_this_iter_s": 47.93333721160889, "time_total_s": 11920.849894046783, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7253.305136203766, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 17.825000000000003, "ram_util_percent": 62.30441176470587}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1743.6073268523369, "policy_loss": -7.319644104256283e+20, "vf_loss": 302945897.090379}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 94325.5, "diff_num_grad_updates_vs_sampler_policy": 94324.5}}, "num_env_steps_sampled": 7308960, "num_env_steps_trained": 7308960, "num_agent_steps_sampled": 7308960, "num_agent_steps_trained": 7308960}, "sampler_results": {"episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352622.7783771052, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235, -1351507.3766842408, -1352743.768744965, -1356350.681972289, -1351554.8893488187, -1351679.6970093274, -1352017.542324443, -1349680.1210062886, -1350159.1944048286, -1354210.1109647385, -1353694.987187547, -1352927.3918354292, -1354713.8643596715, -1350205.5348955018, -1355498.798447667, -1354238.4708820614, -1353533.3895175112, -1354781.3375084153, -1352857.5177177642, -1353595.5767076404, -1351718.944909769], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20416128281415602, "mean_inference_ms": 0.3504161494797691, "mean_action_processing_ms": 0.08650614304257864, "mean_env_wait_ms": 0.6441823787154455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029468536376953125, "StateBufferConnector_ms": 0.0020749568939208984, "ViewRequirementAgentConnector_ms": 0.05443096160888672}}, "episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352622.7783771052, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1352016.833775755, -1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235, -1351507.3766842408, -1352743.768744965, -1356350.681972289, -1351554.8893488187, -1351679.6970093274, -1352017.542324443, -1349680.1210062886, -1350159.1944048286, -1354210.1109647385, -1353694.987187547, -1352927.3918354292, -1354713.8643596715, -1350205.5348955018, -1355498.798447667, -1354238.4708820614, -1353533.3895175112, -1354781.3375084153, -1352857.5177177642, -1353595.5767076404, -1351718.944909769], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20416128281415602, "mean_inference_ms": 0.3504161494797691, "mean_action_processing_ms": 0.08650614304257864, "mean_env_wait_ms": 0.6441823787154455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029468536376953125, "StateBufferConnector_ms": 0.0020749568939208984, "ViewRequirementAgentConnector_ms": 0.05443096160888672}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7308960, "num_agent_steps_trained": 7308960, "num_env_steps_sampled": 7308960, "num_env_steps_trained": 7308960, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 983.1491321139489, "num_env_steps_trained_throughput_per_sec": 983.1491321139489, "timesteps_total": 7308960, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7308960, "timers": {"training_iteration_time_ms": 45780.335, "sample_time_ms": 44831.459, "load_time_ms": 14.754, "load_throughput": 2976750.636, "learn_time_ms": 933.169, "learn_throughput": 47065.425, "synch_weights_time_ms": 0.806}, "counters": {"num_env_steps_sampled": 7308960, "num_env_steps_trained": 7308960, "num_agent_steps_sampled": 7308960, "num_agent_steps_trained": 7308960}, "done": false, "episodes_total": 1357, "training_iteration": 478, "trial_id": "4d6b1_00000", "date": "2023-08-03_16-11-53", "timestamp": 1691068313, "time_this_iter_s": 44.675265073776245, "time_total_s": 11965.52515912056, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7297.980401277542, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 17.085714285714282, "ram_util_percent": 62.36349206349206}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1743.7313125654837, "policy_loss": -7.483067938499879e+20, "vf_loss": 304119566.20991254}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 95011.5, "diff_num_grad_updates_vs_sampler_policy": 95010.5}}, "num_env_steps_sampled": 7352880, "num_env_steps_trained": 7352880, "num_agent_steps_sampled": 7352880, "num_agent_steps_trained": 7352880}, "sampler_results": {"episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352644.7297301497, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235, -1351507.3766842408, -1352743.768744965, -1356350.681972289, -1351554.8893488187, -1351679.6970093274, -1352017.542324443, -1349680.1210062886, -1350159.1944048286, -1354210.1109647385, -1353694.987187547, -1352927.3918354292, -1354713.8643596715, -1350205.5348955018, -1355498.798447667, -1354238.4708820614, -1353533.3895175112, -1354781.3375084153, -1352857.5177177642, -1353595.5767076404, -1351718.944909769, -1354211.969080204], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20382662886049474, "mean_inference_ms": 0.3498527697903815, "mean_action_processing_ms": 0.0863653431926197, "mean_env_wait_ms": 0.6432002560707286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029375553131103516, "StateBufferConnector_ms": 0.002069711685180664, "ViewRequirementAgentConnector_ms": 0.0541994571685791}}, "episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352644.7297301497, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1349780.5965853212, -1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235, -1351507.3766842408, -1352743.768744965, -1356350.681972289, -1351554.8893488187, -1351679.6970093274, -1352017.542324443, -1349680.1210062886, -1350159.1944048286, -1354210.1109647385, -1353694.987187547, -1352927.3918354292, -1354713.8643596715, -1350205.5348955018, -1355498.798447667, -1354238.4708820614, -1353533.3895175112, -1354781.3375084153, -1352857.5177177642, -1353595.5767076404, -1351718.944909769, -1354211.969080204], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20382662886049474, "mean_inference_ms": 0.3498527697903815, "mean_action_processing_ms": 0.0863653431926197, "mean_env_wait_ms": 0.6432002560707286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029375553131103516, "StateBufferConnector_ms": 0.002069711685180664, "ViewRequirementAgentConnector_ms": 0.0541994571685791}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7352880, "num_agent_steps_trained": 7352880, "num_env_steps_sampled": 7352880, "num_env_steps_trained": 7352880, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1005.6407717343269, "num_env_steps_trained_throughput_per_sec": 1005.6407717343269, "timesteps_total": 7352880, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7352880, "timers": {"training_iteration_time_ms": 45466.589, "sample_time_ms": 44572.788, "load_time_ms": 14.205, "load_throughput": 3091800.993, "learn_time_ms": 878.671, "learn_throughput": 49984.584, "synch_weights_time_ms": 0.786}, "counters": {"num_env_steps_sampled": 7352880, "num_env_steps_trained": 7352880, "num_agent_steps_sampled": 7352880, "num_agent_steps_trained": 7352880}, "done": false, "episodes_total": 1358, "training_iteration": 479, "trial_id": "4d6b1_00000", "date": "2023-08-03_16-12-37", "timestamp": 1691068357, "time_this_iter_s": 43.675968170166016, "time_total_s": 12009.201127290726, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7341.656369447708, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 17.991935483870968, "ram_util_percent": 62.59032258064516}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1743.8927578495125, "policy_loss": -7.168674731815153e+20, "vf_loss": 302596309.02040815}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 95697.5, "diff_num_grad_updates_vs_sampler_policy": 95696.5}}, "num_env_steps_sampled": 7396800, "num_env_steps_trained": 7396800, "num_agent_steps_sampled": 7396800, "num_agent_steps_trained": 7396800}, "sampler_results": {"episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352655.3378455525, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235, -1351507.3766842408, -1352743.768744965, -1356350.681972289, -1351554.8893488187, -1351679.6970093274, -1352017.542324443, -1349680.1210062886, -1350159.1944048286, -1354210.1109647385, -1353694.987187547, -1352927.3918354292, -1354713.8643596715, -1350205.5348955018, -1355498.798447667, -1354238.4708820614, -1353533.3895175112, -1354781.3375084153, -1352857.5177177642, -1353595.5767076404, -1351718.944909769, -1354211.969080204, -1350841.4081255856], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2034900516517392, "mean_inference_ms": 0.3492864764426597, "mean_action_processing_ms": 0.08622372674928673, "mean_env_wait_ms": 0.642213303539285, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029294490814208984, "StateBufferConnector_ms": 0.002064228057861328, "ViewRequirementAgentConnector_ms": 0.05401110649108887}}, "episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352655.3378455525, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1353077.0638286101, -1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235, -1351507.3766842408, -1352743.768744965, -1356350.681972289, -1351554.8893488187, -1351679.6970093274, -1352017.542324443, -1349680.1210062886, -1350159.1944048286, -1354210.1109647385, -1353694.987187547, -1352927.3918354292, -1354713.8643596715, -1350205.5348955018, -1355498.798447667, -1354238.4708820614, -1353533.3895175112, -1354781.3375084153, -1352857.5177177642, -1353595.5767076404, -1351718.944909769, -1354211.969080204, -1350841.4081255856], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2034900516517392, "mean_inference_ms": 0.3492864764426597, "mean_action_processing_ms": 0.08622372674928673, "mean_env_wait_ms": 0.642213303539285, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029294490814208984, "StateBufferConnector_ms": 0.002064228057861328, "ViewRequirementAgentConnector_ms": 0.05401110649108887}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7396800, "num_agent_steps_trained": 7396800, "num_env_steps_sampled": 7396800, "num_env_steps_trained": 7396800, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 1004.5041412699655, "num_env_steps_trained_throughput_per_sec": 1004.5041412699655, "timesteps_total": 7396800, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7396800, "timers": {"training_iteration_time_ms": 45253.799, "sample_time_ms": 44357.587, "load_time_ms": 14.261, "load_throughput": 3079623.379, "learn_time_ms": 881.027, "learn_throughput": 49850.926, "synch_weights_time_ms": 0.785}, "counters": {"num_env_steps_sampled": 7396800, "num_env_steps_trained": 7396800, "num_agent_steps_sampled": 7396800, "num_agent_steps_trained": 7396800}, "done": false, "episodes_total": 1359, "training_iteration": 480, "trial_id": "4d6b1_00000", "date": "2023-08-03_16-13-21", "timestamp": 1691068401, "time_this_iter_s": 43.725645780563354, "time_total_s": 12052.926773071289, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7385.3820152282715, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 17.79193548387097, "ram_util_percent": 62.667741935483875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1744.0316776019838, "policy_loss": -7.138027361017256e+20, "vf_loss": 303188848.97376096}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 96383.5, "diff_num_grad_updates_vs_sampler_policy": 96382.5}}, "num_env_steps_sampled": 7440720, "num_env_steps_trained": 7440720, "num_agent_steps_sampled": 7440720, "num_agent_steps_trained": 7440720}, "sampler_results": {"episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352646.3240938357, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235, -1351507.3766842408, -1352743.768744965, -1356350.681972289, -1351554.8893488187, -1351679.6970093274, -1352017.542324443, -1349680.1210062886, -1350159.1944048286, -1354210.1109647385, -1353694.987187547, -1352927.3918354292, -1354713.8643596715, -1350205.5348955018, -1355498.798447667, -1354238.4708820614, -1353533.3895175112, -1354781.3375084153, -1352857.5177177642, -1353595.5767076404, -1351718.944909769, -1354211.969080204, -1350841.4081255856, -1352175.6886569306], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2031524357713198, "mean_inference_ms": 0.3487182322701341, "mean_action_processing_ms": 0.08608156511521826, "mean_env_wait_ms": 0.6412211054843607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029213428497314453, "StateBufferConnector_ms": 0.0020585060119628906, "ViewRequirementAgentConnector_ms": 0.05386972427368164}}, "episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352646.3240938357, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1348824.500846908, -1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235, -1351507.3766842408, -1352743.768744965, -1356350.681972289, -1351554.8893488187, -1351679.6970093274, -1352017.542324443, -1349680.1210062886, -1350159.1944048286, -1354210.1109647385, -1353694.987187547, -1352927.3918354292, -1354713.8643596715, -1350205.5348955018, -1355498.798447667, -1354238.4708820614, -1353533.3895175112, -1354781.3375084153, -1352857.5177177642, -1353595.5767076404, -1351718.944909769, -1354211.969080204, -1350841.4081255856, -1352175.6886569306], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2031524357713198, "mean_inference_ms": 0.3487182322701341, "mean_action_processing_ms": 0.08608156511521826, "mean_env_wait_ms": 0.6412211054843607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029213428497314453, "StateBufferConnector_ms": 0.0020585060119628906, "ViewRequirementAgentConnector_ms": 0.05386972427368164}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7440720, "num_agent_steps_trained": 7440720, "num_env_steps_sampled": 7440720, "num_env_steps_trained": 7440720, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 953.9134526490727, "num_env_steps_trained_throughput_per_sec": 953.9134526490727, "timesteps_total": 7440720, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7440720, "timers": {"training_iteration_time_ms": 45381.07, "sample_time_ms": 44481.071, "load_time_ms": 14.272, "load_throughput": 3077359.745, "learn_time_ms": 884.803, "learn_throughput": 49638.186, "synch_weights_time_ms": 0.786}, "counters": {"num_env_steps_sampled": 7440720, "num_env_steps_trained": 7440720, "num_agent_steps_sampled": 7440720, "num_agent_steps_trained": 7440720}, "done": false, "episodes_total": 1360, "training_iteration": 481, "trial_id": "4d6b1_00000", "date": "2023-08-03_16-14-07", "timestamp": 1691068447, "time_this_iter_s": 46.04446291923523, "time_total_s": 12098.971235990524, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7431.426478147507, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 18.64, "ram_util_percent": 62.510769230769235}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1744.1224872377802, "policy_loss": -7.163793951892043e+20, "vf_loss": 304550317.6676385}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 97069.5, "diff_num_grad_updates_vs_sampler_policy": 97068.5}}, "num_env_steps_sampled": 7484640, "num_env_steps_trained": 7484640, "num_agent_steps_sampled": 7484640, "num_agent_steps_trained": 7484640}, "sampler_results": {"episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352708.8058658522, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235, -1351507.3766842408, -1352743.768744965, -1356350.681972289, -1351554.8893488187, -1351679.6970093274, -1352017.542324443, -1349680.1210062886, -1350159.1944048286, -1354210.1109647385, -1353694.987187547, -1352927.3918354292, -1354713.8643596715, -1350205.5348955018, -1355498.798447667, -1354238.4708820614, -1353533.3895175112, -1354781.3375084153, -1352857.5177177642, -1353595.5767076404, -1351718.944909769, -1354211.969080204, -1350841.4081255856, -1352175.6886569306, -1355072.6780485667], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2028150613876309, "mean_inference_ms": 0.34814930735918787, "mean_action_processing_ms": 0.08593910184370113, "mean_env_wait_ms": 0.6402272667821243, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002916574478149414, "StateBufferConnector_ms": 0.0020558834075927734, "ViewRequirementAgentConnector_ms": 0.053748130798339844}}, "episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352708.8058658522, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1353580.0656092737, -1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235, -1351507.3766842408, -1352743.768744965, -1356350.681972289, -1351554.8893488187, -1351679.6970093274, -1352017.542324443, -1349680.1210062886, -1350159.1944048286, -1354210.1109647385, -1353694.987187547, -1352927.3918354292, -1354713.8643596715, -1350205.5348955018, -1355498.798447667, -1354238.4708820614, -1353533.3895175112, -1354781.3375084153, -1352857.5177177642, -1353595.5767076404, -1351718.944909769, -1354211.969080204, -1350841.4081255856, -1352175.6886569306, -1355072.6780485667], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2028150613876309, "mean_inference_ms": 0.34814930735918787, "mean_action_processing_ms": 0.08593910184370113, "mean_env_wait_ms": 0.6402272667821243, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002916574478149414, "StateBufferConnector_ms": 0.0020558834075927734, "ViewRequirementAgentConnector_ms": 0.053748130798339844}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7484640, "num_agent_steps_trained": 7484640, "num_env_steps_sampled": 7484640, "num_env_steps_trained": 7484640, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 911.6462460538505, "num_env_steps_trained_throughput_per_sec": 911.6462460538505, "timesteps_total": 7484640, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7484640, "timers": {"training_iteration_time_ms": 45702.99, "sample_time_ms": 44799.784, "load_time_ms": 14.546, "load_throughput": 3019389.049, "learn_time_ms": 887.726, "learn_throughput": 49474.727, "synch_weights_time_ms": 0.799}, "counters": {"num_env_steps_sampled": 7484640, "num_env_steps_trained": 7484640, "num_agent_steps_sampled": 7484640, "num_agent_steps_trained": 7484640}, "done": false, "episodes_total": 1361, "training_iteration": 482, "trial_id": "4d6b1_00000", "date": "2023-08-03_16-14-55", "timestamp": 1691068495, "time_this_iter_s": 48.179388761520386, "time_total_s": 12147.150624752045, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7479.605866909027, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 17.61176470588235, "ram_util_percent": 62.530882352941184}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1744.267906077749, "policy_loss": -7.15376333371598e+20, "vf_loss": 302094132.7113703}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 97755.5, "diff_num_grad_updates_vs_sampler_policy": 97754.5}}, "num_env_steps_sampled": 7528560, "num_env_steps_trained": 7528560, "num_agent_steps_sampled": 7528560, "num_agent_steps_trained": 7528560}, "sampler_results": {"episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352671.446136278, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235, -1351507.3766842408, -1352743.768744965, -1356350.681972289, -1351554.8893488187, -1351679.6970093274, -1352017.542324443, -1349680.1210062886, -1350159.1944048286, -1354210.1109647385, -1353694.987187547, -1352927.3918354292, -1354713.8643596715, -1350205.5348955018, -1355498.798447667, -1354238.4708820614, -1353533.3895175112, -1354781.3375084153, -1352857.5177177642, -1353595.5767076404, -1351718.944909769, -1354211.969080204, -1350841.4081255856, -1352175.6886569306, -1355072.6780485667, -1349844.0926519018], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20247705118176337, "mean_inference_ms": 0.3475801411401334, "mean_action_processing_ms": 0.08579642341535036, "mean_env_wait_ms": 0.6392320638816108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029082298278808594, "StateBufferConnector_ms": 0.0020499229431152344, "ViewRequirementAgentConnector_ms": 0.05364680290222168}}, "episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352671.446136278, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1350762.9692213605, -1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235, -1351507.3766842408, -1352743.768744965, -1356350.681972289, -1351554.8893488187, -1351679.6970093274, -1352017.542324443, -1349680.1210062886, -1350159.1944048286, -1354210.1109647385, -1353694.987187547, -1352927.3918354292, -1354713.8643596715, -1350205.5348955018, -1355498.798447667, -1354238.4708820614, -1353533.3895175112, -1354781.3375084153, -1352857.5177177642, -1353595.5767076404, -1351718.944909769, -1354211.969080204, -1350841.4081255856, -1352175.6886569306, -1355072.6780485667, -1349844.0926519018], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20247705118176337, "mean_inference_ms": 0.3475801411401334, "mean_action_processing_ms": 0.08579642341535036, "mean_env_wait_ms": 0.6392320638816108, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0029082298278808594, "StateBufferConnector_ms": 0.0020499229431152344, "ViewRequirementAgentConnector_ms": 0.05364680290222168}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7528560, "num_agent_steps_trained": 7528560, "num_env_steps_sampled": 7528560, "num_env_steps_trained": 7528560, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 887.7975170929395, "num_env_steps_trained_throughput_per_sec": 887.7975170929395, "timesteps_total": 7528560, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7528560, "timers": {"training_iteration_time_ms": 46200.962, "sample_time_ms": 45286.922, "load_time_ms": 14.568, "load_throughput": 3014783.632, "learn_time_ms": 898.534, "learn_throughput": 48879.627, "synch_weights_time_ms": 0.801}, "counters": {"num_env_steps_sampled": 7528560, "num_env_steps_trained": 7528560, "num_agent_steps_sampled": 7528560, "num_agent_steps_trained": 7528560}, "done": false, "episodes_total": 1362, "training_iteration": 483, "trial_id": "4d6b1_00000", "date": "2023-08-03_16-15-45", "timestamp": 1691068545, "time_this_iter_s": 49.473490953445435, "time_total_s": 12196.62411570549, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7529.0793578624725, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 18.10428571428572, "ram_util_percent": 62.622857142857136}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1744.4201375444152, "policy_loss": -7.762967150266114e+20, "vf_loss": 303898510.11078715}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 98441.5, "diff_num_grad_updates_vs_sampler_policy": 98440.5}}, "num_env_steps_sampled": 7572480, "num_env_steps_trained": 7572480, "num_agent_steps_sampled": 7572480, "num_agent_steps_trained": 7572480}, "sampler_results": {"episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352700.9525775271, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235, -1351507.3766842408, -1352743.768744965, -1356350.681972289, -1351554.8893488187, -1351679.6970093274, -1352017.542324443, -1349680.1210062886, -1350159.1944048286, -1354210.1109647385, -1353694.987187547, -1352927.3918354292, -1354713.8643596715, -1350205.5348955018, -1355498.798447667, -1354238.4708820614, -1353533.3895175112, -1354781.3375084153, -1352857.5177177642, -1353595.5767076404, -1351718.944909769, -1354211.969080204, -1350841.4081255856, -1352175.6886569306, -1355072.6780485667, -1349844.0926519018, -1353713.6133462382], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20213910404618946, "mean_inference_ms": 0.34701045340305536, "mean_action_processing_ms": 0.08565351385918825, "mean_env_wait_ms": 0.6382347444850897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002902984619140625, "StateBufferConnector_ms": 0.002048969268798828, "ViewRequirementAgentConnector_ms": 0.05352520942687988}}, "episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352700.9525775271, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1356537.2383041475, -1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235, -1351507.3766842408, -1352743.768744965, -1356350.681972289, -1351554.8893488187, -1351679.6970093274, -1352017.542324443, -1349680.1210062886, -1350159.1944048286, -1354210.1109647385, -1353694.987187547, -1352927.3918354292, -1354713.8643596715, -1350205.5348955018, -1355498.798447667, -1354238.4708820614, -1353533.3895175112, -1354781.3375084153, -1352857.5177177642, -1353595.5767076404, -1351718.944909769, -1354211.969080204, -1350841.4081255856, -1352175.6886569306, -1355072.6780485667, -1349844.0926519018, -1353713.6133462382], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20213910404618946, "mean_inference_ms": 0.34701045340305536, "mean_action_processing_ms": 0.08565351385918825, "mean_env_wait_ms": 0.6382347444850897, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002902984619140625, "StateBufferConnector_ms": 0.002048969268798828, "ViewRequirementAgentConnector_ms": 0.05352520942687988}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7572480, "num_agent_steps_trained": 7572480, "num_env_steps_sampled": 7572480, "num_env_steps_trained": 7572480, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 887.1875031424885, "num_env_steps_trained_throughput_per_sec": 887.1875031424885, "timesteps_total": 7572480, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7572480, "timers": {"training_iteration_time_ms": 46735.998, "sample_time_ms": 45810.67, "load_time_ms": 14.586, "load_throughput": 3011171.419, "learn_time_ms": 909.808, "learn_throughput": 48273.923, "synch_weights_time_ms": 0.798}, "counters": {"num_env_steps_sampled": 7572480, "num_env_steps_trained": 7572480, "num_agent_steps_sampled": 7572480, "num_agent_steps_trained": 7572480}, "done": false, "episodes_total": 1363, "training_iteration": 484, "trial_id": "4d6b1_00000", "date": "2023-08-03_16-16-34", "timestamp": 1691068594, "time_this_iter_s": 49.507447719573975, "time_total_s": 12246.131563425064, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7578.5868055820465, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 18.985915492957748, "ram_util_percent": 62.63239436619717}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1744.5671255039404, "policy_loss": -7.090453067603484e+20, "vf_loss": 303703906.8862974}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 99127.5, "diff_num_grad_updates_vs_sampler_policy": 99126.5}}, "num_env_steps_sampled": 7616400, "num_env_steps_trained": 7616400, "num_agent_steps_sampled": 7616400, "num_agent_steps_trained": 7616400}, "sampler_results": {"episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352668.2100199214, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235, -1351507.3766842408, -1352743.768744965, -1356350.681972289, -1351554.8893488187, -1351679.6970093274, -1352017.542324443, -1349680.1210062886, -1350159.1944048286, -1354210.1109647385, -1353694.987187547, -1352927.3918354292, -1354713.8643596715, -1350205.5348955018, -1355498.798447667, -1354238.4708820614, -1353533.3895175112, -1354781.3375084153, -1352857.5177177642, -1353595.5767076404, -1351718.944909769, -1354211.969080204, -1350841.4081255856, -1352175.6886569306, -1355072.6780485667, -1349844.0926519018, -1353713.6133462382, -1353262.982543569], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2018006111867335, "mean_inference_ms": 0.34644053487051607, "mean_action_processing_ms": 0.08551043205288067, "mean_env_wait_ms": 0.637234708112503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002899169921875, "StateBufferConnector_ms": 0.0020439624786376953, "ViewRequirementAgentConnector_ms": 0.05338311195373535}}, "episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352668.2100199214, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1351847.7986854375, -1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235, -1351507.3766842408, -1352743.768744965, -1356350.681972289, -1351554.8893488187, -1351679.6970093274, -1352017.542324443, -1349680.1210062886, -1350159.1944048286, -1354210.1109647385, -1353694.987187547, -1352927.3918354292, -1354713.8643596715, -1350205.5348955018, -1355498.798447667, -1354238.4708820614, -1353533.3895175112, -1354781.3375084153, -1352857.5177177642, -1353595.5767076404, -1351718.944909769, -1354211.969080204, -1350841.4081255856, -1352175.6886569306, -1355072.6780485667, -1349844.0926519018, -1353713.6133462382, -1353262.982543569], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2018006111867335, "mean_inference_ms": 0.34644053487051607, "mean_action_processing_ms": 0.08551043205288067, "mean_env_wait_ms": 0.637234708112503, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002899169921875, "StateBufferConnector_ms": 0.0020439624786376953, "ViewRequirementAgentConnector_ms": 0.05338311195373535}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7616400, "num_agent_steps_trained": 7616400, "num_env_steps_sampled": 7616400, "num_env_steps_trained": 7616400, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 893.6780339022598, "num_env_steps_trained_throughput_per_sec": 893.6780339022598, "timesteps_total": 7616400, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7616400, "timers": {"training_iteration_time_ms": 47060.494, "sample_time_ms": 46123.949, "load_time_ms": 14.619, "load_throughput": 3004359.936, "learn_time_ms": 920.981, "learn_throughput": 47688.275, "synch_weights_time_ms": 0.805}, "counters": {"num_env_steps_sampled": 7616400, "num_env_steps_trained": 7616400, "num_agent_steps_sampled": 7616400, "num_agent_steps_trained": 7616400}, "done": false, "episodes_total": 1364, "training_iteration": 485, "trial_id": "4d6b1_00000", "date": "2023-08-03_16-17-23", "timestamp": 1691068643, "time_this_iter_s": 49.148488998413086, "time_total_s": 12295.280052423477, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7627.73529458046, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 17.23333333333333, "ram_util_percent": 62.46956521739131}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1744.6830905213649, "policy_loss": -8.020901414072868e+20, "vf_loss": 303088392.06413996}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 99813.5, "diff_num_grad_updates_vs_sampler_policy": 99812.5}}, "num_env_steps_sampled": 7660320, "num_env_steps_trained": 7660320, "num_agent_steps_sampled": 7660320, "num_agent_steps_trained": 7660320}, "sampler_results": {"episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352669.1619326684, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235, -1351507.3766842408, -1352743.768744965, -1356350.681972289, -1351554.8893488187, -1351679.6970093274, -1352017.542324443, -1349680.1210062886, -1350159.1944048286, -1354210.1109647385, -1353694.987187547, -1352927.3918354292, -1354713.8643596715, -1350205.5348955018, -1355498.798447667, -1354238.4708820614, -1353533.3895175112, -1354781.3375084153, -1352857.5177177642, -1353595.5767076404, -1351718.944909769, -1354211.969080204, -1350841.4081255856, -1352175.6886569306, -1355072.6780485667, -1349844.0926519018, -1353713.6133462382, -1353262.982543569, -1351942.989960133], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20146137131774255, "mean_inference_ms": 0.34587005646121033, "mean_action_processing_ms": 0.08536719515065505, "mean_env_wait_ms": 0.6362327923077982, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002889871597290039, "StateBufferConnector_ms": 0.0020389556884765625, "ViewRequirementAgentConnector_ms": 0.05327320098876953}}, "episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352669.1619326684, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1350263.3483671886, -1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235, -1351507.3766842408, -1352743.768744965, -1356350.681972289, -1351554.8893488187, -1351679.6970093274, -1352017.542324443, -1349680.1210062886, -1350159.1944048286, -1354210.1109647385, -1353694.987187547, -1352927.3918354292, -1354713.8643596715, -1350205.5348955018, -1355498.798447667, -1354238.4708820614, -1353533.3895175112, -1354781.3375084153, -1352857.5177177642, -1353595.5767076404, -1351718.944909769, -1354211.969080204, -1350841.4081255856, -1352175.6886569306, -1355072.6780485667, -1349844.0926519018, -1353713.6133462382, -1353262.982543569, -1351942.989960133], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20146137131774255, "mean_inference_ms": 0.34587005646121033, "mean_action_processing_ms": 0.08536719515065505, "mean_env_wait_ms": 0.6362327923077982, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002889871597290039, "StateBufferConnector_ms": 0.0020389556884765625, "ViewRequirementAgentConnector_ms": 0.05327320098876953}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7660320, "num_agent_steps_trained": 7660320, "num_env_steps_sampled": 7660320, "num_env_steps_trained": 7660320, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 887.8150812523307, "num_env_steps_trained_throughput_per_sec": 887.8150812523307, "timesteps_total": 7660320, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7660320, "timers": {"training_iteration_time_ms": 47180.903, "sample_time_ms": 46241.603, "load_time_ms": 14.662, "load_throughput": 2995429.657, "learn_time_ms": 923.701, "learn_throughput": 47547.859, "synch_weights_time_ms": 0.797}, "counters": {"num_env_steps_sampled": 7660320, "num_env_steps_trained": 7660320, "num_agent_steps_sampled": 7660320, "num_agent_steps_trained": 7660320}, "done": false, "episodes_total": 1365, "training_iteration": 486, "trial_id": "4d6b1_00000", "date": "2023-08-03_16-18-13", "timestamp": 1691068693, "time_this_iter_s": 49.47271394729614, "time_total_s": 12344.752766370773, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7677.208008527756, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 17.25857142857143, "ram_util_percent": 62.64}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1744.827275134384, "policy_loss": -7.55871847156709e+20, "vf_loss": 304154752.6297376}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 100499.5, "diff_num_grad_updates_vs_sampler_policy": 100498.5}}, "num_env_steps_sampled": 7704240, "num_env_steps_trained": 7704240, "num_agent_steps_sampled": 7704240, "num_agent_steps_trained": 7704240}, "sampler_results": {"episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352711.2790417855, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235, -1351507.3766842408, -1352743.768744965, -1356350.681972289, -1351554.8893488187, -1351679.6970093274, -1352017.542324443, -1349680.1210062886, -1350159.1944048286, -1354210.1109647385, -1353694.987187547, -1352927.3918354292, -1354713.8643596715, -1350205.5348955018, -1355498.798447667, -1354238.4708820614, -1353533.3895175112, -1354781.3375084153, -1352857.5177177642, -1353595.5767076404, -1351718.944909769, -1354211.969080204, -1350841.4081255856, -1352175.6886569306, -1355072.6780485667, -1349844.0926519018, -1353713.6133462382, -1353262.982543569, -1351942.989960133, -1354475.0592789163], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2011215079890185, "mean_inference_ms": 0.34529905840926206, "mean_action_processing_ms": 0.0852237750451169, "mean_env_wait_ms": 0.6352291076241574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028853416442871094, "StateBufferConnector_ms": 0.002036571502685547, "ViewRequirementAgentConnector_ms": 0.053165435791015625}}, "episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352711.2790417855, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1351711.5904658185, -1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235, -1351507.3766842408, -1352743.768744965, -1356350.681972289, -1351554.8893488187, -1351679.6970093274, -1352017.542324443, -1349680.1210062886, -1350159.1944048286, -1354210.1109647385, -1353694.987187547, -1352927.3918354292, -1354713.8643596715, -1350205.5348955018, -1355498.798447667, -1354238.4708820614, -1353533.3895175112, -1354781.3375084153, -1352857.5177177642, -1353595.5767076404, -1351718.944909769, -1354211.969080204, -1350841.4081255856, -1352175.6886569306, -1355072.6780485667, -1349844.0926519018, -1353713.6133462382, -1353262.982543569, -1351942.989960133, -1354475.0592789163], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2011215079890185, "mean_inference_ms": 0.34529905840926206, "mean_action_processing_ms": 0.0852237750451169, "mean_env_wait_ms": 0.6352291076241574, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028853416442871094, "StateBufferConnector_ms": 0.002036571502685547, "ViewRequirementAgentConnector_ms": 0.053165435791015625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7704240, "num_agent_steps_trained": 7704240, "num_env_steps_sampled": 7704240, "num_env_steps_trained": 7704240, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 896.3611820259445, "num_env_steps_trained_throughput_per_sec": 896.3611820259445, "timesteps_total": 7704240, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7704240, "timers": {"training_iteration_time_ms": 47287.638, "sample_time_ms": 46333.049, "load_time_ms": 14.684, "load_throughput": 2990940.69, "learn_time_ms": 938.968, "learn_throughput": 46774.766, "synch_weights_time_ms": 0.794}, "counters": {"num_env_steps_sampled": 7704240, "num_env_steps_trained": 7704240, "num_agent_steps_sampled": 7704240, "num_agent_steps_trained": 7704240}, "done": false, "episodes_total": 1366, "training_iteration": 487, "trial_id": "4d6b1_00000", "date": "2023-08-03_16-19-02", "timestamp": 1691068742, "time_this_iter_s": 49.000783920288086, "time_total_s": 12393.753550291061, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7726.208792448044, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 17.482857142857142, "ram_util_percent": 62.64}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1744.9336006898575, "policy_loss": -7.100072221547242e+20, "vf_loss": 302087699.6909621}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 101185.5, "diff_num_grad_updates_vs_sampler_policy": 101184.5}}, "num_env_steps_sampled": 7748160, "num_env_steps_trained": 7748160, "num_agent_steps_sampled": 7748160, "num_agent_steps_trained": 7748160}, "sampler_results": {"episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352690.8169943476, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235, -1351507.3766842408, -1352743.768744965, -1356350.681972289, -1351554.8893488187, -1351679.6970093274, -1352017.542324443, -1349680.1210062886, -1350159.1944048286, -1354210.1109647385, -1353694.987187547, -1352927.3918354292, -1354713.8643596715, -1350205.5348955018, -1355498.798447667, -1354238.4708820614, -1353533.3895175112, -1354781.3375084153, -1352857.5177177642, -1353595.5767076404, -1351718.944909769, -1354211.969080204, -1350841.4081255856, -1352175.6886569306, -1355072.6780485667, -1349844.0926519018, -1353713.6133462382, -1353262.982543569, -1351942.989960133, -1354475.0592789163, -1349665.3857220213], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20078084955484898, "mean_inference_ms": 0.3447271570018888, "mean_action_processing_ms": 0.0850800634610416, "mean_env_wait_ms": 0.6342242449162843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002874135971069336, "StateBufferConnector_ms": 0.0020313262939453125, "ViewRequirementAgentConnector_ms": 0.053070068359375}}, "episode_reward_max": -1347503.491812833, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352690.8169943476, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1351497.0334704672, -1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235, -1351507.3766842408, -1352743.768744965, -1356350.681972289, -1351554.8893488187, -1351679.6970093274, -1352017.542324443, -1349680.1210062886, -1350159.1944048286, -1354210.1109647385, -1353694.987187547, -1352927.3918354292, -1354713.8643596715, -1350205.5348955018, -1355498.798447667, -1354238.4708820614, -1353533.3895175112, -1354781.3375084153, -1352857.5177177642, -1353595.5767076404, -1351718.944909769, -1354211.969080204, -1350841.4081255856, -1352175.6886569306, -1355072.6780485667, -1349844.0926519018, -1353713.6133462382, -1353262.982543569, -1351942.989960133, -1354475.0592789163, -1349665.3857220213], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20078084955484898, "mean_inference_ms": 0.3447271570018888, "mean_action_processing_ms": 0.0850800634610416, "mean_env_wait_ms": 0.6342242449162843, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.002874135971069336, "StateBufferConnector_ms": 0.0020313262939453125, "ViewRequirementAgentConnector_ms": 0.053070068359375}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7748160, "num_agent_steps_trained": 7748160, "num_env_steps_sampled": 7748160, "num_env_steps_trained": 7748160, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 907.5858542051814, "num_env_steps_trained_throughput_per_sec": 907.5858542051814, "timesteps_total": 7748160, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7748160, "timers": {"training_iteration_time_ms": 47659.572, "sample_time_ms": 46695.157, "load_time_ms": 14.693, "load_throughput": 2989081.935, "learn_time_ms": 948.781, "learn_throughput": 46290.985, "synch_weights_time_ms": 0.798}, "counters": {"num_env_steps_sampled": 7748160, "num_env_steps_trained": 7748160, "num_agent_steps_sampled": 7748160, "num_agent_steps_trained": 7748160}, "done": false, "episodes_total": 1367, "training_iteration": 488, "trial_id": "4d6b1_00000", "date": "2023-08-03_16-19-50", "timestamp": 1691068790, "time_this_iter_s": 48.39463019371033, "time_total_s": 12442.148180484772, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7774.603422641754, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 17.370588235294118, "ram_util_percent": 62.654411764705884}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1745.0784906771023, "policy_loss": -6.835465436346354e+20, "vf_loss": 300955126.22740525}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 101871.5, "diff_num_grad_updates_vs_sampler_policy": 101870.5}}, "num_env_steps_sampled": 7792080, "num_env_steps_trained": 7792080, "num_agent_steps_sampled": 7792080, "num_agent_steps_trained": 7792080}, "sampler_results": {"episode_reward_max": -1347277.260527122, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352648.6192649144, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235, -1351507.3766842408, -1352743.768744965, -1356350.681972289, -1351554.8893488187, -1351679.6970093274, -1352017.542324443, -1349680.1210062886, -1350159.1944048286, -1354210.1109647385, -1353694.987187547, -1352927.3918354292, -1354713.8643596715, -1350205.5348955018, -1355498.798447667, -1354238.4708820614, -1353533.3895175112, -1354781.3375084153, -1352857.5177177642, -1353595.5767076404, -1351718.944909769, -1354211.969080204, -1350841.4081255856, -1352175.6886569306, -1355072.6780485667, -1349844.0926519018, -1353713.6133462382, -1353262.982543569, -1351942.989960133, -1354475.0592789163, -1349665.3857220213, -1347277.260527122], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20044000114854138, "mean_inference_ms": 0.3441539734216262, "mean_action_processing_ms": 0.0849361540565898, "mean_env_wait_ms": 0.6332171447660743, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028693675994873047, "StateBufferConnector_ms": 0.002031564712524414, "ViewRequirementAgentConnector_ms": 0.05298495292663574}}, "episode_reward_max": -1347277.260527122, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352648.6192649144, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1350156.0044424697, -1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235, -1351507.3766842408, -1352743.768744965, -1356350.681972289, -1351554.8893488187, -1351679.6970093274, -1352017.542324443, -1349680.1210062886, -1350159.1944048286, -1354210.1109647385, -1353694.987187547, -1352927.3918354292, -1354713.8643596715, -1350205.5348955018, -1355498.798447667, -1354238.4708820614, -1353533.3895175112, -1354781.3375084153, -1352857.5177177642, -1353595.5767076404, -1351718.944909769, -1354211.969080204, -1350841.4081255856, -1352175.6886569306, -1355072.6780485667, -1349844.0926519018, -1353713.6133462382, -1353262.982543569, -1351942.989960133, -1354475.0592789163, -1349665.3857220213, -1347277.260527122], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20044000114854138, "mean_inference_ms": 0.3441539734216262, "mean_action_processing_ms": 0.0849361540565898, "mean_env_wait_ms": 0.6332171447660743, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028693675994873047, "StateBufferConnector_ms": 0.002031564712524414, "ViewRequirementAgentConnector_ms": 0.05298495292663574}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7792080, "num_agent_steps_trained": 7792080, "num_env_steps_sampled": 7792080, "num_env_steps_trained": 7792080, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 893.5835948546663, "num_env_steps_trained_throughput_per_sec": 893.5835948546663, "timesteps_total": 7792080, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7792080, "timers": {"training_iteration_time_ms": 48207.249, "sample_time_ms": 47230.139, "load_time_ms": 14.859, "load_throughput": 2955792.11, "learn_time_ms": 961.306, "learn_throughput": 45687.858, "synch_weights_time_ms": 0.799}, "counters": {"num_env_steps_sampled": 7792080, "num_env_steps_trained": 7792080, "num_agent_steps_sampled": 7792080, "num_agent_steps_trained": 7792080}, "done": false, "episodes_total": 1368, "training_iteration": 489, "trial_id": "4d6b1_00000", "date": "2023-08-03_16-20-39", "timestamp": 1691068839, "time_this_iter_s": 49.15302515029907, "time_total_s": 12491.30120563507, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7823.756447792053, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 17.78285714285714, "ram_util_percent": 62.71285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.0000000000000002e-07, "entropy_coeff": 0.049999999999999996, "policy_entropy": -1745.193209901148, "policy_loss": -6.990042193922353e+20, "vf_loss": 301879535.9766764}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 102557.5, "diff_num_grad_updates_vs_sampler_policy": 102556.5}}, "num_env_steps_sampled": 7836000, "num_env_steps_trained": 7836000, "num_agent_steps_sampled": 7836000, "num_agent_steps_trained": 7836000}, "sampler_results": {"episode_reward_max": -1347277.260527122, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352641.322966362, "episode_len_mean": 43920.0, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235, -1351507.3766842408, -1352743.768744965, -1356350.681972289, -1351554.8893488187, -1351679.6970093274, -1352017.542324443, -1349680.1210062886, -1350159.1944048286, -1354210.1109647385, -1353694.987187547, -1352927.3918354292, -1354713.8643596715, -1350205.5348955018, -1355498.798447667, -1354238.4708820614, -1353533.3895175112, -1354781.3375084153, -1352857.5177177642, -1353595.5767076404, -1351718.944909769, -1354211.969080204, -1350841.4081255856, -1352175.6886569306, -1355072.6780485667, -1349844.0926519018, -1353713.6133462382, -1353262.982543569, -1351942.989960133, -1354475.0592789163, -1349665.3857220213, -1347277.260527122, -1349426.374587231], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20009858455036286, "mean_inference_ms": 0.3435801130191063, "mean_action_processing_ms": 0.08479201266939171, "mean_env_wait_ms": 0.6322084308071539, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028676986694335938, "StateBufferConnector_ms": 0.0020275115966796875, "ViewRequirementAgentConnector_ms": 0.052866220474243164}}, "episode_reward_max": -1347277.260527122, "episode_reward_min": -1358008.0831194508, "episode_reward_mean": -1352641.322966362, "episode_len_mean": 43920.0, "episodes_this_iter": 1, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1350377.5342982858, -1350542.8087336302, -1350837.3424913448, -1354250.087647568, -1355965.4367766394, -1353750.7429467726, -1355924.3354087546, -1358008.0831194508, -1356229.458655926, -1352257.955319823, -1349628.4359762557, -1351833.5791379143, -1353434.0461533868, -1353121.7771359417, -1353064.8232876984, -1348371.9765890883, -1347503.491812833, -1353365.783901926, -1354018.1352887603, -1352258.6112312756, -1354924.4627281239, -1351049.3005212727, -1355451.0432132313, -1350752.9860351654, -1350432.0489158782, -1354567.1482374948, -1349086.2972400505, -1351915.0898083413, -1355952.4452610456, -1352654.4926333176, -1355090.959077594, -1353723.715206086, -1350527.6557336885, -1355984.1890633549, -1349743.4296179062, -1349280.3788470863, -1354869.356734561, -1354834.4092652602, -1352436.0551625101, -1349824.1631622221, -1353244.1367439637, -1351883.6098981781, -1351637.2466506916, -1350259.8564088354, -1353523.3567630362, -1353089.1514118016, -1350623.8461486746, -1350524.1472157121, -1353292.5732043497, -1350087.984833971, -1352681.6732393194, -1356538.8835904307, -1352191.8496433145, -1352281.0209918136, -1350129.8767030889, -1354623.9105648869, -1353384.7876354412, -1350120.7957860748, -1356869.6939437434, -1353184.911736693, -1356051.358798814, -1350935.2095876497, -1351969.1736460268, -1354813.9953807003, -1351289.1617327018, -1355619.2337694026, -1354809.8689461465, -1351048.2103259235, -1351507.3766842408, -1352743.768744965, -1356350.681972289, -1351554.8893488187, -1351679.6970093274, -1352017.542324443, -1349680.1210062886, -1350159.1944048286, -1354210.1109647385, -1353694.987187547, -1352927.3918354292, -1354713.8643596715, -1350205.5348955018, -1355498.798447667, -1354238.4708820614, -1353533.3895175112, -1354781.3375084153, -1352857.5177177642, -1353595.5767076404, -1351718.944909769, -1354211.969080204, -1350841.4081255856, -1352175.6886569306, -1355072.6780485667, -1349844.0926519018, -1353713.6133462382, -1353262.982543569, -1351942.989960133, -1354475.0592789163, -1349665.3857220213, -1347277.260527122, -1349426.374587231], "episode_lengths": [43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920, 43920]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.20009858455036286, "mean_inference_ms": 0.3435801130191063, "mean_action_processing_ms": 0.08479201266939171, "mean_env_wait_ms": 0.6322084308071539, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0028676986694335938, "StateBufferConnector_ms": 0.0020275115966796875, "ViewRequirementAgentConnector_ms": 0.052866220474243164}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 7836000, "num_agent_steps_trained": 7836000, "num_env_steps_sampled": 7836000, "num_env_steps_trained": 7836000, "num_env_steps_sampled_this_iter": 43920, "num_env_steps_trained_this_iter": 43920, "num_env_steps_sampled_throughput_per_sec": 897.8811443968538, "num_env_steps_trained_throughput_per_sec": 897.8811443968538, "timesteps_total": 7836000, "num_steps_trained_this_iter": 43920, "agent_timesteps_total": 7836000, "timers": {"training_iteration_time_ms": 48726.458, "sample_time_ms": 47743.448, "load_time_ms": 14.93, "load_throughput": 2941773.103, "learn_time_ms": 967.128, "learn_throughput": 45412.825, "synch_weights_time_ms": 0.806}, "counters": {"num_env_steps_sampled": 7836000, "num_env_steps_trained": 7836000, "num_agent_steps_sampled": 7836000, "num_agent_steps_trained": 7836000}, "done": true, "episodes_total": 1369, "training_iteration": 490, "trial_id": "4d6b1_00000", "date": "2023-08-03_16-21-28", "timestamp": 1691068888, "time_this_iter_s": 48.917901039123535, "time_total_s": 12540.219106674194, "pid": 26914, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 366, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[1291920, 5e-06], [1731120, 8e-06], [2170320, 2.5e-06], [2609520, 2.5e-06], [3048720, 2.5e-06], [3487920, 2.5e-06], [3927120, 1e-06], [4366320, 1e-06], [4805520, 1e-06], [5244720, 5e-07], [5683920, 5e-07], [6123120, 5e-07], [6562320, 5e-07], [7001520, 1e-07], [7440720, 1e-07], [7879920, 1e-07], [8319120, 1e-07], [8758320, 5e-08], [9197520, 5e-08], [9636720, 2.5e-08], [10075920, 2.5e-08], [10515120, 1e-09], [10954320, 1e-09], [11393520, 5e-10], [11832720, 5e-10], [12271920, 1e-10]], "grad_clip": 0.1, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "EpsilonGreedy", "initial_epsilon": 0.05, "final_epsilon": 0.01, "epsilon_timesteps": 1387080}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 43920, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x304276b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 7872.674348831177, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 17.83623188405797, "ram_util_percent": 62.69565217391305}}
