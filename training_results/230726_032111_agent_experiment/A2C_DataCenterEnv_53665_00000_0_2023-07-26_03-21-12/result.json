{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.5091552734375, "policy_loss": -110379.28125, "vf_loss": 5277459.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 3.0, "diff_num_grad_updates_vs_sampler_policy": 2.0}}, "num_env_steps_sampled": 220920, "num_env_steps_trained": 220920, "num_agent_steps_sampled": 220920, "num_agent_steps_trained": 220920}, "sampler_results": {"episode_reward_max": -862.5348525669727, "episode_reward_min": -926.7890591245979, "episode_reward_mean": -904.2867889789974, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-923.5364552454218, -862.5348525669727, -926.7890591245979], "episode_lengths": [120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.212866431788395, "mean_inference_ms": 0.40476011767611936, "mean_action_processing_ms": 0.09647036523369872, "mean_env_wait_ms": 10.73036695781507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031789143880208335, "StateBufferConnector_ms": 0.0027179718017578125, "ViewRequirementAgentConnector_ms": 0.06860891977945964}}, "episode_reward_max": -862.5348525669727, "episode_reward_min": -926.7890591245979, "episode_reward_mean": -904.2867889789974, "episode_len_mean": 120.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-923.5364552454218, -862.5348525669727, -926.7890591245979], "episode_lengths": [120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.212866431788395, "mean_inference_ms": 0.40476011767611936, "mean_action_processing_ms": 0.09647036523369872, "mean_env_wait_ms": 10.73036695781507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0031789143880208335, "StateBufferConnector_ms": 0.0027179718017578125, "ViewRequirementAgentConnector_ms": 0.06860891977945964}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220920, "num_agent_steps_trained": 220920, "num_env_steps_sampled": 220920, "num_env_steps_trained": 220920, "num_env_steps_sampled_this_iter": 360, "num_env_steps_trained_this_iter": 360, "num_env_steps_sampled_throughput_per_sec": 30.61159886774649, "num_env_steps_trained_throughput_per_sec": 30.61159886774649, "timesteps_total": 220920, "num_steps_trained_this_iter": 360, "agent_timesteps_total": 220920, "timers": {"training_iteration_time_ms": 3920.065, "sample_time_ms": 3911.076, "load_time_ms": 0.345, "load_throughput": 347674.29, "learn_time_ms": 7.895, "learn_throughput": 15198.895, "synch_weights_time_ms": 0.71}, "counters": {"num_env_steps_sampled": 220920, "num_env_steps_trained": 220920, "num_agent_steps_sampled": 220920, "num_agent_steps_trained": 220920}, "done": false, "episodes_total": 1841, "training_iteration": 461, "trial_id": "53665_00000", "date": "2023-07-26_03-21-30", "timestamp": 1690330890, "time_this_iter_s": 11.762587785720825, "time_total_s": 5633.088063716888, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 11.762587785720825, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 37.34705882352941, "ram_util_percent": 77.3529411764706}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4962463378906, "policy_loss": -96888.8984375, "vf_loss": 4779343.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 7.0, "diff_num_grad_updates_vs_sampler_policy": 6.0}}, "num_env_steps_sampled": 221400, "num_env_steps_trained": 221400, "num_agent_steps_sampled": 221400, "num_agent_steps_trained": 221400}, "sampler_results": {"episode_reward_max": -644.5249914209028, "episode_reward_min": -983.9948436232871, "episode_reward_mean": -824.3783461709708, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-923.5364552454218, -862.5348525669727, -926.7890591245979, -644.5249914209028, -983.9948436232871, -661.5738640464544, -767.6943571691588], "episode_lengths": [120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.1064176103385, "mean_inference_ms": 0.40393446110527126, "mean_action_processing_ms": 0.09644468898802659, "mean_env_wait_ms": 8.077988719170277, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003685270036969866, "StateBufferConnector_ms": 0.0026907239641462055, "ViewRequirementAgentConnector_ms": 0.06871904645647321}}, "episode_reward_max": -644.5249914209028, "episode_reward_min": -983.9948436232871, "episode_reward_mean": -824.3783461709708, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-923.5364552454218, -862.5348525669727, -926.7890591245979, -644.5249914209028, -983.9948436232871, -661.5738640464544, -767.6943571691588], "episode_lengths": [120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.1064176103385, "mean_inference_ms": 0.40393446110527126, "mean_action_processing_ms": 0.09644468898802659, "mean_env_wait_ms": 8.077988719170277, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003685270036969866, "StateBufferConnector_ms": 0.0026907239641462055, "ViewRequirementAgentConnector_ms": 0.06871904645647321}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 221400, "num_agent_steps_trained": 221400, "num_env_steps_sampled": 221400, "num_env_steps_trained": 221400, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.546690630279514, "num_env_steps_trained_throughput_per_sec": 41.546690630279514, "timesteps_total": 221400, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 221400, "timers": {"training_iteration_time_ms": 3330.488, "sample_time_ms": 3324.271, "load_time_ms": 0.404, "load_throughput": 297092.112, "learn_time_ms": 5.057, "learn_throughput": 23730.15, "synch_weights_time_ms": 0.717}, "counters": {"num_env_steps_sampled": 221400, "num_env_steps_trained": 221400, "num_agent_steps_sampled": 221400, "num_agent_steps_trained": 221400}, "done": false, "episodes_total": 1845, "training_iteration": 462, "trial_id": "53665_00000", "date": "2023-07-26_03-21-41", "timestamp": 1690330901, "time_this_iter_s": 11.555668830871582, "time_total_s": 5644.64373254776, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 23.318256616592407, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 36.85294117647059, "ram_util_percent": 73.80588235294117}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.50067138671875, "policy_loss": -78244.6796875, "vf_loss": 2719004.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 11.0, "diff_num_grad_updates_vs_sampler_policy": 10.0}}, "num_env_steps_sampled": 221880, "num_env_steps_trained": 221880, "num_agent_steps_sampled": 221880, "num_agent_steps_trained": 221880}, "sampler_results": {"episode_reward_max": -360.46403503569405, "episode_reward_min": -983.9948436232871, "episode_reward_mean": -745.9301067877487, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-923.5364552454218, -862.5348525669727, -926.7890591245979, -644.5249914209028, -983.9948436232871, -661.5738640464544, -767.6943571691588, -784.1885188753826, -666.7810453907114, -360.46403503569405, -623.1491521666522], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.05563708021723, "mean_inference_ms": 0.402433245671069, "mean_action_processing_ms": 0.09622707630739592, "mean_env_wait_ms": 6.89201133230253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037626786665482955, "StateBufferConnector_ms": 0.0026897950605912642, "ViewRequirementAgentConnector_ms": 0.06875124844637784}}, "episode_reward_max": -360.46403503569405, "episode_reward_min": -983.9948436232871, "episode_reward_mean": -745.9301067877487, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-923.5364552454218, -862.5348525669727, -926.7890591245979, -644.5249914209028, -983.9948436232871, -661.5738640464544, -767.6943571691588, -784.1885188753826, -666.7810453907114, -360.46403503569405, -623.1491521666522], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.05563708021723, "mean_inference_ms": 0.402433245671069, "mean_action_processing_ms": 0.09622707630739592, "mean_env_wait_ms": 6.89201133230253, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037626786665482955, "StateBufferConnector_ms": 0.0026897950605912642, "ViewRequirementAgentConnector_ms": 0.06875124844637784}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 221880, "num_agent_steps_trained": 221880, "num_env_steps_sampled": 221880, "num_env_steps_trained": 221880, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.643119314179394, "num_env_steps_trained_throughput_per_sec": 41.643119314179394, "timesteps_total": 221880, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 221880, "timers": {"training_iteration_time_ms": 2902.756, "sample_time_ms": 2898.823, "load_time_ms": 0.308, "load_throughput": 390107.332, "learn_time_ms": 2.88, "learn_throughput": 41666.996, "synch_weights_time_ms": 0.707}, "counters": {"num_env_steps_sampled": 221880, "num_env_steps_trained": 221880, "num_agent_steps_sampled": 221880, "num_agent_steps_trained": 221880}, "done": false, "episodes_total": 1849, "training_iteration": 463, "trial_id": "53665_00000", "date": "2023-07-26_03-21-53", "timestamp": 1690330913, "time_this_iter_s": 11.52889609336853, "time_total_s": 5656.1726286411285, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 34.84715270996094, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 34.599999999999994, "ram_util_percent": 69.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4827880859375, "policy_loss": -82788.8125, "vf_loss": 2762496.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 15.0, "diff_num_grad_updates_vs_sampler_policy": 14.0}}, "num_env_steps_sampled": 222360, "num_env_steps_trained": 222360, "num_agent_steps_sampled": 222360, "num_agent_steps_trained": 222360}, "sampler_results": {"episode_reward_max": -360.46403503569405, "episode_reward_min": -1129.9218310837296, "episode_reward_mean": -744.5497370267095, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-923.5364552454218, -862.5348525669727, -926.7890591245979, -644.5249914209028, -983.9948436232871, -661.5738640464544, -767.6943571691588, -784.1885188753826, -666.7810453907114, -360.46403503569405, -623.1491521666522, -598.9058034118659, -669.3836760950687, -1129.9218310837296, -564.8035701447418], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.02367041017494, "mean_inference_ms": 0.401110379648723, "mean_action_processing_ms": 0.09599974401917336, "mean_env_wait_ms": 6.182332782335001, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035778681437174478, "StateBufferConnector_ms": 0.0027290980021158853, "ViewRequirementAgentConnector_ms": 0.06863911946614583}}, "episode_reward_max": -360.46403503569405, "episode_reward_min": -1129.9218310837296, "episode_reward_mean": -744.5497370267095, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-923.5364552454218, -862.5348525669727, -926.7890591245979, -644.5249914209028, -983.9948436232871, -661.5738640464544, -767.6943571691588, -784.1885188753826, -666.7810453907114, -360.46403503569405, -623.1491521666522, -598.9058034118659, -669.3836760950687, -1129.9218310837296, -564.8035701447418], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.02367041017494, "mean_inference_ms": 0.401110379648723, "mean_action_processing_ms": 0.09599974401917336, "mean_env_wait_ms": 6.182332782335001, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035778681437174478, "StateBufferConnector_ms": 0.0027290980021158853, "ViewRequirementAgentConnector_ms": 0.06863911946614583}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 222360, "num_agent_steps_trained": 222360, "num_env_steps_sampled": 222360, "num_env_steps_trained": 222360, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.61416154736776, "num_env_steps_trained_throughput_per_sec": 41.61416154736776, "timesteps_total": 222360, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 222360, "timers": {"training_iteration_time_ms": 2878.983, "sample_time_ms": 2875.179, "load_time_ms": 0.222, "load_throughput": 540619.205, "learn_time_ms": 2.837, "learn_throughput": 42302.968, "synch_weights_time_ms": 0.708}, "counters": {"num_env_steps_sampled": 222360, "num_env_steps_trained": 222360, "num_agent_steps_sampled": 222360, "num_agent_steps_trained": 222360}, "done": false, "episodes_total": 1853, "training_iteration": 464, "trial_id": "53665_00000", "date": "2023-07-26_03-22-05", "timestamp": 1690330925, "time_this_iter_s": 11.536993026733398, "time_total_s": 5667.709621667862, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 46.384145736694336, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 40.61764705882353, "ram_util_percent": 71.42941176470588}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4972229003906, "policy_loss": -139247.9375, "vf_loss": 8372767.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 19.0, "diff_num_grad_updates_vs_sampler_policy": 18.0}}, "num_env_steps_sampled": 222840, "num_env_steps_trained": 222840, "num_agent_steps_sampled": 222840, "num_agent_steps_trained": 222840}, "sampler_results": {"episode_reward_max": -360.46403503569405, "episode_reward_min": -1129.9218310837296, "episode_reward_mean": -741.9729172633506, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-923.5364552454218, -862.5348525669727, -926.7890591245979, -644.5249914209028, -983.9948436232871, -661.5738640464544, -767.6943571691588, -784.1885188753826, -666.7810453907114, -360.46403503569405, -623.1491521666522, -598.9058034118659, -669.3836760950687, -1129.9218310837296, -564.8035701447418, -383.93914348902194, -749.0670555658398, -823.0128438058882, -973.2203297422689], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.01823580165925, "mean_inference_ms": 0.40009858570496726, "mean_action_processing_ms": 0.09580230503422378, "mean_env_wait_ms": 5.698577384866377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00350977245130037, "StateBufferConnector_ms": 0.0027255008095189146, "ViewRequirementAgentConnector_ms": 0.06871223449707031}}, "episode_reward_max": -360.46403503569405, "episode_reward_min": -1129.9218310837296, "episode_reward_mean": -741.9729172633506, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-923.5364552454218, -862.5348525669727, -926.7890591245979, -644.5249914209028, -983.9948436232871, -661.5738640464544, -767.6943571691588, -784.1885188753826, -666.7810453907114, -360.46403503569405, -623.1491521666522, -598.9058034118659, -669.3836760950687, -1129.9218310837296, -564.8035701447418, -383.93914348902194, -749.0670555658398, -823.0128438058882, -973.2203297422689], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.01823580165925, "mean_inference_ms": 0.40009858570496726, "mean_action_processing_ms": 0.09580230503422378, "mean_env_wait_ms": 5.698577384866377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00350977245130037, "StateBufferConnector_ms": 0.0027255008095189146, "ViewRequirementAgentConnector_ms": 0.06871223449707031}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 222840, "num_agent_steps_trained": 222840, "num_env_steps_sampled": 222840, "num_env_steps_trained": 222840, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.019505489092786, "num_env_steps_trained_throughput_per_sec": 41.019505489092786, "timesteps_total": 222840, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 222840, "timers": {"training_iteration_time_ms": 2907.785, "sample_time_ms": 2903.969, "load_time_ms": 0.224, "load_throughput": 536813.652, "learn_time_ms": 2.843, "learn_throughput": 42201.878, "synch_weights_time_ms": 0.708}, "counters": {"num_env_steps_sampled": 222840, "num_env_steps_trained": 222840, "num_agent_steps_sampled": 222840, "num_agent_steps_trained": 222840}, "done": false, "episodes_total": 1857, "training_iteration": 465, "trial_id": "53665_00000", "date": "2023-07-26_03-22-16", "timestamp": 1690330936, "time_this_iter_s": 11.704392910003662, "time_total_s": 5679.414014577866, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 58.088538646698, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 41.181250000000006, "ram_util_percent": 76.67500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.5204162597656, "policy_loss": -107934.1796875, "vf_loss": 4757830.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 23.0, "diff_num_grad_updates_vs_sampler_policy": 22.0}}, "num_env_steps_sampled": 223320, "num_env_steps_trained": 223320, "num_agent_steps_sampled": 223320, "num_agent_steps_trained": 223320}, "sampler_results": {"episode_reward_max": -360.46403503569405, "episode_reward_min": -1129.9218310837296, "episode_reward_mean": -749.2230158663357, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-923.5364552454218, -862.5348525669727, -926.7890591245979, -644.5249914209028, -983.9948436232871, -661.5738640464544, -767.6943571691588, -784.1885188753826, -666.7810453907114, -360.46403503569405, -623.1491521666522, -598.9058034118659, -669.3836760950687, -1129.9218310837296, -564.8035701447418, -383.93914348902194, -749.0670555658398, -823.0128438058882, -973.2203297422689, -711.1108504958753, -664.8804460858096, -901.6806712317137, -856.9719691086589], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.055419512059984, "mean_inference_ms": 0.40209656656118237, "mean_action_processing_ms": 0.09603590606236759, "mean_env_wait_ms": 5.34953274268585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036353650300399117, "StateBufferConnector_ms": 0.0027977901956309443, "ViewRequirementAgentConnector_ms": 0.07117520207944124}}, "episode_reward_max": -360.46403503569405, "episode_reward_min": -1129.9218310837296, "episode_reward_mean": -749.2230158663357, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-923.5364552454218, -862.5348525669727, -926.7890591245979, -644.5249914209028, -983.9948436232871, -661.5738640464544, -767.6943571691588, -784.1885188753826, -666.7810453907114, -360.46403503569405, -623.1491521666522, -598.9058034118659, -669.3836760950687, -1129.9218310837296, -564.8035701447418, -383.93914348902194, -749.0670555658398, -823.0128438058882, -973.2203297422689, -711.1108504958753, -664.8804460858096, -901.6806712317137, -856.9719691086589], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.055419512059984, "mean_inference_ms": 0.40209656656118237, "mean_action_processing_ms": 0.09603590606236759, "mean_env_wait_ms": 5.34953274268585, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036353650300399117, "StateBufferConnector_ms": 0.0027977901956309443, "ViewRequirementAgentConnector_ms": 0.07117520207944124}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 223320, "num_agent_steps_trained": 223320, "num_env_steps_sampled": 223320, "num_env_steps_trained": 223320, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.72511523479862, "num_env_steps_trained_throughput_per_sec": 38.72511523479862, "timesteps_total": 223320, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 223320, "timers": {"training_iteration_time_ms": 2994.956, "sample_time_ms": 2990.348, "load_time_ms": 0.32, "load_throughput": 374714.473, "learn_time_ms": 3.344, "learn_throughput": 35883.255, "synch_weights_time_ms": 0.861}, "counters": {"num_env_steps_sampled": 223320, "num_env_steps_trained": 223320, "num_agent_steps_sampled": 223320, "num_agent_steps_trained": 223320}, "done": false, "episodes_total": 1861, "training_iteration": 466, "trial_id": "53665_00000", "date": "2023-07-26_03-22-29", "timestamp": 1690330949, "time_this_iter_s": 12.398187160491943, "time_total_s": 5691.8122017383575, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 70.48672580718994, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 46.01666666666667, "ram_util_percent": 76.91111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.46978759765625, "policy_loss": -108936.5859375, "vf_loss": 5338760.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 27.0, "diff_num_grad_updates_vs_sampler_policy": 26.0}}, "num_env_steps_sampled": 223800, "num_env_steps_trained": 223800, "num_agent_steps_sampled": 223800, "num_agent_steps_trained": 223800}, "sampler_results": {"episode_reward_max": -360.46403503569405, "episode_reward_min": -1129.9218310837296, "episode_reward_mean": -759.321673093422, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-923.5364552454218, -862.5348525669727, -926.7890591245979, -644.5249914209028, -983.9948436232871, -661.5738640464544, -767.6943571691588, -784.1885188753826, -666.7810453907114, -360.46403503569405, -623.1491521666522, -598.9058034118659, -669.3836760950687, -1129.9218310837296, -564.8035701447418, -383.93914348902194, -749.0670555658398, -823.0128438058882, -973.2203297422689, -711.1108504958753, -664.8804460858096, -901.6806712317137, -856.9719691086589, -715.4068856637762, -1050.4726690457328, -690.2311397780416, -813.4451141091247], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.109696045649205, "mean_inference_ms": 0.4034115958456394, "mean_action_processing_ms": 0.09618388194975808, "mean_env_wait_ms": 5.080607262615213, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003708733452690972, "StateBufferConnector_ms": 0.0027894973754882812, "ViewRequirementAgentConnector_ms": 0.07099928679289641}}, "episode_reward_max": -360.46403503569405, "episode_reward_min": -1129.9218310837296, "episode_reward_mean": -759.321673093422, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-923.5364552454218, -862.5348525669727, -926.7890591245979, -644.5249914209028, -983.9948436232871, -661.5738640464544, -767.6943571691588, -784.1885188753826, -666.7810453907114, -360.46403503569405, -623.1491521666522, -598.9058034118659, -669.3836760950687, -1129.9218310837296, -564.8035701447418, -383.93914348902194, -749.0670555658398, -823.0128438058882, -973.2203297422689, -711.1108504958753, -664.8804460858096, -901.6806712317137, -856.9719691086589, -715.4068856637762, -1050.4726690457328, -690.2311397780416, -813.4451141091247], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.109696045649205, "mean_inference_ms": 0.4034115958456394, "mean_action_processing_ms": 0.09618388194975808, "mean_env_wait_ms": 5.080607262615213, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003708733452690972, "StateBufferConnector_ms": 0.0027894973754882812, "ViewRequirementAgentConnector_ms": 0.07099928679289641}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 223800, "num_agent_steps_trained": 223800, "num_env_steps_sampled": 223800, "num_env_steps_trained": 223800, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.86950964433092, "num_env_steps_trained_throughput_per_sec": 38.86950964433092, "timesteps_total": 223800, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 223800, "timers": {"training_iteration_time_ms": 3047.843, "sample_time_ms": 3043.222, "load_time_ms": 0.316, "load_throughput": 379689.559, "learn_time_ms": 3.337, "learn_throughput": 35959.14, "synch_weights_time_ms": 0.887}, "counters": {"num_env_steps_sampled": 223800, "num_env_steps_trained": 223800, "num_agent_steps_sampled": 223800, "num_agent_steps_trained": 223800}, "done": false, "episodes_total": 1865, "training_iteration": 467, "trial_id": "53665_00000", "date": "2023-07-26_03-22-41", "timestamp": 1690330961, "time_this_iter_s": 12.351573944091797, "time_total_s": 5704.163775682449, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 82.83829975128174, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 43.27058823529412, "ram_util_percent": 77.67647058823529}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4755554199219, "policy_loss": -92176.4921875, "vf_loss": 3928952.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 31.0, "diff_num_grad_updates_vs_sampler_policy": 30.0}}, "num_env_steps_sampled": 224280, "num_env_steps_trained": 224280, "num_agent_steps_sampled": 224280, "num_agent_steps_trained": 224280}, "sampler_results": {"episode_reward_max": -360.46403503569405, "episode_reward_min": -1129.9218310837296, "episode_reward_mean": -743.3103492124957, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-923.5364552454218, -862.5348525669727, -926.7890591245979, -644.5249914209028, -983.9948436232871, -661.5738640464544, -767.6943571691588, -784.1885188753826, -666.7810453907114, -360.46403503569405, -623.1491521666522, -598.9058034118659, -669.3836760950687, -1129.9218310837296, -564.8035701447418, -383.93914348902194, -749.0670555658398, -823.0128438058882, -973.2203297422689, -711.1108504958753, -664.8804460858096, -901.6806712317137, -856.9719691086589, -715.4068856637762, -1050.4726690457328, -690.2311397780416, -813.4451141091247, -750.6149491461733, -611.3273245529999, -477.6000462599683, -701.393332105827], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.160484028232954, "mean_inference_ms": 0.4046415739814701, "mean_action_processing_ms": 0.09632415523620533, "mean_env_wait_ms": 4.866814607159368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038231572797221523, "StateBufferConnector_ms": 0.0028094937724451865, "ViewRequirementAgentConnector_ms": 0.07210162378126575}}, "episode_reward_max": -360.46403503569405, "episode_reward_min": -1129.9218310837296, "episode_reward_mean": -743.3103492124957, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-923.5364552454218, -862.5348525669727, -926.7890591245979, -644.5249914209028, -983.9948436232871, -661.5738640464544, -767.6943571691588, -784.1885188753826, -666.7810453907114, -360.46403503569405, -623.1491521666522, -598.9058034118659, -669.3836760950687, -1129.9218310837296, -564.8035701447418, -383.93914348902194, -749.0670555658398, -823.0128438058882, -973.2203297422689, -711.1108504958753, -664.8804460858096, -901.6806712317137, -856.9719691086589, -715.4068856637762, -1050.4726690457328, -690.2311397780416, -813.4451141091247, -750.6149491461733, -611.3273245529999, -477.6000462599683, -701.393332105827], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.160484028232954, "mean_inference_ms": 0.4046415739814701, "mean_action_processing_ms": 0.09632415523620533, "mean_env_wait_ms": 4.866814607159368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038231572797221523, "StateBufferConnector_ms": 0.0028094937724451865, "ViewRequirementAgentConnector_ms": 0.07210162378126575}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224280, "num_agent_steps_trained": 224280, "num_env_steps_sampled": 224280, "num_env_steps_trained": 224280, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.47260429802041, "num_env_steps_trained_throughput_per_sec": 39.47260429802041, "timesteps_total": 224280, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 224280, "timers": {"training_iteration_time_ms": 3099.699, "sample_time_ms": 3095.015, "load_time_ms": 0.316, "load_throughput": 380292.014, "learn_time_ms": 3.39, "learn_throughput": 35395.966, "synch_weights_time_ms": 0.898}, "counters": {"num_env_steps_sampled": 224280, "num_env_steps_trained": 224280, "num_agent_steps_sampled": 224280, "num_agent_steps_trained": 224280}, "done": false, "episodes_total": 1869, "training_iteration": 468, "trial_id": "53665_00000", "date": "2023-07-26_03-22-53", "timestamp": 1690330973, "time_this_iter_s": 12.162753820419312, "time_total_s": 5716.326529502869, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 95.00105357170105, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 40.68888888888889, "ram_util_percent": 77.18888888888888}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4862976074219, "policy_loss": -99486.984375, "vf_loss": 4721378.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 35.0, "diff_num_grad_updates_vs_sampler_policy": 34.0}}, "num_env_steps_sampled": 224760, "num_env_steps_trained": 224760, "num_agent_steps_sampled": 224760, "num_agent_steps_trained": 224760}, "sampler_results": {"episode_reward_max": -360.46403503569405, "episode_reward_min": -1129.9218310837296, "episode_reward_mean": -735.3477658062366, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-923.5364552454218, -862.5348525669727, -926.7890591245979, -644.5249914209028, -983.9948436232871, -661.5738640464544, -767.6943571691588, -784.1885188753826, -666.7810453907114, -360.46403503569405, -623.1491521666522, -598.9058034118659, -669.3836760950687, -1129.9218310837296, -564.8035701447418, -383.93914348902194, -749.0670555658398, -823.0128438058882, -973.2203297422689, -711.1108504958753, -664.8804460858096, -901.6806712317137, -856.9719691086589, -715.4068856637762, -1050.4726690457328, -690.2311397780416, -813.4451141091247, -750.6149491461733, -611.3273245529999, -477.6000462599683, -701.393332105827, -669.7402630350878, -648.3790898089699, -604.4827643406974, -771.9488604461665], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.19618232593751, "mean_inference_ms": 0.4053822777883731, "mean_action_processing_ms": 0.09640226832573044, "mean_env_wait_ms": 4.691387555756606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037663323538643973, "StateBufferConnector_ms": 0.002796990530831473, "ViewRequirementAgentConnector_ms": 0.07154600960867745}}, "episode_reward_max": -360.46403503569405, "episode_reward_min": -1129.9218310837296, "episode_reward_mean": -735.3477658062366, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-923.5364552454218, -862.5348525669727, -926.7890591245979, -644.5249914209028, -983.9948436232871, -661.5738640464544, -767.6943571691588, -784.1885188753826, -666.7810453907114, -360.46403503569405, -623.1491521666522, -598.9058034118659, -669.3836760950687, -1129.9218310837296, -564.8035701447418, -383.93914348902194, -749.0670555658398, -823.0128438058882, -973.2203297422689, -711.1108504958753, -664.8804460858096, -901.6806712317137, -856.9719691086589, -715.4068856637762, -1050.4726690457328, -690.2311397780416, -813.4451141091247, -750.6149491461733, -611.3273245529999, -477.6000462599683, -701.393332105827, -669.7402630350878, -648.3790898089699, -604.4827643406974, -771.9488604461665], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.19618232593751, "mean_inference_ms": 0.4053822777883731, "mean_action_processing_ms": 0.09640226832573044, "mean_env_wait_ms": 4.691387555756606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037663323538643973, "StateBufferConnector_ms": 0.002796990530831473, "ViewRequirementAgentConnector_ms": 0.07154600960867745}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224760, "num_agent_steps_trained": 224760, "num_env_steps_sampled": 224760, "num_env_steps_trained": 224760, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.94279972592081, "num_env_steps_trained_throughput_per_sec": 40.94279972592081, "timesteps_total": 224760, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 224760, "timers": {"training_iteration_time_ms": 2993.726, "sample_time_ms": 2989.843, "load_time_ms": 0.22, "load_throughput": 545778.009, "learn_time_ms": 2.883, "learn_throughput": 41628.743, "synch_weights_time_ms": 0.741}, "counters": {"num_env_steps_sampled": 224760, "num_env_steps_trained": 224760, "num_agent_steps_sampled": 224760, "num_agent_steps_trained": 224760}, "done": false, "episodes_total": 1873, "training_iteration": 469, "trial_id": "53665_00000", "date": "2023-07-26_03-23-05", "timestamp": 1690330985, "time_this_iter_s": 11.726354122161865, "time_total_s": 5728.0528836250305, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 106.72740769386292, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 39.625, "ram_util_percent": 73.7125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.497802734375, "policy_loss": -122011.546875, "vf_loss": 6117786.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 39.0, "diff_num_grad_updates_vs_sampler_policy": 38.0}}, "num_env_steps_sampled": 225240, "num_env_steps_trained": 225240, "num_agent_steps_sampled": 225240, "num_agent_steps_trained": 225240}, "sampler_results": {"episode_reward_max": -360.46403503569405, "episode_reward_min": -1129.9218310837296, "episode_reward_mean": -731.5084966175078, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-923.5364552454218, -862.5348525669727, -926.7890591245979, -644.5249914209028, -983.9948436232871, -661.5738640464544, -767.6943571691588, -784.1885188753826, -666.7810453907114, -360.46403503569405, -623.1491521666522, -598.9058034118659, -669.3836760950687, -1129.9218310837296, -564.8035701447418, -383.93914348902194, -749.0670555658398, -823.0128438058882, -973.2203297422689, -711.1108504958753, -664.8804460858096, -901.6806712317137, -856.9719691086589, -715.4068856637762, -1050.4726690457328, -690.2311397780416, -813.4451141091247, -750.6149491461733, -611.3273245529999, -477.6000462599683, -701.393332105827, -669.7402630350878, -648.3790898089699, -604.4827643406974, -771.9488604461665, -514.9391731234848, -681.7357675104101, -605.5031164992423, -989.4815077313855], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.22232302658391, "mean_inference_ms": 0.40712118643000184, "mean_action_processing_ms": 0.09650005232171707, "mean_env_wait_ms": 4.54840909778638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003732779087164463, "StateBufferConnector_ms": 0.002788886045798277, "ViewRequirementAgentConnector_ms": 0.07142103635347806}}, "episode_reward_max": -360.46403503569405, "episode_reward_min": -1129.9218310837296, "episode_reward_mean": -731.5084966175078, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-923.5364552454218, -862.5348525669727, -926.7890591245979, -644.5249914209028, -983.9948436232871, -661.5738640464544, -767.6943571691588, -784.1885188753826, -666.7810453907114, -360.46403503569405, -623.1491521666522, -598.9058034118659, -669.3836760950687, -1129.9218310837296, -564.8035701447418, -383.93914348902194, -749.0670555658398, -823.0128438058882, -973.2203297422689, -711.1108504958753, -664.8804460858096, -901.6806712317137, -856.9719691086589, -715.4068856637762, -1050.4726690457328, -690.2311397780416, -813.4451141091247, -750.6149491461733, -611.3273245529999, -477.6000462599683, -701.393332105827, -669.7402630350878, -648.3790898089699, -604.4827643406974, -771.9488604461665, -514.9391731234848, -681.7357675104101, -605.5031164992423, -989.4815077313855], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.22232302658391, "mean_inference_ms": 0.40712118643000184, "mean_action_processing_ms": 0.09650005232171707, "mean_env_wait_ms": 4.54840909778638, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003732779087164463, "StateBufferConnector_ms": 0.002788886045798277, "ViewRequirementAgentConnector_ms": 0.07142103635347806}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 225240, "num_agent_steps_trained": 225240, "num_env_steps_sampled": 225240, "num_env_steps_trained": 225240, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.0563723449371, "num_env_steps_trained_throughput_per_sec": 40.0563723449371, "timesteps_total": 225240, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 225240, "timers": {"training_iteration_time_ms": 2951.212, "sample_time_ms": 2947.075, "load_time_ms": 0.238, "load_throughput": 504881.613, "learn_time_ms": 3.097, "learn_throughput": 38750.932, "synch_weights_time_ms": 0.754}, "counters": {"num_env_steps_sampled": 225240, "num_env_steps_trained": 225240, "num_agent_steps_sampled": 225240, "num_agent_steps_trained": 225240}, "done": false, "episodes_total": 1877, "training_iteration": 470, "trial_id": "53665_00000", "date": "2023-07-26_03-23-17", "timestamp": 1690330997, "time_this_iter_s": 11.985819101333618, "time_total_s": 5740.038702726364, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 118.71322679519653, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 40.46111111111111, "ram_util_percent": 79.15555555555557}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.5132751464844, "policy_loss": -121973.9609375, "vf_loss": 6036755.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 43.0, "diff_num_grad_updates_vs_sampler_policy": 42.0}}, "num_env_steps_sampled": 225720, "num_env_steps_trained": 225720, "num_agent_steps_sampled": 225720, "num_agent_steps_trained": 225720}, "sampler_results": {"episode_reward_max": -360.46403503569405, "episode_reward_min": -1129.9218310837296, "episode_reward_mean": -735.6846054044262, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-923.5364552454218, -862.5348525669727, -926.7890591245979, -644.5249914209028, -983.9948436232871, -661.5738640464544, -767.6943571691588, -784.1885188753826, -666.7810453907114, -360.46403503569405, -623.1491521666522, -598.9058034118659, -669.3836760950687, -1129.9218310837296, -564.8035701447418, -383.93914348902194, -749.0670555658398, -823.0128438058882, -973.2203297422689, -711.1108504958753, -664.8804460858096, -901.6806712317137, -856.9719691086589, -715.4068856637762, -1050.4726690457328, -690.2311397780416, -813.4451141091247, -750.6149491461733, -611.3273245529999, -477.6000462599683, -701.393332105827, -669.7402630350878, -648.3790898089699, -604.4827643406974, -771.9488604461665, -514.9391731234848, -681.7357675104101, -605.5031164992423, -989.4815077313855, -915.0504238071034, -739.6376485282495, -637.4949336273813, -813.4236583447815], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.243704266253484, "mean_inference_ms": 0.40824210775656494, "mean_action_processing_ms": 0.0965453821083486, "mean_env_wait_ms": 4.426921646163933, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037509341572606286, "StateBufferConnector_ms": 0.0027894973754882812, "ViewRequirementAgentConnector_ms": 0.07105871688487918}}, "episode_reward_max": -360.46403503569405, "episode_reward_min": -1129.9218310837296, "episode_reward_mean": -735.6846054044262, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-923.5364552454218, -862.5348525669727, -926.7890591245979, -644.5249914209028, -983.9948436232871, -661.5738640464544, -767.6943571691588, -784.1885188753826, -666.7810453907114, -360.46403503569405, -623.1491521666522, -598.9058034118659, -669.3836760950687, -1129.9218310837296, -564.8035701447418, -383.93914348902194, -749.0670555658398, -823.0128438058882, -973.2203297422689, -711.1108504958753, -664.8804460858096, -901.6806712317137, -856.9719691086589, -715.4068856637762, -1050.4726690457328, -690.2311397780416, -813.4451141091247, -750.6149491461733, -611.3273245529999, -477.6000462599683, -701.393332105827, -669.7402630350878, -648.3790898089699, -604.4827643406974, -771.9488604461665, -514.9391731234848, -681.7357675104101, -605.5031164992423, -989.4815077313855, -915.0504238071034, -739.6376485282495, -637.4949336273813, -813.4236583447815], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.243704266253484, "mean_inference_ms": 0.40824210775656494, "mean_action_processing_ms": 0.0965453821083486, "mean_env_wait_ms": 4.426921646163933, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037509341572606286, "StateBufferConnector_ms": 0.0027894973754882812, "ViewRequirementAgentConnector_ms": 0.07105871688487918}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 225720, "num_agent_steps_trained": 225720, "num_env_steps_sampled": 225720, "num_env_steps_trained": 225720, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.44117198342931, "num_env_steps_trained_throughput_per_sec": 40.44117198342931, "timesteps_total": 225720, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 225720, "timers": {"training_iteration_time_ms": 2987.793, "sample_time_ms": 2983.684, "load_time_ms": 0.238, "load_throughput": 504476.777, "learn_time_ms": 3.073, "learn_throughput": 39048.565, "synch_weights_time_ms": 0.75}, "counters": {"num_env_steps_sampled": 225720, "num_env_steps_trained": 225720, "num_agent_steps_sampled": 225720, "num_agent_steps_trained": 225720}, "done": false, "episodes_total": 1881, "training_iteration": 471, "trial_id": "53665_00000", "date": "2023-07-26_03-23-29", "timestamp": 1690331009, "time_this_iter_s": 11.871685266494751, "time_total_s": 5751.910387992859, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 130.58491206169128, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 37.506249999999994, "ram_util_percent": 78.2375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.489501953125, "policy_loss": -100509.578125, "vf_loss": 4789374.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 47.0, "diff_num_grad_updates_vs_sampler_policy": 46.0}}, "num_env_steps_sampled": 226200, "num_env_steps_trained": 226200, "num_agent_steps_sampled": 226200, "num_agent_steps_trained": 226200}, "sampler_results": {"episode_reward_max": -360.46403503569405, "episode_reward_min": -1129.9218310837296, "episode_reward_mean": -740.5819740933234, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-923.5364552454218, -862.5348525669727, -926.7890591245979, -644.5249914209028, -983.9948436232871, -661.5738640464544, -767.6943571691588, -784.1885188753826, -666.7810453907114, -360.46403503569405, -623.1491521666522, -598.9058034118659, -669.3836760950687, -1129.9218310837296, -564.8035701447418, -383.93914348902194, -749.0670555658398, -823.0128438058882, -973.2203297422689, -711.1108504958753, -664.8804460858096, -901.6806712317137, -856.9719691086589, -715.4068856637762, -1050.4726690457328, -690.2311397780416, -813.4451141091247, -750.6149491461733, -611.3273245529999, -477.6000462599683, -701.393332105827, -669.7402630350878, -648.3790898089699, -604.4827643406974, -771.9488604461665, -514.9391731234848, -681.7357675104101, -605.5031164992423, -989.4815077313855, -915.0504238071034, -739.6376485282495, -637.4949336273813, -813.4236583447815, -1044.049131854899, -760.2720658529917, -574.7015103061706, -793.8920419818169], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.259380579447388, "mean_inference_ms": 0.40895577492021284, "mean_action_processing_ms": 0.09655678334785844, "mean_env_wait_ms": 4.321504769828995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003707662541815575, "StateBufferConnector_ms": 0.002786961007625499, "ViewRequirementAgentConnector_ms": 0.07075299607946518}}, "episode_reward_max": -360.46403503569405, "episode_reward_min": -1129.9218310837296, "episode_reward_mean": -740.5819740933234, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-923.5364552454218, -862.5348525669727, -926.7890591245979, -644.5249914209028, -983.9948436232871, -661.5738640464544, -767.6943571691588, -784.1885188753826, -666.7810453907114, -360.46403503569405, -623.1491521666522, -598.9058034118659, -669.3836760950687, -1129.9218310837296, -564.8035701447418, -383.93914348902194, -749.0670555658398, -823.0128438058882, -973.2203297422689, -711.1108504958753, -664.8804460858096, -901.6806712317137, -856.9719691086589, -715.4068856637762, -1050.4726690457328, -690.2311397780416, -813.4451141091247, -750.6149491461733, -611.3273245529999, -477.6000462599683, -701.393332105827, -669.7402630350878, -648.3790898089699, -604.4827643406974, -771.9488604461665, -514.9391731234848, -681.7357675104101, -605.5031164992423, -989.4815077313855, -915.0504238071034, -739.6376485282495, -637.4949336273813, -813.4236583447815, -1044.049131854899, -760.2720658529917, -574.7015103061706, -793.8920419818169], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.259380579447388, "mean_inference_ms": 0.40895577492021284, "mean_action_processing_ms": 0.09655678334785844, "mean_env_wait_ms": 4.321504769828995, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003707662541815575, "StateBufferConnector_ms": 0.002786961007625499, "ViewRequirementAgentConnector_ms": 0.07075299607946518}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 226200, "num_agent_steps_trained": 226200, "num_env_steps_sampled": 226200, "num_env_steps_trained": 226200, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.0973674825788, "num_env_steps_trained_throughput_per_sec": 41.0973674825788, "timesteps_total": 226200, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 226200, "timers": {"training_iteration_time_ms": 2934.614, "sample_time_ms": 2930.778, "load_time_ms": 0.221, "load_throughput": 542074.83, "learn_time_ms": 2.881, "learn_throughput": 41656.651, "synch_weights_time_ms": 0.694}, "counters": {"num_env_steps_sampled": 226200, "num_env_steps_trained": 226200, "num_agent_steps_sampled": 226200, "num_agent_steps_trained": 226200}, "done": false, "episodes_total": 1885, "training_iteration": 472, "trial_id": "53665_00000", "date": "2023-07-26_03-23-41", "timestamp": 1690331021, "time_this_iter_s": 11.682085275650024, "time_total_s": 5763.592473268509, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 142.2669973373413, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 37.594117647058816, "ram_util_percent": 76.95294117647059}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4688415527344, "policy_loss": -97959.921875, "vf_loss": 4572607.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 51.0, "diff_num_grad_updates_vs_sampler_policy": 50.0}}, "num_env_steps_sampled": 226680, "num_env_steps_trained": 226680, "num_agent_steps_sampled": 226680, "num_agent_steps_trained": 226680}, "sampler_results": {"episode_reward_max": -360.46403503569405, "episode_reward_min": -1129.9218310837296, "episode_reward_mean": -734.2395743860587, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-923.5364552454218, -862.5348525669727, -926.7890591245979, -644.5249914209028, -983.9948436232871, -661.5738640464544, -767.6943571691588, -784.1885188753826, -666.7810453907114, -360.46403503569405, -623.1491521666522, -598.9058034118659, -669.3836760950687, -1129.9218310837296, -564.8035701447418, -383.93914348902194, -749.0670555658398, -823.0128438058882, -973.2203297422689, -711.1108504958753, -664.8804460858096, -901.6806712317137, -856.9719691086589, -715.4068856637762, -1050.4726690457328, -690.2311397780416, -813.4451141091247, -750.6149491461733, -611.3273245529999, -477.6000462599683, -701.393332105827, -669.7402630350878, -648.3790898089699, -604.4827643406974, -771.9488604461665, -514.9391731234848, -681.7357675104101, -605.5031164992423, -989.4815077313855, -915.0504238071034, -739.6376485282495, -637.4949336273813, -813.4236583447815, -1044.049131854899, -760.2720658529917, -574.7015103061706, -793.8920419818169, -561.4809307948568, -522.5100115114014, -825.1119693436538, -729.7625996528775], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.269321297364865, "mean_inference_ms": 0.4094103412520001, "mean_action_processing_ms": 0.0965528680180486, "mean_env_wait_ms": 4.229005874154493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037230697332643996, "StateBufferConnector_ms": 0.002810066821528416, "ViewRequirementAgentConnector_ms": 0.07049008911731196}}, "episode_reward_max": -360.46403503569405, "episode_reward_min": -1129.9218310837296, "episode_reward_mean": -734.2395743860587, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-923.5364552454218, -862.5348525669727, -926.7890591245979, -644.5249914209028, -983.9948436232871, -661.5738640464544, -767.6943571691588, -784.1885188753826, -666.7810453907114, -360.46403503569405, -623.1491521666522, -598.9058034118659, -669.3836760950687, -1129.9218310837296, -564.8035701447418, -383.93914348902194, -749.0670555658398, -823.0128438058882, -973.2203297422689, -711.1108504958753, -664.8804460858096, -901.6806712317137, -856.9719691086589, -715.4068856637762, -1050.4726690457328, -690.2311397780416, -813.4451141091247, -750.6149491461733, -611.3273245529999, -477.6000462599683, -701.393332105827, -669.7402630350878, -648.3790898089699, -604.4827643406974, -771.9488604461665, -514.9391731234848, -681.7357675104101, -605.5031164992423, -989.4815077313855, -915.0504238071034, -739.6376485282495, -637.4949336273813, -813.4236583447815, -1044.049131854899, -760.2720658529917, -574.7015103061706, -793.8920419818169, -561.4809307948568, -522.5100115114014, -825.1119693436538, -729.7625996528775], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.269321297364865, "mean_inference_ms": 0.4094103412520001, "mean_action_processing_ms": 0.0965528680180486, "mean_env_wait_ms": 4.229005874154493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037230697332643996, "StateBufferConnector_ms": 0.002810066821528416, "ViewRequirementAgentConnector_ms": 0.07049008911731196}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 226680, "num_agent_steps_trained": 226680, "num_env_steps_sampled": 226680, "num_env_steps_trained": 226680, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.56621798698747, "num_env_steps_trained_throughput_per_sec": 41.56621798698747, "timesteps_total": 226680, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 226680, "timers": {"training_iteration_time_ms": 2904.63, "sample_time_ms": 2900.812, "load_time_ms": 0.222, "load_throughput": 540329.018, "learn_time_ms": 2.853, "learn_throughput": 42060.459, "synch_weights_time_ms": 0.704}, "counters": {"num_env_steps_sampled": 226680, "num_env_steps_trained": 226680, "num_agent_steps_sampled": 226680, "num_agent_steps_trained": 226680}, "done": false, "episodes_total": 1889, "training_iteration": 473, "trial_id": "53665_00000", "date": "2023-07-26_03-23-52", "timestamp": 1690331032, "time_this_iter_s": 11.550351858139038, "time_total_s": 5775.142825126648, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 153.81734919548035, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 32.193749999999994, "ram_util_percent": 75.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4915771484375, "policy_loss": -101992.140625, "vf_loss": 5114803.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 55.0, "diff_num_grad_updates_vs_sampler_policy": 54.0}}, "num_env_steps_sampled": 227160, "num_env_steps_trained": 227160, "num_agent_steps_sampled": 227160, "num_agent_steps_trained": 227160}, "sampler_results": {"episode_reward_max": -360.46403503569405, "episode_reward_min": -1129.9218310837296, "episode_reward_mean": -738.532253762341, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-923.5364552454218, -862.5348525669727, -926.7890591245979, -644.5249914209028, -983.9948436232871, -661.5738640464544, -767.6943571691588, -784.1885188753826, -666.7810453907114, -360.46403503569405, -623.1491521666522, -598.9058034118659, -669.3836760950687, -1129.9218310837296, -564.8035701447418, -383.93914348902194, -749.0670555658398, -823.0128438058882, -973.2203297422689, -711.1108504958753, -664.8804460858096, -901.6806712317137, -856.9719691086589, -715.4068856637762, -1050.4726690457328, -690.2311397780416, -813.4451141091247, -750.6149491461733, -611.3273245529999, -477.6000462599683, -701.393332105827, -669.7402630350878, -648.3790898089699, -604.4827643406974, -771.9488604461665, -514.9391731234848, -681.7357675104101, -605.5031164992423, -989.4815077313855, -915.0504238071034, -739.6376485282495, -637.4949336273813, -813.4236583447815, -1044.049131854899, -760.2720658529917, -574.7015103061706, -793.8920419818169, -561.4809307948568, -522.5100115114014, -825.1119693436538, -729.7625996528775, -926.1607609593053, -765.0306223697702, -656.701926588058, -825.1623533226306], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.274244408701612, "mean_inference_ms": 0.4096776037349482, "mean_action_processing_ms": 0.0965342395027474, "mean_env_wait_ms": 4.1476755181495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036842172796075993, "StateBufferConnector_ms": 0.0028090043501420455, "ViewRequirementAgentConnector_ms": 0.07034431804310191}}, "episode_reward_max": -360.46403503569405, "episode_reward_min": -1129.9218310837296, "episode_reward_mean": -738.532253762341, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-923.5364552454218, -862.5348525669727, -926.7890591245979, -644.5249914209028, -983.9948436232871, -661.5738640464544, -767.6943571691588, -784.1885188753826, -666.7810453907114, -360.46403503569405, -623.1491521666522, -598.9058034118659, -669.3836760950687, -1129.9218310837296, -564.8035701447418, -383.93914348902194, -749.0670555658398, -823.0128438058882, -973.2203297422689, -711.1108504958753, -664.8804460858096, -901.6806712317137, -856.9719691086589, -715.4068856637762, -1050.4726690457328, -690.2311397780416, -813.4451141091247, -750.6149491461733, -611.3273245529999, -477.6000462599683, -701.393332105827, -669.7402630350878, -648.3790898089699, -604.4827643406974, -771.9488604461665, -514.9391731234848, -681.7357675104101, -605.5031164992423, -989.4815077313855, -915.0504238071034, -739.6376485282495, -637.4949336273813, -813.4236583447815, -1044.049131854899, -760.2720658529917, -574.7015103061706, -793.8920419818169, -561.4809307948568, -522.5100115114014, -825.1119693436538, -729.7625996528775, -926.1607609593053, -765.0306223697702, -656.701926588058, -825.1623533226306], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.274244408701612, "mean_inference_ms": 0.4096776037349482, "mean_action_processing_ms": 0.0965342395027474, "mean_env_wait_ms": 4.1476755181495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036842172796075993, "StateBufferConnector_ms": 0.0028090043501420455, "ViewRequirementAgentConnector_ms": 0.07034431804310191}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 227160, "num_agent_steps_trained": 227160, "num_env_steps_sampled": 227160, "num_env_steps_trained": 227160, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.69909594506554, "num_env_steps_trained_throughput_per_sec": 41.69909594506554, "timesteps_total": 227160, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 227160, "timers": {"training_iteration_time_ms": 2870.026, "sample_time_ms": 2866.224, "load_time_ms": 0.22, "load_throughput": 544655.86, "learn_time_ms": 2.844, "learn_throughput": 42197.632, "synch_weights_time_ms": 0.699}, "counters": {"num_env_steps_sampled": 227160, "num_env_steps_trained": 227160, "num_agent_steps_sampled": 227160, "num_agent_steps_trained": 227160}, "done": false, "episodes_total": 1893, "training_iteration": 474, "trial_id": "53665_00000", "date": "2023-07-26_03-24-04", "timestamp": 1690331044, "time_this_iter_s": 11.513523817062378, "time_total_s": 5786.65634894371, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 165.33087301254272, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 36.08235294117647, "ram_util_percent": 73.33529411764705}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.47894287109375, "policy_loss": -162424.421875, "vf_loss": 10122002.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 59.0, "diff_num_grad_updates_vs_sampler_policy": 58.0}}, "num_env_steps_sampled": 227640, "num_env_steps_trained": 227640, "num_agent_steps_sampled": 227640, "num_agent_steps_trained": 227640}, "sampler_results": {"episode_reward_max": -360.46403503569405, "episode_reward_min": -1129.9218310837296, "episode_reward_mean": -751.4207166832402, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-923.5364552454218, -862.5348525669727, -926.7890591245979, -644.5249914209028, -983.9948436232871, -661.5738640464544, -767.6943571691588, -784.1885188753826, -666.7810453907114, -360.46403503569405, -623.1491521666522, -598.9058034118659, -669.3836760950687, -1129.9218310837296, -564.8035701447418, -383.93914348902194, -749.0670555658398, -823.0128438058882, -973.2203297422689, -711.1108504958753, -664.8804460858096, -901.6806712317137, -856.9719691086589, -715.4068856637762, -1050.4726690457328, -690.2311397780416, -813.4451141091247, -750.6149491461733, -611.3273245529999, -477.6000462599683, -701.393332105827, -669.7402630350878, -648.3790898089699, -604.4827643406974, -771.9488604461665, -514.9391731234848, -681.7357675104101, -605.5031164992423, -989.4815077313855, -915.0504238071034, -739.6376485282495, -637.4949336273813, -813.4236583447815, -1044.049131854899, -760.2720658529917, -574.7015103061706, -793.8920419818169, -561.4809307948568, -522.5100115114014, -825.1119693436538, -729.7625996528775, -926.1607609593053, -765.0306223697702, -656.701926588058, -825.1623533226306, -1056.6224861659093, -947.4262632439014, -695.5562926958454, -1014.9432852767619], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.277770356248865, "mean_inference_ms": 0.4097994779573868, "mean_action_processing_ms": 0.09650364634388953, "mean_env_wait_ms": 4.075582407341627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00365265345169326, "StateBufferConnector_ms": 0.0027935383683544094, "ViewRequirementAgentConnector_ms": 0.07010799343303098}}, "episode_reward_max": -360.46403503569405, "episode_reward_min": -1129.9218310837296, "episode_reward_mean": -751.4207166832402, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-923.5364552454218, -862.5348525669727, -926.7890591245979, -644.5249914209028, -983.9948436232871, -661.5738640464544, -767.6943571691588, -784.1885188753826, -666.7810453907114, -360.46403503569405, -623.1491521666522, -598.9058034118659, -669.3836760950687, -1129.9218310837296, -564.8035701447418, -383.93914348902194, -749.0670555658398, -823.0128438058882, -973.2203297422689, -711.1108504958753, -664.8804460858096, -901.6806712317137, -856.9719691086589, -715.4068856637762, -1050.4726690457328, -690.2311397780416, -813.4451141091247, -750.6149491461733, -611.3273245529999, -477.6000462599683, -701.393332105827, -669.7402630350878, -648.3790898089699, -604.4827643406974, -771.9488604461665, -514.9391731234848, -681.7357675104101, -605.5031164992423, -989.4815077313855, -915.0504238071034, -739.6376485282495, -637.4949336273813, -813.4236583447815, -1044.049131854899, -760.2720658529917, -574.7015103061706, -793.8920419818169, -561.4809307948568, -522.5100115114014, -825.1119693436538, -729.7625996528775, -926.1607609593053, -765.0306223697702, -656.701926588058, -825.1623533226306, -1056.6224861659093, -947.4262632439014, -695.5562926958454, -1014.9432852767619], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.277770356248865, "mean_inference_ms": 0.4097994779573868, "mean_action_processing_ms": 0.09650364634388953, "mean_env_wait_ms": 4.075582407341627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00365265345169326, "StateBufferConnector_ms": 0.0027935383683544094, "ViewRequirementAgentConnector_ms": 0.07010799343303098}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 227640, "num_agent_steps_trained": 227640, "num_env_steps_sampled": 227640, "num_env_steps_trained": 227640, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.88884881105937, "num_env_steps_trained_throughput_per_sec": 40.88884881105937, "timesteps_total": 227640, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 227640, "timers": {"training_iteration_time_ms": 2904.794, "sample_time_ms": 2901.059, "load_time_ms": 0.219, "load_throughput": 547678.433, "learn_time_ms": 2.79, "learn_throughput": 43014.458, "synch_weights_time_ms": 0.687}, "counters": {"num_env_steps_sampled": 227640, "num_env_steps_trained": 227640, "num_agent_steps_sampled": 227640, "num_agent_steps_trained": 227640}, "done": false, "episodes_total": 1897, "training_iteration": 475, "trial_id": "53665_00000", "date": "2023-07-26_03-24-16", "timestamp": 1690331056, "time_this_iter_s": 11.742058038711548, "time_total_s": 5798.398406982422, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 177.07293105125427, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 39.91176470588235, "ram_util_percent": 72.80588235294118}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4844970703125, "policy_loss": -114780.4375, "vf_loss": 6246465.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 63.0, "diff_num_grad_updates_vs_sampler_policy": 62.0}}, "num_env_steps_sampled": 228120, "num_env_steps_trained": 228120, "num_agent_steps_sampled": 228120, "num_agent_steps_trained": 228120}, "sampler_results": {"episode_reward_max": -360.46403503569405, "episode_reward_min": -1129.9218310837296, "episode_reward_mean": -750.0552444366846, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-923.5364552454218, -862.5348525669727, -926.7890591245979, -644.5249914209028, -983.9948436232871, -661.5738640464544, -767.6943571691588, -784.1885188753826, -666.7810453907114, -360.46403503569405, -623.1491521666522, -598.9058034118659, -669.3836760950687, -1129.9218310837296, -564.8035701447418, -383.93914348902194, -749.0670555658398, -823.0128438058882, -973.2203297422689, -711.1108504958753, -664.8804460858096, -901.6806712317137, -856.9719691086589, -715.4068856637762, -1050.4726690457328, -690.2311397780416, -813.4451141091247, -750.6149491461733, -611.3273245529999, -477.6000462599683, -701.393332105827, -669.7402630350878, -648.3790898089699, -604.4827643406974, -771.9488604461665, -514.9391731234848, -681.7357675104101, -605.5031164992423, -989.4815077313855, -915.0504238071034, -739.6376485282495, -637.4949336273813, -813.4236583447815, -1044.049131854899, -760.2720658529917, -574.7015103061706, -793.8920419818169, -561.4809307948568, -522.5100115114014, -825.1119693436538, -729.7625996528775, -926.1607609593053, -765.0306223697702, -656.701926588058, -825.1623533226306, -1056.6224861659093, -947.4262632439014, -695.5562926958454, -1014.9432852767619, -700.8825639828477, -535.4924764872237, -869.4949961638353, -813.7880785660427], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.282293130214956, "mean_inference_ms": 0.40981716997021045, "mean_action_processing_ms": 0.09646657607207902, "mean_env_wait_ms": 4.010854930491943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036761874244326635, "StateBufferConnector_ms": 0.0027985799880254837, "ViewRequirementAgentConnector_ms": 0.06997812361944289}}, "episode_reward_max": -360.46403503569405, "episode_reward_min": -1129.9218310837296, "episode_reward_mean": -750.0552444366846, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-923.5364552454218, -862.5348525669727, -926.7890591245979, -644.5249914209028, -983.9948436232871, -661.5738640464544, -767.6943571691588, -784.1885188753826, -666.7810453907114, -360.46403503569405, -623.1491521666522, -598.9058034118659, -669.3836760950687, -1129.9218310837296, -564.8035701447418, -383.93914348902194, -749.0670555658398, -823.0128438058882, -973.2203297422689, -711.1108504958753, -664.8804460858096, -901.6806712317137, -856.9719691086589, -715.4068856637762, -1050.4726690457328, -690.2311397780416, -813.4451141091247, -750.6149491461733, -611.3273245529999, -477.6000462599683, -701.393332105827, -669.7402630350878, -648.3790898089699, -604.4827643406974, -771.9488604461665, -514.9391731234848, -681.7357675104101, -605.5031164992423, -989.4815077313855, -915.0504238071034, -739.6376485282495, -637.4949336273813, -813.4236583447815, -1044.049131854899, -760.2720658529917, -574.7015103061706, -793.8920419818169, -561.4809307948568, -522.5100115114014, -825.1119693436538, -729.7625996528775, -926.1607609593053, -765.0306223697702, -656.701926588058, -825.1623533226306, -1056.6224861659093, -947.4262632439014, -695.5562926958454, -1014.9432852767619, -700.8825639828477, -535.4924764872237, -869.4949961638353, -813.7880785660427], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.282293130214956, "mean_inference_ms": 0.40981716997021045, "mean_action_processing_ms": 0.09646657607207902, "mean_env_wait_ms": 4.010854930491943, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036761874244326635, "StateBufferConnector_ms": 0.0027985799880254837, "ViewRequirementAgentConnector_ms": 0.06997812361944289}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228120, "num_agent_steps_trained": 228120, "num_env_steps_sampled": 228120, "num_env_steps_trained": 228120, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.1879991010096, "num_env_steps_trained_throughput_per_sec": 40.1879991010096, "timesteps_total": 228120, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 228120, "timers": {"training_iteration_time_ms": 2949.617, "sample_time_ms": 2945.897, "load_time_ms": 0.218, "load_throughput": 550253.067, "learn_time_ms": 2.774, "learn_throughput": 43256.599, "synch_weights_time_ms": 0.688}, "counters": {"num_env_steps_sampled": 228120, "num_env_steps_trained": 228120, "num_agent_steps_sampled": 228120, "num_agent_steps_trained": 228120}, "done": false, "episodes_total": 1901, "training_iteration": 476, "trial_id": "53665_00000", "date": "2023-07-26_03-24-27", "timestamp": 1690331067, "time_this_iter_s": 11.946455001831055, "time_total_s": 5810.344861984253, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 189.01938605308533, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 37.51176470588235, "ram_util_percent": 73.37647058823529}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4920654296875, "policy_loss": -88229.765625, "vf_loss": 3553723.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 67.0, "diff_num_grad_updates_vs_sampler_policy": 66.0}}, "num_env_steps_sampled": 228600, "num_env_steps_trained": 228600, "num_agent_steps_sampled": 228600, "num_agent_steps_trained": 228600}, "sampler_results": {"episode_reward_max": -360.46403503569405, "episode_reward_min": -1129.9218310837296, "episode_reward_mean": -749.3909003111155, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-923.5364552454218, -862.5348525669727, -926.7890591245979, -644.5249914209028, -983.9948436232871, -661.5738640464544, -767.6943571691588, -784.1885188753826, -666.7810453907114, -360.46403503569405, -623.1491521666522, -598.9058034118659, -669.3836760950687, -1129.9218310837296, -564.8035701447418, -383.93914348902194, -749.0670555658398, -823.0128438058882, -973.2203297422689, -711.1108504958753, -664.8804460858096, -901.6806712317137, -856.9719691086589, -715.4068856637762, -1050.4726690457328, -690.2311397780416, -813.4451141091247, -750.6149491461733, -611.3273245529999, -477.6000462599683, -701.393332105827, -669.7402630350878, -648.3790898089699, -604.4827643406974, -771.9488604461665, -514.9391731234848, -681.7357675104101, -605.5031164992423, -989.4815077313855, -915.0504238071034, -739.6376485282495, -637.4949336273813, -813.4236583447815, -1044.049131854899, -760.2720658529917, -574.7015103061706, -793.8920419818169, -561.4809307948568, -522.5100115114014, -825.1119693436538, -729.7625996528775, -926.1607609593053, -765.0306223697702, -656.701926588058, -825.1623533226306, -1056.6224861659093, -947.4262632439014, -695.5562926958454, -1014.9432852767619, -700.8825639828477, -535.4924764872237, -869.4949961638353, -813.7880785660427, -1063.7998193910535, -627.4015267093903, -487.4881272053504, -777.0204480278159], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.284234373485056, "mean_inference_ms": 0.4097772947941137, "mean_action_processing_ms": 0.09642872595167461, "mean_env_wait_ms": 3.9524609090859193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003692997035695546, "StateBufferConnector_ms": 0.0027898532241138058, "ViewRequirementAgentConnector_ms": 0.06986447234651935}}, "episode_reward_max": -360.46403503569405, "episode_reward_min": -1129.9218310837296, "episode_reward_mean": -749.3909003111155, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-923.5364552454218, -862.5348525669727, -926.7890591245979, -644.5249914209028, -983.9948436232871, -661.5738640464544, -767.6943571691588, -784.1885188753826, -666.7810453907114, -360.46403503569405, -623.1491521666522, -598.9058034118659, -669.3836760950687, -1129.9218310837296, -564.8035701447418, -383.93914348902194, -749.0670555658398, -823.0128438058882, -973.2203297422689, -711.1108504958753, -664.8804460858096, -901.6806712317137, -856.9719691086589, -715.4068856637762, -1050.4726690457328, -690.2311397780416, -813.4451141091247, -750.6149491461733, -611.3273245529999, -477.6000462599683, -701.393332105827, -669.7402630350878, -648.3790898089699, -604.4827643406974, -771.9488604461665, -514.9391731234848, -681.7357675104101, -605.5031164992423, -989.4815077313855, -915.0504238071034, -739.6376485282495, -637.4949336273813, -813.4236583447815, -1044.049131854899, -760.2720658529917, -574.7015103061706, -793.8920419818169, -561.4809307948568, -522.5100115114014, -825.1119693436538, -729.7625996528775, -926.1607609593053, -765.0306223697702, -656.701926588058, -825.1623533226306, -1056.6224861659093, -947.4262632439014, -695.5562926958454, -1014.9432852767619, -700.8825639828477, -535.4924764872237, -869.4949961638353, -813.7880785660427, -1063.7998193910535, -627.4015267093903, -487.4881272053504, -777.0204480278159], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.284234373485056, "mean_inference_ms": 0.4097772947941137, "mean_action_processing_ms": 0.09642872595167461, "mean_env_wait_ms": 3.9524609090859193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003692997035695546, "StateBufferConnector_ms": 0.0027898532241138058, "ViewRequirementAgentConnector_ms": 0.06986447234651935}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228600, "num_agent_steps_trained": 228600, "num_env_steps_sampled": 228600, "num_env_steps_trained": 228600, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.65638160995112, "num_env_steps_trained_throughput_per_sec": 41.65638160995112, "timesteps_total": 228600, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 228600, "timers": {"training_iteration_time_ms": 2932.546, "sample_time_ms": 2928.786, "load_time_ms": 0.22, "load_throughput": 546251.878, "learn_time_ms": 2.796, "learn_throughput": 42925.68, "synch_weights_time_ms": 0.704}, "counters": {"num_env_steps_sampled": 228600, "num_env_steps_trained": 228600, "num_agent_steps_sampled": 228600, "num_agent_steps_trained": 228600}, "done": false, "episodes_total": 1905, "training_iteration": 477, "trial_id": "53665_00000", "date": "2023-07-26_03-24-39", "timestamp": 1690331079, "time_this_iter_s": 11.525509119033813, "time_total_s": 5821.870371103287, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 200.54489517211914, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 34.13125, "ram_util_percent": 75.9125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4831237792969, "policy_loss": -109048.5078125, "vf_loss": 5922003.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 71.0, "diff_num_grad_updates_vs_sampler_policy": 70.0}}, "num_env_steps_sampled": 229080, "num_env_steps_trained": 229080, "num_agent_steps_sampled": 229080, "num_agent_steps_trained": 229080}, "sampler_results": {"episode_reward_max": -360.46403503569405, "episode_reward_min": -1228.638734842368, "episode_reward_mean": -755.3196277042497, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-923.5364552454218, -862.5348525669727, -926.7890591245979, -644.5249914209028, -983.9948436232871, -661.5738640464544, -767.6943571691588, -784.1885188753826, -666.7810453907114, -360.46403503569405, -623.1491521666522, -598.9058034118659, -669.3836760950687, -1129.9218310837296, -564.8035701447418, -383.93914348902194, -749.0670555658398, -823.0128438058882, -973.2203297422689, -711.1108504958753, -664.8804460858096, -901.6806712317137, -856.9719691086589, -715.4068856637762, -1050.4726690457328, -690.2311397780416, -813.4451141091247, -750.6149491461733, -611.3273245529999, -477.6000462599683, -701.393332105827, -669.7402630350878, -648.3790898089699, -604.4827643406974, -771.9488604461665, -514.9391731234848, -681.7357675104101, -605.5031164992423, -989.4815077313855, -915.0504238071034, -739.6376485282495, -637.4949336273813, -813.4236583447815, -1044.049131854899, -760.2720658529917, -574.7015103061706, -793.8920419818169, -561.4809307948568, -522.5100115114014, -825.1119693436538, -729.7625996528775, -926.1607609593053, -765.0306223697702, -656.701926588058, -825.1623533226306, -1056.6224861659093, -947.4262632439014, -695.5562926958454, -1014.9432852767619, -700.8825639828477, -535.4924764872237, -869.4949961638353, -813.7880785660427, -1063.7998193910535, -627.4015267093903, -487.4881272053504, -777.0204480278159, -570.4658893786288, -1228.638734842368, -849.224770025147, -770.1738519108461], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.283802366498296, "mean_inference_ms": 0.4097347461184745, "mean_action_processing_ms": 0.09639765414576805, "mean_env_wait_ms": 3.8994326103699306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036625794961418906, "StateBufferConnector_ms": 0.002781438155913017, "ViewRequirementAgentConnector_ms": 0.06970486170809034}}, "episode_reward_max": -360.46403503569405, "episode_reward_min": -1228.638734842368, "episode_reward_mean": -755.3196277042497, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-923.5364552454218, -862.5348525669727, -926.7890591245979, -644.5249914209028, -983.9948436232871, -661.5738640464544, -767.6943571691588, -784.1885188753826, -666.7810453907114, -360.46403503569405, -623.1491521666522, -598.9058034118659, -669.3836760950687, -1129.9218310837296, -564.8035701447418, -383.93914348902194, -749.0670555658398, -823.0128438058882, -973.2203297422689, -711.1108504958753, -664.8804460858096, -901.6806712317137, -856.9719691086589, -715.4068856637762, -1050.4726690457328, -690.2311397780416, -813.4451141091247, -750.6149491461733, -611.3273245529999, -477.6000462599683, -701.393332105827, -669.7402630350878, -648.3790898089699, -604.4827643406974, -771.9488604461665, -514.9391731234848, -681.7357675104101, -605.5031164992423, -989.4815077313855, -915.0504238071034, -739.6376485282495, -637.4949336273813, -813.4236583447815, -1044.049131854899, -760.2720658529917, -574.7015103061706, -793.8920419818169, -561.4809307948568, -522.5100115114014, -825.1119693436538, -729.7625996528775, -926.1607609593053, -765.0306223697702, -656.701926588058, -825.1623533226306, -1056.6224861659093, -947.4262632439014, -695.5562926958454, -1014.9432852767619, -700.8825639828477, -535.4924764872237, -869.4949961638353, -813.7880785660427, -1063.7998193910535, -627.4015267093903, -487.4881272053504, -777.0204480278159, -570.4658893786288, -1228.638734842368, -849.224770025147, -770.1738519108461], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.283802366498296, "mean_inference_ms": 0.4097347461184745, "mean_action_processing_ms": 0.09639765414576805, "mean_env_wait_ms": 3.8994326103699306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036625794961418906, "StateBufferConnector_ms": 0.002781438155913017, "ViewRequirementAgentConnector_ms": 0.06970486170809034}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 229080, "num_agent_steps_trained": 229080, "num_env_steps_sampled": 229080, "num_env_steps_trained": 229080, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.900849336455636, "num_env_steps_trained_throughput_per_sec": 41.900849336455636, "timesteps_total": 229080, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 229080, "timers": {"training_iteration_time_ms": 2886.628, "sample_time_ms": 2882.855, "load_time_ms": 0.219, "load_throughput": 546845.372, "learn_time_ms": 2.805, "learn_throughput": 42785.923, "synch_weights_time_ms": 0.709}, "counters": {"num_env_steps_sampled": 229080, "num_env_steps_trained": 229080, "num_agent_steps_sampled": 229080, "num_agent_steps_trained": 229080}, "done": false, "episodes_total": 1909, "training_iteration": 478, "trial_id": "53665_00000", "date": "2023-07-26_03-24-51", "timestamp": 1690331091, "time_this_iter_s": 11.458451271057129, "time_total_s": 5833.328822374344, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 212.00334644317627, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 36.28125, "ram_util_percent": 76.31875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.47711181640625, "policy_loss": -80723.28125, "vf_loss": 2910039.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 75.0, "diff_num_grad_updates_vs_sampler_policy": 74.0}}, "num_env_steps_sampled": 229560, "num_env_steps_trained": 229560, "num_agent_steps_sampled": 229560, "num_agent_steps_trained": 229560}, "sampler_results": {"episode_reward_max": -360.46403503569405, "episode_reward_min": -1228.638734842368, "episode_reward_mean": -752.3429221073907, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-923.5364552454218, -862.5348525669727, -926.7890591245979, -644.5249914209028, -983.9948436232871, -661.5738640464544, -767.6943571691588, -784.1885188753826, -666.7810453907114, -360.46403503569405, -623.1491521666522, -598.9058034118659, -669.3836760950687, -1129.9218310837296, -564.8035701447418, -383.93914348902194, -749.0670555658398, -823.0128438058882, -973.2203297422689, -711.1108504958753, -664.8804460858096, -901.6806712317137, -856.9719691086589, -715.4068856637762, -1050.4726690457328, -690.2311397780416, -813.4451141091247, -750.6149491461733, -611.3273245529999, -477.6000462599683, -701.393332105827, -669.7402630350878, -648.3790898089699, -604.4827643406974, -771.9488604461665, -514.9391731234848, -681.7357675104101, -605.5031164992423, -989.4815077313855, -915.0504238071034, -739.6376485282495, -637.4949336273813, -813.4236583447815, -1044.049131854899, -760.2720658529917, -574.7015103061706, -793.8920419818169, -561.4809307948568, -522.5100115114014, -825.1119693436538, -729.7625996528775, -926.1607609593053, -765.0306223697702, -656.701926588058, -825.1623533226306, -1056.6224861659093, -947.4262632439014, -695.5562926958454, -1014.9432852767619, -700.8825639828477, -535.4924764872237, -869.4949961638353, -813.7880785660427, -1063.7998193910535, -627.4015267093903, -487.4881272053504, -777.0204480278159, -570.4658893786288, -1228.638734842368, -849.224770025147, -770.1738519108461, -608.9017541481696, -792.5159874240176, -743.3822906671751, -653.2255588132094], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.286014325345285, "mean_inference_ms": 0.4096797353764042, "mean_action_processing_ms": 0.09636856548145376, "mean_env_wait_ms": 3.8509502032552634, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036334991455078125, "StateBufferConnector_ms": 0.0027812321980794272, "ViewRequirementAgentConnector_ms": 0.06957753499348958}}, "episode_reward_max": -360.46403503569405, "episode_reward_min": -1228.638734842368, "episode_reward_mean": -752.3429221073907, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-923.5364552454218, -862.5348525669727, -926.7890591245979, -644.5249914209028, -983.9948436232871, -661.5738640464544, -767.6943571691588, -784.1885188753826, -666.7810453907114, -360.46403503569405, -623.1491521666522, -598.9058034118659, -669.3836760950687, -1129.9218310837296, -564.8035701447418, -383.93914348902194, -749.0670555658398, -823.0128438058882, -973.2203297422689, -711.1108504958753, -664.8804460858096, -901.6806712317137, -856.9719691086589, -715.4068856637762, -1050.4726690457328, -690.2311397780416, -813.4451141091247, -750.6149491461733, -611.3273245529999, -477.6000462599683, -701.393332105827, -669.7402630350878, -648.3790898089699, -604.4827643406974, -771.9488604461665, -514.9391731234848, -681.7357675104101, -605.5031164992423, -989.4815077313855, -915.0504238071034, -739.6376485282495, -637.4949336273813, -813.4236583447815, -1044.049131854899, -760.2720658529917, -574.7015103061706, -793.8920419818169, -561.4809307948568, -522.5100115114014, -825.1119693436538, -729.7625996528775, -926.1607609593053, -765.0306223697702, -656.701926588058, -825.1623533226306, -1056.6224861659093, -947.4262632439014, -695.5562926958454, -1014.9432852767619, -700.8825639828477, -535.4924764872237, -869.4949961638353, -813.7880785660427, -1063.7998193910535, -627.4015267093903, -487.4881272053504, -777.0204480278159, -570.4658893786288, -1228.638734842368, -849.224770025147, -770.1738519108461, -608.9017541481696, -792.5159874240176, -743.3822906671751, -653.2255588132094], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.286014325345285, "mean_inference_ms": 0.4096797353764042, "mean_action_processing_ms": 0.09636856548145376, "mean_env_wait_ms": 3.8509502032552634, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036334991455078125, "StateBufferConnector_ms": 0.0027812321980794272, "ViewRequirementAgentConnector_ms": 0.06957753499348958}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 229560, "num_agent_steps_trained": 229560, "num_env_steps_sampled": 229560, "num_env_steps_trained": 229560, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.39257588134872, "num_env_steps_trained_throughput_per_sec": 39.39257588134872, "timesteps_total": 229560, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 229560, "timers": {"training_iteration_time_ms": 2931.059, "sample_time_ms": 2927.293, "load_time_ms": 0.219, "load_throughput": 546904.792, "learn_time_ms": 2.8, "learn_throughput": 42854.775, "synch_weights_time_ms": 0.706}, "counters": {"num_env_steps_sampled": 229560, "num_env_steps_trained": 229560, "num_agent_steps_sampled": 229560, "num_agent_steps_trained": 229560}, "done": false, "episodes_total": 1913, "training_iteration": 479, "trial_id": "53665_00000", "date": "2023-07-26_03-25-03", "timestamp": 1690331103, "time_this_iter_s": 12.187819004058838, "time_total_s": 5845.516641378403, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 224.1911654472351, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 41.30555555555556, "ram_util_percent": 77.73888888888888}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.517822265625, "policy_loss": -101043.4296875, "vf_loss": 4707336.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 79.0, "diff_num_grad_updates_vs_sampler_policy": 78.0}}, "num_env_steps_sampled": 230040, "num_env_steps_trained": 230040, "num_agent_steps_sampled": 230040, "num_agent_steps_trained": 230040}, "sampler_results": {"episode_reward_max": -360.46403503569405, "episode_reward_min": -1228.638734842368, "episode_reward_mean": -762.9134714723384, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-923.5364552454218, -862.5348525669727, -926.7890591245979, -644.5249914209028, -983.9948436232871, -661.5738640464544, -767.6943571691588, -784.1885188753826, -666.7810453907114, -360.46403503569405, -623.1491521666522, -598.9058034118659, -669.3836760950687, -1129.9218310837296, -564.8035701447418, -383.93914348902194, -749.0670555658398, -823.0128438058882, -973.2203297422689, -711.1108504958753, -664.8804460858096, -901.6806712317137, -856.9719691086589, -715.4068856637762, -1050.4726690457328, -690.2311397780416, -813.4451141091247, -750.6149491461733, -611.3273245529999, -477.6000462599683, -701.393332105827, -669.7402630350878, -648.3790898089699, -604.4827643406974, -771.9488604461665, -514.9391731234848, -681.7357675104101, -605.5031164992423, -989.4815077313855, -915.0504238071034, -739.6376485282495, -637.4949336273813, -813.4236583447815, -1044.049131854899, -760.2720658529917, -574.7015103061706, -793.8920419818169, -561.4809307948568, -522.5100115114014, -825.1119693436538, -729.7625996528775, -926.1607609593053, -765.0306223697702, -656.701926588058, -825.1623533226306, -1056.6224861659093, -947.4262632439014, -695.5562926958454, -1014.9432852767619, -700.8825639828477, -535.4924764872237, -869.4949961638353, -813.7880785660427, -1063.7998193910535, -627.4015267093903, -487.4881272053504, -777.0204480278159, -570.4658893786288, -1228.638734842368, -849.224770025147, -770.1738519108461, -608.9017541481696, -792.5159874240176, -743.3822906671751, -653.2255588132094, -915.5377922969163, -967.9164083879504, -1224.124753580239, -736.8661339953352], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.28763119701338, "mean_inference_ms": 0.4095931065595329, "mean_action_processing_ms": 0.09633824230957454, "mean_env_wait_ms": 3.806518858061577, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036143049409117878, "StateBufferConnector_ms": 0.002776821957358831, "ViewRequirementAgentConnector_ms": 0.06949388528171974}}, "episode_reward_max": -360.46403503569405, "episode_reward_min": -1228.638734842368, "episode_reward_mean": -762.9134714723384, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-923.5364552454218, -862.5348525669727, -926.7890591245979, -644.5249914209028, -983.9948436232871, -661.5738640464544, -767.6943571691588, -784.1885188753826, -666.7810453907114, -360.46403503569405, -623.1491521666522, -598.9058034118659, -669.3836760950687, -1129.9218310837296, -564.8035701447418, -383.93914348902194, -749.0670555658398, -823.0128438058882, -973.2203297422689, -711.1108504958753, -664.8804460858096, -901.6806712317137, -856.9719691086589, -715.4068856637762, -1050.4726690457328, -690.2311397780416, -813.4451141091247, -750.6149491461733, -611.3273245529999, -477.6000462599683, -701.393332105827, -669.7402630350878, -648.3790898089699, -604.4827643406974, -771.9488604461665, -514.9391731234848, -681.7357675104101, -605.5031164992423, -989.4815077313855, -915.0504238071034, -739.6376485282495, -637.4949336273813, -813.4236583447815, -1044.049131854899, -760.2720658529917, -574.7015103061706, -793.8920419818169, -561.4809307948568, -522.5100115114014, -825.1119693436538, -729.7625996528775, -926.1607609593053, -765.0306223697702, -656.701926588058, -825.1623533226306, -1056.6224861659093, -947.4262632439014, -695.5562926958454, -1014.9432852767619, -700.8825639828477, -535.4924764872237, -869.4949961638353, -813.7880785660427, -1063.7998193910535, -627.4015267093903, -487.4881272053504, -777.0204480278159, -570.4658893786288, -1228.638734842368, -849.224770025147, -770.1738519108461, -608.9017541481696, -792.5159874240176, -743.3822906671751, -653.2255588132094, -915.5377922969163, -967.9164083879504, -1224.124753580239, -736.8661339953352], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.28763119701338, "mean_inference_ms": 0.4095931065595329, "mean_action_processing_ms": 0.09633824230957454, "mean_env_wait_ms": 3.806518858061577, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036143049409117878, "StateBufferConnector_ms": 0.002776821957358831, "ViewRequirementAgentConnector_ms": 0.06949388528171974}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 230040, "num_agent_steps_trained": 230040, "num_env_steps_sampled": 230040, "num_env_steps_trained": 230040, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.98219285130052, "num_env_steps_trained_throughput_per_sec": 40.98219285130052, "timesteps_total": 230040, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 230040, "timers": {"training_iteration_time_ms": 2960.425, "sample_time_ms": 2956.646, "load_time_ms": 0.219, "load_throughput": 547083.13, "learn_time_ms": 2.802, "learn_throughput": 42825.604, "synch_weights_time_ms": 0.718}, "counters": {"num_env_steps_sampled": 230040, "num_env_steps_trained": 230040, "num_agent_steps_sampled": 230040, "num_agent_steps_trained": 230040}, "done": false, "episodes_total": 1917, "training_iteration": 480, "trial_id": "53665_00000", "date": "2023-07-26_03-25-14", "timestamp": 1690331114, "time_this_iter_s": 11.715106725692749, "time_total_s": 5857.2317481040955, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 235.90627217292786, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 40.118750000000006, "ram_util_percent": 74.4375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.48748779296875, "policy_loss": -160272.34375, "vf_loss": 11379218.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 83.0, "diff_num_grad_updates_vs_sampler_policy": 82.0}}, "num_env_steps_sampled": 230520, "num_env_steps_trained": 230520, "num_agent_steps_sampled": 230520, "num_agent_steps_trained": 230520}, "sampler_results": {"episode_reward_max": -360.46403503569405, "episode_reward_min": -1228.638734842368, "episode_reward_mean": -763.2276344507469, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-923.5364552454218, -862.5348525669727, -926.7890591245979, -644.5249914209028, -983.9948436232871, -661.5738640464544, -767.6943571691588, -784.1885188753826, -666.7810453907114, -360.46403503569405, -623.1491521666522, -598.9058034118659, -669.3836760950687, -1129.9218310837296, -564.8035701447418, -383.93914348902194, -749.0670555658398, -823.0128438058882, -973.2203297422689, -711.1108504958753, -664.8804460858096, -901.6806712317137, -856.9719691086589, -715.4068856637762, -1050.4726690457328, -690.2311397780416, -813.4451141091247, -750.6149491461733, -611.3273245529999, -477.6000462599683, -701.393332105827, -669.7402630350878, -648.3790898089699, -604.4827643406974, -771.9488604461665, -514.9391731234848, -681.7357675104101, -605.5031164992423, -989.4815077313855, -915.0504238071034, -739.6376485282495, -637.4949336273813, -813.4236583447815, -1044.049131854899, -760.2720658529917, -574.7015103061706, -793.8920419818169, -561.4809307948568, -522.5100115114014, -825.1119693436538, -729.7625996528775, -926.1607609593053, -765.0306223697702, -656.701926588058, -825.1623533226306, -1056.6224861659093, -947.4262632439014, -695.5562926958454, -1014.9432852767619, -700.8825639828477, -535.4924764872237, -869.4949961638353, -813.7880785660427, -1063.7998193910535, -627.4015267093903, -487.4881272053504, -777.0204480278159, -570.4658893786288, -1228.638734842368, -849.224770025147, -770.1738519108461, -608.9017541481696, -792.5159874240176, -743.3822906671751, -653.2255588132094, -915.5377922969163, -967.9164083879504, -1224.124753580239, -736.8661339953352, -871.9493199469679, -449.44088607528846, -533.531392144829, -1222.8078149301723], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.289946896706365, "mean_inference_ms": 0.4094796367419241, "mean_action_processing_ms": 0.09630630415499716, "mean_env_wait_ms": 3.7655761063294637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036765293902661427, "StateBufferConnector_ms": 0.0027748475591820405, "ViewRequirementAgentConnector_ms": 0.06930684468832361}}, "episode_reward_max": -360.46403503569405, "episode_reward_min": -1228.638734842368, "episode_reward_mean": -763.2276344507469, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-923.5364552454218, -862.5348525669727, -926.7890591245979, -644.5249914209028, -983.9948436232871, -661.5738640464544, -767.6943571691588, -784.1885188753826, -666.7810453907114, -360.46403503569405, -623.1491521666522, -598.9058034118659, -669.3836760950687, -1129.9218310837296, -564.8035701447418, -383.93914348902194, -749.0670555658398, -823.0128438058882, -973.2203297422689, -711.1108504958753, -664.8804460858096, -901.6806712317137, -856.9719691086589, -715.4068856637762, -1050.4726690457328, -690.2311397780416, -813.4451141091247, -750.6149491461733, -611.3273245529999, -477.6000462599683, -701.393332105827, -669.7402630350878, -648.3790898089699, -604.4827643406974, -771.9488604461665, -514.9391731234848, -681.7357675104101, -605.5031164992423, -989.4815077313855, -915.0504238071034, -739.6376485282495, -637.4949336273813, -813.4236583447815, -1044.049131854899, -760.2720658529917, -574.7015103061706, -793.8920419818169, -561.4809307948568, -522.5100115114014, -825.1119693436538, -729.7625996528775, -926.1607609593053, -765.0306223697702, -656.701926588058, -825.1623533226306, -1056.6224861659093, -947.4262632439014, -695.5562926958454, -1014.9432852767619, -700.8825639828477, -535.4924764872237, -869.4949961638353, -813.7880785660427, -1063.7998193910535, -627.4015267093903, -487.4881272053504, -777.0204480278159, -570.4658893786288, -1228.638734842368, -849.224770025147, -770.1738519108461, -608.9017541481696, -792.5159874240176, -743.3822906671751, -653.2255588132094, -915.5377922969163, -967.9164083879504, -1224.124753580239, -736.8661339953352, -871.9493199469679, -449.44088607528846, -533.531392144829, -1222.8078149301723], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.289946896706365, "mean_inference_ms": 0.4094796367419241, "mean_action_processing_ms": 0.09630630415499716, "mean_env_wait_ms": 3.7655761063294637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036765293902661427, "StateBufferConnector_ms": 0.0027748475591820405, "ViewRequirementAgentConnector_ms": 0.06930684468832361}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 230520, "num_agent_steps_trained": 230520, "num_env_steps_sampled": 230520, "num_env_steps_trained": 230520, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.19262280698147, "num_env_steps_trained_throughput_per_sec": 40.19262280698147, "timesteps_total": 230520, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 230520, "timers": {"training_iteration_time_ms": 2947.338, "sample_time_ms": 2943.567, "load_time_ms": 0.219, "load_throughput": 548275.033, "learn_time_ms": 2.793, "learn_throughput": 42965.622, "synch_weights_time_ms": 0.718}, "counters": {"num_env_steps_sampled": 230520, "num_env_steps_trained": 230520, "num_agent_steps_sampled": 230520, "num_agent_steps_trained": 230520}, "done": false, "episodes_total": 1921, "training_iteration": 481, "trial_id": "53665_00000", "date": "2023-07-26_03-25-26", "timestamp": 1690331126, "time_this_iter_s": 11.945167303085327, "time_total_s": 5869.176915407181, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 247.85143947601318, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 41.48235294117647, "ram_util_percent": 76.14117647058822}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4884033203125, "policy_loss": -115976.6484375, "vf_loss": 5433998.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 87.0, "diff_num_grad_updates_vs_sampler_policy": 86.0}}, "num_env_steps_sampled": 231000, "num_env_steps_trained": 231000, "num_agent_steps_sampled": 231000, "num_agent_steps_trained": 231000}, "sampler_results": {"episode_reward_max": -360.46403503569405, "episode_reward_min": -1228.638734842368, "episode_reward_mean": -761.489418710466, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-923.5364552454218, -862.5348525669727, -926.7890591245979, -644.5249914209028, -983.9948436232871, -661.5738640464544, -767.6943571691588, -784.1885188753826, -666.7810453907114, -360.46403503569405, -623.1491521666522, -598.9058034118659, -669.3836760950687, -1129.9218310837296, -564.8035701447418, -383.93914348902194, -749.0670555658398, -823.0128438058882, -973.2203297422689, -711.1108504958753, -664.8804460858096, -901.6806712317137, -856.9719691086589, -715.4068856637762, -1050.4726690457328, -690.2311397780416, -813.4451141091247, -750.6149491461733, -611.3273245529999, -477.6000462599683, -701.393332105827, -669.7402630350878, -648.3790898089699, -604.4827643406974, -771.9488604461665, -514.9391731234848, -681.7357675104101, -605.5031164992423, -989.4815077313855, -915.0504238071034, -739.6376485282495, -637.4949336273813, -813.4236583447815, -1044.049131854899, -760.2720658529917, -574.7015103061706, -793.8920419818169, -561.4809307948568, -522.5100115114014, -825.1119693436538, -729.7625996528775, -926.1607609593053, -765.0306223697702, -656.701926588058, -825.1623533226306, -1056.6224861659093, -947.4262632439014, -695.5562926958454, -1014.9432852767619, -700.8825639828477, -535.4924764872237, -869.4949961638353, -813.7880785660427, -1063.7998193910535, -627.4015267093903, -487.4881272053504, -777.0204480278159, -570.4658893786288, -1228.638734842368, -849.224770025147, -770.1738519108461, -608.9017541481696, -792.5159874240176, -743.3822906671751, -653.2255588132094, -915.5377922969163, -967.9164083879504, -1224.124753580239, -736.8661339953352, -871.9493199469679, -449.44088607528846, -533.531392144829, -1222.8078149301723, -591.0592238638071, -732.1603902783818, -789.8588830338664, -788.6072712225003], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.29061256966227, "mean_inference_ms": 0.4093594043416772, "mean_action_processing_ms": 0.09627634611478263, "mean_env_wait_ms": 3.7277846942760804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036911032665735005, "StateBufferConnector_ms": 0.0027782615573926903, "ViewRequirementAgentConnector_ms": 0.06923456301634338}}, "episode_reward_max": -360.46403503569405, "episode_reward_min": -1228.638734842368, "episode_reward_mean": -761.489418710466, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-923.5364552454218, -862.5348525669727, -926.7890591245979, -644.5249914209028, -983.9948436232871, -661.5738640464544, -767.6943571691588, -784.1885188753826, -666.7810453907114, -360.46403503569405, -623.1491521666522, -598.9058034118659, -669.3836760950687, -1129.9218310837296, -564.8035701447418, -383.93914348902194, -749.0670555658398, -823.0128438058882, -973.2203297422689, -711.1108504958753, -664.8804460858096, -901.6806712317137, -856.9719691086589, -715.4068856637762, -1050.4726690457328, -690.2311397780416, -813.4451141091247, -750.6149491461733, -611.3273245529999, -477.6000462599683, -701.393332105827, -669.7402630350878, -648.3790898089699, -604.4827643406974, -771.9488604461665, -514.9391731234848, -681.7357675104101, -605.5031164992423, -989.4815077313855, -915.0504238071034, -739.6376485282495, -637.4949336273813, -813.4236583447815, -1044.049131854899, -760.2720658529917, -574.7015103061706, -793.8920419818169, -561.4809307948568, -522.5100115114014, -825.1119693436538, -729.7625996528775, -926.1607609593053, -765.0306223697702, -656.701926588058, -825.1623533226306, -1056.6224861659093, -947.4262632439014, -695.5562926958454, -1014.9432852767619, -700.8825639828477, -535.4924764872237, -869.4949961638353, -813.7880785660427, -1063.7998193910535, -627.4015267093903, -487.4881272053504, -777.0204480278159, -570.4658893786288, -1228.638734842368, -849.224770025147, -770.1738519108461, -608.9017541481696, -792.5159874240176, -743.3822906671751, -653.2255588132094, -915.5377922969163, -967.9164083879504, -1224.124753580239, -736.8661339953352, -871.9493199469679, -449.44088607528846, -533.531392144829, -1222.8078149301723, -591.0592238638071, -732.1603902783818, -789.8588830338664, -788.6072712225003], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.29061256966227, "mean_inference_ms": 0.4093594043416772, "mean_action_processing_ms": 0.09627634611478263, "mean_env_wait_ms": 3.7277846942760804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036911032665735005, "StateBufferConnector_ms": 0.0027782615573926903, "ViewRequirementAgentConnector_ms": 0.06923456301634338}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 231000, "num_agent_steps_trained": 231000, "num_env_steps_sampled": 231000, "num_env_steps_trained": 231000, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.84600869554536, "num_env_steps_trained_throughput_per_sec": 41.84600869554536, "timesteps_total": 231000, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 231000, "timers": {"training_iteration_time_ms": 2935.504, "sample_time_ms": 2931.639, "load_time_ms": 0.226, "load_throughput": 531597.465, "learn_time_ms": 2.875, "learn_throughput": 41739.906, "synch_weights_time_ms": 0.719}, "counters": {"num_env_steps_sampled": 231000, "num_env_steps_trained": 231000, "num_agent_steps_sampled": 231000, "num_agent_steps_trained": 231000}, "done": false, "episodes_total": 1925, "training_iteration": 482, "trial_id": "53665_00000", "date": "2023-07-26_03-25-38", "timestamp": 1690331138, "time_this_iter_s": 11.473381757736206, "time_total_s": 5880.650297164917, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 259.3248212337494, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 36.182352941176475, "ram_util_percent": 73.14117647058822}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4990234375, "policy_loss": -100964.6640625, "vf_loss": 5302288.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 91.0, "diff_num_grad_updates_vs_sampler_policy": 90.0}}, "num_env_steps_sampled": 231480, "num_env_steps_trained": 231480, "num_agent_steps_sampled": 231480, "num_agent_steps_trained": 231480}, "sampler_results": {"episode_reward_max": -360.46403503569405, "episode_reward_min": -1228.638734842368, "episode_reward_mean": -761.67685075197, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-923.5364552454218, -862.5348525669727, -926.7890591245979, -644.5249914209028, -983.9948436232871, -661.5738640464544, -767.6943571691588, -784.1885188753826, -666.7810453907114, -360.46403503569405, -623.1491521666522, -598.9058034118659, -669.3836760950687, -1129.9218310837296, -564.8035701447418, -383.93914348902194, -749.0670555658398, -823.0128438058882, -973.2203297422689, -711.1108504958753, -664.8804460858096, -901.6806712317137, -856.9719691086589, -715.4068856637762, -1050.4726690457328, -690.2311397780416, -813.4451141091247, -750.6149491461733, -611.3273245529999, -477.6000462599683, -701.393332105827, -669.7402630350878, -648.3790898089699, -604.4827643406974, -771.9488604461665, -514.9391731234848, -681.7357675104101, -605.5031164992423, -989.4815077313855, -915.0504238071034, -739.6376485282495, -637.4949336273813, -813.4236583447815, -1044.049131854899, -760.2720658529917, -574.7015103061706, -793.8920419818169, -561.4809307948568, -522.5100115114014, -825.1119693436538, -729.7625996528775, -926.1607609593053, -765.0306223697702, -656.701926588058, -825.1623533226306, -1056.6224861659093, -947.4262632439014, -695.5562926958454, -1014.9432852767619, -700.8825639828477, -535.4924764872237, -869.4949961638353, -813.7880785660427, -1063.7998193910535, -627.4015267093903, -487.4881272053504, -777.0204480278159, -570.4658893786288, -1228.638734842368, -849.224770025147, -770.1738519108461, -608.9017541481696, -792.5159874240176, -743.3822906671751, -653.2255588132094, -915.5377922969163, -967.9164083879504, -1224.124753580239, -736.8661339953352, -871.9493199469679, -449.44088607528846, -533.531392144829, -1222.8078149301723, -591.0592238638071, -732.1603902783818, -789.8588830338664, -788.6072712225003, -1072.6202813812297, -393.3801237387281, -765.8249738045077, -831.1886116942605], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.289945685125428, "mean_inference_ms": 0.40921467697751285, "mean_action_processing_ms": 0.0962451627771201, "mean_env_wait_ms": 3.692703878930179, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036776720822512448, "StateBufferConnector_ms": 0.002775087461366758, "ViewRequirementAgentConnector_ms": 0.06919195363809774}}, "episode_reward_max": -360.46403503569405, "episode_reward_min": -1228.638734842368, "episode_reward_mean": -761.67685075197, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-923.5364552454218, -862.5348525669727, -926.7890591245979, -644.5249914209028, -983.9948436232871, -661.5738640464544, -767.6943571691588, -784.1885188753826, -666.7810453907114, -360.46403503569405, -623.1491521666522, -598.9058034118659, -669.3836760950687, -1129.9218310837296, -564.8035701447418, -383.93914348902194, -749.0670555658398, -823.0128438058882, -973.2203297422689, -711.1108504958753, -664.8804460858096, -901.6806712317137, -856.9719691086589, -715.4068856637762, -1050.4726690457328, -690.2311397780416, -813.4451141091247, -750.6149491461733, -611.3273245529999, -477.6000462599683, -701.393332105827, -669.7402630350878, -648.3790898089699, -604.4827643406974, -771.9488604461665, -514.9391731234848, -681.7357675104101, -605.5031164992423, -989.4815077313855, -915.0504238071034, -739.6376485282495, -637.4949336273813, -813.4236583447815, -1044.049131854899, -760.2720658529917, -574.7015103061706, -793.8920419818169, -561.4809307948568, -522.5100115114014, -825.1119693436538, -729.7625996528775, -926.1607609593053, -765.0306223697702, -656.701926588058, -825.1623533226306, -1056.6224861659093, -947.4262632439014, -695.5562926958454, -1014.9432852767619, -700.8825639828477, -535.4924764872237, -869.4949961638353, -813.7880785660427, -1063.7998193910535, -627.4015267093903, -487.4881272053504, -777.0204480278159, -570.4658893786288, -1228.638734842368, -849.224770025147, -770.1738519108461, -608.9017541481696, -792.5159874240176, -743.3822906671751, -653.2255588132094, -915.5377922969163, -967.9164083879504, -1224.124753580239, -736.8661339953352, -871.9493199469679, -449.44088607528846, -533.531392144829, -1222.8078149301723, -591.0592238638071, -732.1603902783818, -789.8588830338664, -788.6072712225003, -1072.6202813812297, -393.3801237387281, -765.8249738045077, -831.1886116942605], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.289945685125428, "mean_inference_ms": 0.40921467697751285, "mean_action_processing_ms": 0.0962451627771201, "mean_env_wait_ms": 3.692703878930179, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036776720822512448, "StateBufferConnector_ms": 0.002775087461366758, "ViewRequirementAgentConnector_ms": 0.06919195363809774}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 231480, "num_agent_steps_trained": 231480, "num_env_steps_sampled": 231480, "num_env_steps_trained": 231480, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.964002767882675, "num_env_steps_trained_throughput_per_sec": 41.964002767882675, "timesteps_total": 231480, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 231480, "timers": {"training_iteration_time_ms": 2909.629, "sample_time_ms": 2905.777, "load_time_ms": 0.225, "load_throughput": 532835.571, "learn_time_ms": 2.874, "learn_throughput": 41753.41, "synch_weights_time_ms": 0.708}, "counters": {"num_env_steps_sampled": 231480, "num_env_steps_trained": 231480, "num_agent_steps_sampled": 231480, "num_agent_steps_trained": 231480}, "done": false, "episodes_total": 1929, "training_iteration": 483, "trial_id": "53665_00000", "date": "2023-07-26_03-25-49", "timestamp": 1690331149, "time_this_iter_s": 11.44108510017395, "time_total_s": 5892.091382265091, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 270.76590633392334, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 39.1875, "ram_util_percent": 70.55000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.48291015625, "policy_loss": -120600.21875, "vf_loss": 5848155.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 95.0, "diff_num_grad_updates_vs_sampler_policy": 94.0}}, "num_env_steps_sampled": 231960, "num_env_steps_trained": 231960, "num_agent_steps_sampled": 231960, "num_agent_steps_trained": 231960}, "sampler_results": {"episode_reward_max": -360.46403503569405, "episode_reward_min": -1228.638734842368, "episode_reward_mean": -757.3789622489381, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-923.5364552454218, -862.5348525669727, -926.7890591245979, -644.5249914209028, -983.9948436232871, -661.5738640464544, -767.6943571691588, -784.1885188753826, -666.7810453907114, -360.46403503569405, -623.1491521666522, -598.9058034118659, -669.3836760950687, -1129.9218310837296, -564.8035701447418, -383.93914348902194, -749.0670555658398, -823.0128438058882, -973.2203297422689, -711.1108504958753, -664.8804460858096, -901.6806712317137, -856.9719691086589, -715.4068856637762, -1050.4726690457328, -690.2311397780416, -813.4451141091247, -750.6149491461733, -611.3273245529999, -477.6000462599683, -701.393332105827, -669.7402630350878, -648.3790898089699, -604.4827643406974, -771.9488604461665, -514.9391731234848, -681.7357675104101, -605.5031164992423, -989.4815077313855, -915.0504238071034, -739.6376485282495, -637.4949336273813, -813.4236583447815, -1044.049131854899, -760.2720658529917, -574.7015103061706, -793.8920419818169, -561.4809307948568, -522.5100115114014, -825.1119693436538, -729.7625996528775, -926.1607609593053, -765.0306223697702, -656.701926588058, -825.1623533226306, -1056.6224861659093, -947.4262632439014, -695.5562926958454, -1014.9432852767619, -700.8825639828477, -535.4924764872237, -869.4949961638353, -813.7880785660427, -1063.7998193910535, -627.4015267093903, -487.4881272053504, -777.0204480278159, -570.4658893786288, -1228.638734842368, -849.224770025147, -770.1738519108461, -608.9017541481696, -792.5159874240176, -743.3822906671751, -653.2255588132094, -915.5377922969163, -967.9164083879504, -1224.124753580239, -736.8661339953352, -871.9493199469679, -449.44088607528846, -533.531392144829, -1222.8078149301723, -591.0592238638071, -732.1603902783818, -789.8588830338664, -788.6072712225003, -1072.6202813812297, -393.3801237387281, -765.8249738045077, -831.1886116942605, -762.3454772637814, -486.92455876945724, -448.69671577154355, -940.4412434150737], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.29109838071829, "mean_inference_ms": 0.40921015028796565, "mean_action_processing_ms": 0.0962415126703594, "mean_env_wait_ms": 3.6603411296870285, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036751596551192435, "StateBufferConnector_ms": 0.002788493507786801, "ViewRequirementAgentConnector_ms": 0.06946764494243421}}, "episode_reward_max": -360.46403503569405, "episode_reward_min": -1228.638734842368, "episode_reward_mean": -757.3789622489381, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-923.5364552454218, -862.5348525669727, -926.7890591245979, -644.5249914209028, -983.9948436232871, -661.5738640464544, -767.6943571691588, -784.1885188753826, -666.7810453907114, -360.46403503569405, -623.1491521666522, -598.9058034118659, -669.3836760950687, -1129.9218310837296, -564.8035701447418, -383.93914348902194, -749.0670555658398, -823.0128438058882, -973.2203297422689, -711.1108504958753, -664.8804460858096, -901.6806712317137, -856.9719691086589, -715.4068856637762, -1050.4726690457328, -690.2311397780416, -813.4451141091247, -750.6149491461733, -611.3273245529999, -477.6000462599683, -701.393332105827, -669.7402630350878, -648.3790898089699, -604.4827643406974, -771.9488604461665, -514.9391731234848, -681.7357675104101, -605.5031164992423, -989.4815077313855, -915.0504238071034, -739.6376485282495, -637.4949336273813, -813.4236583447815, -1044.049131854899, -760.2720658529917, -574.7015103061706, -793.8920419818169, -561.4809307948568, -522.5100115114014, -825.1119693436538, -729.7625996528775, -926.1607609593053, -765.0306223697702, -656.701926588058, -825.1623533226306, -1056.6224861659093, -947.4262632439014, -695.5562926958454, -1014.9432852767619, -700.8825639828477, -535.4924764872237, -869.4949961638353, -813.7880785660427, -1063.7998193910535, -627.4015267093903, -487.4881272053504, -777.0204480278159, -570.4658893786288, -1228.638734842368, -849.224770025147, -770.1738519108461, -608.9017541481696, -792.5159874240176, -743.3822906671751, -653.2255588132094, -915.5377922969163, -967.9164083879504, -1224.124753580239, -736.8661339953352, -871.9493199469679, -449.44088607528846, -533.531392144829, -1222.8078149301723, -591.0592238638071, -732.1603902783818, -789.8588830338664, -788.6072712225003, -1072.6202813812297, -393.3801237387281, -765.8249738045077, -831.1886116942605, -762.3454772637814, -486.92455876945724, -448.69671577154355, -940.4412434150737], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.29109838071829, "mean_inference_ms": 0.40921015028796565, "mean_action_processing_ms": 0.0962415126703594, "mean_env_wait_ms": 3.6603411296870285, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036751596551192435, "StateBufferConnector_ms": 0.002788493507786801, "ViewRequirementAgentConnector_ms": 0.06946764494243421}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 231960, "num_agent_steps_trained": 231960, "num_env_steps_sampled": 231960, "num_env_steps_trained": 231960, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.857310541059135, "num_env_steps_trained_throughput_per_sec": 38.857310541059135, "timesteps_total": 231960, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 231960, "timers": {"training_iteration_time_ms": 2938.895, "sample_time_ms": 2935.062, "load_time_ms": 0.223, "load_throughput": 539229.141, "learn_time_ms": 2.853, "learn_throughput": 42057.296, "synch_weights_time_ms": 0.717}, "counters": {"num_env_steps_sampled": 231960, "num_env_steps_trained": 231960, "num_agent_steps_sampled": 231960, "num_agent_steps_trained": 231960}, "done": false, "episodes_total": 1933, "training_iteration": 484, "trial_id": "53665_00000", "date": "2023-07-26_03-26-02", "timestamp": 1690331162, "time_this_iter_s": 12.3558988571167, "time_total_s": 5904.447281122208, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 283.12180519104004, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 47.77777777777777, "ram_util_percent": 76.6611111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4823913574219, "policy_loss": -118411.328125, "vf_loss": 6727544.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 99.0, "diff_num_grad_updates_vs_sampler_policy": 98.0}}, "num_env_steps_sampled": 232440, "num_env_steps_trained": 232440, "num_agent_steps_sampled": 232440, "num_agent_steps_trained": 232440}, "sampler_results": {"episode_reward_max": -360.46403503569405, "episode_reward_min": -1228.638734842368, "episode_reward_mean": -761.3503836717338, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-923.5364552454218, -862.5348525669727, -926.7890591245979, -644.5249914209028, -983.9948436232871, -661.5738640464544, -767.6943571691588, -784.1885188753826, -666.7810453907114, -360.46403503569405, -623.1491521666522, -598.9058034118659, -669.3836760950687, -1129.9218310837296, -564.8035701447418, -383.93914348902194, -749.0670555658398, -823.0128438058882, -973.2203297422689, -711.1108504958753, -664.8804460858096, -901.6806712317137, -856.9719691086589, -715.4068856637762, -1050.4726690457328, -690.2311397780416, -813.4451141091247, -750.6149491461733, -611.3273245529999, -477.6000462599683, -701.393332105827, -669.7402630350878, -648.3790898089699, -604.4827643406974, -771.9488604461665, -514.9391731234848, -681.7357675104101, -605.5031164992423, -989.4815077313855, -915.0504238071034, -739.6376485282495, -637.4949336273813, -813.4236583447815, -1044.049131854899, -760.2720658529917, -574.7015103061706, -793.8920419818169, -561.4809307948568, -522.5100115114014, -825.1119693436538, -729.7625996528775, -926.1607609593053, -765.0306223697702, -656.701926588058, -825.1623533226306, -1056.6224861659093, -947.4262632439014, -695.5562926958454, -1014.9432852767619, -700.8825639828477, -535.4924764872237, -869.4949961638353, -813.7880785660427, -1063.7998193910535, -627.4015267093903, -487.4881272053504, -777.0204480278159, -570.4658893786288, -1228.638734842368, -849.224770025147, -770.1738519108461, -608.9017541481696, -792.5159874240176, -743.3822906671751, -653.2255588132094, -915.5377922969163, -967.9164083879504, -1224.124753580239, -736.8661339953352, -871.9493199469679, -449.44088607528846, -533.531392144829, -1222.8078149301723, -591.0592238638071, -732.1603902783818, -789.8588830338664, -788.6072712225003, -1072.6202813812297, -393.3801237387281, -765.8249738045077, -831.1886116942605, -762.3454772637814, -486.92455876945724, -448.69671577154355, -940.4412434150737, -727.1847401582801, -806.6944164867027, -901.2084436665884, -987.5989695409434], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.29190342963782, "mean_inference_ms": 0.4091654377915346, "mean_action_processing_ms": 0.0962322487801124, "mean_env_wait_ms": 3.630280564444578, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003654788238833649, "StateBufferConnector_ms": 0.0027928689513543638, "ViewRequirementAgentConnector_ms": 0.06936439360030974}}, "episode_reward_max": -360.46403503569405, "episode_reward_min": -1228.638734842368, "episode_reward_mean": -761.3503836717338, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-923.5364552454218, -862.5348525669727, -926.7890591245979, -644.5249914209028, -983.9948436232871, -661.5738640464544, -767.6943571691588, -784.1885188753826, -666.7810453907114, -360.46403503569405, -623.1491521666522, -598.9058034118659, -669.3836760950687, -1129.9218310837296, -564.8035701447418, -383.93914348902194, -749.0670555658398, -823.0128438058882, -973.2203297422689, -711.1108504958753, -664.8804460858096, -901.6806712317137, -856.9719691086589, -715.4068856637762, -1050.4726690457328, -690.2311397780416, -813.4451141091247, -750.6149491461733, -611.3273245529999, -477.6000462599683, -701.393332105827, -669.7402630350878, -648.3790898089699, -604.4827643406974, -771.9488604461665, -514.9391731234848, -681.7357675104101, -605.5031164992423, -989.4815077313855, -915.0504238071034, -739.6376485282495, -637.4949336273813, -813.4236583447815, -1044.049131854899, -760.2720658529917, -574.7015103061706, -793.8920419818169, -561.4809307948568, -522.5100115114014, -825.1119693436538, -729.7625996528775, -926.1607609593053, -765.0306223697702, -656.701926588058, -825.1623533226306, -1056.6224861659093, -947.4262632439014, -695.5562926958454, -1014.9432852767619, -700.8825639828477, -535.4924764872237, -869.4949961638353, -813.7880785660427, -1063.7998193910535, -627.4015267093903, -487.4881272053504, -777.0204480278159, -570.4658893786288, -1228.638734842368, -849.224770025147, -770.1738519108461, -608.9017541481696, -792.5159874240176, -743.3822906671751, -653.2255588132094, -915.5377922969163, -967.9164083879504, -1224.124753580239, -736.8661339953352, -871.9493199469679, -449.44088607528846, -533.531392144829, -1222.8078149301723, -591.0592238638071, -732.1603902783818, -789.8588830338664, -788.6072712225003, -1072.6202813812297, -393.3801237387281, -765.8249738045077, -831.1886116942605, -762.3454772637814, -486.92455876945724, -448.69671577154355, -940.4412434150737, -727.1847401582801, -806.6944164867027, -901.2084436665884, -987.5989695409434], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.29190342963782, "mean_inference_ms": 0.4091654377915346, "mean_action_processing_ms": 0.0962322487801124, "mean_env_wait_ms": 3.630280564444578, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003654788238833649, "StateBufferConnector_ms": 0.0027928689513543638, "ViewRequirementAgentConnector_ms": 0.06936439360030974}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 232440, "num_agent_steps_trained": 232440, "num_env_steps_sampled": 232440, "num_env_steps_trained": 232440, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.904814451986894, "num_env_steps_trained_throughput_per_sec": 40.904814451986894, "timesteps_total": 232440, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 232440, "timers": {"training_iteration_time_ms": 2977.164, "sample_time_ms": 2973.307, "load_time_ms": 0.224, "load_throughput": 535101.51, "learn_time_ms": 2.882, "learn_throughput": 41640.108, "synch_weights_time_ms": 0.711}, "counters": {"num_env_steps_sampled": 232440, "num_env_steps_trained": 232440, "num_agent_steps_sampled": 232440, "num_agent_steps_trained": 232440}, "done": false, "episodes_total": 1937, "training_iteration": 485, "trial_id": "53665_00000", "date": "2023-07-26_03-26-14", "timestamp": 1690331174, "time_this_iter_s": 11.73740005493164, "time_total_s": 5916.184681177139, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 294.8592052459717, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 41.650000000000006, "ram_util_percent": 77.98750000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.48956298828125, "policy_loss": -90000.65625, "vf_loss": 4028409.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 103.0, "diff_num_grad_updates_vs_sampler_policy": 102.0}}, "num_env_steps_sampled": 232920, "num_env_steps_trained": 232920, "num_agent_steps_sampled": 232920, "num_agent_steps_trained": 232920}, "sampler_results": {"episode_reward_max": -360.46403503569405, "episode_reward_min": -1228.638734842368, "episode_reward_mean": -756.3864923261386, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-644.5249914209028, -983.9948436232871, -661.5738640464544, -767.6943571691588, -784.1885188753826, -666.7810453907114, -360.46403503569405, -623.1491521666522, -598.9058034118659, -669.3836760950687, -1129.9218310837296, -564.8035701447418, -383.93914348902194, -749.0670555658398, -823.0128438058882, -973.2203297422689, -711.1108504958753, -664.8804460858096, -901.6806712317137, -856.9719691086589, -715.4068856637762, -1050.4726690457328, -690.2311397780416, -813.4451141091247, -750.6149491461733, -611.3273245529999, -477.6000462599683, -701.393332105827, -669.7402630350878, -648.3790898089699, -604.4827643406974, -771.9488604461665, -514.9391731234848, -681.7357675104101, -605.5031164992423, -989.4815077313855, -915.0504238071034, -739.6376485282495, -637.4949336273813, -813.4236583447815, -1044.049131854899, -760.2720658529917, -574.7015103061706, -793.8920419818169, -561.4809307948568, -522.5100115114014, -825.1119693436538, -729.7625996528775, -926.1607609593053, -765.0306223697702, -656.701926588058, -825.1623533226306, -1056.6224861659093, -947.4262632439014, -695.5562926958454, -1014.9432852767619, -700.8825639828477, -535.4924764872237, -869.4949961638353, -813.7880785660427, -1063.7998193910535, -627.4015267093903, -487.4881272053504, -777.0204480278159, -570.4658893786288, -1228.638734842368, -849.224770025147, -770.1738519108461, -608.9017541481696, -792.5159874240176, -743.3822906671751, -653.2255588132094, -915.5377922969163, -967.9164083879504, -1224.124753580239, -736.8661339953352, -871.9493199469679, -449.44088607528846, -533.531392144829, -1222.8078149301723, -591.0592238638071, -732.1603902783818, -789.8588830338664, -788.6072712225003, -1072.6202813812297, -393.3801237387281, -765.8249738045077, -831.1886116942605, -762.3454772637814, -486.92455876945724, -448.69671577154355, -940.4412434150737, -727.1847401582801, -806.6944164867027, -901.2084436665884, -987.5989695409434, -671.6777141601648, -888.5446985441893, -721.5441831103919, -696.055020234459], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.294782063082156, "mean_inference_ms": 0.4092297762094192, "mean_action_processing_ms": 0.09621368362328972, "mean_env_wait_ms": 3.388420761395792, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036530494689941406, "StateBufferConnector_ms": 0.0027904510498046875, "ViewRequirementAgentConnector_ms": 0.06935763359069824}}, "episode_reward_max": -360.46403503569405, "episode_reward_min": -1228.638734842368, "episode_reward_mean": -756.3864923261386, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-644.5249914209028, -983.9948436232871, -661.5738640464544, -767.6943571691588, -784.1885188753826, -666.7810453907114, -360.46403503569405, -623.1491521666522, -598.9058034118659, -669.3836760950687, -1129.9218310837296, -564.8035701447418, -383.93914348902194, -749.0670555658398, -823.0128438058882, -973.2203297422689, -711.1108504958753, -664.8804460858096, -901.6806712317137, -856.9719691086589, -715.4068856637762, -1050.4726690457328, -690.2311397780416, -813.4451141091247, -750.6149491461733, -611.3273245529999, -477.6000462599683, -701.393332105827, -669.7402630350878, -648.3790898089699, -604.4827643406974, -771.9488604461665, -514.9391731234848, -681.7357675104101, -605.5031164992423, -989.4815077313855, -915.0504238071034, -739.6376485282495, -637.4949336273813, -813.4236583447815, -1044.049131854899, -760.2720658529917, -574.7015103061706, -793.8920419818169, -561.4809307948568, -522.5100115114014, -825.1119693436538, -729.7625996528775, -926.1607609593053, -765.0306223697702, -656.701926588058, -825.1623533226306, -1056.6224861659093, -947.4262632439014, -695.5562926958454, -1014.9432852767619, -700.8825639828477, -535.4924764872237, -869.4949961638353, -813.7880785660427, -1063.7998193910535, -627.4015267093903, -487.4881272053504, -777.0204480278159, -570.4658893786288, -1228.638734842368, -849.224770025147, -770.1738519108461, -608.9017541481696, -792.5159874240176, -743.3822906671751, -653.2255588132094, -915.5377922969163, -967.9164083879504, -1224.124753580239, -736.8661339953352, -871.9493199469679, -449.44088607528846, -533.531392144829, -1222.8078149301723, -591.0592238638071, -732.1603902783818, -789.8588830338664, -788.6072712225003, -1072.6202813812297, -393.3801237387281, -765.8249738045077, -831.1886116942605, -762.3454772637814, -486.92455876945724, -448.69671577154355, -940.4412434150737, -727.1847401582801, -806.6944164867027, -901.2084436665884, -987.5989695409434, -671.6777141601648, -888.5446985441893, -721.5441831103919, -696.055020234459], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.294782063082156, "mean_inference_ms": 0.4092297762094192, "mean_action_processing_ms": 0.09621368362328972, "mean_env_wait_ms": 3.388420761395792, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036530494689941406, "StateBufferConnector_ms": 0.0027904510498046875, "ViewRequirementAgentConnector_ms": 0.06935763359069824}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 232920, "num_agent_steps_trained": 232920, "num_env_steps_sampled": 232920, "num_env_steps_trained": 232920, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.93041305387768, "num_env_steps_trained_throughput_per_sec": 40.93041305387768, "timesteps_total": 232920, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 232920, "timers": {"training_iteration_time_ms": 2926.304, "sample_time_ms": 2922.46, "load_time_ms": 0.221, "load_throughput": 543362.28, "learn_time_ms": 2.88, "learn_throughput": 41671.136, "synch_weights_time_ms": 0.703}, "counters": {"num_env_steps_sampled": 232920, "num_env_steps_trained": 232920, "num_agent_steps_sampled": 232920, "num_agent_steps_trained": 232920}, "done": false, "episodes_total": 1941, "training_iteration": 486, "trial_id": "53665_00000", "date": "2023-07-26_03-26-25", "timestamp": 1690331185, "time_this_iter_s": 11.729919910430908, "time_total_s": 5927.91460108757, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 306.5891251564026, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 40.43529411764706, "ram_util_percent": 77.06470588235294}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.51129150390625, "policy_loss": -75041.34375, "vf_loss": 2787357.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 107.0, "diff_num_grad_updates_vs_sampler_policy": 106.0}}, "num_env_steps_sampled": 233400, "num_env_steps_trained": 233400, "num_agent_steps_sampled": 233400, "num_agent_steps_trained": 233400}, "sampler_results": {"episode_reward_max": -360.46403503569405, "episode_reward_min": -1228.638734842368, "episode_reward_mean": -755.3250134811226, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-784.1885188753826, -666.7810453907114, -360.46403503569405, -623.1491521666522, -598.9058034118659, -669.3836760950687, -1129.9218310837296, -564.8035701447418, -383.93914348902194, -749.0670555658398, -823.0128438058882, -973.2203297422689, -711.1108504958753, -664.8804460858096, -901.6806712317137, -856.9719691086589, -715.4068856637762, -1050.4726690457328, -690.2311397780416, -813.4451141091247, -750.6149491461733, -611.3273245529999, -477.6000462599683, -701.393332105827, -669.7402630350878, -648.3790898089699, -604.4827643406974, -771.9488604461665, -514.9391731234848, -681.7357675104101, -605.5031164992423, -989.4815077313855, -915.0504238071034, -739.6376485282495, -637.4949336273813, -813.4236583447815, -1044.049131854899, -760.2720658529917, -574.7015103061706, -793.8920419818169, -561.4809307948568, -522.5100115114014, -825.1119693436538, -729.7625996528775, -926.1607609593053, -765.0306223697702, -656.701926588058, -825.1623533226306, -1056.6224861659093, -947.4262632439014, -695.5562926958454, -1014.9432852767619, -700.8825639828477, -535.4924764872237, -869.4949961638353, -813.7880785660427, -1063.7998193910535, -627.4015267093903, -487.4881272053504, -777.0204480278159, -570.4658893786288, -1228.638734842368, -849.224770025147, -770.1738519108461, -608.9017541481696, -792.5159874240176, -743.3822906671751, -653.2255588132094, -915.5377922969163, -967.9164083879504, -1224.124753580239, -736.8661339953352, -871.9493199469679, -449.44088607528846, -533.531392144829, -1222.8078149301723, -591.0592238638071, -732.1603902783818, -789.8588830338664, -788.6072712225003, -1072.6202813812297, -393.3801237387281, -765.8249738045077, -831.1886116942605, -762.3454772637814, -486.92455876945724, -448.69671577154355, -940.4412434150737, -727.1847401582801, -806.6944164867027, -901.2084436665884, -987.5989695409434, -671.6777141601648, -888.5446985441893, -721.5441831103919, -696.055020234459, -898.3968632804158, -1027.4011248166166, -403.03280759378634, -622.8093760673837], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.30503261580439, "mean_inference_ms": 0.4093763999262551, "mean_action_processing_ms": 0.09619180808883147, "mean_env_wait_ms": 3.2608117304837276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003647327423095703, "StateBufferConnector_ms": 0.0028002262115478516, "ViewRequirementAgentConnector_ms": 0.06929302215576172}}, "episode_reward_max": -360.46403503569405, "episode_reward_min": -1228.638734842368, "episode_reward_mean": -755.3250134811226, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-784.1885188753826, -666.7810453907114, -360.46403503569405, -623.1491521666522, -598.9058034118659, -669.3836760950687, -1129.9218310837296, -564.8035701447418, -383.93914348902194, -749.0670555658398, -823.0128438058882, -973.2203297422689, -711.1108504958753, -664.8804460858096, -901.6806712317137, -856.9719691086589, -715.4068856637762, -1050.4726690457328, -690.2311397780416, -813.4451141091247, -750.6149491461733, -611.3273245529999, -477.6000462599683, -701.393332105827, -669.7402630350878, -648.3790898089699, -604.4827643406974, -771.9488604461665, -514.9391731234848, -681.7357675104101, -605.5031164992423, -989.4815077313855, -915.0504238071034, -739.6376485282495, -637.4949336273813, -813.4236583447815, -1044.049131854899, -760.2720658529917, -574.7015103061706, -793.8920419818169, -561.4809307948568, -522.5100115114014, -825.1119693436538, -729.7625996528775, -926.1607609593053, -765.0306223697702, -656.701926588058, -825.1623533226306, -1056.6224861659093, -947.4262632439014, -695.5562926958454, -1014.9432852767619, -700.8825639828477, -535.4924764872237, -869.4949961638353, -813.7880785660427, -1063.7998193910535, -627.4015267093903, -487.4881272053504, -777.0204480278159, -570.4658893786288, -1228.638734842368, -849.224770025147, -770.1738519108461, -608.9017541481696, -792.5159874240176, -743.3822906671751, -653.2255588132094, -915.5377922969163, -967.9164083879504, -1224.124753580239, -736.8661339953352, -871.9493199469679, -449.44088607528846, -533.531392144829, -1222.8078149301723, -591.0592238638071, -732.1603902783818, -789.8588830338664, -788.6072712225003, -1072.6202813812297, -393.3801237387281, -765.8249738045077, -831.1886116942605, -762.3454772637814, -486.92455876945724, -448.69671577154355, -940.4412434150737, -727.1847401582801, -806.6944164867027, -901.2084436665884, -987.5989695409434, -671.6777141601648, -888.5446985441893, -721.5441831103919, -696.055020234459, -898.3968632804158, -1027.4011248166166, -403.03280759378634, -622.8093760673837], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.30503261580439, "mean_inference_ms": 0.4093763999262551, "mean_action_processing_ms": 0.09619180808883147, "mean_env_wait_ms": 3.2608117304837276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003647327423095703, "StateBufferConnector_ms": 0.0028002262115478516, "ViewRequirementAgentConnector_ms": 0.06929302215576172}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 233400, "num_agent_steps_trained": 233400, "num_env_steps_sampled": 233400, "num_env_steps_trained": 233400, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.80721792976696, "num_env_steps_trained_throughput_per_sec": 41.80721792976696, "timesteps_total": 233400, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 233400, "timers": {"training_iteration_time_ms": 2920.261, "sample_time_ms": 2916.428, "load_time_ms": 0.224, "load_throughput": 536813.652, "learn_time_ms": 2.859, "learn_throughput": 41968.221, "synch_weights_time_ms": 0.71}, "counters": {"num_env_steps_sampled": 233400, "num_env_steps_trained": 233400, "num_agent_steps_sampled": 233400, "num_agent_steps_trained": 233400}, "done": false, "episodes_total": 1945, "training_iteration": 487, "trial_id": "53665_00000", "date": "2023-07-26_03-26-37", "timestamp": 1690331197, "time_this_iter_s": 11.483947992324829, "time_total_s": 5939.398549079895, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 318.0730731487274, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 38.675, "ram_util_percent": 74.98750000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4968566894531, "policy_loss": -82210.2265625, "vf_loss": 3177704.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 111.0, "diff_num_grad_updates_vs_sampler_policy": 110.0}}, "num_env_steps_sampled": 233880, "num_env_steps_trained": 233880, "num_agent_steps_sampled": 233880, "num_agent_steps_trained": 233880}, "sampler_results": {"episode_reward_max": -383.93914348902194, "episode_reward_min": -1228.638734842368, "episode_reward_mean": -761.1404770242935, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-598.9058034118659, -669.3836760950687, -1129.9218310837296, -564.8035701447418, -383.93914348902194, -749.0670555658398, -823.0128438058882, -973.2203297422689, -711.1108504958753, -664.8804460858096, -901.6806712317137, -856.9719691086589, -715.4068856637762, -1050.4726690457328, -690.2311397780416, -813.4451141091247, -750.6149491461733, -611.3273245529999, -477.6000462599683, -701.393332105827, -669.7402630350878, -648.3790898089699, -604.4827643406974, -771.9488604461665, -514.9391731234848, -681.7357675104101, -605.5031164992423, -989.4815077313855, -915.0504238071034, -739.6376485282495, -637.4949336273813, -813.4236583447815, -1044.049131854899, -760.2720658529917, -574.7015103061706, -793.8920419818169, -561.4809307948568, -522.5100115114014, -825.1119693436538, -729.7625996528775, -926.1607609593053, -765.0306223697702, -656.701926588058, -825.1623533226306, -1056.6224861659093, -947.4262632439014, -695.5562926958454, -1014.9432852767619, -700.8825639828477, -535.4924764872237, -869.4949961638353, -813.7880785660427, -1063.7998193910535, -627.4015267093903, -487.4881272053504, -777.0204480278159, -570.4658893786288, -1228.638734842368, -849.224770025147, -770.1738519108461, -608.9017541481696, -792.5159874240176, -743.3822906671751, -653.2255588132094, -915.5377922969163, -967.9164083879504, -1224.124753580239, -736.8661339953352, -871.9493199469679, -449.44088607528846, -533.531392144829, -1222.8078149301723, -591.0592238638071, -732.1603902783818, -789.8588830338664, -788.6072712225003, -1072.6202813812297, -393.3801237387281, -765.8249738045077, -831.1886116942605, -762.3454772637814, -486.92455876945724, -448.69671577154355, -940.4412434150737, -727.1847401582801, -806.6944164867027, -901.2084436665884, -987.5989695409434, -671.6777141601648, -888.5446985441893, -721.5441831103919, -696.055020234459, -898.3968632804158, -1027.4011248166166, -403.03280759378634, -622.8093760673837, -812.637503569869, -862.0779852735153, -647.6766655147794, -693.7369514273789], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.316741957107137, "mean_inference_ms": 0.4096937471485385, "mean_action_processing_ms": 0.0962031225104889, "mean_env_wait_ms": 3.1838189026646746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036728382110595703, "StateBufferConnector_ms": 0.0028121471405029297, "ViewRequirementAgentConnector_ms": 0.06949424743652344}}, "episode_reward_max": -383.93914348902194, "episode_reward_min": -1228.638734842368, "episode_reward_mean": -761.1404770242935, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-598.9058034118659, -669.3836760950687, -1129.9218310837296, -564.8035701447418, -383.93914348902194, -749.0670555658398, -823.0128438058882, -973.2203297422689, -711.1108504958753, -664.8804460858096, -901.6806712317137, -856.9719691086589, -715.4068856637762, -1050.4726690457328, -690.2311397780416, -813.4451141091247, -750.6149491461733, -611.3273245529999, -477.6000462599683, -701.393332105827, -669.7402630350878, -648.3790898089699, -604.4827643406974, -771.9488604461665, -514.9391731234848, -681.7357675104101, -605.5031164992423, -989.4815077313855, -915.0504238071034, -739.6376485282495, -637.4949336273813, -813.4236583447815, -1044.049131854899, -760.2720658529917, -574.7015103061706, -793.8920419818169, -561.4809307948568, -522.5100115114014, -825.1119693436538, -729.7625996528775, -926.1607609593053, -765.0306223697702, -656.701926588058, -825.1623533226306, -1056.6224861659093, -947.4262632439014, -695.5562926958454, -1014.9432852767619, -700.8825639828477, -535.4924764872237, -869.4949961638353, -813.7880785660427, -1063.7998193910535, -627.4015267093903, -487.4881272053504, -777.0204480278159, -570.4658893786288, -1228.638734842368, -849.224770025147, -770.1738519108461, -608.9017541481696, -792.5159874240176, -743.3822906671751, -653.2255588132094, -915.5377922969163, -967.9164083879504, -1224.124753580239, -736.8661339953352, -871.9493199469679, -449.44088607528846, -533.531392144829, -1222.8078149301723, -591.0592238638071, -732.1603902783818, -789.8588830338664, -788.6072712225003, -1072.6202813812297, -393.3801237387281, -765.8249738045077, -831.1886116942605, -762.3454772637814, -486.92455876945724, -448.69671577154355, -940.4412434150737, -727.1847401582801, -806.6944164867027, -901.2084436665884, -987.5989695409434, -671.6777141601648, -888.5446985441893, -721.5441831103919, -696.055020234459, -898.3968632804158, -1027.4011248166166, -403.03280759378634, -622.8093760673837, -812.637503569869, -862.0779852735153, -647.6766655147794, -693.7369514273789], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.316741957107137, "mean_inference_ms": 0.4096937471485385, "mean_action_processing_ms": 0.0962031225104889, "mean_env_wait_ms": 3.1838189026646746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036728382110595703, "StateBufferConnector_ms": 0.0028121471405029297, "ViewRequirementAgentConnector_ms": 0.06949424743652344}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 233880, "num_agent_steps_trained": 233880, "num_env_steps_sampled": 233880, "num_env_steps_trained": 233880, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.747831488691325, "num_env_steps_trained_throughput_per_sec": 41.747831488691325, "timesteps_total": 233880, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 233880, "timers": {"training_iteration_time_ms": 2891.346, "sample_time_ms": 2887.562, "load_time_ms": 0.222, "load_throughput": 540851.58, "learn_time_ms": 2.815, "learn_throughput": 42630.817, "synch_weights_time_ms": 0.707}, "counters": {"num_env_steps_sampled": 233880, "num_env_steps_trained": 233880, "num_agent_steps_sampled": 233880, "num_agent_steps_trained": 233880}, "done": false, "episodes_total": 1949, "training_iteration": 488, "trial_id": "53665_00000", "date": "2023-07-26_03-26-48", "timestamp": 1690331208, "time_this_iter_s": 11.500273704528809, "time_total_s": 5950.898822784424, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 329.5733468532562, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 40.629411764705885, "ram_util_percent": 73.94117647058823}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4973449707031, "policy_loss": -106466.625, "vf_loss": 5147521.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 115.0, "diff_num_grad_updates_vs_sampler_policy": 114.0}}, "num_env_steps_sampled": 234360, "num_env_steps_trained": 234360, "num_agent_steps_sampled": 234360, "num_agent_steps_trained": 234360}, "sampler_results": {"episode_reward_max": -383.93914348902194, "episode_reward_min": -1228.638734842368, "episode_reward_mean": -758.2954837421498, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-383.93914348902194, -749.0670555658398, -823.0128438058882, -973.2203297422689, -711.1108504958753, -664.8804460858096, -901.6806712317137, -856.9719691086589, -715.4068856637762, -1050.4726690457328, -690.2311397780416, -813.4451141091247, -750.6149491461733, -611.3273245529999, -477.6000462599683, -701.393332105827, -669.7402630350878, -648.3790898089699, -604.4827643406974, -771.9488604461665, -514.9391731234848, -681.7357675104101, -605.5031164992423, -989.4815077313855, -915.0504238071034, -739.6376485282495, -637.4949336273813, -813.4236583447815, -1044.049131854899, -760.2720658529917, -574.7015103061706, -793.8920419818169, -561.4809307948568, -522.5100115114014, -825.1119693436538, -729.7625996528775, -926.1607609593053, -765.0306223697702, -656.701926588058, -825.1623533226306, -1056.6224861659093, -947.4262632439014, -695.5562926958454, -1014.9432852767619, -700.8825639828477, -535.4924764872237, -869.4949961638353, -813.7880785660427, -1063.7998193910535, -627.4015267093903, -487.4881272053504, -777.0204480278159, -570.4658893786288, -1228.638734842368, -849.224770025147, -770.1738519108461, -608.9017541481696, -792.5159874240176, -743.3822906671751, -653.2255588132094, -915.5377922969163, -967.9164083879504, -1224.124753580239, -736.8661339953352, -871.9493199469679, -449.44088607528846, -533.531392144829, -1222.8078149301723, -591.0592238638071, -732.1603902783818, -789.8588830338664, -788.6072712225003, -1072.6202813812297, -393.3801237387281, -765.8249738045077, -831.1886116942605, -762.3454772637814, -486.92455876945724, -448.69671577154355, -940.4412434150737, -727.1847401582801, -806.6944164867027, -901.2084436665884, -987.5989695409434, -671.6777141601648, -888.5446985441893, -721.5441831103919, -696.055020234459, -898.3968632804158, -1027.4011248166166, -403.03280759378634, -622.8093760673837, -812.637503569869, -862.0779852735153, -647.6766655147794, -693.7369514273789, -731.414711060411, -677.8189717782886, -496.3815859129291, -772.9002837693945], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.32919172027498, "mean_inference_ms": 0.4100807485707506, "mean_action_processing_ms": 0.09623039921284413, "mean_env_wait_ms": 3.1297639906067287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036749839782714844, "StateBufferConnector_ms": 0.0028095245361328125, "ViewRequirementAgentConnector_ms": 0.06950235366821289}}, "episode_reward_max": -383.93914348902194, "episode_reward_min": -1228.638734842368, "episode_reward_mean": -758.2954837421498, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-383.93914348902194, -749.0670555658398, -823.0128438058882, -973.2203297422689, -711.1108504958753, -664.8804460858096, -901.6806712317137, -856.9719691086589, -715.4068856637762, -1050.4726690457328, -690.2311397780416, -813.4451141091247, -750.6149491461733, -611.3273245529999, -477.6000462599683, -701.393332105827, -669.7402630350878, -648.3790898089699, -604.4827643406974, -771.9488604461665, -514.9391731234848, -681.7357675104101, -605.5031164992423, -989.4815077313855, -915.0504238071034, -739.6376485282495, -637.4949336273813, -813.4236583447815, -1044.049131854899, -760.2720658529917, -574.7015103061706, -793.8920419818169, -561.4809307948568, -522.5100115114014, -825.1119693436538, -729.7625996528775, -926.1607609593053, -765.0306223697702, -656.701926588058, -825.1623533226306, -1056.6224861659093, -947.4262632439014, -695.5562926958454, -1014.9432852767619, -700.8825639828477, -535.4924764872237, -869.4949961638353, -813.7880785660427, -1063.7998193910535, -627.4015267093903, -487.4881272053504, -777.0204480278159, -570.4658893786288, -1228.638734842368, -849.224770025147, -770.1738519108461, -608.9017541481696, -792.5159874240176, -743.3822906671751, -653.2255588132094, -915.5377922969163, -967.9164083879504, -1224.124753580239, -736.8661339953352, -871.9493199469679, -449.44088607528846, -533.531392144829, -1222.8078149301723, -591.0592238638071, -732.1603902783818, -789.8588830338664, -788.6072712225003, -1072.6202813812297, -393.3801237387281, -765.8249738045077, -831.1886116942605, -762.3454772637814, -486.92455876945724, -448.69671577154355, -940.4412434150737, -727.1847401582801, -806.6944164867027, -901.2084436665884, -987.5989695409434, -671.6777141601648, -888.5446985441893, -721.5441831103919, -696.055020234459, -898.3968632804158, -1027.4011248166166, -403.03280759378634, -622.8093760673837, -812.637503569869, -862.0779852735153, -647.6766655147794, -693.7369514273789, -731.414711060411, -677.8189717782886, -496.3815859129291, -772.9002837693945], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.32919172027498, "mean_inference_ms": 0.4100807485707506, "mean_action_processing_ms": 0.09623039921284413, "mean_env_wait_ms": 3.1297639906067287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036749839782714844, "StateBufferConnector_ms": 0.0028095245361328125, "ViewRequirementAgentConnector_ms": 0.06950235366821289}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 234360, "num_agent_steps_trained": 234360, "num_env_steps_sampled": 234360, "num_env_steps_trained": 234360, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.66159250796292, "num_env_steps_trained_throughput_per_sec": 41.66159250796292, "timesteps_total": 234360, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 234360, "timers": {"training_iteration_time_ms": 2871.698, "sample_time_ms": 2867.851, "load_time_ms": 0.232, "load_throughput": 518028.489, "learn_time_ms": 2.85, "learn_throughput": 42108.315, "synch_weights_time_ms": 0.724}, "counters": {"num_env_steps_sampled": 234360, "num_env_steps_trained": 234360, "num_agent_steps_sampled": 234360, "num_agent_steps_trained": 234360}, "done": false, "episodes_total": 1953, "training_iteration": 489, "trial_id": "53665_00000", "date": "2023-07-26_03-27-00", "timestamp": 1690331220, "time_this_iter_s": 11.524241924285889, "time_total_s": 5962.42306470871, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 341.0975887775421, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 37.95625, "ram_util_percent": 72.8375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.47235107421875, "policy_loss": -107975.296875, "vf_loss": 4803483.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 119.0, "diff_num_grad_updates_vs_sampler_policy": 118.0}}, "num_env_steps_sampled": 234840, "num_env_steps_trained": 234840, "num_agent_steps_sampled": 234840, "num_agent_steps_trained": 234840}, "sampler_results": {"episode_reward_max": -393.3801237387281, "episode_reward_min": -1228.638734842368, "episode_reward_mean": -759.1769898882766, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-711.1108504958753, -664.8804460858096, -901.6806712317137, -856.9719691086589, -715.4068856637762, -1050.4726690457328, -690.2311397780416, -813.4451141091247, -750.6149491461733, -611.3273245529999, -477.6000462599683, -701.393332105827, -669.7402630350878, -648.3790898089699, -604.4827643406974, -771.9488604461665, -514.9391731234848, -681.7357675104101, -605.5031164992423, -989.4815077313855, -915.0504238071034, -739.6376485282495, -637.4949336273813, -813.4236583447815, -1044.049131854899, -760.2720658529917, -574.7015103061706, -793.8920419818169, -561.4809307948568, -522.5100115114014, -825.1119693436538, -729.7625996528775, -926.1607609593053, -765.0306223697702, -656.701926588058, -825.1623533226306, -1056.6224861659093, -947.4262632439014, -695.5562926958454, -1014.9432852767619, -700.8825639828477, -535.4924764872237, -869.4949961638353, -813.7880785660427, -1063.7998193910535, -627.4015267093903, -487.4881272053504, -777.0204480278159, -570.4658893786288, -1228.638734842368, -849.224770025147, -770.1738519108461, -608.9017541481696, -792.5159874240176, -743.3822906671751, -653.2255588132094, -915.5377922969163, -967.9164083879504, -1224.124753580239, -736.8661339953352, -871.9493199469679, -449.44088607528846, -533.531392144829, -1222.8078149301723, -591.0592238638071, -732.1603902783818, -789.8588830338664, -788.6072712225003, -1072.6202813812297, -393.3801237387281, -765.8249738045077, -831.1886116942605, -762.3454772637814, -486.92455876945724, -448.69671577154355, -940.4412434150737, -727.1847401582801, -806.6944164867027, -901.2084436665884, -987.5989695409434, -671.6777141601648, -888.5446985441893, -721.5441831103919, -696.055020234459, -898.3968632804158, -1027.4011248166166, -403.03280759378634, -622.8093760673837, -812.637503569869, -862.0779852735153, -647.6766655147794, -693.7369514273789, -731.414711060411, -677.8189717782886, -496.3815859129291, -772.9002837693945, -784.9194702372788, -666.9597433282892, -736.7936402637039, -828.7171333864179], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.339949496493883, "mean_inference_ms": 0.4104917818213789, "mean_action_processing_ms": 0.09626641623897388, "mean_env_wait_ms": 3.089265435722179, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036721229553222656, "StateBufferConnector_ms": 0.002812623977661133, "ViewRequirementAgentConnector_ms": 0.06941413879394531}}, "episode_reward_max": -393.3801237387281, "episode_reward_min": -1228.638734842368, "episode_reward_mean": -759.1769898882766, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-711.1108504958753, -664.8804460858096, -901.6806712317137, -856.9719691086589, -715.4068856637762, -1050.4726690457328, -690.2311397780416, -813.4451141091247, -750.6149491461733, -611.3273245529999, -477.6000462599683, -701.393332105827, -669.7402630350878, -648.3790898089699, -604.4827643406974, -771.9488604461665, -514.9391731234848, -681.7357675104101, -605.5031164992423, -989.4815077313855, -915.0504238071034, -739.6376485282495, -637.4949336273813, -813.4236583447815, -1044.049131854899, -760.2720658529917, -574.7015103061706, -793.8920419818169, -561.4809307948568, -522.5100115114014, -825.1119693436538, -729.7625996528775, -926.1607609593053, -765.0306223697702, -656.701926588058, -825.1623533226306, -1056.6224861659093, -947.4262632439014, -695.5562926958454, -1014.9432852767619, -700.8825639828477, -535.4924764872237, -869.4949961638353, -813.7880785660427, -1063.7998193910535, -627.4015267093903, -487.4881272053504, -777.0204480278159, -570.4658893786288, -1228.638734842368, -849.224770025147, -770.1738519108461, -608.9017541481696, -792.5159874240176, -743.3822906671751, -653.2255588132094, -915.5377922969163, -967.9164083879504, -1224.124753580239, -736.8661339953352, -871.9493199469679, -449.44088607528846, -533.531392144829, -1222.8078149301723, -591.0592238638071, -732.1603902783818, -789.8588830338664, -788.6072712225003, -1072.6202813812297, -393.3801237387281, -765.8249738045077, -831.1886116942605, -762.3454772637814, -486.92455876945724, -448.69671577154355, -940.4412434150737, -727.1847401582801, -806.6944164867027, -901.2084436665884, -987.5989695409434, -671.6777141601648, -888.5446985441893, -721.5441831103919, -696.055020234459, -898.3968632804158, -1027.4011248166166, -403.03280759378634, -622.8093760673837, -812.637503569869, -862.0779852735153, -647.6766655147794, -693.7369514273789, -731.414711060411, -677.8189717782886, -496.3815859129291, -772.9002837693945, -784.9194702372788, -666.9597433282892, -736.7936402637039, -828.7171333864179], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.339949496493883, "mean_inference_ms": 0.4104917818213789, "mean_action_processing_ms": 0.09626641623897388, "mean_env_wait_ms": 3.089265435722179, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036721229553222656, "StateBufferConnector_ms": 0.002812623977661133, "ViewRequirementAgentConnector_ms": 0.06941413879394531}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 234840, "num_agent_steps_trained": 234840, "num_env_steps_sampled": 234840, "num_env_steps_trained": 234840, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.909597769544405, "num_env_steps_trained_throughput_per_sec": 39.909597769544405, "timesteps_total": 234840, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 234840, "timers": {"training_iteration_time_ms": 2927.623, "sample_time_ms": 2923.791, "load_time_ms": 0.232, "load_throughput": 518241.845, "learn_time_ms": 2.838, "learn_throughput": 42275.963, "synch_weights_time_ms": 0.721}, "counters": {"num_env_steps_sampled": 234840, "num_env_steps_trained": 234840, "num_agent_steps_sampled": 234840, "num_agent_steps_trained": 234840}, "done": false, "episodes_total": 1957, "training_iteration": 490, "trial_id": "53665_00000", "date": "2023-07-26_03-27-12", "timestamp": 1690331232, "time_this_iter_s": 12.029998064041138, "time_total_s": 5974.453062772751, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 353.12758684158325, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 42.23529411764706, "ram_util_percent": 74.47058823529412}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.5101318359375, "policy_loss": -111802.8046875, "vf_loss": 5453475.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 123.0, "diff_num_grad_updates_vs_sampler_policy": 122.0}}, "num_env_steps_sampled": 235320, "num_env_steps_trained": 235320, "num_agent_steps_sampled": 235320, "num_agent_steps_trained": 235320}, "sampler_results": {"episode_reward_max": -393.3801237387281, "episode_reward_min": -1228.638734842368, "episode_reward_mean": -761.76045273601, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-715.4068856637762, -1050.4726690457328, -690.2311397780416, -813.4451141091247, -750.6149491461733, -611.3273245529999, -477.6000462599683, -701.393332105827, -669.7402630350878, -648.3790898089699, -604.4827643406974, -771.9488604461665, -514.9391731234848, -681.7357675104101, -605.5031164992423, -989.4815077313855, -915.0504238071034, -739.6376485282495, -637.4949336273813, -813.4236583447815, -1044.049131854899, -760.2720658529917, -574.7015103061706, -793.8920419818169, -561.4809307948568, -522.5100115114014, -825.1119693436538, -729.7625996528775, -926.1607609593053, -765.0306223697702, -656.701926588058, -825.1623533226306, -1056.6224861659093, -947.4262632439014, -695.5562926958454, -1014.9432852767619, -700.8825639828477, -535.4924764872237, -869.4949961638353, -813.7880785660427, -1063.7998193910535, -627.4015267093903, -487.4881272053504, -777.0204480278159, -570.4658893786288, -1228.638734842368, -849.224770025147, -770.1738519108461, -608.9017541481696, -792.5159874240176, -743.3822906671751, -653.2255588132094, -915.5377922969163, -967.9164083879504, -1224.124753580239, -736.8661339953352, -871.9493199469679, -449.44088607528846, -533.531392144829, -1222.8078149301723, -591.0592238638071, -732.1603902783818, -789.8588830338664, -788.6072712225003, -1072.6202813812297, -393.3801237387281, -765.8249738045077, -831.1886116942605, -762.3454772637814, -486.92455876945724, -448.69671577154355, -940.4412434150737, -727.1847401582801, -806.6944164867027, -901.2084436665884, -987.5989695409434, -671.6777141601648, -888.5446985441893, -721.5441831103919, -696.055020234459, -898.3968632804158, -1027.4011248166166, -403.03280759378634, -622.8093760673837, -812.637503569869, -862.0779852735153, -647.6766655147794, -693.7369514273789, -731.414711060411, -677.8189717782886, -496.3815859129291, -772.9002837693945, -784.9194702372788, -666.9597433282892, -736.7936402637039, -828.7171333864179, -929.0374674872801, -715.6177440587994, -938.376510490651, -809.9584996586964], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.34213259911933, "mean_inference_ms": 0.410319073296521, "mean_action_processing_ms": 0.09622261954117367, "mean_env_wait_ms": 3.056274213619056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003670930862426758, "StateBufferConnector_ms": 0.0028090476989746094, "ViewRequirementAgentConnector_ms": 0.06942605972290039}}, "episode_reward_max": -393.3801237387281, "episode_reward_min": -1228.638734842368, "episode_reward_mean": -761.76045273601, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-715.4068856637762, -1050.4726690457328, -690.2311397780416, -813.4451141091247, -750.6149491461733, -611.3273245529999, -477.6000462599683, -701.393332105827, -669.7402630350878, -648.3790898089699, -604.4827643406974, -771.9488604461665, -514.9391731234848, -681.7357675104101, -605.5031164992423, -989.4815077313855, -915.0504238071034, -739.6376485282495, -637.4949336273813, -813.4236583447815, -1044.049131854899, -760.2720658529917, -574.7015103061706, -793.8920419818169, -561.4809307948568, -522.5100115114014, -825.1119693436538, -729.7625996528775, -926.1607609593053, -765.0306223697702, -656.701926588058, -825.1623533226306, -1056.6224861659093, -947.4262632439014, -695.5562926958454, -1014.9432852767619, -700.8825639828477, -535.4924764872237, -869.4949961638353, -813.7880785660427, -1063.7998193910535, -627.4015267093903, -487.4881272053504, -777.0204480278159, -570.4658893786288, -1228.638734842368, -849.224770025147, -770.1738519108461, -608.9017541481696, -792.5159874240176, -743.3822906671751, -653.2255588132094, -915.5377922969163, -967.9164083879504, -1224.124753580239, -736.8661339953352, -871.9493199469679, -449.44088607528846, -533.531392144829, -1222.8078149301723, -591.0592238638071, -732.1603902783818, -789.8588830338664, -788.6072712225003, -1072.6202813812297, -393.3801237387281, -765.8249738045077, -831.1886116942605, -762.3454772637814, -486.92455876945724, -448.69671577154355, -940.4412434150737, -727.1847401582801, -806.6944164867027, -901.2084436665884, -987.5989695409434, -671.6777141601648, -888.5446985441893, -721.5441831103919, -696.055020234459, -898.3968632804158, -1027.4011248166166, -403.03280759378634, -622.8093760673837, -812.637503569869, -862.0779852735153, -647.6766655147794, -693.7369514273789, -731.414711060411, -677.8189717782886, -496.3815859129291, -772.9002837693945, -784.9194702372788, -666.9597433282892, -736.7936402637039, -828.7171333864179, -929.0374674872801, -715.6177440587994, -938.376510490651, -809.9584996586964], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.34213259911933, "mean_inference_ms": 0.410319073296521, "mean_action_processing_ms": 0.09622261954117367, "mean_env_wait_ms": 3.056274213619056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003670930862426758, "StateBufferConnector_ms": 0.0028090476989746094, "ViewRequirementAgentConnector_ms": 0.06942605972290039}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 235320, "num_agent_steps_trained": 235320, "num_env_steps_sampled": 235320, "num_env_steps_trained": 235320, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.6891815095869, "num_env_steps_trained_throughput_per_sec": 39.6891815095869, "timesteps_total": 235320, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 235320, "timers": {"training_iteration_time_ms": 2986.399, "sample_time_ms": 2982.486, "load_time_ms": 0.24, "load_throughput": 499321.905, "learn_time_ms": 2.903, "learn_throughput": 41341.86, "synch_weights_time_ms": 0.724}, "counters": {"num_env_steps_sampled": 235320, "num_env_steps_trained": 235320, "num_agent_steps_sampled": 235320, "num_agent_steps_trained": 235320}, "done": false, "episodes_total": 1961, "training_iteration": 491, "trial_id": "53665_00000", "date": "2023-07-26_03-27-24", "timestamp": 1690331244, "time_this_iter_s": 12.096892833709717, "time_total_s": 5986.549955606461, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 365.22447967529297, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 44.038888888888884, "ram_util_percent": 77.5111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4902038574219, "policy_loss": -120063.0390625, "vf_loss": 6973096.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 127.0, "diff_num_grad_updates_vs_sampler_policy": 126.0}}, "num_env_steps_sampled": 235800, "num_env_steps_trained": 235800, "num_agent_steps_sampled": 235800, "num_agent_steps_trained": 235800}, "sampler_results": {"episode_reward_max": -393.3801237387281, "episode_reward_min": -1228.638734842368, "episode_reward_mean": -758.1477400582357, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-750.6149491461733, -611.3273245529999, -477.6000462599683, -701.393332105827, -669.7402630350878, -648.3790898089699, -604.4827643406974, -771.9488604461665, -514.9391731234848, -681.7357675104101, -605.5031164992423, -989.4815077313855, -915.0504238071034, -739.6376485282495, -637.4949336273813, -813.4236583447815, -1044.049131854899, -760.2720658529917, -574.7015103061706, -793.8920419818169, -561.4809307948568, -522.5100115114014, -825.1119693436538, -729.7625996528775, -926.1607609593053, -765.0306223697702, -656.701926588058, -825.1623533226306, -1056.6224861659093, -947.4262632439014, -695.5562926958454, -1014.9432852767619, -700.8825639828477, -535.4924764872237, -869.4949961638353, -813.7880785660427, -1063.7998193910535, -627.4015267093903, -487.4881272053504, -777.0204480278159, -570.4658893786288, -1228.638734842368, -849.224770025147, -770.1738519108461, -608.9017541481696, -792.5159874240176, -743.3822906671751, -653.2255588132094, -915.5377922969163, -967.9164083879504, -1224.124753580239, -736.8661339953352, -871.9493199469679, -449.44088607528846, -533.531392144829, -1222.8078149301723, -591.0592238638071, -732.1603902783818, -789.8588830338664, -788.6072712225003, -1072.6202813812297, -393.3801237387281, -765.8249738045077, -831.1886116942605, -762.3454772637814, -486.92455876945724, -448.69671577154355, -940.4412434150737, -727.1847401582801, -806.6944164867027, -901.2084436665884, -987.5989695409434, -671.6777141601648, -888.5446985441893, -721.5441831103919, -696.055020234459, -898.3968632804158, -1027.4011248166166, -403.03280759378634, -622.8093760673837, -812.637503569869, -862.0779852735153, -647.6766655147794, -693.7369514273789, -731.414711060411, -677.8189717782886, -496.3815859129291, -772.9002837693945, -784.9194702372788, -666.9597433282892, -736.7936402637039, -828.7171333864179, -929.0374674872801, -715.6177440587994, -938.376510490651, -809.9584996586964, -639.6658348782015, -625.3896161339452, -704.1842142384083, -939.044875568671], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.337999460475604, "mean_inference_ms": 0.41018953659841256, "mean_action_processing_ms": 0.09619359849295202, "mean_env_wait_ms": 3.0293665888070156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003717660903930664, "StateBufferConnector_ms": 0.0028274059295654297, "ViewRequirementAgentConnector_ms": 0.06978034973144531}}, "episode_reward_max": -393.3801237387281, "episode_reward_min": -1228.638734842368, "episode_reward_mean": -758.1477400582357, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-750.6149491461733, -611.3273245529999, -477.6000462599683, -701.393332105827, -669.7402630350878, -648.3790898089699, -604.4827643406974, -771.9488604461665, -514.9391731234848, -681.7357675104101, -605.5031164992423, -989.4815077313855, -915.0504238071034, -739.6376485282495, -637.4949336273813, -813.4236583447815, -1044.049131854899, -760.2720658529917, -574.7015103061706, -793.8920419818169, -561.4809307948568, -522.5100115114014, -825.1119693436538, -729.7625996528775, -926.1607609593053, -765.0306223697702, -656.701926588058, -825.1623533226306, -1056.6224861659093, -947.4262632439014, -695.5562926958454, -1014.9432852767619, -700.8825639828477, -535.4924764872237, -869.4949961638353, -813.7880785660427, -1063.7998193910535, -627.4015267093903, -487.4881272053504, -777.0204480278159, -570.4658893786288, -1228.638734842368, -849.224770025147, -770.1738519108461, -608.9017541481696, -792.5159874240176, -743.3822906671751, -653.2255588132094, -915.5377922969163, -967.9164083879504, -1224.124753580239, -736.8661339953352, -871.9493199469679, -449.44088607528846, -533.531392144829, -1222.8078149301723, -591.0592238638071, -732.1603902783818, -789.8588830338664, -788.6072712225003, -1072.6202813812297, -393.3801237387281, -765.8249738045077, -831.1886116942605, -762.3454772637814, -486.92455876945724, -448.69671577154355, -940.4412434150737, -727.1847401582801, -806.6944164867027, -901.2084436665884, -987.5989695409434, -671.6777141601648, -888.5446985441893, -721.5441831103919, -696.055020234459, -898.3968632804158, -1027.4011248166166, -403.03280759378634, -622.8093760673837, -812.637503569869, -862.0779852735153, -647.6766655147794, -693.7369514273789, -731.414711060411, -677.8189717782886, -496.3815859129291, -772.9002837693945, -784.9194702372788, -666.9597433282892, -736.7936402637039, -828.7171333864179, -929.0374674872801, -715.6177440587994, -938.376510490651, -809.9584996586964, -639.6658348782015, -625.3896161339452, -704.1842142384083, -939.044875568671], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.337999460475604, "mean_inference_ms": 0.41018953659841256, "mean_action_processing_ms": 0.09619359849295202, "mean_env_wait_ms": 3.0293665888070156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003717660903930664, "StateBufferConnector_ms": 0.0028274059295654297, "ViewRequirementAgentConnector_ms": 0.06978034973144531}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 235800, "num_agent_steps_trained": 235800, "num_env_steps_sampled": 235800, "num_env_steps_trained": 235800, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.05807546994549, "num_env_steps_trained_throughput_per_sec": 39.05807546994549, "timesteps_total": 235800, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 235800, "timers": {"training_iteration_time_ms": 3057.205, "sample_time_ms": 3053.306, "load_time_ms": 0.231, "load_throughput": 518401.978, "learn_time_ms": 2.899, "learn_throughput": 41393.2, "synch_weights_time_ms": 0.723}, "counters": {"num_env_steps_sampled": 235800, "num_env_steps_trained": 235800, "num_agent_steps_sampled": 235800, "num_agent_steps_trained": 235800}, "done": false, "episodes_total": 1965, "training_iteration": 492, "trial_id": "53665_00000", "date": "2023-07-26_03-27-36", "timestamp": 1690331256, "time_this_iter_s": 12.292175054550171, "time_total_s": 5998.842130661011, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 377.51665472984314, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 41.22941176470588, "ram_util_percent": 78.48823529411766}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.5232238769531, "policy_loss": -87053.3359375, "vf_loss": 3510166.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 131.0, "diff_num_grad_updates_vs_sampler_policy": 130.0}}, "num_env_steps_sampled": 236280, "num_env_steps_trained": 236280, "num_agent_steps_sampled": 236280, "num_agent_steps_trained": 236280}, "sampler_results": {"episode_reward_max": -393.3801237387281, "episode_reward_min": -1228.638734842368, "episode_reward_mean": -758.0129326578115, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-669.7402630350878, -648.3790898089699, -604.4827643406974, -771.9488604461665, -514.9391731234848, -681.7357675104101, -605.5031164992423, -989.4815077313855, -915.0504238071034, -739.6376485282495, -637.4949336273813, -813.4236583447815, -1044.049131854899, -760.2720658529917, -574.7015103061706, -793.8920419818169, -561.4809307948568, -522.5100115114014, -825.1119693436538, -729.7625996528775, -926.1607609593053, -765.0306223697702, -656.701926588058, -825.1623533226306, -1056.6224861659093, -947.4262632439014, -695.5562926958454, -1014.9432852767619, -700.8825639828477, -535.4924764872237, -869.4949961638353, -813.7880785660427, -1063.7998193910535, -627.4015267093903, -487.4881272053504, -777.0204480278159, -570.4658893786288, -1228.638734842368, -849.224770025147, -770.1738519108461, -608.9017541481696, -792.5159874240176, -743.3822906671751, -653.2255588132094, -915.5377922969163, -967.9164083879504, -1224.124753580239, -736.8661339953352, -871.9493199469679, -449.44088607528846, -533.531392144829, -1222.8078149301723, -591.0592238638071, -732.1603902783818, -789.8588830338664, -788.6072712225003, -1072.6202813812297, -393.3801237387281, -765.8249738045077, -831.1886116942605, -762.3454772637814, -486.92455876945724, -448.69671577154355, -940.4412434150737, -727.1847401582801, -806.6944164867027, -901.2084436665884, -987.5989695409434, -671.6777141601648, -888.5446985441893, -721.5441831103919, -696.055020234459, -898.3968632804158, -1027.4011248166166, -403.03280759378634, -622.8093760673837, -812.637503569869, -862.0779852735153, -647.6766655147794, -693.7369514273789, -731.414711060411, -677.8189717782886, -496.3815859129291, -772.9002837693945, -784.9194702372788, -666.9597433282892, -736.7936402637039, -828.7171333864179, -929.0374674872801, -715.6177440587994, -938.376510490651, -809.9584996586964, -639.6658348782015, -625.3896161339452, -704.1842142384083, -939.044875568671, -840.4886444151232, -449.8080675969133, -496.15838555700157, -740.9998144535155], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.33061904892644, "mean_inference_ms": 0.41009795307953345, "mean_action_processing_ms": 0.09617817280417032, "mean_env_wait_ms": 3.006915479288807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003722667694091797, "StateBufferConnector_ms": 0.002828359603881836, "ViewRequirementAgentConnector_ms": 0.06950759887695312}}, "episode_reward_max": -393.3801237387281, "episode_reward_min": -1228.638734842368, "episode_reward_mean": -758.0129326578115, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-669.7402630350878, -648.3790898089699, -604.4827643406974, -771.9488604461665, -514.9391731234848, -681.7357675104101, -605.5031164992423, -989.4815077313855, -915.0504238071034, -739.6376485282495, -637.4949336273813, -813.4236583447815, -1044.049131854899, -760.2720658529917, -574.7015103061706, -793.8920419818169, -561.4809307948568, -522.5100115114014, -825.1119693436538, -729.7625996528775, -926.1607609593053, -765.0306223697702, -656.701926588058, -825.1623533226306, -1056.6224861659093, -947.4262632439014, -695.5562926958454, -1014.9432852767619, -700.8825639828477, -535.4924764872237, -869.4949961638353, -813.7880785660427, -1063.7998193910535, -627.4015267093903, -487.4881272053504, -777.0204480278159, -570.4658893786288, -1228.638734842368, -849.224770025147, -770.1738519108461, -608.9017541481696, -792.5159874240176, -743.3822906671751, -653.2255588132094, -915.5377922969163, -967.9164083879504, -1224.124753580239, -736.8661339953352, -871.9493199469679, -449.44088607528846, -533.531392144829, -1222.8078149301723, -591.0592238638071, -732.1603902783818, -789.8588830338664, -788.6072712225003, -1072.6202813812297, -393.3801237387281, -765.8249738045077, -831.1886116942605, -762.3454772637814, -486.92455876945724, -448.69671577154355, -940.4412434150737, -727.1847401582801, -806.6944164867027, -901.2084436665884, -987.5989695409434, -671.6777141601648, -888.5446985441893, -721.5441831103919, -696.055020234459, -898.3968632804158, -1027.4011248166166, -403.03280759378634, -622.8093760673837, -812.637503569869, -862.0779852735153, -647.6766655147794, -693.7369514273789, -731.414711060411, -677.8189717782886, -496.3815859129291, -772.9002837693945, -784.9194702372788, -666.9597433282892, -736.7936402637039, -828.7171333864179, -929.0374674872801, -715.6177440587994, -938.376510490651, -809.9584996586964, -639.6658348782015, -625.3896161339452, -704.1842142384083, -939.044875568671, -840.4886444151232, -449.8080675969133, -496.15838555700157, -740.9998144535155], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.33061904892644, "mean_inference_ms": 0.41009795307953345, "mean_action_processing_ms": 0.09617817280417032, "mean_env_wait_ms": 3.006915479288807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003722667694091797, "StateBufferConnector_ms": 0.002828359603881836, "ViewRequirementAgentConnector_ms": 0.06950759887695312}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 236280, "num_agent_steps_trained": 236280, "num_env_steps_sampled": 236280, "num_env_steps_trained": 236280, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.11320191795078, "num_env_steps_trained_throughput_per_sec": 40.11320191795078, "timesteps_total": 236280, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 236280, "timers": {"training_iteration_time_ms": 3004.273, "sample_time_ms": 3000.234, "load_time_ms": 0.234, "load_throughput": 512855.594, "learn_time_ms": 3.016, "learn_throughput": 39787.864, "synch_weights_time_ms": 0.745}, "counters": {"num_env_steps_sampled": 236280, "num_env_steps_trained": 236280, "num_agent_steps_sampled": 236280, "num_agent_steps_trained": 236280}, "done": false, "episodes_total": 1969, "training_iteration": 493, "trial_id": "53665_00000", "date": "2023-07-26_03-27-48", "timestamp": 1690331268, "time_this_iter_s": 11.96890902519226, "time_total_s": 6010.811039686203, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 389.4855637550354, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 53.98823529411765, "ram_util_percent": 78.97647058823529}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.5210266113281, "policy_loss": -95145.3515625, "vf_loss": 4291415.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 135.0, "diff_num_grad_updates_vs_sampler_policy": 134.0}}, "num_env_steps_sampled": 236760, "num_env_steps_trained": 236760, "num_agent_steps_sampled": 236760, "num_agent_steps_trained": 236760}, "sampler_results": {"episode_reward_max": -393.3801237387281, "episode_reward_min": -1228.638734842368, "episode_reward_mean": -758.3918732222671, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-514.9391731234848, -681.7357675104101, -605.5031164992423, -989.4815077313855, -915.0504238071034, -739.6376485282495, -637.4949336273813, -813.4236583447815, -1044.049131854899, -760.2720658529917, -574.7015103061706, -793.8920419818169, -561.4809307948568, -522.5100115114014, -825.1119693436538, -729.7625996528775, -926.1607609593053, -765.0306223697702, -656.701926588058, -825.1623533226306, -1056.6224861659093, -947.4262632439014, -695.5562926958454, -1014.9432852767619, -700.8825639828477, -535.4924764872237, -869.4949961638353, -813.7880785660427, -1063.7998193910535, -627.4015267093903, -487.4881272053504, -777.0204480278159, -570.4658893786288, -1228.638734842368, -849.224770025147, -770.1738519108461, -608.9017541481696, -792.5159874240176, -743.3822906671751, -653.2255588132094, -915.5377922969163, -967.9164083879504, -1224.124753580239, -736.8661339953352, -871.9493199469679, -449.44088607528846, -533.531392144829, -1222.8078149301723, -591.0592238638071, -732.1603902783818, -789.8588830338664, -788.6072712225003, -1072.6202813812297, -393.3801237387281, -765.8249738045077, -831.1886116942605, -762.3454772637814, -486.92455876945724, -448.69671577154355, -940.4412434150737, -727.1847401582801, -806.6944164867027, -901.2084436665884, -987.5989695409434, -671.6777141601648, -888.5446985441893, -721.5441831103919, -696.055020234459, -898.3968632804158, -1027.4011248166166, -403.03280759378634, -622.8093760673837, -812.637503569869, -862.0779852735153, -647.6766655147794, -693.7369514273789, -731.414711060411, -677.8189717782886, -496.3815859129291, -772.9002837693945, -784.9194702372788, -666.9597433282892, -736.7936402637039, -828.7171333864179, -929.0374674872801, -715.6177440587994, -938.376510490651, -809.9584996586964, -639.6658348782015, -625.3896161339452, -704.1842142384083, -939.044875568671, -840.4886444151232, -449.8080675969133, -496.15838555700157, -740.9998144535155, -614.2794320613347, -676.2066202764812, -655.6447688061047, -786.3142129325706], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.323819590944527, "mean_inference_ms": 0.41005291085113343, "mean_action_processing_ms": 0.09616898888115194, "mean_env_wait_ms": 2.987848105852884, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003722667694091797, "StateBufferConnector_ms": 0.0028269290924072266, "ViewRequirementAgentConnector_ms": 0.06957244873046875}}, "episode_reward_max": -393.3801237387281, "episode_reward_min": -1228.638734842368, "episode_reward_mean": -758.3918732222671, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-514.9391731234848, -681.7357675104101, -605.5031164992423, -989.4815077313855, -915.0504238071034, -739.6376485282495, -637.4949336273813, -813.4236583447815, -1044.049131854899, -760.2720658529917, -574.7015103061706, -793.8920419818169, -561.4809307948568, -522.5100115114014, -825.1119693436538, -729.7625996528775, -926.1607609593053, -765.0306223697702, -656.701926588058, -825.1623533226306, -1056.6224861659093, -947.4262632439014, -695.5562926958454, -1014.9432852767619, -700.8825639828477, -535.4924764872237, -869.4949961638353, -813.7880785660427, -1063.7998193910535, -627.4015267093903, -487.4881272053504, -777.0204480278159, -570.4658893786288, -1228.638734842368, -849.224770025147, -770.1738519108461, -608.9017541481696, -792.5159874240176, -743.3822906671751, -653.2255588132094, -915.5377922969163, -967.9164083879504, -1224.124753580239, -736.8661339953352, -871.9493199469679, -449.44088607528846, -533.531392144829, -1222.8078149301723, -591.0592238638071, -732.1603902783818, -789.8588830338664, -788.6072712225003, -1072.6202813812297, -393.3801237387281, -765.8249738045077, -831.1886116942605, -762.3454772637814, -486.92455876945724, -448.69671577154355, -940.4412434150737, -727.1847401582801, -806.6944164867027, -901.2084436665884, -987.5989695409434, -671.6777141601648, -888.5446985441893, -721.5441831103919, -696.055020234459, -898.3968632804158, -1027.4011248166166, -403.03280759378634, -622.8093760673837, -812.637503569869, -862.0779852735153, -647.6766655147794, -693.7369514273789, -731.414711060411, -677.8189717782886, -496.3815859129291, -772.9002837693945, -784.9194702372788, -666.9597433282892, -736.7936402637039, -828.7171333864179, -929.0374674872801, -715.6177440587994, -938.376510490651, -809.9584996586964, -639.6658348782015, -625.3896161339452, -704.1842142384083, -939.044875568671, -840.4886444151232, -449.8080675969133, -496.15838555700157, -740.9998144535155, -614.2794320613347, -676.2066202764812, -655.6447688061047, -786.3142129325706], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.323819590944527, "mean_inference_ms": 0.41005291085113343, "mean_action_processing_ms": 0.09616898888115194, "mean_env_wait_ms": 2.987848105852884, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003722667694091797, "StateBufferConnector_ms": 0.0028269290924072266, "ViewRequirementAgentConnector_ms": 0.06957244873046875}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 236760, "num_agent_steps_trained": 236760, "num_env_steps_sampled": 236760, "num_env_steps_trained": 236760, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.735025676192244, "num_env_steps_trained_throughput_per_sec": 41.735025676192244, "timesteps_total": 236760, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 236760, "timers": {"training_iteration_time_ms": 2920.942, "sample_time_ms": 2916.774, "load_time_ms": 0.245, "load_throughput": 490084.206, "learn_time_ms": 3.106, "learn_throughput": 38631.663, "synch_weights_time_ms": 0.767}, "counters": {"num_env_steps_sampled": 236760, "num_env_steps_trained": 236760, "num_agent_steps_sampled": 236760, "num_agent_steps_trained": 236760}, "done": false, "episodes_total": 1973, "training_iteration": 494, "trial_id": "53665_00000", "date": "2023-07-26_03-28-00", "timestamp": 1690331280, "time_this_iter_s": 11.504215955734253, "time_total_s": 6022.315255641937, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 400.98977971076965, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 40.993750000000006, "ram_util_percent": 78.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.51702880859375, "policy_loss": -108533.9609375, "vf_loss": 5279490.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 139.0, "diff_num_grad_updates_vs_sampler_policy": 138.0}}, "num_env_steps_sampled": 237240, "num_env_steps_trained": 237240, "num_agent_steps_sampled": 237240, "num_agent_steps_trained": 237240}, "sampler_results": {"episode_reward_max": -393.3801237387281, "episode_reward_min": -1228.638734842368, "episode_reward_mean": -758.7580781035788, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-915.0504238071034, -739.6376485282495, -637.4949336273813, -813.4236583447815, -1044.049131854899, -760.2720658529917, -574.7015103061706, -793.8920419818169, -561.4809307948568, -522.5100115114014, -825.1119693436538, -729.7625996528775, -926.1607609593053, -765.0306223697702, -656.701926588058, -825.1623533226306, -1056.6224861659093, -947.4262632439014, -695.5562926958454, -1014.9432852767619, -700.8825639828477, -535.4924764872237, -869.4949961638353, -813.7880785660427, -1063.7998193910535, -627.4015267093903, -487.4881272053504, -777.0204480278159, -570.4658893786288, -1228.638734842368, -849.224770025147, -770.1738519108461, -608.9017541481696, -792.5159874240176, -743.3822906671751, -653.2255588132094, -915.5377922969163, -967.9164083879504, -1224.124753580239, -736.8661339953352, -871.9493199469679, -449.44088607528846, -533.531392144829, -1222.8078149301723, -591.0592238638071, -732.1603902783818, -789.8588830338664, -788.6072712225003, -1072.6202813812297, -393.3801237387281, -765.8249738045077, -831.1886116942605, -762.3454772637814, -486.92455876945724, -448.69671577154355, -940.4412434150737, -727.1847401582801, -806.6944164867027, -901.2084436665884, -987.5989695409434, -671.6777141601648, -888.5446985441893, -721.5441831103919, -696.055020234459, -898.3968632804158, -1027.4011248166166, -403.03280759378634, -622.8093760673837, -812.637503569869, -862.0779852735153, -647.6766655147794, -693.7369514273789, -731.414711060411, -677.8189717782886, -496.3815859129291, -772.9002837693945, -784.9194702372788, -666.9597433282892, -736.7936402637039, -828.7171333864179, -929.0374674872801, -715.6177440587994, -938.376510490651, -809.9584996586964, -639.6658348782015, -625.3896161339452, -704.1842142384083, -939.044875568671, -840.4886444151232, -449.8080675969133, -496.15838555700157, -740.9998144535155, -614.2794320613347, -676.2066202764812, -655.6447688061047, -786.3142129325706, -748.214887257547, -717.5610314603733, -567.3208605917897, -795.1832736859715], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.31758641136105, "mean_inference_ms": 0.4095507719928348, "mean_action_processing_ms": 0.09614455620081162, "mean_env_wait_ms": 2.969826768383259, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037152767181396484, "StateBufferConnector_ms": 0.0028238296508789062, "ViewRequirementAgentConnector_ms": 0.0694432258605957}}, "episode_reward_max": -393.3801237387281, "episode_reward_min": -1228.638734842368, "episode_reward_mean": -758.7580781035788, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-915.0504238071034, -739.6376485282495, -637.4949336273813, -813.4236583447815, -1044.049131854899, -760.2720658529917, -574.7015103061706, -793.8920419818169, -561.4809307948568, -522.5100115114014, -825.1119693436538, -729.7625996528775, -926.1607609593053, -765.0306223697702, -656.701926588058, -825.1623533226306, -1056.6224861659093, -947.4262632439014, -695.5562926958454, -1014.9432852767619, -700.8825639828477, -535.4924764872237, -869.4949961638353, -813.7880785660427, -1063.7998193910535, -627.4015267093903, -487.4881272053504, -777.0204480278159, -570.4658893786288, -1228.638734842368, -849.224770025147, -770.1738519108461, -608.9017541481696, -792.5159874240176, -743.3822906671751, -653.2255588132094, -915.5377922969163, -967.9164083879504, -1224.124753580239, -736.8661339953352, -871.9493199469679, -449.44088607528846, -533.531392144829, -1222.8078149301723, -591.0592238638071, -732.1603902783818, -789.8588830338664, -788.6072712225003, -1072.6202813812297, -393.3801237387281, -765.8249738045077, -831.1886116942605, -762.3454772637814, -486.92455876945724, -448.69671577154355, -940.4412434150737, -727.1847401582801, -806.6944164867027, -901.2084436665884, -987.5989695409434, -671.6777141601648, -888.5446985441893, -721.5441831103919, -696.055020234459, -898.3968632804158, -1027.4011248166166, -403.03280759378634, -622.8093760673837, -812.637503569869, -862.0779852735153, -647.6766655147794, -693.7369514273789, -731.414711060411, -677.8189717782886, -496.3815859129291, -772.9002837693945, -784.9194702372788, -666.9597433282892, -736.7936402637039, -828.7171333864179, -929.0374674872801, -715.6177440587994, -938.376510490651, -809.9584996586964, -639.6658348782015, -625.3896161339452, -704.1842142384083, -939.044875568671, -840.4886444151232, -449.8080675969133, -496.15838555700157, -740.9998144535155, -614.2794320613347, -676.2066202764812, -655.6447688061047, -786.3142129325706, -748.214887257547, -717.5610314603733, -567.3208605917897, -795.1832736859715], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.31758641136105, "mean_inference_ms": 0.4095507719928348, "mean_action_processing_ms": 0.09614455620081162, "mean_env_wait_ms": 2.969826768383259, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037152767181396484, "StateBufferConnector_ms": 0.0028238296508789062, "ViewRequirementAgentConnector_ms": 0.0694432258605957}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 237240, "num_agent_steps_trained": 237240, "num_env_steps_sampled": 237240, "num_env_steps_trained": 237240, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.3516723186505, "num_env_steps_trained_throughput_per_sec": 41.3516723186505, "timesteps_total": 237240, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 237240, "timers": {"training_iteration_time_ms": 2876.119, "sample_time_ms": 2872.123, "load_time_ms": 0.235, "load_throughput": 510981.198, "learn_time_ms": 2.973, "learn_throughput": 40366.396, "synch_weights_time_ms": 0.739}, "counters": {"num_env_steps_sampled": 237240, "num_env_steps_trained": 237240, "num_agent_steps_sampled": 237240, "num_agent_steps_trained": 237240}, "done": false, "episodes_total": 1977, "training_iteration": 495, "trial_id": "53665_00000", "date": "2023-07-26_03-28-12", "timestamp": 1690331292, "time_this_iter_s": 11.610755205154419, "time_total_s": 6033.926010847092, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 412.6005349159241, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 43.5235294117647, "ram_util_percent": 79.22941176470589}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.45635986328125, "policy_loss": -58502.56640625, "vf_loss": 1810857.625}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 143.0, "diff_num_grad_updates_vs_sampler_policy": 142.0}}, "num_env_steps_sampled": 237720, "num_env_steps_trained": 237720, "num_agent_steps_sampled": 237720, "num_agent_steps_trained": 237720}, "sampler_results": {"episode_reward_max": -393.3801237387281, "episode_reward_min": -1228.638734842368, "episode_reward_mean": -752.9533591714707, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1044.049131854899, -760.2720658529917, -574.7015103061706, -793.8920419818169, -561.4809307948568, -522.5100115114014, -825.1119693436538, -729.7625996528775, -926.1607609593053, -765.0306223697702, -656.701926588058, -825.1623533226306, -1056.6224861659093, -947.4262632439014, -695.5562926958454, -1014.9432852767619, -700.8825639828477, -535.4924764872237, -869.4949961638353, -813.7880785660427, -1063.7998193910535, -627.4015267093903, -487.4881272053504, -777.0204480278159, -570.4658893786288, -1228.638734842368, -849.224770025147, -770.1738519108461, -608.9017541481696, -792.5159874240176, -743.3822906671751, -653.2255588132094, -915.5377922969163, -967.9164083879504, -1224.124753580239, -736.8661339953352, -871.9493199469679, -449.44088607528846, -533.531392144829, -1222.8078149301723, -591.0592238638071, -732.1603902783818, -789.8588830338664, -788.6072712225003, -1072.6202813812297, -393.3801237387281, -765.8249738045077, -831.1886116942605, -762.3454772637814, -486.92455876945724, -448.69671577154355, -940.4412434150737, -727.1847401582801, -806.6944164867027, -901.2084436665884, -987.5989695409434, -671.6777141601648, -888.5446985441893, -721.5441831103919, -696.055020234459, -898.3968632804158, -1027.4011248166166, -403.03280759378634, -622.8093760673837, -812.637503569869, -862.0779852735153, -647.6766655147794, -693.7369514273789, -731.414711060411, -677.8189717782886, -496.3815859129291, -772.9002837693945, -784.9194702372788, -666.9597433282892, -736.7936402637039, -828.7171333864179, -929.0374674872801, -715.6177440587994, -938.376510490651, -809.9584996586964, -639.6658348782015, -625.3896161339452, -704.1842142384083, -939.044875568671, -840.4886444151232, -449.8080675969133, -496.15838555700157, -740.9998144535155, -614.2794320613347, -676.2066202764812, -655.6447688061047, -786.3142129325706, -748.214887257547, -717.5610314603733, -567.3208605917897, -795.1832736859715, -522.5236199172583, -641.873038589753, -772.9943629527012, -587.7437496369887], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.312535478890403, "mean_inference_ms": 0.4091792120164005, "mean_action_processing_ms": 0.09613503166339328, "mean_env_wait_ms": 2.9539013806926095, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037200450897216797, "StateBufferConnector_ms": 0.002826690673828125, "ViewRequirementAgentConnector_ms": 0.06942152976989746}}, "episode_reward_max": -393.3801237387281, "episode_reward_min": -1228.638734842368, "episode_reward_mean": -752.9533591714707, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1044.049131854899, -760.2720658529917, -574.7015103061706, -793.8920419818169, -561.4809307948568, -522.5100115114014, -825.1119693436538, -729.7625996528775, -926.1607609593053, -765.0306223697702, -656.701926588058, -825.1623533226306, -1056.6224861659093, -947.4262632439014, -695.5562926958454, -1014.9432852767619, -700.8825639828477, -535.4924764872237, -869.4949961638353, -813.7880785660427, -1063.7998193910535, -627.4015267093903, -487.4881272053504, -777.0204480278159, -570.4658893786288, -1228.638734842368, -849.224770025147, -770.1738519108461, -608.9017541481696, -792.5159874240176, -743.3822906671751, -653.2255588132094, -915.5377922969163, -967.9164083879504, -1224.124753580239, -736.8661339953352, -871.9493199469679, -449.44088607528846, -533.531392144829, -1222.8078149301723, -591.0592238638071, -732.1603902783818, -789.8588830338664, -788.6072712225003, -1072.6202813812297, -393.3801237387281, -765.8249738045077, -831.1886116942605, -762.3454772637814, -486.92455876945724, -448.69671577154355, -940.4412434150737, -727.1847401582801, -806.6944164867027, -901.2084436665884, -987.5989695409434, -671.6777141601648, -888.5446985441893, -721.5441831103919, -696.055020234459, -898.3968632804158, -1027.4011248166166, -403.03280759378634, -622.8093760673837, -812.637503569869, -862.0779852735153, -647.6766655147794, -693.7369514273789, -731.414711060411, -677.8189717782886, -496.3815859129291, -772.9002837693945, -784.9194702372788, -666.9597433282892, -736.7936402637039, -828.7171333864179, -929.0374674872801, -715.6177440587994, -938.376510490651, -809.9584996586964, -639.6658348782015, -625.3896161339452, -704.1842142384083, -939.044875568671, -840.4886444151232, -449.8080675969133, -496.15838555700157, -740.9998144535155, -614.2794320613347, -676.2066202764812, -655.6447688061047, -786.3142129325706, -748.214887257547, -717.5610314603733, -567.3208605917897, -795.1832736859715, -522.5236199172583, -641.873038589753, -772.9943629527012, -587.7437496369887], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.312535478890403, "mean_inference_ms": 0.4091792120164005, "mean_action_processing_ms": 0.09613503166339328, "mean_env_wait_ms": 2.9539013806926095, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037200450897216797, "StateBufferConnector_ms": 0.002826690673828125, "ViewRequirementAgentConnector_ms": 0.06942152976989746}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 237720, "num_agent_steps_trained": 237720, "num_env_steps_sampled": 237720, "num_env_steps_trained": 237720, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.833779467386655, "num_env_steps_trained_throughput_per_sec": 38.833779467386655, "timesteps_total": 237720, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 237720, "timers": {"training_iteration_time_ms": 2967.396, "sample_time_ms": 2963.25, "load_time_ms": 0.249, "load_throughput": 480998.165, "learn_time_ms": 3.041, "learn_throughput": 39463.422, "synch_weights_time_ms": 0.806}, "counters": {"num_env_steps_sampled": 237720, "num_env_steps_trained": 237720, "num_agent_steps_sampled": 237720, "num_agent_steps_trained": 237720}, "done": false, "episodes_total": 1981, "training_iteration": 496, "trial_id": "53665_00000", "date": "2023-07-26_03-28-24", "timestamp": 1690331304, "time_this_iter_s": 12.363351106643677, "time_total_s": 6046.289361953735, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 424.96388602256775, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 43.977777777777774, "ram_util_percent": 80.02777777777779}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.5141906738281, "policy_loss": -99232.4765625, "vf_loss": 4676229.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 147.0, "diff_num_grad_updates_vs_sampler_policy": 146.0}}, "num_env_steps_sampled": 238200, "num_env_steps_trained": 238200, "num_agent_steps_sampled": 238200, "num_agent_steps_trained": 238200}, "sampler_results": {"episode_reward_max": -393.3801237387281, "episode_reward_min": -1228.638734842368, "episode_reward_mean": -750.48922425792, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-561.4809307948568, -522.5100115114014, -825.1119693436538, -729.7625996528775, -926.1607609593053, -765.0306223697702, -656.701926588058, -825.1623533226306, -1056.6224861659093, -947.4262632439014, -695.5562926958454, -1014.9432852767619, -700.8825639828477, -535.4924764872237, -869.4949961638353, -813.7880785660427, -1063.7998193910535, -627.4015267093903, -487.4881272053504, -777.0204480278159, -570.4658893786288, -1228.638734842368, -849.224770025147, -770.1738519108461, -608.9017541481696, -792.5159874240176, -743.3822906671751, -653.2255588132094, -915.5377922969163, -967.9164083879504, -1224.124753580239, -736.8661339953352, -871.9493199469679, -449.44088607528846, -533.531392144829, -1222.8078149301723, -591.0592238638071, -732.1603902783818, -789.8588830338664, -788.6072712225003, -1072.6202813812297, -393.3801237387281, -765.8249738045077, -831.1886116942605, -762.3454772637814, -486.92455876945724, -448.69671577154355, -940.4412434150737, -727.1847401582801, -806.6944164867027, -901.2084436665884, -987.5989695409434, -671.6777141601648, -888.5446985441893, -721.5441831103919, -696.055020234459, -898.3968632804158, -1027.4011248166166, -403.03280759378634, -622.8093760673837, -812.637503569869, -862.0779852735153, -647.6766655147794, -693.7369514273789, -731.414711060411, -677.8189717782886, -496.3815859129291, -772.9002837693945, -784.9194702372788, -666.9597433282892, -736.7936402637039, -828.7171333864179, -929.0374674872801, -715.6177440587994, -938.376510490651, -809.9584996586964, -639.6658348782015, -625.3896161339452, -704.1842142384083, -939.044875568671, -840.4886444151232, -449.8080675969133, -496.15838555700157, -740.9998144535155, -614.2794320613347, -676.2066202764812, -655.6447688061047, -786.3142129325706, -748.214887257547, -717.5610314603733, -567.3208605917897, -795.1832736859715, -522.5236199172583, -641.873038589753, -772.9943629527012, -587.7437496369887, -654.6097072248673, -660.0811819240284, -840.1582661241384, -771.6521033677748], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.30864871474337, "mean_inference_ms": 0.40895131591842104, "mean_action_processing_ms": 0.09613486686354399, "mean_env_wait_ms": 2.9398569183975143, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037190914154052734, "StateBufferConnector_ms": 0.0028183460235595703, "ViewRequirementAgentConnector_ms": 0.06938791275024414}}, "episode_reward_max": -393.3801237387281, "episode_reward_min": -1228.638734842368, "episode_reward_mean": -750.48922425792, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-561.4809307948568, -522.5100115114014, -825.1119693436538, -729.7625996528775, -926.1607609593053, -765.0306223697702, -656.701926588058, -825.1623533226306, -1056.6224861659093, -947.4262632439014, -695.5562926958454, -1014.9432852767619, -700.8825639828477, -535.4924764872237, -869.4949961638353, -813.7880785660427, -1063.7998193910535, -627.4015267093903, -487.4881272053504, -777.0204480278159, -570.4658893786288, -1228.638734842368, -849.224770025147, -770.1738519108461, -608.9017541481696, -792.5159874240176, -743.3822906671751, -653.2255588132094, -915.5377922969163, -967.9164083879504, -1224.124753580239, -736.8661339953352, -871.9493199469679, -449.44088607528846, -533.531392144829, -1222.8078149301723, -591.0592238638071, -732.1603902783818, -789.8588830338664, -788.6072712225003, -1072.6202813812297, -393.3801237387281, -765.8249738045077, -831.1886116942605, -762.3454772637814, -486.92455876945724, -448.69671577154355, -940.4412434150737, -727.1847401582801, -806.6944164867027, -901.2084436665884, -987.5989695409434, -671.6777141601648, -888.5446985441893, -721.5441831103919, -696.055020234459, -898.3968632804158, -1027.4011248166166, -403.03280759378634, -622.8093760673837, -812.637503569869, -862.0779852735153, -647.6766655147794, -693.7369514273789, -731.414711060411, -677.8189717782886, -496.3815859129291, -772.9002837693945, -784.9194702372788, -666.9597433282892, -736.7936402637039, -828.7171333864179, -929.0374674872801, -715.6177440587994, -938.376510490651, -809.9584996586964, -639.6658348782015, -625.3896161339452, -704.1842142384083, -939.044875568671, -840.4886444151232, -449.8080675969133, -496.15838555700157, -740.9998144535155, -614.2794320613347, -676.2066202764812, -655.6447688061047, -786.3142129325706, -748.214887257547, -717.5610314603733, -567.3208605917897, -795.1832736859715, -522.5236199172583, -641.873038589753, -772.9943629527012, -587.7437496369887, -654.6097072248673, -660.0811819240284, -840.1582661241384, -771.6521033677748], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.30864871474337, "mean_inference_ms": 0.40895131591842104, "mean_action_processing_ms": 0.09613486686354399, "mean_env_wait_ms": 2.9398569183975143, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037190914154052734, "StateBufferConnector_ms": 0.0028183460235595703, "ViewRequirementAgentConnector_ms": 0.06938791275024414}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 238200, "num_agent_steps_trained": 238200, "num_env_steps_sampled": 238200, "num_env_steps_trained": 238200, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.392883974738304, "num_env_steps_trained_throughput_per_sec": 40.392883974738304, "timesteps_total": 238200, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 238200, "timers": {"training_iteration_time_ms": 3008.078, "sample_time_ms": 3002.26, "load_time_ms": 0.248, "load_throughput": 484750.535, "learn_time_ms": 4.59, "learn_throughput": 26144.273, "synch_weights_time_ms": 0.932}, "counters": {"num_env_steps_sampled": 238200, "num_env_steps_trained": 238200, "num_agent_steps_sampled": 238200, "num_agent_steps_trained": 238200}, "done": false, "episodes_total": 1985, "training_iteration": 497, "trial_id": "53665_00000", "date": "2023-07-26_03-28-36", "timestamp": 1690331316, "time_this_iter_s": 11.886077880859375, "time_total_s": 6058.175439834595, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 436.8499639034271, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 36.688235294117646, "ram_util_percent": 76.15294117647059}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.5128173828125, "policy_loss": -107902.171875, "vf_loss": 5118798.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 151.0, "diff_num_grad_updates_vs_sampler_policy": 150.0}}, "num_env_steps_sampled": 238680, "num_env_steps_trained": 238680, "num_agent_steps_sampled": 238680, "num_agent_steps_trained": 238680}, "sampler_results": {"episode_reward_max": -393.3801237387281, "episode_reward_min": -1228.638734842368, "episode_reward_mean": -752.292822209921, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-926.1607609593053, -765.0306223697702, -656.701926588058, -825.1623533226306, -1056.6224861659093, -947.4262632439014, -695.5562926958454, -1014.9432852767619, -700.8825639828477, -535.4924764872237, -869.4949961638353, -813.7880785660427, -1063.7998193910535, -627.4015267093903, -487.4881272053504, -777.0204480278159, -570.4658893786288, -1228.638734842368, -849.224770025147, -770.1738519108461, -608.9017541481696, -792.5159874240176, -743.3822906671751, -653.2255588132094, -915.5377922969163, -967.9164083879504, -1224.124753580239, -736.8661339953352, -871.9493199469679, -449.44088607528846, -533.531392144829, -1222.8078149301723, -591.0592238638071, -732.1603902783818, -789.8588830338664, -788.6072712225003, -1072.6202813812297, -393.3801237387281, -765.8249738045077, -831.1886116942605, -762.3454772637814, -486.92455876945724, -448.69671577154355, -940.4412434150737, -727.1847401582801, -806.6944164867027, -901.2084436665884, -987.5989695409434, -671.6777141601648, -888.5446985441893, -721.5441831103919, -696.055020234459, -898.3968632804158, -1027.4011248166166, -403.03280759378634, -622.8093760673837, -812.637503569869, -862.0779852735153, -647.6766655147794, -693.7369514273789, -731.414711060411, -677.8189717782886, -496.3815859129291, -772.9002837693945, -784.9194702372788, -666.9597433282892, -736.7936402637039, -828.7171333864179, -929.0374674872801, -715.6177440587994, -938.376510490651, -809.9584996586964, -639.6658348782015, -625.3896161339452, -704.1842142384083, -939.044875568671, -840.4886444151232, -449.8080675969133, -496.15838555700157, -740.9998144535155, -614.2794320613347, -676.2066202764812, -655.6447688061047, -786.3142129325706, -748.214887257547, -717.5610314603733, -567.3208605917897, -795.1832736859715, -522.5236199172583, -641.873038589753, -772.9943629527012, -587.7437496369887, -654.6097072248673, -660.0811819240284, -840.1582661241384, -771.6521033677748, -770.5913338343424, -560.3132301075361, -664.500084210021, -823.8206583509998], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.30665483802561, "mean_inference_ms": 0.4087922735633095, "mean_action_processing_ms": 0.09614029626931098, "mean_env_wait_ms": 2.927410734815197, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037240982055664062, "StateBufferConnector_ms": 0.002801179885864258, "ViewRequirementAgentConnector_ms": 0.06935477256774902}}, "episode_reward_max": -393.3801237387281, "episode_reward_min": -1228.638734842368, "episode_reward_mean": -752.292822209921, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-926.1607609593053, -765.0306223697702, -656.701926588058, -825.1623533226306, -1056.6224861659093, -947.4262632439014, -695.5562926958454, -1014.9432852767619, -700.8825639828477, -535.4924764872237, -869.4949961638353, -813.7880785660427, -1063.7998193910535, -627.4015267093903, -487.4881272053504, -777.0204480278159, -570.4658893786288, -1228.638734842368, -849.224770025147, -770.1738519108461, -608.9017541481696, -792.5159874240176, -743.3822906671751, -653.2255588132094, -915.5377922969163, -967.9164083879504, -1224.124753580239, -736.8661339953352, -871.9493199469679, -449.44088607528846, -533.531392144829, -1222.8078149301723, -591.0592238638071, -732.1603902783818, -789.8588830338664, -788.6072712225003, -1072.6202813812297, -393.3801237387281, -765.8249738045077, -831.1886116942605, -762.3454772637814, -486.92455876945724, -448.69671577154355, -940.4412434150737, -727.1847401582801, -806.6944164867027, -901.2084436665884, -987.5989695409434, -671.6777141601648, -888.5446985441893, -721.5441831103919, -696.055020234459, -898.3968632804158, -1027.4011248166166, -403.03280759378634, -622.8093760673837, -812.637503569869, -862.0779852735153, -647.6766655147794, -693.7369514273789, -731.414711060411, -677.8189717782886, -496.3815859129291, -772.9002837693945, -784.9194702372788, -666.9597433282892, -736.7936402637039, -828.7171333864179, -929.0374674872801, -715.6177440587994, -938.376510490651, -809.9584996586964, -639.6658348782015, -625.3896161339452, -704.1842142384083, -939.044875568671, -840.4886444151232, -449.8080675969133, -496.15838555700157, -740.9998144535155, -614.2794320613347, -676.2066202764812, -655.6447688061047, -786.3142129325706, -748.214887257547, -717.5610314603733, -567.3208605917897, -795.1832736859715, -522.5236199172583, -641.873038589753, -772.9943629527012, -587.7437496369887, -654.6097072248673, -660.0811819240284, -840.1582661241384, -771.6521033677748, -770.5913338343424, -560.3132301075361, -664.500084210021, -823.8206583509998], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.30665483802561, "mean_inference_ms": 0.4087922735633095, "mean_action_processing_ms": 0.09614029626931098, "mean_env_wait_ms": 2.927410734815197, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037240982055664062, "StateBufferConnector_ms": 0.002801179885864258, "ViewRequirementAgentConnector_ms": 0.06935477256774902}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 238680, "num_agent_steps_trained": 238680, "num_env_steps_sampled": 238680, "num_env_steps_trained": 238680, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.450661713946836, "num_env_steps_trained_throughput_per_sec": 40.450661713946836, "timesteps_total": 238680, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 238680, "timers": {"training_iteration_time_ms": 2984.011, "sample_time_ms": 2978.393, "load_time_ms": 0.231, "load_throughput": 520331.314, "learn_time_ms": 4.48, "learn_throughput": 26787.257, "synch_weights_time_ms": 0.861}, "counters": {"num_env_steps_sampled": 238680, "num_env_steps_trained": 238680, "num_agent_steps_sampled": 238680, "num_agent_steps_trained": 238680}, "done": false, "episodes_total": 1989, "training_iteration": 498, "trial_id": "53665_00000", "date": "2023-07-26_03-28-48", "timestamp": 1690331328, "time_this_iter_s": 11.86892294883728, "time_total_s": 6070.044362783432, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 448.7188868522644, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 46.09411764705882, "ram_util_percent": 72.92941176470588}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4984436035156, "policy_loss": -88190.8203125, "vf_loss": 3364282.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 155.0, "diff_num_grad_updates_vs_sampler_policy": 154.0}}, "num_env_steps_sampled": 239160, "num_env_steps_trained": 239160, "num_agent_steps_sampled": 239160, "num_agent_steps_trained": 239160}, "sampler_results": {"episode_reward_max": -393.3801237387281, "episode_reward_min": -1228.638734842368, "episode_reward_mean": -745.6456548390495, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1056.6224861659093, -947.4262632439014, -695.5562926958454, -1014.9432852767619, -700.8825639828477, -535.4924764872237, -869.4949961638353, -813.7880785660427, -1063.7998193910535, -627.4015267093903, -487.4881272053504, -777.0204480278159, -570.4658893786288, -1228.638734842368, -849.224770025147, -770.1738519108461, -608.9017541481696, -792.5159874240176, -743.3822906671751, -653.2255588132094, -915.5377922969163, -967.9164083879504, -1224.124753580239, -736.8661339953352, -871.9493199469679, -449.44088607528846, -533.531392144829, -1222.8078149301723, -591.0592238638071, -732.1603902783818, -789.8588830338664, -788.6072712225003, -1072.6202813812297, -393.3801237387281, -765.8249738045077, -831.1886116942605, -762.3454772637814, -486.92455876945724, -448.69671577154355, -940.4412434150737, -727.1847401582801, -806.6944164867027, -901.2084436665884, -987.5989695409434, -671.6777141601648, -888.5446985441893, -721.5441831103919, -696.055020234459, -898.3968632804158, -1027.4011248166166, -403.03280759378634, -622.8093760673837, -812.637503569869, -862.0779852735153, -647.6766655147794, -693.7369514273789, -731.414711060411, -677.8189717782886, -496.3815859129291, -772.9002837693945, -784.9194702372788, -666.9597433282892, -736.7936402637039, -828.7171333864179, -929.0374674872801, -715.6177440587994, -938.376510490651, -809.9584996586964, -639.6658348782015, -625.3896161339452, -704.1842142384083, -939.044875568671, -840.4886444151232, -449.8080675969133, -496.15838555700157, -740.9998144535155, -614.2794320613347, -676.2066202764812, -655.6447688061047, -786.3142129325706, -748.214887257547, -717.5610314603733, -567.3208605917897, -795.1832736859715, -522.5236199172583, -641.873038589753, -772.9943629527012, -587.7437496369887, -654.6097072248673, -660.0811819240284, -840.1582661241384, -771.6521033677748, -770.5913338343424, -560.3132301075361, -664.500084210021, -823.8206583509998, -643.87232033823, -422.4467698617693, -758.3788329586012, -683.6410029940168], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.30733229288503, "mean_inference_ms": 0.4087304362869439, "mean_action_processing_ms": 0.0961601583336093, "mean_env_wait_ms": 2.9159668220235178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037415027618408203, "StateBufferConnector_ms": 0.002801656723022461, "ViewRequirementAgentConnector_ms": 0.06951451301574707}}, "episode_reward_max": -393.3801237387281, "episode_reward_min": -1228.638734842368, "episode_reward_mean": -745.6456548390495, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1056.6224861659093, -947.4262632439014, -695.5562926958454, -1014.9432852767619, -700.8825639828477, -535.4924764872237, -869.4949961638353, -813.7880785660427, -1063.7998193910535, -627.4015267093903, -487.4881272053504, -777.0204480278159, -570.4658893786288, -1228.638734842368, -849.224770025147, -770.1738519108461, -608.9017541481696, -792.5159874240176, -743.3822906671751, -653.2255588132094, -915.5377922969163, -967.9164083879504, -1224.124753580239, -736.8661339953352, -871.9493199469679, -449.44088607528846, -533.531392144829, -1222.8078149301723, -591.0592238638071, -732.1603902783818, -789.8588830338664, -788.6072712225003, -1072.6202813812297, -393.3801237387281, -765.8249738045077, -831.1886116942605, -762.3454772637814, -486.92455876945724, -448.69671577154355, -940.4412434150737, -727.1847401582801, -806.6944164867027, -901.2084436665884, -987.5989695409434, -671.6777141601648, -888.5446985441893, -721.5441831103919, -696.055020234459, -898.3968632804158, -1027.4011248166166, -403.03280759378634, -622.8093760673837, -812.637503569869, -862.0779852735153, -647.6766655147794, -693.7369514273789, -731.414711060411, -677.8189717782886, -496.3815859129291, -772.9002837693945, -784.9194702372788, -666.9597433282892, -736.7936402637039, -828.7171333864179, -929.0374674872801, -715.6177440587994, -938.376510490651, -809.9584996586964, -639.6658348782015, -625.3896161339452, -704.1842142384083, -939.044875568671, -840.4886444151232, -449.8080675969133, -496.15838555700157, -740.9998144535155, -614.2794320613347, -676.2066202764812, -655.6447688061047, -786.3142129325706, -748.214887257547, -717.5610314603733, -567.3208605917897, -795.1832736859715, -522.5236199172583, -641.873038589753, -772.9943629527012, -587.7437496369887, -654.6097072248673, -660.0811819240284, -840.1582661241384, -771.6521033677748, -770.5913338343424, -560.3132301075361, -664.500084210021, -823.8206583509998, -643.87232033823, -422.4467698617693, -758.3788329586012, -683.6410029940168], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.30733229288503, "mean_inference_ms": 0.4087304362869439, "mean_action_processing_ms": 0.0961601583336093, "mean_env_wait_ms": 2.9159668220235178, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037415027618408203, "StateBufferConnector_ms": 0.002801656723022461, "ViewRequirementAgentConnector_ms": 0.06951451301574707}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 239160, "num_agent_steps_trained": 239160, "num_env_steps_sampled": 239160, "num_env_steps_trained": 239160, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.638935225008666, "num_env_steps_trained_throughput_per_sec": 39.638935225008666, "timesteps_total": 239160, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 239160, "timers": {"training_iteration_time_ms": 2971.339, "sample_time_ms": 2967.549, "load_time_ms": 0.225, "load_throughput": 534136.135, "learn_time_ms": 2.796, "learn_throughput": 42913.969, "synch_weights_time_ms": 0.728}, "counters": {"num_env_steps_sampled": 239160, "num_env_steps_trained": 239160, "num_agent_steps_sampled": 239160, "num_agent_steps_trained": 239160}, "done": false, "episodes_total": 1993, "training_iteration": 499, "trial_id": "53665_00000", "date": "2023-07-26_03-29-00", "timestamp": 1690331340, "time_this_iter_s": 12.11209511756897, "time_total_s": 6082.156457901001, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 460.8309819698334, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 44.805882352941175, "ram_util_percent": 78.42352941176469}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.51702880859375, "policy_loss": -94783.234375, "vf_loss": 3897862.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 159.0, "diff_num_grad_updates_vs_sampler_policy": 158.0}}, "num_env_steps_sampled": 239640, "num_env_steps_trained": 239640, "num_agent_steps_sampled": 239640, "num_agent_steps_trained": 239640}, "sampler_results": {"episode_reward_max": -393.3801237387281, "episode_reward_min": -1228.638734842368, "episode_reward_mean": -738.6555313109294, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-700.8825639828477, -535.4924764872237, -869.4949961638353, -813.7880785660427, -1063.7998193910535, -627.4015267093903, -487.4881272053504, -777.0204480278159, -570.4658893786288, -1228.638734842368, -849.224770025147, -770.1738519108461, -608.9017541481696, -792.5159874240176, -743.3822906671751, -653.2255588132094, -915.5377922969163, -967.9164083879504, -1224.124753580239, -736.8661339953352, -871.9493199469679, -449.44088607528846, -533.531392144829, -1222.8078149301723, -591.0592238638071, -732.1603902783818, -789.8588830338664, -788.6072712225003, -1072.6202813812297, -393.3801237387281, -765.8249738045077, -831.1886116942605, -762.3454772637814, -486.92455876945724, -448.69671577154355, -940.4412434150737, -727.1847401582801, -806.6944164867027, -901.2084436665884, -987.5989695409434, -671.6777141601648, -888.5446985441893, -721.5441831103919, -696.055020234459, -898.3968632804158, -1027.4011248166166, -403.03280759378634, -622.8093760673837, -812.637503569869, -862.0779852735153, -647.6766655147794, -693.7369514273789, -731.414711060411, -677.8189717782886, -496.3815859129291, -772.9002837693945, -784.9194702372788, -666.9597433282892, -736.7936402637039, -828.7171333864179, -929.0374674872801, -715.6177440587994, -938.376510490651, -809.9584996586964, -639.6658348782015, -625.3896161339452, -704.1842142384083, -939.044875568671, -840.4886444151232, -449.8080675969133, -496.15838555700157, -740.9998144535155, -614.2794320613347, -676.2066202764812, -655.6447688061047, -786.3142129325706, -748.214887257547, -717.5610314603733, -567.3208605917897, -795.1832736859715, -522.5236199172583, -641.873038589753, -772.9943629527012, -587.7437496369887, -654.6097072248673, -660.0811819240284, -840.1582661241384, -771.6521033677748, -770.5913338343424, -560.3132301075361, -664.500084210021, -823.8206583509998, -643.87232033823, -422.4467698617693, -758.3788329586012, -683.6410029940168, -1050.0830923782478, -714.5323413079711, -542.2370442241776, -708.6834966599782], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.310670546028, "mean_inference_ms": 0.40882329002430345, "mean_action_processing_ms": 0.09620141595483755, "mean_env_wait_ms": 2.905711542254233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037627220153808594, "StateBufferConnector_ms": 0.002815723419189453, "ViewRequirementAgentConnector_ms": 0.06985116004943848}}, "episode_reward_max": -393.3801237387281, "episode_reward_min": -1228.638734842368, "episode_reward_mean": -738.6555313109294, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-700.8825639828477, -535.4924764872237, -869.4949961638353, -813.7880785660427, -1063.7998193910535, -627.4015267093903, -487.4881272053504, -777.0204480278159, -570.4658893786288, -1228.638734842368, -849.224770025147, -770.1738519108461, -608.9017541481696, -792.5159874240176, -743.3822906671751, -653.2255588132094, -915.5377922969163, -967.9164083879504, -1224.124753580239, -736.8661339953352, -871.9493199469679, -449.44088607528846, -533.531392144829, -1222.8078149301723, -591.0592238638071, -732.1603902783818, -789.8588830338664, -788.6072712225003, -1072.6202813812297, -393.3801237387281, -765.8249738045077, -831.1886116942605, -762.3454772637814, -486.92455876945724, -448.69671577154355, -940.4412434150737, -727.1847401582801, -806.6944164867027, -901.2084436665884, -987.5989695409434, -671.6777141601648, -888.5446985441893, -721.5441831103919, -696.055020234459, -898.3968632804158, -1027.4011248166166, -403.03280759378634, -622.8093760673837, -812.637503569869, -862.0779852735153, -647.6766655147794, -693.7369514273789, -731.414711060411, -677.8189717782886, -496.3815859129291, -772.9002837693945, -784.9194702372788, -666.9597433282892, -736.7936402637039, -828.7171333864179, -929.0374674872801, -715.6177440587994, -938.376510490651, -809.9584996586964, -639.6658348782015, -625.3896161339452, -704.1842142384083, -939.044875568671, -840.4886444151232, -449.8080675969133, -496.15838555700157, -740.9998144535155, -614.2794320613347, -676.2066202764812, -655.6447688061047, -786.3142129325706, -748.214887257547, -717.5610314603733, -567.3208605917897, -795.1832736859715, -522.5236199172583, -641.873038589753, -772.9943629527012, -587.7437496369887, -654.6097072248673, -660.0811819240284, -840.1582661241384, -771.6521033677748, -770.5913338343424, -560.3132301075361, -664.500084210021, -823.8206583509998, -643.87232033823, -422.4467698617693, -758.3788329586012, -683.6410029940168, -1050.0830923782478, -714.5323413079711, -542.2370442241776, -708.6834966599782], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.310670546028, "mean_inference_ms": 0.40882329002430345, "mean_action_processing_ms": 0.09620141595483755, "mean_env_wait_ms": 2.905711542254233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037627220153808594, "StateBufferConnector_ms": 0.002815723419189453, "ViewRequirementAgentConnector_ms": 0.06985116004943848}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 239640, "num_agent_steps_trained": 239640, "num_env_steps_sampled": 239640, "num_env_steps_trained": 239640, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 36.61228917116616, "num_env_steps_trained_throughput_per_sec": 36.61228917116616, "timesteps_total": 239640, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 239640, "timers": {"training_iteration_time_ms": 3142.433, "sample_time_ms": 3135.791, "load_time_ms": 0.354, "load_throughput": 339162.049, "learn_time_ms": 5.058, "learn_throughput": 23725.34, "synch_weights_time_ms": 1.135}, "counters": {"num_env_steps_sampled": 239640, "num_env_steps_trained": 239640, "num_agent_steps_sampled": 239640, "num_agent_steps_trained": 239640}, "done": false, "episodes_total": 1997, "training_iteration": 500, "trial_id": "53665_00000", "date": "2023-07-26_03-29-13", "timestamp": 1690331353, "time_this_iter_s": 13.133709907531738, "time_total_s": 6095.290167808533, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 473.9646918773651, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 50.46666666666667, "ram_util_percent": 79.66666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.48968505859375, "policy_loss": -118677.7109375, "vf_loss": 6151288.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 163.0, "diff_num_grad_updates_vs_sampler_policy": 162.0}}, "num_env_steps_sampled": 240120, "num_env_steps_trained": 240120, "num_agent_steps_sampled": 240120, "num_agent_steps_trained": 240120}, "sampler_results": {"episode_reward_max": -393.3801237387281, "episode_reward_min": -1228.638734842368, "episode_reward_mean": -737.4554276522861, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1063.7998193910535, -627.4015267093903, -487.4881272053504, -777.0204480278159, -570.4658893786288, -1228.638734842368, -849.224770025147, -770.1738519108461, -608.9017541481696, -792.5159874240176, -743.3822906671751, -653.2255588132094, -915.5377922969163, -967.9164083879504, -1224.124753580239, -736.8661339953352, -871.9493199469679, -449.44088607528846, -533.531392144829, -1222.8078149301723, -591.0592238638071, -732.1603902783818, -789.8588830338664, -788.6072712225003, -1072.6202813812297, -393.3801237387281, -765.8249738045077, -831.1886116942605, -762.3454772637814, -486.92455876945724, -448.69671577154355, -940.4412434150737, -727.1847401582801, -806.6944164867027, -901.2084436665884, -987.5989695409434, -671.6777141601648, -888.5446985441893, -721.5441831103919, -696.055020234459, -898.3968632804158, -1027.4011248166166, -403.03280759378634, -622.8093760673837, -812.637503569869, -862.0779852735153, -647.6766655147794, -693.7369514273789, -731.414711060411, -677.8189717782886, -496.3815859129291, -772.9002837693945, -784.9194702372788, -666.9597433282892, -736.7936402637039, -828.7171333864179, -929.0374674872801, -715.6177440587994, -938.376510490651, -809.9584996586964, -639.6658348782015, -625.3896161339452, -704.1842142384083, -939.044875568671, -840.4886444151232, -449.8080675969133, -496.15838555700157, -740.9998144535155, -614.2794320613347, -676.2066202764812, -655.6447688061047, -786.3142129325706, -748.214887257547, -717.5610314603733, -567.3208605917897, -795.1832736859715, -522.5236199172583, -641.873038589753, -772.9943629527012, -587.7437496369887, -654.6097072248673, -660.0811819240284, -840.1582661241384, -771.6521033677748, -770.5913338343424, -560.3132301075361, -664.500084210021, -823.8206583509998, -643.87232033823, -422.4467698617693, -758.3788329586012, -683.6410029940168, -1050.0830923782478, -714.5323413079711, -542.2370442241776, -708.6834966599782, -526.3516866049765, -519.6725368770785, -959.0094157729756, -794.6141100806169], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.313539671964506, "mean_inference_ms": 0.409148899549681, "mean_action_processing_ms": 0.09628657428633854, "mean_env_wait_ms": 2.8969452924790975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003805398941040039, "StateBufferConnector_ms": 0.0028443336486816406, "ViewRequirementAgentConnector_ms": 0.07072734832763672}}, "episode_reward_max": -393.3801237387281, "episode_reward_min": -1228.638734842368, "episode_reward_mean": -737.4554276522861, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1063.7998193910535, -627.4015267093903, -487.4881272053504, -777.0204480278159, -570.4658893786288, -1228.638734842368, -849.224770025147, -770.1738519108461, -608.9017541481696, -792.5159874240176, -743.3822906671751, -653.2255588132094, -915.5377922969163, -967.9164083879504, -1224.124753580239, -736.8661339953352, -871.9493199469679, -449.44088607528846, -533.531392144829, -1222.8078149301723, -591.0592238638071, -732.1603902783818, -789.8588830338664, -788.6072712225003, -1072.6202813812297, -393.3801237387281, -765.8249738045077, -831.1886116942605, -762.3454772637814, -486.92455876945724, -448.69671577154355, -940.4412434150737, -727.1847401582801, -806.6944164867027, -901.2084436665884, -987.5989695409434, -671.6777141601648, -888.5446985441893, -721.5441831103919, -696.055020234459, -898.3968632804158, -1027.4011248166166, -403.03280759378634, -622.8093760673837, -812.637503569869, -862.0779852735153, -647.6766655147794, -693.7369514273789, -731.414711060411, -677.8189717782886, -496.3815859129291, -772.9002837693945, -784.9194702372788, -666.9597433282892, -736.7936402637039, -828.7171333864179, -929.0374674872801, -715.6177440587994, -938.376510490651, -809.9584996586964, -639.6658348782015, -625.3896161339452, -704.1842142384083, -939.044875568671, -840.4886444151232, -449.8080675969133, -496.15838555700157, -740.9998144535155, -614.2794320613347, -676.2066202764812, -655.6447688061047, -786.3142129325706, -748.214887257547, -717.5610314603733, -567.3208605917897, -795.1832736859715, -522.5236199172583, -641.873038589753, -772.9943629527012, -587.7437496369887, -654.6097072248673, -660.0811819240284, -840.1582661241384, -771.6521033677748, -770.5913338343424, -560.3132301075361, -664.500084210021, -823.8206583509998, -643.87232033823, -422.4467698617693, -758.3788329586012, -683.6410029940168, -1050.0830923782478, -714.5323413079711, -542.2370442241776, -708.6834966599782, -526.3516866049765, -519.6725368770785, -959.0094157729756, -794.6141100806169], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.313539671964506, "mean_inference_ms": 0.409148899549681, "mean_action_processing_ms": 0.09628657428633854, "mean_env_wait_ms": 2.8969452924790975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003805398941040039, "StateBufferConnector_ms": 0.0028443336486816406, "ViewRequirementAgentConnector_ms": 0.07072734832763672}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240120, "num_agent_steps_trained": 240120, "num_env_steps_sampled": 240120, "num_env_steps_trained": 240120, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.652325917597906, "num_env_steps_trained_throughput_per_sec": 38.652325917597906, "timesteps_total": 240120, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 240120, "timers": {"training_iteration_time_ms": 3129.878, "sample_time_ms": 3123.137, "load_time_ms": 0.365, "load_throughput": 328449.804, "learn_time_ms": 5.143, "learn_throughput": 23334.53, "synch_weights_time_ms": 1.136}, "counters": {"num_env_steps_sampled": 240120, "num_env_steps_trained": 240120, "num_agent_steps_sampled": 240120, "num_agent_steps_trained": 240120}, "done": false, "episodes_total": 2001, "training_iteration": 501, "trial_id": "53665_00000", "date": "2023-07-26_03-29-26", "timestamp": 1690331366, "time_this_iter_s": 12.421127796173096, "time_total_s": 6107.711295604706, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 486.3858196735382, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 52.43888888888889, "ram_util_percent": 80.94444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4989929199219, "policy_loss": -98619.7109375, "vf_loss": 4820201.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 167.0, "diff_num_grad_updates_vs_sampler_policy": 166.0}}, "num_env_steps_sampled": 240600, "num_env_steps_trained": 240600, "num_agent_steps_sampled": 240600, "num_agent_steps_trained": 240600}, "sampler_results": {"episode_reward_max": -393.3801237387281, "episode_reward_min": -1228.638734842368, "episode_reward_mean": -734.2852578929654, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-570.4658893786288, -1228.638734842368, -849.224770025147, -770.1738519108461, -608.9017541481696, -792.5159874240176, -743.3822906671751, -653.2255588132094, -915.5377922969163, -967.9164083879504, -1224.124753580239, -736.8661339953352, -871.9493199469679, -449.44088607528846, -533.531392144829, -1222.8078149301723, -591.0592238638071, -732.1603902783818, -789.8588830338664, -788.6072712225003, -1072.6202813812297, -393.3801237387281, -765.8249738045077, -831.1886116942605, -762.3454772637814, -486.92455876945724, -448.69671577154355, -940.4412434150737, -727.1847401582801, -806.6944164867027, -901.2084436665884, -987.5989695409434, -671.6777141601648, -888.5446985441893, -721.5441831103919, -696.055020234459, -898.3968632804158, -1027.4011248166166, -403.03280759378634, -622.8093760673837, -812.637503569869, -862.0779852735153, -647.6766655147794, -693.7369514273789, -731.414711060411, -677.8189717782886, -496.3815859129291, -772.9002837693945, -784.9194702372788, -666.9597433282892, -736.7936402637039, -828.7171333864179, -929.0374674872801, -715.6177440587994, -938.376510490651, -809.9584996586964, -639.6658348782015, -625.3896161339452, -704.1842142384083, -939.044875568671, -840.4886444151232, -449.8080675969133, -496.15838555700157, -740.9998144535155, -614.2794320613347, -676.2066202764812, -655.6447688061047, -786.3142129325706, -748.214887257547, -717.5610314603733, -567.3208605917897, -795.1832736859715, -522.5236199172583, -641.873038589753, -772.9943629527012, -587.7437496369887, -654.6097072248673, -660.0811819240284, -840.1582661241384, -771.6521033677748, -770.5913338343424, -560.3132301075361, -664.500084210021, -823.8206583509998, -643.87232033823, -422.4467698617693, -758.3788329586012, -683.6410029940168, -1050.0830923782478, -714.5323413079711, -542.2370442241776, -708.6834966599782, -526.3516866049765, -519.6725368770785, -959.0094157729756, -794.6141100806169, -717.9127731029838, -546.5730213098454, -689.3024314572707, -684.9047195314457], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.317923429083656, "mean_inference_ms": 0.4095609321694516, "mean_action_processing_ms": 0.09638479117109913, "mean_env_wait_ms": 2.889022034943827, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003852367401123047, "StateBufferConnector_ms": 0.002875804901123047, "ViewRequirementAgentConnector_ms": 0.07174897193908691}}, "episode_reward_max": -393.3801237387281, "episode_reward_min": -1228.638734842368, "episode_reward_mean": -734.2852578929654, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-570.4658893786288, -1228.638734842368, -849.224770025147, -770.1738519108461, -608.9017541481696, -792.5159874240176, -743.3822906671751, -653.2255588132094, -915.5377922969163, -967.9164083879504, -1224.124753580239, -736.8661339953352, -871.9493199469679, -449.44088607528846, -533.531392144829, -1222.8078149301723, -591.0592238638071, -732.1603902783818, -789.8588830338664, -788.6072712225003, -1072.6202813812297, -393.3801237387281, -765.8249738045077, -831.1886116942605, -762.3454772637814, -486.92455876945724, -448.69671577154355, -940.4412434150737, -727.1847401582801, -806.6944164867027, -901.2084436665884, -987.5989695409434, -671.6777141601648, -888.5446985441893, -721.5441831103919, -696.055020234459, -898.3968632804158, -1027.4011248166166, -403.03280759378634, -622.8093760673837, -812.637503569869, -862.0779852735153, -647.6766655147794, -693.7369514273789, -731.414711060411, -677.8189717782886, -496.3815859129291, -772.9002837693945, -784.9194702372788, -666.9597433282892, -736.7936402637039, -828.7171333864179, -929.0374674872801, -715.6177440587994, -938.376510490651, -809.9584996586964, -639.6658348782015, -625.3896161339452, -704.1842142384083, -939.044875568671, -840.4886444151232, -449.8080675969133, -496.15838555700157, -740.9998144535155, -614.2794320613347, -676.2066202764812, -655.6447688061047, -786.3142129325706, -748.214887257547, -717.5610314603733, -567.3208605917897, -795.1832736859715, -522.5236199172583, -641.873038589753, -772.9943629527012, -587.7437496369887, -654.6097072248673, -660.0811819240284, -840.1582661241384, -771.6521033677748, -770.5913338343424, -560.3132301075361, -664.500084210021, -823.8206583509998, -643.87232033823, -422.4467698617693, -758.3788329586012, -683.6410029940168, -1050.0830923782478, -714.5323413079711, -542.2370442241776, -708.6834966599782, -526.3516866049765, -519.6725368770785, -959.0094157729756, -794.6141100806169, -717.9127731029838, -546.5730213098454, -689.3024314572707, -684.9047195314457], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.317923429083656, "mean_inference_ms": 0.4095609321694516, "mean_action_processing_ms": 0.09638479117109913, "mean_env_wait_ms": 2.889022034943827, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003852367401123047, "StateBufferConnector_ms": 0.002875804901123047, "ViewRequirementAgentConnector_ms": 0.07174897193908691}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240600, "num_agent_steps_trained": 240600, "num_env_steps_sampled": 240600, "num_env_steps_trained": 240600, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.02264668499606, "num_env_steps_trained_throughput_per_sec": 40.02264668499606, "timesteps_total": 240600, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 240600, "timers": {"training_iteration_time_ms": 3136.863, "sample_time_ms": 3129.819, "load_time_ms": 0.375, "load_throughput": 319687.805, "learn_time_ms": 5.37, "learn_throughput": 22347.572, "synch_weights_time_ms": 1.194}, "counters": {"num_env_steps_sampled": 240600, "num_env_steps_trained": 240600, "num_agent_steps_sampled": 240600, "num_agent_steps_trained": 240600}, "done": false, "episodes_total": 2005, "training_iteration": 502, "trial_id": "53665_00000", "date": "2023-07-26_03-29-38", "timestamp": 1690331378, "time_this_iter_s": 11.99623703956604, "time_total_s": 6119.707532644272, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 498.38205671310425, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 46.58823529411764, "ram_util_percent": 79.45294117647057}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4977111816406, "policy_loss": -113122.9921875, "vf_loss": 6249331.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 171.0, "diff_num_grad_updates_vs_sampler_policy": 170.0}}, "num_env_steps_sampled": 241080, "num_env_steps_trained": 241080, "num_agent_steps_sampled": 241080, "num_agent_steps_trained": 241080}, "sampler_results": {"episode_reward_max": -393.3801237387281, "episode_reward_min": -1224.124753580239, "episode_reward_mean": -736.1426580580928, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-608.9017541481696, -792.5159874240176, -743.3822906671751, -653.2255588132094, -915.5377922969163, -967.9164083879504, -1224.124753580239, -736.8661339953352, -871.9493199469679, -449.44088607528846, -533.531392144829, -1222.8078149301723, -591.0592238638071, -732.1603902783818, -789.8588830338664, -788.6072712225003, -1072.6202813812297, -393.3801237387281, -765.8249738045077, -831.1886116942605, -762.3454772637814, -486.92455876945724, -448.69671577154355, -940.4412434150737, -727.1847401582801, -806.6944164867027, -901.2084436665884, -987.5989695409434, -671.6777141601648, -888.5446985441893, -721.5441831103919, -696.055020234459, -898.3968632804158, -1027.4011248166166, -403.03280759378634, -622.8093760673837, -812.637503569869, -862.0779852735153, -647.6766655147794, -693.7369514273789, -731.414711060411, -677.8189717782886, -496.3815859129291, -772.9002837693945, -784.9194702372788, -666.9597433282892, -736.7936402637039, -828.7171333864179, -929.0374674872801, -715.6177440587994, -938.376510490651, -809.9584996586964, -639.6658348782015, -625.3896161339452, -704.1842142384083, -939.044875568671, -840.4886444151232, -449.8080675969133, -496.15838555700157, -740.9998144535155, -614.2794320613347, -676.2066202764812, -655.6447688061047, -786.3142129325706, -748.214887257547, -717.5610314603733, -567.3208605917897, -795.1832736859715, -522.5236199172583, -641.873038589753, -772.9943629527012, -587.7437496369887, -654.6097072248673, -660.0811819240284, -840.1582661241384, -771.6521033677748, -770.5913338343424, -560.3132301075361, -664.500084210021, -823.8206583509998, -643.87232033823, -422.4467698617693, -758.3788329586012, -683.6410029940168, -1050.0830923782478, -714.5323413079711, -542.2370442241776, -708.6834966599782, -526.3516866049765, -519.6725368770785, -959.0094157729756, -794.6141100806169, -717.9127731029838, -546.5730213098454, -689.3024314572707, -684.9047195314457, -965.4251485365626, -860.6902099893744, -849.249808045342, -928.8780960984502], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.327920404051135, "mean_inference_ms": 0.4100516433408816, "mean_action_processing_ms": 0.09649378053890295, "mean_env_wait_ms": 2.8819608466175146, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003902435302734375, "StateBufferConnector_ms": 0.002903461456298828, "ViewRequirementAgentConnector_ms": 0.07273387908935547}}, "episode_reward_max": -393.3801237387281, "episode_reward_min": -1224.124753580239, "episode_reward_mean": -736.1426580580928, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-608.9017541481696, -792.5159874240176, -743.3822906671751, -653.2255588132094, -915.5377922969163, -967.9164083879504, -1224.124753580239, -736.8661339953352, -871.9493199469679, -449.44088607528846, -533.531392144829, -1222.8078149301723, -591.0592238638071, -732.1603902783818, -789.8588830338664, -788.6072712225003, -1072.6202813812297, -393.3801237387281, -765.8249738045077, -831.1886116942605, -762.3454772637814, -486.92455876945724, -448.69671577154355, -940.4412434150737, -727.1847401582801, -806.6944164867027, -901.2084436665884, -987.5989695409434, -671.6777141601648, -888.5446985441893, -721.5441831103919, -696.055020234459, -898.3968632804158, -1027.4011248166166, -403.03280759378634, -622.8093760673837, -812.637503569869, -862.0779852735153, -647.6766655147794, -693.7369514273789, -731.414711060411, -677.8189717782886, -496.3815859129291, -772.9002837693945, -784.9194702372788, -666.9597433282892, -736.7936402637039, -828.7171333864179, -929.0374674872801, -715.6177440587994, -938.376510490651, -809.9584996586964, -639.6658348782015, -625.3896161339452, -704.1842142384083, -939.044875568671, -840.4886444151232, -449.8080675969133, -496.15838555700157, -740.9998144535155, -614.2794320613347, -676.2066202764812, -655.6447688061047, -786.3142129325706, -748.214887257547, -717.5610314603733, -567.3208605917897, -795.1832736859715, -522.5236199172583, -641.873038589753, -772.9943629527012, -587.7437496369887, -654.6097072248673, -660.0811819240284, -840.1582661241384, -771.6521033677748, -770.5913338343424, -560.3132301075361, -664.500084210021, -823.8206583509998, -643.87232033823, -422.4467698617693, -758.3788329586012, -683.6410029940168, -1050.0830923782478, -714.5323413079711, -542.2370442241776, -708.6834966599782, -526.3516866049765, -519.6725368770785, -959.0094157729756, -794.6141100806169, -717.9127731029838, -546.5730213098454, -689.3024314572707, -684.9047195314457, -965.4251485365626, -860.6902099893744, -849.249808045342, -928.8780960984502], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.327920404051135, "mean_inference_ms": 0.4100516433408816, "mean_action_processing_ms": 0.09649378053890295, "mean_env_wait_ms": 2.8819608466175146, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003902435302734375, "StateBufferConnector_ms": 0.002903461456298828, "ViewRequirementAgentConnector_ms": 0.07273387908935547}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 241080, "num_agent_steps_trained": 241080, "num_env_steps_sampled": 241080, "num_env_steps_trained": 241080, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 34.10708790421027, "num_env_steps_trained_throughput_per_sec": 34.10708790421027, "timesteps_total": 241080, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 241080, "timers": {"training_iteration_time_ms": 3211.723, "sample_time_ms": 3207.387, "load_time_ms": 0.238, "load_throughput": 503870.738, "learn_time_ms": 3.243, "learn_throughput": 37008.02, "synch_weights_time_ms": 0.805}, "counters": {"num_env_steps_sampled": 241080, "num_env_steps_trained": 241080, "num_agent_steps_sampled": 241080, "num_agent_steps_trained": 241080}, "done": false, "episodes_total": 2009, "training_iteration": 503, "trial_id": "53665_00000", "date": "2023-07-26_03-29-52", "timestamp": 1690331392, "time_this_iter_s": 14.076434135437012, "time_total_s": 6133.783966779709, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 512.4584908485413, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 51.62857142857143, "ram_util_percent": 78.67142857142858}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.494873046875, "policy_loss": -129661.3515625, "vf_loss": 7027455.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 175.0, "diff_num_grad_updates_vs_sampler_policy": 174.0}}, "num_env_steps_sampled": 241560, "num_env_steps_trained": 241560, "num_agent_steps_sampled": 241560, "num_agent_steps_trained": 241560}, "sampler_results": {"episode_reward_max": -393.3801237387281, "episode_reward_min": -1224.124753580239, "episode_reward_mean": -739.6252523729614, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-915.5377922969163, -967.9164083879504, -1224.124753580239, -736.8661339953352, -871.9493199469679, -449.44088607528846, -533.531392144829, -1222.8078149301723, -591.0592238638071, -732.1603902783818, -789.8588830338664, -788.6072712225003, -1072.6202813812297, -393.3801237387281, -765.8249738045077, -831.1886116942605, -762.3454772637814, -486.92455876945724, -448.69671577154355, -940.4412434150737, -727.1847401582801, -806.6944164867027, -901.2084436665884, -987.5989695409434, -671.6777141601648, -888.5446985441893, -721.5441831103919, -696.055020234459, -898.3968632804158, -1027.4011248166166, -403.03280759378634, -622.8093760673837, -812.637503569869, -862.0779852735153, -647.6766655147794, -693.7369514273789, -731.414711060411, -677.8189717782886, -496.3815859129291, -772.9002837693945, -784.9194702372788, -666.9597433282892, -736.7936402637039, -828.7171333864179, -929.0374674872801, -715.6177440587994, -938.376510490651, -809.9584996586964, -639.6658348782015, -625.3896161339452, -704.1842142384083, -939.044875568671, -840.4886444151232, -449.8080675969133, -496.15838555700157, -740.9998144535155, -614.2794320613347, -676.2066202764812, -655.6447688061047, -786.3142129325706, -748.214887257547, -717.5610314603733, -567.3208605917897, -795.1832736859715, -522.5236199172583, -641.873038589753, -772.9943629527012, -587.7437496369887, -654.6097072248673, -660.0811819240284, -840.1582661241384, -771.6521033677748, -770.5913338343424, -560.3132301075361, -664.500084210021, -823.8206583509998, -643.87232033823, -422.4467698617693, -758.3788329586012, -683.6410029940168, -1050.0830923782478, -714.5323413079711, -542.2370442241776, -708.6834966599782, -526.3516866049765, -519.6725368770785, -959.0094157729756, -794.6141100806169, -717.9127731029838, -546.5730213098454, -689.3024314572707, -684.9047195314457, -965.4251485365626, -860.6902099893744, -849.249808045342, -928.8780960984502, -533.9385147135721, -711.0544088742677, -889.7095797327539, -1011.5825192188363], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.3359431627515, "mean_inference_ms": 0.41055673000004517, "mean_action_processing_ms": 0.09660385279714445, "mean_env_wait_ms": 2.875606438096121, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003916501998901367, "StateBufferConnector_ms": 0.0028989315032958984, "ViewRequirementAgentConnector_ms": 0.07277703285217285}}, "episode_reward_max": -393.3801237387281, "episode_reward_min": -1224.124753580239, "episode_reward_mean": -739.6252523729614, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-915.5377922969163, -967.9164083879504, -1224.124753580239, -736.8661339953352, -871.9493199469679, -449.44088607528846, -533.531392144829, -1222.8078149301723, -591.0592238638071, -732.1603902783818, -789.8588830338664, -788.6072712225003, -1072.6202813812297, -393.3801237387281, -765.8249738045077, -831.1886116942605, -762.3454772637814, -486.92455876945724, -448.69671577154355, -940.4412434150737, -727.1847401582801, -806.6944164867027, -901.2084436665884, -987.5989695409434, -671.6777141601648, -888.5446985441893, -721.5441831103919, -696.055020234459, -898.3968632804158, -1027.4011248166166, -403.03280759378634, -622.8093760673837, -812.637503569869, -862.0779852735153, -647.6766655147794, -693.7369514273789, -731.414711060411, -677.8189717782886, -496.3815859129291, -772.9002837693945, -784.9194702372788, -666.9597433282892, -736.7936402637039, -828.7171333864179, -929.0374674872801, -715.6177440587994, -938.376510490651, -809.9584996586964, -639.6658348782015, -625.3896161339452, -704.1842142384083, -939.044875568671, -840.4886444151232, -449.8080675969133, -496.15838555700157, -740.9998144535155, -614.2794320613347, -676.2066202764812, -655.6447688061047, -786.3142129325706, -748.214887257547, -717.5610314603733, -567.3208605917897, -795.1832736859715, -522.5236199172583, -641.873038589753, -772.9943629527012, -587.7437496369887, -654.6097072248673, -660.0811819240284, -840.1582661241384, -771.6521033677748, -770.5913338343424, -560.3132301075361, -664.500084210021, -823.8206583509998, -643.87232033823, -422.4467698617693, -758.3788329586012, -683.6410029940168, -1050.0830923782478, -714.5323413079711, -542.2370442241776, -708.6834966599782, -526.3516866049765, -519.6725368770785, -959.0094157729756, -794.6141100806169, -717.9127731029838, -546.5730213098454, -689.3024314572707, -684.9047195314457, -965.4251485365626, -860.6902099893744, -849.249808045342, -928.8780960984502, -533.9385147135721, -711.0544088742677, -889.7095797327539, -1011.5825192188363], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.3359431627515, "mean_inference_ms": 0.41055673000004517, "mean_action_processing_ms": 0.09660385279714445, "mean_env_wait_ms": 2.875606438096121, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003916501998901367, "StateBufferConnector_ms": 0.0028989315032958984, "ViewRequirementAgentConnector_ms": 0.07277703285217285}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 241560, "num_agent_steps_trained": 241560, "num_env_steps_sampled": 241560, "num_env_steps_trained": 241560, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.33074535495954, "num_env_steps_trained_throughput_per_sec": 40.33074535495954, "timesteps_total": 241560, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 241560, "timers": {"training_iteration_time_ms": 3213.219, "sample_time_ms": 3209.201, "load_time_ms": 0.227, "load_throughput": 527917.432, "learn_time_ms": 2.994, "learn_throughput": 40082.861, "synch_weights_time_ms": 0.754}, "counters": {"num_env_steps_sampled": 241560, "num_env_steps_trained": 241560, "num_agent_steps_sampled": 241560, "num_agent_steps_trained": 241560}, "done": false, "episodes_total": 2013, "training_iteration": 504, "trial_id": "53665_00000", "date": "2023-07-26_03-30-04", "timestamp": 1690331404, "time_this_iter_s": 11.904399871826172, "time_total_s": 6145.688366651535, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 524.3628907203674, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 42.41875, "ram_util_percent": 78.30000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.497802734375, "policy_loss": -121826.7578125, "vf_loss": 7250711.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 179.0, "diff_num_grad_updates_vs_sampler_policy": 178.0}}, "num_env_steps_sampled": 242040, "num_env_steps_trained": 242040, "num_agent_steps_sampled": 242040, "num_agent_steps_trained": 242040}, "sampler_results": {"episode_reward_max": -393.3801237387281, "episode_reward_min": -1222.8078149301723, "episode_reward_mean": -731.2488880094808, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-871.9493199469679, -449.44088607528846, -533.531392144829, -1222.8078149301723, -591.0592238638071, -732.1603902783818, -789.8588830338664, -788.6072712225003, -1072.6202813812297, -393.3801237387281, -765.8249738045077, -831.1886116942605, -762.3454772637814, -486.92455876945724, -448.69671577154355, -940.4412434150737, -727.1847401582801, -806.6944164867027, -901.2084436665884, -987.5989695409434, -671.6777141601648, -888.5446985441893, -721.5441831103919, -696.055020234459, -898.3968632804158, -1027.4011248166166, -403.03280759378634, -622.8093760673837, -812.637503569869, -862.0779852735153, -647.6766655147794, -693.7369514273789, -731.414711060411, -677.8189717782886, -496.3815859129291, -772.9002837693945, -784.9194702372788, -666.9597433282892, -736.7936402637039, -828.7171333864179, -929.0374674872801, -715.6177440587994, -938.376510490651, -809.9584996586964, -639.6658348782015, -625.3896161339452, -704.1842142384083, -939.044875568671, -840.4886444151232, -449.8080675969133, -496.15838555700157, -740.9998144535155, -614.2794320613347, -676.2066202764812, -655.6447688061047, -786.3142129325706, -748.214887257547, -717.5610314603733, -567.3208605917897, -795.1832736859715, -522.5236199172583, -641.873038589753, -772.9943629527012, -587.7437496369887, -654.6097072248673, -660.0811819240284, -840.1582661241384, -771.6521033677748, -770.5913338343424, -560.3132301075361, -664.500084210021, -823.8206583509998, -643.87232033823, -422.4467698617693, -758.3788329586012, -683.6410029940168, -1050.0830923782478, -714.5323413079711, -542.2370442241776, -708.6834966599782, -526.3516866049765, -519.6725368770785, -959.0094157729756, -794.6141100806169, -717.9127731029838, -546.5730213098454, -689.3024314572707, -684.9047195314457, -965.4251485365626, -860.6902099893744, -849.249808045342, -928.8780960984502, -533.9385147135721, -711.0544088742677, -889.7095797327539, -1011.5825192188363, -848.6993117931511, -533.1778889575806, -654.8578261426946, -970.0736250189459], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.34560647466843, "mean_inference_ms": 0.4111389495446596, "mean_action_processing_ms": 0.09672477956813681, "mean_env_wait_ms": 2.8700667853416064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004006385803222656, "StateBufferConnector_ms": 0.002948760986328125, "ViewRequirementAgentConnector_ms": 0.07418942451477051}}, "episode_reward_max": -393.3801237387281, "episode_reward_min": -1222.8078149301723, "episode_reward_mean": -731.2488880094808, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-871.9493199469679, -449.44088607528846, -533.531392144829, -1222.8078149301723, -591.0592238638071, -732.1603902783818, -789.8588830338664, -788.6072712225003, -1072.6202813812297, -393.3801237387281, -765.8249738045077, -831.1886116942605, -762.3454772637814, -486.92455876945724, -448.69671577154355, -940.4412434150737, -727.1847401582801, -806.6944164867027, -901.2084436665884, -987.5989695409434, -671.6777141601648, -888.5446985441893, -721.5441831103919, -696.055020234459, -898.3968632804158, -1027.4011248166166, -403.03280759378634, -622.8093760673837, -812.637503569869, -862.0779852735153, -647.6766655147794, -693.7369514273789, -731.414711060411, -677.8189717782886, -496.3815859129291, -772.9002837693945, -784.9194702372788, -666.9597433282892, -736.7936402637039, -828.7171333864179, -929.0374674872801, -715.6177440587994, -938.376510490651, -809.9584996586964, -639.6658348782015, -625.3896161339452, -704.1842142384083, -939.044875568671, -840.4886444151232, -449.8080675969133, -496.15838555700157, -740.9998144535155, -614.2794320613347, -676.2066202764812, -655.6447688061047, -786.3142129325706, -748.214887257547, -717.5610314603733, -567.3208605917897, -795.1832736859715, -522.5236199172583, -641.873038589753, -772.9943629527012, -587.7437496369887, -654.6097072248673, -660.0811819240284, -840.1582661241384, -771.6521033677748, -770.5913338343424, -560.3132301075361, -664.500084210021, -823.8206583509998, -643.87232033823, -422.4467698617693, -758.3788329586012, -683.6410029940168, -1050.0830923782478, -714.5323413079711, -542.2370442241776, -708.6834966599782, -526.3516866049765, -519.6725368770785, -959.0094157729756, -794.6141100806169, -717.9127731029838, -546.5730213098454, -689.3024314572707, -684.9047195314457, -965.4251485365626, -860.6902099893744, -849.249808045342, -928.8780960984502, -533.9385147135721, -711.0544088742677, -889.7095797327539, -1011.5825192188363, -848.6993117931511, -533.1778889575806, -654.8578261426946, -970.0736250189459], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.34560647466843, "mean_inference_ms": 0.4111389495446596, "mean_action_processing_ms": 0.09672477956813681, "mean_env_wait_ms": 2.8700667853416064, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004006385803222656, "StateBufferConnector_ms": 0.002948760986328125, "ViewRequirementAgentConnector_ms": 0.07418942451477051}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 242040, "num_agent_steps_trained": 242040, "num_env_steps_sampled": 242040, "num_env_steps_trained": 242040, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 37.46497348098203, "num_env_steps_trained_throughput_per_sec": 37.46497348098203, "timesteps_total": 242040, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 242040, "timers": {"training_iteration_time_ms": 3285.358, "sample_time_ms": 3281.105, "load_time_ms": 0.264, "load_throughput": 454297.753, "learn_time_ms": 3.136, "learn_throughput": 38260.761, "synch_weights_time_ms": 0.803}, "counters": {"num_env_steps_sampled": 242040, "num_env_steps_trained": 242040, "num_agent_steps_sampled": 242040, "num_agent_steps_trained": 242040}, "done": false, "episodes_total": 2017, "training_iteration": 505, "trial_id": "53665_00000", "date": "2023-07-26_03-30-17", "timestamp": 1690331417, "time_this_iter_s": 12.815812110900879, "time_total_s": 6158.504178762436, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 537.1787028312683, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 49.28421052631578, "ram_util_percent": 78.5315789473684}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.48004150390625, "policy_loss": -129872.140625, "vf_loss": 8157393.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 183.0, "diff_num_grad_updates_vs_sampler_policy": 182.0}}, "num_env_steps_sampled": 242520, "num_env_steps_trained": 242520, "num_agent_steps_sampled": 242520, "num_agent_steps_trained": 242520}, "sampler_results": {"episode_reward_max": -393.3801237387281, "episode_reward_min": -1072.6202813812297, "episode_reward_mean": -733.5284254873249, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-591.0592238638071, -732.1603902783818, -789.8588830338664, -788.6072712225003, -1072.6202813812297, -393.3801237387281, -765.8249738045077, -831.1886116942605, -762.3454772637814, -486.92455876945724, -448.69671577154355, -940.4412434150737, -727.1847401582801, -806.6944164867027, -901.2084436665884, -987.5989695409434, -671.6777141601648, -888.5446985441893, -721.5441831103919, -696.055020234459, -898.3968632804158, -1027.4011248166166, -403.03280759378634, -622.8093760673837, -812.637503569869, -862.0779852735153, -647.6766655147794, -693.7369514273789, -731.414711060411, -677.8189717782886, -496.3815859129291, -772.9002837693945, -784.9194702372788, -666.9597433282892, -736.7936402637039, -828.7171333864179, -929.0374674872801, -715.6177440587994, -938.376510490651, -809.9584996586964, -639.6658348782015, -625.3896161339452, -704.1842142384083, -939.044875568671, -840.4886444151232, -449.8080675969133, -496.15838555700157, -740.9998144535155, -614.2794320613347, -676.2066202764812, -655.6447688061047, -786.3142129325706, -748.214887257547, -717.5610314603733, -567.3208605917897, -795.1832736859715, -522.5236199172583, -641.873038589753, -772.9943629527012, -587.7437496369887, -654.6097072248673, -660.0811819240284, -840.1582661241384, -771.6521033677748, -770.5913338343424, -560.3132301075361, -664.500084210021, -823.8206583509998, -643.87232033823, -422.4467698617693, -758.3788329586012, -683.6410029940168, -1050.0830923782478, -714.5323413079711, -542.2370442241776, -708.6834966599782, -526.3516866049765, -519.6725368770785, -959.0094157729756, -794.6141100806169, -717.9127731029838, -546.5730213098454, -689.3024314572707, -684.9047195314457, -965.4251485365626, -860.6902099893744, -849.249808045342, -928.8780960984502, -533.9385147135721, -711.0544088742677, -889.7095797327539, -1011.5825192188363, -848.6993117931511, -533.1778889575806, -654.8578261426946, -970.0736250189459, -708.9593166589218, -801.3102885118361, -905.3342330150098, -890.079322695907], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.355827905906644, "mean_inference_ms": 0.41178108868972757, "mean_action_processing_ms": 0.09685404698124912, "mean_env_wait_ms": 2.865082451634853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004037380218505859, "StateBufferConnector_ms": 0.0029659271240234375, "ViewRequirementAgentConnector_ms": 0.07472920417785645}}, "episode_reward_max": -393.3801237387281, "episode_reward_min": -1072.6202813812297, "episode_reward_mean": -733.5284254873249, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-591.0592238638071, -732.1603902783818, -789.8588830338664, -788.6072712225003, -1072.6202813812297, -393.3801237387281, -765.8249738045077, -831.1886116942605, -762.3454772637814, -486.92455876945724, -448.69671577154355, -940.4412434150737, -727.1847401582801, -806.6944164867027, -901.2084436665884, -987.5989695409434, -671.6777141601648, -888.5446985441893, -721.5441831103919, -696.055020234459, -898.3968632804158, -1027.4011248166166, -403.03280759378634, -622.8093760673837, -812.637503569869, -862.0779852735153, -647.6766655147794, -693.7369514273789, -731.414711060411, -677.8189717782886, -496.3815859129291, -772.9002837693945, -784.9194702372788, -666.9597433282892, -736.7936402637039, -828.7171333864179, -929.0374674872801, -715.6177440587994, -938.376510490651, -809.9584996586964, -639.6658348782015, -625.3896161339452, -704.1842142384083, -939.044875568671, -840.4886444151232, -449.8080675969133, -496.15838555700157, -740.9998144535155, -614.2794320613347, -676.2066202764812, -655.6447688061047, -786.3142129325706, -748.214887257547, -717.5610314603733, -567.3208605917897, -795.1832736859715, -522.5236199172583, -641.873038589753, -772.9943629527012, -587.7437496369887, -654.6097072248673, -660.0811819240284, -840.1582661241384, -771.6521033677748, -770.5913338343424, -560.3132301075361, -664.500084210021, -823.8206583509998, -643.87232033823, -422.4467698617693, -758.3788329586012, -683.6410029940168, -1050.0830923782478, -714.5323413079711, -542.2370442241776, -708.6834966599782, -526.3516866049765, -519.6725368770785, -959.0094157729756, -794.6141100806169, -717.9127731029838, -546.5730213098454, -689.3024314572707, -684.9047195314457, -965.4251485365626, -860.6902099893744, -849.249808045342, -928.8780960984502, -533.9385147135721, -711.0544088742677, -889.7095797327539, -1011.5825192188363, -848.6993117931511, -533.1778889575806, -654.8578261426946, -970.0736250189459, -708.9593166589218, -801.3102885118361, -905.3342330150098, -890.079322695907], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.355827905906644, "mean_inference_ms": 0.41178108868972757, "mean_action_processing_ms": 0.09685404698124912, "mean_env_wait_ms": 2.865082451634853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004037380218505859, "StateBufferConnector_ms": 0.0029659271240234375, "ViewRequirementAgentConnector_ms": 0.07472920417785645}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 242520, "num_agent_steps_trained": 242520, "num_env_steps_sampled": 242520, "num_env_steps_trained": 242520, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 37.915944128734466, "num_env_steps_trained_throughput_per_sec": 37.915944128734466, "timesteps_total": 242520, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 242520, "timers": {"training_iteration_time_ms": 3149.481, "sample_time_ms": 3145.186, "load_time_ms": 0.272, "load_throughput": 441854.517, "learn_time_ms": 3.156, "learn_throughput": 38026.328, "synch_weights_time_ms": 0.816}, "counters": {"num_env_steps_sampled": 242520, "num_env_steps_trained": 242520, "num_agent_steps_sampled": 242520, "num_agent_steps_trained": 242520}, "done": false, "episodes_total": 2021, "training_iteration": 506, "trial_id": "53665_00000", "date": "2023-07-26_03-30-29", "timestamp": 1690331429, "time_this_iter_s": 12.662375211715698, "time_total_s": 6171.166553974152, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 549.841078042984, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 48.83888888888889, "ram_util_percent": 78.21666666666665}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.48260498046875, "policy_loss": -68138.015625, "vf_loss": 2398478.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 187.0, "diff_num_grad_updates_vs_sampler_policy": 186.0}}, "num_env_steps_sampled": 243000, "num_env_steps_trained": 243000, "num_agent_steps_sampled": 243000, "num_agent_steps_trained": 243000}, "sampler_results": {"episode_reward_max": -393.3801237387281, "episode_reward_min": -1072.6202813812297, "episode_reward_mean": -731.3323681557298, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1072.6202813812297, -393.3801237387281, -765.8249738045077, -831.1886116942605, -762.3454772637814, -486.92455876945724, -448.69671577154355, -940.4412434150737, -727.1847401582801, -806.6944164867027, -901.2084436665884, -987.5989695409434, -671.6777141601648, -888.5446985441893, -721.5441831103919, -696.055020234459, -898.3968632804158, -1027.4011248166166, -403.03280759378634, -622.8093760673837, -812.637503569869, -862.0779852735153, -647.6766655147794, -693.7369514273789, -731.414711060411, -677.8189717782886, -496.3815859129291, -772.9002837693945, -784.9194702372788, -666.9597433282892, -736.7936402637039, -828.7171333864179, -929.0374674872801, -715.6177440587994, -938.376510490651, -809.9584996586964, -639.6658348782015, -625.3896161339452, -704.1842142384083, -939.044875568671, -840.4886444151232, -449.8080675969133, -496.15838555700157, -740.9998144535155, -614.2794320613347, -676.2066202764812, -655.6447688061047, -786.3142129325706, -748.214887257547, -717.5610314603733, -567.3208605917897, -795.1832736859715, -522.5236199172583, -641.873038589753, -772.9943629527012, -587.7437496369887, -654.6097072248673, -660.0811819240284, -840.1582661241384, -771.6521033677748, -770.5913338343424, -560.3132301075361, -664.500084210021, -823.8206583509998, -643.87232033823, -422.4467698617693, -758.3788329586012, -683.6410029940168, -1050.0830923782478, -714.5323413079711, -542.2370442241776, -708.6834966599782, -526.3516866049765, -519.6725368770785, -959.0094157729756, -794.6141100806169, -717.9127731029838, -546.5730213098454, -689.3024314572707, -684.9047195314457, -965.4251485365626, -860.6902099893744, -849.249808045342, -928.8780960984502, -533.9385147135721, -711.0544088742677, -889.7095797327539, -1011.5825192188363, -848.6993117931511, -533.1778889575806, -654.8578261426946, -970.0736250189459, -708.9593166589218, -801.3102885118361, -905.3342330150098, -890.079322695907, -552.6976151878957, -707.6135333104693, -868.2015979940194, -553.567288746659], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.36730533775504, "mean_inference_ms": 0.41247267450046904, "mean_action_processing_ms": 0.09698965838344559, "mean_env_wait_ms": 2.8604244833185093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004099845886230469, "StateBufferConnector_ms": 0.0029773712158203125, "ViewRequirementAgentConnector_ms": 0.07530403137207031}}, "episode_reward_max": -393.3801237387281, "episode_reward_min": -1072.6202813812297, "episode_reward_mean": -731.3323681557298, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1072.6202813812297, -393.3801237387281, -765.8249738045077, -831.1886116942605, -762.3454772637814, -486.92455876945724, -448.69671577154355, -940.4412434150737, -727.1847401582801, -806.6944164867027, -901.2084436665884, -987.5989695409434, -671.6777141601648, -888.5446985441893, -721.5441831103919, -696.055020234459, -898.3968632804158, -1027.4011248166166, -403.03280759378634, -622.8093760673837, -812.637503569869, -862.0779852735153, -647.6766655147794, -693.7369514273789, -731.414711060411, -677.8189717782886, -496.3815859129291, -772.9002837693945, -784.9194702372788, -666.9597433282892, -736.7936402637039, -828.7171333864179, -929.0374674872801, -715.6177440587994, -938.376510490651, -809.9584996586964, -639.6658348782015, -625.3896161339452, -704.1842142384083, -939.044875568671, -840.4886444151232, -449.8080675969133, -496.15838555700157, -740.9998144535155, -614.2794320613347, -676.2066202764812, -655.6447688061047, -786.3142129325706, -748.214887257547, -717.5610314603733, -567.3208605917897, -795.1832736859715, -522.5236199172583, -641.873038589753, -772.9943629527012, -587.7437496369887, -654.6097072248673, -660.0811819240284, -840.1582661241384, -771.6521033677748, -770.5913338343424, -560.3132301075361, -664.500084210021, -823.8206583509998, -643.87232033823, -422.4467698617693, -758.3788329586012, -683.6410029940168, -1050.0830923782478, -714.5323413079711, -542.2370442241776, -708.6834966599782, -526.3516866049765, -519.6725368770785, -959.0094157729756, -794.6141100806169, -717.9127731029838, -546.5730213098454, -689.3024314572707, -684.9047195314457, -965.4251485365626, -860.6902099893744, -849.249808045342, -928.8780960984502, -533.9385147135721, -711.0544088742677, -889.7095797327539, -1011.5825192188363, -848.6993117931511, -533.1778889575806, -654.8578261426946, -970.0736250189459, -708.9593166589218, -801.3102885118361, -905.3342330150098, -890.079322695907, -552.6976151878957, -707.6135333104693, -868.2015979940194, -553.567288746659], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.36730533775504, "mean_inference_ms": 0.41247267450046904, "mean_action_processing_ms": 0.09698965838344559, "mean_env_wait_ms": 2.8604244833185093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004099845886230469, "StateBufferConnector_ms": 0.0029773712158203125, "ViewRequirementAgentConnector_ms": 0.07530403137207031}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 243000, "num_agent_steps_trained": 243000, "num_env_steps_sampled": 243000, "num_env_steps_trained": 243000, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.96077493656197, "num_env_steps_trained_throughput_per_sec": 39.96077493656197, "timesteps_total": 243000, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 243000, "timers": {"training_iteration_time_ms": 3130.014, "sample_time_ms": 3122.571, "load_time_ms": 0.267, "load_throughput": 449429.842, "learn_time_ms": 6.268, "learn_throughput": 19145.808, "synch_weights_time_ms": 0.855}, "counters": {"num_env_steps_sampled": 243000, "num_env_steps_trained": 243000, "num_agent_steps_sampled": 243000, "num_agent_steps_trained": 243000}, "done": false, "episodes_total": 2025, "training_iteration": 507, "trial_id": "53665_00000", "date": "2023-07-26_03-30-41", "timestamp": 1690331441, "time_this_iter_s": 12.015161275863647, "time_total_s": 6183.181715250015, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 561.8562393188477, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 47.28823529411764, "ram_util_percent": 77.70588235294117}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.5042419433594, "policy_loss": -115652.203125, "vf_loss": 5975486.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 191.0, "diff_num_grad_updates_vs_sampler_policy": 190.0}}, "num_env_steps_sampled": 243480, "num_env_steps_trained": 243480, "num_agent_steps_sampled": 243480, "num_agent_steps_trained": 243480}, "sampler_results": {"episode_reward_max": -320.6031240664431, "episode_reward_min": -1050.0830923782478, "episode_reward_mean": -725.7974705003795, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-762.3454772637814, -486.92455876945724, -448.69671577154355, -940.4412434150737, -727.1847401582801, -806.6944164867027, -901.2084436665884, -987.5989695409434, -671.6777141601648, -888.5446985441893, -721.5441831103919, -696.055020234459, -898.3968632804158, -1027.4011248166166, -403.03280759378634, -622.8093760673837, -812.637503569869, -862.0779852735153, -647.6766655147794, -693.7369514273789, -731.414711060411, -677.8189717782886, -496.3815859129291, -772.9002837693945, -784.9194702372788, -666.9597433282892, -736.7936402637039, -828.7171333864179, -929.0374674872801, -715.6177440587994, -938.376510490651, -809.9584996586964, -639.6658348782015, -625.3896161339452, -704.1842142384083, -939.044875568671, -840.4886444151232, -449.8080675969133, -496.15838555700157, -740.9998144535155, -614.2794320613347, -676.2066202764812, -655.6447688061047, -786.3142129325706, -748.214887257547, -717.5610314603733, -567.3208605917897, -795.1832736859715, -522.5236199172583, -641.873038589753, -772.9943629527012, -587.7437496369887, -654.6097072248673, -660.0811819240284, -840.1582661241384, -771.6521033677748, -770.5913338343424, -560.3132301075361, -664.500084210021, -823.8206583509998, -643.87232033823, -422.4467698617693, -758.3788329586012, -683.6410029940168, -1050.0830923782478, -714.5323413079711, -542.2370442241776, -708.6834966599782, -526.3516866049765, -519.6725368770785, -959.0094157729756, -794.6141100806169, -717.9127731029838, -546.5730213098454, -689.3024314572707, -684.9047195314457, -965.4251485365626, -860.6902099893744, -849.249808045342, -928.8780960984502, -533.9385147135721, -711.0544088742677, -889.7095797327539, -1011.5825192188363, -848.6993117931511, -533.1778889575806, -654.8578261426946, -970.0736250189459, -708.9593166589218, -801.3102885118361, -905.3342330150098, -890.079322695907, -552.6976151878957, -707.6135333104693, -868.2015979940194, -553.567288746659, -320.6031240664431, -603.7100690444422, -728.4999169102664, -856.7111150625428], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.379441376308353, "mean_inference_ms": 0.4131889961672783, "mean_action_processing_ms": 0.09712797763255064, "mean_env_wait_ms": 2.856192590829745, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004095554351806641, "StateBufferConnector_ms": 0.002989053726196289, "ViewRequirementAgentConnector_ms": 0.07532572746276855}}, "episode_reward_max": -320.6031240664431, "episode_reward_min": -1050.0830923782478, "episode_reward_mean": -725.7974705003795, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-762.3454772637814, -486.92455876945724, -448.69671577154355, -940.4412434150737, -727.1847401582801, -806.6944164867027, -901.2084436665884, -987.5989695409434, -671.6777141601648, -888.5446985441893, -721.5441831103919, -696.055020234459, -898.3968632804158, -1027.4011248166166, -403.03280759378634, -622.8093760673837, -812.637503569869, -862.0779852735153, -647.6766655147794, -693.7369514273789, -731.414711060411, -677.8189717782886, -496.3815859129291, -772.9002837693945, -784.9194702372788, -666.9597433282892, -736.7936402637039, -828.7171333864179, -929.0374674872801, -715.6177440587994, -938.376510490651, -809.9584996586964, -639.6658348782015, -625.3896161339452, -704.1842142384083, -939.044875568671, -840.4886444151232, -449.8080675969133, -496.15838555700157, -740.9998144535155, -614.2794320613347, -676.2066202764812, -655.6447688061047, -786.3142129325706, -748.214887257547, -717.5610314603733, -567.3208605917897, -795.1832736859715, -522.5236199172583, -641.873038589753, -772.9943629527012, -587.7437496369887, -654.6097072248673, -660.0811819240284, -840.1582661241384, -771.6521033677748, -770.5913338343424, -560.3132301075361, -664.500084210021, -823.8206583509998, -643.87232033823, -422.4467698617693, -758.3788329586012, -683.6410029940168, -1050.0830923782478, -714.5323413079711, -542.2370442241776, -708.6834966599782, -526.3516866049765, -519.6725368770785, -959.0094157729756, -794.6141100806169, -717.9127731029838, -546.5730213098454, -689.3024314572707, -684.9047195314457, -965.4251485365626, -860.6902099893744, -849.249808045342, -928.8780960984502, -533.9385147135721, -711.0544088742677, -889.7095797327539, -1011.5825192188363, -848.6993117931511, -533.1778889575806, -654.8578261426946, -970.0736250189459, -708.9593166589218, -801.3102885118361, -905.3342330150098, -890.079322695907, -552.6976151878957, -707.6135333104693, -868.2015979940194, -553.567288746659, -320.6031240664431, -603.7100690444422, -728.4999169102664, -856.7111150625428], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.379441376308353, "mean_inference_ms": 0.4131889961672783, "mean_action_processing_ms": 0.09712797763255064, "mean_env_wait_ms": 2.856192590829745, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004095554351806641, "StateBufferConnector_ms": 0.002989053726196289, "ViewRequirementAgentConnector_ms": 0.07532572746276855}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 243480, "num_agent_steps_trained": 243480, "num_env_steps_sampled": 243480, "num_env_steps_trained": 243480, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.218403295726425, "num_env_steps_trained_throughput_per_sec": 41.218403295726425, "timesteps_total": 243480, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 243480, "timers": {"training_iteration_time_ms": 3041.24, "sample_time_ms": 3034.007, "load_time_ms": 0.242, "load_throughput": 495000.472, "learn_time_ms": 6.153, "learn_throughput": 19502.495, "synch_weights_time_ms": 0.788}, "counters": {"num_env_steps_sampled": 243480, "num_env_steps_trained": 243480, "num_agent_steps_sampled": 243480, "num_agent_steps_trained": 243480}, "done": false, "episodes_total": 2029, "training_iteration": 508, "trial_id": "53665_00000", "date": "2023-07-26_03-30-53", "timestamp": 1690331453, "time_this_iter_s": 11.648178339004517, "time_total_s": 6194.82989358902, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 573.5044176578522, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 36.43125, "ram_util_percent": 78.94375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.49847412109375, "policy_loss": -103363.3515625, "vf_loss": 4929113.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 195.0, "diff_num_grad_updates_vs_sampler_policy": 194.0}}, "num_env_steps_sampled": 243960, "num_env_steps_trained": 243960, "num_agent_steps_sampled": 243960, "num_agent_steps_trained": 243960}, "sampler_results": {"episode_reward_max": -320.6031240664431, "episode_reward_min": -1050.0830923782478, "episode_reward_mean": -729.5359724330668, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-727.1847401582801, -806.6944164867027, -901.2084436665884, -987.5989695409434, -671.6777141601648, -888.5446985441893, -721.5441831103919, -696.055020234459, -898.3968632804158, -1027.4011248166166, -403.03280759378634, -622.8093760673837, -812.637503569869, -862.0779852735153, -647.6766655147794, -693.7369514273789, -731.414711060411, -677.8189717782886, -496.3815859129291, -772.9002837693945, -784.9194702372788, -666.9597433282892, -736.7936402637039, -828.7171333864179, -929.0374674872801, -715.6177440587994, -938.376510490651, -809.9584996586964, -639.6658348782015, -625.3896161339452, -704.1842142384083, -939.044875568671, -840.4886444151232, -449.8080675969133, -496.15838555700157, -740.9998144535155, -614.2794320613347, -676.2066202764812, -655.6447688061047, -786.3142129325706, -748.214887257547, -717.5610314603733, -567.3208605917897, -795.1832736859715, -522.5236199172583, -641.873038589753, -772.9943629527012, -587.7437496369887, -654.6097072248673, -660.0811819240284, -840.1582661241384, -771.6521033677748, -770.5913338343424, -560.3132301075361, -664.500084210021, -823.8206583509998, -643.87232033823, -422.4467698617693, -758.3788329586012, -683.6410029940168, -1050.0830923782478, -714.5323413079711, -542.2370442241776, -708.6834966599782, -526.3516866049765, -519.6725368770785, -959.0094157729756, -794.6141100806169, -717.9127731029838, -546.5730213098454, -689.3024314572707, -684.9047195314457, -965.4251485365626, -860.6902099893744, -849.249808045342, -928.8780960984502, -533.9385147135721, -711.0544088742677, -889.7095797327539, -1011.5825192188363, -848.6993117931511, -533.1778889575806, -654.8578261426946, -970.0736250189459, -708.9593166589218, -801.3102885118361, -905.3342330150098, -890.079322695907, -552.6976151878957, -707.6135333104693, -868.2015979940194, -553.567288746659, -320.6031240664431, -603.7100690444422, -728.4999169102664, -856.7111150625428, -530.4646661252414, -960.7057113477946, -667.4174388010184, -853.6703722145295], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.389705224087347, "mean_inference_ms": 0.4137583447553693, "mean_action_processing_ms": 0.09723851826983947, "mean_env_wait_ms": 2.852021670531741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004082202911376953, "StateBufferConnector_ms": 0.0029706954956054688, "ViewRequirementAgentConnector_ms": 0.07498764991760254}}, "episode_reward_max": -320.6031240664431, "episode_reward_min": -1050.0830923782478, "episode_reward_mean": -729.5359724330668, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-727.1847401582801, -806.6944164867027, -901.2084436665884, -987.5989695409434, -671.6777141601648, -888.5446985441893, -721.5441831103919, -696.055020234459, -898.3968632804158, -1027.4011248166166, -403.03280759378634, -622.8093760673837, -812.637503569869, -862.0779852735153, -647.6766655147794, -693.7369514273789, -731.414711060411, -677.8189717782886, -496.3815859129291, -772.9002837693945, -784.9194702372788, -666.9597433282892, -736.7936402637039, -828.7171333864179, -929.0374674872801, -715.6177440587994, -938.376510490651, -809.9584996586964, -639.6658348782015, -625.3896161339452, -704.1842142384083, -939.044875568671, -840.4886444151232, -449.8080675969133, -496.15838555700157, -740.9998144535155, -614.2794320613347, -676.2066202764812, -655.6447688061047, -786.3142129325706, -748.214887257547, -717.5610314603733, -567.3208605917897, -795.1832736859715, -522.5236199172583, -641.873038589753, -772.9943629527012, -587.7437496369887, -654.6097072248673, -660.0811819240284, -840.1582661241384, -771.6521033677748, -770.5913338343424, -560.3132301075361, -664.500084210021, -823.8206583509998, -643.87232033823, -422.4467698617693, -758.3788329586012, -683.6410029940168, -1050.0830923782478, -714.5323413079711, -542.2370442241776, -708.6834966599782, -526.3516866049765, -519.6725368770785, -959.0094157729756, -794.6141100806169, -717.9127731029838, -546.5730213098454, -689.3024314572707, -684.9047195314457, -965.4251485365626, -860.6902099893744, -849.249808045342, -928.8780960984502, -533.9385147135721, -711.0544088742677, -889.7095797327539, -1011.5825192188363, -848.6993117931511, -533.1778889575806, -654.8578261426946, -970.0736250189459, -708.9593166589218, -801.3102885118361, -905.3342330150098, -890.079322695907, -552.6976151878957, -707.6135333104693, -868.2015979940194, -553.567288746659, -320.6031240664431, -603.7100690444422, -728.4999169102664, -856.7111150625428, -530.4646661252414, -960.7057113477946, -667.4174388010184, -853.6703722145295], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.389705224087347, "mean_inference_ms": 0.4137583447553693, "mean_action_processing_ms": 0.09723851826983947, "mean_env_wait_ms": 2.852021670531741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004082202911376953, "StateBufferConnector_ms": 0.0029706954956054688, "ViewRequirementAgentConnector_ms": 0.07498764991760254}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 243960, "num_agent_steps_trained": 243960, "num_env_steps_sampled": 243960, "num_env_steps_trained": 243960, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.772299106906885, "num_env_steps_trained_throughput_per_sec": 40.772299106906885, "timesteps_total": 243960, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 243960, "timers": {"training_iteration_time_ms": 2939.548, "sample_time_ms": 2932.483, "load_time_ms": 0.238, "load_throughput": 504426.218, "learn_time_ms": 6.018, "learn_throughput": 19939.643, "synch_weights_time_ms": 0.762}, "counters": {"num_env_steps_sampled": 243960, "num_env_steps_trained": 243960, "num_agent_steps_sampled": 243960, "num_agent_steps_trained": 243960}, "done": false, "episodes_total": 2033, "training_iteration": 509, "trial_id": "53665_00000", "date": "2023-07-26_03-31-05", "timestamp": 1690331465, "time_this_iter_s": 11.775599956512451, "time_total_s": 6206.605493545532, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 585.2800176143646, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 39.023529411764706, "ram_util_percent": 78.34117647058825}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.50115966796875, "policy_loss": -64759.06640625, "vf_loss": 2042800.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 199.0, "diff_num_grad_updates_vs_sampler_policy": 198.0}}, "num_env_steps_sampled": 244440, "num_env_steps_trained": 244440, "num_agent_steps_sampled": 244440, "num_agent_steps_trained": 244440}, "sampler_results": {"episode_reward_max": -320.6031240664431, "episode_reward_min": -1050.0830923782478, "episode_reward_mean": -721.963539073518, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-671.6777141601648, -888.5446985441893, -721.5441831103919, -696.055020234459, -898.3968632804158, -1027.4011248166166, -403.03280759378634, -622.8093760673837, -812.637503569869, -862.0779852735153, -647.6766655147794, -693.7369514273789, -731.414711060411, -677.8189717782886, -496.3815859129291, -772.9002837693945, -784.9194702372788, -666.9597433282892, -736.7936402637039, -828.7171333864179, -929.0374674872801, -715.6177440587994, -938.376510490651, -809.9584996586964, -639.6658348782015, -625.3896161339452, -704.1842142384083, -939.044875568671, -840.4886444151232, -449.8080675969133, -496.15838555700157, -740.9998144535155, -614.2794320613347, -676.2066202764812, -655.6447688061047, -786.3142129325706, -748.214887257547, -717.5610314603733, -567.3208605917897, -795.1832736859715, -522.5236199172583, -641.873038589753, -772.9943629527012, -587.7437496369887, -654.6097072248673, -660.0811819240284, -840.1582661241384, -771.6521033677748, -770.5913338343424, -560.3132301075361, -664.500084210021, -823.8206583509998, -643.87232033823, -422.4467698617693, -758.3788329586012, -683.6410029940168, -1050.0830923782478, -714.5323413079711, -542.2370442241776, -708.6834966599782, -526.3516866049765, -519.6725368770785, -959.0094157729756, -794.6141100806169, -717.9127731029838, -546.5730213098454, -689.3024314572707, -684.9047195314457, -965.4251485365626, -860.6902099893744, -849.249808045342, -928.8780960984502, -533.9385147135721, -711.0544088742677, -889.7095797327539, -1011.5825192188363, -848.6993117931511, -533.1778889575806, -654.8578261426946, -970.0736250189459, -708.9593166589218, -801.3102885118361, -905.3342330150098, -890.079322695907, -552.6976151878957, -707.6135333104693, -868.2015979940194, -553.567288746659, -320.6031240664431, -603.7100690444422, -728.4999169102664, -856.7111150625428, -530.4646661252414, -960.7057113477946, -667.4174388010184, -853.6703722145295, -714.45120732419, -896.1297332283533, -490.98605790250696, -563.8762354425565], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.400318085609552, "mean_inference_ms": 0.41434194163607785, "mean_action_processing_ms": 0.09735085910205839, "mean_env_wait_ms": 2.8481269370506923, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040853023529052734, "StateBufferConnector_ms": 0.0029633045196533203, "ViewRequirementAgentConnector_ms": 0.07505226135253906}}, "episode_reward_max": -320.6031240664431, "episode_reward_min": -1050.0830923782478, "episode_reward_mean": -721.963539073518, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-671.6777141601648, -888.5446985441893, -721.5441831103919, -696.055020234459, -898.3968632804158, -1027.4011248166166, -403.03280759378634, -622.8093760673837, -812.637503569869, -862.0779852735153, -647.6766655147794, -693.7369514273789, -731.414711060411, -677.8189717782886, -496.3815859129291, -772.9002837693945, -784.9194702372788, -666.9597433282892, -736.7936402637039, -828.7171333864179, -929.0374674872801, -715.6177440587994, -938.376510490651, -809.9584996586964, -639.6658348782015, -625.3896161339452, -704.1842142384083, -939.044875568671, -840.4886444151232, -449.8080675969133, -496.15838555700157, -740.9998144535155, -614.2794320613347, -676.2066202764812, -655.6447688061047, -786.3142129325706, -748.214887257547, -717.5610314603733, -567.3208605917897, -795.1832736859715, -522.5236199172583, -641.873038589753, -772.9943629527012, -587.7437496369887, -654.6097072248673, -660.0811819240284, -840.1582661241384, -771.6521033677748, -770.5913338343424, -560.3132301075361, -664.500084210021, -823.8206583509998, -643.87232033823, -422.4467698617693, -758.3788329586012, -683.6410029940168, -1050.0830923782478, -714.5323413079711, -542.2370442241776, -708.6834966599782, -526.3516866049765, -519.6725368770785, -959.0094157729756, -794.6141100806169, -717.9127731029838, -546.5730213098454, -689.3024314572707, -684.9047195314457, -965.4251485365626, -860.6902099893744, -849.249808045342, -928.8780960984502, -533.9385147135721, -711.0544088742677, -889.7095797327539, -1011.5825192188363, -848.6993117931511, -533.1778889575806, -654.8578261426946, -970.0736250189459, -708.9593166589218, -801.3102885118361, -905.3342330150098, -890.079322695907, -552.6976151878957, -707.6135333104693, -868.2015979940194, -553.567288746659, -320.6031240664431, -603.7100690444422, -728.4999169102664, -856.7111150625428, -530.4646661252414, -960.7057113477946, -667.4174388010184, -853.6703722145295, -714.45120732419, -896.1297332283533, -490.98605790250696, -563.8762354425565], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.400318085609552, "mean_inference_ms": 0.41434194163607785, "mean_action_processing_ms": 0.09735085910205839, "mean_env_wait_ms": 2.8481269370506923, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040853023529052734, "StateBufferConnector_ms": 0.0029633045196533203, "ViewRequirementAgentConnector_ms": 0.07505226135253906}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 244440, "num_agent_steps_trained": 244440, "num_env_steps_sampled": 244440, "num_env_steps_trained": 244440, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.9487556713341, "num_env_steps_trained_throughput_per_sec": 39.9487556713341, "timesteps_total": 244440, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 244440, "timers": {"training_iteration_time_ms": 2959.791, "sample_time_ms": 2956.023, "load_time_ms": 0.223, "load_throughput": 538191.275, "learn_time_ms": 2.796, "learn_throughput": 42919.458, "synch_weights_time_ms": 0.709}, "counters": {"num_env_steps_sampled": 244440, "num_env_steps_trained": 244440, "num_agent_steps_sampled": 244440, "num_agent_steps_trained": 244440}, "done": false, "episodes_total": 2037, "training_iteration": 510, "trial_id": "53665_00000", "date": "2023-07-26_03-31-17", "timestamp": 1690331477, "time_this_iter_s": 12.018221616744995, "time_total_s": 6218.623715162277, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 597.2982392311096, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 41.3470588235294, "ram_util_percent": 77.85882352941178}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4984436035156, "policy_loss": -115134.3359375, "vf_loss": 6210029.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 203.0, "diff_num_grad_updates_vs_sampler_policy": 202.0}}, "num_env_steps_sampled": 244920, "num_env_steps_trained": 244920, "num_agent_steps_sampled": 244920, "num_agent_steps_trained": 244920}, "sampler_results": {"episode_reward_max": -320.6031240664431, "episode_reward_min": -1050.0830923782478, "episode_reward_mean": -723.3175475172792, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-898.3968632804158, -1027.4011248166166, -403.03280759378634, -622.8093760673837, -812.637503569869, -862.0779852735153, -647.6766655147794, -693.7369514273789, -731.414711060411, -677.8189717782886, -496.3815859129291, -772.9002837693945, -784.9194702372788, -666.9597433282892, -736.7936402637039, -828.7171333864179, -929.0374674872801, -715.6177440587994, -938.376510490651, -809.9584996586964, -639.6658348782015, -625.3896161339452, -704.1842142384083, -939.044875568671, -840.4886444151232, -449.8080675969133, -496.15838555700157, -740.9998144535155, -614.2794320613347, -676.2066202764812, -655.6447688061047, -786.3142129325706, -748.214887257547, -717.5610314603733, -567.3208605917897, -795.1832736859715, -522.5236199172583, -641.873038589753, -772.9943629527012, -587.7437496369887, -654.6097072248673, -660.0811819240284, -840.1582661241384, -771.6521033677748, -770.5913338343424, -560.3132301075361, -664.500084210021, -823.8206583509998, -643.87232033823, -422.4467698617693, -758.3788329586012, -683.6410029940168, -1050.0830923782478, -714.5323413079711, -542.2370442241776, -708.6834966599782, -526.3516866049765, -519.6725368770785, -959.0094157729756, -794.6141100806169, -717.9127731029838, -546.5730213098454, -689.3024314572707, -684.9047195314457, -965.4251485365626, -860.6902099893744, -849.249808045342, -928.8780960984502, -533.9385147135721, -711.0544088742677, -889.7095797327539, -1011.5825192188363, -848.6993117931511, -533.1778889575806, -654.8578261426946, -970.0736250189459, -708.9593166589218, -801.3102885118361, -905.3342330150098, -890.079322695907, -552.6976151878957, -707.6135333104693, -868.2015979940194, -553.567288746659, -320.6031240664431, -603.7100690444422, -728.4999169102664, -856.7111150625428, -530.4646661252414, -960.7057113477946, -667.4174388010184, -853.6703722145295, -714.45120732419, -896.1297332283533, -490.98605790250696, -563.8762354425565, -815.8561166327121, -791.6210861201384, -775.4429801673118, -730.3022775051776], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.410640671898882, "mean_inference_ms": 0.4149540153056526, "mean_action_processing_ms": 0.0974629907456703, "mean_env_wait_ms": 2.8443664859900877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040988922119140625, "StateBufferConnector_ms": 0.0029740333557128906, "ViewRequirementAgentConnector_ms": 0.07526350021362305}}, "episode_reward_max": -320.6031240664431, "episode_reward_min": -1050.0830923782478, "episode_reward_mean": -723.3175475172792, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-898.3968632804158, -1027.4011248166166, -403.03280759378634, -622.8093760673837, -812.637503569869, -862.0779852735153, -647.6766655147794, -693.7369514273789, -731.414711060411, -677.8189717782886, -496.3815859129291, -772.9002837693945, -784.9194702372788, -666.9597433282892, -736.7936402637039, -828.7171333864179, -929.0374674872801, -715.6177440587994, -938.376510490651, -809.9584996586964, -639.6658348782015, -625.3896161339452, -704.1842142384083, -939.044875568671, -840.4886444151232, -449.8080675969133, -496.15838555700157, -740.9998144535155, -614.2794320613347, -676.2066202764812, -655.6447688061047, -786.3142129325706, -748.214887257547, -717.5610314603733, -567.3208605917897, -795.1832736859715, -522.5236199172583, -641.873038589753, -772.9943629527012, -587.7437496369887, -654.6097072248673, -660.0811819240284, -840.1582661241384, -771.6521033677748, -770.5913338343424, -560.3132301075361, -664.500084210021, -823.8206583509998, -643.87232033823, -422.4467698617693, -758.3788329586012, -683.6410029940168, -1050.0830923782478, -714.5323413079711, -542.2370442241776, -708.6834966599782, -526.3516866049765, -519.6725368770785, -959.0094157729756, -794.6141100806169, -717.9127731029838, -546.5730213098454, -689.3024314572707, -684.9047195314457, -965.4251485365626, -860.6902099893744, -849.249808045342, -928.8780960984502, -533.9385147135721, -711.0544088742677, -889.7095797327539, -1011.5825192188363, -848.6993117931511, -533.1778889575806, -654.8578261426946, -970.0736250189459, -708.9593166589218, -801.3102885118361, -905.3342330150098, -890.079322695907, -552.6976151878957, -707.6135333104693, -868.2015979940194, -553.567288746659, -320.6031240664431, -603.7100690444422, -728.4999169102664, -856.7111150625428, -530.4646661252414, -960.7057113477946, -667.4174388010184, -853.6703722145295, -714.45120732419, -896.1297332283533, -490.98605790250696, -563.8762354425565, -815.8561166327121, -791.6210861201384, -775.4429801673118, -730.3022775051776], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.410640671898882, "mean_inference_ms": 0.4149540153056526, "mean_action_processing_ms": 0.0974629907456703, "mean_env_wait_ms": 2.8443664859900877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040988922119140625, "StateBufferConnector_ms": 0.0029740333557128906, "ViewRequirementAgentConnector_ms": 0.07526350021362305}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 244920, "num_agent_steps_trained": 244920, "num_env_steps_sampled": 244920, "num_env_steps_trained": 244920, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.394511837400316, "num_env_steps_trained_throughput_per_sec": 41.394511837400316, "timesteps_total": 244920, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 244920, "timers": {"training_iteration_time_ms": 2960.481, "sample_time_ms": 2954.237, "load_time_ms": 0.31, "load_throughput": 386928.413, "learn_time_ms": 4.851, "learn_throughput": 24735.428, "synch_weights_time_ms": 1.001}, "counters": {"num_env_steps_sampled": 244920, "num_env_steps_trained": 244920, "num_agent_steps_sampled": 244920, "num_agent_steps_trained": 244920}, "done": false, "episodes_total": 2041, "training_iteration": 511, "trial_id": "53665_00000", "date": "2023-07-26_03-31-29", "timestamp": 1690331489, "time_this_iter_s": 11.599036931991577, "time_total_s": 6230.222752094269, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 608.8972761631012, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 42.07058823529412, "ram_util_percent": 77.20588235294116}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.48828125, "policy_loss": -84668.71875, "vf_loss": 3227569.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 207.0, "diff_num_grad_updates_vs_sampler_policy": 206.0}}, "num_env_steps_sampled": 245400, "num_env_steps_trained": 245400, "num_agent_steps_sampled": 245400, "num_agent_steps_trained": 245400}, "sampler_results": {"episode_reward_max": -320.6031240664431, "episode_reward_min": -1058.1805385841717, "episode_reward_mean": -726.4759336029047, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-812.637503569869, -862.0779852735153, -647.6766655147794, -693.7369514273789, -731.414711060411, -677.8189717782886, -496.3815859129291, -772.9002837693945, -784.9194702372788, -666.9597433282892, -736.7936402637039, -828.7171333864179, -929.0374674872801, -715.6177440587994, -938.376510490651, -809.9584996586964, -639.6658348782015, -625.3896161339452, -704.1842142384083, -939.044875568671, -840.4886444151232, -449.8080675969133, -496.15838555700157, -740.9998144535155, -614.2794320613347, -676.2066202764812, -655.6447688061047, -786.3142129325706, -748.214887257547, -717.5610314603733, -567.3208605917897, -795.1832736859715, -522.5236199172583, -641.873038589753, -772.9943629527012, -587.7437496369887, -654.6097072248673, -660.0811819240284, -840.1582661241384, -771.6521033677748, -770.5913338343424, -560.3132301075361, -664.500084210021, -823.8206583509998, -643.87232033823, -422.4467698617693, -758.3788329586012, -683.6410029940168, -1050.0830923782478, -714.5323413079711, -542.2370442241776, -708.6834966599782, -526.3516866049765, -519.6725368770785, -959.0094157729756, -794.6141100806169, -717.9127731029838, -546.5730213098454, -689.3024314572707, -684.9047195314457, -965.4251485365626, -860.6902099893744, -849.249808045342, -928.8780960984502, -533.9385147135721, -711.0544088742677, -889.7095797327539, -1011.5825192188363, -848.6993117931511, -533.1778889575806, -654.8578261426946, -970.0736250189459, -708.9593166589218, -801.3102885118361, -905.3342330150098, -890.079322695907, -552.6976151878957, -707.6135333104693, -868.2015979940194, -553.567288746659, -320.6031240664431, -603.7100690444422, -728.4999169102664, -856.7111150625428, -530.4646661252414, -960.7057113477946, -667.4174388010184, -853.6703722145295, -714.45120732419, -896.1297332283533, -490.98605790250696, -563.8762354425565, -815.8561166327121, -791.6210861201384, -775.4429801673118, -730.3022775051776, -972.2752830050244, -582.7407996606615, -1058.1805385841717, -654.2821590709123], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.42172247397877, "mean_inference_ms": 0.415579853104717, "mean_action_processing_ms": 0.09757654440626741, "mean_env_wait_ms": 2.840866169464457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004111528396606445, "StateBufferConnector_ms": 0.0029714107513427734, "ViewRequirementAgentConnector_ms": 0.07528162002563477}}, "episode_reward_max": -320.6031240664431, "episode_reward_min": -1058.1805385841717, "episode_reward_mean": -726.4759336029047, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-812.637503569869, -862.0779852735153, -647.6766655147794, -693.7369514273789, -731.414711060411, -677.8189717782886, -496.3815859129291, -772.9002837693945, -784.9194702372788, -666.9597433282892, -736.7936402637039, -828.7171333864179, -929.0374674872801, -715.6177440587994, -938.376510490651, -809.9584996586964, -639.6658348782015, -625.3896161339452, -704.1842142384083, -939.044875568671, -840.4886444151232, -449.8080675969133, -496.15838555700157, -740.9998144535155, -614.2794320613347, -676.2066202764812, -655.6447688061047, -786.3142129325706, -748.214887257547, -717.5610314603733, -567.3208605917897, -795.1832736859715, -522.5236199172583, -641.873038589753, -772.9943629527012, -587.7437496369887, -654.6097072248673, -660.0811819240284, -840.1582661241384, -771.6521033677748, -770.5913338343424, -560.3132301075361, -664.500084210021, -823.8206583509998, -643.87232033823, -422.4467698617693, -758.3788329586012, -683.6410029940168, -1050.0830923782478, -714.5323413079711, -542.2370442241776, -708.6834966599782, -526.3516866049765, -519.6725368770785, -959.0094157729756, -794.6141100806169, -717.9127731029838, -546.5730213098454, -689.3024314572707, -684.9047195314457, -965.4251485365626, -860.6902099893744, -849.249808045342, -928.8780960984502, -533.9385147135721, -711.0544088742677, -889.7095797327539, -1011.5825192188363, -848.6993117931511, -533.1778889575806, -654.8578261426946, -970.0736250189459, -708.9593166589218, -801.3102885118361, -905.3342330150098, -890.079322695907, -552.6976151878957, -707.6135333104693, -868.2015979940194, -553.567288746659, -320.6031240664431, -603.7100690444422, -728.4999169102664, -856.7111150625428, -530.4646661252414, -960.7057113477946, -667.4174388010184, -853.6703722145295, -714.45120732419, -896.1297332283533, -490.98605790250696, -563.8762354425565, -815.8561166327121, -791.6210861201384, -775.4429801673118, -730.3022775051776, -972.2752830050244, -582.7407996606615, -1058.1805385841717, -654.2821590709123], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.42172247397877, "mean_inference_ms": 0.415579853104717, "mean_action_processing_ms": 0.09757654440626741, "mean_env_wait_ms": 2.840866169464457, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004111528396606445, "StateBufferConnector_ms": 0.0029714107513427734, "ViewRequirementAgentConnector_ms": 0.07528162002563477}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 245400, "num_agent_steps_trained": 245400, "num_env_steps_sampled": 245400, "num_env_steps_trained": 245400, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.590331680216565, "num_env_steps_trained_throughput_per_sec": 40.590331680216565, "timesteps_total": 245400, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 245400, "timers": {"training_iteration_time_ms": 2933.431, "sample_time_ms": 2926.923, "load_time_ms": 0.316, "load_throughput": 379890.165, "learn_time_ms": 5.062, "learn_throughput": 23707.236, "synch_weights_time_ms": 1.046}, "counters": {"num_env_steps_sampled": 245400, "num_env_steps_trained": 245400, "num_agent_steps_sampled": 245400, "num_agent_steps_trained": 245400}, "done": false, "episodes_total": 2045, "training_iteration": 512, "trial_id": "53665_00000", "date": "2023-07-26_03-31-40", "timestamp": 1690331500, "time_this_iter_s": 11.828333139419556, "time_total_s": 6242.051085233688, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 620.7256093025208, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 42.96470588235294, "ram_util_percent": 77.01764705882354}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4756774902344, "policy_loss": -105155.40625, "vf_loss": 4956816.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 211.0, "diff_num_grad_updates_vs_sampler_policy": 210.0}}, "num_env_steps_sampled": 245880, "num_env_steps_trained": 245880, "num_agent_steps_sampled": 245880, "num_agent_steps_trained": 245880}, "sampler_results": {"episode_reward_max": -320.6031240664431, "episode_reward_min": -1058.1805385841717, "episode_reward_mean": -725.3569873297122, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-731.414711060411, -677.8189717782886, -496.3815859129291, -772.9002837693945, -784.9194702372788, -666.9597433282892, -736.7936402637039, -828.7171333864179, -929.0374674872801, -715.6177440587994, -938.376510490651, -809.9584996586964, -639.6658348782015, -625.3896161339452, -704.1842142384083, -939.044875568671, -840.4886444151232, -449.8080675969133, -496.15838555700157, -740.9998144535155, -614.2794320613347, -676.2066202764812, -655.6447688061047, -786.3142129325706, -748.214887257547, -717.5610314603733, -567.3208605917897, -795.1832736859715, -522.5236199172583, -641.873038589753, -772.9943629527012, -587.7437496369887, -654.6097072248673, -660.0811819240284, -840.1582661241384, -771.6521033677748, -770.5913338343424, -560.3132301075361, -664.500084210021, -823.8206583509998, -643.87232033823, -422.4467698617693, -758.3788329586012, -683.6410029940168, -1050.0830923782478, -714.5323413079711, -542.2370442241776, -708.6834966599782, -526.3516866049765, -519.6725368770785, -959.0094157729756, -794.6141100806169, -717.9127731029838, -546.5730213098454, -689.3024314572707, -684.9047195314457, -965.4251485365626, -860.6902099893744, -849.249808045342, -928.8780960984502, -533.9385147135721, -711.0544088742677, -889.7095797327539, -1011.5825192188363, -848.6993117931511, -533.1778889575806, -654.8578261426946, -970.0736250189459, -708.9593166589218, -801.3102885118361, -905.3342330150098, -890.079322695907, -552.6976151878957, -707.6135333104693, -868.2015979940194, -553.567288746659, -320.6031240664431, -603.7100690444422, -728.4999169102664, -856.7111150625428, -530.4646661252414, -960.7057113477946, -667.4174388010184, -853.6703722145295, -714.45120732419, -896.1297332283533, -490.98605790250696, -563.8762354425565, -815.8561166327121, -791.6210861201384, -775.4429801673118, -730.3022775051776, -972.2752830050244, -582.7407996606615, -1058.1805385841717, -654.2821590709123, -714.762250754641, -767.0760586107676, -604.4258405419961, -817.9703285588729], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.433161417394377, "mean_inference_ms": 0.41615411522595896, "mean_action_processing_ms": 0.09767678895815222, "mean_env_wait_ms": 2.837469564272956, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004094362258911133, "StateBufferConnector_ms": 0.0029633045196533203, "ViewRequirementAgentConnector_ms": 0.07509040832519531}}, "episode_reward_max": -320.6031240664431, "episode_reward_min": -1058.1805385841717, "episode_reward_mean": -725.3569873297122, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-731.414711060411, -677.8189717782886, -496.3815859129291, -772.9002837693945, -784.9194702372788, -666.9597433282892, -736.7936402637039, -828.7171333864179, -929.0374674872801, -715.6177440587994, -938.376510490651, -809.9584996586964, -639.6658348782015, -625.3896161339452, -704.1842142384083, -939.044875568671, -840.4886444151232, -449.8080675969133, -496.15838555700157, -740.9998144535155, -614.2794320613347, -676.2066202764812, -655.6447688061047, -786.3142129325706, -748.214887257547, -717.5610314603733, -567.3208605917897, -795.1832736859715, -522.5236199172583, -641.873038589753, -772.9943629527012, -587.7437496369887, -654.6097072248673, -660.0811819240284, -840.1582661241384, -771.6521033677748, -770.5913338343424, -560.3132301075361, -664.500084210021, -823.8206583509998, -643.87232033823, -422.4467698617693, -758.3788329586012, -683.6410029940168, -1050.0830923782478, -714.5323413079711, -542.2370442241776, -708.6834966599782, -526.3516866049765, -519.6725368770785, -959.0094157729756, -794.6141100806169, -717.9127731029838, -546.5730213098454, -689.3024314572707, -684.9047195314457, -965.4251485365626, -860.6902099893744, -849.249808045342, -928.8780960984502, -533.9385147135721, -711.0544088742677, -889.7095797327539, -1011.5825192188363, -848.6993117931511, -533.1778889575806, -654.8578261426946, -970.0736250189459, -708.9593166589218, -801.3102885118361, -905.3342330150098, -890.079322695907, -552.6976151878957, -707.6135333104693, -868.2015979940194, -553.567288746659, -320.6031240664431, -603.7100690444422, -728.4999169102664, -856.7111150625428, -530.4646661252414, -960.7057113477946, -667.4174388010184, -853.6703722145295, -714.45120732419, -896.1297332283533, -490.98605790250696, -563.8762354425565, -815.8561166327121, -791.6210861201384, -775.4429801673118, -730.3022775051776, -972.2752830050244, -582.7407996606615, -1058.1805385841717, -654.2821590709123, -714.762250754641, -767.0760586107676, -604.4258405419961, -817.9703285588729], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.433161417394377, "mean_inference_ms": 0.41615411522595896, "mean_action_processing_ms": 0.09767678895815222, "mean_env_wait_ms": 2.837469564272956, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004094362258911133, "StateBufferConnector_ms": 0.0029633045196533203, "ViewRequirementAgentConnector_ms": 0.07509040832519531}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 245880, "num_agent_steps_trained": 245880, "num_env_steps_sampled": 245880, "num_env_steps_trained": 245880, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.74243715228949, "num_env_steps_trained_throughput_per_sec": 41.74243715228949, "timesteps_total": 245880, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 245880, "timers": {"training_iteration_time_ms": 2919.549, "sample_time_ms": 2913.028, "load_time_ms": 0.315, "load_throughput": 380954.042, "learn_time_ms": 5.074, "learn_throughput": 23648.756, "synch_weights_time_ms": 1.048}, "counters": {"num_env_steps_sampled": 245880, "num_env_steps_trained": 245880, "num_agent_steps_sampled": 245880, "num_agent_steps_trained": 245880}, "done": false, "episodes_total": 2049, "training_iteration": 513, "trial_id": "53665_00000", "date": "2023-07-26_03-31-52", "timestamp": 1690331512, "time_this_iter_s": 11.502259254455566, "time_total_s": 6253.553344488144, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 632.2278685569763, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 38.5, "ram_util_percent": 77.275}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4784240722656, "policy_loss": -123489.1171875, "vf_loss": 7189710.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 215.0, "diff_num_grad_updates_vs_sampler_policy": 214.0}}, "num_env_steps_sampled": 246360, "num_env_steps_trained": 246360, "num_agent_steps_sampled": 246360, "num_agent_steps_trained": 246360}, "sampler_results": {"episode_reward_max": -292.21222727618317, "episode_reward_min": -1058.1805385841717, "episode_reward_mean": -725.7639811494981, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-784.9194702372788, -666.9597433282892, -736.7936402637039, -828.7171333864179, -929.0374674872801, -715.6177440587994, -938.376510490651, -809.9584996586964, -639.6658348782015, -625.3896161339452, -704.1842142384083, -939.044875568671, -840.4886444151232, -449.8080675969133, -496.15838555700157, -740.9998144535155, -614.2794320613347, -676.2066202764812, -655.6447688061047, -786.3142129325706, -748.214887257547, -717.5610314603733, -567.3208605917897, -795.1832736859715, -522.5236199172583, -641.873038589753, -772.9943629527012, -587.7437496369887, -654.6097072248673, -660.0811819240284, -840.1582661241384, -771.6521033677748, -770.5913338343424, -560.3132301075361, -664.500084210021, -823.8206583509998, -643.87232033823, -422.4467698617693, -758.3788329586012, -683.6410029940168, -1050.0830923782478, -714.5323413079711, -542.2370442241776, -708.6834966599782, -526.3516866049765, -519.6725368770785, -959.0094157729756, -794.6141100806169, -717.9127731029838, -546.5730213098454, -689.3024314572707, -684.9047195314457, -965.4251485365626, -860.6902099893744, -849.249808045342, -928.8780960984502, -533.9385147135721, -711.0544088742677, -889.7095797327539, -1011.5825192188363, -848.6993117931511, -533.1778889575806, -654.8578261426946, -970.0736250189459, -708.9593166589218, -801.3102885118361, -905.3342330150098, -890.079322695907, -552.6976151878957, -707.6135333104693, -868.2015979940194, -553.567288746659, -320.6031240664431, -603.7100690444422, -728.4999169102664, -856.7111150625428, -530.4646661252414, -960.7057113477946, -667.4174388010184, -853.6703722145295, -714.45120732419, -896.1297332283533, -490.98605790250696, -563.8762354425565, -815.8561166327121, -791.6210861201384, -775.4429801673118, -730.3022775051776, -972.2752830050244, -582.7407996606615, -1058.1805385841717, -654.2821590709123, -714.762250754641, -767.0760586107676, -604.4258405419961, -817.9703285588729, -292.21222727618317, -741.0783275251554, -770.8117765901958, -915.112603108096], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.444797126933363, "mean_inference_ms": 0.4167390415054072, "mean_action_processing_ms": 0.09777789564749653, "mean_env_wait_ms": 2.834429719870374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041196346282958984, "StateBufferConnector_ms": 0.0029754638671875, "ViewRequirementAgentConnector_ms": 0.07563996315002441}}, "episode_reward_max": -292.21222727618317, "episode_reward_min": -1058.1805385841717, "episode_reward_mean": -725.7639811494981, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-784.9194702372788, -666.9597433282892, -736.7936402637039, -828.7171333864179, -929.0374674872801, -715.6177440587994, -938.376510490651, -809.9584996586964, -639.6658348782015, -625.3896161339452, -704.1842142384083, -939.044875568671, -840.4886444151232, -449.8080675969133, -496.15838555700157, -740.9998144535155, -614.2794320613347, -676.2066202764812, -655.6447688061047, -786.3142129325706, -748.214887257547, -717.5610314603733, -567.3208605917897, -795.1832736859715, -522.5236199172583, -641.873038589753, -772.9943629527012, -587.7437496369887, -654.6097072248673, -660.0811819240284, -840.1582661241384, -771.6521033677748, -770.5913338343424, -560.3132301075361, -664.500084210021, -823.8206583509998, -643.87232033823, -422.4467698617693, -758.3788329586012, -683.6410029940168, -1050.0830923782478, -714.5323413079711, -542.2370442241776, -708.6834966599782, -526.3516866049765, -519.6725368770785, -959.0094157729756, -794.6141100806169, -717.9127731029838, -546.5730213098454, -689.3024314572707, -684.9047195314457, -965.4251485365626, -860.6902099893744, -849.249808045342, -928.8780960984502, -533.9385147135721, -711.0544088742677, -889.7095797327539, -1011.5825192188363, -848.6993117931511, -533.1778889575806, -654.8578261426946, -970.0736250189459, -708.9593166589218, -801.3102885118361, -905.3342330150098, -890.079322695907, -552.6976151878957, -707.6135333104693, -868.2015979940194, -553.567288746659, -320.6031240664431, -603.7100690444422, -728.4999169102664, -856.7111150625428, -530.4646661252414, -960.7057113477946, -667.4174388010184, -853.6703722145295, -714.45120732419, -896.1297332283533, -490.98605790250696, -563.8762354425565, -815.8561166327121, -791.6210861201384, -775.4429801673118, -730.3022775051776, -972.2752830050244, -582.7407996606615, -1058.1805385841717, -654.2821590709123, -714.762250754641, -767.0760586107676, -604.4258405419961, -817.9703285588729, -292.21222727618317, -741.0783275251554, -770.8117765901958, -915.112603108096], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.444797126933363, "mean_inference_ms": 0.4167390415054072, "mean_action_processing_ms": 0.09777789564749653, "mean_env_wait_ms": 2.834429719870374, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041196346282958984, "StateBufferConnector_ms": 0.0029754638671875, "ViewRequirementAgentConnector_ms": 0.07563996315002441}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 246360, "num_agent_steps_trained": 246360, "num_env_steps_sampled": 246360, "num_env_steps_trained": 246360, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.092425088484, "num_env_steps_trained_throughput_per_sec": 41.092425088484, "timesteps_total": 246360, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 246360, "timers": {"training_iteration_time_ms": 2896.546, "sample_time_ms": 2892.708, "load_time_ms": 0.221, "load_throughput": 544067.106, "learn_time_ms": 2.85, "learn_throughput": 42105.849, "synch_weights_time_ms": 0.727}, "counters": {"num_env_steps_sampled": 246360, "num_env_steps_trained": 246360, "num_agent_steps_sampled": 246360, "num_agent_steps_trained": 246360}, "done": false, "episodes_total": 2053, "training_iteration": 514, "trial_id": "53665_00000", "date": "2023-07-26_03-32-04", "timestamp": 1690331524, "time_this_iter_s": 11.683903932571411, "time_total_s": 6265.237248420715, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 643.9117724895477, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 41.86470588235294, "ram_util_percent": 77.15882352941175}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4956970214844, "policy_loss": -69721.8046875, "vf_loss": 2372724.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 219.0, "diff_num_grad_updates_vs_sampler_policy": 218.0}}, "num_env_steps_sampled": 246840, "num_env_steps_trained": 246840, "num_agent_steps_sampled": 246840, "num_agent_steps_trained": 246840}, "sampler_results": {"episode_reward_max": -292.21222727618317, "episode_reward_min": -1058.1805385841717, "episode_reward_mean": -719.1618781811292, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-929.0374674872801, -715.6177440587994, -938.376510490651, -809.9584996586964, -639.6658348782015, -625.3896161339452, -704.1842142384083, -939.044875568671, -840.4886444151232, -449.8080675969133, -496.15838555700157, -740.9998144535155, -614.2794320613347, -676.2066202764812, -655.6447688061047, -786.3142129325706, -748.214887257547, -717.5610314603733, -567.3208605917897, -795.1832736859715, -522.5236199172583, -641.873038589753, -772.9943629527012, -587.7437496369887, -654.6097072248673, -660.0811819240284, -840.1582661241384, -771.6521033677748, -770.5913338343424, -560.3132301075361, -664.500084210021, -823.8206583509998, -643.87232033823, -422.4467698617693, -758.3788329586012, -683.6410029940168, -1050.0830923782478, -714.5323413079711, -542.2370442241776, -708.6834966599782, -526.3516866049765, -519.6725368770785, -959.0094157729756, -794.6141100806169, -717.9127731029838, -546.5730213098454, -689.3024314572707, -684.9047195314457, -965.4251485365626, -860.6902099893744, -849.249808045342, -928.8780960984502, -533.9385147135721, -711.0544088742677, -889.7095797327539, -1011.5825192188363, -848.6993117931511, -533.1778889575806, -654.8578261426946, -970.0736250189459, -708.9593166589218, -801.3102885118361, -905.3342330150098, -890.079322695907, -552.6976151878957, -707.6135333104693, -868.2015979940194, -553.567288746659, -320.6031240664431, -603.7100690444422, -728.4999169102664, -856.7111150625428, -530.4646661252414, -960.7057113477946, -667.4174388010184, -853.6703722145295, -714.45120732419, -896.1297332283533, -490.98605790250696, -563.8762354425565, -815.8561166327121, -791.6210861201384, -775.4429801673118, -730.3022775051776, -972.2752830050244, -582.7407996606615, -1058.1805385841717, -654.2821590709123, -714.762250754641, -767.0760586107676, -604.4258405419961, -817.9703285588729, -292.21222727618317, -741.0783275251554, -770.8117765901958, -915.112603108096, -669.8805313490843, -367.4418885706997, -799.9827632094997, -519.8745072495046], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.455427120629388, "mean_inference_ms": 0.41732328124274365, "mean_action_processing_ms": 0.0978790663943712, "mean_env_wait_ms": 2.831516148535974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004117727279663086, "StateBufferConnector_ms": 0.002974987030029297, "ViewRequirementAgentConnector_ms": 0.07565903663635254}}, "episode_reward_max": -292.21222727618317, "episode_reward_min": -1058.1805385841717, "episode_reward_mean": -719.1618781811292, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-929.0374674872801, -715.6177440587994, -938.376510490651, -809.9584996586964, -639.6658348782015, -625.3896161339452, -704.1842142384083, -939.044875568671, -840.4886444151232, -449.8080675969133, -496.15838555700157, -740.9998144535155, -614.2794320613347, -676.2066202764812, -655.6447688061047, -786.3142129325706, -748.214887257547, -717.5610314603733, -567.3208605917897, -795.1832736859715, -522.5236199172583, -641.873038589753, -772.9943629527012, -587.7437496369887, -654.6097072248673, -660.0811819240284, -840.1582661241384, -771.6521033677748, -770.5913338343424, -560.3132301075361, -664.500084210021, -823.8206583509998, -643.87232033823, -422.4467698617693, -758.3788329586012, -683.6410029940168, -1050.0830923782478, -714.5323413079711, -542.2370442241776, -708.6834966599782, -526.3516866049765, -519.6725368770785, -959.0094157729756, -794.6141100806169, -717.9127731029838, -546.5730213098454, -689.3024314572707, -684.9047195314457, -965.4251485365626, -860.6902099893744, -849.249808045342, -928.8780960984502, -533.9385147135721, -711.0544088742677, -889.7095797327539, -1011.5825192188363, -848.6993117931511, -533.1778889575806, -654.8578261426946, -970.0736250189459, -708.9593166589218, -801.3102885118361, -905.3342330150098, -890.079322695907, -552.6976151878957, -707.6135333104693, -868.2015979940194, -553.567288746659, -320.6031240664431, -603.7100690444422, -728.4999169102664, -856.7111150625428, -530.4646661252414, -960.7057113477946, -667.4174388010184, -853.6703722145295, -714.45120732419, -896.1297332283533, -490.98605790250696, -563.8762354425565, -815.8561166327121, -791.6210861201384, -775.4429801673118, -730.3022775051776, -972.2752830050244, -582.7407996606615, -1058.1805385841717, -654.2821590709123, -714.762250754641, -767.0760586107676, -604.4258405419961, -817.9703285588729, -292.21222727618317, -741.0783275251554, -770.8117765901958, -915.112603108096, -669.8805313490843, -367.4418885706997, -799.9827632094997, -519.8745072495046], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.455427120629388, "mean_inference_ms": 0.41732328124274365, "mean_action_processing_ms": 0.0978790663943712, "mean_env_wait_ms": 2.831516148535974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004117727279663086, "StateBufferConnector_ms": 0.002974987030029297, "ViewRequirementAgentConnector_ms": 0.07565903663635254}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 246840, "num_agent_steps_trained": 246840, "num_env_steps_sampled": 246840, "num_env_steps_trained": 246840, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.010835513821426, "num_env_steps_trained_throughput_per_sec": 41.010835513821426, "timesteps_total": 246840, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 246840, "timers": {"training_iteration_time_ms": 2908.652, "sample_time_ms": 2904.876, "load_time_ms": 0.218, "load_throughput": 550433.596, "learn_time_ms": 2.808, "learn_throughput": 42741.958, "synch_weights_time_ms": 0.71}, "counters": {"num_env_steps_sampled": 246840, "num_env_steps_trained": 246840, "num_agent_steps_sampled": 246840, "num_agent_steps_trained": 246840}, "done": false, "episodes_total": 2057, "training_iteration": 515, "trial_id": "53665_00000", "date": "2023-07-26_03-32-15", "timestamp": 1690331535, "time_this_iter_s": 11.706921100616455, "time_total_s": 6276.944169521332, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 655.6186935901642, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 43.88125, "ram_util_percent": 76.9875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4859619140625, "policy_loss": -102677.234375, "vf_loss": 4695891.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 223.0, "diff_num_grad_updates_vs_sampler_policy": 222.0}}, "num_env_steps_sampled": 247320, "num_env_steps_trained": 247320, "num_agent_steps_sampled": 247320, "num_agent_steps_trained": 247320}, "sampler_results": {"episode_reward_max": -292.21222727618317, "episode_reward_min": -1058.1805385841717, "episode_reward_mean": -716.9211339703944, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-639.6658348782015, -625.3896161339452, -704.1842142384083, -939.044875568671, -840.4886444151232, -449.8080675969133, -496.15838555700157, -740.9998144535155, -614.2794320613347, -676.2066202764812, -655.6447688061047, -786.3142129325706, -748.214887257547, -717.5610314603733, -567.3208605917897, -795.1832736859715, -522.5236199172583, -641.873038589753, -772.9943629527012, -587.7437496369887, -654.6097072248673, -660.0811819240284, -840.1582661241384, -771.6521033677748, -770.5913338343424, -560.3132301075361, -664.500084210021, -823.8206583509998, -643.87232033823, -422.4467698617693, -758.3788329586012, -683.6410029940168, -1050.0830923782478, -714.5323413079711, -542.2370442241776, -708.6834966599782, -526.3516866049765, -519.6725368770785, -959.0094157729756, -794.6141100806169, -717.9127731029838, -546.5730213098454, -689.3024314572707, -684.9047195314457, -965.4251485365626, -860.6902099893744, -849.249808045342, -928.8780960984502, -533.9385147135721, -711.0544088742677, -889.7095797327539, -1011.5825192188363, -848.6993117931511, -533.1778889575806, -654.8578261426946, -970.0736250189459, -708.9593166589218, -801.3102885118361, -905.3342330150098, -890.079322695907, -552.6976151878957, -707.6135333104693, -868.2015979940194, -553.567288746659, -320.6031240664431, -603.7100690444422, -728.4999169102664, -856.7111150625428, -530.4646661252414, -960.7057113477946, -667.4174388010184, -853.6703722145295, -714.45120732419, -896.1297332283533, -490.98605790250696, -563.8762354425565, -815.8561166327121, -791.6210861201384, -775.4429801673118, -730.3022775051776, -972.2752830050244, -582.7407996606615, -1058.1805385841717, -654.2821590709123, -714.762250754641, -767.0760586107676, -604.4258405419961, -817.9703285588729, -292.21222727618317, -741.0783275251554, -770.8117765901958, -915.112603108096, -669.8805313490843, -367.4418885706997, -799.9827632094997, -519.8745072495046, -806.6498885469076, -867.4250403636132, -654.7518312941235, -840.0890404173158], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.465058173542886, "mean_inference_ms": 0.4178817731207159, "mean_action_processing_ms": 0.09797704469261298, "mean_env_wait_ms": 2.8288550817355906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004096269607543945, "StateBufferConnector_ms": 0.002980470657348633, "ViewRequirementAgentConnector_ms": 0.0753169059753418}}, "episode_reward_max": -292.21222727618317, "episode_reward_min": -1058.1805385841717, "episode_reward_mean": -716.9211339703944, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-639.6658348782015, -625.3896161339452, -704.1842142384083, -939.044875568671, -840.4886444151232, -449.8080675969133, -496.15838555700157, -740.9998144535155, -614.2794320613347, -676.2066202764812, -655.6447688061047, -786.3142129325706, -748.214887257547, -717.5610314603733, -567.3208605917897, -795.1832736859715, -522.5236199172583, -641.873038589753, -772.9943629527012, -587.7437496369887, -654.6097072248673, -660.0811819240284, -840.1582661241384, -771.6521033677748, -770.5913338343424, -560.3132301075361, -664.500084210021, -823.8206583509998, -643.87232033823, -422.4467698617693, -758.3788329586012, -683.6410029940168, -1050.0830923782478, -714.5323413079711, -542.2370442241776, -708.6834966599782, -526.3516866049765, -519.6725368770785, -959.0094157729756, -794.6141100806169, -717.9127731029838, -546.5730213098454, -689.3024314572707, -684.9047195314457, -965.4251485365626, -860.6902099893744, -849.249808045342, -928.8780960984502, -533.9385147135721, -711.0544088742677, -889.7095797327539, -1011.5825192188363, -848.6993117931511, -533.1778889575806, -654.8578261426946, -970.0736250189459, -708.9593166589218, -801.3102885118361, -905.3342330150098, -890.079322695907, -552.6976151878957, -707.6135333104693, -868.2015979940194, -553.567288746659, -320.6031240664431, -603.7100690444422, -728.4999169102664, -856.7111150625428, -530.4646661252414, -960.7057113477946, -667.4174388010184, -853.6703722145295, -714.45120732419, -896.1297332283533, -490.98605790250696, -563.8762354425565, -815.8561166327121, -791.6210861201384, -775.4429801673118, -730.3022775051776, -972.2752830050244, -582.7407996606615, -1058.1805385841717, -654.2821590709123, -714.762250754641, -767.0760586107676, -604.4258405419961, -817.9703285588729, -292.21222727618317, -741.0783275251554, -770.8117765901958, -915.112603108096, -669.8805313490843, -367.4418885706997, -799.9827632094997, -519.8745072495046, -806.6498885469076, -867.4250403636132, -654.7518312941235, -840.0890404173158], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.465058173542886, "mean_inference_ms": 0.4178817731207159, "mean_action_processing_ms": 0.09797704469261298, "mean_env_wait_ms": 2.8288550817355906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004096269607543945, "StateBufferConnector_ms": 0.002980470657348633, "ViewRequirementAgentConnector_ms": 0.0753169059753418}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 247320, "num_agent_steps_trained": 247320, "num_env_steps_sampled": 247320, "num_env_steps_trained": 247320, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.43556588044909, "num_env_steps_trained_throughput_per_sec": 40.43556588044909, "timesteps_total": 247320, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 247320, "timers": {"training_iteration_time_ms": 2940.143, "sample_time_ms": 2935.656, "load_time_ms": 0.278, "load_throughput": 432365.329, "learn_time_ms": 3.325, "learn_throughput": 36084.949, "synch_weights_time_ms": 0.814}, "counters": {"num_env_steps_sampled": 247320, "num_env_steps_trained": 247320, "num_agent_steps_sampled": 247320, "num_agent_steps_trained": 247320}, "done": false, "episodes_total": 2061, "training_iteration": 516, "trial_id": "53665_00000", "date": "2023-07-26_03-32-27", "timestamp": 1690331547, "time_this_iter_s": 11.874638080596924, "time_total_s": 6288.818807601929, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 667.4933316707611, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 43.80588235294118, "ram_util_percent": 78.37058823529412}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4960021972656, "policy_loss": -111508.5703125, "vf_loss": 5719654.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 227.0, "diff_num_grad_updates_vs_sampler_policy": 226.0}}, "num_env_steps_sampled": 247800, "num_env_steps_trained": 247800, "num_agent_steps_sampled": 247800, "num_agent_steps_trained": 247800}, "sampler_results": {"episode_reward_max": -292.21222727618317, "episode_reward_min": -1203.1219602777874, "episode_reward_mean": -722.5099146271612, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-840.4886444151232, -449.8080675969133, -496.15838555700157, -740.9998144535155, -614.2794320613347, -676.2066202764812, -655.6447688061047, -786.3142129325706, -748.214887257547, -717.5610314603733, -567.3208605917897, -795.1832736859715, -522.5236199172583, -641.873038589753, -772.9943629527012, -587.7437496369887, -654.6097072248673, -660.0811819240284, -840.1582661241384, -771.6521033677748, -770.5913338343424, -560.3132301075361, -664.500084210021, -823.8206583509998, -643.87232033823, -422.4467698617693, -758.3788329586012, -683.6410029940168, -1050.0830923782478, -714.5323413079711, -542.2370442241776, -708.6834966599782, -526.3516866049765, -519.6725368770785, -959.0094157729756, -794.6141100806169, -717.9127731029838, -546.5730213098454, -689.3024314572707, -684.9047195314457, -965.4251485365626, -860.6902099893744, -849.249808045342, -928.8780960984502, -533.9385147135721, -711.0544088742677, -889.7095797327539, -1011.5825192188363, -848.6993117931511, -533.1778889575806, -654.8578261426946, -970.0736250189459, -708.9593166589218, -801.3102885118361, -905.3342330150098, -890.079322695907, -552.6976151878957, -707.6135333104693, -868.2015979940194, -553.567288746659, -320.6031240664431, -603.7100690444422, -728.4999169102664, -856.7111150625428, -530.4646661252414, -960.7057113477946, -667.4174388010184, -853.6703722145295, -714.45120732419, -896.1297332283533, -490.98605790250696, -563.8762354425565, -815.8561166327121, -791.6210861201384, -775.4429801673118, -730.3022775051776, -972.2752830050244, -582.7407996606615, -1058.1805385841717, -654.2821590709123, -714.762250754641, -767.0760586107676, -604.4258405419961, -817.9703285588729, -292.21222727618317, -741.0783275251554, -770.8117765901958, -915.112603108096, -669.8805313490843, -367.4418885706997, -799.9827632094997, -519.8745072495046, -806.6498885469076, -867.4250403636132, -654.7518312941235, -840.0890404173158, -1203.1219602777874, -522.5329041512487, -881.3467784518417, -860.1609636150134], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.473503435829834, "mean_inference_ms": 0.4184219425007298, "mean_action_processing_ms": 0.09806569267314132, "mean_env_wait_ms": 2.8263382207366687, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00403904914855957, "StateBufferConnector_ms": 0.0029642581939697266, "ViewRequirementAgentConnector_ms": 0.07499003410339355}}, "episode_reward_max": -292.21222727618317, "episode_reward_min": -1203.1219602777874, "episode_reward_mean": -722.5099146271612, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-840.4886444151232, -449.8080675969133, -496.15838555700157, -740.9998144535155, -614.2794320613347, -676.2066202764812, -655.6447688061047, -786.3142129325706, -748.214887257547, -717.5610314603733, -567.3208605917897, -795.1832736859715, -522.5236199172583, -641.873038589753, -772.9943629527012, -587.7437496369887, -654.6097072248673, -660.0811819240284, -840.1582661241384, -771.6521033677748, -770.5913338343424, -560.3132301075361, -664.500084210021, -823.8206583509998, -643.87232033823, -422.4467698617693, -758.3788329586012, -683.6410029940168, -1050.0830923782478, -714.5323413079711, -542.2370442241776, -708.6834966599782, -526.3516866049765, -519.6725368770785, -959.0094157729756, -794.6141100806169, -717.9127731029838, -546.5730213098454, -689.3024314572707, -684.9047195314457, -965.4251485365626, -860.6902099893744, -849.249808045342, -928.8780960984502, -533.9385147135721, -711.0544088742677, -889.7095797327539, -1011.5825192188363, -848.6993117931511, -533.1778889575806, -654.8578261426946, -970.0736250189459, -708.9593166589218, -801.3102885118361, -905.3342330150098, -890.079322695907, -552.6976151878957, -707.6135333104693, -868.2015979940194, -553.567288746659, -320.6031240664431, -603.7100690444422, -728.4999169102664, -856.7111150625428, -530.4646661252414, -960.7057113477946, -667.4174388010184, -853.6703722145295, -714.45120732419, -896.1297332283533, -490.98605790250696, -563.8762354425565, -815.8561166327121, -791.6210861201384, -775.4429801673118, -730.3022775051776, -972.2752830050244, -582.7407996606615, -1058.1805385841717, -654.2821590709123, -714.762250754641, -767.0760586107676, -604.4258405419961, -817.9703285588729, -292.21222727618317, -741.0783275251554, -770.8117765901958, -915.112603108096, -669.8805313490843, -367.4418885706997, -799.9827632094997, -519.8745072495046, -806.6498885469076, -867.4250403636132, -654.7518312941235, -840.0890404173158, -1203.1219602777874, -522.5329041512487, -881.3467784518417, -860.1609636150134], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.473503435829834, "mean_inference_ms": 0.4184219425007298, "mean_action_processing_ms": 0.09806569267314132, "mean_env_wait_ms": 2.8263382207366687, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00403904914855957, "StateBufferConnector_ms": 0.0029642581939697266, "ViewRequirementAgentConnector_ms": 0.07499003410339355}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 247800, "num_agent_steps_trained": 247800, "num_env_steps_sampled": 247800, "num_env_steps_trained": 247800, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.05645682395765, "num_env_steps_trained_throughput_per_sec": 40.05645682395765, "timesteps_total": 247800, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 247800, "timers": {"training_iteration_time_ms": 2982.346, "sample_time_ms": 2977.698, "load_time_ms": 0.281, "load_throughput": 427299.839, "learn_time_ms": 3.479, "learn_throughput": 34491.45, "synch_weights_time_ms": 0.818}, "counters": {"num_env_steps_sampled": 247800, "num_env_steps_trained": 247800, "num_agent_steps_sampled": 247800, "num_agent_steps_trained": 247800}, "done": false, "episodes_total": 2065, "training_iteration": 517, "trial_id": "53665_00000", "date": "2023-07-26_03-32-39", "timestamp": 1690331559, "time_this_iter_s": 11.986248970031738, "time_total_s": 6300.80505657196, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 679.4795806407928, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 43.4, "ram_util_percent": 79.32352941176471}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4866638183594, "policy_loss": -107328.9921875, "vf_loss": 5710914.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 231.0, "diff_num_grad_updates_vs_sampler_policy": 230.0}}, "num_env_steps_sampled": 248280, "num_env_steps_trained": 248280, "num_agent_steps_sampled": 248280, "num_agent_steps_trained": 248280}, "sampler_results": {"episode_reward_max": -292.21222727618317, "episode_reward_min": -1203.1219602777874, "episode_reward_mean": -725.7072743625744, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-614.2794320613347, -676.2066202764812, -655.6447688061047, -786.3142129325706, -748.214887257547, -717.5610314603733, -567.3208605917897, -795.1832736859715, -522.5236199172583, -641.873038589753, -772.9943629527012, -587.7437496369887, -654.6097072248673, -660.0811819240284, -840.1582661241384, -771.6521033677748, -770.5913338343424, -560.3132301075361, -664.500084210021, -823.8206583509998, -643.87232033823, -422.4467698617693, -758.3788329586012, -683.6410029940168, -1050.0830923782478, -714.5323413079711, -542.2370442241776, -708.6834966599782, -526.3516866049765, -519.6725368770785, -959.0094157729756, -794.6141100806169, -717.9127731029838, -546.5730213098454, -689.3024314572707, -684.9047195314457, -965.4251485365626, -860.6902099893744, -849.249808045342, -928.8780960984502, -533.9385147135721, -711.0544088742677, -889.7095797327539, -1011.5825192188363, -848.6993117931511, -533.1778889575806, -654.8578261426946, -970.0736250189459, -708.9593166589218, -801.3102885118361, -905.3342330150098, -890.079322695907, -552.6976151878957, -707.6135333104693, -868.2015979940194, -553.567288746659, -320.6031240664431, -603.7100690444422, -728.4999169102664, -856.7111150625428, -530.4646661252414, -960.7057113477946, -667.4174388010184, -853.6703722145295, -714.45120732419, -896.1297332283533, -490.98605790250696, -563.8762354425565, -815.8561166327121, -791.6210861201384, -775.4429801673118, -730.3022775051776, -972.2752830050244, -582.7407996606615, -1058.1805385841717, -654.2821590709123, -714.762250754641, -767.0760586107676, -604.4258405419961, -817.9703285588729, -292.21222727618317, -741.0783275251554, -770.8117765901958, -915.112603108096, -669.8805313490843, -367.4418885706997, -799.9827632094997, -519.8745072495046, -806.6498885469076, -867.4250403636132, -654.7518312941235, -840.0890404173158, -1203.1219602777874, -522.5329041512487, -881.3467784518417, -860.1609636150134, -766.1518735418813, -540.8527192722173, -697.6865161125108, -842.4997766372727], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.481900018523355, "mean_inference_ms": 0.4188528537053615, "mean_action_processing_ms": 0.09813233988327415, "mean_env_wait_ms": 2.8236717153653035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004019021987915039, "StateBufferConnector_ms": 0.0029697418212890625, "ViewRequirementAgentConnector_ms": 0.07494425773620605}}, "episode_reward_max": -292.21222727618317, "episode_reward_min": -1203.1219602777874, "episode_reward_mean": -725.7072743625744, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-614.2794320613347, -676.2066202764812, -655.6447688061047, -786.3142129325706, -748.214887257547, -717.5610314603733, -567.3208605917897, -795.1832736859715, -522.5236199172583, -641.873038589753, -772.9943629527012, -587.7437496369887, -654.6097072248673, -660.0811819240284, -840.1582661241384, -771.6521033677748, -770.5913338343424, -560.3132301075361, -664.500084210021, -823.8206583509998, -643.87232033823, -422.4467698617693, -758.3788329586012, -683.6410029940168, -1050.0830923782478, -714.5323413079711, -542.2370442241776, -708.6834966599782, -526.3516866049765, -519.6725368770785, -959.0094157729756, -794.6141100806169, -717.9127731029838, -546.5730213098454, -689.3024314572707, -684.9047195314457, -965.4251485365626, -860.6902099893744, -849.249808045342, -928.8780960984502, -533.9385147135721, -711.0544088742677, -889.7095797327539, -1011.5825192188363, -848.6993117931511, -533.1778889575806, -654.8578261426946, -970.0736250189459, -708.9593166589218, -801.3102885118361, -905.3342330150098, -890.079322695907, -552.6976151878957, -707.6135333104693, -868.2015979940194, -553.567288746659, -320.6031240664431, -603.7100690444422, -728.4999169102664, -856.7111150625428, -530.4646661252414, -960.7057113477946, -667.4174388010184, -853.6703722145295, -714.45120732419, -896.1297332283533, -490.98605790250696, -563.8762354425565, -815.8561166327121, -791.6210861201384, -775.4429801673118, -730.3022775051776, -972.2752830050244, -582.7407996606615, -1058.1805385841717, -654.2821590709123, -714.762250754641, -767.0760586107676, -604.4258405419961, -817.9703285588729, -292.21222727618317, -741.0783275251554, -770.8117765901958, -915.112603108096, -669.8805313490843, -367.4418885706997, -799.9827632094997, -519.8745072495046, -806.6498885469076, -867.4250403636132, -654.7518312941235, -840.0890404173158, -1203.1219602777874, -522.5329041512487, -881.3467784518417, -860.1609636150134, -766.1518735418813, -540.8527192722173, -697.6865161125108, -842.4997766372727], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.481900018523355, "mean_inference_ms": 0.4188528537053615, "mean_action_processing_ms": 0.09813233988327415, "mean_env_wait_ms": 2.8236717153653035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004019021987915039, "StateBufferConnector_ms": 0.0029697418212890625, "ViewRequirementAgentConnector_ms": 0.07494425773620605}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 248280, "num_agent_steps_trained": 248280, "num_env_steps_sampled": 248280, "num_env_steps_trained": 248280, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.454530712869, "num_env_steps_trained_throughput_per_sec": 40.454530712869, "timesteps_total": 248280, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 248280, "timers": {"training_iteration_time_ms": 3008.05, "sample_time_ms": 3003.396, "load_time_ms": 0.282, "load_throughput": 425062.478, "learn_time_ms": 3.481, "learn_throughput": 34469.718, "synch_weights_time_ms": 0.821}, "counters": {"num_env_steps_sampled": 248280, "num_env_steps_trained": 248280, "num_agent_steps_sampled": 248280, "num_agent_steps_trained": 248280}, "done": false, "episodes_total": 2069, "training_iteration": 518, "trial_id": "53665_00000", "date": "2023-07-26_03-32-51", "timestamp": 1690331571, "time_this_iter_s": 11.867781162261963, "time_total_s": 6312.672837734222, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 691.3473618030548, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 42.92352941176471, "ram_util_percent": 77.72941176470587}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.47705078125, "policy_loss": -115072.8671875, "vf_loss": 5720868.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 235.0, "diff_num_grad_updates_vs_sampler_policy": 234.0}}, "num_env_steps_sampled": 248760, "num_env_steps_trained": 248760, "num_agent_steps_sampled": 248760, "num_agent_steps_trained": 248760}, "sampler_results": {"episode_reward_max": -292.21222727618317, "episode_reward_min": -1203.1219602777874, "episode_reward_mean": -730.6015657409938, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-748.214887257547, -717.5610314603733, -567.3208605917897, -795.1832736859715, -522.5236199172583, -641.873038589753, -772.9943629527012, -587.7437496369887, -654.6097072248673, -660.0811819240284, -840.1582661241384, -771.6521033677748, -770.5913338343424, -560.3132301075361, -664.500084210021, -823.8206583509998, -643.87232033823, -422.4467698617693, -758.3788329586012, -683.6410029940168, -1050.0830923782478, -714.5323413079711, -542.2370442241776, -708.6834966599782, -526.3516866049765, -519.6725368770785, -959.0094157729756, -794.6141100806169, -717.9127731029838, -546.5730213098454, -689.3024314572707, -684.9047195314457, -965.4251485365626, -860.6902099893744, -849.249808045342, -928.8780960984502, -533.9385147135721, -711.0544088742677, -889.7095797327539, -1011.5825192188363, -848.6993117931511, -533.1778889575806, -654.8578261426946, -970.0736250189459, -708.9593166589218, -801.3102885118361, -905.3342330150098, -890.079322695907, -552.6976151878957, -707.6135333104693, -868.2015979940194, -553.567288746659, -320.6031240664431, -603.7100690444422, -728.4999169102664, -856.7111150625428, -530.4646661252414, -960.7057113477946, -667.4174388010184, -853.6703722145295, -714.45120732419, -896.1297332283533, -490.98605790250696, -563.8762354425565, -815.8561166327121, -791.6210861201384, -775.4429801673118, -730.3022775051776, -972.2752830050244, -582.7407996606615, -1058.1805385841717, -654.2821590709123, -714.762250754641, -767.0760586107676, -604.4258405419961, -817.9703285588729, -292.21222727618317, -741.0783275251554, -770.8117765901958, -915.112603108096, -669.8805313490843, -367.4418885706997, -799.9827632094997, -519.8745072495046, -806.6498885469076, -867.4250403636132, -654.7518312941235, -840.0890404173158, -1203.1219602777874, -522.5329041512487, -881.3467784518417, -860.1609636150134, -766.1518735418813, -540.8527192722173, -697.6865161125108, -842.4997766372727, -887.1778288513328, -953.0802454679492, -560.5160467973631, -821.1000508017892], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.490827918254936, "mean_inference_ms": 0.4192920746808228, "mean_action_processing_ms": 0.0982002963795434, "mean_env_wait_ms": 2.8211614325216936, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004021167755126953, "StateBufferConnector_ms": 0.0029702186584472656, "ViewRequirementAgentConnector_ms": 0.0749814510345459}}, "episode_reward_max": -292.21222727618317, "episode_reward_min": -1203.1219602777874, "episode_reward_mean": -730.6015657409938, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-748.214887257547, -717.5610314603733, -567.3208605917897, -795.1832736859715, -522.5236199172583, -641.873038589753, -772.9943629527012, -587.7437496369887, -654.6097072248673, -660.0811819240284, -840.1582661241384, -771.6521033677748, -770.5913338343424, -560.3132301075361, -664.500084210021, -823.8206583509998, -643.87232033823, -422.4467698617693, -758.3788329586012, -683.6410029940168, -1050.0830923782478, -714.5323413079711, -542.2370442241776, -708.6834966599782, -526.3516866049765, -519.6725368770785, -959.0094157729756, -794.6141100806169, -717.9127731029838, -546.5730213098454, -689.3024314572707, -684.9047195314457, -965.4251485365626, -860.6902099893744, -849.249808045342, -928.8780960984502, -533.9385147135721, -711.0544088742677, -889.7095797327539, -1011.5825192188363, -848.6993117931511, -533.1778889575806, -654.8578261426946, -970.0736250189459, -708.9593166589218, -801.3102885118361, -905.3342330150098, -890.079322695907, -552.6976151878957, -707.6135333104693, -868.2015979940194, -553.567288746659, -320.6031240664431, -603.7100690444422, -728.4999169102664, -856.7111150625428, -530.4646661252414, -960.7057113477946, -667.4174388010184, -853.6703722145295, -714.45120732419, -896.1297332283533, -490.98605790250696, -563.8762354425565, -815.8561166327121, -791.6210861201384, -775.4429801673118, -730.3022775051776, -972.2752830050244, -582.7407996606615, -1058.1805385841717, -654.2821590709123, -714.762250754641, -767.0760586107676, -604.4258405419961, -817.9703285588729, -292.21222727618317, -741.0783275251554, -770.8117765901958, -915.112603108096, -669.8805313490843, -367.4418885706997, -799.9827632094997, -519.8745072495046, -806.6498885469076, -867.4250403636132, -654.7518312941235, -840.0890404173158, -1203.1219602777874, -522.5329041512487, -881.3467784518417, -860.1609636150134, -766.1518735418813, -540.8527192722173, -697.6865161125108, -842.4997766372727, -887.1778288513328, -953.0802454679492, -560.5160467973631, -821.1000508017892], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.490827918254936, "mean_inference_ms": 0.4192920746808228, "mean_action_processing_ms": 0.0982002963795434, "mean_env_wait_ms": 2.8211614325216936, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004021167755126953, "StateBufferConnector_ms": 0.0029702186584472656, "ViewRequirementAgentConnector_ms": 0.0749814510345459}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 248760, "num_agent_steps_trained": 248760, "num_env_steps_sampled": 248760, "num_env_steps_trained": 248760, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.74740254945875, "num_env_steps_trained_throughput_per_sec": 40.74740254945875, "timesteps_total": 248760, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 248760, "timers": {"training_iteration_time_ms": 2971.242, "sample_time_ms": 2967.159, "load_time_ms": 0.232, "load_throughput": 518295.212, "learn_time_ms": 3.066, "learn_throughput": 39145.141, "synch_weights_time_ms": 0.74}, "counters": {"num_env_steps_sampled": 248760, "num_env_steps_trained": 248760, "num_agent_steps_sampled": 248760, "num_agent_steps_trained": 248760}, "done": false, "episodes_total": 2073, "training_iteration": 519, "trial_id": "53665_00000", "date": "2023-07-26_03-33-03", "timestamp": 1690331583, "time_this_iter_s": 11.783237934112549, "time_total_s": 6324.456075668335, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 703.1305997371674, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 36.51764705882353, "ram_util_percent": 78.85882352941177}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.482421875, "policy_loss": -75607.1875, "vf_loss": 2648058.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 239.0, "diff_num_grad_updates_vs_sampler_policy": 238.0}}, "num_env_steps_sampled": 249240, "num_env_steps_trained": 249240, "num_agent_steps_sampled": 249240, "num_agent_steps_trained": 249240}, "sampler_results": {"episode_reward_max": -292.21222727618317, "episode_reward_min": -1203.1219602777874, "episode_reward_mean": -729.8497069213014, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-522.5236199172583, -641.873038589753, -772.9943629527012, -587.7437496369887, -654.6097072248673, -660.0811819240284, -840.1582661241384, -771.6521033677748, -770.5913338343424, -560.3132301075361, -664.500084210021, -823.8206583509998, -643.87232033823, -422.4467698617693, -758.3788329586012, -683.6410029940168, -1050.0830923782478, -714.5323413079711, -542.2370442241776, -708.6834966599782, -526.3516866049765, -519.6725368770785, -959.0094157729756, -794.6141100806169, -717.9127731029838, -546.5730213098454, -689.3024314572707, -684.9047195314457, -965.4251485365626, -860.6902099893744, -849.249808045342, -928.8780960984502, -533.9385147135721, -711.0544088742677, -889.7095797327539, -1011.5825192188363, -848.6993117931511, -533.1778889575806, -654.8578261426946, -970.0736250189459, -708.9593166589218, -801.3102885118361, -905.3342330150098, -890.079322695907, -552.6976151878957, -707.6135333104693, -868.2015979940194, -553.567288746659, -320.6031240664431, -603.7100690444422, -728.4999169102664, -856.7111150625428, -530.4646661252414, -960.7057113477946, -667.4174388010184, -853.6703722145295, -714.45120732419, -896.1297332283533, -490.98605790250696, -563.8762354425565, -815.8561166327121, -791.6210861201384, -775.4429801673118, -730.3022775051776, -972.2752830050244, -582.7407996606615, -1058.1805385841717, -654.2821590709123, -714.762250754641, -767.0760586107676, -604.4258405419961, -817.9703285588729, -292.21222727618317, -741.0783275251554, -770.8117765901958, -915.112603108096, -669.8805313490843, -367.4418885706997, -799.9827632094997, -519.8745072495046, -806.6498885469076, -867.4250403636132, -654.7518312941235, -840.0890404173158, -1203.1219602777874, -522.5329041512487, -881.3467784518417, -860.1609636150134, -766.1518735418813, -540.8527192722173, -697.6865161125108, -842.4997766372727, -887.1778288513328, -953.0802454679492, -560.5160467973631, -821.1000508017892, -709.0977696137401, -672.5917323197915, -810.2125900542125, -561.1920790386728], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.49987345877764, "mean_inference_ms": 0.41971851382177805, "mean_action_processing_ms": 0.09826612803834003, "mean_env_wait_ms": 2.81893041687743, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004019737243652344, "StateBufferConnector_ms": 0.0029726028442382812, "ViewRequirementAgentConnector_ms": 0.07495689392089844}}, "episode_reward_max": -292.21222727618317, "episode_reward_min": -1203.1219602777874, "episode_reward_mean": -729.8497069213014, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-522.5236199172583, -641.873038589753, -772.9943629527012, -587.7437496369887, -654.6097072248673, -660.0811819240284, -840.1582661241384, -771.6521033677748, -770.5913338343424, -560.3132301075361, -664.500084210021, -823.8206583509998, -643.87232033823, -422.4467698617693, -758.3788329586012, -683.6410029940168, -1050.0830923782478, -714.5323413079711, -542.2370442241776, -708.6834966599782, -526.3516866049765, -519.6725368770785, -959.0094157729756, -794.6141100806169, -717.9127731029838, -546.5730213098454, -689.3024314572707, -684.9047195314457, -965.4251485365626, -860.6902099893744, -849.249808045342, -928.8780960984502, -533.9385147135721, -711.0544088742677, -889.7095797327539, -1011.5825192188363, -848.6993117931511, -533.1778889575806, -654.8578261426946, -970.0736250189459, -708.9593166589218, -801.3102885118361, -905.3342330150098, -890.079322695907, -552.6976151878957, -707.6135333104693, -868.2015979940194, -553.567288746659, -320.6031240664431, -603.7100690444422, -728.4999169102664, -856.7111150625428, -530.4646661252414, -960.7057113477946, -667.4174388010184, -853.6703722145295, -714.45120732419, -896.1297332283533, -490.98605790250696, -563.8762354425565, -815.8561166327121, -791.6210861201384, -775.4429801673118, -730.3022775051776, -972.2752830050244, -582.7407996606615, -1058.1805385841717, -654.2821590709123, -714.762250754641, -767.0760586107676, -604.4258405419961, -817.9703285588729, -292.21222727618317, -741.0783275251554, -770.8117765901958, -915.112603108096, -669.8805313490843, -367.4418885706997, -799.9827632094997, -519.8745072495046, -806.6498885469076, -867.4250403636132, -654.7518312941235, -840.0890404173158, -1203.1219602777874, -522.5329041512487, -881.3467784518417, -860.1609636150134, -766.1518735418813, -540.8527192722173, -697.6865161125108, -842.4997766372727, -887.1778288513328, -953.0802454679492, -560.5160467973631, -821.1000508017892, -709.0977696137401, -672.5917323197915, -810.2125900542125, -561.1920790386728], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.49987345877764, "mean_inference_ms": 0.41971851382177805, "mean_action_processing_ms": 0.09826612803834003, "mean_env_wait_ms": 2.81893041687743, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004019737243652344, "StateBufferConnector_ms": 0.0029726028442382812, "ViewRequirementAgentConnector_ms": 0.07495689392089844}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 249240, "num_agent_steps_trained": 249240, "num_env_steps_sampled": 249240, "num_env_steps_trained": 249240, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.78777554297404, "num_env_steps_trained_throughput_per_sec": 40.78777554297404, "timesteps_total": 249240, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 249240, "timers": {"training_iteration_time_ms": 2920.933, "sample_time_ms": 2916.979, "load_time_ms": 0.233, "load_throughput": 516010.334, "learn_time_ms": 2.95, "learn_throughput": 40678.942, "synch_weights_time_ms": 0.727}, "counters": {"num_env_steps_sampled": 249240, "num_env_steps_trained": 249240, "num_agent_steps_sampled": 249240, "num_agent_steps_trained": 249240}, "done": false, "episodes_total": 2077, "training_iteration": 520, "trial_id": "53665_00000", "date": "2023-07-26_03-33-15", "timestamp": 1690331595, "time_this_iter_s": 11.771151065826416, "time_total_s": 6336.227226734161, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 714.9017508029938, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 43.24117647058824, "ram_util_percent": 77.8941176470588}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4842529296875, "policy_loss": -98748.203125, "vf_loss": 4072660.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 243.0, "diff_num_grad_updates_vs_sampler_policy": 242.0}}, "num_env_steps_sampled": 249720, "num_env_steps_trained": 249720, "num_agent_steps_sampled": 249720, "num_agent_steps_trained": 249720}, "sampler_results": {"episode_reward_max": -292.21222727618317, "episode_reward_min": -1203.1219602777874, "episode_reward_mean": -740.4579435045238, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-654.6097072248673, -660.0811819240284, -840.1582661241384, -771.6521033677748, -770.5913338343424, -560.3132301075361, -664.500084210021, -823.8206583509998, -643.87232033823, -422.4467698617693, -758.3788329586012, -683.6410029940168, -1050.0830923782478, -714.5323413079711, -542.2370442241776, -708.6834966599782, -526.3516866049765, -519.6725368770785, -959.0094157729756, -794.6141100806169, -717.9127731029838, -546.5730213098454, -689.3024314572707, -684.9047195314457, -965.4251485365626, -860.6902099893744, -849.249808045342, -928.8780960984502, -533.9385147135721, -711.0544088742677, -889.7095797327539, -1011.5825192188363, -848.6993117931511, -533.1778889575806, -654.8578261426946, -970.0736250189459, -708.9593166589218, -801.3102885118361, -905.3342330150098, -890.079322695907, -552.6976151878957, -707.6135333104693, -868.2015979940194, -553.567288746659, -320.6031240664431, -603.7100690444422, -728.4999169102664, -856.7111150625428, -530.4646661252414, -960.7057113477946, -667.4174388010184, -853.6703722145295, -714.45120732419, -896.1297332283533, -490.98605790250696, -563.8762354425565, -815.8561166327121, -791.6210861201384, -775.4429801673118, -730.3022775051776, -972.2752830050244, -582.7407996606615, -1058.1805385841717, -654.2821590709123, -714.762250754641, -767.0760586107676, -604.4258405419961, -817.9703285588729, -292.21222727618317, -741.0783275251554, -770.8117765901958, -915.112603108096, -669.8805313490843, -367.4418885706997, -799.9827632094997, -519.8745072495046, -806.6498885469076, -867.4250403636132, -654.7518312941235, -840.0890404173158, -1203.1219602777874, -522.5329041512487, -881.3467784518417, -860.1609636150134, -766.1518735418813, -540.8527192722173, -697.6865161125108, -842.4997766372727, -887.1778288513328, -953.0802454679492, -560.5160467973631, -821.1000508017892, -709.0977696137401, -672.5917323197915, -810.2125900542125, -561.1920790386728, -906.3649642823498, -1196.7773023427235, -798.4709598097372, -684.3452029841236], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.50764598834251, "mean_inference_ms": 0.42012276951967337, "mean_action_processing_ms": 0.09832872126883743, "mean_env_wait_ms": 2.816663513559224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040209293365478516, "StateBufferConnector_ms": 0.002970457077026367, "ViewRequirementAgentConnector_ms": 0.0749974250793457}}, "episode_reward_max": -292.21222727618317, "episode_reward_min": -1203.1219602777874, "episode_reward_mean": -740.4579435045238, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-654.6097072248673, -660.0811819240284, -840.1582661241384, -771.6521033677748, -770.5913338343424, -560.3132301075361, -664.500084210021, -823.8206583509998, -643.87232033823, -422.4467698617693, -758.3788329586012, -683.6410029940168, -1050.0830923782478, -714.5323413079711, -542.2370442241776, -708.6834966599782, -526.3516866049765, -519.6725368770785, -959.0094157729756, -794.6141100806169, -717.9127731029838, -546.5730213098454, -689.3024314572707, -684.9047195314457, -965.4251485365626, -860.6902099893744, -849.249808045342, -928.8780960984502, -533.9385147135721, -711.0544088742677, -889.7095797327539, -1011.5825192188363, -848.6993117931511, -533.1778889575806, -654.8578261426946, -970.0736250189459, -708.9593166589218, -801.3102885118361, -905.3342330150098, -890.079322695907, -552.6976151878957, -707.6135333104693, -868.2015979940194, -553.567288746659, -320.6031240664431, -603.7100690444422, -728.4999169102664, -856.7111150625428, -530.4646661252414, -960.7057113477946, -667.4174388010184, -853.6703722145295, -714.45120732419, -896.1297332283533, -490.98605790250696, -563.8762354425565, -815.8561166327121, -791.6210861201384, -775.4429801673118, -730.3022775051776, -972.2752830050244, -582.7407996606615, -1058.1805385841717, -654.2821590709123, -714.762250754641, -767.0760586107676, -604.4258405419961, -817.9703285588729, -292.21222727618317, -741.0783275251554, -770.8117765901958, -915.112603108096, -669.8805313490843, -367.4418885706997, -799.9827632094997, -519.8745072495046, -806.6498885469076, -867.4250403636132, -654.7518312941235, -840.0890404173158, -1203.1219602777874, -522.5329041512487, -881.3467784518417, -860.1609636150134, -766.1518735418813, -540.8527192722173, -697.6865161125108, -842.4997766372727, -887.1778288513328, -953.0802454679492, -560.5160467973631, -821.1000508017892, -709.0977696137401, -672.5917323197915, -810.2125900542125, -561.1920790386728, -906.3649642823498, -1196.7773023427235, -798.4709598097372, -684.3452029841236], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.50764598834251, "mean_inference_ms": 0.42012276951967337, "mean_action_processing_ms": 0.09832872126883743, "mean_env_wait_ms": 2.816663513559224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040209293365478516, "StateBufferConnector_ms": 0.002970457077026367, "ViewRequirementAgentConnector_ms": 0.0749974250793457}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 249720, "num_agent_steps_trained": 249720, "num_env_steps_sampled": 249720, "num_env_steps_trained": 249720, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.6529680288768, "num_env_steps_trained_throughput_per_sec": 40.6529680288768, "timesteps_total": 249720, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 249720, "timers": {"training_iteration_time_ms": 2952.404, "sample_time_ms": 2948.399, "load_time_ms": 0.233, "load_throughput": 514691.155, "learn_time_ms": 2.982, "learn_throughput": 40235.062, "synch_weights_time_ms": 0.743}, "counters": {"num_env_steps_sampled": 249720, "num_env_steps_trained": 249720, "num_agent_steps_sampled": 249720, "num_agent_steps_trained": 249720}, "done": false, "episodes_total": 2081, "training_iteration": 521, "trial_id": "53665_00000", "date": "2023-07-26_03-33-27", "timestamp": 1690331607, "time_this_iter_s": 11.810038089752197, "time_total_s": 6348.037264823914, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 726.711788892746, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 37.54705882352942, "ram_util_percent": 79.15294117647058}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4918212890625, "policy_loss": -45871.48828125, "vf_loss": 1282180.125}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 247.0, "diff_num_grad_updates_vs_sampler_policy": 246.0}}, "num_env_steps_sampled": 250200, "num_env_steps_trained": 250200, "num_agent_steps_sampled": 250200, "num_agent_steps_trained": 250200}, "sampler_results": {"episode_reward_max": -292.21222727618317, "episode_reward_min": -1203.1219602777874, "episode_reward_mean": -738.5543255991096, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-770.5913338343424, -560.3132301075361, -664.500084210021, -823.8206583509998, -643.87232033823, -422.4467698617693, -758.3788329586012, -683.6410029940168, -1050.0830923782478, -714.5323413079711, -542.2370442241776, -708.6834966599782, -526.3516866049765, -519.6725368770785, -959.0094157729756, -794.6141100806169, -717.9127731029838, -546.5730213098454, -689.3024314572707, -684.9047195314457, -965.4251485365626, -860.6902099893744, -849.249808045342, -928.8780960984502, -533.9385147135721, -711.0544088742677, -889.7095797327539, -1011.5825192188363, -848.6993117931511, -533.1778889575806, -654.8578261426946, -970.0736250189459, -708.9593166589218, -801.3102885118361, -905.3342330150098, -890.079322695907, -552.6976151878957, -707.6135333104693, -868.2015979940194, -553.567288746659, -320.6031240664431, -603.7100690444422, -728.4999169102664, -856.7111150625428, -530.4646661252414, -960.7057113477946, -667.4174388010184, -853.6703722145295, -714.45120732419, -896.1297332283533, -490.98605790250696, -563.8762354425565, -815.8561166327121, -791.6210861201384, -775.4429801673118, -730.3022775051776, -972.2752830050244, -582.7407996606615, -1058.1805385841717, -654.2821590709123, -714.762250754641, -767.0760586107676, -604.4258405419961, -817.9703285588729, -292.21222727618317, -741.0783275251554, -770.8117765901958, -915.112603108096, -669.8805313490843, -367.4418885706997, -799.9827632094997, -519.8745072495046, -806.6498885469076, -867.4250403636132, -654.7518312941235, -840.0890404173158, -1203.1219602777874, -522.5329041512487, -881.3467784518417, -860.1609636150134, -766.1518735418813, -540.8527192722173, -697.6865161125108, -842.4997766372727, -887.1778288513328, -953.0802454679492, -560.5160467973631, -821.1000508017892, -709.0977696137401, -672.5917323197915, -810.2125900542125, -561.1920790386728, -906.3649642823498, -1196.7773023427235, -798.4709598097372, -684.3452029841236, -782.3556538846735, -888.5636672899157, -601.5650805563787, -463.65506636846624], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.514719295066342, "mean_inference_ms": 0.42047733684236605, "mean_action_processing_ms": 0.09839299447148894, "mean_env_wait_ms": 2.8145693757007075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004047393798828125, "StateBufferConnector_ms": 0.00299072265625, "ViewRequirementAgentConnector_ms": 0.07539248466491699}}, "episode_reward_max": -292.21222727618317, "episode_reward_min": -1203.1219602777874, "episode_reward_mean": -738.5543255991096, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-770.5913338343424, -560.3132301075361, -664.500084210021, -823.8206583509998, -643.87232033823, -422.4467698617693, -758.3788329586012, -683.6410029940168, -1050.0830923782478, -714.5323413079711, -542.2370442241776, -708.6834966599782, -526.3516866049765, -519.6725368770785, -959.0094157729756, -794.6141100806169, -717.9127731029838, -546.5730213098454, -689.3024314572707, -684.9047195314457, -965.4251485365626, -860.6902099893744, -849.249808045342, -928.8780960984502, -533.9385147135721, -711.0544088742677, -889.7095797327539, -1011.5825192188363, -848.6993117931511, -533.1778889575806, -654.8578261426946, -970.0736250189459, -708.9593166589218, -801.3102885118361, -905.3342330150098, -890.079322695907, -552.6976151878957, -707.6135333104693, -868.2015979940194, -553.567288746659, -320.6031240664431, -603.7100690444422, -728.4999169102664, -856.7111150625428, -530.4646661252414, -960.7057113477946, -667.4174388010184, -853.6703722145295, -714.45120732419, -896.1297332283533, -490.98605790250696, -563.8762354425565, -815.8561166327121, -791.6210861201384, -775.4429801673118, -730.3022775051776, -972.2752830050244, -582.7407996606615, -1058.1805385841717, -654.2821590709123, -714.762250754641, -767.0760586107676, -604.4258405419961, -817.9703285588729, -292.21222727618317, -741.0783275251554, -770.8117765901958, -915.112603108096, -669.8805313490843, -367.4418885706997, -799.9827632094997, -519.8745072495046, -806.6498885469076, -867.4250403636132, -654.7518312941235, -840.0890404173158, -1203.1219602777874, -522.5329041512487, -881.3467784518417, -860.1609636150134, -766.1518735418813, -540.8527192722173, -697.6865161125108, -842.4997766372727, -887.1778288513328, -953.0802454679492, -560.5160467973631, -821.1000508017892, -709.0977696137401, -672.5917323197915, -810.2125900542125, -561.1920790386728, -906.3649642823498, -1196.7773023427235, -798.4709598097372, -684.3452029841236, -782.3556538846735, -888.5636672899157, -601.5650805563787, -463.65506636846624], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.514719295066342, "mean_inference_ms": 0.42047733684236605, "mean_action_processing_ms": 0.09839299447148894, "mean_env_wait_ms": 2.8145693757007075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004047393798828125, "StateBufferConnector_ms": 0.00299072265625, "ViewRequirementAgentConnector_ms": 0.07539248466491699}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 250200, "num_agent_steps_trained": 250200, "num_env_steps_sampled": 250200, "num_env_steps_trained": 250200, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.77519509894153, "num_env_steps_trained_throughput_per_sec": 41.77519509894153, "timesteps_total": 250200, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 250200, "timers": {"training_iteration_time_ms": 2923.497, "sample_time_ms": 2919.585, "load_time_ms": 0.228, "load_throughput": 527364.292, "learn_time_ms": 2.901, "learn_throughput": 41364.965, "synch_weights_time_ms": 0.742}, "counters": {"num_env_steps_sampled": 250200, "num_env_steps_trained": 250200, "num_agent_steps_sampled": 250200, "num_agent_steps_trained": 250200}, "done": false, "episodes_total": 2085, "training_iteration": 522, "trial_id": "53665_00000", "date": "2023-07-26_03-33-38", "timestamp": 1690331618, "time_this_iter_s": 11.493054866790771, "time_total_s": 6359.530319690704, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 738.2048437595367, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 39.81875, "ram_util_percent": 78.625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.489501953125, "policy_loss": -125783.9296875, "vf_loss": 6256834.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 251.0, "diff_num_grad_updates_vs_sampler_policy": 250.0}}, "num_env_steps_sampled": 250680, "num_env_steps_trained": 250680, "num_agent_steps_sampled": 250680, "num_agent_steps_trained": 250680}, "sampler_results": {"episode_reward_max": -292.21222727618317, "episode_reward_min": -1203.1219602777874, "episode_reward_mean": -734.2051166604791, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-643.87232033823, -422.4467698617693, -758.3788329586012, -683.6410029940168, -1050.0830923782478, -714.5323413079711, -542.2370442241776, -708.6834966599782, -526.3516866049765, -519.6725368770785, -959.0094157729756, -794.6141100806169, -717.9127731029838, -546.5730213098454, -689.3024314572707, -684.9047195314457, -965.4251485365626, -860.6902099893744, -849.249808045342, -928.8780960984502, -533.9385147135721, -711.0544088742677, -889.7095797327539, -1011.5825192188363, -848.6993117931511, -533.1778889575806, -654.8578261426946, -970.0736250189459, -708.9593166589218, -801.3102885118361, -905.3342330150098, -890.079322695907, -552.6976151878957, -707.6135333104693, -868.2015979940194, -553.567288746659, -320.6031240664431, -603.7100690444422, -728.4999169102664, -856.7111150625428, -530.4646661252414, -960.7057113477946, -667.4174388010184, -853.6703722145295, -714.45120732419, -896.1297332283533, -490.98605790250696, -563.8762354425565, -815.8561166327121, -791.6210861201384, -775.4429801673118, -730.3022775051776, -972.2752830050244, -582.7407996606615, -1058.1805385841717, -654.2821590709123, -714.762250754641, -767.0760586107676, -604.4258405419961, -817.9703285588729, -292.21222727618317, -741.0783275251554, -770.8117765901958, -915.112603108096, -669.8805313490843, -367.4418885706997, -799.9827632094997, -519.8745072495046, -806.6498885469076, -867.4250403636132, -654.7518312941235, -840.0890404173158, -1203.1219602777874, -522.5329041512487, -881.3467784518417, -860.1609636150134, -766.1518735418813, -540.8527192722173, -697.6865161125108, -842.4997766372727, -887.1778288513328, -953.0802454679492, -560.5160467973631, -821.1000508017892, -709.0977696137401, -672.5917323197915, -810.2125900542125, -561.1920790386728, -906.3649642823498, -1196.7773023427235, -798.4709598097372, -684.3452029841236, -782.3556538846735, -888.5636672899157, -601.5650805563787, -463.65506636846624, -416.1390728793751, -512.2823976150429, -598.093883976555, -857.7890581688563], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.521064232164427, "mean_inference_ms": 0.4208242773306505, "mean_action_processing_ms": 0.09845626314425891, "mean_env_wait_ms": 2.812591984691135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040705204010009766, "StateBufferConnector_ms": 0.00299835205078125, "ViewRequirementAgentConnector_ms": 0.0756685733795166}}, "episode_reward_max": -292.21222727618317, "episode_reward_min": -1203.1219602777874, "episode_reward_mean": -734.2051166604791, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-643.87232033823, -422.4467698617693, -758.3788329586012, -683.6410029940168, -1050.0830923782478, -714.5323413079711, -542.2370442241776, -708.6834966599782, -526.3516866049765, -519.6725368770785, -959.0094157729756, -794.6141100806169, -717.9127731029838, -546.5730213098454, -689.3024314572707, -684.9047195314457, -965.4251485365626, -860.6902099893744, -849.249808045342, -928.8780960984502, -533.9385147135721, -711.0544088742677, -889.7095797327539, -1011.5825192188363, -848.6993117931511, -533.1778889575806, -654.8578261426946, -970.0736250189459, -708.9593166589218, -801.3102885118361, -905.3342330150098, -890.079322695907, -552.6976151878957, -707.6135333104693, -868.2015979940194, -553.567288746659, -320.6031240664431, -603.7100690444422, -728.4999169102664, -856.7111150625428, -530.4646661252414, -960.7057113477946, -667.4174388010184, -853.6703722145295, -714.45120732419, -896.1297332283533, -490.98605790250696, -563.8762354425565, -815.8561166327121, -791.6210861201384, -775.4429801673118, -730.3022775051776, -972.2752830050244, -582.7407996606615, -1058.1805385841717, -654.2821590709123, -714.762250754641, -767.0760586107676, -604.4258405419961, -817.9703285588729, -292.21222727618317, -741.0783275251554, -770.8117765901958, -915.112603108096, -669.8805313490843, -367.4418885706997, -799.9827632094997, -519.8745072495046, -806.6498885469076, -867.4250403636132, -654.7518312941235, -840.0890404173158, -1203.1219602777874, -522.5329041512487, -881.3467784518417, -860.1609636150134, -766.1518735418813, -540.8527192722173, -697.6865161125108, -842.4997766372727, -887.1778288513328, -953.0802454679492, -560.5160467973631, -821.1000508017892, -709.0977696137401, -672.5917323197915, -810.2125900542125, -561.1920790386728, -906.3649642823498, -1196.7773023427235, -798.4709598097372, -684.3452029841236, -782.3556538846735, -888.5636672899157, -601.5650805563787, -463.65506636846624, -416.1390728793751, -512.2823976150429, -598.093883976555, -857.7890581688563], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.521064232164427, "mean_inference_ms": 0.4208242773306505, "mean_action_processing_ms": 0.09845626314425891, "mean_env_wait_ms": 2.812591984691135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040705204010009766, "StateBufferConnector_ms": 0.00299835205078125, "ViewRequirementAgentConnector_ms": 0.0756685733795166}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 250680, "num_agent_steps_trained": 250680, "num_env_steps_sampled": 250680, "num_env_steps_trained": 250680, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.907053191135724, "num_env_steps_trained_throughput_per_sec": 41.907053191135724, "timesteps_total": 250680, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 250680, "timers": {"training_iteration_time_ms": 2889.014, "sample_time_ms": 2885.12, "load_time_ms": 0.226, "load_throughput": 531485.195, "learn_time_ms": 2.893, "learn_throughput": 41475.747, "synch_weights_time_ms": 0.734}, "counters": {"num_env_steps_sampled": 250680, "num_env_steps_trained": 250680, "num_agent_steps_sampled": 250680, "num_agent_steps_trained": 250680}, "done": false, "episodes_total": 2089, "training_iteration": 523, "trial_id": "53665_00000", "date": "2023-07-26_03-33-50", "timestamp": 1690331630, "time_this_iter_s": 11.456664085388184, "time_total_s": 6370.9869837760925, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 749.6615078449249, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 38.4375, "ram_util_percent": 76.8375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4990234375, "policy_loss": -109226.9765625, "vf_loss": 4934014.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 255.0, "diff_num_grad_updates_vs_sampler_policy": 254.0}}, "num_env_steps_sampled": 251160, "num_env_steps_trained": 251160, "num_agent_steps_sampled": 251160, "num_agent_steps_trained": 251160}, "sampler_results": {"episode_reward_max": -292.21222727618317, "episode_reward_min": -1203.1219602777874, "episode_reward_mean": -745.858992275771, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1050.0830923782478, -714.5323413079711, -542.2370442241776, -708.6834966599782, -526.3516866049765, -519.6725368770785, -959.0094157729756, -794.6141100806169, -717.9127731029838, -546.5730213098454, -689.3024314572707, -684.9047195314457, -965.4251485365626, -860.6902099893744, -849.249808045342, -928.8780960984502, -533.9385147135721, -711.0544088742677, -889.7095797327539, -1011.5825192188363, -848.6993117931511, -533.1778889575806, -654.8578261426946, -970.0736250189459, -708.9593166589218, -801.3102885118361, -905.3342330150098, -890.079322695907, -552.6976151878957, -707.6135333104693, -868.2015979940194, -553.567288746659, -320.6031240664431, -603.7100690444422, -728.4999169102664, -856.7111150625428, -530.4646661252414, -960.7057113477946, -667.4174388010184, -853.6703722145295, -714.45120732419, -896.1297332283533, -490.98605790250696, -563.8762354425565, -815.8561166327121, -791.6210861201384, -775.4429801673118, -730.3022775051776, -972.2752830050244, -582.7407996606615, -1058.1805385841717, -654.2821590709123, -714.762250754641, -767.0760586107676, -604.4258405419961, -817.9703285588729, -292.21222727618317, -741.0783275251554, -770.8117765901958, -915.112603108096, -669.8805313490843, -367.4418885706997, -799.9827632094997, -519.8745072495046, -806.6498885469076, -867.4250403636132, -654.7518312941235, -840.0890404173158, -1203.1219602777874, -522.5329041512487, -881.3467784518417, -860.1609636150134, -766.1518735418813, -540.8527192722173, -697.6865161125108, -842.4997766372727, -887.1778288513328, -953.0802454679492, -560.5160467973631, -821.1000508017892, -709.0977696137401, -672.5917323197915, -810.2125900542125, -561.1920790386728, -906.3649642823498, -1196.7773023427235, -798.4709598097372, -684.3452029841236, -782.3556538846735, -888.5636672899157, -601.5650805563787, -463.65506636846624, -416.1390728793751, -512.2823976150429, -598.093883976555, -857.7890581688563, -920.7751702909966, -1060.0094418113433, -985.8165647448916, -707.1253108345709], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.52653298282347, "mean_inference_ms": 0.42112860773545563, "mean_action_processing_ms": 0.0985117965979384, "mean_env_wait_ms": 2.8107424286723868, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004053831100463867, "StateBufferConnector_ms": 0.0030002593994140625, "ViewRequirementAgentConnector_ms": 0.07546591758728027}}, "episode_reward_max": -292.21222727618317, "episode_reward_min": -1203.1219602777874, "episode_reward_mean": -745.858992275771, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1050.0830923782478, -714.5323413079711, -542.2370442241776, -708.6834966599782, -526.3516866049765, -519.6725368770785, -959.0094157729756, -794.6141100806169, -717.9127731029838, -546.5730213098454, -689.3024314572707, -684.9047195314457, -965.4251485365626, -860.6902099893744, -849.249808045342, -928.8780960984502, -533.9385147135721, -711.0544088742677, -889.7095797327539, -1011.5825192188363, -848.6993117931511, -533.1778889575806, -654.8578261426946, -970.0736250189459, -708.9593166589218, -801.3102885118361, -905.3342330150098, -890.079322695907, -552.6976151878957, -707.6135333104693, -868.2015979940194, -553.567288746659, -320.6031240664431, -603.7100690444422, -728.4999169102664, -856.7111150625428, -530.4646661252414, -960.7057113477946, -667.4174388010184, -853.6703722145295, -714.45120732419, -896.1297332283533, -490.98605790250696, -563.8762354425565, -815.8561166327121, -791.6210861201384, -775.4429801673118, -730.3022775051776, -972.2752830050244, -582.7407996606615, -1058.1805385841717, -654.2821590709123, -714.762250754641, -767.0760586107676, -604.4258405419961, -817.9703285588729, -292.21222727618317, -741.0783275251554, -770.8117765901958, -915.112603108096, -669.8805313490843, -367.4418885706997, -799.9827632094997, -519.8745072495046, -806.6498885469076, -867.4250403636132, -654.7518312941235, -840.0890404173158, -1203.1219602777874, -522.5329041512487, -881.3467784518417, -860.1609636150134, -766.1518735418813, -540.8527192722173, -697.6865161125108, -842.4997766372727, -887.1778288513328, -953.0802454679492, -560.5160467973631, -821.1000508017892, -709.0977696137401, -672.5917323197915, -810.2125900542125, -561.1920790386728, -906.3649642823498, -1196.7773023427235, -798.4709598097372, -684.3452029841236, -782.3556538846735, -888.5636672899157, -601.5650805563787, -463.65506636846624, -416.1390728793751, -512.2823976150429, -598.093883976555, -857.7890581688563, -920.7751702909966, -1060.0094418113433, -985.8165647448916, -707.1253108345709], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.52653298282347, "mean_inference_ms": 0.42112860773545563, "mean_action_processing_ms": 0.0985117965979384, "mean_env_wait_ms": 2.8107424286723868, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004053831100463867, "StateBufferConnector_ms": 0.0030002593994140625, "ViewRequirementAgentConnector_ms": 0.07546591758728027}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 251160, "num_agent_steps_trained": 251160, "num_env_steps_sampled": 251160, "num_env_steps_trained": 251160, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.02291983806869, "num_env_steps_trained_throughput_per_sec": 41.02291983806869, "timesteps_total": 251160, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 251160, "timers": {"training_iteration_time_ms": 2892.587, "sample_time_ms": 2888.816, "load_time_ms": 0.219, "load_throughput": 548693.426, "learn_time_ms": 2.811, "learn_throughput": 42696.636, "synch_weights_time_ms": 0.703}, "counters": {"num_env_steps_sampled": 251160, "num_env_steps_trained": 251160, "num_agent_steps_sampled": 251160, "num_agent_steps_trained": 251160}, "done": false, "episodes_total": 2093, "training_iteration": 524, "trial_id": "53665_00000", "date": "2023-07-26_03-34-01", "timestamp": 1690331641, "time_this_iter_s": 11.703519821166992, "time_total_s": 6382.6905035972595, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 761.3650276660919, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 43.370588235294115, "ram_util_percent": 76.2764705882353}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4779052734375, "policy_loss": -118883.0625, "vf_loss": 6408425.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 259.0, "diff_num_grad_updates_vs_sampler_policy": 258.0}}, "num_env_steps_sampled": 251640, "num_env_steps_trained": 251640, "num_agent_steps_sampled": 251640, "num_agent_steps_trained": 251640}, "sampler_results": {"episode_reward_max": -292.21222727618317, "episode_reward_min": -1203.1219602777874, "episode_reward_mean": -747.1667599291702, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-526.3516866049765, -519.6725368770785, -959.0094157729756, -794.6141100806169, -717.9127731029838, -546.5730213098454, -689.3024314572707, -684.9047195314457, -965.4251485365626, -860.6902099893744, -849.249808045342, -928.8780960984502, -533.9385147135721, -711.0544088742677, -889.7095797327539, -1011.5825192188363, -848.6993117931511, -533.1778889575806, -654.8578261426946, -970.0736250189459, -708.9593166589218, -801.3102885118361, -905.3342330150098, -890.079322695907, -552.6976151878957, -707.6135333104693, -868.2015979940194, -553.567288746659, -320.6031240664431, -603.7100690444422, -728.4999169102664, -856.7111150625428, -530.4646661252414, -960.7057113477946, -667.4174388010184, -853.6703722145295, -714.45120732419, -896.1297332283533, -490.98605790250696, -563.8762354425565, -815.8561166327121, -791.6210861201384, -775.4429801673118, -730.3022775051776, -972.2752830050244, -582.7407996606615, -1058.1805385841717, -654.2821590709123, -714.762250754641, -767.0760586107676, -604.4258405419961, -817.9703285588729, -292.21222727618317, -741.0783275251554, -770.8117765901958, -915.112603108096, -669.8805313490843, -367.4418885706997, -799.9827632094997, -519.8745072495046, -806.6498885469076, -867.4250403636132, -654.7518312941235, -840.0890404173158, -1203.1219602777874, -522.5329041512487, -881.3467784518417, -860.1609636150134, -766.1518735418813, -540.8527192722173, -697.6865161125108, -842.4997766372727, -887.1778288513328, -953.0802454679492, -560.5160467973631, -821.1000508017892, -709.0977696137401, -672.5917323197915, -810.2125900542125, -561.1920790386728, -906.3649642823498, -1196.7773023427235, -798.4709598097372, -684.3452029841236, -782.3556538846735, -888.5636672899157, -601.5650805563787, -463.65506636846624, -416.1390728793751, -512.2823976150429, -598.093883976555, -857.7890581688563, -920.7751702909966, -1060.0094418113433, -985.8165647448916, -707.1253108345709, -761.666438222746, -718.0838775933024, -753.8799234876818, -912.6825006065798], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.53003311325847, "mean_inference_ms": 0.4213262115914576, "mean_action_processing_ms": 0.09855175931242652, "mean_env_wait_ms": 2.808717392181819, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004030704498291016, "StateBufferConnector_ms": 0.0029909610748291016, "ViewRequirementAgentConnector_ms": 0.0751657485961914}}, "episode_reward_max": -292.21222727618317, "episode_reward_min": -1203.1219602777874, "episode_reward_mean": -747.1667599291702, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-526.3516866049765, -519.6725368770785, -959.0094157729756, -794.6141100806169, -717.9127731029838, -546.5730213098454, -689.3024314572707, -684.9047195314457, -965.4251485365626, -860.6902099893744, -849.249808045342, -928.8780960984502, -533.9385147135721, -711.0544088742677, -889.7095797327539, -1011.5825192188363, -848.6993117931511, -533.1778889575806, -654.8578261426946, -970.0736250189459, -708.9593166589218, -801.3102885118361, -905.3342330150098, -890.079322695907, -552.6976151878957, -707.6135333104693, -868.2015979940194, -553.567288746659, -320.6031240664431, -603.7100690444422, -728.4999169102664, -856.7111150625428, -530.4646661252414, -960.7057113477946, -667.4174388010184, -853.6703722145295, -714.45120732419, -896.1297332283533, -490.98605790250696, -563.8762354425565, -815.8561166327121, -791.6210861201384, -775.4429801673118, -730.3022775051776, -972.2752830050244, -582.7407996606615, -1058.1805385841717, -654.2821590709123, -714.762250754641, -767.0760586107676, -604.4258405419961, -817.9703285588729, -292.21222727618317, -741.0783275251554, -770.8117765901958, -915.112603108096, -669.8805313490843, -367.4418885706997, -799.9827632094997, -519.8745072495046, -806.6498885469076, -867.4250403636132, -654.7518312941235, -840.0890404173158, -1203.1219602777874, -522.5329041512487, -881.3467784518417, -860.1609636150134, -766.1518735418813, -540.8527192722173, -697.6865161125108, -842.4997766372727, -887.1778288513328, -953.0802454679492, -560.5160467973631, -821.1000508017892, -709.0977696137401, -672.5917323197915, -810.2125900542125, -561.1920790386728, -906.3649642823498, -1196.7773023427235, -798.4709598097372, -684.3452029841236, -782.3556538846735, -888.5636672899157, -601.5650805563787, -463.65506636846624, -416.1390728793751, -512.2823976150429, -598.093883976555, -857.7890581688563, -920.7751702909966, -1060.0094418113433, -985.8165647448916, -707.1253108345709, -761.666438222746, -718.0838775933024, -753.8799234876818, -912.6825006065798], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.53003311325847, "mean_inference_ms": 0.4213262115914576, "mean_action_processing_ms": 0.09855175931242652, "mean_env_wait_ms": 2.808717392181819, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004030704498291016, "StateBufferConnector_ms": 0.0029909610748291016, "ViewRequirementAgentConnector_ms": 0.0751657485961914}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 251640, "num_agent_steps_trained": 251640, "num_env_steps_sampled": 251640, "num_env_steps_trained": 251640, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.697826067024074, "num_env_steps_trained_throughput_per_sec": 39.697826067024074, "timesteps_total": 251640, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 251640, "timers": {"training_iteration_time_ms": 2952.98, "sample_time_ms": 2949.07, "load_time_ms": 0.23, "load_throughput": 520869.792, "learn_time_ms": 2.92, "learn_throughput": 41101.151, "synch_weights_time_ms": 0.715}, "counters": {"num_env_steps_sampled": 251640, "num_env_steps_trained": 251640, "num_agent_steps_sampled": 251640, "num_agent_steps_trained": 251640}, "done": false, "episodes_total": 2097, "training_iteration": 525, "trial_id": "53665_00000", "date": "2023-07-26_03-34-14", "timestamp": 1690331654, "time_this_iter_s": 12.09438419342041, "time_total_s": 6394.78488779068, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 773.4594118595123, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 40.48823529411765, "ram_util_percent": 78.58235294117647}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4926452636719, "policy_loss": -74005.9296875, "vf_loss": 2824504.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 263.0, "diff_num_grad_updates_vs_sampler_policy": 262.0}}, "num_env_steps_sampled": 252120, "num_env_steps_trained": 252120, "num_agent_steps_sampled": 252120, "num_agent_steps_trained": 252120}, "sampler_results": {"episode_reward_max": -292.21222727618317, "episode_reward_min": -1203.1219602777874, "episode_reward_mean": -750.211019640882, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-717.9127731029838, -546.5730213098454, -689.3024314572707, -684.9047195314457, -965.4251485365626, -860.6902099893744, -849.249808045342, -928.8780960984502, -533.9385147135721, -711.0544088742677, -889.7095797327539, -1011.5825192188363, -848.6993117931511, -533.1778889575806, -654.8578261426946, -970.0736250189459, -708.9593166589218, -801.3102885118361, -905.3342330150098, -890.079322695907, -552.6976151878957, -707.6135333104693, -868.2015979940194, -553.567288746659, -320.6031240664431, -603.7100690444422, -728.4999169102664, -856.7111150625428, -530.4646661252414, -960.7057113477946, -667.4174388010184, -853.6703722145295, -714.45120732419, -896.1297332283533, -490.98605790250696, -563.8762354425565, -815.8561166327121, -791.6210861201384, -775.4429801673118, -730.3022775051776, -972.2752830050244, -582.7407996606615, -1058.1805385841717, -654.2821590709123, -714.762250754641, -767.0760586107676, -604.4258405419961, -817.9703285588729, -292.21222727618317, -741.0783275251554, -770.8117765901958, -915.112603108096, -669.8805313490843, -367.4418885706997, -799.9827632094997, -519.8745072495046, -806.6498885469076, -867.4250403636132, -654.7518312941235, -840.0890404173158, -1203.1219602777874, -522.5329041512487, -881.3467784518417, -860.1609636150134, -766.1518735418813, -540.8527192722173, -697.6865161125108, -842.4997766372727, -887.1778288513328, -953.0802454679492, -560.5160467973631, -821.1000508017892, -709.0977696137401, -672.5917323197915, -810.2125900542125, -561.1920790386728, -906.3649642823498, -1196.7773023427235, -798.4709598097372, -684.3452029841236, -782.3556538846735, -888.5636672899157, -601.5650805563787, -463.65506636846624, -416.1390728793751, -512.2823976150429, -598.093883976555, -857.7890581688563, -920.7751702909966, -1060.0094418113433, -985.8165647448916, -707.1253108345709, -761.666438222746, -718.0838775933024, -753.8799234876818, -912.6825006065798, -886.0253014907576, -850.697507711902, -757.4724784932018, -609.8784328109755], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.53280281429318, "mean_inference_ms": 0.42133590771372065, "mean_action_processing_ms": 0.09855268906597459, "mean_env_wait_ms": 2.80628986573646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003985404968261719, "StateBufferConnector_ms": 0.0029625892639160156, "ViewRequirementAgentConnector_ms": 0.07424736022949219}}, "episode_reward_max": -292.21222727618317, "episode_reward_min": -1203.1219602777874, "episode_reward_mean": -750.211019640882, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-717.9127731029838, -546.5730213098454, -689.3024314572707, -684.9047195314457, -965.4251485365626, -860.6902099893744, -849.249808045342, -928.8780960984502, -533.9385147135721, -711.0544088742677, -889.7095797327539, -1011.5825192188363, -848.6993117931511, -533.1778889575806, -654.8578261426946, -970.0736250189459, -708.9593166589218, -801.3102885118361, -905.3342330150098, -890.079322695907, -552.6976151878957, -707.6135333104693, -868.2015979940194, -553.567288746659, -320.6031240664431, -603.7100690444422, -728.4999169102664, -856.7111150625428, -530.4646661252414, -960.7057113477946, -667.4174388010184, -853.6703722145295, -714.45120732419, -896.1297332283533, -490.98605790250696, -563.8762354425565, -815.8561166327121, -791.6210861201384, -775.4429801673118, -730.3022775051776, -972.2752830050244, -582.7407996606615, -1058.1805385841717, -654.2821590709123, -714.762250754641, -767.0760586107676, -604.4258405419961, -817.9703285588729, -292.21222727618317, -741.0783275251554, -770.8117765901958, -915.112603108096, -669.8805313490843, -367.4418885706997, -799.9827632094997, -519.8745072495046, -806.6498885469076, -867.4250403636132, -654.7518312941235, -840.0890404173158, -1203.1219602777874, -522.5329041512487, -881.3467784518417, -860.1609636150134, -766.1518735418813, -540.8527192722173, -697.6865161125108, -842.4997766372727, -887.1778288513328, -953.0802454679492, -560.5160467973631, -821.1000508017892, -709.0977696137401, -672.5917323197915, -810.2125900542125, -561.1920790386728, -906.3649642823498, -1196.7773023427235, -798.4709598097372, -684.3452029841236, -782.3556538846735, -888.5636672899157, -601.5650805563787, -463.65506636846624, -416.1390728793751, -512.2823976150429, -598.093883976555, -857.7890581688563, -920.7751702909966, -1060.0094418113433, -985.8165647448916, -707.1253108345709, -761.666438222746, -718.0838775933024, -753.8799234876818, -912.6825006065798, -886.0253014907576, -850.697507711902, -757.4724784932018, -609.8784328109755], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.53280281429318, "mean_inference_ms": 0.42133590771372065, "mean_action_processing_ms": 0.09855268906597459, "mean_env_wait_ms": 2.80628986573646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003985404968261719, "StateBufferConnector_ms": 0.0029625892639160156, "ViewRequirementAgentConnector_ms": 0.07424736022949219}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252120, "num_agent_steps_trained": 252120, "num_env_steps_sampled": 252120, "num_env_steps_trained": 252120, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.14361779198433, "num_env_steps_trained_throughput_per_sec": 41.14361779198433, "timesteps_total": 252120, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 252120, "timers": {"training_iteration_time_ms": 2960.494, "sample_time_ms": 2956.576, "load_time_ms": 0.229, "load_throughput": 522926.213, "learn_time_ms": 2.924, "learn_throughput": 41036.141, "synch_weights_time_ms": 0.719}, "counters": {"num_env_steps_sampled": 252120, "num_env_steps_trained": 252120, "num_agent_steps_sampled": 252120, "num_agent_steps_trained": 252120}, "done": false, "episodes_total": 2101, "training_iteration": 526, "trial_id": "53665_00000", "date": "2023-07-26_03-34-25", "timestamp": 1690331665, "time_this_iter_s": 11.669575929641724, "time_total_s": 6406.454463720322, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 785.128987789154, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 39.16470588235295, "ram_util_percent": 77.18823529411765}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4733581542969, "policy_loss": -110408.5078125, "vf_loss": 4842132.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 267.0, "diff_num_grad_updates_vs_sampler_policy": 266.0}}, "num_env_steps_sampled": 252600, "num_env_steps_trained": 252600, "num_agent_steps_sampled": 252600, "num_agent_steps_trained": 252600}, "sampler_results": {"episode_reward_max": -292.21222727618317, "episode_reward_min": -1203.1219602777874, "episode_reward_mean": -754.263062704403, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-965.4251485365626, -860.6902099893744, -849.249808045342, -928.8780960984502, -533.9385147135721, -711.0544088742677, -889.7095797327539, -1011.5825192188363, -848.6993117931511, -533.1778889575806, -654.8578261426946, -970.0736250189459, -708.9593166589218, -801.3102885118361, -905.3342330150098, -890.079322695907, -552.6976151878957, -707.6135333104693, -868.2015979940194, -553.567288746659, -320.6031240664431, -603.7100690444422, -728.4999169102664, -856.7111150625428, -530.4646661252414, -960.7057113477946, -667.4174388010184, -853.6703722145295, -714.45120732419, -896.1297332283533, -490.98605790250696, -563.8762354425565, -815.8561166327121, -791.6210861201384, -775.4429801673118, -730.3022775051776, -972.2752830050244, -582.7407996606615, -1058.1805385841717, -654.2821590709123, -714.762250754641, -767.0760586107676, -604.4258405419961, -817.9703285588729, -292.21222727618317, -741.0783275251554, -770.8117765901958, -915.112603108096, -669.8805313490843, -367.4418885706997, -799.9827632094997, -519.8745072495046, -806.6498885469076, -867.4250403636132, -654.7518312941235, -840.0890404173158, -1203.1219602777874, -522.5329041512487, -881.3467784518417, -860.1609636150134, -766.1518735418813, -540.8527192722173, -697.6865161125108, -842.4997766372727, -887.1778288513328, -953.0802454679492, -560.5160467973631, -821.1000508017892, -709.0977696137401, -672.5917323197915, -810.2125900542125, -561.1920790386728, -906.3649642823498, -1196.7773023427235, -798.4709598097372, -684.3452029841236, -782.3556538846735, -888.5636672899157, -601.5650805563787, -463.65506636846624, -416.1390728793751, -512.2823976150429, -598.093883976555, -857.7890581688563, -920.7751702909966, -1060.0094418113433, -985.8165647448916, -707.1253108345709, -761.666438222746, -718.0838775933024, -753.8799234876818, -912.6825006065798, -886.0253014907576, -850.697507711902, -757.4724784932018, -609.8784328109755, -882.3308110692128, -886.285045724919, -481.08934177726707, -794.1920531822366], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.535727272310115, "mean_inference_ms": 0.42131031896825055, "mean_action_processing_ms": 0.09854752008176451, "mean_env_wait_ms": 2.803897325281257, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003972291946411133, "StateBufferConnector_ms": 0.002950906753540039, "ViewRequirementAgentConnector_ms": 0.07377386093139648}}, "episode_reward_max": -292.21222727618317, "episode_reward_min": -1203.1219602777874, "episode_reward_mean": -754.263062704403, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-965.4251485365626, -860.6902099893744, -849.249808045342, -928.8780960984502, -533.9385147135721, -711.0544088742677, -889.7095797327539, -1011.5825192188363, -848.6993117931511, -533.1778889575806, -654.8578261426946, -970.0736250189459, -708.9593166589218, -801.3102885118361, -905.3342330150098, -890.079322695907, -552.6976151878957, -707.6135333104693, -868.2015979940194, -553.567288746659, -320.6031240664431, -603.7100690444422, -728.4999169102664, -856.7111150625428, -530.4646661252414, -960.7057113477946, -667.4174388010184, -853.6703722145295, -714.45120732419, -896.1297332283533, -490.98605790250696, -563.8762354425565, -815.8561166327121, -791.6210861201384, -775.4429801673118, -730.3022775051776, -972.2752830050244, -582.7407996606615, -1058.1805385841717, -654.2821590709123, -714.762250754641, -767.0760586107676, -604.4258405419961, -817.9703285588729, -292.21222727618317, -741.0783275251554, -770.8117765901958, -915.112603108096, -669.8805313490843, -367.4418885706997, -799.9827632094997, -519.8745072495046, -806.6498885469076, -867.4250403636132, -654.7518312941235, -840.0890404173158, -1203.1219602777874, -522.5329041512487, -881.3467784518417, -860.1609636150134, -766.1518735418813, -540.8527192722173, -697.6865161125108, -842.4997766372727, -887.1778288513328, -953.0802454679492, -560.5160467973631, -821.1000508017892, -709.0977696137401, -672.5917323197915, -810.2125900542125, -561.1920790386728, -906.3649642823498, -1196.7773023427235, -798.4709598097372, -684.3452029841236, -782.3556538846735, -888.5636672899157, -601.5650805563787, -463.65506636846624, -416.1390728793751, -512.2823976150429, -598.093883976555, -857.7890581688563, -920.7751702909966, -1060.0094418113433, -985.8165647448916, -707.1253108345709, -761.666438222746, -718.0838775933024, -753.8799234876818, -912.6825006065798, -886.0253014907576, -850.697507711902, -757.4724784932018, -609.8784328109755, -882.3308110692128, -886.285045724919, -481.08934177726707, -794.1920531822366], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.535727272310115, "mean_inference_ms": 0.42131031896825055, "mean_action_processing_ms": 0.09854752008176451, "mean_env_wait_ms": 2.803897325281257, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003972291946411133, "StateBufferConnector_ms": 0.002950906753540039, "ViewRequirementAgentConnector_ms": 0.07377386093139648}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252600, "num_agent_steps_trained": 252600, "num_env_steps_sampled": 252600, "num_env_steps_trained": 252600, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.52183521677543, "num_env_steps_trained_throughput_per_sec": 39.52183521677543, "timesteps_total": 252600, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 252600, "timers": {"training_iteration_time_ms": 2984.112, "sample_time_ms": 2980.142, "load_time_ms": 0.23, "load_throughput": 521085.495, "learn_time_ms": 2.945, "learn_throughput": 40741.835, "synch_weights_time_ms": 0.749}, "counters": {"num_env_steps_sampled": 252600, "num_env_steps_trained": 252600, "num_agent_steps_sampled": 252600, "num_agent_steps_trained": 252600}, "done": false, "episodes_total": 2105, "training_iteration": 527, "trial_id": "53665_00000", "date": "2023-07-26_03-34-37", "timestamp": 1690331677, "time_this_iter_s": 12.147876739501953, "time_total_s": 6418.602340459824, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 797.276864528656, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 45.858823529411765, "ram_util_percent": 77.71764705882353}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.45623779296875, "policy_loss": -76664.9765625, "vf_loss": 2658877.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 271.0, "diff_num_grad_updates_vs_sampler_policy": 270.0}}, "num_env_steps_sampled": 253080, "num_env_steps_trained": 253080, "num_agent_steps_sampled": 253080, "num_agent_steps_trained": 253080}, "sampler_results": {"episode_reward_max": -292.21222727618317, "episode_reward_min": -1203.1219602777874, "episode_reward_mean": -747.9196575583736, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-533.9385147135721, -711.0544088742677, -889.7095797327539, -1011.5825192188363, -848.6993117931511, -533.1778889575806, -654.8578261426946, -970.0736250189459, -708.9593166589218, -801.3102885118361, -905.3342330150098, -890.079322695907, -552.6976151878957, -707.6135333104693, -868.2015979940194, -553.567288746659, -320.6031240664431, -603.7100690444422, -728.4999169102664, -856.7111150625428, -530.4646661252414, -960.7057113477946, -667.4174388010184, -853.6703722145295, -714.45120732419, -896.1297332283533, -490.98605790250696, -563.8762354425565, -815.8561166327121, -791.6210861201384, -775.4429801673118, -730.3022775051776, -972.2752830050244, -582.7407996606615, -1058.1805385841717, -654.2821590709123, -714.762250754641, -767.0760586107676, -604.4258405419961, -817.9703285588729, -292.21222727618317, -741.0783275251554, -770.8117765901958, -915.112603108096, -669.8805313490843, -367.4418885706997, -799.9827632094997, -519.8745072495046, -806.6498885469076, -867.4250403636132, -654.7518312941235, -840.0890404173158, -1203.1219602777874, -522.5329041512487, -881.3467784518417, -860.1609636150134, -766.1518735418813, -540.8527192722173, -697.6865161125108, -842.4997766372727, -887.1778288513328, -953.0802454679492, -560.5160467973631, -821.1000508017892, -709.0977696137401, -672.5917323197915, -810.2125900542125, -561.1920790386728, -906.3649642823498, -1196.7773023427235, -798.4709598097372, -684.3452029841236, -782.3556538846735, -888.5636672899157, -601.5650805563787, -463.65506636846624, -416.1390728793751, -512.2823976150429, -598.093883976555, -857.7890581688563, -920.7751702909966, -1060.0094418113433, -985.8165647448916, -707.1253108345709, -761.666438222746, -718.0838775933024, -753.8799234876818, -912.6825006065798, -886.0253014907576, -850.697507711902, -757.4724784932018, -609.8784328109755, -882.3308110692128, -886.285045724919, -481.08934177726707, -794.1920531822366, -711.6784718845645, -848.8305485281672, -887.3004409764154, -522.0932866776407], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.5342822940688, "mean_inference_ms": 0.4212041424792444, "mean_action_processing_ms": 0.09852882256547836, "mean_env_wait_ms": 2.8014307238234335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003935575485229492, "StateBufferConnector_ms": 0.002935647964477539, "ViewRequirementAgentConnector_ms": 0.0730891227722168}}, "episode_reward_max": -292.21222727618317, "episode_reward_min": -1203.1219602777874, "episode_reward_mean": -747.9196575583736, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-533.9385147135721, -711.0544088742677, -889.7095797327539, -1011.5825192188363, -848.6993117931511, -533.1778889575806, -654.8578261426946, -970.0736250189459, -708.9593166589218, -801.3102885118361, -905.3342330150098, -890.079322695907, -552.6976151878957, -707.6135333104693, -868.2015979940194, -553.567288746659, -320.6031240664431, -603.7100690444422, -728.4999169102664, -856.7111150625428, -530.4646661252414, -960.7057113477946, -667.4174388010184, -853.6703722145295, -714.45120732419, -896.1297332283533, -490.98605790250696, -563.8762354425565, -815.8561166327121, -791.6210861201384, -775.4429801673118, -730.3022775051776, -972.2752830050244, -582.7407996606615, -1058.1805385841717, -654.2821590709123, -714.762250754641, -767.0760586107676, -604.4258405419961, -817.9703285588729, -292.21222727618317, -741.0783275251554, -770.8117765901958, -915.112603108096, -669.8805313490843, -367.4418885706997, -799.9827632094997, -519.8745072495046, -806.6498885469076, -867.4250403636132, -654.7518312941235, -840.0890404173158, -1203.1219602777874, -522.5329041512487, -881.3467784518417, -860.1609636150134, -766.1518735418813, -540.8527192722173, -697.6865161125108, -842.4997766372727, -887.1778288513328, -953.0802454679492, -560.5160467973631, -821.1000508017892, -709.0977696137401, -672.5917323197915, -810.2125900542125, -561.1920790386728, -906.3649642823498, -1196.7773023427235, -798.4709598097372, -684.3452029841236, -782.3556538846735, -888.5636672899157, -601.5650805563787, -463.65506636846624, -416.1390728793751, -512.2823976150429, -598.093883976555, -857.7890581688563, -920.7751702909966, -1060.0094418113433, -985.8165647448916, -707.1253108345709, -761.666438222746, -718.0838775933024, -753.8799234876818, -912.6825006065798, -886.0253014907576, -850.697507711902, -757.4724784932018, -609.8784328109755, -882.3308110692128, -886.285045724919, -481.08934177726707, -794.1920531822366, -711.6784718845645, -848.8305485281672, -887.3004409764154, -522.0932866776407], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.5342822940688, "mean_inference_ms": 0.4212041424792444, "mean_action_processing_ms": 0.09852882256547836, "mean_env_wait_ms": 2.8014307238234335, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003935575485229492, "StateBufferConnector_ms": 0.002935647964477539, "ViewRequirementAgentConnector_ms": 0.0730891227722168}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 253080, "num_agent_steps_trained": 253080, "num_env_steps_sampled": 253080, "num_env_steps_trained": 253080, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.24759945786547, "num_env_steps_trained_throughput_per_sec": 41.24759945786547, "timesteps_total": 253080, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 253080, "timers": {"training_iteration_time_ms": 2964.539, "sample_time_ms": 2960.701, "load_time_ms": 0.221, "load_throughput": 543303.627, "learn_time_ms": 2.845, "learn_throughput": 42177.123, "synch_weights_time_ms": 0.731}, "counters": {"num_env_steps_sampled": 253080, "num_env_steps_trained": 253080, "num_agent_steps_sampled": 253080, "num_agent_steps_trained": 253080}, "done": false, "episodes_total": 2109, "training_iteration": 528, "trial_id": "53665_00000", "date": "2023-07-26_03-34-49", "timestamp": 1690331689, "time_this_iter_s": 11.639998197555542, "time_total_s": 6430.242338657379, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 808.9168627262115, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 43.92941176470589, "ram_util_percent": 78.47647058823529}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.51690673828125, "policy_loss": -113409.6015625, "vf_loss": 5488594.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 275.0, "diff_num_grad_updates_vs_sampler_policy": 274.0}}, "num_env_steps_sampled": 253560, "num_env_steps_trained": 253560, "num_agent_steps_sampled": 253560, "num_agent_steps_trained": 253560}, "sampler_results": {"episode_reward_max": -292.21222727618317, "episode_reward_min": -1203.1219602777874, "episode_reward_mean": -744.9265959642903, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-848.6993117931511, -533.1778889575806, -654.8578261426946, -970.0736250189459, -708.9593166589218, -801.3102885118361, -905.3342330150098, -890.079322695907, -552.6976151878957, -707.6135333104693, -868.2015979940194, -553.567288746659, -320.6031240664431, -603.7100690444422, -728.4999169102664, -856.7111150625428, -530.4646661252414, -960.7057113477946, -667.4174388010184, -853.6703722145295, -714.45120732419, -896.1297332283533, -490.98605790250696, -563.8762354425565, -815.8561166327121, -791.6210861201384, -775.4429801673118, -730.3022775051776, -972.2752830050244, -582.7407996606615, -1058.1805385841717, -654.2821590709123, -714.762250754641, -767.0760586107676, -604.4258405419961, -817.9703285588729, -292.21222727618317, -741.0783275251554, -770.8117765901958, -915.112603108096, -669.8805313490843, -367.4418885706997, -799.9827632094997, -519.8745072495046, -806.6498885469076, -867.4250403636132, -654.7518312941235, -840.0890404173158, -1203.1219602777874, -522.5329041512487, -881.3467784518417, -860.1609636150134, -766.1518735418813, -540.8527192722173, -697.6865161125108, -842.4997766372727, -887.1778288513328, -953.0802454679492, -560.5160467973631, -821.1000508017892, -709.0977696137401, -672.5917323197915, -810.2125900542125, -561.1920790386728, -906.3649642823498, -1196.7773023427235, -798.4709598097372, -684.3452029841236, -782.3556538846735, -888.5636672899157, -601.5650805563787, -463.65506636846624, -416.1390728793751, -512.2823976150429, -598.093883976555, -857.7890581688563, -920.7751702909966, -1060.0094418113433, -985.8165647448916, -707.1253108345709, -761.666438222746, -718.0838775933024, -753.8799234876818, -912.6825006065798, -886.0253014907576, -850.697507711902, -757.4724784932018, -609.8784328109755, -882.3308110692128, -886.285045724919, -481.08934177726707, -794.1920531822366, -711.6784718845645, -848.8305485281672, -887.3004409764154, -522.0932866776407, -709.2056911835209, -600.2664043158451, -715.6813345032776, -821.8254331284692], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.532800372798324, "mean_inference_ms": 0.421120139188087, "mean_action_processing_ms": 0.09851393955818065, "mean_env_wait_ms": 2.799039634058391, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039403438568115234, "StateBufferConnector_ms": 0.0029478073120117188, "ViewRequirementAgentConnector_ms": 0.07328104972839355}}, "episode_reward_max": -292.21222727618317, "episode_reward_min": -1203.1219602777874, "episode_reward_mean": -744.9265959642903, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-848.6993117931511, -533.1778889575806, -654.8578261426946, -970.0736250189459, -708.9593166589218, -801.3102885118361, -905.3342330150098, -890.079322695907, -552.6976151878957, -707.6135333104693, -868.2015979940194, -553.567288746659, -320.6031240664431, -603.7100690444422, -728.4999169102664, -856.7111150625428, -530.4646661252414, -960.7057113477946, -667.4174388010184, -853.6703722145295, -714.45120732419, -896.1297332283533, -490.98605790250696, -563.8762354425565, -815.8561166327121, -791.6210861201384, -775.4429801673118, -730.3022775051776, -972.2752830050244, -582.7407996606615, -1058.1805385841717, -654.2821590709123, -714.762250754641, -767.0760586107676, -604.4258405419961, -817.9703285588729, -292.21222727618317, -741.0783275251554, -770.8117765901958, -915.112603108096, -669.8805313490843, -367.4418885706997, -799.9827632094997, -519.8745072495046, -806.6498885469076, -867.4250403636132, -654.7518312941235, -840.0890404173158, -1203.1219602777874, -522.5329041512487, -881.3467784518417, -860.1609636150134, -766.1518735418813, -540.8527192722173, -697.6865161125108, -842.4997766372727, -887.1778288513328, -953.0802454679492, -560.5160467973631, -821.1000508017892, -709.0977696137401, -672.5917323197915, -810.2125900542125, -561.1920790386728, -906.3649642823498, -1196.7773023427235, -798.4709598097372, -684.3452029841236, -782.3556538846735, -888.5636672899157, -601.5650805563787, -463.65506636846624, -416.1390728793751, -512.2823976150429, -598.093883976555, -857.7890581688563, -920.7751702909966, -1060.0094418113433, -985.8165647448916, -707.1253108345709, -761.666438222746, -718.0838775933024, -753.8799234876818, -912.6825006065798, -886.0253014907576, -850.697507711902, -757.4724784932018, -609.8784328109755, -882.3308110692128, -886.285045724919, -481.08934177726707, -794.1920531822366, -711.6784718845645, -848.8305485281672, -887.3004409764154, -522.0932866776407, -709.2056911835209, -600.2664043158451, -715.6813345032776, -821.8254331284692], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.532800372798324, "mean_inference_ms": 0.421120139188087, "mean_action_processing_ms": 0.09851393955818065, "mean_env_wait_ms": 2.799039634058391, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039403438568115234, "StateBufferConnector_ms": 0.0029478073120117188, "ViewRequirementAgentConnector_ms": 0.07328104972839355}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 253560, "num_agent_steps_trained": 253560, "num_env_steps_sampled": 253560, "num_env_steps_trained": 253560, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.4644471817371, "num_env_steps_trained_throughput_per_sec": 40.4644471817371, "timesteps_total": 253560, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 253560, "timers": {"training_iteration_time_ms": 2972.264, "sample_time_ms": 2968.435, "load_time_ms": 0.224, "load_throughput": 536184.596, "learn_time_ms": 2.84, "learn_throughput": 42255.732, "synch_weights_time_ms": 0.724}, "counters": {"num_env_steps_sampled": 253560, "num_env_steps_trained": 253560, "num_agent_steps_sampled": 253560, "num_agent_steps_trained": 253560}, "done": false, "episodes_total": 2113, "training_iteration": 529, "trial_id": "53665_00000", "date": "2023-07-26_03-35-01", "timestamp": 1690331701, "time_this_iter_s": 11.865058898925781, "time_total_s": 6442.107397556305, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 820.7819216251373, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 46.57647058823529, "ram_util_percent": 78.34117647058824}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-08, "entropy_coeff": 0.05, "policy_entropy": 267.53082275390625, "policy_loss": -162742.734375, "vf_loss": 10764290.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 279.0, "diff_num_grad_updates_vs_sampler_policy": 278.0}}, "num_env_steps_sampled": 254040, "num_env_steps_trained": 254040, "num_agent_steps_sampled": 254040, "num_agent_steps_trained": 254040}, "sampler_results": {"episode_reward_max": -292.21222727618317, "episode_reward_min": -1203.1219602777874, "episode_reward_mean": -748.1088634525499, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-708.9593166589218, -801.3102885118361, -905.3342330150098, -890.079322695907, -552.6976151878957, -707.6135333104693, -868.2015979940194, -553.567288746659, -320.6031240664431, -603.7100690444422, -728.4999169102664, -856.7111150625428, -530.4646661252414, -960.7057113477946, -667.4174388010184, -853.6703722145295, -714.45120732419, -896.1297332283533, -490.98605790250696, -563.8762354425565, -815.8561166327121, -791.6210861201384, -775.4429801673118, -730.3022775051776, -972.2752830050244, -582.7407996606615, -1058.1805385841717, -654.2821590709123, -714.762250754641, -767.0760586107676, -604.4258405419961, -817.9703285588729, -292.21222727618317, -741.0783275251554, -770.8117765901958, -915.112603108096, -669.8805313490843, -367.4418885706997, -799.9827632094997, -519.8745072495046, -806.6498885469076, -867.4250403636132, -654.7518312941235, -840.0890404173158, -1203.1219602777874, -522.5329041512487, -881.3467784518417, -860.1609636150134, -766.1518735418813, -540.8527192722173, -697.6865161125108, -842.4997766372727, -887.1778288513328, -953.0802454679492, -560.5160467973631, -821.1000508017892, -709.0977696137401, -672.5917323197915, -810.2125900542125, -561.1920790386728, -906.3649642823498, -1196.7773023427235, -798.4709598097372, -684.3452029841236, -782.3556538846735, -888.5636672899157, -601.5650805563787, -463.65506636846624, -416.1390728793751, -512.2823976150429, -598.093883976555, -857.7890581688563, -920.7751702909966, -1060.0094418113433, -985.8165647448916, -707.1253108345709, -761.666438222746, -718.0838775933024, -753.8799234876818, -912.6825006065798, -886.0253014907576, -850.697507711902, -757.4724784932018, -609.8784328109755, -882.3308110692128, -886.285045724919, -481.08934177726707, -794.1920531822366, -711.6784718845645, -848.8305485281672, -887.3004409764154, -522.0932866776407, -709.2056911835209, -600.2664043158451, -715.6813345032776, -821.8254331284692, -937.9442820285622, -730.0486852291759, -535.7589437723914, -1121.2834897081757], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.529898279828505, "mean_inference_ms": 0.42098172934955785, "mean_action_processing_ms": 0.09849082189076924, "mean_env_wait_ms": 2.7964805044001024, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038712024688720703, "StateBufferConnector_ms": 0.0029098987579345703, "ViewRequirementAgentConnector_ms": 0.07248377799987793}}, "episode_reward_max": -292.21222727618317, "episode_reward_min": -1203.1219602777874, "episode_reward_mean": -748.1088634525499, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-708.9593166589218, -801.3102885118361, -905.3342330150098, -890.079322695907, -552.6976151878957, -707.6135333104693, -868.2015979940194, -553.567288746659, -320.6031240664431, -603.7100690444422, -728.4999169102664, -856.7111150625428, -530.4646661252414, -960.7057113477946, -667.4174388010184, -853.6703722145295, -714.45120732419, -896.1297332283533, -490.98605790250696, -563.8762354425565, -815.8561166327121, -791.6210861201384, -775.4429801673118, -730.3022775051776, -972.2752830050244, -582.7407996606615, -1058.1805385841717, -654.2821590709123, -714.762250754641, -767.0760586107676, -604.4258405419961, -817.9703285588729, -292.21222727618317, -741.0783275251554, -770.8117765901958, -915.112603108096, -669.8805313490843, -367.4418885706997, -799.9827632094997, -519.8745072495046, -806.6498885469076, -867.4250403636132, -654.7518312941235, -840.0890404173158, -1203.1219602777874, -522.5329041512487, -881.3467784518417, -860.1609636150134, -766.1518735418813, -540.8527192722173, -697.6865161125108, -842.4997766372727, -887.1778288513328, -953.0802454679492, -560.5160467973631, -821.1000508017892, -709.0977696137401, -672.5917323197915, -810.2125900542125, -561.1920790386728, -906.3649642823498, -1196.7773023427235, -798.4709598097372, -684.3452029841236, -782.3556538846735, -888.5636672899157, -601.5650805563787, -463.65506636846624, -416.1390728793751, -512.2823976150429, -598.093883976555, -857.7890581688563, -920.7751702909966, -1060.0094418113433, -985.8165647448916, -707.1253108345709, -761.666438222746, -718.0838775933024, -753.8799234876818, -912.6825006065798, -886.0253014907576, -850.697507711902, -757.4724784932018, -609.8784328109755, -882.3308110692128, -886.285045724919, -481.08934177726707, -794.1920531822366, -711.6784718845645, -848.8305485281672, -887.3004409764154, -522.0932866776407, -709.2056911835209, -600.2664043158451, -715.6813345032776, -821.8254331284692, -937.9442820285622, -730.0486852291759, -535.7589437723914, -1121.2834897081757], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.529898279828505, "mean_inference_ms": 0.42098172934955785, "mean_action_processing_ms": 0.09849082189076924, "mean_env_wait_ms": 2.7964805044001024, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038712024688720703, "StateBufferConnector_ms": 0.0029098987579345703, "ViewRequirementAgentConnector_ms": 0.07248377799987793}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 254040, "num_agent_steps_trained": 254040, "num_env_steps_sampled": 254040, "num_env_steps_trained": 254040, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.539534296305696, "num_env_steps_trained_throughput_per_sec": 40.539534296305696, "timesteps_total": 254040, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 254040, "timers": {"training_iteration_time_ms": 2958.13, "sample_time_ms": 2954.129, "load_time_ms": 0.235, "load_throughput": 510411.196, "learn_time_ms": 2.964, "learn_throughput": 40482.629, "synch_weights_time_ms": 0.751}, "counters": {"num_env_steps_sampled": 254040, "num_env_steps_trained": 254040, "num_agent_steps_sampled": 254040, "num_agent_steps_trained": 254040}, "done": false, "episodes_total": 2117, "training_iteration": 530, "trial_id": "53665_00000", "date": "2023-07-26_03-35-13", "timestamp": 1690331713, "time_this_iter_s": 11.843047857284546, "time_total_s": 6453.9504454135895, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 832.6249694824219, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 40.747058823529414, "ram_util_percent": 78.07058823529412}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-08, "entropy_coeff": 0.05, "policy_entropy": 267.49700927734375, "policy_loss": -105071.578125, "vf_loss": 5054736.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 283.0, "diff_num_grad_updates_vs_sampler_policy": 282.0}}, "num_env_steps_sampled": 254520, "num_env_steps_trained": 254520, "num_agent_steps_sampled": 254520, "num_agent_steps_trained": 254520}, "sampler_results": {"episode_reward_max": -292.21222727618317, "episode_reward_min": -1203.1219602777874, "episode_reward_mean": -746.5394200450702, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-552.6976151878957, -707.6135333104693, -868.2015979940194, -553.567288746659, -320.6031240664431, -603.7100690444422, -728.4999169102664, -856.7111150625428, -530.4646661252414, -960.7057113477946, -667.4174388010184, -853.6703722145295, -714.45120732419, -896.1297332283533, -490.98605790250696, -563.8762354425565, -815.8561166327121, -791.6210861201384, -775.4429801673118, -730.3022775051776, -972.2752830050244, -582.7407996606615, -1058.1805385841717, -654.2821590709123, -714.762250754641, -767.0760586107676, -604.4258405419961, -817.9703285588729, -292.21222727618317, -741.0783275251554, -770.8117765901958, -915.112603108096, -669.8805313490843, -367.4418885706997, -799.9827632094997, -519.8745072495046, -806.6498885469076, -867.4250403636132, -654.7518312941235, -840.0890404173158, -1203.1219602777874, -522.5329041512487, -881.3467784518417, -860.1609636150134, -766.1518735418813, -540.8527192722173, -697.6865161125108, -842.4997766372727, -887.1778288513328, -953.0802454679492, -560.5160467973631, -821.1000508017892, -709.0977696137401, -672.5917323197915, -810.2125900542125, -561.1920790386728, -906.3649642823498, -1196.7773023427235, -798.4709598097372, -684.3452029841236, -782.3556538846735, -888.5636672899157, -601.5650805563787, -463.65506636846624, -416.1390728793751, -512.2823976150429, -598.093883976555, -857.7890581688563, -920.7751702909966, -1060.0094418113433, -985.8165647448916, -707.1253108345709, -761.666438222746, -718.0838775933024, -753.8799234876818, -912.6825006065798, -886.0253014907576, -850.697507711902, -757.4724784932018, -609.8784328109755, -882.3308110692128, -886.285045724919, -481.08934177726707, -794.1920531822366, -711.6784718845645, -848.8305485281672, -887.3004409764154, -522.0932866776407, -709.2056911835209, -600.2664043158451, -715.6813345032776, -821.8254331284692, -937.9442820285622, -730.0486852291759, -535.7589437723914, -1121.2834897081757, -582.8082993067468, -708.0427139636481, -1008.5458885392121, -849.3419183240953], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.52534486041303, "mean_inference_ms": 0.4208013283784433, "mean_action_processing_ms": 0.09846120608535808, "mean_env_wait_ms": 2.79394866335663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038576126098632812, "StateBufferConnector_ms": 0.002897024154663086, "ViewRequirementAgentConnector_ms": 0.072113037109375}}, "episode_reward_max": -292.21222727618317, "episode_reward_min": -1203.1219602777874, "episode_reward_mean": -746.5394200450702, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-552.6976151878957, -707.6135333104693, -868.2015979940194, -553.567288746659, -320.6031240664431, -603.7100690444422, -728.4999169102664, -856.7111150625428, -530.4646661252414, -960.7057113477946, -667.4174388010184, -853.6703722145295, -714.45120732419, -896.1297332283533, -490.98605790250696, -563.8762354425565, -815.8561166327121, -791.6210861201384, -775.4429801673118, -730.3022775051776, -972.2752830050244, -582.7407996606615, -1058.1805385841717, -654.2821590709123, -714.762250754641, -767.0760586107676, -604.4258405419961, -817.9703285588729, -292.21222727618317, -741.0783275251554, -770.8117765901958, -915.112603108096, -669.8805313490843, -367.4418885706997, -799.9827632094997, -519.8745072495046, -806.6498885469076, -867.4250403636132, -654.7518312941235, -840.0890404173158, -1203.1219602777874, -522.5329041512487, -881.3467784518417, -860.1609636150134, -766.1518735418813, -540.8527192722173, -697.6865161125108, -842.4997766372727, -887.1778288513328, -953.0802454679492, -560.5160467973631, -821.1000508017892, -709.0977696137401, -672.5917323197915, -810.2125900542125, -561.1920790386728, -906.3649642823498, -1196.7773023427235, -798.4709598097372, -684.3452029841236, -782.3556538846735, -888.5636672899157, -601.5650805563787, -463.65506636846624, -416.1390728793751, -512.2823976150429, -598.093883976555, -857.7890581688563, -920.7751702909966, -1060.0094418113433, -985.8165647448916, -707.1253108345709, -761.666438222746, -718.0838775933024, -753.8799234876818, -912.6825006065798, -886.0253014907576, -850.697507711902, -757.4724784932018, -609.8784328109755, -882.3308110692128, -886.285045724919, -481.08934177726707, -794.1920531822366, -711.6784718845645, -848.8305485281672, -887.3004409764154, -522.0932866776407, -709.2056911835209, -600.2664043158451, -715.6813345032776, -821.8254331284692, -937.9442820285622, -730.0486852291759, -535.7589437723914, -1121.2834897081757, -582.8082993067468, -708.0427139636481, -1008.5458885392121, -849.3419183240953], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.52534486041303, "mean_inference_ms": 0.4208013283784433, "mean_action_processing_ms": 0.09846120608535808, "mean_env_wait_ms": 2.79394866335663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038576126098632812, "StateBufferConnector_ms": 0.002897024154663086, "ViewRequirementAgentConnector_ms": 0.072113037109375}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 254520, "num_agent_steps_trained": 254520, "num_env_steps_sampled": 254520, "num_env_steps_trained": 254520, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.002696961233866, "num_env_steps_trained_throughput_per_sec": 41.002696961233866, "timesteps_total": 254520, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 254520, "timers": {"training_iteration_time_ms": 2952.635, "sample_time_ms": 2931.39, "load_time_ms": 12.622, "load_throughput": 9506.905, "learn_time_ms": 4.245, "learn_throughput": 28269.695, "synch_weights_time_ms": 0.796}, "counters": {"num_env_steps_sampled": 254520, "num_env_steps_trained": 254520, "num_agent_steps_sampled": 254520, "num_agent_steps_trained": 254520}, "done": false, "episodes_total": 2121, "training_iteration": 531, "trial_id": "53665_00000", "date": "2023-07-26_03-35-25", "timestamp": 1690331725, "time_this_iter_s": 11.70990800857544, "time_total_s": 6465.660353422165, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 844.3348774909973, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 35.08125, "ram_util_percent": 76.79374999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-08, "entropy_coeff": 0.05, "policy_entropy": 267.50048828125, "policy_loss": -121736.4765625, "vf_loss": 6679334.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 287.0, "diff_num_grad_updates_vs_sampler_policy": 286.0}}, "num_env_steps_sampled": 255000, "num_env_steps_trained": 255000, "num_agent_steps_sampled": 255000, "num_agent_steps_trained": 255000}, "sampler_results": {"episode_reward_max": -292.21222727618317, "episode_reward_min": -1203.1219602777874, "episode_reward_mean": -753.0286642348199, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-320.6031240664431, -603.7100690444422, -728.4999169102664, -856.7111150625428, -530.4646661252414, -960.7057113477946, -667.4174388010184, -853.6703722145295, -714.45120732419, -896.1297332283533, -490.98605790250696, -563.8762354425565, -815.8561166327121, -791.6210861201384, -775.4429801673118, -730.3022775051776, -972.2752830050244, -582.7407996606615, -1058.1805385841717, -654.2821590709123, -714.762250754641, -767.0760586107676, -604.4258405419961, -817.9703285588729, -292.21222727618317, -741.0783275251554, -770.8117765901958, -915.112603108096, -669.8805313490843, -367.4418885706997, -799.9827632094997, -519.8745072495046, -806.6498885469076, -867.4250403636132, -654.7518312941235, -840.0890404173158, -1203.1219602777874, -522.5329041512487, -881.3467784518417, -860.1609636150134, -766.1518735418813, -540.8527192722173, -697.6865161125108, -842.4997766372727, -887.1778288513328, -953.0802454679492, -560.5160467973631, -821.1000508017892, -709.0977696137401, -672.5917323197915, -810.2125900542125, -561.1920790386728, -906.3649642823498, -1196.7773023427235, -798.4709598097372, -684.3452029841236, -782.3556538846735, -888.5636672899157, -601.5650805563787, -463.65506636846624, -416.1390728793751, -512.2823976150429, -598.093883976555, -857.7890581688563, -920.7751702909966, -1060.0094418113433, -985.8165647448916, -707.1253108345709, -761.666438222746, -718.0838775933024, -753.8799234876818, -912.6825006065798, -886.0253014907576, -850.697507711902, -757.4724784932018, -609.8784328109755, -882.3308110692128, -886.285045724919, -481.08934177726707, -794.1920531822366, -711.6784718845645, -848.8305485281672, -887.3004409764154, -522.0932866776407, -709.2056911835209, -600.2664043158451, -715.6813345032776, -821.8254331284692, -937.9442820285622, -730.0486852291759, -535.7589437723914, -1121.2834897081757, -582.8082993067468, -708.0427139636481, -1008.5458885392121, -849.3419183240953, -801.2879736130425, -738.39199592524, -896.1957660248137, -895.128718650913], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.520749531471292, "mean_inference_ms": 0.420583899642876, "mean_action_processing_ms": 0.09842547613380585, "mean_env_wait_ms": 2.7915656326589557, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037994384765625, "StateBufferConnector_ms": 0.002886056900024414, "ViewRequirementAgentConnector_ms": 0.07155942916870117}}, "episode_reward_max": -292.21222727618317, "episode_reward_min": -1203.1219602777874, "episode_reward_mean": -753.0286642348199, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-320.6031240664431, -603.7100690444422, -728.4999169102664, -856.7111150625428, -530.4646661252414, -960.7057113477946, -667.4174388010184, -853.6703722145295, -714.45120732419, -896.1297332283533, -490.98605790250696, -563.8762354425565, -815.8561166327121, -791.6210861201384, -775.4429801673118, -730.3022775051776, -972.2752830050244, -582.7407996606615, -1058.1805385841717, -654.2821590709123, -714.762250754641, -767.0760586107676, -604.4258405419961, -817.9703285588729, -292.21222727618317, -741.0783275251554, -770.8117765901958, -915.112603108096, -669.8805313490843, -367.4418885706997, -799.9827632094997, -519.8745072495046, -806.6498885469076, -867.4250403636132, -654.7518312941235, -840.0890404173158, -1203.1219602777874, -522.5329041512487, -881.3467784518417, -860.1609636150134, -766.1518735418813, -540.8527192722173, -697.6865161125108, -842.4997766372727, -887.1778288513328, -953.0802454679492, -560.5160467973631, -821.1000508017892, -709.0977696137401, -672.5917323197915, -810.2125900542125, -561.1920790386728, -906.3649642823498, -1196.7773023427235, -798.4709598097372, -684.3452029841236, -782.3556538846735, -888.5636672899157, -601.5650805563787, -463.65506636846624, -416.1390728793751, -512.2823976150429, -598.093883976555, -857.7890581688563, -920.7751702909966, -1060.0094418113433, -985.8165647448916, -707.1253108345709, -761.666438222746, -718.0838775933024, -753.8799234876818, -912.6825006065798, -886.0253014907576, -850.697507711902, -757.4724784932018, -609.8784328109755, -882.3308110692128, -886.285045724919, -481.08934177726707, -794.1920531822366, -711.6784718845645, -848.8305485281672, -887.3004409764154, -522.0932866776407, -709.2056911835209, -600.2664043158451, -715.6813345032776, -821.8254331284692, -937.9442820285622, -730.0486852291759, -535.7589437723914, -1121.2834897081757, -582.8082993067468, -708.0427139636481, -1008.5458885392121, -849.3419183240953, -801.2879736130425, -738.39199592524, -896.1957660248137, -895.128718650913], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.520749531471292, "mean_inference_ms": 0.420583899642876, "mean_action_processing_ms": 0.09842547613380585, "mean_env_wait_ms": 2.7915656326589557, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037994384765625, "StateBufferConnector_ms": 0.002886056900024414, "ViewRequirementAgentConnector_ms": 0.07155942916870117}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 255000, "num_agent_steps_trained": 255000, "num_env_steps_sampled": 255000, "num_env_steps_trained": 255000, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.54047144455074, "num_env_steps_trained_throughput_per_sec": 40.54047144455074, "timesteps_total": 255000, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 255000, "timers": {"training_iteration_time_ms": 2926.336, "sample_time_ms": 2905.069, "load_time_ms": 12.621, "load_throughput": 9507.839, "learn_time_ms": 4.267, "learn_throughput": 28123.424, "synch_weights_time_ms": 0.797}, "counters": {"num_env_steps_sampled": 255000, "num_env_steps_trained": 255000, "num_agent_steps_sampled": 255000, "num_agent_steps_trained": 255000}, "done": false, "episodes_total": 2125, "training_iteration": 532, "trial_id": "53665_00000", "date": "2023-07-26_03-35-36", "timestamp": 1690331736, "time_this_iter_s": 11.842873096466064, "time_total_s": 6477.503226518631, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 856.1777505874634, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 42.423529411764704, "ram_util_percent": 78.91176470588235}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-08, "entropy_coeff": 0.05, "policy_entropy": 267.4591979980469, "policy_loss": -94135.359375, "vf_loss": 4032378.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 291.0, "diff_num_grad_updates_vs_sampler_policy": 290.0}}, "num_env_steps_sampled": 255480, "num_env_steps_trained": 255480, "num_agent_steps_sampled": 255480, "num_agent_steps_trained": 255480}, "sampler_results": {"episode_reward_max": -292.21222727618317, "episode_reward_min": -1203.1219602777874, "episode_reward_mean": -755.5403793716822, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-530.4646661252414, -960.7057113477946, -667.4174388010184, -853.6703722145295, -714.45120732419, -896.1297332283533, -490.98605790250696, -563.8762354425565, -815.8561166327121, -791.6210861201384, -775.4429801673118, -730.3022775051776, -972.2752830050244, -582.7407996606615, -1058.1805385841717, -654.2821590709123, -714.762250754641, -767.0760586107676, -604.4258405419961, -817.9703285588729, -292.21222727618317, -741.0783275251554, -770.8117765901958, -915.112603108096, -669.8805313490843, -367.4418885706997, -799.9827632094997, -519.8745072495046, -806.6498885469076, -867.4250403636132, -654.7518312941235, -840.0890404173158, -1203.1219602777874, -522.5329041512487, -881.3467784518417, -860.1609636150134, -766.1518735418813, -540.8527192722173, -697.6865161125108, -842.4997766372727, -887.1778288513328, -953.0802454679492, -560.5160467973631, -821.1000508017892, -709.0977696137401, -672.5917323197915, -810.2125900542125, -561.1920790386728, -906.3649642823498, -1196.7773023427235, -798.4709598097372, -684.3452029841236, -782.3556538846735, -888.5636672899157, -601.5650805563787, -463.65506636846624, -416.1390728793751, -512.2823976150429, -598.093883976555, -857.7890581688563, -920.7751702909966, -1060.0094418113433, -985.8165647448916, -707.1253108345709, -761.666438222746, -718.0838775933024, -753.8799234876818, -912.6825006065798, -886.0253014907576, -850.697507711902, -757.4724784932018, -609.8784328109755, -882.3308110692128, -886.285045724919, -481.08934177726707, -794.1920531822366, -711.6784718845645, -848.8305485281672, -887.3004409764154, -522.0932866776407, -709.2056911835209, -600.2664043158451, -715.6813345032776, -821.8254331284692, -937.9442820285622, -730.0486852291759, -535.7589437723914, -1121.2834897081757, -582.8082993067468, -708.0427139636481, -1008.5458885392121, -849.3419183240953, -801.2879736130425, -738.39199592524, -896.1957660248137, -895.128718650913, -825.6136082124613, -882.8726763830157, -416.5620963072277, -635.6473578672366], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.51665764127982, "mean_inference_ms": 0.4203668276952823, "mean_action_processing_ms": 0.09838893585080044, "mean_env_wait_ms": 2.7892796883363076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038123130798339844, "StateBufferConnector_ms": 0.0028765201568603516, "ViewRequirementAgentConnector_ms": 0.07173514366149902}}, "episode_reward_max": -292.21222727618317, "episode_reward_min": -1203.1219602777874, "episode_reward_mean": -755.5403793716822, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-530.4646661252414, -960.7057113477946, -667.4174388010184, -853.6703722145295, -714.45120732419, -896.1297332283533, -490.98605790250696, -563.8762354425565, -815.8561166327121, -791.6210861201384, -775.4429801673118, -730.3022775051776, -972.2752830050244, -582.7407996606615, -1058.1805385841717, -654.2821590709123, -714.762250754641, -767.0760586107676, -604.4258405419961, -817.9703285588729, -292.21222727618317, -741.0783275251554, -770.8117765901958, -915.112603108096, -669.8805313490843, -367.4418885706997, -799.9827632094997, -519.8745072495046, -806.6498885469076, -867.4250403636132, -654.7518312941235, -840.0890404173158, -1203.1219602777874, -522.5329041512487, -881.3467784518417, -860.1609636150134, -766.1518735418813, -540.8527192722173, -697.6865161125108, -842.4997766372727, -887.1778288513328, -953.0802454679492, -560.5160467973631, -821.1000508017892, -709.0977696137401, -672.5917323197915, -810.2125900542125, -561.1920790386728, -906.3649642823498, -1196.7773023427235, -798.4709598097372, -684.3452029841236, -782.3556538846735, -888.5636672899157, -601.5650805563787, -463.65506636846624, -416.1390728793751, -512.2823976150429, -598.093883976555, -857.7890581688563, -920.7751702909966, -1060.0094418113433, -985.8165647448916, -707.1253108345709, -761.666438222746, -718.0838775933024, -753.8799234876818, -912.6825006065798, -886.0253014907576, -850.697507711902, -757.4724784932018, -609.8784328109755, -882.3308110692128, -886.285045724919, -481.08934177726707, -794.1920531822366, -711.6784718845645, -848.8305485281672, -887.3004409764154, -522.0932866776407, -709.2056911835209, -600.2664043158451, -715.6813345032776, -821.8254331284692, -937.9442820285622, -730.0486852291759, -535.7589437723914, -1121.2834897081757, -582.8082993067468, -708.0427139636481, -1008.5458885392121, -849.3419183240953, -801.2879736130425, -738.39199592524, -896.1957660248137, -895.128718650913, -825.6136082124613, -882.8726763830157, -416.5620963072277, -635.6473578672366], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.51665764127982, "mean_inference_ms": 0.4203668276952823, "mean_action_processing_ms": 0.09838893585080044, "mean_env_wait_ms": 2.7892796883363076, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038123130798339844, "StateBufferConnector_ms": 0.0028765201568603516, "ViewRequirementAgentConnector_ms": 0.07173514366149902}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 255480, "num_agent_steps_trained": 255480, "num_env_steps_sampled": 255480, "num_env_steps_trained": 255480, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.37597764946344, "num_env_steps_trained_throughput_per_sec": 40.37597764946344, "timesteps_total": 255480, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 255480, "timers": {"training_iteration_time_ms": 2946.071, "sample_time_ms": 2942.23, "load_time_ms": 0.223, "load_throughput": 538018.685, "learn_time_ms": 2.836, "learn_throughput": 42320.041, "synch_weights_time_ms": 0.741}, "counters": {"num_env_steps_sampled": 255480, "num_env_steps_trained": 255480, "num_agent_steps_sampled": 255480, "num_agent_steps_trained": 255480}, "done": false, "episodes_total": 2129, "training_iteration": 533, "trial_id": "53665_00000", "date": "2023-07-26_03-35-48", "timestamp": 1690331748, "time_this_iter_s": 11.891008853912354, "time_total_s": 6489.394235372543, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 868.0687594413757, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 44.805882352941175, "ram_util_percent": 78.13529411764705}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-08, "entropy_coeff": 0.05, "policy_entropy": 267.48504638671875, "policy_loss": -129649.5234375, "vf_loss": 6651945.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 295.0, "diff_num_grad_updates_vs_sampler_policy": 294.0}}, "num_env_steps_sampled": 255960, "num_env_steps_trained": 255960, "num_agent_steps_sampled": 255960, "num_agent_steps_trained": 255960}, "sampler_results": {"episode_reward_max": -292.21222727618317, "episode_reward_min": -1203.1219602777874, "episode_reward_mean": -758.2888021622255, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-714.45120732419, -896.1297332283533, -490.98605790250696, -563.8762354425565, -815.8561166327121, -791.6210861201384, -775.4429801673118, -730.3022775051776, -972.2752830050244, -582.7407996606615, -1058.1805385841717, -654.2821590709123, -714.762250754641, -767.0760586107676, -604.4258405419961, -817.9703285588729, -292.21222727618317, -741.0783275251554, -770.8117765901958, -915.112603108096, -669.8805313490843, -367.4418885706997, -799.9827632094997, -519.8745072495046, -806.6498885469076, -867.4250403636132, -654.7518312941235, -840.0890404173158, -1203.1219602777874, -522.5329041512487, -881.3467784518417, -860.1609636150134, -766.1518735418813, -540.8527192722173, -697.6865161125108, -842.4997766372727, -887.1778288513328, -953.0802454679492, -560.5160467973631, -821.1000508017892, -709.0977696137401, -672.5917323197915, -810.2125900542125, -561.1920790386728, -906.3649642823498, -1196.7773023427235, -798.4709598097372, -684.3452029841236, -782.3556538846735, -888.5636672899157, -601.5650805563787, -463.65506636846624, -416.1390728793751, -512.2823976150429, -598.093883976555, -857.7890581688563, -920.7751702909966, -1060.0094418113433, -985.8165647448916, -707.1253108345709, -761.666438222746, -718.0838775933024, -753.8799234876818, -912.6825006065798, -886.0253014907576, -850.697507711902, -757.4724784932018, -609.8784328109755, -882.3308110692128, -886.285045724919, -481.08934177726707, -794.1920531822366, -711.6784718845645, -848.8305485281672, -887.3004409764154, -522.0932866776407, -709.2056911835209, -600.2664043158451, -715.6813345032776, -821.8254331284692, -937.9442820285622, -730.0486852291759, -535.7589437723914, -1121.2834897081757, -582.8082993067468, -708.0427139636481, -1008.5458885392121, -849.3419183240953, -801.2879736130425, -738.39199592524, -896.1957660248137, -895.128718650913, -825.6136082124613, -882.8726763830157, -416.5620963072277, -635.6473578672366, -749.95019999497, -835.4811765437128, -805.439885115331, -896.2292058888935], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.51284657463973, "mean_inference_ms": 0.4201662203464342, "mean_action_processing_ms": 0.0983549383990136, "mean_env_wait_ms": 2.787123615255398, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038118362426757812, "StateBufferConnector_ms": 0.0028815269470214844, "ViewRequirementAgentConnector_ms": 0.07176852226257324}}, "episode_reward_max": -292.21222727618317, "episode_reward_min": -1203.1219602777874, "episode_reward_mean": -758.2888021622255, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-714.45120732419, -896.1297332283533, -490.98605790250696, -563.8762354425565, -815.8561166327121, -791.6210861201384, -775.4429801673118, -730.3022775051776, -972.2752830050244, -582.7407996606615, -1058.1805385841717, -654.2821590709123, -714.762250754641, -767.0760586107676, -604.4258405419961, -817.9703285588729, -292.21222727618317, -741.0783275251554, -770.8117765901958, -915.112603108096, -669.8805313490843, -367.4418885706997, -799.9827632094997, -519.8745072495046, -806.6498885469076, -867.4250403636132, -654.7518312941235, -840.0890404173158, -1203.1219602777874, -522.5329041512487, -881.3467784518417, -860.1609636150134, -766.1518735418813, -540.8527192722173, -697.6865161125108, -842.4997766372727, -887.1778288513328, -953.0802454679492, -560.5160467973631, -821.1000508017892, -709.0977696137401, -672.5917323197915, -810.2125900542125, -561.1920790386728, -906.3649642823498, -1196.7773023427235, -798.4709598097372, -684.3452029841236, -782.3556538846735, -888.5636672899157, -601.5650805563787, -463.65506636846624, -416.1390728793751, -512.2823976150429, -598.093883976555, -857.7890581688563, -920.7751702909966, -1060.0094418113433, -985.8165647448916, -707.1253108345709, -761.666438222746, -718.0838775933024, -753.8799234876818, -912.6825006065798, -886.0253014907576, -850.697507711902, -757.4724784932018, -609.8784328109755, -882.3308110692128, -886.285045724919, -481.08934177726707, -794.1920531822366, -711.6784718845645, -848.8305485281672, -887.3004409764154, -522.0932866776407, -709.2056911835209, -600.2664043158451, -715.6813345032776, -821.8254331284692, -937.9442820285622, -730.0486852291759, -535.7589437723914, -1121.2834897081757, -582.8082993067468, -708.0427139636481, -1008.5458885392121, -849.3419183240953, -801.2879736130425, -738.39199592524, -896.1957660248137, -895.128718650913, -825.6136082124613, -882.8726763830157, -416.5620963072277, -635.6473578672366, -749.95019999497, -835.4811765437128, -805.439885115331, -896.2292058888935], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.51284657463973, "mean_inference_ms": 0.4201662203464342, "mean_action_processing_ms": 0.0983549383990136, "mean_env_wait_ms": 2.787123615255398, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038118362426757812, "StateBufferConnector_ms": 0.0028815269470214844, "ViewRequirementAgentConnector_ms": 0.07176852226257324}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 255960, "num_agent_steps_trained": 255960, "num_env_steps_sampled": 255960, "num_env_steps_trained": 255960, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.144064057395916, "num_env_steps_trained_throughput_per_sec": 40.144064057395916, "timesteps_total": 255960, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 255960, "timers": {"training_iteration_time_ms": 2960.386, "sample_time_ms": 2956.577, "load_time_ms": 0.225, "load_throughput": 534249.528, "learn_time_ms": 2.819, "learn_throughput": 42564.121, "synch_weights_time_ms": 0.725}, "counters": {"num_env_steps_sampled": 255960, "num_env_steps_trained": 255960, "num_agent_steps_sampled": 255960, "num_agent_steps_trained": 255960}, "done": false, "episodes_total": 2133, "training_iteration": 534, "trial_id": "53665_00000", "date": "2023-07-26_03-36-00", "timestamp": 1690331760, "time_this_iter_s": 11.959730386734009, "time_total_s": 6501.353965759277, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 880.0284898281097, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 42.75294117647059, "ram_util_percent": 76.6764705882353}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.7499999999999995e-08, "entropy_coeff": 0.05, "policy_entropy": 267.5006103515625, "policy_loss": -73552.8125, "vf_loss": 2497559.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 299.0, "diff_num_grad_updates_vs_sampler_policy": 298.0}}, "num_env_steps_sampled": 256440, "num_env_steps_trained": 256440, "num_agent_steps_sampled": 256440, "num_agent_steps_trained": 256440}, "sampler_results": {"episode_reward_max": -292.21222727618317, "episode_reward_min": -1203.1219602777874, "episode_reward_mean": -763.4859793452856, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-815.8561166327121, -791.6210861201384, -775.4429801673118, -730.3022775051776, -972.2752830050244, -582.7407996606615, -1058.1805385841717, -654.2821590709123, -714.762250754641, -767.0760586107676, -604.4258405419961, -817.9703285588729, -292.21222727618317, -741.0783275251554, -770.8117765901958, -915.112603108096, -669.8805313490843, -367.4418885706997, -799.9827632094997, -519.8745072495046, -806.6498885469076, -867.4250403636132, -654.7518312941235, -840.0890404173158, -1203.1219602777874, -522.5329041512487, -881.3467784518417, -860.1609636150134, -766.1518735418813, -540.8527192722173, -697.6865161125108, -842.4997766372727, -887.1778288513328, -953.0802454679492, -560.5160467973631, -821.1000508017892, -709.0977696137401, -672.5917323197915, -810.2125900542125, -561.1920790386728, -906.3649642823498, -1196.7773023427235, -798.4709598097372, -684.3452029841236, -782.3556538846735, -888.5636672899157, -601.5650805563787, -463.65506636846624, -416.1390728793751, -512.2823976150429, -598.093883976555, -857.7890581688563, -920.7751702909966, -1060.0094418113433, -985.8165647448916, -707.1253108345709, -761.666438222746, -718.0838775933024, -753.8799234876818, -912.6825006065798, -886.0253014907576, -850.697507711902, -757.4724784932018, -609.8784328109755, -882.3308110692128, -886.285045724919, -481.08934177726707, -794.1920531822366, -711.6784718845645, -848.8305485281672, -887.3004409764154, -522.0932866776407, -709.2056911835209, -600.2664043158451, -715.6813345032776, -821.8254331284692, -937.9442820285622, -730.0486852291759, -535.7589437723914, -1121.2834897081757, -582.8082993067468, -708.0427139636481, -1008.5458885392121, -849.3419183240953, -801.2879736130425, -738.39199592524, -896.1957660248137, -895.128718650913, -825.6136082124613, -882.8726763830157, -416.5620963072277, -635.6473578672366, -749.95019999497, -835.4811765437128, -805.439885115331, -896.2292058888935, -964.0834131168805, -1013.652153672089, -588.2568382069389, -619.1685472077081], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.508816270696553, "mean_inference_ms": 0.42001499479681104, "mean_action_processing_ms": 0.0983289572619297, "mean_env_wait_ms": 2.7849624524880223, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003813028335571289, "StateBufferConnector_ms": 0.002880096435546875, "ViewRequirementAgentConnector_ms": 0.07176446914672852}}, "episode_reward_max": -292.21222727618317, "episode_reward_min": -1203.1219602777874, "episode_reward_mean": -763.4859793452856, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-815.8561166327121, -791.6210861201384, -775.4429801673118, -730.3022775051776, -972.2752830050244, -582.7407996606615, -1058.1805385841717, -654.2821590709123, -714.762250754641, -767.0760586107676, -604.4258405419961, -817.9703285588729, -292.21222727618317, -741.0783275251554, -770.8117765901958, -915.112603108096, -669.8805313490843, -367.4418885706997, -799.9827632094997, -519.8745072495046, -806.6498885469076, -867.4250403636132, -654.7518312941235, -840.0890404173158, -1203.1219602777874, -522.5329041512487, -881.3467784518417, -860.1609636150134, -766.1518735418813, -540.8527192722173, -697.6865161125108, -842.4997766372727, -887.1778288513328, -953.0802454679492, -560.5160467973631, -821.1000508017892, -709.0977696137401, -672.5917323197915, -810.2125900542125, -561.1920790386728, -906.3649642823498, -1196.7773023427235, -798.4709598097372, -684.3452029841236, -782.3556538846735, -888.5636672899157, -601.5650805563787, -463.65506636846624, -416.1390728793751, -512.2823976150429, -598.093883976555, -857.7890581688563, -920.7751702909966, -1060.0094418113433, -985.8165647448916, -707.1253108345709, -761.666438222746, -718.0838775933024, -753.8799234876818, -912.6825006065798, -886.0253014907576, -850.697507711902, -757.4724784932018, -609.8784328109755, -882.3308110692128, -886.285045724919, -481.08934177726707, -794.1920531822366, -711.6784718845645, -848.8305485281672, -887.3004409764154, -522.0932866776407, -709.2056911835209, -600.2664043158451, -715.6813345032776, -821.8254331284692, -937.9442820285622, -730.0486852291759, -535.7589437723914, -1121.2834897081757, -582.8082993067468, -708.0427139636481, -1008.5458885392121, -849.3419183240953, -801.2879736130425, -738.39199592524, -896.1957660248137, -895.128718650913, -825.6136082124613, -882.8726763830157, -416.5620963072277, -635.6473578672366, -749.95019999497, -835.4811765437128, -805.439885115331, -896.2292058888935, -964.0834131168805, -1013.652153672089, -588.2568382069389, -619.1685472077081], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.508816270696553, "mean_inference_ms": 0.42001499479681104, "mean_action_processing_ms": 0.0983289572619297, "mean_env_wait_ms": 2.7849624524880223, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003813028335571289, "StateBufferConnector_ms": 0.002880096435546875, "ViewRequirementAgentConnector_ms": 0.07176446914672852}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256440, "num_agent_steps_trained": 256440, "num_env_steps_sampled": 256440, "num_env_steps_trained": 256440, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.62482043598053, "num_env_steps_trained_throughput_per_sec": 40.62482043598053, "timesteps_total": 256440, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 256440, "timers": {"training_iteration_time_ms": 2973.386, "sample_time_ms": 2968.937, "load_time_ms": 0.262, "load_throughput": 458519.158, "learn_time_ms": 3.26, "learn_throughput": 36806.131, "synch_weights_time_ms": 0.859}, "counters": {"num_env_steps_sampled": 256440, "num_env_steps_trained": 256440, "num_agent_steps_sampled": 256440, "num_agent_steps_trained": 256440}, "done": false, "episodes_total": 2137, "training_iteration": 535, "trial_id": "53665_00000", "date": "2023-07-26_03-36-12", "timestamp": 1690331772, "time_this_iter_s": 11.818886995315552, "time_total_s": 6513.172852754593, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 891.8473768234253, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 46.48235294117647, "ram_util_percent": 77.74117647058824}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.25e-08, "entropy_coeff": 0.05, "policy_entropy": 267.49786376953125, "policy_loss": -40348.06640625, "vf_loss": 851383.875}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 303.0, "diff_num_grad_updates_vs_sampler_policy": 302.0}}, "num_env_steps_sampled": 256920, "num_env_steps_trained": 256920, "num_agent_steps_sampled": 256920, "num_agent_steps_trained": 256920}, "sampler_results": {"episode_reward_max": -292.21222727618317, "episode_reward_min": -1203.1219602777874, "episode_reward_mean": -757.9783620025015, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-972.2752830050244, -582.7407996606615, -1058.1805385841717, -654.2821590709123, -714.762250754641, -767.0760586107676, -604.4258405419961, -817.9703285588729, -292.21222727618317, -741.0783275251554, -770.8117765901958, -915.112603108096, -669.8805313490843, -367.4418885706997, -799.9827632094997, -519.8745072495046, -806.6498885469076, -867.4250403636132, -654.7518312941235, -840.0890404173158, -1203.1219602777874, -522.5329041512487, -881.3467784518417, -860.1609636150134, -766.1518735418813, -540.8527192722173, -697.6865161125108, -842.4997766372727, -887.1778288513328, -953.0802454679492, -560.5160467973631, -821.1000508017892, -709.0977696137401, -672.5917323197915, -810.2125900542125, -561.1920790386728, -906.3649642823498, -1196.7773023427235, -798.4709598097372, -684.3452029841236, -782.3556538846735, -888.5636672899157, -601.5650805563787, -463.65506636846624, -416.1390728793751, -512.2823976150429, -598.093883976555, -857.7890581688563, -920.7751702909966, -1060.0094418113433, -985.8165647448916, -707.1253108345709, -761.666438222746, -718.0838775933024, -753.8799234876818, -912.6825006065798, -886.0253014907576, -850.697507711902, -757.4724784932018, -609.8784328109755, -882.3308110692128, -886.285045724919, -481.08934177726707, -794.1920531822366, -711.6784718845645, -848.8305485281672, -887.3004409764154, -522.0932866776407, -709.2056911835209, -600.2664043158451, -715.6813345032776, -821.8254331284692, -937.9442820285622, -730.0486852291759, -535.7589437723914, -1121.2834897081757, -582.8082993067468, -708.0427139636481, -1008.5458885392121, -849.3419183240953, -801.2879736130425, -738.39199592524, -896.1957660248137, -895.128718650913, -825.6136082124613, -882.8726763830157, -416.5620963072277, -635.6473578672366, -749.95019999497, -835.4811765437128, -805.439885115331, -896.2292058888935, -964.0834131168805, -1013.652153672089, -588.2568382069389, -619.1685472077081, -961.3726654618121, -679.3912721613107, -545.6730933335284, -376.0236951902823], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.505074957248127, "mean_inference_ms": 0.41987023754777225, "mean_action_processing_ms": 0.09830687434079236, "mean_env_wait_ms": 2.782891033877993, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038175582885742188, "StateBufferConnector_ms": 0.0028886795043945312, "ViewRequirementAgentConnector_ms": 0.07184338569641113}}, "episode_reward_max": -292.21222727618317, "episode_reward_min": -1203.1219602777874, "episode_reward_mean": -757.9783620025015, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-972.2752830050244, -582.7407996606615, -1058.1805385841717, -654.2821590709123, -714.762250754641, -767.0760586107676, -604.4258405419961, -817.9703285588729, -292.21222727618317, -741.0783275251554, -770.8117765901958, -915.112603108096, -669.8805313490843, -367.4418885706997, -799.9827632094997, -519.8745072495046, -806.6498885469076, -867.4250403636132, -654.7518312941235, -840.0890404173158, -1203.1219602777874, -522.5329041512487, -881.3467784518417, -860.1609636150134, -766.1518735418813, -540.8527192722173, -697.6865161125108, -842.4997766372727, -887.1778288513328, -953.0802454679492, -560.5160467973631, -821.1000508017892, -709.0977696137401, -672.5917323197915, -810.2125900542125, -561.1920790386728, -906.3649642823498, -1196.7773023427235, -798.4709598097372, -684.3452029841236, -782.3556538846735, -888.5636672899157, -601.5650805563787, -463.65506636846624, -416.1390728793751, -512.2823976150429, -598.093883976555, -857.7890581688563, -920.7751702909966, -1060.0094418113433, -985.8165647448916, -707.1253108345709, -761.666438222746, -718.0838775933024, -753.8799234876818, -912.6825006065798, -886.0253014907576, -850.697507711902, -757.4724784932018, -609.8784328109755, -882.3308110692128, -886.285045724919, -481.08934177726707, -794.1920531822366, -711.6784718845645, -848.8305485281672, -887.3004409764154, -522.0932866776407, -709.2056911835209, -600.2664043158451, -715.6813345032776, -821.8254331284692, -937.9442820285622, -730.0486852291759, -535.7589437723914, -1121.2834897081757, -582.8082993067468, -708.0427139636481, -1008.5458885392121, -849.3419183240953, -801.2879736130425, -738.39199592524, -896.1957660248137, -895.128718650913, -825.6136082124613, -882.8726763830157, -416.5620963072277, -635.6473578672366, -749.95019999497, -835.4811765437128, -805.439885115331, -896.2292058888935, -964.0834131168805, -1013.652153672089, -588.2568382069389, -619.1685472077081, -961.3726654618121, -679.3912721613107, -545.6730933335284, -376.0236951902823], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.505074957248127, "mean_inference_ms": 0.41987023754777225, "mean_action_processing_ms": 0.09830687434079236, "mean_env_wait_ms": 2.782891033877993, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038175582885742188, "StateBufferConnector_ms": 0.0028886795043945312, "ViewRequirementAgentConnector_ms": 0.07184338569641113}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256920, "num_agent_steps_trained": 256920, "num_env_steps_sampled": 256920, "num_env_steps_trained": 256920, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.28309108609094, "num_env_steps_trained_throughput_per_sec": 41.28309108609094, "timesteps_total": 256920, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 256920, "timers": {"training_iteration_time_ms": 2949.998, "sample_time_ms": 2945.521, "load_time_ms": 0.261, "load_throughput": 460406.586, "learn_time_ms": 3.279, "learn_throughput": 36597.648, "synch_weights_time_ms": 0.869}, "counters": {"num_env_steps_sampled": 256920, "num_env_steps_trained": 256920, "num_agent_steps_sampled": 256920, "num_agent_steps_trained": 256920}, "done": false, "episodes_total": 2141, "training_iteration": 536, "trial_id": "53665_00000", "date": "2023-07-26_03-36-24", "timestamp": 1690331784, "time_this_iter_s": 11.62989330291748, "time_total_s": 6524.80274605751, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 903.4772701263428, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 40.42352941176471, "ram_util_percent": 76.9705882352941}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.75e-08, "entropy_coeff": 0.05, "policy_entropy": 267.4767150878906, "policy_loss": -71699.3515625, "vf_loss": 2339189.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 307.0, "diff_num_grad_updates_vs_sampler_policy": 306.0}}, "num_env_steps_sampled": 257400, "num_env_steps_trained": 257400, "num_agent_steps_sampled": 257400, "num_agent_steps_trained": 257400}, "sampler_results": {"episode_reward_max": -292.21222727618317, "episode_reward_min": -1203.1219602777874, "episode_reward_mean": -753.7723618199888, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-714.762250754641, -767.0760586107676, -604.4258405419961, -817.9703285588729, -292.21222727618317, -741.0783275251554, -770.8117765901958, -915.112603108096, -669.8805313490843, -367.4418885706997, -799.9827632094997, -519.8745072495046, -806.6498885469076, -867.4250403636132, -654.7518312941235, -840.0890404173158, -1203.1219602777874, -522.5329041512487, -881.3467784518417, -860.1609636150134, -766.1518735418813, -540.8527192722173, -697.6865161125108, -842.4997766372727, -887.1778288513328, -953.0802454679492, -560.5160467973631, -821.1000508017892, -709.0977696137401, -672.5917323197915, -810.2125900542125, -561.1920790386728, -906.3649642823498, -1196.7773023427235, -798.4709598097372, -684.3452029841236, -782.3556538846735, -888.5636672899157, -601.5650805563787, -463.65506636846624, -416.1390728793751, -512.2823976150429, -598.093883976555, -857.7890581688563, -920.7751702909966, -1060.0094418113433, -985.8165647448916, -707.1253108345709, -761.666438222746, -718.0838775933024, -753.8799234876818, -912.6825006065798, -886.0253014907576, -850.697507711902, -757.4724784932018, -609.8784328109755, -882.3308110692128, -886.285045724919, -481.08934177726707, -794.1920531822366, -711.6784718845645, -848.8305485281672, -887.3004409764154, -522.0932866776407, -709.2056911835209, -600.2664043158451, -715.6813345032776, -821.8254331284692, -937.9442820285622, -730.0486852291759, -535.7589437723914, -1121.2834897081757, -582.8082993067468, -708.0427139636481, -1008.5458885392121, -849.3419183240953, -801.2879736130425, -738.39199592524, -896.1957660248137, -895.128718650913, -825.6136082124613, -882.8726763830157, -416.5620963072277, -635.6473578672366, -749.95019999497, -835.4811765437128, -805.439885115331, -896.2292058888935, -964.0834131168805, -1013.652153672089, -588.2568382069389, -619.1685472077081, -961.3726654618121, -679.3912721613107, -545.6730933335284, -376.0236951902823, -653.1001606933421, -814.9315259429418, -854.8000692655935, -524.0470061676156], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.501509742185753, "mean_inference_ms": 0.41974039299508364, "mean_action_processing_ms": 0.09828774140128012, "mean_env_wait_ms": 2.7808973721048473, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003835439682006836, "StateBufferConnector_ms": 0.0028934478759765625, "ViewRequirementAgentConnector_ms": 0.07214760780334473}}, "episode_reward_max": -292.21222727618317, "episode_reward_min": -1203.1219602777874, "episode_reward_mean": -753.7723618199888, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-714.762250754641, -767.0760586107676, -604.4258405419961, -817.9703285588729, -292.21222727618317, -741.0783275251554, -770.8117765901958, -915.112603108096, -669.8805313490843, -367.4418885706997, -799.9827632094997, -519.8745072495046, -806.6498885469076, -867.4250403636132, -654.7518312941235, -840.0890404173158, -1203.1219602777874, -522.5329041512487, -881.3467784518417, -860.1609636150134, -766.1518735418813, -540.8527192722173, -697.6865161125108, -842.4997766372727, -887.1778288513328, -953.0802454679492, -560.5160467973631, -821.1000508017892, -709.0977696137401, -672.5917323197915, -810.2125900542125, -561.1920790386728, -906.3649642823498, -1196.7773023427235, -798.4709598097372, -684.3452029841236, -782.3556538846735, -888.5636672899157, -601.5650805563787, -463.65506636846624, -416.1390728793751, -512.2823976150429, -598.093883976555, -857.7890581688563, -920.7751702909966, -1060.0094418113433, -985.8165647448916, -707.1253108345709, -761.666438222746, -718.0838775933024, -753.8799234876818, -912.6825006065798, -886.0253014907576, -850.697507711902, -757.4724784932018, -609.8784328109755, -882.3308110692128, -886.285045724919, -481.08934177726707, -794.1920531822366, -711.6784718845645, -848.8305485281672, -887.3004409764154, -522.0932866776407, -709.2056911835209, -600.2664043158451, -715.6813345032776, -821.8254331284692, -937.9442820285622, -730.0486852291759, -535.7589437723914, -1121.2834897081757, -582.8082993067468, -708.0427139636481, -1008.5458885392121, -849.3419183240953, -801.2879736130425, -738.39199592524, -896.1957660248137, -895.128718650913, -825.6136082124613, -882.8726763830157, -416.5620963072277, -635.6473578672366, -749.95019999497, -835.4811765437128, -805.439885115331, -896.2292058888935, -964.0834131168805, -1013.652153672089, -588.2568382069389, -619.1685472077081, -961.3726654618121, -679.3912721613107, -545.6730933335284, -376.0236951902823, -653.1001606933421, -814.9315259429418, -854.8000692655935, -524.0470061676156], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.501509742185753, "mean_inference_ms": 0.41974039299508364, "mean_action_processing_ms": 0.09828774140128012, "mean_env_wait_ms": 2.7808973721048473, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003835439682006836, "StateBufferConnector_ms": 0.0028934478759765625, "ViewRequirementAgentConnector_ms": 0.07214760780334473}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 257400, "num_agent_steps_trained": 257400, "num_env_steps_sampled": 257400, "num_env_steps_trained": 257400, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.28113519054392, "num_env_steps_trained_throughput_per_sec": 40.28113519054392, "timesteps_total": 257400, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 257400, "timers": {"training_iteration_time_ms": 2944.165, "sample_time_ms": 2940.251, "load_time_ms": 0.224, "load_throughput": 535443.064, "learn_time_ms": 2.88, "learn_throughput": 41662.857, "synch_weights_time_ms": 0.762}, "counters": {"num_env_steps_sampled": 257400, "num_env_steps_trained": 257400, "num_agent_steps_sampled": 257400, "num_agent_steps_trained": 257400}, "done": false, "episodes_total": 2145, "training_iteration": 537, "trial_id": "53665_00000", "date": "2023-07-26_03-36-36", "timestamp": 1690331796, "time_this_iter_s": 11.918941974639893, "time_total_s": 6536.72168803215, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 915.3962121009827, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 42.11764705882353, "ram_util_percent": 77.35882352941177}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.25e-08, "entropy_coeff": 0.05, "policy_entropy": 267.4765625, "policy_loss": -132369.375, "vf_loss": 7541540.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 311.0, "diff_num_grad_updates_vs_sampler_policy": 310.0}}, "num_env_steps_sampled": 257880, "num_env_steps_trained": 257880, "num_agent_steps_sampled": 257880, "num_agent_steps_trained": 257880}, "sampler_results": {"episode_reward_max": -292.21222727618317, "episode_reward_min": -1203.1219602777874, "episode_reward_mean": -755.6934100589248, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-292.21222727618317, -741.0783275251554, -770.8117765901958, -915.112603108096, -669.8805313490843, -367.4418885706997, -799.9827632094997, -519.8745072495046, -806.6498885469076, -867.4250403636132, -654.7518312941235, -840.0890404173158, -1203.1219602777874, -522.5329041512487, -881.3467784518417, -860.1609636150134, -766.1518735418813, -540.8527192722173, -697.6865161125108, -842.4997766372727, -887.1778288513328, -953.0802454679492, -560.5160467973631, -821.1000508017892, -709.0977696137401, -672.5917323197915, -810.2125900542125, -561.1920790386728, -906.3649642823498, -1196.7773023427235, -798.4709598097372, -684.3452029841236, -782.3556538846735, -888.5636672899157, -601.5650805563787, -463.65506636846624, -416.1390728793751, -512.2823976150429, -598.093883976555, -857.7890581688563, -920.7751702909966, -1060.0094418113433, -985.8165647448916, -707.1253108345709, -761.666438222746, -718.0838775933024, -753.8799234876818, -912.6825006065798, -886.0253014907576, -850.697507711902, -757.4724784932018, -609.8784328109755, -882.3308110692128, -886.285045724919, -481.08934177726707, -794.1920531822366, -711.6784718845645, -848.8305485281672, -887.3004409764154, -522.0932866776407, -709.2056911835209, -600.2664043158451, -715.6813345032776, -821.8254331284692, -937.9442820285622, -730.0486852291759, -535.7589437723914, -1121.2834897081757, -582.8082993067468, -708.0427139636481, -1008.5458885392121, -849.3419183240953, -801.2879736130425, -738.39199592524, -896.1957660248137, -895.128718650913, -825.6136082124613, -882.8726763830157, -416.5620963072277, -635.6473578672366, -749.95019999497, -835.4811765437128, -805.439885115331, -896.2292058888935, -964.0834131168805, -1013.652153672089, -588.2568382069389, -619.1685472077081, -961.3726654618121, -679.3912721613107, -545.6730933335284, -376.0236951902823, -653.1001606933421, -814.9315259429418, -854.8000692655935, -524.0470061676156, -605.0998920006286, -708.1750676846361, -810.0858574256316, -972.9784852489795], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.498394856939054, "mean_inference_ms": 0.41961503493924907, "mean_action_processing_ms": 0.09826917627235109, "mean_env_wait_ms": 2.7789952883162643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003827333450317383, "StateBufferConnector_ms": 0.002893686294555664, "ViewRequirementAgentConnector_ms": 0.07202768325805664}}, "episode_reward_max": -292.21222727618317, "episode_reward_min": -1203.1219602777874, "episode_reward_mean": -755.6934100589248, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-292.21222727618317, -741.0783275251554, -770.8117765901958, -915.112603108096, -669.8805313490843, -367.4418885706997, -799.9827632094997, -519.8745072495046, -806.6498885469076, -867.4250403636132, -654.7518312941235, -840.0890404173158, -1203.1219602777874, -522.5329041512487, -881.3467784518417, -860.1609636150134, -766.1518735418813, -540.8527192722173, -697.6865161125108, -842.4997766372727, -887.1778288513328, -953.0802454679492, -560.5160467973631, -821.1000508017892, -709.0977696137401, -672.5917323197915, -810.2125900542125, -561.1920790386728, -906.3649642823498, -1196.7773023427235, -798.4709598097372, -684.3452029841236, -782.3556538846735, -888.5636672899157, -601.5650805563787, -463.65506636846624, -416.1390728793751, -512.2823976150429, -598.093883976555, -857.7890581688563, -920.7751702909966, -1060.0094418113433, -985.8165647448916, -707.1253108345709, -761.666438222746, -718.0838775933024, -753.8799234876818, -912.6825006065798, -886.0253014907576, -850.697507711902, -757.4724784932018, -609.8784328109755, -882.3308110692128, -886.285045724919, -481.08934177726707, -794.1920531822366, -711.6784718845645, -848.8305485281672, -887.3004409764154, -522.0932866776407, -709.2056911835209, -600.2664043158451, -715.6813345032776, -821.8254331284692, -937.9442820285622, -730.0486852291759, -535.7589437723914, -1121.2834897081757, -582.8082993067468, -708.0427139636481, -1008.5458885392121, -849.3419183240953, -801.2879736130425, -738.39199592524, -896.1957660248137, -895.128718650913, -825.6136082124613, -882.8726763830157, -416.5620963072277, -635.6473578672366, -749.95019999497, -835.4811765437128, -805.439885115331, -896.2292058888935, -964.0834131168805, -1013.652153672089, -588.2568382069389, -619.1685472077081, -961.3726654618121, -679.3912721613107, -545.6730933335284, -376.0236951902823, -653.1001606933421, -814.9315259429418, -854.8000692655935, -524.0470061676156, -605.0998920006286, -708.1750676846361, -810.0858574256316, -972.9784852489795], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.498394856939054, "mean_inference_ms": 0.41961503493924907, "mean_action_processing_ms": 0.09826917627235109, "mean_env_wait_ms": 2.7789952883162643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003827333450317383, "StateBufferConnector_ms": 0.002893686294555664, "ViewRequirementAgentConnector_ms": 0.07202768325805664}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 257880, "num_agent_steps_trained": 257880, "num_env_steps_sampled": 257880, "num_env_steps_trained": 257880, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.98993102242688, "num_env_steps_trained_throughput_per_sec": 40.98993102242688, "timesteps_total": 257880, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 257880, "timers": {"training_iteration_time_ms": 2929.778, "sample_time_ms": 2925.991, "load_time_ms": 0.218, "load_throughput": 551036.216, "learn_time_ms": 2.794, "learn_throughput": 42950.589, "synch_weights_time_ms": 0.735}, "counters": {"num_env_steps_sampled": 257880, "num_env_steps_trained": 257880, "num_agent_steps_sampled": 257880, "num_agent_steps_trained": 257880}, "done": false, "episodes_total": 2149, "training_iteration": 538, "trial_id": "53665_00000", "date": "2023-07-26_03-36-48", "timestamp": 1690331808, "time_this_iter_s": 11.71288514137268, "time_total_s": 6548.434573173523, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 927.1090972423553, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 41.58125, "ram_util_percent": 77.63125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.7499999999999998e-08, "entropy_coeff": 0.05, "policy_entropy": 267.4776611328125, "policy_loss": -96121.640625, "vf_loss": 3868206.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 315.0, "diff_num_grad_updates_vs_sampler_policy": 314.0}}, "num_env_steps_sampled": 258360, "num_env_steps_trained": 258360, "num_agent_steps_sampled": 258360, "num_agent_steps_trained": 258360}, "sampler_results": {"episode_reward_max": -367.4418885706997, "episode_reward_min": -1203.1219602777874, "episode_reward_mean": -755.1163160754468, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-669.8805313490843, -367.4418885706997, -799.9827632094997, -519.8745072495046, -806.6498885469076, -867.4250403636132, -654.7518312941235, -840.0890404173158, -1203.1219602777874, -522.5329041512487, -881.3467784518417, -860.1609636150134, -766.1518735418813, -540.8527192722173, -697.6865161125108, -842.4997766372727, -887.1778288513328, -953.0802454679492, -560.5160467973631, -821.1000508017892, -709.0977696137401, -672.5917323197915, -810.2125900542125, -561.1920790386728, -906.3649642823498, -1196.7773023427235, -798.4709598097372, -684.3452029841236, -782.3556538846735, -888.5636672899157, -601.5650805563787, -463.65506636846624, -416.1390728793751, -512.2823976150429, -598.093883976555, -857.7890581688563, -920.7751702909966, -1060.0094418113433, -985.8165647448916, -707.1253108345709, -761.666438222746, -718.0838775933024, -753.8799234876818, -912.6825006065798, -886.0253014907576, -850.697507711902, -757.4724784932018, -609.8784328109755, -882.3308110692128, -886.285045724919, -481.08934177726707, -794.1920531822366, -711.6784718845645, -848.8305485281672, -887.3004409764154, -522.0932866776407, -709.2056911835209, -600.2664043158451, -715.6813345032776, -821.8254331284692, -937.9442820285622, -730.0486852291759, -535.7589437723914, -1121.2834897081757, -582.8082993067468, -708.0427139636481, -1008.5458885392121, -849.3419183240953, -801.2879736130425, -738.39199592524, -896.1957660248137, -895.128718650913, -825.6136082124613, -882.8726763830157, -416.5620963072277, -635.6473578672366, -749.95019999497, -835.4811765437128, -805.439885115331, -896.2292058888935, -964.0834131168805, -1013.652153672089, -588.2568382069389, -619.1685472077081, -961.3726654618121, -679.3912721613107, -545.6730933335284, -376.0236951902823, -653.1001606933421, -814.9315259429418, -854.8000692655935, -524.0470061676156, -605.0998920006286, -708.1750676846361, -810.0858574256316, -972.9784852489795, -465.0305409430647, -820.7630550745884, -674.1608211203869, -701.5511190138091], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.495454298305948, "mean_inference_ms": 0.41948458736510175, "mean_action_processing_ms": 0.0982496863864734, "mean_env_wait_ms": 2.777168991371171, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038084983825683594, "StateBufferConnector_ms": 0.002881288528442383, "ViewRequirementAgentConnector_ms": 0.07141351699829102}}, "episode_reward_max": -367.4418885706997, "episode_reward_min": -1203.1219602777874, "episode_reward_mean": -755.1163160754468, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-669.8805313490843, -367.4418885706997, -799.9827632094997, -519.8745072495046, -806.6498885469076, -867.4250403636132, -654.7518312941235, -840.0890404173158, -1203.1219602777874, -522.5329041512487, -881.3467784518417, -860.1609636150134, -766.1518735418813, -540.8527192722173, -697.6865161125108, -842.4997766372727, -887.1778288513328, -953.0802454679492, -560.5160467973631, -821.1000508017892, -709.0977696137401, -672.5917323197915, -810.2125900542125, -561.1920790386728, -906.3649642823498, -1196.7773023427235, -798.4709598097372, -684.3452029841236, -782.3556538846735, -888.5636672899157, -601.5650805563787, -463.65506636846624, -416.1390728793751, -512.2823976150429, -598.093883976555, -857.7890581688563, -920.7751702909966, -1060.0094418113433, -985.8165647448916, -707.1253108345709, -761.666438222746, -718.0838775933024, -753.8799234876818, -912.6825006065798, -886.0253014907576, -850.697507711902, -757.4724784932018, -609.8784328109755, -882.3308110692128, -886.285045724919, -481.08934177726707, -794.1920531822366, -711.6784718845645, -848.8305485281672, -887.3004409764154, -522.0932866776407, -709.2056911835209, -600.2664043158451, -715.6813345032776, -821.8254331284692, -937.9442820285622, -730.0486852291759, -535.7589437723914, -1121.2834897081757, -582.8082993067468, -708.0427139636481, -1008.5458885392121, -849.3419183240953, -801.2879736130425, -738.39199592524, -896.1957660248137, -895.128718650913, -825.6136082124613, -882.8726763830157, -416.5620963072277, -635.6473578672366, -749.95019999497, -835.4811765437128, -805.439885115331, -896.2292058888935, -964.0834131168805, -1013.652153672089, -588.2568382069389, -619.1685472077081, -961.3726654618121, -679.3912721613107, -545.6730933335284, -376.0236951902823, -653.1001606933421, -814.9315259429418, -854.8000692655935, -524.0470061676156, -605.0998920006286, -708.1750676846361, -810.0858574256316, -972.9784852489795, -465.0305409430647, -820.7630550745884, -674.1608211203869, -701.5511190138091], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.495454298305948, "mean_inference_ms": 0.41948458736510175, "mean_action_processing_ms": 0.0982496863864734, "mean_env_wait_ms": 2.777168991371171, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038084983825683594, "StateBufferConnector_ms": 0.002881288528442383, "ViewRequirementAgentConnector_ms": 0.07141351699829102}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 258360, "num_agent_steps_trained": 258360, "num_env_steps_sampled": 258360, "num_env_steps_trained": 258360, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.978351551805794, "num_env_steps_trained_throughput_per_sec": 40.978351551805794, "timesteps_total": 258360, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 258360, "timers": {"training_iteration_time_ms": 2910.969, "sample_time_ms": 2907.211, "load_time_ms": 0.218, "load_throughput": 550734.741, "learn_time_ms": 2.793, "learn_throughput": 42963.421, "synch_weights_time_ms": 0.707}, "counters": {"num_env_steps_sampled": 258360, "num_env_steps_trained": 258360, "num_agent_steps_sampled": 258360, "num_agent_steps_trained": 258360}, "done": false, "episodes_total": 2153, "training_iteration": 539, "trial_id": "53665_00000", "date": "2023-07-26_03-36-59", "timestamp": 1690331819, "time_this_iter_s": 11.716347932815552, "time_total_s": 6560.1509211063385, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 938.8254451751709, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 38.44117647058823, "ram_util_percent": 77.68235294117646}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-08, "entropy_coeff": 0.05, "policy_entropy": 267.4865417480469, "policy_loss": -138633.15625, "vf_loss": 8695254.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 319.0, "diff_num_grad_updates_vs_sampler_policy": 318.0}}, "num_env_steps_sampled": 258840, "num_env_steps_trained": 258840, "num_agent_steps_sampled": 258840, "num_agent_steps_trained": 258840}, "sampler_results": {"episode_reward_max": -376.0236951902823, "episode_reward_min": -1203.1219602777874, "episode_reward_mean": -767.2958795465564, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-806.6498885469076, -867.4250403636132, -654.7518312941235, -840.0890404173158, -1203.1219602777874, -522.5329041512487, -881.3467784518417, -860.1609636150134, -766.1518735418813, -540.8527192722173, -697.6865161125108, -842.4997766372727, -887.1778288513328, -953.0802454679492, -560.5160467973631, -821.1000508017892, -709.0977696137401, -672.5917323197915, -810.2125900542125, -561.1920790386728, -906.3649642823498, -1196.7773023427235, -798.4709598097372, -684.3452029841236, -782.3556538846735, -888.5636672899157, -601.5650805563787, -463.65506636846624, -416.1390728793751, -512.2823976150429, -598.093883976555, -857.7890581688563, -920.7751702909966, -1060.0094418113433, -985.8165647448916, -707.1253108345709, -761.666438222746, -718.0838775933024, -753.8799234876818, -912.6825006065798, -886.0253014907576, -850.697507711902, -757.4724784932018, -609.8784328109755, -882.3308110692128, -886.285045724919, -481.08934177726707, -794.1920531822366, -711.6784718845645, -848.8305485281672, -887.3004409764154, -522.0932866776407, -709.2056911835209, -600.2664043158451, -715.6813345032776, -821.8254331284692, -937.9442820285622, -730.0486852291759, -535.7589437723914, -1121.2834897081757, -582.8082993067468, -708.0427139636481, -1008.5458885392121, -849.3419183240953, -801.2879736130425, -738.39199592524, -896.1957660248137, -895.128718650913, -825.6136082124613, -882.8726763830157, -416.5620963072277, -635.6473578672366, -749.95019999497, -835.4811765437128, -805.439885115331, -896.2292058888935, -964.0834131168805, -1013.652153672089, -588.2568382069389, -619.1685472077081, -961.3726654618121, -679.3912721613107, -545.6730933335284, -376.0236951902823, -653.1001606933421, -814.9315259429418, -854.8000692655935, -524.0470061676156, -605.0998920006286, -708.1750676846361, -810.0858574256316, -972.9784852489795, -465.0305409430647, -820.7630550745884, -674.1608211203869, -701.5511190138091, -1015.8245870393804, -688.1877178368541, -913.7429877270883, -957.3807448864148], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.49257264045358, "mean_inference_ms": 0.41936684262717544, "mean_action_processing_ms": 0.09823214608799806, "mean_env_wait_ms": 2.7754730089387487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003833293914794922, "StateBufferConnector_ms": 0.0028934478759765625, "ViewRequirementAgentConnector_ms": 0.07177066802978516}}, "episode_reward_max": -376.0236951902823, "episode_reward_min": -1203.1219602777874, "episode_reward_mean": -767.2958795465564, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-806.6498885469076, -867.4250403636132, -654.7518312941235, -840.0890404173158, -1203.1219602777874, -522.5329041512487, -881.3467784518417, -860.1609636150134, -766.1518735418813, -540.8527192722173, -697.6865161125108, -842.4997766372727, -887.1778288513328, -953.0802454679492, -560.5160467973631, -821.1000508017892, -709.0977696137401, -672.5917323197915, -810.2125900542125, -561.1920790386728, -906.3649642823498, -1196.7773023427235, -798.4709598097372, -684.3452029841236, -782.3556538846735, -888.5636672899157, -601.5650805563787, -463.65506636846624, -416.1390728793751, -512.2823976150429, -598.093883976555, -857.7890581688563, -920.7751702909966, -1060.0094418113433, -985.8165647448916, -707.1253108345709, -761.666438222746, -718.0838775933024, -753.8799234876818, -912.6825006065798, -886.0253014907576, -850.697507711902, -757.4724784932018, -609.8784328109755, -882.3308110692128, -886.285045724919, -481.08934177726707, -794.1920531822366, -711.6784718845645, -848.8305485281672, -887.3004409764154, -522.0932866776407, -709.2056911835209, -600.2664043158451, -715.6813345032776, -821.8254331284692, -937.9442820285622, -730.0486852291759, -535.7589437723914, -1121.2834897081757, -582.8082993067468, -708.0427139636481, -1008.5458885392121, -849.3419183240953, -801.2879736130425, -738.39199592524, -896.1957660248137, -895.128718650913, -825.6136082124613, -882.8726763830157, -416.5620963072277, -635.6473578672366, -749.95019999497, -835.4811765437128, -805.439885115331, -896.2292058888935, -964.0834131168805, -1013.652153672089, -588.2568382069389, -619.1685472077081, -961.3726654618121, -679.3912721613107, -545.6730933335284, -376.0236951902823, -653.1001606933421, -814.9315259429418, -854.8000692655935, -524.0470061676156, -605.0998920006286, -708.1750676846361, -810.0858574256316, -972.9784852489795, -465.0305409430647, -820.7630550745884, -674.1608211203869, -701.5511190138091, -1015.8245870393804, -688.1877178368541, -913.7429877270883, -957.3807448864148], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.49257264045358, "mean_inference_ms": 0.41936684262717544, "mean_action_processing_ms": 0.09823214608799806, "mean_env_wait_ms": 2.7754730089387487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003833293914794922, "StateBufferConnector_ms": 0.0028934478759765625, "ViewRequirementAgentConnector_ms": 0.07177066802978516}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 258840, "num_agent_steps_trained": 258840, "num_env_steps_sampled": 258840, "num_env_steps_trained": 258840, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.959224181361634, "num_env_steps_trained_throughput_per_sec": 40.959224181361634, "timesteps_total": 258840, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 258840, "timers": {"training_iteration_time_ms": 2935.453, "sample_time_ms": 2931.56, "load_time_ms": 0.229, "load_throughput": 523306.8, "learn_time_ms": 2.905, "learn_throughput": 41307.592, "synch_weights_time_ms": 0.713}, "counters": {"num_env_steps_sampled": 258840, "num_env_steps_trained": 258840, "num_agent_steps_sampled": 258840, "num_agent_steps_trained": 258840}, "done": false, "episodes_total": 2157, "training_iteration": 540, "trial_id": "53665_00000", "date": "2023-07-26_03-37-11", "timestamp": 1690331831, "time_this_iter_s": 11.721693992614746, "time_total_s": 6571.872615098953, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 950.5471391677856, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 48.37058823529412, "ram_util_percent": 76.58823529411765}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-08, "entropy_coeff": 0.05, "policy_entropy": 267.4685974121094, "policy_loss": -76781.5703125, "vf_loss": 3057246.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 323.0, "diff_num_grad_updates_vs_sampler_policy": 322.0}}, "num_env_steps_sampled": 259320, "num_env_steps_trained": 259320, "num_agent_steps_sampled": 259320, "num_agent_steps_trained": 259320}, "sampler_results": {"episode_reward_max": -376.0236951902823, "episode_reward_min": -1203.1219602777874, "episode_reward_mean": -770.1454259161444, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1203.1219602777874, -522.5329041512487, -881.3467784518417, -860.1609636150134, -766.1518735418813, -540.8527192722173, -697.6865161125108, -842.4997766372727, -887.1778288513328, -953.0802454679492, -560.5160467973631, -821.1000508017892, -709.0977696137401, -672.5917323197915, -810.2125900542125, -561.1920790386728, -906.3649642823498, -1196.7773023427235, -798.4709598097372, -684.3452029841236, -782.3556538846735, -888.5636672899157, -601.5650805563787, -463.65506636846624, -416.1390728793751, -512.2823976150429, -598.093883976555, -857.7890581688563, -920.7751702909966, -1060.0094418113433, -985.8165647448916, -707.1253108345709, -761.666438222746, -718.0838775933024, -753.8799234876818, -912.6825006065798, -886.0253014907576, -850.697507711902, -757.4724784932018, -609.8784328109755, -882.3308110692128, -886.285045724919, -481.08934177726707, -794.1920531822366, -711.6784718845645, -848.8305485281672, -887.3004409764154, -522.0932866776407, -709.2056911835209, -600.2664043158451, -715.6813345032776, -821.8254331284692, -937.9442820285622, -730.0486852291759, -535.7589437723914, -1121.2834897081757, -582.8082993067468, -708.0427139636481, -1008.5458885392121, -849.3419183240953, -801.2879736130425, -738.39199592524, -896.1957660248137, -895.128718650913, -825.6136082124613, -882.8726763830157, -416.5620963072277, -635.6473578672366, -749.95019999497, -835.4811765437128, -805.439885115331, -896.2292058888935, -964.0834131168805, -1013.652153672089, -588.2568382069389, -619.1685472077081, -961.3726654618121, -679.3912721613107, -545.6730933335284, -376.0236951902823, -653.1001606933421, -814.9315259429418, -854.8000692655935, -524.0470061676156, -605.0998920006286, -708.1750676846361, -810.0858574256316, -972.9784852489795, -465.0305409430647, -820.7630550745884, -674.1608211203869, -701.5511190138091, -1015.8245870393804, -688.1877178368541, -913.7429877270883, -957.3807448864148, -980.690926533723, -635.8164732742916, -1038.9959112623549, -798.3671265104039], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.489743289430763, "mean_inference_ms": 0.41926269069967, "mean_action_processing_ms": 0.09821797423011322, "mean_env_wait_ms": 2.7737125828219025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038192272186279297, "StateBufferConnector_ms": 0.002880573272705078, "ViewRequirementAgentConnector_ms": 0.07160067558288574}}, "episode_reward_max": -376.0236951902823, "episode_reward_min": -1203.1219602777874, "episode_reward_mean": -770.1454259161444, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1203.1219602777874, -522.5329041512487, -881.3467784518417, -860.1609636150134, -766.1518735418813, -540.8527192722173, -697.6865161125108, -842.4997766372727, -887.1778288513328, -953.0802454679492, -560.5160467973631, -821.1000508017892, -709.0977696137401, -672.5917323197915, -810.2125900542125, -561.1920790386728, -906.3649642823498, -1196.7773023427235, -798.4709598097372, -684.3452029841236, -782.3556538846735, -888.5636672899157, -601.5650805563787, -463.65506636846624, -416.1390728793751, -512.2823976150429, -598.093883976555, -857.7890581688563, -920.7751702909966, -1060.0094418113433, -985.8165647448916, -707.1253108345709, -761.666438222746, -718.0838775933024, -753.8799234876818, -912.6825006065798, -886.0253014907576, -850.697507711902, -757.4724784932018, -609.8784328109755, -882.3308110692128, -886.285045724919, -481.08934177726707, -794.1920531822366, -711.6784718845645, -848.8305485281672, -887.3004409764154, -522.0932866776407, -709.2056911835209, -600.2664043158451, -715.6813345032776, -821.8254331284692, -937.9442820285622, -730.0486852291759, -535.7589437723914, -1121.2834897081757, -582.8082993067468, -708.0427139636481, -1008.5458885392121, -849.3419183240953, -801.2879736130425, -738.39199592524, -896.1957660248137, -895.128718650913, -825.6136082124613, -882.8726763830157, -416.5620963072277, -635.6473578672366, -749.95019999497, -835.4811765437128, -805.439885115331, -896.2292058888935, -964.0834131168805, -1013.652153672089, -588.2568382069389, -619.1685472077081, -961.3726654618121, -679.3912721613107, -545.6730933335284, -376.0236951902823, -653.1001606933421, -814.9315259429418, -854.8000692655935, -524.0470061676156, -605.0998920006286, -708.1750676846361, -810.0858574256316, -972.9784852489795, -465.0305409430647, -820.7630550745884, -674.1608211203869, -701.5511190138091, -1015.8245870393804, -688.1877178368541, -913.7429877270883, -957.3807448864148, -980.690926533723, -635.8164732742916, -1038.9959112623549, -798.3671265104039], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.489743289430763, "mean_inference_ms": 0.41926269069967, "mean_action_processing_ms": 0.09821797423011322, "mean_env_wait_ms": 2.7737125828219025, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038192272186279297, "StateBufferConnector_ms": 0.002880573272705078, "ViewRequirementAgentConnector_ms": 0.07160067558288574}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 259320, "num_agent_steps_trained": 259320, "num_env_steps_sampled": 259320, "num_env_steps_trained": 259320, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.82132526071355, "num_env_steps_trained_throughput_per_sec": 40.82132526071355, "timesteps_total": 259320, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 259320, "timers": {"training_iteration_time_ms": 2942.165, "sample_time_ms": 2938.218, "load_time_ms": 0.231, "load_throughput": 520277.527, "learn_time_ms": 2.936, "learn_throughput": 40867.543, "synch_weights_time_ms": 0.734}, "counters": {"num_env_steps_sampled": 259320, "num_env_steps_trained": 259320, "num_agent_steps_sampled": 259320, "num_agent_steps_trained": 259320}, "done": false, "episodes_total": 2161, "training_iteration": 541, "trial_id": "53665_00000", "date": "2023-07-26_03-37-23", "timestamp": 1690331843, "time_this_iter_s": 11.761383056640625, "time_total_s": 6583.633998155594, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 962.3085222244263, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 41.86875, "ram_util_percent": 75.325}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-08, "entropy_coeff": 0.05, "policy_entropy": 267.488525390625, "policy_loss": -78556.1171875, "vf_loss": 2527076.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 327.0, "diff_num_grad_updates_vs_sampler_policy": 326.0}}, "num_env_steps_sampled": 259800, "num_env_steps_trained": 259800, "num_agent_steps_sampled": 259800, "num_agent_steps_trained": 259800}, "sampler_results": {"episode_reward_max": -376.0236951902823, "episode_reward_min": -1196.7773023427235, "episode_reward_mean": -766.57436489196, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-766.1518735418813, -540.8527192722173, -697.6865161125108, -842.4997766372727, -887.1778288513328, -953.0802454679492, -560.5160467973631, -821.1000508017892, -709.0977696137401, -672.5917323197915, -810.2125900542125, -561.1920790386728, -906.3649642823498, -1196.7773023427235, -798.4709598097372, -684.3452029841236, -782.3556538846735, -888.5636672899157, -601.5650805563787, -463.65506636846624, -416.1390728793751, -512.2823976150429, -598.093883976555, -857.7890581688563, -920.7751702909966, -1060.0094418113433, -985.8165647448916, -707.1253108345709, -761.666438222746, -718.0838775933024, -753.8799234876818, -912.6825006065798, -886.0253014907576, -850.697507711902, -757.4724784932018, -609.8784328109755, -882.3308110692128, -886.285045724919, -481.08934177726707, -794.1920531822366, -711.6784718845645, -848.8305485281672, -887.3004409764154, -522.0932866776407, -709.2056911835209, -600.2664043158451, -715.6813345032776, -821.8254331284692, -937.9442820285622, -730.0486852291759, -535.7589437723914, -1121.2834897081757, -582.8082993067468, -708.0427139636481, -1008.5458885392121, -849.3419183240953, -801.2879736130425, -738.39199592524, -896.1957660248137, -895.128718650913, -825.6136082124613, -882.8726763830157, -416.5620963072277, -635.6473578672366, -749.95019999497, -835.4811765437128, -805.439885115331, -896.2292058888935, -964.0834131168805, -1013.652153672089, -588.2568382069389, -619.1685472077081, -961.3726654618121, -679.3912721613107, -545.6730933335284, -376.0236951902823, -653.1001606933421, -814.9315259429418, -854.8000692655935, -524.0470061676156, -605.0998920006286, -708.1750676846361, -810.0858574256316, -972.9784852489795, -465.0305409430647, -820.7630550745884, -674.1608211203869, -701.5511190138091, -1015.8245870393804, -688.1877178368541, -913.7429877270883, -957.3807448864148, -980.690926533723, -635.8164732742916, -1038.9959112623549, -798.3671265104039, -985.0507328121622, -909.7584013792837, -664.9043829806535, -550.3429869053524], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.486427810827127, "mean_inference_ms": 0.41914360971058995, "mean_action_processing_ms": 0.09820066159683825, "mean_env_wait_ms": 2.7719491563925143, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038263797760009766, "StateBufferConnector_ms": 0.0028727054595947266, "ViewRequirementAgentConnector_ms": 0.07145142555236816}}, "episode_reward_max": -376.0236951902823, "episode_reward_min": -1196.7773023427235, "episode_reward_mean": -766.57436489196, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-766.1518735418813, -540.8527192722173, -697.6865161125108, -842.4997766372727, -887.1778288513328, -953.0802454679492, -560.5160467973631, -821.1000508017892, -709.0977696137401, -672.5917323197915, -810.2125900542125, -561.1920790386728, -906.3649642823498, -1196.7773023427235, -798.4709598097372, -684.3452029841236, -782.3556538846735, -888.5636672899157, -601.5650805563787, -463.65506636846624, -416.1390728793751, -512.2823976150429, -598.093883976555, -857.7890581688563, -920.7751702909966, -1060.0094418113433, -985.8165647448916, -707.1253108345709, -761.666438222746, -718.0838775933024, -753.8799234876818, -912.6825006065798, -886.0253014907576, -850.697507711902, -757.4724784932018, -609.8784328109755, -882.3308110692128, -886.285045724919, -481.08934177726707, -794.1920531822366, -711.6784718845645, -848.8305485281672, -887.3004409764154, -522.0932866776407, -709.2056911835209, -600.2664043158451, -715.6813345032776, -821.8254331284692, -937.9442820285622, -730.0486852291759, -535.7589437723914, -1121.2834897081757, -582.8082993067468, -708.0427139636481, -1008.5458885392121, -849.3419183240953, -801.2879736130425, -738.39199592524, -896.1957660248137, -895.128718650913, -825.6136082124613, -882.8726763830157, -416.5620963072277, -635.6473578672366, -749.95019999497, -835.4811765437128, -805.439885115331, -896.2292058888935, -964.0834131168805, -1013.652153672089, -588.2568382069389, -619.1685472077081, -961.3726654618121, -679.3912721613107, -545.6730933335284, -376.0236951902823, -653.1001606933421, -814.9315259429418, -854.8000692655935, -524.0470061676156, -605.0998920006286, -708.1750676846361, -810.0858574256316, -972.9784852489795, -465.0305409430647, -820.7630550745884, -674.1608211203869, -701.5511190138091, -1015.8245870393804, -688.1877178368541, -913.7429877270883, -957.3807448864148, -980.690926533723, -635.8164732742916, -1038.9959112623549, -798.3671265104039, -985.0507328121622, -909.7584013792837, -664.9043829806535, -550.3429869053524], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.486427810827127, "mean_inference_ms": 0.41914360971058995, "mean_action_processing_ms": 0.09820066159683825, "mean_env_wait_ms": 2.7719491563925143, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038263797760009766, "StateBufferConnector_ms": 0.0028727054595947266, "ViewRequirementAgentConnector_ms": 0.07145142555236816}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 259800, "num_agent_steps_trained": 259800, "num_env_steps_sampled": 259800, "num_env_steps_trained": 259800, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.973371007224095, "num_env_steps_trained_throughput_per_sec": 41.973371007224095, "timesteps_total": 259800, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 259800, "timers": {"training_iteration_time_ms": 2896.837, "sample_time_ms": 2892.921, "load_time_ms": 0.221, "load_throughput": 541841.404, "learn_time_ms": 2.918, "learn_throughput": 41124.995, "synch_weights_time_ms": 0.734}, "counters": {"num_env_steps_sampled": 259800, "num_env_steps_trained": 259800, "num_agent_steps_sampled": 259800, "num_agent_steps_trained": 259800}, "done": false, "episodes_total": 2165, "training_iteration": 542, "trial_id": "53665_00000", "date": "2023-07-26_03-37-34", "timestamp": 1690331854, "time_this_iter_s": 11.438841819763184, "time_total_s": 6595.072839975357, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 973.7473640441895, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 39.64705882352941, "ram_util_percent": 75.99411764705883}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-08, "entropy_coeff": 0.05, "policy_entropy": 267.49884033203125, "policy_loss": -81518.03125, "vf_loss": 3502551.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 331.0, "diff_num_grad_updates_vs_sampler_policy": 330.0}}, "num_env_steps_sampled": 260280, "num_env_steps_trained": 260280, "num_agent_steps_sampled": 260280, "num_agent_steps_trained": 260280}, "sampler_results": {"episode_reward_max": -376.0236951902823, "episode_reward_min": -1196.7773023427235, "episode_reward_mean": -768.7205300070302, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-887.1778288513328, -953.0802454679492, -560.5160467973631, -821.1000508017892, -709.0977696137401, -672.5917323197915, -810.2125900542125, -561.1920790386728, -906.3649642823498, -1196.7773023427235, -798.4709598097372, -684.3452029841236, -782.3556538846735, -888.5636672899157, -601.5650805563787, -463.65506636846624, -416.1390728793751, -512.2823976150429, -598.093883976555, -857.7890581688563, -920.7751702909966, -1060.0094418113433, -985.8165647448916, -707.1253108345709, -761.666438222746, -718.0838775933024, -753.8799234876818, -912.6825006065798, -886.0253014907576, -850.697507711902, -757.4724784932018, -609.8784328109755, -882.3308110692128, -886.285045724919, -481.08934177726707, -794.1920531822366, -711.6784718845645, -848.8305485281672, -887.3004409764154, -522.0932866776407, -709.2056911835209, -600.2664043158451, -715.6813345032776, -821.8254331284692, -937.9442820285622, -730.0486852291759, -535.7589437723914, -1121.2834897081757, -582.8082993067468, -708.0427139636481, -1008.5458885392121, -849.3419183240953, -801.2879736130425, -738.39199592524, -896.1957660248137, -895.128718650913, -825.6136082124613, -882.8726763830157, -416.5620963072277, -635.6473578672366, -749.95019999497, -835.4811765437128, -805.439885115331, -896.2292058888935, -964.0834131168805, -1013.652153672089, -588.2568382069389, -619.1685472077081, -961.3726654618121, -679.3912721613107, -545.6730933335284, -376.0236951902823, -653.1001606933421, -814.9315259429418, -854.8000692655935, -524.0470061676156, -605.0998920006286, -708.1750676846361, -810.0858574256316, -972.9784852489795, -465.0305409430647, -820.7630550745884, -674.1608211203869, -701.5511190138091, -1015.8245870393804, -688.1877178368541, -913.7429877270883, -957.3807448864148, -980.690926533723, -635.8164732742916, -1038.9959112623549, -798.3671265104039, -985.0507328121622, -909.7584013792837, -664.9043829806535, -550.3429869053524, -922.4678708029103, -817.0432076537971, -606.3966063351744, -715.8997122790017], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.483210049399577, "mean_inference_ms": 0.4190012249687496, "mean_action_processing_ms": 0.09817986032324966, "mean_env_wait_ms": 2.770252669320904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038194656372070312, "StateBufferConnector_ms": 0.0028579235076904297, "ViewRequirementAgentConnector_ms": 0.07133960723876953}}, "episode_reward_max": -376.0236951902823, "episode_reward_min": -1196.7773023427235, "episode_reward_mean": -768.7205300070302, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-887.1778288513328, -953.0802454679492, -560.5160467973631, -821.1000508017892, -709.0977696137401, -672.5917323197915, -810.2125900542125, -561.1920790386728, -906.3649642823498, -1196.7773023427235, -798.4709598097372, -684.3452029841236, -782.3556538846735, -888.5636672899157, -601.5650805563787, -463.65506636846624, -416.1390728793751, -512.2823976150429, -598.093883976555, -857.7890581688563, -920.7751702909966, -1060.0094418113433, -985.8165647448916, -707.1253108345709, -761.666438222746, -718.0838775933024, -753.8799234876818, -912.6825006065798, -886.0253014907576, -850.697507711902, -757.4724784932018, -609.8784328109755, -882.3308110692128, -886.285045724919, -481.08934177726707, -794.1920531822366, -711.6784718845645, -848.8305485281672, -887.3004409764154, -522.0932866776407, -709.2056911835209, -600.2664043158451, -715.6813345032776, -821.8254331284692, -937.9442820285622, -730.0486852291759, -535.7589437723914, -1121.2834897081757, -582.8082993067468, -708.0427139636481, -1008.5458885392121, -849.3419183240953, -801.2879736130425, -738.39199592524, -896.1957660248137, -895.128718650913, -825.6136082124613, -882.8726763830157, -416.5620963072277, -635.6473578672366, -749.95019999497, -835.4811765437128, -805.439885115331, -896.2292058888935, -964.0834131168805, -1013.652153672089, -588.2568382069389, -619.1685472077081, -961.3726654618121, -679.3912721613107, -545.6730933335284, -376.0236951902823, -653.1001606933421, -814.9315259429418, -854.8000692655935, -524.0470061676156, -605.0998920006286, -708.1750676846361, -810.0858574256316, -972.9784852489795, -465.0305409430647, -820.7630550745884, -674.1608211203869, -701.5511190138091, -1015.8245870393804, -688.1877178368541, -913.7429877270883, -957.3807448864148, -980.690926533723, -635.8164732742916, -1038.9959112623549, -798.3671265104039, -985.0507328121622, -909.7584013792837, -664.9043829806535, -550.3429869053524, -922.4678708029103, -817.0432076537971, -606.3966063351744, -715.8997122790017], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.483210049399577, "mean_inference_ms": 0.4190012249687496, "mean_action_processing_ms": 0.09817986032324966, "mean_env_wait_ms": 2.770252669320904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038194656372070312, "StateBufferConnector_ms": 0.0028579235076904297, "ViewRequirementAgentConnector_ms": 0.07133960723876953}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 260280, "num_agent_steps_trained": 260280, "num_env_steps_sampled": 260280, "num_env_steps_trained": 260280, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.35100618268931, "num_env_steps_trained_throughput_per_sec": 40.35100618268931, "timesteps_total": 260280, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 260280, "timers": {"training_iteration_time_ms": 2918.325, "sample_time_ms": 2914.471, "load_time_ms": 0.219, "load_throughput": 548215.314, "learn_time_ms": 2.879, "learn_throughput": 41681.489, "synch_weights_time_ms": 0.715}, "counters": {"num_env_steps_sampled": 260280, "num_env_steps_trained": 260280, "num_agent_steps_sampled": 260280, "num_agent_steps_trained": 260280}, "done": false, "episodes_total": 2169, "training_iteration": 543, "trial_id": "53665_00000", "date": "2023-07-26_03-37-46", "timestamp": 1690331866, "time_this_iter_s": 11.89843201637268, "time_total_s": 6606.97127199173, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 985.6457960605621, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 39.14705882352941, "ram_util_percent": 76.69411764705883}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-08, "entropy_coeff": 0.05, "policy_entropy": 267.4591979980469, "policy_loss": -103489.1875, "vf_loss": 5232268.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 335.0, "diff_num_grad_updates_vs_sampler_policy": 334.0}}, "num_env_steps_sampled": 260760, "num_env_steps_trained": 260760, "num_agent_steps_sampled": 260760, "num_agent_steps_trained": 260760}, "sampler_results": {"episode_reward_max": -376.0236951902823, "episode_reward_min": -1196.7773023427235, "episode_reward_mean": -764.5052726557146, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-709.0977696137401, -672.5917323197915, -810.2125900542125, -561.1920790386728, -906.3649642823498, -1196.7773023427235, -798.4709598097372, -684.3452029841236, -782.3556538846735, -888.5636672899157, -601.5650805563787, -463.65506636846624, -416.1390728793751, -512.2823976150429, -598.093883976555, -857.7890581688563, -920.7751702909966, -1060.0094418113433, -985.8165647448916, -707.1253108345709, -761.666438222746, -718.0838775933024, -753.8799234876818, -912.6825006065798, -886.0253014907576, -850.697507711902, -757.4724784932018, -609.8784328109755, -882.3308110692128, -886.285045724919, -481.08934177726707, -794.1920531822366, -711.6784718845645, -848.8305485281672, -887.3004409764154, -522.0932866776407, -709.2056911835209, -600.2664043158451, -715.6813345032776, -821.8254331284692, -937.9442820285622, -730.0486852291759, -535.7589437723914, -1121.2834897081757, -582.8082993067468, -708.0427139636481, -1008.5458885392121, -849.3419183240953, -801.2879736130425, -738.39199592524, -896.1957660248137, -895.128718650913, -825.6136082124613, -882.8726763830157, -416.5620963072277, -635.6473578672366, -749.95019999497, -835.4811765437128, -805.439885115331, -896.2292058888935, -964.0834131168805, -1013.652153672089, -588.2568382069389, -619.1685472077081, -961.3726654618121, -679.3912721613107, -545.6730933335284, -376.0236951902823, -653.1001606933421, -814.9315259429418, -854.8000692655935, -524.0470061676156, -605.0998920006286, -708.1750676846361, -810.0858574256316, -972.9784852489795, -465.0305409430647, -820.7630550745884, -674.1608211203869, -701.5511190138091, -1015.8245870393804, -688.1877178368541, -913.7429877270883, -957.3807448864148, -980.690926533723, -635.8164732742916, -1038.9959112623549, -798.3671265104039, -985.0507328121622, -909.7584013792837, -664.9043829806535, -550.3429869053524, -922.4678708029103, -817.0432076537971, -606.3966063351744, -715.8997122790017, -581.369814242515, -722.5601392597337, -682.6704451177101, -813.7480381669358], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.480165787472465, "mean_inference_ms": 0.41886206640116597, "mean_action_processing_ms": 0.09815967100841932, "mean_env_wait_ms": 2.768653423745404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038156509399414062, "StateBufferConnector_ms": 0.0028612613677978516, "ViewRequirementAgentConnector_ms": 0.07128310203552246}}, "episode_reward_max": -376.0236951902823, "episode_reward_min": -1196.7773023427235, "episode_reward_mean": -764.5052726557146, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-709.0977696137401, -672.5917323197915, -810.2125900542125, -561.1920790386728, -906.3649642823498, -1196.7773023427235, -798.4709598097372, -684.3452029841236, -782.3556538846735, -888.5636672899157, -601.5650805563787, -463.65506636846624, -416.1390728793751, -512.2823976150429, -598.093883976555, -857.7890581688563, -920.7751702909966, -1060.0094418113433, -985.8165647448916, -707.1253108345709, -761.666438222746, -718.0838775933024, -753.8799234876818, -912.6825006065798, -886.0253014907576, -850.697507711902, -757.4724784932018, -609.8784328109755, -882.3308110692128, -886.285045724919, -481.08934177726707, -794.1920531822366, -711.6784718845645, -848.8305485281672, -887.3004409764154, -522.0932866776407, -709.2056911835209, -600.2664043158451, -715.6813345032776, -821.8254331284692, -937.9442820285622, -730.0486852291759, -535.7589437723914, -1121.2834897081757, -582.8082993067468, -708.0427139636481, -1008.5458885392121, -849.3419183240953, -801.2879736130425, -738.39199592524, -896.1957660248137, -895.128718650913, -825.6136082124613, -882.8726763830157, -416.5620963072277, -635.6473578672366, -749.95019999497, -835.4811765437128, -805.439885115331, -896.2292058888935, -964.0834131168805, -1013.652153672089, -588.2568382069389, -619.1685472077081, -961.3726654618121, -679.3912721613107, -545.6730933335284, -376.0236951902823, -653.1001606933421, -814.9315259429418, -854.8000692655935, -524.0470061676156, -605.0998920006286, -708.1750676846361, -810.0858574256316, -972.9784852489795, -465.0305409430647, -820.7630550745884, -674.1608211203869, -701.5511190138091, -1015.8245870393804, -688.1877178368541, -913.7429877270883, -957.3807448864148, -980.690926533723, -635.8164732742916, -1038.9959112623549, -798.3671265104039, -985.0507328121622, -909.7584013792837, -664.9043829806535, -550.3429869053524, -922.4678708029103, -817.0432076537971, -606.3966063351744, -715.8997122790017, -581.369814242515, -722.5601392597337, -682.6704451177101, -813.7480381669358], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.480165787472465, "mean_inference_ms": 0.41886206640116597, "mean_action_processing_ms": 0.09815967100841932, "mean_env_wait_ms": 2.768653423745404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038156509399414062, "StateBufferConnector_ms": 0.0028612613677978516, "ViewRequirementAgentConnector_ms": 0.07128310203552246}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 260760, "num_agent_steps_trained": 260760, "num_env_steps_sampled": 260760, "num_env_steps_trained": 260760, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.29507389436655, "num_env_steps_trained_throughput_per_sec": 40.29507389436655, "timesteps_total": 260760, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 260760, "timers": {"training_iteration_time_ms": 2954.17, "sample_time_ms": 2950.451, "load_time_ms": 0.218, "load_throughput": 550313.23, "learn_time_ms": 2.757, "learn_throughput": 43525.933, "synch_weights_time_ms": 0.704}, "counters": {"num_env_steps_sampled": 260760, "num_env_steps_trained": 260760, "num_agent_steps_sampled": 260760, "num_agent_steps_trained": 260760}, "done": false, "episodes_total": 2173, "training_iteration": 544, "trial_id": "53665_00000", "date": "2023-07-26_03-37-58", "timestamp": 1690331878, "time_this_iter_s": 11.914819717407227, "time_total_s": 6618.886091709137, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 997.5606157779694, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 37.93125, "ram_util_percent": 75.60624999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-08, "entropy_coeff": 0.05, "policy_entropy": 267.4967956542969, "policy_loss": -82893.828125, "vf_loss": 3437303.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 339.0, "diff_num_grad_updates_vs_sampler_policy": 338.0}}, "num_env_steps_sampled": 261240, "num_env_steps_trained": 261240, "num_agent_steps_sampled": 261240, "num_agent_steps_trained": 261240}, "sampler_results": {"episode_reward_max": -376.0236951902823, "episode_reward_min": -1196.7773023427235, "episode_reward_mean": -765.4880340457047, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-906.3649642823498, -1196.7773023427235, -798.4709598097372, -684.3452029841236, -782.3556538846735, -888.5636672899157, -601.5650805563787, -463.65506636846624, -416.1390728793751, -512.2823976150429, -598.093883976555, -857.7890581688563, -920.7751702909966, -1060.0094418113433, -985.8165647448916, -707.1253108345709, -761.666438222746, -718.0838775933024, -753.8799234876818, -912.6825006065798, -886.0253014907576, -850.697507711902, -757.4724784932018, -609.8784328109755, -882.3308110692128, -886.285045724919, -481.08934177726707, -794.1920531822366, -711.6784718845645, -848.8305485281672, -887.3004409764154, -522.0932866776407, -709.2056911835209, -600.2664043158451, -715.6813345032776, -821.8254331284692, -937.9442820285622, -730.0486852291759, -535.7589437723914, -1121.2834897081757, -582.8082993067468, -708.0427139636481, -1008.5458885392121, -849.3419183240953, -801.2879736130425, -738.39199592524, -896.1957660248137, -895.128718650913, -825.6136082124613, -882.8726763830157, -416.5620963072277, -635.6473578672366, -749.95019999497, -835.4811765437128, -805.439885115331, -896.2292058888935, -964.0834131168805, -1013.652153672089, -588.2568382069389, -619.1685472077081, -961.3726654618121, -679.3912721613107, -545.6730933335284, -376.0236951902823, -653.1001606933421, -814.9315259429418, -854.8000692655935, -524.0470061676156, -605.0998920006286, -708.1750676846361, -810.0858574256316, -972.9784852489795, -465.0305409430647, -820.7630550745884, -674.1608211203869, -701.5511190138091, -1015.8245870393804, -688.1877178368541, -913.7429877270883, -957.3807448864148, -980.690926533723, -635.8164732742916, -1038.9959112623549, -798.3671265104039, -985.0507328121622, -909.7584013792837, -664.9043829806535, -550.3429869053524, -922.4678708029103, -817.0432076537971, -606.3966063351744, -715.8997122790017, -581.369814242515, -722.5601392597337, -682.6704451177101, -813.7480381669358, -800.0170557657304, -688.515361895256, -656.8257082151661, -706.0121841492595], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.47697097802203, "mean_inference_ms": 0.41873414926523067, "mean_action_processing_ms": 0.09814129590601528, "mean_env_wait_ms": 2.767046696775223, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003820180892944336, "StateBufferConnector_ms": 0.0028672218322753906, "ViewRequirementAgentConnector_ms": 0.07137084007263184}}, "episode_reward_max": -376.0236951902823, "episode_reward_min": -1196.7773023427235, "episode_reward_mean": -765.4880340457047, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-906.3649642823498, -1196.7773023427235, -798.4709598097372, -684.3452029841236, -782.3556538846735, -888.5636672899157, -601.5650805563787, -463.65506636846624, -416.1390728793751, -512.2823976150429, -598.093883976555, -857.7890581688563, -920.7751702909966, -1060.0094418113433, -985.8165647448916, -707.1253108345709, -761.666438222746, -718.0838775933024, -753.8799234876818, -912.6825006065798, -886.0253014907576, -850.697507711902, -757.4724784932018, -609.8784328109755, -882.3308110692128, -886.285045724919, -481.08934177726707, -794.1920531822366, -711.6784718845645, -848.8305485281672, -887.3004409764154, -522.0932866776407, -709.2056911835209, -600.2664043158451, -715.6813345032776, -821.8254331284692, -937.9442820285622, -730.0486852291759, -535.7589437723914, -1121.2834897081757, -582.8082993067468, -708.0427139636481, -1008.5458885392121, -849.3419183240953, -801.2879736130425, -738.39199592524, -896.1957660248137, -895.128718650913, -825.6136082124613, -882.8726763830157, -416.5620963072277, -635.6473578672366, -749.95019999497, -835.4811765437128, -805.439885115331, -896.2292058888935, -964.0834131168805, -1013.652153672089, -588.2568382069389, -619.1685472077081, -961.3726654618121, -679.3912721613107, -545.6730933335284, -376.0236951902823, -653.1001606933421, -814.9315259429418, -854.8000692655935, -524.0470061676156, -605.0998920006286, -708.1750676846361, -810.0858574256316, -972.9784852489795, -465.0305409430647, -820.7630550745884, -674.1608211203869, -701.5511190138091, -1015.8245870393804, -688.1877178368541, -913.7429877270883, -957.3807448864148, -980.690926533723, -635.8164732742916, -1038.9959112623549, -798.3671265104039, -985.0507328121622, -909.7584013792837, -664.9043829806535, -550.3429869053524, -922.4678708029103, -817.0432076537971, -606.3966063351744, -715.8997122790017, -581.369814242515, -722.5601392597337, -682.6704451177101, -813.7480381669358, -800.0170557657304, -688.515361895256, -656.8257082151661, -706.0121841492595], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.47697097802203, "mean_inference_ms": 0.41873414926523067, "mean_action_processing_ms": 0.09814129590601528, "mean_env_wait_ms": 2.767046696775223, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003820180892944336, "StateBufferConnector_ms": 0.0028672218322753906, "ViewRequirementAgentConnector_ms": 0.07137084007263184}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 261240, "num_agent_steps_trained": 261240, "num_env_steps_sampled": 261240, "num_env_steps_trained": 261240, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.8013204607255, "num_env_steps_trained_throughput_per_sec": 41.8013204607255, "timesteps_total": 261240, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 261240, "timers": {"training_iteration_time_ms": 2939.905, "sample_time_ms": 2936.164, "load_time_ms": 0.218, "load_throughput": 549472.14, "learn_time_ms": 2.773, "learn_throughput": 43273.334, "synch_weights_time_ms": 0.71}, "counters": {"num_env_steps_sampled": 261240, "num_env_steps_trained": 261240, "num_agent_steps_sampled": 261240, "num_agent_steps_trained": 261240}, "done": false, "episodes_total": 2177, "training_iteration": 545, "trial_id": "53665_00000", "date": "2023-07-26_03-38-10", "timestamp": 1690331890, "time_this_iter_s": 11.485584735870361, "time_total_s": 6630.371676445007, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1009.0462005138397, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 37.20588235294117, "ram_util_percent": 75.74117647058824}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-08, "entropy_coeff": 0.05, "policy_entropy": 267.5062561035156, "policy_loss": -101372.453125, "vf_loss": 4909685.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 343.0, "diff_num_grad_updates_vs_sampler_policy": 342.0}}, "num_env_steps_sampled": 261720, "num_env_steps_trained": 261720, "num_agent_steps_sampled": 261720, "num_agent_steps_trained": 261720}, "sampler_results": {"episode_reward_max": -376.0236951902823, "episode_reward_min": -1121.2834897081757, "episode_reward_mean": -760.4227873550901, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-782.3556538846735, -888.5636672899157, -601.5650805563787, -463.65506636846624, -416.1390728793751, -512.2823976150429, -598.093883976555, -857.7890581688563, -920.7751702909966, -1060.0094418113433, -985.8165647448916, -707.1253108345709, -761.666438222746, -718.0838775933024, -753.8799234876818, -912.6825006065798, -886.0253014907576, -850.697507711902, -757.4724784932018, -609.8784328109755, -882.3308110692128, -886.285045724919, -481.08934177726707, -794.1920531822366, -711.6784718845645, -848.8305485281672, -887.3004409764154, -522.0932866776407, -709.2056911835209, -600.2664043158451, -715.6813345032776, -821.8254331284692, -937.9442820285622, -730.0486852291759, -535.7589437723914, -1121.2834897081757, -582.8082993067468, -708.0427139636481, -1008.5458885392121, -849.3419183240953, -801.2879736130425, -738.39199592524, -896.1957660248137, -895.128718650913, -825.6136082124613, -882.8726763830157, -416.5620963072277, -635.6473578672366, -749.95019999497, -835.4811765437128, -805.439885115331, -896.2292058888935, -964.0834131168805, -1013.652153672089, -588.2568382069389, -619.1685472077081, -961.3726654618121, -679.3912721613107, -545.6730933335284, -376.0236951902823, -653.1001606933421, -814.9315259429418, -854.8000692655935, -524.0470061676156, -605.0998920006286, -708.1750676846361, -810.0858574256316, -972.9784852489795, -465.0305409430647, -820.7630550745884, -674.1608211203869, -701.5511190138091, -1015.8245870393804, -688.1877178368541, -913.7429877270883, -957.3807448864148, -980.690926533723, -635.8164732742916, -1038.9959112623549, -798.3671265104039, -985.0507328121622, -909.7584013792837, -664.9043829806535, -550.3429869053524, -922.4678708029103, -817.0432076537971, -606.3966063351744, -715.8997122790017, -581.369814242515, -722.5601392597337, -682.6704451177101, -813.7480381669358, -800.0170557657304, -688.515361895256, -656.8257082151661, -706.0121841492595, -921.3153022098309, -618.2226863519622, -781.9132054701772, -757.9825663255237], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.47335178177859, "mean_inference_ms": 0.41861113185225746, "mean_action_processing_ms": 0.09812374119353784, "mean_env_wait_ms": 2.765507989515903, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038216114044189453, "StateBufferConnector_ms": 0.002863645553588867, "ViewRequirementAgentConnector_ms": 0.07133102416992188}}, "episode_reward_max": -376.0236951902823, "episode_reward_min": -1121.2834897081757, "episode_reward_mean": -760.4227873550901, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-782.3556538846735, -888.5636672899157, -601.5650805563787, -463.65506636846624, -416.1390728793751, -512.2823976150429, -598.093883976555, -857.7890581688563, -920.7751702909966, -1060.0094418113433, -985.8165647448916, -707.1253108345709, -761.666438222746, -718.0838775933024, -753.8799234876818, -912.6825006065798, -886.0253014907576, -850.697507711902, -757.4724784932018, -609.8784328109755, -882.3308110692128, -886.285045724919, -481.08934177726707, -794.1920531822366, -711.6784718845645, -848.8305485281672, -887.3004409764154, -522.0932866776407, -709.2056911835209, -600.2664043158451, -715.6813345032776, -821.8254331284692, -937.9442820285622, -730.0486852291759, -535.7589437723914, -1121.2834897081757, -582.8082993067468, -708.0427139636481, -1008.5458885392121, -849.3419183240953, -801.2879736130425, -738.39199592524, -896.1957660248137, -895.128718650913, -825.6136082124613, -882.8726763830157, -416.5620963072277, -635.6473578672366, -749.95019999497, -835.4811765437128, -805.439885115331, -896.2292058888935, -964.0834131168805, -1013.652153672089, -588.2568382069389, -619.1685472077081, -961.3726654618121, -679.3912721613107, -545.6730933335284, -376.0236951902823, -653.1001606933421, -814.9315259429418, -854.8000692655935, -524.0470061676156, -605.0998920006286, -708.1750676846361, -810.0858574256316, -972.9784852489795, -465.0305409430647, -820.7630550745884, -674.1608211203869, -701.5511190138091, -1015.8245870393804, -688.1877178368541, -913.7429877270883, -957.3807448864148, -980.690926533723, -635.8164732742916, -1038.9959112623549, -798.3671265104039, -985.0507328121622, -909.7584013792837, -664.9043829806535, -550.3429869053524, -922.4678708029103, -817.0432076537971, -606.3966063351744, -715.8997122790017, -581.369814242515, -722.5601392597337, -682.6704451177101, -813.7480381669358, -800.0170557657304, -688.515361895256, -656.8257082151661, -706.0121841492595, -921.3153022098309, -618.2226863519622, -781.9132054701772, -757.9825663255237], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.47335178177859, "mean_inference_ms": 0.41861113185225746, "mean_action_processing_ms": 0.09812374119353784, "mean_env_wait_ms": 2.765507989515903, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038216114044189453, "StateBufferConnector_ms": 0.002863645553588867, "ViewRequirementAgentConnector_ms": 0.07133102416992188}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 261720, "num_agent_steps_trained": 261720, "num_env_steps_sampled": 261720, "num_env_steps_trained": 261720, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 42.38498916504453, "num_env_steps_trained_throughput_per_sec": 42.38498916504453, "timesteps_total": 261720, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 261720, "timers": {"training_iteration_time_ms": 2881.326, "sample_time_ms": 2877.578, "load_time_ms": 0.218, "load_throughput": 550132.78, "learn_time_ms": 2.782, "learn_throughput": 43139.44, "synch_weights_time_ms": 0.708}, "counters": {"num_env_steps_sampled": 261720, "num_env_steps_trained": 261720, "num_agent_steps_sampled": 261720, "num_agent_steps_trained": 261720}, "done": false, "episodes_total": 2181, "training_iteration": 546, "trial_id": "53665_00000", "date": "2023-07-26_03-38-21", "timestamp": 1690331901, "time_this_iter_s": 11.327495098114014, "time_total_s": 6641.699171543121, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1020.3736956119537, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 39.35625, "ram_util_percent": 74.025}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-08, "entropy_coeff": 0.05, "policy_entropy": 267.4958801269531, "policy_loss": -132983.640625, "vf_loss": 7671943.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 347.0, "diff_num_grad_updates_vs_sampler_policy": 346.0}}, "num_env_steps_sampled": 262200, "num_env_steps_trained": 262200, "num_agent_steps_sampled": 262200, "num_agent_steps_trained": 262200}, "sampler_results": {"episode_reward_max": -376.0236951902823, "episode_reward_min": -1121.2834897081757, "episode_reward_mean": -764.6050362911042, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-416.1390728793751, -512.2823976150429, -598.093883976555, -857.7890581688563, -920.7751702909966, -1060.0094418113433, -985.8165647448916, -707.1253108345709, -761.666438222746, -718.0838775933024, -753.8799234876818, -912.6825006065798, -886.0253014907576, -850.697507711902, -757.4724784932018, -609.8784328109755, -882.3308110692128, -886.285045724919, -481.08934177726707, -794.1920531822366, -711.6784718845645, -848.8305485281672, -887.3004409764154, -522.0932866776407, -709.2056911835209, -600.2664043158451, -715.6813345032776, -821.8254331284692, -937.9442820285622, -730.0486852291759, -535.7589437723914, -1121.2834897081757, -582.8082993067468, -708.0427139636481, -1008.5458885392121, -849.3419183240953, -801.2879736130425, -738.39199592524, -896.1957660248137, -895.128718650913, -825.6136082124613, -882.8726763830157, -416.5620963072277, -635.6473578672366, -749.95019999497, -835.4811765437128, -805.439885115331, -896.2292058888935, -964.0834131168805, -1013.652153672089, -588.2568382069389, -619.1685472077081, -961.3726654618121, -679.3912721613107, -545.6730933335284, -376.0236951902823, -653.1001606933421, -814.9315259429418, -854.8000692655935, -524.0470061676156, -605.0998920006286, -708.1750676846361, -810.0858574256316, -972.9784852489795, -465.0305409430647, -820.7630550745884, -674.1608211203869, -701.5511190138091, -1015.8245870393804, -688.1877178368541, -913.7429877270883, -957.3807448864148, -980.690926533723, -635.8164732742916, -1038.9959112623549, -798.3671265104039, -985.0507328121622, -909.7584013792837, -664.9043829806535, -550.3429869053524, -922.4678708029103, -817.0432076537971, -606.3966063351744, -715.8997122790017, -581.369814242515, -722.5601392597337, -682.6704451177101, -813.7480381669358, -800.0170557657304, -688.515361895256, -656.8257082151661, -706.0121841492595, -921.3153022098309, -618.2226863519622, -781.9132054701772, -757.9825663255237, -809.3578777297809, -518.1503008899604, -791.9352729033599, -1034.920910177727], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.469954863465915, "mean_inference_ms": 0.41848265575138777, "mean_action_processing_ms": 0.09810527120899763, "mean_env_wait_ms": 2.7640100474230223, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003790140151977539, "StateBufferConnector_ms": 0.0028519630432128906, "ViewRequirementAgentConnector_ms": 0.07095456123352051}}, "episode_reward_max": -376.0236951902823, "episode_reward_min": -1121.2834897081757, "episode_reward_mean": -764.6050362911042, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-416.1390728793751, -512.2823976150429, -598.093883976555, -857.7890581688563, -920.7751702909966, -1060.0094418113433, -985.8165647448916, -707.1253108345709, -761.666438222746, -718.0838775933024, -753.8799234876818, -912.6825006065798, -886.0253014907576, -850.697507711902, -757.4724784932018, -609.8784328109755, -882.3308110692128, -886.285045724919, -481.08934177726707, -794.1920531822366, -711.6784718845645, -848.8305485281672, -887.3004409764154, -522.0932866776407, -709.2056911835209, -600.2664043158451, -715.6813345032776, -821.8254331284692, -937.9442820285622, -730.0486852291759, -535.7589437723914, -1121.2834897081757, -582.8082993067468, -708.0427139636481, -1008.5458885392121, -849.3419183240953, -801.2879736130425, -738.39199592524, -896.1957660248137, -895.128718650913, -825.6136082124613, -882.8726763830157, -416.5620963072277, -635.6473578672366, -749.95019999497, -835.4811765437128, -805.439885115331, -896.2292058888935, -964.0834131168805, -1013.652153672089, -588.2568382069389, -619.1685472077081, -961.3726654618121, -679.3912721613107, -545.6730933335284, -376.0236951902823, -653.1001606933421, -814.9315259429418, -854.8000692655935, -524.0470061676156, -605.0998920006286, -708.1750676846361, -810.0858574256316, -972.9784852489795, -465.0305409430647, -820.7630550745884, -674.1608211203869, -701.5511190138091, -1015.8245870393804, -688.1877178368541, -913.7429877270883, -957.3807448864148, -980.690926533723, -635.8164732742916, -1038.9959112623549, -798.3671265104039, -985.0507328121622, -909.7584013792837, -664.9043829806535, -550.3429869053524, -922.4678708029103, -817.0432076537971, -606.3966063351744, -715.8997122790017, -581.369814242515, -722.5601392597337, -682.6704451177101, -813.7480381669358, -800.0170557657304, -688.515361895256, -656.8257082151661, -706.0121841492595, -921.3153022098309, -618.2226863519622, -781.9132054701772, -757.9825663255237, -809.3578777297809, -518.1503008899604, -791.9352729033599, -1034.920910177727], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.469954863465915, "mean_inference_ms": 0.41848265575138777, "mean_action_processing_ms": 0.09810527120899763, "mean_env_wait_ms": 2.7640100474230223, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003790140151977539, "StateBufferConnector_ms": 0.0028519630432128906, "ViewRequirementAgentConnector_ms": 0.07095456123352051}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 262200, "num_agent_steps_trained": 262200, "num_env_steps_sampled": 262200, "num_env_steps_trained": 262200, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.726579024790254, "num_env_steps_trained_throughput_per_sec": 41.726579024790254, "timesteps_total": 262200, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 262200, "timers": {"training_iteration_time_ms": 2854.063, "sample_time_ms": 2850.323, "load_time_ms": 0.22, "load_throughput": 546667.188, "learn_time_ms": 2.777, "learn_throughput": 43214.259, "synch_weights_time_ms": 0.704}, "counters": {"num_env_steps_sampled": 262200, "num_env_steps_trained": 262200, "num_agent_steps_sampled": 262200, "num_agent_steps_trained": 262200}, "done": false, "episodes_total": 2185, "training_iteration": 547, "trial_id": "53665_00000", "date": "2023-07-26_03-38-33", "timestamp": 1690331913, "time_this_iter_s": 11.506393194198608, "time_total_s": 6653.20556473732, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1031.8800888061523, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 36.8375, "ram_util_percent": 74.07499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-08, "entropy_coeff": 0.05, "policy_entropy": 267.4703674316406, "policy_loss": -70335.578125, "vf_loss": 2091207.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 351.0, "diff_num_grad_updates_vs_sampler_policy": 350.0}}, "num_env_steps_sampled": 262680, "num_env_steps_trained": 262680, "num_agent_steps_sampled": 262680, "num_agent_steps_trained": 262680}, "sampler_results": {"episode_reward_max": -376.0236951902823, "episode_reward_min": -1121.2834897081757, "episode_reward_mean": -768.5996953991735, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-920.7751702909966, -1060.0094418113433, -985.8165647448916, -707.1253108345709, -761.666438222746, -718.0838775933024, -753.8799234876818, -912.6825006065798, -886.0253014907576, -850.697507711902, -757.4724784932018, -609.8784328109755, -882.3308110692128, -886.285045724919, -481.08934177726707, -794.1920531822366, -711.6784718845645, -848.8305485281672, -887.3004409764154, -522.0932866776407, -709.2056911835209, -600.2664043158451, -715.6813345032776, -821.8254331284692, -937.9442820285622, -730.0486852291759, -535.7589437723914, -1121.2834897081757, -582.8082993067468, -708.0427139636481, -1008.5458885392121, -849.3419183240953, -801.2879736130425, -738.39199592524, -896.1957660248137, -895.128718650913, -825.6136082124613, -882.8726763830157, -416.5620963072277, -635.6473578672366, -749.95019999497, -835.4811765437128, -805.439885115331, -896.2292058888935, -964.0834131168805, -1013.652153672089, -588.2568382069389, -619.1685472077081, -961.3726654618121, -679.3912721613107, -545.6730933335284, -376.0236951902823, -653.1001606933421, -814.9315259429418, -854.8000692655935, -524.0470061676156, -605.0998920006286, -708.1750676846361, -810.0858574256316, -972.9784852489795, -465.0305409430647, -820.7630550745884, -674.1608211203869, -701.5511190138091, -1015.8245870393804, -688.1877178368541, -913.7429877270883, -957.3807448864148, -980.690926533723, -635.8164732742916, -1038.9959112623549, -798.3671265104039, -985.0507328121622, -909.7584013792837, -664.9043829806535, -550.3429869053524, -922.4678708029103, -817.0432076537971, -606.3966063351744, -715.8997122790017, -581.369814242515, -722.5601392597337, -682.6704451177101, -813.7480381669358, -800.0170557657304, -688.515361895256, -656.8257082151661, -706.0121841492595, -921.3153022098309, -618.2226863519622, -781.9132054701772, -757.9825663255237, -809.3578777297809, -518.1503008899604, -791.9352729033599, -1034.920910177727, -849.6202455813967, -878.3370146796489, -553.6211473432435, -502.1919158424673], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.46758876125463, "mean_inference_ms": 0.41838972885883025, "mean_action_processing_ms": 0.09809229103150831, "mean_env_wait_ms": 2.762683776678482, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003795146942138672, "StateBufferConnector_ms": 0.002864360809326172, "ViewRequirementAgentConnector_ms": 0.07116889953613281}}, "episode_reward_max": -376.0236951902823, "episode_reward_min": -1121.2834897081757, "episode_reward_mean": -768.5996953991735, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-920.7751702909966, -1060.0094418113433, -985.8165647448916, -707.1253108345709, -761.666438222746, -718.0838775933024, -753.8799234876818, -912.6825006065798, -886.0253014907576, -850.697507711902, -757.4724784932018, -609.8784328109755, -882.3308110692128, -886.285045724919, -481.08934177726707, -794.1920531822366, -711.6784718845645, -848.8305485281672, -887.3004409764154, -522.0932866776407, -709.2056911835209, -600.2664043158451, -715.6813345032776, -821.8254331284692, -937.9442820285622, -730.0486852291759, -535.7589437723914, -1121.2834897081757, -582.8082993067468, -708.0427139636481, -1008.5458885392121, -849.3419183240953, -801.2879736130425, -738.39199592524, -896.1957660248137, -895.128718650913, -825.6136082124613, -882.8726763830157, -416.5620963072277, -635.6473578672366, -749.95019999497, -835.4811765437128, -805.439885115331, -896.2292058888935, -964.0834131168805, -1013.652153672089, -588.2568382069389, -619.1685472077081, -961.3726654618121, -679.3912721613107, -545.6730933335284, -376.0236951902823, -653.1001606933421, -814.9315259429418, -854.8000692655935, -524.0470061676156, -605.0998920006286, -708.1750676846361, -810.0858574256316, -972.9784852489795, -465.0305409430647, -820.7630550745884, -674.1608211203869, -701.5511190138091, -1015.8245870393804, -688.1877178368541, -913.7429877270883, -957.3807448864148, -980.690926533723, -635.8164732742916, -1038.9959112623549, -798.3671265104039, -985.0507328121622, -909.7584013792837, -664.9043829806535, -550.3429869053524, -922.4678708029103, -817.0432076537971, -606.3966063351744, -715.8997122790017, -581.369814242515, -722.5601392597337, -682.6704451177101, -813.7480381669358, -800.0170557657304, -688.515361895256, -656.8257082151661, -706.0121841492595, -921.3153022098309, -618.2226863519622, -781.9132054701772, -757.9825663255237, -809.3578777297809, -518.1503008899604, -791.9352729033599, -1034.920910177727, -849.6202455813967, -878.3370146796489, -553.6211473432435, -502.1919158424673], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.46758876125463, "mean_inference_ms": 0.41838972885883025, "mean_action_processing_ms": 0.09809229103150831, "mean_env_wait_ms": 2.762683776678482, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003795146942138672, "StateBufferConnector_ms": 0.002864360809326172, "ViewRequirementAgentConnector_ms": 0.07116889953613281}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 262680, "num_agent_steps_trained": 262680, "num_env_steps_sampled": 262680, "num_env_steps_trained": 262680, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.35531061440464, "num_env_steps_trained_throughput_per_sec": 38.35531061440464, "timesteps_total": 262680, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 262680, "timers": {"training_iteration_time_ms": 2967.571, "sample_time_ms": 2963.507, "load_time_ms": 0.24, "load_throughput": 499718.507, "learn_time_ms": 2.983, "learn_throughput": 40233.775, "synch_weights_time_ms": 0.794}, "counters": {"num_env_steps_sampled": 262680, "num_env_steps_trained": 262680, "num_agent_steps_sampled": 262680, "num_agent_steps_trained": 262680}, "done": false, "episodes_total": 2189, "training_iteration": 548, "trial_id": "53665_00000", "date": "2023-07-26_03-38-45", "timestamp": 1690331925, "time_this_iter_s": 12.51893925666809, "time_total_s": 6665.724503993988, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1044.3990280628204, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 47.4388888888889, "ram_util_percent": 77.59444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-08, "entropy_coeff": 0.05, "policy_entropy": 267.5081481933594, "policy_loss": -130207.4453125, "vf_loss": 6771982.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 354.0, "diff_num_grad_updates_vs_sampler_policy": 353.0}}, "num_env_steps_sampled": 263040, "num_env_steps_trained": 263040, "num_agent_steps_sampled": 263040, "num_agent_steps_trained": 263040}, "sampler_results": {"episode_reward_max": -376.0236951902823, "episode_reward_min": -1121.2834897081757, "episode_reward_mean": -761.7526466798607, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-707.1253108345709, -761.666438222746, -718.0838775933024, -753.8799234876818, -912.6825006065798, -886.0253014907576, -850.697507711902, -757.4724784932018, -609.8784328109755, -882.3308110692128, -886.285045724919, -481.08934177726707, -794.1920531822366, -711.6784718845645, -848.8305485281672, -887.3004409764154, -522.0932866776407, -709.2056911835209, -600.2664043158451, -715.6813345032776, -821.8254331284692, -937.9442820285622, -730.0486852291759, -535.7589437723914, -1121.2834897081757, -582.8082993067468, -708.0427139636481, -1008.5458885392121, -849.3419183240953, -801.2879736130425, -738.39199592524, -896.1957660248137, -895.128718650913, -825.6136082124613, -882.8726763830157, -416.5620963072277, -635.6473578672366, -749.95019999497, -835.4811765437128, -805.439885115331, -896.2292058888935, -964.0834131168805, -1013.652153672089, -588.2568382069389, -619.1685472077081, -961.3726654618121, -679.3912721613107, -545.6730933335284, -376.0236951902823, -653.1001606933421, -814.9315259429418, -854.8000692655935, -524.0470061676156, -605.0998920006286, -708.1750676846361, -810.0858574256316, -972.9784852489795, -465.0305409430647, -820.7630550745884, -674.1608211203869, -701.5511190138091, -1015.8245870393804, -688.1877178368541, -913.7429877270883, -957.3807448864148, -980.690926533723, -635.8164732742916, -1038.9959112623549, -798.3671265104039, -985.0507328121622, -909.7584013792837, -664.9043829806535, -550.3429869053524, -922.4678708029103, -817.0432076537971, -606.3966063351744, -715.8997122790017, -581.369814242515, -722.5601392597337, -682.6704451177101, -813.7480381669358, -800.0170557657304, -688.515361895256, -656.8257082151661, -706.0121841492595, -921.3153022098309, -618.2226863519622, -781.9132054701772, -757.9825663255237, -809.3578777297809, -518.1503008899604, -791.9352729033599, -1034.920910177727, -849.6202455813967, -878.3370146796489, -553.6211473432435, -502.1919158424673, -696.9409535721932, -586.0176853132299, -998.937666030531], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.466746446173538, "mean_inference_ms": 0.41834939160549145, "mean_action_processing_ms": 0.09808773205604487, "mean_env_wait_ms": 2.761829348007238, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038089752197265625, "StateBufferConnector_ms": 0.002864837646484375, "ViewRequirementAgentConnector_ms": 0.0713801383972168}}, "episode_reward_max": -376.0236951902823, "episode_reward_min": -1121.2834897081757, "episode_reward_mean": -761.7526466798607, "episode_len_mean": 120.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-707.1253108345709, -761.666438222746, -718.0838775933024, -753.8799234876818, -912.6825006065798, -886.0253014907576, -850.697507711902, -757.4724784932018, -609.8784328109755, -882.3308110692128, -886.285045724919, -481.08934177726707, -794.1920531822366, -711.6784718845645, -848.8305485281672, -887.3004409764154, -522.0932866776407, -709.2056911835209, -600.2664043158451, -715.6813345032776, -821.8254331284692, -937.9442820285622, -730.0486852291759, -535.7589437723914, -1121.2834897081757, -582.8082993067468, -708.0427139636481, -1008.5458885392121, -849.3419183240953, -801.2879736130425, -738.39199592524, -896.1957660248137, -895.128718650913, -825.6136082124613, -882.8726763830157, -416.5620963072277, -635.6473578672366, -749.95019999497, -835.4811765437128, -805.439885115331, -896.2292058888935, -964.0834131168805, -1013.652153672089, -588.2568382069389, -619.1685472077081, -961.3726654618121, -679.3912721613107, -545.6730933335284, -376.0236951902823, -653.1001606933421, -814.9315259429418, -854.8000692655935, -524.0470061676156, -605.0998920006286, -708.1750676846361, -810.0858574256316, -972.9784852489795, -465.0305409430647, -820.7630550745884, -674.1608211203869, -701.5511190138091, -1015.8245870393804, -688.1877178368541, -913.7429877270883, -957.3807448864148, -980.690926533723, -635.8164732742916, -1038.9959112623549, -798.3671265104039, -985.0507328121622, -909.7584013792837, -664.9043829806535, -550.3429869053524, -922.4678708029103, -817.0432076537971, -606.3966063351744, -715.8997122790017, -581.369814242515, -722.5601392597337, -682.6704451177101, -813.7480381669358, -800.0170557657304, -688.515361895256, -656.8257082151661, -706.0121841492595, -921.3153022098309, -618.2226863519622, -781.9132054701772, -757.9825663255237, -809.3578777297809, -518.1503008899604, -791.9352729033599, -1034.920910177727, -849.6202455813967, -878.3370146796489, -553.6211473432435, -502.1919158424673, -696.9409535721932, -586.0176853132299, -998.937666030531], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.466746446173538, "mean_inference_ms": 0.41834939160549145, "mean_action_processing_ms": 0.09808773205604487, "mean_env_wait_ms": 2.761829348007238, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038089752197265625, "StateBufferConnector_ms": 0.002864837646484375, "ViewRequirementAgentConnector_ms": 0.0713801383972168}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 263040, "num_agent_steps_trained": 263040, "num_env_steps_sampled": 263040, "num_env_steps_trained": 263040, "num_env_steps_sampled_this_iter": 360, "num_env_steps_trained_this_iter": 360, "num_env_steps_sampled_throughput_per_sec": 35.412185135849676, "num_env_steps_trained_throughput_per_sec": 35.412185135849676, "timesteps_total": 263040, "num_steps_trained_this_iter": 360, "agent_timesteps_total": 263040, "timers": {"training_iteration_time_ms": 3128.018, "sample_time_ms": 3123.578, "load_time_ms": 0.259, "load_throughput": 463117.851, "learn_time_ms": 3.255, "learn_throughput": 36868.951, "synch_weights_time_ms": 0.875}, "counters": {"num_env_steps_sampled": 263040, "num_env_steps_trained": 263040, "num_agent_steps_sampled": 263040, "num_agent_steps_trained": 263040}, "done": false, "episodes_total": 2192, "training_iteration": 549, "trial_id": "53665_00000", "date": "2023-07-26_03-38-55", "timestamp": 1690331935, "time_this_iter_s": 10.169244766235352, "time_total_s": 6675.893748760223, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1054.5682728290558, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 56.226666666666674, "ram_util_percent": 79.01333333333334}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-08, "entropy_coeff": 0.05, "policy_entropy": 267.4881286621094, "policy_loss": -85085.015625, "vf_loss": 3488816.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 358.0, "diff_num_grad_updates_vs_sampler_policy": 357.0}}, "num_env_steps_sampled": 263520, "num_env_steps_trained": 263520, "num_agent_steps_sampled": 263520, "num_agent_steps_trained": 263520}, "sampler_results": {"episode_reward_max": -376.0236951902823, "episode_reward_min": -1121.2834897081757, "episode_reward_mean": -761.4498921785787, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-912.6825006065798, -886.0253014907576, -850.697507711902, -757.4724784932018, -609.8784328109755, -882.3308110692128, -886.285045724919, -481.08934177726707, -794.1920531822366, -711.6784718845645, -848.8305485281672, -887.3004409764154, -522.0932866776407, -709.2056911835209, -600.2664043158451, -715.6813345032776, -821.8254331284692, -937.9442820285622, -730.0486852291759, -535.7589437723914, -1121.2834897081757, -582.8082993067468, -708.0427139636481, -1008.5458885392121, -849.3419183240953, -801.2879736130425, -738.39199592524, -896.1957660248137, -895.128718650913, -825.6136082124613, -882.8726763830157, -416.5620963072277, -635.6473578672366, -749.95019999497, -835.4811765437128, -805.439885115331, -896.2292058888935, -964.0834131168805, -1013.652153672089, -588.2568382069389, -619.1685472077081, -961.3726654618121, -679.3912721613107, -545.6730933335284, -376.0236951902823, -653.1001606933421, -814.9315259429418, -854.8000692655935, -524.0470061676156, -605.0998920006286, -708.1750676846361, -810.0858574256316, -972.9784852489795, -465.0305409430647, -820.7630550745884, -674.1608211203869, -701.5511190138091, -1015.8245870393804, -688.1877178368541, -913.7429877270883, -957.3807448864148, -980.690926533723, -635.8164732742916, -1038.9959112623549, -798.3671265104039, -985.0507328121622, -909.7584013792837, -664.9043829806535, -550.3429869053524, -922.4678708029103, -817.0432076537971, -606.3966063351744, -715.8997122790017, -581.369814242515, -722.5601392597337, -682.6704451177101, -813.7480381669358, -800.0170557657304, -688.515361895256, -656.8257082151661, -706.0121841492595, -921.3153022098309, -618.2226863519622, -781.9132054701772, -757.9825663255237, -809.3578777297809, -518.1503008899604, -791.9352729033599, -1034.920910177727, -849.6202455813967, -878.3370146796489, -553.6211473432435, -502.1919158424673, -696.9409535721932, -586.0176853132299, -998.937666030531, -864.431869177693, -602.0025835532326, -796.7895092014937, -647.2561380776884], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.465124508908975, "mean_inference_ms": 0.41829859453372903, "mean_action_processing_ms": 0.0980821368120452, "mean_env_wait_ms": 2.7606491590633184, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038297176361083984, "StateBufferConnector_ms": 0.0028738975524902344, "ViewRequirementAgentConnector_ms": 0.07164263725280762}}, "episode_reward_max": -376.0236951902823, "episode_reward_min": -1121.2834897081757, "episode_reward_mean": -761.4498921785787, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-912.6825006065798, -886.0253014907576, -850.697507711902, -757.4724784932018, -609.8784328109755, -882.3308110692128, -886.285045724919, -481.08934177726707, -794.1920531822366, -711.6784718845645, -848.8305485281672, -887.3004409764154, -522.0932866776407, -709.2056911835209, -600.2664043158451, -715.6813345032776, -821.8254331284692, -937.9442820285622, -730.0486852291759, -535.7589437723914, -1121.2834897081757, -582.8082993067468, -708.0427139636481, -1008.5458885392121, -849.3419183240953, -801.2879736130425, -738.39199592524, -896.1957660248137, -895.128718650913, -825.6136082124613, -882.8726763830157, -416.5620963072277, -635.6473578672366, -749.95019999497, -835.4811765437128, -805.439885115331, -896.2292058888935, -964.0834131168805, -1013.652153672089, -588.2568382069389, -619.1685472077081, -961.3726654618121, -679.3912721613107, -545.6730933335284, -376.0236951902823, -653.1001606933421, -814.9315259429418, -854.8000692655935, -524.0470061676156, -605.0998920006286, -708.1750676846361, -810.0858574256316, -972.9784852489795, -465.0305409430647, -820.7630550745884, -674.1608211203869, -701.5511190138091, -1015.8245870393804, -688.1877178368541, -913.7429877270883, -957.3807448864148, -980.690926533723, -635.8164732742916, -1038.9959112623549, -798.3671265104039, -985.0507328121622, -909.7584013792837, -664.9043829806535, -550.3429869053524, -922.4678708029103, -817.0432076537971, -606.3966063351744, -715.8997122790017, -581.369814242515, -722.5601392597337, -682.6704451177101, -813.7480381669358, -800.0170557657304, -688.515361895256, -656.8257082151661, -706.0121841492595, -921.3153022098309, -618.2226863519622, -781.9132054701772, -757.9825663255237, -809.3578777297809, -518.1503008899604, -791.9352729033599, -1034.920910177727, -849.6202455813967, -878.3370146796489, -553.6211473432435, -502.1919158424673, -696.9409535721932, -586.0176853132299, -998.937666030531, -864.431869177693, -602.0025835532326, -796.7895092014937, -647.2561380776884], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.465124508908975, "mean_inference_ms": 0.41829859453372903, "mean_action_processing_ms": 0.0980821368120452, "mean_env_wait_ms": 2.7606491590633184, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038297176361083984, "StateBufferConnector_ms": 0.0028738975524902344, "ViewRequirementAgentConnector_ms": 0.07164263725280762}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 263520, "num_agent_steps_trained": 263520, "num_env_steps_sampled": 263520, "num_env_steps_trained": 263520, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.772512420649456, "num_env_steps_trained_throughput_per_sec": 41.772512420649456, "timesteps_total": 263520, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 263520, "timers": {"training_iteration_time_ms": 3101.442, "sample_time_ms": 3096.972, "load_time_ms": 0.257, "load_throughput": 466725.223, "learn_time_ms": 3.284, "learn_throughput": 36542.115, "synch_weights_time_ms": 0.879}, "counters": {"num_env_steps_sampled": 263520, "num_env_steps_trained": 263520, "num_agent_steps_sampled": 263520, "num_agent_steps_trained": 263520}, "done": false, "episodes_total": 2196, "training_iteration": 550, "trial_id": "53665_00000", "date": "2023-07-26_03-39-07", "timestamp": 1690331947, "time_this_iter_s": 11.493599891662598, "time_total_s": 6687.387348651886, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1066.0618727207184, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 38.53125, "ram_util_percent": 76.5375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-08, "entropy_coeff": 0.05, "policy_entropy": 267.48712158203125, "policy_loss": -86982.2265625, "vf_loss": 3620354.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 362.0, "diff_num_grad_updates_vs_sampler_policy": 361.0}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "sampler_results": {"episode_reward_max": -236.0166478699493, "episode_reward_min": -1121.2834897081757, "episode_reward_mean": -749.3064037464005, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-609.8784328109755, -882.3308110692128, -886.285045724919, -481.08934177726707, -794.1920531822366, -711.6784718845645, -848.8305485281672, -887.3004409764154, -522.0932866776407, -709.2056911835209, -600.2664043158451, -715.6813345032776, -821.8254331284692, -937.9442820285622, -730.0486852291759, -535.7589437723914, -1121.2834897081757, -582.8082993067468, -708.0427139636481, -1008.5458885392121, -849.3419183240953, -801.2879736130425, -738.39199592524, -896.1957660248137, -895.128718650913, -825.6136082124613, -882.8726763830157, -416.5620963072277, -635.6473578672366, -749.95019999497, -835.4811765437128, -805.439885115331, -896.2292058888935, -964.0834131168805, -1013.652153672089, -588.2568382069389, -619.1685472077081, -961.3726654618121, -679.3912721613107, -545.6730933335284, -376.0236951902823, -653.1001606933421, -814.9315259429418, -854.8000692655935, -524.0470061676156, -605.0998920006286, -708.1750676846361, -810.0858574256316, -972.9784852489795, -465.0305409430647, -820.7630550745884, -674.1608211203869, -701.5511190138091, -1015.8245870393804, -688.1877178368541, -913.7429877270883, -957.3807448864148, -980.690926533723, -635.8164732742916, -1038.9959112623549, -798.3671265104039, -985.0507328121622, -909.7584013792837, -664.9043829806535, -550.3429869053524, -922.4678708029103, -817.0432076537971, -606.3966063351744, -715.8997122790017, -581.369814242515, -722.5601392597337, -682.6704451177101, -813.7480381669358, -800.0170557657304, -688.515361895256, -656.8257082151661, -706.0121841492595, -921.3153022098309, -618.2226863519622, -781.9132054701772, -757.9825663255237, -809.3578777297809, -518.1503008899604, -791.9352729033599, -1034.920910177727, -849.6202455813967, -878.3370146796489, -553.6211473432435, -502.1919158424673, -696.9409535721932, -586.0176853132299, -998.937666030531, -864.431869177693, -602.0025835532326, -796.7895092014937, -647.2561380776884, -236.0166478699493, -636.2536656975443, -661.0210729432954, -659.2375585738099], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.463562526034305, "mean_inference_ms": 0.4182512215940253, "mean_action_processing_ms": 0.09807698317871262, "mean_env_wait_ms": 2.7594372771079394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003849506378173828, "StateBufferConnector_ms": 0.0028753280639648438, "ViewRequirementAgentConnector_ms": 0.07171106338500977}}, "episode_reward_max": -236.0166478699493, "episode_reward_min": -1121.2834897081757, "episode_reward_mean": -749.3064037464005, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-609.8784328109755, -882.3308110692128, -886.285045724919, -481.08934177726707, -794.1920531822366, -711.6784718845645, -848.8305485281672, -887.3004409764154, -522.0932866776407, -709.2056911835209, -600.2664043158451, -715.6813345032776, -821.8254331284692, -937.9442820285622, -730.0486852291759, -535.7589437723914, -1121.2834897081757, -582.8082993067468, -708.0427139636481, -1008.5458885392121, -849.3419183240953, -801.2879736130425, -738.39199592524, -896.1957660248137, -895.128718650913, -825.6136082124613, -882.8726763830157, -416.5620963072277, -635.6473578672366, -749.95019999497, -835.4811765437128, -805.439885115331, -896.2292058888935, -964.0834131168805, -1013.652153672089, -588.2568382069389, -619.1685472077081, -961.3726654618121, -679.3912721613107, -545.6730933335284, -376.0236951902823, -653.1001606933421, -814.9315259429418, -854.8000692655935, -524.0470061676156, -605.0998920006286, -708.1750676846361, -810.0858574256316, -972.9784852489795, -465.0305409430647, -820.7630550745884, -674.1608211203869, -701.5511190138091, -1015.8245870393804, -688.1877178368541, -913.7429877270883, -957.3807448864148, -980.690926533723, -635.8164732742916, -1038.9959112623549, -798.3671265104039, -985.0507328121622, -909.7584013792837, -664.9043829806535, -550.3429869053524, -922.4678708029103, -817.0432076537971, -606.3966063351744, -715.8997122790017, -581.369814242515, -722.5601392597337, -682.6704451177101, -813.7480381669358, -800.0170557657304, -688.515361895256, -656.8257082151661, -706.0121841492595, -921.3153022098309, -618.2226863519622, -781.9132054701772, -757.9825663255237, -809.3578777297809, -518.1503008899604, -791.9352729033599, -1034.920910177727, -849.6202455813967, -878.3370146796489, -553.6211473432435, -502.1919158424673, -696.9409535721932, -586.0176853132299, -998.937666030531, -864.431869177693, -602.0025835532326, -796.7895092014937, -647.2561380776884, -236.0166478699493, -636.2536656975443, -661.0210729432954, -659.2375585738099], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.463562526034305, "mean_inference_ms": 0.4182512215940253, "mean_action_processing_ms": 0.09807698317871262, "mean_env_wait_ms": 2.7594372771079394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003849506378173828, "StateBufferConnector_ms": 0.0028753280639648438, "ViewRequirementAgentConnector_ms": 0.07171106338500977}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.98634610199163, "num_env_steps_trained_throughput_per_sec": 40.98634610199163, "timesteps_total": 264000, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 264000, "timers": {"training_iteration_time_ms": 2938.459, "sample_time_ms": 2934.633, "load_time_ms": 0.219, "load_throughput": 546785.964, "learn_time_ms": 2.839, "learn_throughput": 42272.058, "synch_weights_time_ms": 0.728}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "done": false, "episodes_total": 2200, "training_iteration": 551, "trial_id": "53665_00000", "date": "2023-07-26_03-39-19", "timestamp": 1690331959, "time_this_iter_s": 11.713955163955688, "time_total_s": 6699.101303815842, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1077.775827884674, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 40.21176470588235, "ram_util_percent": 77.44117647058823}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-08, "entropy_coeff": 0.05, "policy_entropy": 267.4991760253906, "policy_loss": -126588.0625, "vf_loss": 7018166.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 366.0, "diff_num_grad_updates_vs_sampler_policy": 365.0}}, "num_env_steps_sampled": 264480, "num_env_steps_trained": 264480, "num_agent_steps_sampled": 264480, "num_agent_steps_trained": 264480}, "sampler_results": {"episode_reward_max": -236.0166478699493, "episode_reward_min": -1121.2834897081757, "episode_reward_mean": -751.9156727517689, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-794.1920531822366, -711.6784718845645, -848.8305485281672, -887.3004409764154, -522.0932866776407, -709.2056911835209, -600.2664043158451, -715.6813345032776, -821.8254331284692, -937.9442820285622, -730.0486852291759, -535.7589437723914, -1121.2834897081757, -582.8082993067468, -708.0427139636481, -1008.5458885392121, -849.3419183240953, -801.2879736130425, -738.39199592524, -896.1957660248137, -895.128718650913, -825.6136082124613, -882.8726763830157, -416.5620963072277, -635.6473578672366, -749.95019999497, -835.4811765437128, -805.439885115331, -896.2292058888935, -964.0834131168805, -1013.652153672089, -588.2568382069389, -619.1685472077081, -961.3726654618121, -679.3912721613107, -545.6730933335284, -376.0236951902823, -653.1001606933421, -814.9315259429418, -854.8000692655935, -524.0470061676156, -605.0998920006286, -708.1750676846361, -810.0858574256316, -972.9784852489795, -465.0305409430647, -820.7630550745884, -674.1608211203869, -701.5511190138091, -1015.8245870393804, -688.1877178368541, -913.7429877270883, -957.3807448864148, -980.690926533723, -635.8164732742916, -1038.9959112623549, -798.3671265104039, -985.0507328121622, -909.7584013792837, -664.9043829806535, -550.3429869053524, -922.4678708029103, -817.0432076537971, -606.3966063351744, -715.8997122790017, -581.369814242515, -722.5601392597337, -682.6704451177101, -813.7480381669358, -800.0170557657304, -688.515361895256, -656.8257082151661, -706.0121841492595, -921.3153022098309, -618.2226863519622, -781.9132054701772, -757.9825663255237, -809.3578777297809, -518.1503008899604, -791.9352729033599, -1034.920910177727, -849.6202455813967, -878.3370146796489, -553.6211473432435, -502.1919158424673, -696.9409535721932, -586.0176853132299, -998.937666030531, -864.431869177693, -602.0025835532326, -796.7895092014937, -647.2561380776884, -236.0166478699493, -636.2536656975443, -661.0210729432954, -659.2375585738099, -890.6729698007413, -810.4122099881012, -420.23710906097955, -999.1882430694006], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.46186276926681, "mean_inference_ms": 0.41818244109753505, "mean_action_processing_ms": 0.09806733368784885, "mean_env_wait_ms": 2.758280602248755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038318634033203125, "StateBufferConnector_ms": 0.002866506576538086, "ViewRequirementAgentConnector_ms": 0.07128119468688965}}, "episode_reward_max": -236.0166478699493, "episode_reward_min": -1121.2834897081757, "episode_reward_mean": -751.9156727517689, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-794.1920531822366, -711.6784718845645, -848.8305485281672, -887.3004409764154, -522.0932866776407, -709.2056911835209, -600.2664043158451, -715.6813345032776, -821.8254331284692, -937.9442820285622, -730.0486852291759, -535.7589437723914, -1121.2834897081757, -582.8082993067468, -708.0427139636481, -1008.5458885392121, -849.3419183240953, -801.2879736130425, -738.39199592524, -896.1957660248137, -895.128718650913, -825.6136082124613, -882.8726763830157, -416.5620963072277, -635.6473578672366, -749.95019999497, -835.4811765437128, -805.439885115331, -896.2292058888935, -964.0834131168805, -1013.652153672089, -588.2568382069389, -619.1685472077081, -961.3726654618121, -679.3912721613107, -545.6730933335284, -376.0236951902823, -653.1001606933421, -814.9315259429418, -854.8000692655935, -524.0470061676156, -605.0998920006286, -708.1750676846361, -810.0858574256316, -972.9784852489795, -465.0305409430647, -820.7630550745884, -674.1608211203869, -701.5511190138091, -1015.8245870393804, -688.1877178368541, -913.7429877270883, -957.3807448864148, -980.690926533723, -635.8164732742916, -1038.9959112623549, -798.3671265104039, -985.0507328121622, -909.7584013792837, -664.9043829806535, -550.3429869053524, -922.4678708029103, -817.0432076537971, -606.3966063351744, -715.8997122790017, -581.369814242515, -722.5601392597337, -682.6704451177101, -813.7480381669358, -800.0170557657304, -688.515361895256, -656.8257082151661, -706.0121841492595, -921.3153022098309, -618.2226863519622, -781.9132054701772, -757.9825663255237, -809.3578777297809, -518.1503008899604, -791.9352729033599, -1034.920910177727, -849.6202455813967, -878.3370146796489, -553.6211473432435, -502.1919158424673, -696.9409535721932, -586.0176853132299, -998.937666030531, -864.431869177693, -602.0025835532326, -796.7895092014937, -647.2561380776884, -236.0166478699493, -636.2536656975443, -661.0210729432954, -659.2375585738099, -890.6729698007413, -810.4122099881012, -420.23710906097955, -999.1882430694006], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.46186276926681, "mean_inference_ms": 0.41818244109753505, "mean_action_processing_ms": 0.09806733368784885, "mean_env_wait_ms": 2.758280602248755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038318634033203125, "StateBufferConnector_ms": 0.002866506576538086, "ViewRequirementAgentConnector_ms": 0.07128119468688965}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264480, "num_agent_steps_trained": 264480, "num_env_steps_sampled": 264480, "num_env_steps_trained": 264480, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.33119699041202, "num_env_steps_trained_throughput_per_sec": 40.33119699041202, "timesteps_total": 264480, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 264480, "timers": {"training_iteration_time_ms": 2940.954, "sample_time_ms": 2937.205, "load_time_ms": 0.219, "load_throughput": 548215.314, "learn_time_ms": 2.785, "learn_throughput": 43090.689, "synch_weights_time_ms": 0.706}, "counters": {"num_env_steps_sampled": 264480, "num_env_steps_trained": 264480, "num_agent_steps_sampled": 264480, "num_agent_steps_trained": 264480}, "done": false, "episodes_total": 2204, "training_iteration": 552, "trial_id": "53665_00000", "date": "2023-07-26_03-39-31", "timestamp": 1690331971, "time_this_iter_s": 11.904191970825195, "time_total_s": 6711.005495786667, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1089.6800198554993, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 42.07058823529411, "ram_util_percent": 77.49411764705883}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-08, "entropy_coeff": 0.05, "policy_entropy": 267.4658203125, "policy_loss": -132164.171875, "vf_loss": 8162461.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 370.0, "diff_num_grad_updates_vs_sampler_policy": 369.0}}, "num_env_steps_sampled": 264960, "num_env_steps_trained": 264960, "num_agent_steps_sampled": 264960, "num_agent_steps_trained": 264960}, "sampler_results": {"episode_reward_max": -236.0166478699493, "episode_reward_min": -1121.2834897081757, "episode_reward_mean": -751.379668266822, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-522.0932866776407, -709.2056911835209, -600.2664043158451, -715.6813345032776, -821.8254331284692, -937.9442820285622, -730.0486852291759, -535.7589437723914, -1121.2834897081757, -582.8082993067468, -708.0427139636481, -1008.5458885392121, -849.3419183240953, -801.2879736130425, -738.39199592524, -896.1957660248137, -895.128718650913, -825.6136082124613, -882.8726763830157, -416.5620963072277, -635.6473578672366, -749.95019999497, -835.4811765437128, -805.439885115331, -896.2292058888935, -964.0834131168805, -1013.652153672089, -588.2568382069389, -619.1685472077081, -961.3726654618121, -679.3912721613107, -545.6730933335284, -376.0236951902823, -653.1001606933421, -814.9315259429418, -854.8000692655935, -524.0470061676156, -605.0998920006286, -708.1750676846361, -810.0858574256316, -972.9784852489795, -465.0305409430647, -820.7630550745884, -674.1608211203869, -701.5511190138091, -1015.8245870393804, -688.1877178368541, -913.7429877270883, -957.3807448864148, -980.690926533723, -635.8164732742916, -1038.9959112623549, -798.3671265104039, -985.0507328121622, -909.7584013792837, -664.9043829806535, -550.3429869053524, -922.4678708029103, -817.0432076537971, -606.3966063351744, -715.8997122790017, -581.369814242515, -722.5601392597337, -682.6704451177101, -813.7480381669358, -800.0170557657304, -688.515361895256, -656.8257082151661, -706.0121841492595, -921.3153022098309, -618.2226863519622, -781.9132054701772, -757.9825663255237, -809.3578777297809, -518.1503008899604, -791.9352729033599, -1034.920910177727, -849.6202455813967, -878.3370146796489, -553.6211473432435, -502.1919158424673, -696.9409535721932, -586.0176853132299, -998.937666030531, -864.431869177693, -602.0025835532326, -796.7895092014937, -647.2561380776884, -236.0166478699493, -636.2536656975443, -661.0210729432954, -659.2375585738099, -890.6729698007413, -810.4122099881012, -420.23710906097955, -999.1882430694006, -685.1520441618709, -712.5506270730253, -807.3880170914313, -983.3103777503555], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.460286175806505, "mean_inference_ms": 0.4181018818715486, "mean_action_processing_ms": 0.09805531873487412, "mean_env_wait_ms": 2.7571378250438334, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038232803344726562, "StateBufferConnector_ms": 0.002855539321899414, "ViewRequirementAgentConnector_ms": 0.07103276252746582}}, "episode_reward_max": -236.0166478699493, "episode_reward_min": -1121.2834897081757, "episode_reward_mean": -751.379668266822, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-522.0932866776407, -709.2056911835209, -600.2664043158451, -715.6813345032776, -821.8254331284692, -937.9442820285622, -730.0486852291759, -535.7589437723914, -1121.2834897081757, -582.8082993067468, -708.0427139636481, -1008.5458885392121, -849.3419183240953, -801.2879736130425, -738.39199592524, -896.1957660248137, -895.128718650913, -825.6136082124613, -882.8726763830157, -416.5620963072277, -635.6473578672366, -749.95019999497, -835.4811765437128, -805.439885115331, -896.2292058888935, -964.0834131168805, -1013.652153672089, -588.2568382069389, -619.1685472077081, -961.3726654618121, -679.3912721613107, -545.6730933335284, -376.0236951902823, -653.1001606933421, -814.9315259429418, -854.8000692655935, -524.0470061676156, -605.0998920006286, -708.1750676846361, -810.0858574256316, -972.9784852489795, -465.0305409430647, -820.7630550745884, -674.1608211203869, -701.5511190138091, -1015.8245870393804, -688.1877178368541, -913.7429877270883, -957.3807448864148, -980.690926533723, -635.8164732742916, -1038.9959112623549, -798.3671265104039, -985.0507328121622, -909.7584013792837, -664.9043829806535, -550.3429869053524, -922.4678708029103, -817.0432076537971, -606.3966063351744, -715.8997122790017, -581.369814242515, -722.5601392597337, -682.6704451177101, -813.7480381669358, -800.0170557657304, -688.515361895256, -656.8257082151661, -706.0121841492595, -921.3153022098309, -618.2226863519622, -781.9132054701772, -757.9825663255237, -809.3578777297809, -518.1503008899604, -791.9352729033599, -1034.920910177727, -849.6202455813967, -878.3370146796489, -553.6211473432435, -502.1919158424673, -696.9409535721932, -586.0176853132299, -998.937666030531, -864.431869177693, -602.0025835532326, -796.7895092014937, -647.2561380776884, -236.0166478699493, -636.2536656975443, -661.0210729432954, -659.2375585738099, -890.6729698007413, -810.4122099881012, -420.23710906097955, -999.1882430694006, -685.1520441618709, -712.5506270730253, -807.3880170914313, -983.3103777503555], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.460286175806505, "mean_inference_ms": 0.4181018818715486, "mean_action_processing_ms": 0.09805531873487412, "mean_env_wait_ms": 2.7571378250438334, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038232803344726562, "StateBufferConnector_ms": 0.002855539321899414, "ViewRequirementAgentConnector_ms": 0.07103276252746582}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264960, "num_agent_steps_trained": 264960, "num_env_steps_sampled": 264960, "num_env_steps_trained": 264960, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.67130670435811, "num_env_steps_trained_throughput_per_sec": 40.67130670435811, "timesteps_total": 264960, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 264960, "timers": {"training_iteration_time_ms": 2951.082, "sample_time_ms": 2947.354, "load_time_ms": 0.218, "load_throughput": 551338.022, "learn_time_ms": 2.771, "learn_throughput": 43306.845, "synch_weights_time_ms": 0.7}, "counters": {"num_env_steps_sampled": 264960, "num_env_steps_trained": 264960, "num_agent_steps_sampled": 264960, "num_agent_steps_trained": 264960}, "done": false, "episodes_total": 2208, "training_iteration": 553, "trial_id": "53665_00000", "date": "2023-07-26_03-39-42", "timestamp": 1690331982, "time_this_iter_s": 11.80459189414978, "time_total_s": 6722.810087680817, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1101.484611749649, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 43.48823529411764, "ram_util_percent": 77.61764705882352}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.5e-08, "entropy_coeff": 0.05, "policy_entropy": 267.50445556640625, "policy_loss": -127194.8359375, "vf_loss": 7227756.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 374.0, "diff_num_grad_updates_vs_sampler_policy": 373.0}}, "num_env_steps_sampled": 265440, "num_env_steps_trained": 265440, "num_agent_steps_sampled": 265440, "num_agent_steps_trained": 265440}, "sampler_results": {"episode_reward_max": -236.0166478699493, "episode_reward_min": -1121.2834897081757, "episode_reward_mean": -755.66739265673, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-821.8254331284692, -937.9442820285622, -730.0486852291759, -535.7589437723914, -1121.2834897081757, -582.8082993067468, -708.0427139636481, -1008.5458885392121, -849.3419183240953, -801.2879736130425, -738.39199592524, -896.1957660248137, -895.128718650913, -825.6136082124613, -882.8726763830157, -416.5620963072277, -635.6473578672366, -749.95019999497, -835.4811765437128, -805.439885115331, -896.2292058888935, -964.0834131168805, -1013.652153672089, -588.2568382069389, -619.1685472077081, -961.3726654618121, -679.3912721613107, -545.6730933335284, -376.0236951902823, -653.1001606933421, -814.9315259429418, -854.8000692655935, -524.0470061676156, -605.0998920006286, -708.1750676846361, -810.0858574256316, -972.9784852489795, -465.0305409430647, -820.7630550745884, -674.1608211203869, -701.5511190138091, -1015.8245870393804, -688.1877178368541, -913.7429877270883, -957.3807448864148, -980.690926533723, -635.8164732742916, -1038.9959112623549, -798.3671265104039, -985.0507328121622, -909.7584013792837, -664.9043829806535, -550.3429869053524, -922.4678708029103, -817.0432076537971, -606.3966063351744, -715.8997122790017, -581.369814242515, -722.5601392597337, -682.6704451177101, -813.7480381669358, -800.0170557657304, -688.515361895256, -656.8257082151661, -706.0121841492595, -921.3153022098309, -618.2226863519622, -781.9132054701772, -757.9825663255237, -809.3578777297809, -518.1503008899604, -791.9352729033599, -1034.920910177727, -849.6202455813967, -878.3370146796489, -553.6211473432435, -502.1919158424673, -696.9409535721932, -586.0176853132299, -998.937666030531, -864.431869177693, -602.0025835532326, -796.7895092014937, -647.2561380776884, -236.0166478699493, -636.2536656975443, -661.0210729432954, -659.2375585738099, -890.6729698007413, -810.4122099881012, -420.23710906097955, -999.1882430694006, -685.1520441618709, -712.5506270730253, -807.3880170914313, -983.3103777503555, -802.3735094427007, -606.1927232251744, -601.4036421112345, -966.0492808920018], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.458754204152175, "mean_inference_ms": 0.4179936605237623, "mean_action_processing_ms": 0.09803867910015461, "mean_env_wait_ms": 2.756006366093701, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038127899169921875, "StateBufferConnector_ms": 0.002849578857421875, "ViewRequirementAgentConnector_ms": 0.07086801528930664}}, "episode_reward_max": -236.0166478699493, "episode_reward_min": -1121.2834897081757, "episode_reward_mean": -755.66739265673, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-821.8254331284692, -937.9442820285622, -730.0486852291759, -535.7589437723914, -1121.2834897081757, -582.8082993067468, -708.0427139636481, -1008.5458885392121, -849.3419183240953, -801.2879736130425, -738.39199592524, -896.1957660248137, -895.128718650913, -825.6136082124613, -882.8726763830157, -416.5620963072277, -635.6473578672366, -749.95019999497, -835.4811765437128, -805.439885115331, -896.2292058888935, -964.0834131168805, -1013.652153672089, -588.2568382069389, -619.1685472077081, -961.3726654618121, -679.3912721613107, -545.6730933335284, -376.0236951902823, -653.1001606933421, -814.9315259429418, -854.8000692655935, -524.0470061676156, -605.0998920006286, -708.1750676846361, -810.0858574256316, -972.9784852489795, -465.0305409430647, -820.7630550745884, -674.1608211203869, -701.5511190138091, -1015.8245870393804, -688.1877178368541, -913.7429877270883, -957.3807448864148, -980.690926533723, -635.8164732742916, -1038.9959112623549, -798.3671265104039, -985.0507328121622, -909.7584013792837, -664.9043829806535, -550.3429869053524, -922.4678708029103, -817.0432076537971, -606.3966063351744, -715.8997122790017, -581.369814242515, -722.5601392597337, -682.6704451177101, -813.7480381669358, -800.0170557657304, -688.515361895256, -656.8257082151661, -706.0121841492595, -921.3153022098309, -618.2226863519622, -781.9132054701772, -757.9825663255237, -809.3578777297809, -518.1503008899604, -791.9352729033599, -1034.920910177727, -849.6202455813967, -878.3370146796489, -553.6211473432435, -502.1919158424673, -696.9409535721932, -586.0176853132299, -998.937666030531, -864.431869177693, -602.0025835532326, -796.7895092014937, -647.2561380776884, -236.0166478699493, -636.2536656975443, -661.0210729432954, -659.2375585738099, -890.6729698007413, -810.4122099881012, -420.23710906097955, -999.1882430694006, -685.1520441618709, -712.5506270730253, -807.3880170914313, -983.3103777503555, -802.3735094427007, -606.1927232251744, -601.4036421112345, -966.0492808920018], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.458754204152175, "mean_inference_ms": 0.4179936605237623, "mean_action_processing_ms": 0.09803867910015461, "mean_env_wait_ms": 2.756006366093701, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038127899169921875, "StateBufferConnector_ms": 0.002849578857421875, "ViewRequirementAgentConnector_ms": 0.07086801528930664}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 265440, "num_agent_steps_trained": 265440, "num_env_steps_sampled": 265440, "num_env_steps_trained": 265440, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.84497061741648, "num_env_steps_trained_throughput_per_sec": 40.84497061741648, "timesteps_total": 265440, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 265440, "timers": {"training_iteration_time_ms": 2957.035, "sample_time_ms": 2953.162, "load_time_ms": 0.229, "load_throughput": 523252.396, "learn_time_ms": 2.869, "learn_throughput": 41833.575, "synch_weights_time_ms": 0.729}, "counters": {"num_env_steps_sampled": 265440, "num_env_steps_trained": 265440, "num_agent_steps_sampled": 265440, "num_agent_steps_trained": 265440}, "done": false, "episodes_total": 2212, "training_iteration": 554, "trial_id": "53665_00000", "date": "2023-07-26_03-39-54", "timestamp": 1690331994, "time_this_iter_s": 11.754973888397217, "time_total_s": 6734.565061569214, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1113.2395856380463, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 40.85625, "ram_util_percent": 77.7125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.425e-08, "entropy_coeff": 0.05, "policy_entropy": 267.48309326171875, "policy_loss": -114228.1484375, "vf_loss": 5696352.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 378.0, "diff_num_grad_updates_vs_sampler_policy": 377.0}}, "num_env_steps_sampled": 265920, "num_env_steps_trained": 265920, "num_agent_steps_sampled": 265920, "num_agent_steps_trained": 265920}, "sampler_results": {"episode_reward_max": -236.0166478699493, "episode_reward_min": -1121.2834897081757, "episode_reward_mean": -752.6667631539391, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1121.2834897081757, -582.8082993067468, -708.0427139636481, -1008.5458885392121, -849.3419183240953, -801.2879736130425, -738.39199592524, -896.1957660248137, -895.128718650913, -825.6136082124613, -882.8726763830157, -416.5620963072277, -635.6473578672366, -749.95019999497, -835.4811765437128, -805.439885115331, -896.2292058888935, -964.0834131168805, -1013.652153672089, -588.2568382069389, -619.1685472077081, -961.3726654618121, -679.3912721613107, -545.6730933335284, -376.0236951902823, -653.1001606933421, -814.9315259429418, -854.8000692655935, -524.0470061676156, -605.0998920006286, -708.1750676846361, -810.0858574256316, -972.9784852489795, -465.0305409430647, -820.7630550745884, -674.1608211203869, -701.5511190138091, -1015.8245870393804, -688.1877178368541, -913.7429877270883, -957.3807448864148, -980.690926533723, -635.8164732742916, -1038.9959112623549, -798.3671265104039, -985.0507328121622, -909.7584013792837, -664.9043829806535, -550.3429869053524, -922.4678708029103, -817.0432076537971, -606.3966063351744, -715.8997122790017, -581.369814242515, -722.5601392597337, -682.6704451177101, -813.7480381669358, -800.0170557657304, -688.515361895256, -656.8257082151661, -706.0121841492595, -921.3153022098309, -618.2226863519622, -781.9132054701772, -757.9825663255237, -809.3578777297809, -518.1503008899604, -791.9352729033599, -1034.920910177727, -849.6202455813967, -878.3370146796489, -553.6211473432435, -502.1919158424673, -696.9409535721932, -586.0176853132299, -998.937666030531, -864.431869177693, -602.0025835532326, -796.7895092014937, -647.2561380776884, -236.0166478699493, -636.2536656975443, -661.0210729432954, -659.2375585738099, -890.6729698007413, -810.4122099881012, -420.23710906097955, -999.1882430694006, -685.1520441618709, -712.5506270730253, -807.3880170914313, -983.3103777503555, -802.3735094427007, -606.1927232251744, -601.4036421112345, -966.0492808920018, -520.5992178428874, -600.5375929979575, -641.8323874065542, -962.5451956320919], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.457031627281953, "mean_inference_ms": 0.41788715709267144, "mean_action_processing_ms": 0.09802233313640998, "mean_env_wait_ms": 2.7548217247840103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038034915924072266, "StateBufferConnector_ms": 0.0028464794158935547, "ViewRequirementAgentConnector_ms": 0.07055449485778809}}, "episode_reward_max": -236.0166478699493, "episode_reward_min": -1121.2834897081757, "episode_reward_mean": -752.6667631539391, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1121.2834897081757, -582.8082993067468, -708.0427139636481, -1008.5458885392121, -849.3419183240953, -801.2879736130425, -738.39199592524, -896.1957660248137, -895.128718650913, -825.6136082124613, -882.8726763830157, -416.5620963072277, -635.6473578672366, -749.95019999497, -835.4811765437128, -805.439885115331, -896.2292058888935, -964.0834131168805, -1013.652153672089, -588.2568382069389, -619.1685472077081, -961.3726654618121, -679.3912721613107, -545.6730933335284, -376.0236951902823, -653.1001606933421, -814.9315259429418, -854.8000692655935, -524.0470061676156, -605.0998920006286, -708.1750676846361, -810.0858574256316, -972.9784852489795, -465.0305409430647, -820.7630550745884, -674.1608211203869, -701.5511190138091, -1015.8245870393804, -688.1877178368541, -913.7429877270883, -957.3807448864148, -980.690926533723, -635.8164732742916, -1038.9959112623549, -798.3671265104039, -985.0507328121622, -909.7584013792837, -664.9043829806535, -550.3429869053524, -922.4678708029103, -817.0432076537971, -606.3966063351744, -715.8997122790017, -581.369814242515, -722.5601392597337, -682.6704451177101, -813.7480381669358, -800.0170557657304, -688.515361895256, -656.8257082151661, -706.0121841492595, -921.3153022098309, -618.2226863519622, -781.9132054701772, -757.9825663255237, -809.3578777297809, -518.1503008899604, -791.9352729033599, -1034.920910177727, -849.6202455813967, -878.3370146796489, -553.6211473432435, -502.1919158424673, -696.9409535721932, -586.0176853132299, -998.937666030531, -864.431869177693, -602.0025835532326, -796.7895092014937, -647.2561380776884, -236.0166478699493, -636.2536656975443, -661.0210729432954, -659.2375585738099, -890.6729698007413, -810.4122099881012, -420.23710906097955, -999.1882430694006, -685.1520441618709, -712.5506270730253, -807.3880170914313, -983.3103777503555, -802.3735094427007, -606.1927232251744, -601.4036421112345, -966.0492808920018, -520.5992178428874, -600.5375929979575, -641.8323874065542, -962.5451956320919], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.457031627281953, "mean_inference_ms": 0.41788715709267144, "mean_action_processing_ms": 0.09802233313640998, "mean_env_wait_ms": 2.7548217247840103, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038034915924072266, "StateBufferConnector_ms": 0.0028464794158935547, "ViewRequirementAgentConnector_ms": 0.07055449485778809}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 265920, "num_agent_steps_trained": 265920, "num_env_steps_sampled": 265920, "num_env_steps_trained": 265920, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.70523674010791, "num_env_steps_trained_throughput_per_sec": 41.70523674010791, "timesteps_total": 265920, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 265920, "timers": {"training_iteration_time_ms": 2914.643, "sample_time_ms": 2910.312, "load_time_ms": 0.231, "load_throughput": 518455.377, "learn_time_ms": 3.237, "learn_throughput": 37067.437, "synch_weights_time_ms": 0.808}, "counters": {"num_env_steps_sampled": 265920, "num_env_steps_trained": 265920, "num_agent_steps_sampled": 265920, "num_agent_steps_trained": 265920}, "done": false, "episodes_total": 2216, "training_iteration": 555, "trial_id": "53665_00000", "date": "2023-07-26_03-40-06", "timestamp": 1690332006, "time_this_iter_s": 11.512171030044556, "time_total_s": 6746.077232599258, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1124.7517566680908, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 35.27647058823529, "ram_util_percent": 77.04117647058823}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.125e-08, "entropy_coeff": 0.05, "policy_entropy": 267.4493408203125, "policy_loss": -60065.3125, "vf_loss": 1516894.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 382.0, "diff_num_grad_updates_vs_sampler_policy": 381.0}}, "num_env_steps_sampled": 266400, "num_env_steps_trained": 266400, "num_agent_steps_sampled": 266400, "num_agent_steps_trained": 266400}, "sampler_results": {"episode_reward_max": -236.0166478699493, "episode_reward_min": -1038.9959112623549, "episode_reward_mean": -744.0783247748186, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-849.3419183240953, -801.2879736130425, -738.39199592524, -896.1957660248137, -895.128718650913, -825.6136082124613, -882.8726763830157, -416.5620963072277, -635.6473578672366, -749.95019999497, -835.4811765437128, -805.439885115331, -896.2292058888935, -964.0834131168805, -1013.652153672089, -588.2568382069389, -619.1685472077081, -961.3726654618121, -679.3912721613107, -545.6730933335284, -376.0236951902823, -653.1001606933421, -814.9315259429418, -854.8000692655935, -524.0470061676156, -605.0998920006286, -708.1750676846361, -810.0858574256316, -972.9784852489795, -465.0305409430647, -820.7630550745884, -674.1608211203869, -701.5511190138091, -1015.8245870393804, -688.1877178368541, -913.7429877270883, -957.3807448864148, -980.690926533723, -635.8164732742916, -1038.9959112623549, -798.3671265104039, -985.0507328121622, -909.7584013792837, -664.9043829806535, -550.3429869053524, -922.4678708029103, -817.0432076537971, -606.3966063351744, -715.8997122790017, -581.369814242515, -722.5601392597337, -682.6704451177101, -813.7480381669358, -800.0170557657304, -688.515361895256, -656.8257082151661, -706.0121841492595, -921.3153022098309, -618.2226863519622, -781.9132054701772, -757.9825663255237, -809.3578777297809, -518.1503008899604, -791.9352729033599, -1034.920910177727, -849.6202455813967, -878.3370146796489, -553.6211473432435, -502.1919158424673, -696.9409535721932, -586.0176853132299, -998.937666030531, -864.431869177693, -602.0025835532326, -796.7895092014937, -647.2561380776884, -236.0166478699493, -636.2536656975443, -661.0210729432954, -659.2375585738099, -890.6729698007413, -810.4122099881012, -420.23710906097955, -999.1882430694006, -685.1520441618709, -712.5506270730253, -807.3880170914313, -983.3103777503555, -802.3735094427007, -606.1927232251744, -601.4036421112345, -966.0492808920018, -520.5992178428874, -600.5375929979575, -641.8323874065542, -962.5451956320919, -594.3087991486598, -772.9163376438366, -719.9538553926772, -474.6575614205599], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.455490618284692, "mean_inference_ms": 0.4177789304458466, "mean_action_processing_ms": 0.09800584299353333, "mean_env_wait_ms": 2.753652510258023, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037941932678222656, "StateBufferConnector_ms": 0.0028417110443115234, "ViewRequirementAgentConnector_ms": 0.07047891616821289}}, "episode_reward_max": -236.0166478699493, "episode_reward_min": -1038.9959112623549, "episode_reward_mean": -744.0783247748186, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-849.3419183240953, -801.2879736130425, -738.39199592524, -896.1957660248137, -895.128718650913, -825.6136082124613, -882.8726763830157, -416.5620963072277, -635.6473578672366, -749.95019999497, -835.4811765437128, -805.439885115331, -896.2292058888935, -964.0834131168805, -1013.652153672089, -588.2568382069389, -619.1685472077081, -961.3726654618121, -679.3912721613107, -545.6730933335284, -376.0236951902823, -653.1001606933421, -814.9315259429418, -854.8000692655935, -524.0470061676156, -605.0998920006286, -708.1750676846361, -810.0858574256316, -972.9784852489795, -465.0305409430647, -820.7630550745884, -674.1608211203869, -701.5511190138091, -1015.8245870393804, -688.1877178368541, -913.7429877270883, -957.3807448864148, -980.690926533723, -635.8164732742916, -1038.9959112623549, -798.3671265104039, -985.0507328121622, -909.7584013792837, -664.9043829806535, -550.3429869053524, -922.4678708029103, -817.0432076537971, -606.3966063351744, -715.8997122790017, -581.369814242515, -722.5601392597337, -682.6704451177101, -813.7480381669358, -800.0170557657304, -688.515361895256, -656.8257082151661, -706.0121841492595, -921.3153022098309, -618.2226863519622, -781.9132054701772, -757.9825663255237, -809.3578777297809, -518.1503008899604, -791.9352729033599, -1034.920910177727, -849.6202455813967, -878.3370146796489, -553.6211473432435, -502.1919158424673, -696.9409535721932, -586.0176853132299, -998.937666030531, -864.431869177693, -602.0025835532326, -796.7895092014937, -647.2561380776884, -236.0166478699493, -636.2536656975443, -661.0210729432954, -659.2375585738099, -890.6729698007413, -810.4122099881012, -420.23710906097955, -999.1882430694006, -685.1520441618709, -712.5506270730253, -807.3880170914313, -983.3103777503555, -802.3735094427007, -606.1927232251744, -601.4036421112345, -966.0492808920018, -520.5992178428874, -600.5375929979575, -641.8323874065542, -962.5451956320919, -594.3087991486598, -772.9163376438366, -719.9538553926772, -474.6575614205599], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.455490618284692, "mean_inference_ms": 0.4177789304458466, "mean_action_processing_ms": 0.09800584299353333, "mean_env_wait_ms": 2.753652510258023, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037941932678222656, "StateBufferConnector_ms": 0.0028417110443115234, "ViewRequirementAgentConnector_ms": 0.07047891616821289}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 266400, "num_agent_steps_trained": 266400, "num_env_steps_sampled": 266400, "num_env_steps_trained": 266400, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.107627667500495, "num_env_steps_trained_throughput_per_sec": 41.107627667500495, "timesteps_total": 266400, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 266400, "timers": {"training_iteration_time_ms": 2899.952, "sample_time_ms": 2895.735, "load_time_ms": 0.22, "load_throughput": 545896.399, "learn_time_ms": 3.162, "learn_throughput": 37951.492, "synch_weights_time_ms": 0.787}, "counters": {"num_env_steps_sampled": 266400, "num_env_steps_trained": 266400, "num_agent_steps_sampled": 266400, "num_agent_steps_trained": 266400}, "done": false, "episodes_total": 2220, "training_iteration": 556, "trial_id": "53665_00000", "date": "2023-07-26_03-40-17", "timestamp": 1690332017, "time_this_iter_s": 11.67939305305481, "time_total_s": 6757.756625652313, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1136.4311497211456, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 35.0125, "ram_util_percent": 77.05000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.825e-08, "entropy_coeff": 0.05, "policy_entropy": 267.4770202636719, "policy_loss": -67001.1953125, "vf_loss": 2069023.375}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 386.0, "diff_num_grad_updates_vs_sampler_policy": 385.0}}, "num_env_steps_sampled": 266880, "num_env_steps_trained": 266880, "num_agent_steps_sampled": 266880, "num_agent_steps_trained": 266880}, "sampler_results": {"episode_reward_max": -236.0166478699493, "episode_reward_min": -1038.9959112623549, "episode_reward_mean": -738.0266698033797, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-895.128718650913, -825.6136082124613, -882.8726763830157, -416.5620963072277, -635.6473578672366, -749.95019999497, -835.4811765437128, -805.439885115331, -896.2292058888935, -964.0834131168805, -1013.652153672089, -588.2568382069389, -619.1685472077081, -961.3726654618121, -679.3912721613107, -545.6730933335284, -376.0236951902823, -653.1001606933421, -814.9315259429418, -854.8000692655935, -524.0470061676156, -605.0998920006286, -708.1750676846361, -810.0858574256316, -972.9784852489795, -465.0305409430647, -820.7630550745884, -674.1608211203869, -701.5511190138091, -1015.8245870393804, -688.1877178368541, -913.7429877270883, -957.3807448864148, -980.690926533723, -635.8164732742916, -1038.9959112623549, -798.3671265104039, -985.0507328121622, -909.7584013792837, -664.9043829806535, -550.3429869053524, -922.4678708029103, -817.0432076537971, -606.3966063351744, -715.8997122790017, -581.369814242515, -722.5601392597337, -682.6704451177101, -813.7480381669358, -800.0170557657304, -688.515361895256, -656.8257082151661, -706.0121841492595, -921.3153022098309, -618.2226863519622, -781.9132054701772, -757.9825663255237, -809.3578777297809, -518.1503008899604, -791.9352729033599, -1034.920910177727, -849.6202455813967, -878.3370146796489, -553.6211473432435, -502.1919158424673, -696.9409535721932, -586.0176853132299, -998.937666030531, -864.431869177693, -602.0025835532326, -796.7895092014937, -647.2561380776884, -236.0166478699493, -636.2536656975443, -661.0210729432954, -659.2375585738099, -890.6729698007413, -810.4122099881012, -420.23710906097955, -999.1882430694006, -685.1520441618709, -712.5506270730253, -807.3880170914313, -983.3103777503555, -802.3735094427007, -606.1927232251744, -601.4036421112345, -966.0492808920018, -520.5992178428874, -600.5375929979575, -641.8323874065542, -962.5451956320919, -594.3087991486598, -772.9163376438366, -719.9538553926772, -474.6575614205599, -699.51904075112, -638.947254086584, -784.4679001007582, -557.1179618048418], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.45405053024142, "mean_inference_ms": 0.4176630146736271, "mean_action_processing_ms": 0.09798845802110062, "mean_env_wait_ms": 2.752491288539553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003780364990234375, "StateBufferConnector_ms": 0.002844095230102539, "ViewRequirementAgentConnector_ms": 0.07039690017700195}}, "episode_reward_max": -236.0166478699493, "episode_reward_min": -1038.9959112623549, "episode_reward_mean": -738.0266698033797, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-895.128718650913, -825.6136082124613, -882.8726763830157, -416.5620963072277, -635.6473578672366, -749.95019999497, -835.4811765437128, -805.439885115331, -896.2292058888935, -964.0834131168805, -1013.652153672089, -588.2568382069389, -619.1685472077081, -961.3726654618121, -679.3912721613107, -545.6730933335284, -376.0236951902823, -653.1001606933421, -814.9315259429418, -854.8000692655935, -524.0470061676156, -605.0998920006286, -708.1750676846361, -810.0858574256316, -972.9784852489795, -465.0305409430647, -820.7630550745884, -674.1608211203869, -701.5511190138091, -1015.8245870393804, -688.1877178368541, -913.7429877270883, -957.3807448864148, -980.690926533723, -635.8164732742916, -1038.9959112623549, -798.3671265104039, -985.0507328121622, -909.7584013792837, -664.9043829806535, -550.3429869053524, -922.4678708029103, -817.0432076537971, -606.3966063351744, -715.8997122790017, -581.369814242515, -722.5601392597337, -682.6704451177101, -813.7480381669358, -800.0170557657304, -688.515361895256, -656.8257082151661, -706.0121841492595, -921.3153022098309, -618.2226863519622, -781.9132054701772, -757.9825663255237, -809.3578777297809, -518.1503008899604, -791.9352729033599, -1034.920910177727, -849.6202455813967, -878.3370146796489, -553.6211473432435, -502.1919158424673, -696.9409535721932, -586.0176853132299, -998.937666030531, -864.431869177693, -602.0025835532326, -796.7895092014937, -647.2561380776884, -236.0166478699493, -636.2536656975443, -661.0210729432954, -659.2375585738099, -890.6729698007413, -810.4122099881012, -420.23710906097955, -999.1882430694006, -685.1520441618709, -712.5506270730253, -807.3880170914313, -983.3103777503555, -802.3735094427007, -606.1927232251744, -601.4036421112345, -966.0492808920018, -520.5992178428874, -600.5375929979575, -641.8323874065542, -962.5451956320919, -594.3087991486598, -772.9163376438366, -719.9538553926772, -474.6575614205599, -699.51904075112, -638.947254086584, -784.4679001007582, -557.1179618048418], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.45405053024142, "mean_inference_ms": 0.4176630146736271, "mean_action_processing_ms": 0.09798845802110062, "mean_env_wait_ms": 2.752491288539553, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003780364990234375, "StateBufferConnector_ms": 0.002844095230102539, "ViewRequirementAgentConnector_ms": 0.07039690017700195}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 266880, "num_agent_steps_trained": 266880, "num_env_steps_sampled": 266880, "num_env_steps_trained": 266880, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.733927201273254, "num_env_steps_trained_throughput_per_sec": 40.733927201273254, "timesteps_total": 266880, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 266880, "timers": {"training_iteration_time_ms": 2920.731, "sample_time_ms": 2917.005, "load_time_ms": 0.217, "load_throughput": 552003.159, "learn_time_ms": 2.76, "learn_throughput": 43486.071, "synch_weights_time_ms": 0.706}, "counters": {"num_env_steps_sampled": 266880, "num_env_steps_trained": 266880, "num_agent_steps_sampled": 266880, "num_agent_steps_trained": 266880}, "done": false, "episodes_total": 2224, "training_iteration": 557, "trial_id": "53665_00000", "date": "2023-07-26_03-40-29", "timestamp": 1690332029, "time_this_iter_s": 11.786559104919434, "time_total_s": 6769.543184757233, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1148.217708826065, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 35.8235294117647, "ram_util_percent": 76.73529411764707}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.525e-08, "entropy_coeff": 0.05, "policy_entropy": 267.45318603515625, "policy_loss": -71949.359375, "vf_loss": 2642165.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 390.0, "diff_num_grad_updates_vs_sampler_policy": 389.0}}, "num_env_steps_sampled": 267360, "num_env_steps_trained": 267360, "num_agent_steps_sampled": 267360, "num_agent_steps_trained": 267360}, "sampler_results": {"episode_reward_max": -236.0166478699493, "episode_reward_min": -1075.706434745053, "episode_reward_mean": -738.8087731845412, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-635.6473578672366, -749.95019999497, -835.4811765437128, -805.439885115331, -896.2292058888935, -964.0834131168805, -1013.652153672089, -588.2568382069389, -619.1685472077081, -961.3726654618121, -679.3912721613107, -545.6730933335284, -376.0236951902823, -653.1001606933421, -814.9315259429418, -854.8000692655935, -524.0470061676156, -605.0998920006286, -708.1750676846361, -810.0858574256316, -972.9784852489795, -465.0305409430647, -820.7630550745884, -674.1608211203869, -701.5511190138091, -1015.8245870393804, -688.1877178368541, -913.7429877270883, -957.3807448864148, -980.690926533723, -635.8164732742916, -1038.9959112623549, -798.3671265104039, -985.0507328121622, -909.7584013792837, -664.9043829806535, -550.3429869053524, -922.4678708029103, -817.0432076537971, -606.3966063351744, -715.8997122790017, -581.369814242515, -722.5601392597337, -682.6704451177101, -813.7480381669358, -800.0170557657304, -688.515361895256, -656.8257082151661, -706.0121841492595, -921.3153022098309, -618.2226863519622, -781.9132054701772, -757.9825663255237, -809.3578777297809, -518.1503008899604, -791.9352729033599, -1034.920910177727, -849.6202455813967, -878.3370146796489, -553.6211473432435, -502.1919158424673, -696.9409535721932, -586.0176853132299, -998.937666030531, -864.431869177693, -602.0025835532326, -796.7895092014937, -647.2561380776884, -236.0166478699493, -636.2536656975443, -661.0210729432954, -659.2375585738099, -890.6729698007413, -810.4122099881012, -420.23710906097955, -999.1882430694006, -685.1520441618709, -712.5506270730253, -807.3880170914313, -983.3103777503555, -802.3735094427007, -606.1927232251744, -601.4036421112345, -966.0492808920018, -520.5992178428874, -600.5375929979575, -641.8323874065542, -962.5451956320919, -594.3087991486598, -772.9163376438366, -719.9538553926772, -474.6575614205599, -699.51904075112, -638.947254086584, -784.4679001007582, -557.1179618048418, -839.2750058176025, -1075.706434745053, -621.5407325078561, -561.8652645992591], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.452549352426995, "mean_inference_ms": 0.41754153909071223, "mean_action_processing_ms": 0.097970717680554, "mean_env_wait_ms": 2.751360421088847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037758350372314453, "StateBufferConnector_ms": 0.002852201461791992, "ViewRequirementAgentConnector_ms": 0.07022976875305176}}, "episode_reward_max": -236.0166478699493, "episode_reward_min": -1075.706434745053, "episode_reward_mean": -738.8087731845412, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-635.6473578672366, -749.95019999497, -835.4811765437128, -805.439885115331, -896.2292058888935, -964.0834131168805, -1013.652153672089, -588.2568382069389, -619.1685472077081, -961.3726654618121, -679.3912721613107, -545.6730933335284, -376.0236951902823, -653.1001606933421, -814.9315259429418, -854.8000692655935, -524.0470061676156, -605.0998920006286, -708.1750676846361, -810.0858574256316, -972.9784852489795, -465.0305409430647, -820.7630550745884, -674.1608211203869, -701.5511190138091, -1015.8245870393804, -688.1877178368541, -913.7429877270883, -957.3807448864148, -980.690926533723, -635.8164732742916, -1038.9959112623549, -798.3671265104039, -985.0507328121622, -909.7584013792837, -664.9043829806535, -550.3429869053524, -922.4678708029103, -817.0432076537971, -606.3966063351744, -715.8997122790017, -581.369814242515, -722.5601392597337, -682.6704451177101, -813.7480381669358, -800.0170557657304, -688.515361895256, -656.8257082151661, -706.0121841492595, -921.3153022098309, -618.2226863519622, -781.9132054701772, -757.9825663255237, -809.3578777297809, -518.1503008899604, -791.9352729033599, -1034.920910177727, -849.6202455813967, -878.3370146796489, -553.6211473432435, -502.1919158424673, -696.9409535721932, -586.0176853132299, -998.937666030531, -864.431869177693, -602.0025835532326, -796.7895092014937, -647.2561380776884, -236.0166478699493, -636.2536656975443, -661.0210729432954, -659.2375585738099, -890.6729698007413, -810.4122099881012, -420.23710906097955, -999.1882430694006, -685.1520441618709, -712.5506270730253, -807.3880170914313, -983.3103777503555, -802.3735094427007, -606.1927232251744, -601.4036421112345, -966.0492808920018, -520.5992178428874, -600.5375929979575, -641.8323874065542, -962.5451956320919, -594.3087991486598, -772.9163376438366, -719.9538553926772, -474.6575614205599, -699.51904075112, -638.947254086584, -784.4679001007582, -557.1179618048418, -839.2750058176025, -1075.706434745053, -621.5407325078561, -561.8652645992591], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.452549352426995, "mean_inference_ms": 0.41754153909071223, "mean_action_processing_ms": 0.097970717680554, "mean_env_wait_ms": 2.751360421088847, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037758350372314453, "StateBufferConnector_ms": 0.002852201461791992, "ViewRequirementAgentConnector_ms": 0.07022976875305176}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 267360, "num_agent_steps_trained": 267360, "num_env_steps_sampled": 267360, "num_env_steps_trained": 267360, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.7376296635668, "num_env_steps_trained_throughput_per_sec": 40.7376296635668, "timesteps_total": 267360, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 267360, "timers": {"training_iteration_time_ms": 2936.893, "sample_time_ms": 2933.174, "load_time_ms": 0.216, "load_throughput": 555108.062, "learn_time_ms": 2.755, "learn_throughput": 43552.674, "synch_weights_time_ms": 0.708}, "counters": {"num_env_steps_sampled": 267360, "num_env_steps_trained": 267360, "num_agent_steps_sampled": 267360, "num_agent_steps_trained": 267360}, "done": false, "episodes_total": 2228, "training_iteration": 558, "trial_id": "53665_00000", "date": "2023-07-26_03-40-41", "timestamp": 1690332041, "time_this_iter_s": 11.785648107528687, "time_total_s": 6781.328832864761, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1160.0033569335938, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 40.3235294117647, "ram_util_percent": 76.73529411764707}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.225e-08, "entropy_coeff": 0.05, "policy_entropy": 267.5008850097656, "policy_loss": -121605.9453125, "vf_loss": 6464396.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 394.0, "diff_num_grad_updates_vs_sampler_policy": 393.0}}, "num_env_steps_sampled": 267840, "num_env_steps_trained": 267840, "num_agent_steps_sampled": 267840, "num_agent_steps_trained": 267840}, "sampler_results": {"episode_reward_max": -236.0166478699493, "episode_reward_min": -1075.706434745053, "episode_reward_mean": -737.3842244977982, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-896.2292058888935, -964.0834131168805, -1013.652153672089, -588.2568382069389, -619.1685472077081, -961.3726654618121, -679.3912721613107, -545.6730933335284, -376.0236951902823, -653.1001606933421, -814.9315259429418, -854.8000692655935, -524.0470061676156, -605.0998920006286, -708.1750676846361, -810.0858574256316, -972.9784852489795, -465.0305409430647, -820.7630550745884, -674.1608211203869, -701.5511190138091, -1015.8245870393804, -688.1877178368541, -913.7429877270883, -957.3807448864148, -980.690926533723, -635.8164732742916, -1038.9959112623549, -798.3671265104039, -985.0507328121622, -909.7584013792837, -664.9043829806535, -550.3429869053524, -922.4678708029103, -817.0432076537971, -606.3966063351744, -715.8997122790017, -581.369814242515, -722.5601392597337, -682.6704451177101, -813.7480381669358, -800.0170557657304, -688.515361895256, -656.8257082151661, -706.0121841492595, -921.3153022098309, -618.2226863519622, -781.9132054701772, -757.9825663255237, -809.3578777297809, -518.1503008899604, -791.9352729033599, -1034.920910177727, -849.6202455813967, -878.3370146796489, -553.6211473432435, -502.1919158424673, -696.9409535721932, -586.0176853132299, -998.937666030531, -864.431869177693, -602.0025835532326, -796.7895092014937, -647.2561380776884, -236.0166478699493, -636.2536656975443, -661.0210729432954, -659.2375585738099, -890.6729698007413, -810.4122099881012, -420.23710906097955, -999.1882430694006, -685.1520441618709, -712.5506270730253, -807.3880170914313, -983.3103777503555, -802.3735094427007, -606.1927232251744, -601.4036421112345, -966.0492808920018, -520.5992178428874, -600.5375929979575, -641.8323874065542, -962.5451956320919, -594.3087991486598, -772.9163376438366, -719.9538553926772, -474.6575614205599, -699.51904075112, -638.947254086584, -784.4679001007582, -557.1179618048418, -839.2750058176025, -1075.706434745053, -621.5407325078561, -561.8652645992591, -684.4522993353054, -503.06258249728535, -834.3587733516559, -862.1900956627134], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.45081326387271, "mean_inference_ms": 0.4174217411824448, "mean_action_processing_ms": 0.09795343240240038, "mean_env_wait_ms": 2.75023595638968, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037813186645507812, "StateBufferConnector_ms": 0.002855539321899414, "ViewRequirementAgentConnector_ms": 0.07027864456176758}}, "episode_reward_max": -236.0166478699493, "episode_reward_min": -1075.706434745053, "episode_reward_mean": -737.3842244977982, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-896.2292058888935, -964.0834131168805, -1013.652153672089, -588.2568382069389, -619.1685472077081, -961.3726654618121, -679.3912721613107, -545.6730933335284, -376.0236951902823, -653.1001606933421, -814.9315259429418, -854.8000692655935, -524.0470061676156, -605.0998920006286, -708.1750676846361, -810.0858574256316, -972.9784852489795, -465.0305409430647, -820.7630550745884, -674.1608211203869, -701.5511190138091, -1015.8245870393804, -688.1877178368541, -913.7429877270883, -957.3807448864148, -980.690926533723, -635.8164732742916, -1038.9959112623549, -798.3671265104039, -985.0507328121622, -909.7584013792837, -664.9043829806535, -550.3429869053524, -922.4678708029103, -817.0432076537971, -606.3966063351744, -715.8997122790017, -581.369814242515, -722.5601392597337, -682.6704451177101, -813.7480381669358, -800.0170557657304, -688.515361895256, -656.8257082151661, -706.0121841492595, -921.3153022098309, -618.2226863519622, -781.9132054701772, -757.9825663255237, -809.3578777297809, -518.1503008899604, -791.9352729033599, -1034.920910177727, -849.6202455813967, -878.3370146796489, -553.6211473432435, -502.1919158424673, -696.9409535721932, -586.0176853132299, -998.937666030531, -864.431869177693, -602.0025835532326, -796.7895092014937, -647.2561380776884, -236.0166478699493, -636.2536656975443, -661.0210729432954, -659.2375585738099, -890.6729698007413, -810.4122099881012, -420.23710906097955, -999.1882430694006, -685.1520441618709, -712.5506270730253, -807.3880170914313, -983.3103777503555, -802.3735094427007, -606.1927232251744, -601.4036421112345, -966.0492808920018, -520.5992178428874, -600.5375929979575, -641.8323874065542, -962.5451956320919, -594.3087991486598, -772.9163376438366, -719.9538553926772, -474.6575614205599, -699.51904075112, -638.947254086584, -784.4679001007582, -557.1179618048418, -839.2750058176025, -1075.706434745053, -621.5407325078561, -561.8652645992591, -684.4522993353054, -503.06258249728535, -834.3587733516559, -862.1900956627134], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.45081326387271, "mean_inference_ms": 0.4174217411824448, "mean_action_processing_ms": 0.09795343240240038, "mean_env_wait_ms": 2.75023595638968, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037813186645507812, "StateBufferConnector_ms": 0.002855539321899414, "ViewRequirementAgentConnector_ms": 0.07027864456176758}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 267840, "num_agent_steps_trained": 267840, "num_env_steps_sampled": 267840, "num_env_steps_trained": 267840, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.22125159076533, "num_env_steps_trained_throughput_per_sec": 41.22125159076533, "timesteps_total": 267840, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 267840, "timers": {"training_iteration_time_ms": 2950.179, "sample_time_ms": 2946.429, "load_time_ms": 0.22, "load_throughput": 546667.188, "learn_time_ms": 2.78, "learn_throughput": 43158.306, "synch_weights_time_ms": 0.711}, "counters": {"num_env_steps_sampled": 267840, "num_env_steps_trained": 267840, "num_agent_steps_sampled": 267840, "num_agent_steps_trained": 267840}, "done": false, "episodes_total": 2232, "training_iteration": 559, "trial_id": "53665_00000", "date": "2023-07-26_03-40-53", "timestamp": 1690332053, "time_this_iter_s": 11.647426843643188, "time_total_s": 6792.9762597084045, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1171.650783777237, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 41.7375, "ram_util_percent": 76.7125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": 267.47613525390625, "policy_loss": -82343.78125, "vf_loss": 3567588.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 398.0, "diff_num_grad_updates_vs_sampler_policy": 397.0}}, "num_env_steps_sampled": 268320, "num_env_steps_trained": 268320, "num_agent_steps_sampled": 268320, "num_agent_steps_trained": 268320}, "sampler_results": {"episode_reward_max": -236.0166478699493, "episode_reward_min": -1075.706434745053, "episode_reward_mean": -735.7981543743664, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-619.1685472077081, -961.3726654618121, -679.3912721613107, -545.6730933335284, -376.0236951902823, -653.1001606933421, -814.9315259429418, -854.8000692655935, -524.0470061676156, -605.0998920006286, -708.1750676846361, -810.0858574256316, -972.9784852489795, -465.0305409430647, -820.7630550745884, -674.1608211203869, -701.5511190138091, -1015.8245870393804, -688.1877178368541, -913.7429877270883, -957.3807448864148, -980.690926533723, -635.8164732742916, -1038.9959112623549, -798.3671265104039, -985.0507328121622, -909.7584013792837, -664.9043829806535, -550.3429869053524, -922.4678708029103, -817.0432076537971, -606.3966063351744, -715.8997122790017, -581.369814242515, -722.5601392597337, -682.6704451177101, -813.7480381669358, -800.0170557657304, -688.515361895256, -656.8257082151661, -706.0121841492595, -921.3153022098309, -618.2226863519622, -781.9132054701772, -757.9825663255237, -809.3578777297809, -518.1503008899604, -791.9352729033599, -1034.920910177727, -849.6202455813967, -878.3370146796489, -553.6211473432435, -502.1919158424673, -696.9409535721932, -586.0176853132299, -998.937666030531, -864.431869177693, -602.0025835532326, -796.7895092014937, -647.2561380776884, -236.0166478699493, -636.2536656975443, -661.0210729432954, -659.2375585738099, -890.6729698007413, -810.4122099881012, -420.23710906097955, -999.1882430694006, -685.1520441618709, -712.5506270730253, -807.3880170914313, -983.3103777503555, -802.3735094427007, -606.1927232251744, -601.4036421112345, -966.0492808920018, -520.5992178428874, -600.5375929979575, -641.8323874065542, -962.5451956320919, -594.3087991486598, -772.9163376438366, -719.9538553926772, -474.6575614205599, -699.51904075112, -638.947254086584, -784.4679001007582, -557.1179618048418, -839.2750058176025, -1075.706434745053, -621.5407325078561, -561.8652645992591, -684.4522993353054, -503.06258249728535, -834.3587733516559, -862.1900956627134, -809.9168935275501, -875.6670549559827, -963.6767032457285, -654.353946812361], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.4488241276388, "mean_inference_ms": 0.4172825299607669, "mean_action_processing_ms": 0.09793281668017538, "mean_env_wait_ms": 2.7491195649668696, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037822723388671875, "StateBufferConnector_ms": 0.0028586387634277344, "ViewRequirementAgentConnector_ms": 0.07024455070495605}}, "episode_reward_max": -236.0166478699493, "episode_reward_min": -1075.706434745053, "episode_reward_mean": -735.7981543743664, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-619.1685472077081, -961.3726654618121, -679.3912721613107, -545.6730933335284, -376.0236951902823, -653.1001606933421, -814.9315259429418, -854.8000692655935, -524.0470061676156, -605.0998920006286, -708.1750676846361, -810.0858574256316, -972.9784852489795, -465.0305409430647, -820.7630550745884, -674.1608211203869, -701.5511190138091, -1015.8245870393804, -688.1877178368541, -913.7429877270883, -957.3807448864148, -980.690926533723, -635.8164732742916, -1038.9959112623549, -798.3671265104039, -985.0507328121622, -909.7584013792837, -664.9043829806535, -550.3429869053524, -922.4678708029103, -817.0432076537971, -606.3966063351744, -715.8997122790017, -581.369814242515, -722.5601392597337, -682.6704451177101, -813.7480381669358, -800.0170557657304, -688.515361895256, -656.8257082151661, -706.0121841492595, -921.3153022098309, -618.2226863519622, -781.9132054701772, -757.9825663255237, -809.3578777297809, -518.1503008899604, -791.9352729033599, -1034.920910177727, -849.6202455813967, -878.3370146796489, -553.6211473432435, -502.1919158424673, -696.9409535721932, -586.0176853132299, -998.937666030531, -864.431869177693, -602.0025835532326, -796.7895092014937, -647.2561380776884, -236.0166478699493, -636.2536656975443, -661.0210729432954, -659.2375585738099, -890.6729698007413, -810.4122099881012, -420.23710906097955, -999.1882430694006, -685.1520441618709, -712.5506270730253, -807.3880170914313, -983.3103777503555, -802.3735094427007, -606.1927232251744, -601.4036421112345, -966.0492808920018, -520.5992178428874, -600.5375929979575, -641.8323874065542, -962.5451956320919, -594.3087991486598, -772.9163376438366, -719.9538553926772, -474.6575614205599, -699.51904075112, -638.947254086584, -784.4679001007582, -557.1179618048418, -839.2750058176025, -1075.706434745053, -621.5407325078561, -561.8652645992591, -684.4522993353054, -503.06258249728535, -834.3587733516559, -862.1900956627134, -809.9168935275501, -875.6670549559827, -963.6767032457285, -654.353946812361], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.4488241276388, "mean_inference_ms": 0.4172825299607669, "mean_action_processing_ms": 0.09793281668017538, "mean_env_wait_ms": 2.7491195649668696, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037822723388671875, "StateBufferConnector_ms": 0.0028586387634277344, "ViewRequirementAgentConnector_ms": 0.07024455070495605}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 268320, "num_agent_steps_trained": 268320, "num_env_steps_sampled": 268320, "num_env_steps_trained": 268320, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.88998633231013, "num_env_steps_trained_throughput_per_sec": 41.88998633231013, "timesteps_total": 268320, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 268320, "timers": {"training_iteration_time_ms": 2904.069, "sample_time_ms": 2900.279, "load_time_ms": 0.223, "load_throughput": 538652.055, "learn_time_ms": 2.804, "learn_throughput": 42793.562, "synch_weights_time_ms": 0.722}, "counters": {"num_env_steps_sampled": 268320, "num_env_steps_trained": 268320, "num_agent_steps_sampled": 268320, "num_agent_steps_trained": 268320}, "done": false, "episodes_total": 2236, "training_iteration": 560, "trial_id": "53665_00000", "date": "2023-07-26_03-41-04", "timestamp": 1690332064, "time_this_iter_s": 11.461470127105713, "time_total_s": 6804.43772983551, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1183.1122539043427, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 38.170588235294126, "ram_util_percent": 76.11176470588236}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": 267.5002746582031, "policy_loss": -114951.71875, "vf_loss": 6223213.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 402.0, "diff_num_grad_updates_vs_sampler_policy": 401.0}}, "num_env_steps_sampled": 268800, "num_env_steps_trained": 268800, "num_agent_steps_sampled": 268800, "num_agent_steps_trained": 268800}, "sampler_results": {"episode_reward_max": -236.0166478699493, "episode_reward_min": -1075.706434745053, "episode_reward_mean": -731.6459001718716, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-376.0236951902823, -653.1001606933421, -814.9315259429418, -854.8000692655935, -524.0470061676156, -605.0998920006286, -708.1750676846361, -810.0858574256316, -972.9784852489795, -465.0305409430647, -820.7630550745884, -674.1608211203869, -701.5511190138091, -1015.8245870393804, -688.1877178368541, -913.7429877270883, -957.3807448864148, -980.690926533723, -635.8164732742916, -1038.9959112623549, -798.3671265104039, -985.0507328121622, -909.7584013792837, -664.9043829806535, -550.3429869053524, -922.4678708029103, -817.0432076537971, -606.3966063351744, -715.8997122790017, -581.369814242515, -722.5601392597337, -682.6704451177101, -813.7480381669358, -800.0170557657304, -688.515361895256, -656.8257082151661, -706.0121841492595, -921.3153022098309, -618.2226863519622, -781.9132054701772, -757.9825663255237, -809.3578777297809, -518.1503008899604, -791.9352729033599, -1034.920910177727, -849.6202455813967, -878.3370146796489, -553.6211473432435, -502.1919158424673, -696.9409535721932, -586.0176853132299, -998.937666030531, -864.431869177693, -602.0025835532326, -796.7895092014937, -647.2561380776884, -236.0166478699493, -636.2536656975443, -661.0210729432954, -659.2375585738099, -890.6729698007413, -810.4122099881012, -420.23710906097955, -999.1882430694006, -685.1520441618709, -712.5506270730253, -807.3880170914313, -983.3103777503555, -802.3735094427007, -606.1927232251744, -601.4036421112345, -966.0492808920018, -520.5992178428874, -600.5375929979575, -641.8323874065542, -962.5451956320919, -594.3087991486598, -772.9163376438366, -719.9538553926772, -474.6575614205599, -699.51904075112, -638.947254086584, -784.4679001007582, -557.1179618048418, -839.2750058176025, -1075.706434745053, -621.5407325078561, -561.8652645992591, -684.4522993353054, -503.06258249728535, -834.3587733516559, -862.1900956627134, -809.9168935275501, -875.6670549559827, -963.6767032457285, -654.353946812361, -345.0189279420206, -756.4941077139541, -444.8640447618194, -844.0030774970837], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.44703613972316, "mean_inference_ms": 0.4171243574619619, "mean_action_processing_ms": 0.09790958259980272, "mean_env_wait_ms": 2.7480188266788734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037806034088134766, "StateBufferConnector_ms": 0.0028443336486816406, "ViewRequirementAgentConnector_ms": 0.07014608383178711}}, "episode_reward_max": -236.0166478699493, "episode_reward_min": -1075.706434745053, "episode_reward_mean": -731.6459001718716, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-376.0236951902823, -653.1001606933421, -814.9315259429418, -854.8000692655935, -524.0470061676156, -605.0998920006286, -708.1750676846361, -810.0858574256316, -972.9784852489795, -465.0305409430647, -820.7630550745884, -674.1608211203869, -701.5511190138091, -1015.8245870393804, -688.1877178368541, -913.7429877270883, -957.3807448864148, -980.690926533723, -635.8164732742916, -1038.9959112623549, -798.3671265104039, -985.0507328121622, -909.7584013792837, -664.9043829806535, -550.3429869053524, -922.4678708029103, -817.0432076537971, -606.3966063351744, -715.8997122790017, -581.369814242515, -722.5601392597337, -682.6704451177101, -813.7480381669358, -800.0170557657304, -688.515361895256, -656.8257082151661, -706.0121841492595, -921.3153022098309, -618.2226863519622, -781.9132054701772, -757.9825663255237, -809.3578777297809, -518.1503008899604, -791.9352729033599, -1034.920910177727, -849.6202455813967, -878.3370146796489, -553.6211473432435, -502.1919158424673, -696.9409535721932, -586.0176853132299, -998.937666030531, -864.431869177693, -602.0025835532326, -796.7895092014937, -647.2561380776884, -236.0166478699493, -636.2536656975443, -661.0210729432954, -659.2375585738099, -890.6729698007413, -810.4122099881012, -420.23710906097955, -999.1882430694006, -685.1520441618709, -712.5506270730253, -807.3880170914313, -983.3103777503555, -802.3735094427007, -606.1927232251744, -601.4036421112345, -966.0492808920018, -520.5992178428874, -600.5375929979575, -641.8323874065542, -962.5451956320919, -594.3087991486598, -772.9163376438366, -719.9538553926772, -474.6575614205599, -699.51904075112, -638.947254086584, -784.4679001007582, -557.1179618048418, -839.2750058176025, -1075.706434745053, -621.5407325078561, -561.8652645992591, -684.4522993353054, -503.06258249728535, -834.3587733516559, -862.1900956627134, -809.9168935275501, -875.6670549559827, -963.6767032457285, -654.353946812361, -345.0189279420206, -756.4941077139541, -444.8640447618194, -844.0030774970837], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.44703613972316, "mean_inference_ms": 0.4171243574619619, "mean_action_processing_ms": 0.09790958259980272, "mean_env_wait_ms": 2.7480188266788734, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037806034088134766, "StateBufferConnector_ms": 0.0028443336486816406, "ViewRequirementAgentConnector_ms": 0.07014608383178711}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 268800, "num_agent_steps_trained": 268800, "num_env_steps_sampled": 268800, "num_env_steps_trained": 268800, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.733851378713375, "num_env_steps_trained_throughput_per_sec": 40.733851378713375, "timesteps_total": 268800, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 268800, "timers": {"training_iteration_time_ms": 2903.578, "sample_time_ms": 2899.773, "load_time_ms": 0.224, "load_throughput": 534589.995, "learn_time_ms": 2.818, "learn_throughput": 42588.252, "synch_weights_time_ms": 0.722}, "counters": {"num_env_steps_sampled": 268800, "num_env_steps_trained": 268800, "num_agent_steps_sampled": 268800, "num_agent_steps_trained": 268800}, "done": false, "episodes_total": 2240, "training_iteration": 561, "trial_id": "53665_00000", "date": "2023-07-26_03-41-16", "timestamp": 1690332076, "time_this_iter_s": 11.786533832550049, "time_total_s": 6816.22426366806, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1194.8987877368927, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 40.31875, "ram_util_percent": 75.375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": 267.48162841796875, "policy_loss": -109647.390625, "vf_loss": 4704610.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 406.0, "diff_num_grad_updates_vs_sampler_policy": 405.0}}, "num_env_steps_sampled": 269280, "num_env_steps_trained": 269280, "num_agent_steps_sampled": 269280, "num_agent_steps_trained": 269280}, "sampler_results": {"episode_reward_max": -236.0166478699493, "episode_reward_min": -1075.706434745053, "episode_reward_mean": -734.0232675200837, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-524.0470061676156, -605.0998920006286, -708.1750676846361, -810.0858574256316, -972.9784852489795, -465.0305409430647, -820.7630550745884, -674.1608211203869, -701.5511190138091, -1015.8245870393804, -688.1877178368541, -913.7429877270883, -957.3807448864148, -980.690926533723, -635.8164732742916, -1038.9959112623549, -798.3671265104039, -985.0507328121622, -909.7584013792837, -664.9043829806535, -550.3429869053524, -922.4678708029103, -817.0432076537971, -606.3966063351744, -715.8997122790017, -581.369814242515, -722.5601392597337, -682.6704451177101, -813.7480381669358, -800.0170557657304, -688.515361895256, -656.8257082151661, -706.0121841492595, -921.3153022098309, -618.2226863519622, -781.9132054701772, -757.9825663255237, -809.3578777297809, -518.1503008899604, -791.9352729033599, -1034.920910177727, -849.6202455813967, -878.3370146796489, -553.6211473432435, -502.1919158424673, -696.9409535721932, -586.0176853132299, -998.937666030531, -864.431869177693, -602.0025835532326, -796.7895092014937, -647.2561380776884, -236.0166478699493, -636.2536656975443, -661.0210729432954, -659.2375585738099, -890.6729698007413, -810.4122099881012, -420.23710906097955, -999.1882430694006, -685.1520441618709, -712.5506270730253, -807.3880170914313, -983.3103777503555, -802.3735094427007, -606.1927232251744, -601.4036421112345, -966.0492808920018, -520.5992178428874, -600.5375929979575, -641.8323874065542, -962.5451956320919, -594.3087991486598, -772.9163376438366, -719.9538553926772, -474.6575614205599, -699.51904075112, -638.947254086584, -784.4679001007582, -557.1179618048418, -839.2750058176025, -1075.706434745053, -621.5407325078561, -561.8652645992591, -684.4522993353054, -503.06258249728535, -834.3587733516559, -862.1900956627134, -809.9168935275501, -875.6670549559827, -963.6767032457285, -654.353946812361, -345.0189279420206, -756.4941077139541, -444.8640447618194, -844.0030774970837, -653.7971306917312, -698.15588955326, -806.1105141535306, -778.5286515148268], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.44524827066415, "mean_inference_ms": 0.4169489418136594, "mean_action_processing_ms": 0.09788345966903239, "mean_env_wait_ms": 2.7469589816385644, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003754138946533203, "StateBufferConnector_ms": 0.0028371810913085938, "ViewRequirementAgentConnector_ms": 0.06983423233032227}}, "episode_reward_max": -236.0166478699493, "episode_reward_min": -1075.706434745053, "episode_reward_mean": -734.0232675200837, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-524.0470061676156, -605.0998920006286, -708.1750676846361, -810.0858574256316, -972.9784852489795, -465.0305409430647, -820.7630550745884, -674.1608211203869, -701.5511190138091, -1015.8245870393804, -688.1877178368541, -913.7429877270883, -957.3807448864148, -980.690926533723, -635.8164732742916, -1038.9959112623549, -798.3671265104039, -985.0507328121622, -909.7584013792837, -664.9043829806535, -550.3429869053524, -922.4678708029103, -817.0432076537971, -606.3966063351744, -715.8997122790017, -581.369814242515, -722.5601392597337, -682.6704451177101, -813.7480381669358, -800.0170557657304, -688.515361895256, -656.8257082151661, -706.0121841492595, -921.3153022098309, -618.2226863519622, -781.9132054701772, -757.9825663255237, -809.3578777297809, -518.1503008899604, -791.9352729033599, -1034.920910177727, -849.6202455813967, -878.3370146796489, -553.6211473432435, -502.1919158424673, -696.9409535721932, -586.0176853132299, -998.937666030531, -864.431869177693, -602.0025835532326, -796.7895092014937, -647.2561380776884, -236.0166478699493, -636.2536656975443, -661.0210729432954, -659.2375585738099, -890.6729698007413, -810.4122099881012, -420.23710906097955, -999.1882430694006, -685.1520441618709, -712.5506270730253, -807.3880170914313, -983.3103777503555, -802.3735094427007, -606.1927232251744, -601.4036421112345, -966.0492808920018, -520.5992178428874, -600.5375929979575, -641.8323874065542, -962.5451956320919, -594.3087991486598, -772.9163376438366, -719.9538553926772, -474.6575614205599, -699.51904075112, -638.947254086584, -784.4679001007582, -557.1179618048418, -839.2750058176025, -1075.706434745053, -621.5407325078561, -561.8652645992591, -684.4522993353054, -503.06258249728535, -834.3587733516559, -862.1900956627134, -809.9168935275501, -875.6670549559827, -963.6767032457285, -654.353946812361, -345.0189279420206, -756.4941077139541, -444.8640447618194, -844.0030774970837, -653.7971306917312, -698.15588955326, -806.1105141535306, -778.5286515148268], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.44524827066415, "mean_inference_ms": 0.4169489418136594, "mean_action_processing_ms": 0.09788345966903239, "mean_env_wait_ms": 2.7469589816385644, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003754138946533203, "StateBufferConnector_ms": 0.0028371810913085938, "ViewRequirementAgentConnector_ms": 0.06983423233032227}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 269280, "num_agent_steps_trained": 269280, "num_env_steps_sampled": 269280, "num_env_steps_trained": 269280, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.655068787246826, "num_env_steps_trained_throughput_per_sec": 40.655068787246826, "timesteps_total": 269280, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 269280, "timers": {"training_iteration_time_ms": 2931.225, "sample_time_ms": 2927.457, "load_time_ms": 0.219, "load_throughput": 547559.269, "learn_time_ms": 2.794, "learn_throughput": 42948.757, "synch_weights_time_ms": 0.714}, "counters": {"num_env_steps_sampled": 269280, "num_env_steps_trained": 269280, "num_agent_steps_sampled": 269280, "num_agent_steps_trained": 269280}, "done": false, "episodes_total": 2244, "training_iteration": 562, "trial_id": "53665_00000", "date": "2023-07-26_03-41-28", "timestamp": 1690332088, "time_this_iter_s": 11.809434175491333, "time_total_s": 6828.033697843552, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1206.708221912384, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 37.741176470588236, "ram_util_percent": 73.5235294117647}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": 267.4970703125, "policy_loss": -59437.6796875, "vf_loss": 1891420.375}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 410.0, "diff_num_grad_updates_vs_sampler_policy": 409.0}}, "num_env_steps_sampled": 269760, "num_env_steps_trained": 269760, "num_agent_steps_sampled": 269760, "num_agent_steps_trained": 269760}, "sampler_results": {"episode_reward_max": -236.0166478699493, "episode_reward_min": -1075.706434745053, "episode_reward_mean": -735.5482872540554, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-972.9784852489795, -465.0305409430647, -820.7630550745884, -674.1608211203869, -701.5511190138091, -1015.8245870393804, -688.1877178368541, -913.7429877270883, -957.3807448864148, -980.690926533723, -635.8164732742916, -1038.9959112623549, -798.3671265104039, -985.0507328121622, -909.7584013792837, -664.9043829806535, -550.3429869053524, -922.4678708029103, -817.0432076537971, -606.3966063351744, -715.8997122790017, -581.369814242515, -722.5601392597337, -682.6704451177101, -813.7480381669358, -800.0170557657304, -688.515361895256, -656.8257082151661, -706.0121841492595, -921.3153022098309, -618.2226863519622, -781.9132054701772, -757.9825663255237, -809.3578777297809, -518.1503008899604, -791.9352729033599, -1034.920910177727, -849.6202455813967, -878.3370146796489, -553.6211473432435, -502.1919158424673, -696.9409535721932, -586.0176853132299, -998.937666030531, -864.431869177693, -602.0025835532326, -796.7895092014937, -647.2561380776884, -236.0166478699493, -636.2536656975443, -661.0210729432954, -659.2375585738099, -890.6729698007413, -810.4122099881012, -420.23710906097955, -999.1882430694006, -685.1520441618709, -712.5506270730253, -807.3880170914313, -983.3103777503555, -802.3735094427007, -606.1927232251744, -601.4036421112345, -966.0492808920018, -520.5992178428874, -600.5375929979575, -641.8323874065542, -962.5451956320919, -594.3087991486598, -772.9163376438366, -719.9538553926772, -474.6575614205599, -699.51904075112, -638.947254086584, -784.4679001007582, -557.1179618048418, -839.2750058176025, -1075.706434745053, -621.5407325078561, -561.8652645992591, -684.4522993353054, -503.06258249728535, -834.3587733516559, -862.1900956627134, -809.9168935275501, -875.6670549559827, -963.6767032457285, -654.353946812361, -345.0189279420206, -756.4941077139541, -444.8640447618194, -844.0030774970837, -653.7971306917312, -698.15588955326, -806.1105141535306, -778.5286515148268, -836.2556057298376, -702.89886243886, -674.3364089798628, -586.4189195271406], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.443582799933434, "mean_inference_ms": 0.4167767588500467, "mean_action_processing_ms": 0.09785785726808842, "mean_env_wait_ms": 2.7459405353294675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003756999969482422, "StateBufferConnector_ms": 0.0028345584869384766, "ViewRequirementAgentConnector_ms": 0.06987857818603516}}, "episode_reward_max": -236.0166478699493, "episode_reward_min": -1075.706434745053, "episode_reward_mean": -735.5482872540554, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-972.9784852489795, -465.0305409430647, -820.7630550745884, -674.1608211203869, -701.5511190138091, -1015.8245870393804, -688.1877178368541, -913.7429877270883, -957.3807448864148, -980.690926533723, -635.8164732742916, -1038.9959112623549, -798.3671265104039, -985.0507328121622, -909.7584013792837, -664.9043829806535, -550.3429869053524, -922.4678708029103, -817.0432076537971, -606.3966063351744, -715.8997122790017, -581.369814242515, -722.5601392597337, -682.6704451177101, -813.7480381669358, -800.0170557657304, -688.515361895256, -656.8257082151661, -706.0121841492595, -921.3153022098309, -618.2226863519622, -781.9132054701772, -757.9825663255237, -809.3578777297809, -518.1503008899604, -791.9352729033599, -1034.920910177727, -849.6202455813967, -878.3370146796489, -553.6211473432435, -502.1919158424673, -696.9409535721932, -586.0176853132299, -998.937666030531, -864.431869177693, -602.0025835532326, -796.7895092014937, -647.2561380776884, -236.0166478699493, -636.2536656975443, -661.0210729432954, -659.2375585738099, -890.6729698007413, -810.4122099881012, -420.23710906097955, -999.1882430694006, -685.1520441618709, -712.5506270730253, -807.3880170914313, -983.3103777503555, -802.3735094427007, -606.1927232251744, -601.4036421112345, -966.0492808920018, -520.5992178428874, -600.5375929979575, -641.8323874065542, -962.5451956320919, -594.3087991486598, -772.9163376438366, -719.9538553926772, -474.6575614205599, -699.51904075112, -638.947254086584, -784.4679001007582, -557.1179618048418, -839.2750058176025, -1075.706434745053, -621.5407325078561, -561.8652645992591, -684.4522993353054, -503.06258249728535, -834.3587733516559, -862.1900956627134, -809.9168935275501, -875.6670549559827, -963.6767032457285, -654.353946812361, -345.0189279420206, -756.4941077139541, -444.8640447618194, -844.0030774970837, -653.7971306917312, -698.15588955326, -806.1105141535306, -778.5286515148268, -836.2556057298376, -702.89886243886, -674.3364089798628, -586.4189195271406], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.443582799933434, "mean_inference_ms": 0.4167767588500467, "mean_action_processing_ms": 0.09785785726808842, "mean_env_wait_ms": 2.7459405353294675, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003756999969482422, "StateBufferConnector_ms": 0.0028345584869384766, "ViewRequirementAgentConnector_ms": 0.06987857818603516}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 269760, "num_agent_steps_trained": 269760, "num_env_steps_sampled": 269760, "num_env_steps_trained": 269760, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.39181020066059, "num_env_steps_trained_throughput_per_sec": 40.39181020066059, "timesteps_total": 269760, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 269760, "timers": {"training_iteration_time_ms": 2946.591, "sample_time_ms": 2942.746, "load_time_ms": 0.226, "load_throughput": 531597.465, "learn_time_ms": 2.849, "learn_throughput": 42120.649, "synch_weights_time_ms": 0.724}, "counters": {"num_env_steps_sampled": 269760, "num_env_steps_trained": 269760, "num_agent_steps_sampled": 269760, "num_agent_steps_trained": 269760}, "done": false, "episodes_total": 2248, "training_iteration": 563, "trial_id": "53665_00000", "date": "2023-07-26_03-41-40", "timestamp": 1690332100, "time_this_iter_s": 11.886327028274536, "time_total_s": 6839.920024871826, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1218.5945489406586, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 40.27058823529411, "ram_util_percent": 74.01764705882354}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": 267.474365234375, "policy_loss": -45923.6875, "vf_loss": 1045647.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 414.0, "diff_num_grad_updates_vs_sampler_policy": 413.0}}, "num_env_steps_sampled": 270240, "num_env_steps_trained": 270240, "num_agent_steps_sampled": 270240, "num_agent_steps_trained": 270240}, "sampler_results": {"episode_reward_max": -236.0166478699493, "episode_reward_min": -1075.706434745053, "episode_reward_mean": -737.7495789674248, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-701.5511190138091, -1015.8245870393804, -688.1877178368541, -913.7429877270883, -957.3807448864148, -980.690926533723, -635.8164732742916, -1038.9959112623549, -798.3671265104039, -985.0507328121622, -909.7584013792837, -664.9043829806535, -550.3429869053524, -922.4678708029103, -817.0432076537971, -606.3966063351744, -715.8997122790017, -581.369814242515, -722.5601392597337, -682.6704451177101, -813.7480381669358, -800.0170557657304, -688.515361895256, -656.8257082151661, -706.0121841492595, -921.3153022098309, -618.2226863519622, -781.9132054701772, -757.9825663255237, -809.3578777297809, -518.1503008899604, -791.9352729033599, -1034.920910177727, -849.6202455813967, -878.3370146796489, -553.6211473432435, -502.1919158424673, -696.9409535721932, -586.0176853132299, -998.937666030531, -864.431869177693, -602.0025835532326, -796.7895092014937, -647.2561380776884, -236.0166478699493, -636.2536656975443, -661.0210729432954, -659.2375585738099, -890.6729698007413, -810.4122099881012, -420.23710906097955, -999.1882430694006, -685.1520441618709, -712.5506270730253, -807.3880170914313, -983.3103777503555, -802.3735094427007, -606.1927232251744, -601.4036421112345, -966.0492808920018, -520.5992178428874, -600.5375929979575, -641.8323874065542, -962.5451956320919, -594.3087991486598, -772.9163376438366, -719.9538553926772, -474.6575614205599, -699.51904075112, -638.947254086584, -784.4679001007582, -557.1179618048418, -839.2750058176025, -1075.706434745053, -621.5407325078561, -561.8652645992591, -684.4522993353054, -503.06258249728535, -834.3587733516559, -862.1900956627134, -809.9168935275501, -875.6670549559827, -963.6767032457285, -654.353946812361, -345.0189279420206, -756.4941077139541, -444.8640447618194, -844.0030774970837, -653.7971306917312, -698.15588955326, -806.1105141535306, -778.5286515148268, -836.2556057298376, -702.89886243886, -674.3364089798628, -586.4189195271406, -957.5296487521726, -910.3520816700877, -893.4379223305275, -391.74242097115416], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.441919808178426, "mean_inference_ms": 0.41661852299796814, "mean_action_processing_ms": 0.09783462167161444, "mean_env_wait_ms": 2.7449858460961036, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003758668899536133, "StateBufferConnector_ms": 0.002829313278198242, "ViewRequirementAgentConnector_ms": 0.06993293762207031}}, "episode_reward_max": -236.0166478699493, "episode_reward_min": -1075.706434745053, "episode_reward_mean": -737.7495789674248, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-701.5511190138091, -1015.8245870393804, -688.1877178368541, -913.7429877270883, -957.3807448864148, -980.690926533723, -635.8164732742916, -1038.9959112623549, -798.3671265104039, -985.0507328121622, -909.7584013792837, -664.9043829806535, -550.3429869053524, -922.4678708029103, -817.0432076537971, -606.3966063351744, -715.8997122790017, -581.369814242515, -722.5601392597337, -682.6704451177101, -813.7480381669358, -800.0170557657304, -688.515361895256, -656.8257082151661, -706.0121841492595, -921.3153022098309, -618.2226863519622, -781.9132054701772, -757.9825663255237, -809.3578777297809, -518.1503008899604, -791.9352729033599, -1034.920910177727, -849.6202455813967, -878.3370146796489, -553.6211473432435, -502.1919158424673, -696.9409535721932, -586.0176853132299, -998.937666030531, -864.431869177693, -602.0025835532326, -796.7895092014937, -647.2561380776884, -236.0166478699493, -636.2536656975443, -661.0210729432954, -659.2375585738099, -890.6729698007413, -810.4122099881012, -420.23710906097955, -999.1882430694006, -685.1520441618709, -712.5506270730253, -807.3880170914313, -983.3103777503555, -802.3735094427007, -606.1927232251744, -601.4036421112345, -966.0492808920018, -520.5992178428874, -600.5375929979575, -641.8323874065542, -962.5451956320919, -594.3087991486598, -772.9163376438366, -719.9538553926772, -474.6575614205599, -699.51904075112, -638.947254086584, -784.4679001007582, -557.1179618048418, -839.2750058176025, -1075.706434745053, -621.5407325078561, -561.8652645992591, -684.4522993353054, -503.06258249728535, -834.3587733516559, -862.1900956627134, -809.9168935275501, -875.6670549559827, -963.6767032457285, -654.353946812361, -345.0189279420206, -756.4941077139541, -444.8640447618194, -844.0030774970837, -653.7971306917312, -698.15588955326, -806.1105141535306, -778.5286515148268, -836.2556057298376, -702.89886243886, -674.3364089798628, -586.4189195271406, -957.5296487521726, -910.3520816700877, -893.4379223305275, -391.74242097115416], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.441919808178426, "mean_inference_ms": 0.41661852299796814, "mean_action_processing_ms": 0.09783462167161444, "mean_env_wait_ms": 2.7449858460961036, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003758668899536133, "StateBufferConnector_ms": 0.002829313278198242, "ViewRequirementAgentConnector_ms": 0.06993293762207031}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 270240, "num_agent_steps_trained": 270240, "num_env_steps_sampled": 270240, "num_env_steps_trained": 270240, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.9663201417162, "num_env_steps_trained_throughput_per_sec": 40.9663201417162, "timesteps_total": 270240, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 270240, "timers": {"training_iteration_time_ms": 2962.022, "sample_time_ms": 2958.157, "load_time_ms": 0.223, "load_throughput": 538018.685, "learn_time_ms": 2.868, "learn_throughput": 41842.966, "synch_weights_time_ms": 0.728}, "counters": {"num_env_steps_sampled": 270240, "num_env_steps_trained": 270240, "num_agent_steps_sampled": 270240, "num_agent_steps_trained": 270240}, "done": false, "episodes_total": 2252, "training_iteration": 564, "trial_id": "53665_00000", "date": "2023-07-26_03-41-51", "timestamp": 1690332111, "time_this_iter_s": 11.719640731811523, "time_total_s": 6851.639665603638, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1230.31418967247, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 37.24375, "ram_util_percent": 72.84375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": 267.49530029296875, "policy_loss": -116178.421875, "vf_loss": 5512420.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 418.0, "diff_num_grad_updates_vs_sampler_policy": 417.0}}, "num_env_steps_sampled": 270720, "num_env_steps_trained": 270720, "num_agent_steps_sampled": 270720, "num_agent_steps_trained": 270720}, "sampler_results": {"episode_reward_max": -236.0166478699493, "episode_reward_min": -1264.805319356825, "episode_reward_mean": -743.0954036085856, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-957.3807448864148, -980.690926533723, -635.8164732742916, -1038.9959112623549, -798.3671265104039, -985.0507328121622, -909.7584013792837, -664.9043829806535, -550.3429869053524, -922.4678708029103, -817.0432076537971, -606.3966063351744, -715.8997122790017, -581.369814242515, -722.5601392597337, -682.6704451177101, -813.7480381669358, -800.0170557657304, -688.515361895256, -656.8257082151661, -706.0121841492595, -921.3153022098309, -618.2226863519622, -781.9132054701772, -757.9825663255237, -809.3578777297809, -518.1503008899604, -791.9352729033599, -1034.920910177727, -849.6202455813967, -878.3370146796489, -553.6211473432435, -502.1919158424673, -696.9409535721932, -586.0176853132299, -998.937666030531, -864.431869177693, -602.0025835532326, -796.7895092014937, -647.2561380776884, -236.0166478699493, -636.2536656975443, -661.0210729432954, -659.2375585738099, -890.6729698007413, -810.4122099881012, -420.23710906097955, -999.1882430694006, -685.1520441618709, -712.5506270730253, -807.3880170914313, -983.3103777503555, -802.3735094427007, -606.1927232251744, -601.4036421112345, -966.0492808920018, -520.5992178428874, -600.5375929979575, -641.8323874065542, -962.5451956320919, -594.3087991486598, -772.9163376438366, -719.9538553926772, -474.6575614205599, -699.51904075112, -638.947254086584, -784.4679001007582, -557.1179618048418, -839.2750058176025, -1075.706434745053, -621.5407325078561, -561.8652645992591, -684.4522993353054, -503.06258249728535, -834.3587733516559, -862.1900956627134, -809.9168935275501, -875.6670549559827, -963.6767032457285, -654.353946812361, -345.0189279420206, -756.4941077139541, -444.8640447618194, -844.0030774970837, -653.7971306917312, -698.15588955326, -806.1105141535306, -778.5286515148268, -836.2556057298376, -702.89886243886, -674.3364089798628, -586.4189195271406, -957.5296487521726, -910.3520816700877, -893.4379223305275, -391.74242097115416, -1264.805319356825, -959.6474938561171, -798.4250593957078, -831.0110031245925], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.440084502410137, "mean_inference_ms": 0.41646573388180086, "mean_action_processing_ms": 0.0978121989651442, "mean_env_wait_ms": 2.7440217476506006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037398338317871094, "StateBufferConnector_ms": 0.002821683883666992, "ViewRequirementAgentConnector_ms": 0.06966209411621094}}, "episode_reward_max": -236.0166478699493, "episode_reward_min": -1264.805319356825, "episode_reward_mean": -743.0954036085856, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-957.3807448864148, -980.690926533723, -635.8164732742916, -1038.9959112623549, -798.3671265104039, -985.0507328121622, -909.7584013792837, -664.9043829806535, -550.3429869053524, -922.4678708029103, -817.0432076537971, -606.3966063351744, -715.8997122790017, -581.369814242515, -722.5601392597337, -682.6704451177101, -813.7480381669358, -800.0170557657304, -688.515361895256, -656.8257082151661, -706.0121841492595, -921.3153022098309, -618.2226863519622, -781.9132054701772, -757.9825663255237, -809.3578777297809, -518.1503008899604, -791.9352729033599, -1034.920910177727, -849.6202455813967, -878.3370146796489, -553.6211473432435, -502.1919158424673, -696.9409535721932, -586.0176853132299, -998.937666030531, -864.431869177693, -602.0025835532326, -796.7895092014937, -647.2561380776884, -236.0166478699493, -636.2536656975443, -661.0210729432954, -659.2375585738099, -890.6729698007413, -810.4122099881012, -420.23710906097955, -999.1882430694006, -685.1520441618709, -712.5506270730253, -807.3880170914313, -983.3103777503555, -802.3735094427007, -606.1927232251744, -601.4036421112345, -966.0492808920018, -520.5992178428874, -600.5375929979575, -641.8323874065542, -962.5451956320919, -594.3087991486598, -772.9163376438366, -719.9538553926772, -474.6575614205599, -699.51904075112, -638.947254086584, -784.4679001007582, -557.1179618048418, -839.2750058176025, -1075.706434745053, -621.5407325078561, -561.8652645992591, -684.4522993353054, -503.06258249728535, -834.3587733516559, -862.1900956627134, -809.9168935275501, -875.6670549559827, -963.6767032457285, -654.353946812361, -345.0189279420206, -756.4941077139541, -444.8640447618194, -844.0030774970837, -653.7971306917312, -698.15588955326, -806.1105141535306, -778.5286515148268, -836.2556057298376, -702.89886243886, -674.3364089798628, -586.4189195271406, -957.5296487521726, -910.3520816700877, -893.4379223305275, -391.74242097115416, -1264.805319356825, -959.6474938561171, -798.4250593957078, -831.0110031245925], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.440084502410137, "mean_inference_ms": 0.41646573388180086, "mean_action_processing_ms": 0.0978121989651442, "mean_env_wait_ms": 2.7440217476506006, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037398338317871094, "StateBufferConnector_ms": 0.002821683883666992, "ViewRequirementAgentConnector_ms": 0.06966209411621094}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 270720, "num_agent_steps_trained": 270720, "num_env_steps_sampled": 270720, "num_env_steps_trained": 270720, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 42.10402209698645, "num_env_steps_trained_throughput_per_sec": 42.10402209698645, "timesteps_total": 270720, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 270720, "timers": {"training_iteration_time_ms": 2922.636, "sample_time_ms": 2918.728, "load_time_ms": 0.225, "load_throughput": 533456.789, "learn_time_ms": 2.902, "learn_throughput": 41345.256, "synch_weights_time_ms": 0.734}, "counters": {"num_env_steps_sampled": 270720, "num_env_steps_trained": 270720, "num_agent_steps_sampled": 270720, "num_agent_steps_trained": 270720}, "done": false, "episodes_total": 2256, "training_iteration": 565, "trial_id": "53665_00000", "date": "2023-07-26_03-42-03", "timestamp": 1690332123, "time_this_iter_s": 11.403302192687988, "time_total_s": 6863.042967796326, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1241.717491865158, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 34.82941176470588, "ram_util_percent": 72.40588235294118}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": 267.4900207519531, "policy_loss": -80854.4140625, "vf_loss": 2932023.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 422.0, "diff_num_grad_updates_vs_sampler_policy": 421.0}}, "num_env_steps_sampled": 271200, "num_env_steps_trained": 271200, "num_agent_steps_sampled": 271200, "num_agent_steps_trained": 271200}, "sampler_results": {"episode_reward_max": -236.0166478699493, "episode_reward_min": -1264.805319356825, "episode_reward_mean": -730.0630128108179, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-798.3671265104039, -985.0507328121622, -909.7584013792837, -664.9043829806535, -550.3429869053524, -922.4678708029103, -817.0432076537971, -606.3966063351744, -715.8997122790017, -581.369814242515, -722.5601392597337, -682.6704451177101, -813.7480381669358, -800.0170557657304, -688.515361895256, -656.8257082151661, -706.0121841492595, -921.3153022098309, -618.2226863519622, -781.9132054701772, -757.9825663255237, -809.3578777297809, -518.1503008899604, -791.9352729033599, -1034.920910177727, -849.6202455813967, -878.3370146796489, -553.6211473432435, -502.1919158424673, -696.9409535721932, -586.0176853132299, -998.937666030531, -864.431869177693, -602.0025835532326, -796.7895092014937, -647.2561380776884, -236.0166478699493, -636.2536656975443, -661.0210729432954, -659.2375585738099, -890.6729698007413, -810.4122099881012, -420.23710906097955, -999.1882430694006, -685.1520441618709, -712.5506270730253, -807.3880170914313, -983.3103777503555, -802.3735094427007, -606.1927232251744, -601.4036421112345, -966.0492808920018, -520.5992178428874, -600.5375929979575, -641.8323874065542, -962.5451956320919, -594.3087991486598, -772.9163376438366, -719.9538553926772, -474.6575614205599, -699.51904075112, -638.947254086584, -784.4679001007582, -557.1179618048418, -839.2750058176025, -1075.706434745053, -621.5407325078561, -561.8652645992591, -684.4522993353054, -503.06258249728535, -834.3587733516559, -862.1900956627134, -809.9168935275501, -875.6670549559827, -963.6767032457285, -654.353946812361, -345.0189279420206, -756.4941077139541, -444.8640447618194, -844.0030774970837, -653.7971306917312, -698.15588955326, -806.1105141535306, -778.5286515148268, -836.2556057298376, -702.89886243886, -674.3364089798628, -586.4189195271406, -957.5296487521726, -910.3520816700877, -893.4379223305275, -391.74242097115416, -1264.805319356825, -959.6474938561171, -798.4250593957078, -831.0110031245925, -437.1133817849657, -763.0267766695106, -563.0577289151793, -546.4470888103436], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.438221933128535, "mean_inference_ms": 0.4163022850583137, "mean_action_processing_ms": 0.09778711298162994, "mean_env_wait_ms": 2.743031229460511, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003749370574951172, "StateBufferConnector_ms": 0.0028228759765625, "ViewRequirementAgentConnector_ms": 0.06962108612060547}}, "episode_reward_max": -236.0166478699493, "episode_reward_min": -1264.805319356825, "episode_reward_mean": -730.0630128108179, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-798.3671265104039, -985.0507328121622, -909.7584013792837, -664.9043829806535, -550.3429869053524, -922.4678708029103, -817.0432076537971, -606.3966063351744, -715.8997122790017, -581.369814242515, -722.5601392597337, -682.6704451177101, -813.7480381669358, -800.0170557657304, -688.515361895256, -656.8257082151661, -706.0121841492595, -921.3153022098309, -618.2226863519622, -781.9132054701772, -757.9825663255237, -809.3578777297809, -518.1503008899604, -791.9352729033599, -1034.920910177727, -849.6202455813967, -878.3370146796489, -553.6211473432435, -502.1919158424673, -696.9409535721932, -586.0176853132299, -998.937666030531, -864.431869177693, -602.0025835532326, -796.7895092014937, -647.2561380776884, -236.0166478699493, -636.2536656975443, -661.0210729432954, -659.2375585738099, -890.6729698007413, -810.4122099881012, -420.23710906097955, -999.1882430694006, -685.1520441618709, -712.5506270730253, -807.3880170914313, -983.3103777503555, -802.3735094427007, -606.1927232251744, -601.4036421112345, -966.0492808920018, -520.5992178428874, -600.5375929979575, -641.8323874065542, -962.5451956320919, -594.3087991486598, -772.9163376438366, -719.9538553926772, -474.6575614205599, -699.51904075112, -638.947254086584, -784.4679001007582, -557.1179618048418, -839.2750058176025, -1075.706434745053, -621.5407325078561, -561.8652645992591, -684.4522993353054, -503.06258249728535, -834.3587733516559, -862.1900956627134, -809.9168935275501, -875.6670549559827, -963.6767032457285, -654.353946812361, -345.0189279420206, -756.4941077139541, -444.8640447618194, -844.0030774970837, -653.7971306917312, -698.15588955326, -806.1105141535306, -778.5286515148268, -836.2556057298376, -702.89886243886, -674.3364089798628, -586.4189195271406, -957.5296487521726, -910.3520816700877, -893.4379223305275, -391.74242097115416, -1264.805319356825, -959.6474938561171, -798.4250593957078, -831.0110031245925, -437.1133817849657, -763.0267766695106, -563.0577289151793, -546.4470888103436], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.438221933128535, "mean_inference_ms": 0.4163022850583137, "mean_action_processing_ms": 0.09778711298162994, "mean_env_wait_ms": 2.743031229460511, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003749370574951172, "StateBufferConnector_ms": 0.0028228759765625, "ViewRequirementAgentConnector_ms": 0.06962108612060547}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 271200, "num_agent_steps_trained": 271200, "num_env_steps_sampled": 271200, "num_env_steps_trained": 271200, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.464716848013595, "num_env_steps_trained_throughput_per_sec": 41.464716848013595, "timesteps_total": 271200, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 271200, "timers": {"training_iteration_time_ms": 2886.662, "sample_time_ms": 2882.842, "load_time_ms": 0.218, "load_throughput": 550373.406, "learn_time_ms": 2.836, "learn_throughput": 42314.348, "synch_weights_time_ms": 0.724}, "counters": {"num_env_steps_sampled": 271200, "num_env_steps_trained": 271200, "num_agent_steps_sampled": 271200, "num_agent_steps_trained": 271200}, "done": false, "episodes_total": 2260, "training_iteration": 566, "trial_id": "53665_00000", "date": "2023-07-26_03-42-15", "timestamp": 1690332135, "time_this_iter_s": 11.579063177108765, "time_total_s": 6874.622030973434, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1253.2965550422668, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 41.96875, "ram_util_percent": 73.44375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": 267.48577880859375, "policy_loss": -108099.296875, "vf_loss": 5340663.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 426.0, "diff_num_grad_updates_vs_sampler_policy": 425.0}}, "num_env_steps_sampled": 271680, "num_env_steps_trained": 271680, "num_agent_steps_sampled": 271680, "num_agent_steps_trained": 271680}, "sampler_results": {"episode_reward_max": -236.0166478699493, "episode_reward_min": -1264.805319356825, "episode_reward_mean": -728.4402178907545, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-550.3429869053524, -922.4678708029103, -817.0432076537971, -606.3966063351744, -715.8997122790017, -581.369814242515, -722.5601392597337, -682.6704451177101, -813.7480381669358, -800.0170557657304, -688.515361895256, -656.8257082151661, -706.0121841492595, -921.3153022098309, -618.2226863519622, -781.9132054701772, -757.9825663255237, -809.3578777297809, -518.1503008899604, -791.9352729033599, -1034.920910177727, -849.6202455813967, -878.3370146796489, -553.6211473432435, -502.1919158424673, -696.9409535721932, -586.0176853132299, -998.937666030531, -864.431869177693, -602.0025835532326, -796.7895092014937, -647.2561380776884, -236.0166478699493, -636.2536656975443, -661.0210729432954, -659.2375585738099, -890.6729698007413, -810.4122099881012, -420.23710906097955, -999.1882430694006, -685.1520441618709, -712.5506270730253, -807.3880170914313, -983.3103777503555, -802.3735094427007, -606.1927232251744, -601.4036421112345, -966.0492808920018, -520.5992178428874, -600.5375929979575, -641.8323874065542, -962.5451956320919, -594.3087991486598, -772.9163376438366, -719.9538553926772, -474.6575614205599, -699.51904075112, -638.947254086584, -784.4679001007582, -557.1179618048418, -839.2750058176025, -1075.706434745053, -621.5407325078561, -561.8652645992591, -684.4522993353054, -503.06258249728535, -834.3587733516559, -862.1900956627134, -809.9168935275501, -875.6670549559827, -963.6767032457285, -654.353946812361, -345.0189279420206, -756.4941077139541, -444.8640447618194, -844.0030774970837, -653.7971306917312, -698.15588955326, -806.1105141535306, -778.5286515148268, -836.2556057298376, -702.89886243886, -674.3364089798628, -586.4189195271406, -957.5296487521726, -910.3520816700877, -893.4379223305275, -391.74242097115416, -1264.805319356825, -959.6474938561171, -798.4250593957078, -831.0110031245925, -437.1133817849657, -763.0267766695106, -563.0577289151793, -546.4470888103436, -1100.079136414408, -517.3967538146196, -684.6859154027624, -893.6393460443707], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.43658684533403, "mean_inference_ms": 0.41614280094473266, "mean_action_processing_ms": 0.09776240470043465, "mean_env_wait_ms": 2.7420608739061163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003770589828491211, "StateBufferConnector_ms": 0.002839803695678711, "ViewRequirementAgentConnector_ms": 0.06996941566467285}}, "episode_reward_max": -236.0166478699493, "episode_reward_min": -1264.805319356825, "episode_reward_mean": -728.4402178907545, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-550.3429869053524, -922.4678708029103, -817.0432076537971, -606.3966063351744, -715.8997122790017, -581.369814242515, -722.5601392597337, -682.6704451177101, -813.7480381669358, -800.0170557657304, -688.515361895256, -656.8257082151661, -706.0121841492595, -921.3153022098309, -618.2226863519622, -781.9132054701772, -757.9825663255237, -809.3578777297809, -518.1503008899604, -791.9352729033599, -1034.920910177727, -849.6202455813967, -878.3370146796489, -553.6211473432435, -502.1919158424673, -696.9409535721932, -586.0176853132299, -998.937666030531, -864.431869177693, -602.0025835532326, -796.7895092014937, -647.2561380776884, -236.0166478699493, -636.2536656975443, -661.0210729432954, -659.2375585738099, -890.6729698007413, -810.4122099881012, -420.23710906097955, -999.1882430694006, -685.1520441618709, -712.5506270730253, -807.3880170914313, -983.3103777503555, -802.3735094427007, -606.1927232251744, -601.4036421112345, -966.0492808920018, -520.5992178428874, -600.5375929979575, -641.8323874065542, -962.5451956320919, -594.3087991486598, -772.9163376438366, -719.9538553926772, -474.6575614205599, -699.51904075112, -638.947254086584, -784.4679001007582, -557.1179618048418, -839.2750058176025, -1075.706434745053, -621.5407325078561, -561.8652645992591, -684.4522993353054, -503.06258249728535, -834.3587733516559, -862.1900956627134, -809.9168935275501, -875.6670549559827, -963.6767032457285, -654.353946812361, -345.0189279420206, -756.4941077139541, -444.8640447618194, -844.0030774970837, -653.7971306917312, -698.15588955326, -806.1105141535306, -778.5286515148268, -836.2556057298376, -702.89886243886, -674.3364089798628, -586.4189195271406, -957.5296487521726, -910.3520816700877, -893.4379223305275, -391.74242097115416, -1264.805319356825, -959.6474938561171, -798.4250593957078, -831.0110031245925, -437.1133817849657, -763.0267766695106, -563.0577289151793, -546.4470888103436, -1100.079136414408, -517.3967538146196, -684.6859154027624, -893.6393460443707], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.43658684533403, "mean_inference_ms": 0.41614280094473266, "mean_action_processing_ms": 0.09776240470043465, "mean_env_wait_ms": 2.7420608739061163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003770589828491211, "StateBufferConnector_ms": 0.002839803695678711, "ViewRequirementAgentConnector_ms": 0.06996941566467285}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 271680, "num_agent_steps_trained": 271680, "num_env_steps_sampled": 271680, "num_env_steps_trained": 271680, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.09212985749221, "num_env_steps_trained_throughput_per_sec": 41.09212985749221, "timesteps_total": 271680, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 271680, "timers": {"training_iteration_time_ms": 2895.832, "sample_time_ms": 2892.079, "load_time_ms": 0.216, "load_throughput": 556581.312, "learn_time_ms": 2.778, "learn_throughput": 43190.897, "synch_weights_time_ms": 0.719}, "counters": {"num_env_steps_sampled": 271680, "num_env_steps_trained": 271680, "num_agent_steps_sampled": 271680, "num_agent_steps_trained": 271680}, "done": false, "episodes_total": 2264, "training_iteration": 567, "trial_id": "53665_00000", "date": "2023-07-26_03-42-26", "timestamp": 1690332146, "time_this_iter_s": 11.683833837509155, "time_total_s": 6886.305864810944, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1264.980388879776, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 44.82352941176471, "ram_util_percent": 73.36470588235295}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": 267.4488830566406, "policy_loss": -65685.9375, "vf_loss": 1973956.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 430.0, "diff_num_grad_updates_vs_sampler_policy": 429.0}}, "num_env_steps_sampled": 272160, "num_env_steps_trained": 272160, "num_agent_steps_sampled": 272160, "num_agent_steps_trained": 272160}, "sampler_results": {"episode_reward_max": -236.0166478699493, "episode_reward_min": -1264.805319356825, "episode_reward_mean": -724.2513221838499, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-715.8997122790017, -581.369814242515, -722.5601392597337, -682.6704451177101, -813.7480381669358, -800.0170557657304, -688.515361895256, -656.8257082151661, -706.0121841492595, -921.3153022098309, -618.2226863519622, -781.9132054701772, -757.9825663255237, -809.3578777297809, -518.1503008899604, -791.9352729033599, -1034.920910177727, -849.6202455813967, -878.3370146796489, -553.6211473432435, -502.1919158424673, -696.9409535721932, -586.0176853132299, -998.937666030531, -864.431869177693, -602.0025835532326, -796.7895092014937, -647.2561380776884, -236.0166478699493, -636.2536656975443, -661.0210729432954, -659.2375585738099, -890.6729698007413, -810.4122099881012, -420.23710906097955, -999.1882430694006, -685.1520441618709, -712.5506270730253, -807.3880170914313, -983.3103777503555, -802.3735094427007, -606.1927232251744, -601.4036421112345, -966.0492808920018, -520.5992178428874, -600.5375929979575, -641.8323874065542, -962.5451956320919, -594.3087991486598, -772.9163376438366, -719.9538553926772, -474.6575614205599, -699.51904075112, -638.947254086584, -784.4679001007582, -557.1179618048418, -839.2750058176025, -1075.706434745053, -621.5407325078561, -561.8652645992591, -684.4522993353054, -503.06258249728535, -834.3587733516559, -862.1900956627134, -809.9168935275501, -875.6670549559827, -963.6767032457285, -654.353946812361, -345.0189279420206, -756.4941077139541, -444.8640447618194, -844.0030774970837, -653.7971306917312, -698.15588955326, -806.1105141535306, -778.5286515148268, -836.2556057298376, -702.89886243886, -674.3364089798628, -586.4189195271406, -957.5296487521726, -910.3520816700877, -893.4379223305275, -391.74242097115416, -1264.805319356825, -959.6474938561171, -798.4250593957078, -831.0110031245925, -437.1133817849657, -763.0267766695106, -563.0577289151793, -546.4470888103436, -1100.079136414408, -517.3967538146196, -684.6859154027624, -893.6393460443707, -789.955151911287, -575.2301847628802, -642.4043922466298, -469.7713720859592], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.43528686740696, "mean_inference_ms": 0.41600329009839015, "mean_action_processing_ms": 0.09774069885234461, "mean_env_wait_ms": 2.7411340440648617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038025379180908203, "StateBufferConnector_ms": 0.002855539321899414, "ViewRequirementAgentConnector_ms": 0.07032012939453125}}, "episode_reward_max": -236.0166478699493, "episode_reward_min": -1264.805319356825, "episode_reward_mean": -724.2513221838499, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-715.8997122790017, -581.369814242515, -722.5601392597337, -682.6704451177101, -813.7480381669358, -800.0170557657304, -688.515361895256, -656.8257082151661, -706.0121841492595, -921.3153022098309, -618.2226863519622, -781.9132054701772, -757.9825663255237, -809.3578777297809, -518.1503008899604, -791.9352729033599, -1034.920910177727, -849.6202455813967, -878.3370146796489, -553.6211473432435, -502.1919158424673, -696.9409535721932, -586.0176853132299, -998.937666030531, -864.431869177693, -602.0025835532326, -796.7895092014937, -647.2561380776884, -236.0166478699493, -636.2536656975443, -661.0210729432954, -659.2375585738099, -890.6729698007413, -810.4122099881012, -420.23710906097955, -999.1882430694006, -685.1520441618709, -712.5506270730253, -807.3880170914313, -983.3103777503555, -802.3735094427007, -606.1927232251744, -601.4036421112345, -966.0492808920018, -520.5992178428874, -600.5375929979575, -641.8323874065542, -962.5451956320919, -594.3087991486598, -772.9163376438366, -719.9538553926772, -474.6575614205599, -699.51904075112, -638.947254086584, -784.4679001007582, -557.1179618048418, -839.2750058176025, -1075.706434745053, -621.5407325078561, -561.8652645992591, -684.4522993353054, -503.06258249728535, -834.3587733516559, -862.1900956627134, -809.9168935275501, -875.6670549559827, -963.6767032457285, -654.353946812361, -345.0189279420206, -756.4941077139541, -444.8640447618194, -844.0030774970837, -653.7971306917312, -698.15588955326, -806.1105141535306, -778.5286515148268, -836.2556057298376, -702.89886243886, -674.3364089798628, -586.4189195271406, -957.5296487521726, -910.3520816700877, -893.4379223305275, -391.74242097115416, -1264.805319356825, -959.6474938561171, -798.4250593957078, -831.0110031245925, -437.1133817849657, -763.0267766695106, -563.0577289151793, -546.4470888103436, -1100.079136414408, -517.3967538146196, -684.6859154027624, -893.6393460443707, -789.955151911287, -575.2301847628802, -642.4043922466298, -469.7713720859592], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.43528686740696, "mean_inference_ms": 0.41600329009839015, "mean_action_processing_ms": 0.09774069885234461, "mean_env_wait_ms": 2.7411340440648617, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038025379180908203, "StateBufferConnector_ms": 0.002855539321899414, "ViewRequirementAgentConnector_ms": 0.07032012939453125}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272160, "num_agent_steps_trained": 272160, "num_env_steps_sampled": 272160, "num_env_steps_trained": 272160, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.25603858197059, "num_env_steps_trained_throughput_per_sec": 39.25603858197059, "timesteps_total": 272160, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 272160, "timers": {"training_iteration_time_ms": 2971.635, "sample_time_ms": 2967.872, "load_time_ms": 0.217, "load_throughput": 553520.818, "learn_time_ms": 2.79, "learn_throughput": 43003.066, "synch_weights_time_ms": 0.714}, "counters": {"num_env_steps_sampled": 272160, "num_env_steps_trained": 272160, "num_agent_steps_sampled": 272160, "num_agent_steps_trained": 272160}, "done": false, "episodes_total": 2268, "training_iteration": 568, "trial_id": "53665_00000", "date": "2023-07-26_03-42-39", "timestamp": 1690332159, "time_this_iter_s": 12.230207920074463, "time_total_s": 6898.536072731018, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1277.2105967998505, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 52.50588235294117, "ram_util_percent": 73.52941176470588}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-08, "entropy_coeff": 0.05, "policy_entropy": 267.4655456542969, "policy_loss": -122435.03125, "vf_loss": 7093499.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 434.0, "diff_num_grad_updates_vs_sampler_policy": 433.0}}, "num_env_steps_sampled": 272640, "num_env_steps_trained": 272640, "num_agent_steps_sampled": 272640, "num_agent_steps_trained": 272640}, "sampler_results": {"episode_reward_max": -236.0166478699493, "episode_reward_min": -1264.805319356825, "episode_reward_mean": -731.3391497084621, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-813.7480381669358, -800.0170557657304, -688.515361895256, -656.8257082151661, -706.0121841492595, -921.3153022098309, -618.2226863519622, -781.9132054701772, -757.9825663255237, -809.3578777297809, -518.1503008899604, -791.9352729033599, -1034.920910177727, -849.6202455813967, -878.3370146796489, -553.6211473432435, -502.1919158424673, -696.9409535721932, -586.0176853132299, -998.937666030531, -864.431869177693, -602.0025835532326, -796.7895092014937, -647.2561380776884, -236.0166478699493, -636.2536656975443, -661.0210729432954, -659.2375585738099, -890.6729698007413, -810.4122099881012, -420.23710906097955, -999.1882430694006, -685.1520441618709, -712.5506270730253, -807.3880170914313, -983.3103777503555, -802.3735094427007, -606.1927232251744, -601.4036421112345, -966.0492808920018, -520.5992178428874, -600.5375929979575, -641.8323874065542, -962.5451956320919, -594.3087991486598, -772.9163376438366, -719.9538553926772, -474.6575614205599, -699.51904075112, -638.947254086584, -784.4679001007582, -557.1179618048418, -839.2750058176025, -1075.706434745053, -621.5407325078561, -561.8652645992591, -684.4522993353054, -503.06258249728535, -834.3587733516559, -862.1900956627134, -809.9168935275501, -875.6670549559827, -963.6767032457285, -654.353946812361, -345.0189279420206, -756.4941077139541, -444.8640447618194, -844.0030774970837, -653.7971306917312, -698.15588955326, -806.1105141535306, -778.5286515148268, -836.2556057298376, -702.89886243886, -674.3364089798628, -586.4189195271406, -957.5296487521726, -910.3520816700877, -893.4379223305275, -391.74242097115416, -1264.805319356825, -959.6474938561171, -798.4250593957078, -831.0110031245925, -437.1133817849657, -763.0267766695106, -563.0577289151793, -546.4470888103436, -1100.079136414408, -517.3967538146196, -684.6859154027624, -893.6393460443707, -789.955151911287, -575.2301847628802, -642.4043922466298, -469.7713720859592, -1103.6267050896254, -832.9088887202608, -560.0298103152801, -914.7174592350212], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.43377899350636, "mean_inference_ms": 0.415870061105512, "mean_action_processing_ms": 0.097719948979509, "mean_env_wait_ms": 2.740273211363034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003805875778198242, "StateBufferConnector_ms": 0.00286102294921875, "ViewRequirementAgentConnector_ms": 0.07041049003601074}}, "episode_reward_max": -236.0166478699493, "episode_reward_min": -1264.805319356825, "episode_reward_mean": -731.3391497084621, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-813.7480381669358, -800.0170557657304, -688.515361895256, -656.8257082151661, -706.0121841492595, -921.3153022098309, -618.2226863519622, -781.9132054701772, -757.9825663255237, -809.3578777297809, -518.1503008899604, -791.9352729033599, -1034.920910177727, -849.6202455813967, -878.3370146796489, -553.6211473432435, -502.1919158424673, -696.9409535721932, -586.0176853132299, -998.937666030531, -864.431869177693, -602.0025835532326, -796.7895092014937, -647.2561380776884, -236.0166478699493, -636.2536656975443, -661.0210729432954, -659.2375585738099, -890.6729698007413, -810.4122099881012, -420.23710906097955, -999.1882430694006, -685.1520441618709, -712.5506270730253, -807.3880170914313, -983.3103777503555, -802.3735094427007, -606.1927232251744, -601.4036421112345, -966.0492808920018, -520.5992178428874, -600.5375929979575, -641.8323874065542, -962.5451956320919, -594.3087991486598, -772.9163376438366, -719.9538553926772, -474.6575614205599, -699.51904075112, -638.947254086584, -784.4679001007582, -557.1179618048418, -839.2750058176025, -1075.706434745053, -621.5407325078561, -561.8652645992591, -684.4522993353054, -503.06258249728535, -834.3587733516559, -862.1900956627134, -809.9168935275501, -875.6670549559827, -963.6767032457285, -654.353946812361, -345.0189279420206, -756.4941077139541, -444.8640447618194, -844.0030774970837, -653.7971306917312, -698.15588955326, -806.1105141535306, -778.5286515148268, -836.2556057298376, -702.89886243886, -674.3364089798628, -586.4189195271406, -957.5296487521726, -910.3520816700877, -893.4379223305275, -391.74242097115416, -1264.805319356825, -959.6474938561171, -798.4250593957078, -831.0110031245925, -437.1133817849657, -763.0267766695106, -563.0577289151793, -546.4470888103436, -1100.079136414408, -517.3967538146196, -684.6859154027624, -893.6393460443707, -789.955151911287, -575.2301847628802, -642.4043922466298, -469.7713720859592, -1103.6267050896254, -832.9088887202608, -560.0298103152801, -914.7174592350212], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.43377899350636, "mean_inference_ms": 0.415870061105512, "mean_action_processing_ms": 0.097719948979509, "mean_env_wait_ms": 2.740273211363034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003805875778198242, "StateBufferConnector_ms": 0.00286102294921875, "ViewRequirementAgentConnector_ms": 0.07041049003601074}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272640, "num_agent_steps_trained": 272640, "num_env_steps_sampled": 272640, "num_env_steps_trained": 272640, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.99978360349905, "num_env_steps_trained_throughput_per_sec": 40.99978360349905, "timesteps_total": 272640, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 272640, "timers": {"training_iteration_time_ms": 2971.718, "sample_time_ms": 2967.942, "load_time_ms": 0.218, "load_throughput": 549352.194, "learn_time_ms": 2.8, "learn_throughput": 42856.235, "synch_weights_time_ms": 0.717}, "counters": {"num_env_steps_sampled": 272640, "num_env_steps_trained": 272640, "num_agent_steps_sampled": 272640, "num_agent_steps_trained": 272640}, "done": false, "episodes_total": 2272, "training_iteration": 569, "trial_id": "53665_00000", "date": "2023-07-26_03-42-50", "timestamp": 1690332170, "time_this_iter_s": 11.710231065750122, "time_total_s": 6910.246303796768, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1288.9208278656006, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 37.976470588235294, "ram_util_percent": 73.72941176470589}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 9.75e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4736633300781, "policy_loss": -119162.5234375, "vf_loss": 6448855.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 438.0, "diff_num_grad_updates_vs_sampler_policy": 437.0}}, "num_env_steps_sampled": 273120, "num_env_steps_trained": 273120, "num_agent_steps_sampled": 273120, "num_agent_steps_trained": 273120}, "sampler_results": {"episode_reward_max": -236.0166478699493, "episode_reward_min": -1264.805319356825, "episode_reward_mean": -730.9568764002787, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-706.0121841492595, -921.3153022098309, -618.2226863519622, -781.9132054701772, -757.9825663255237, -809.3578777297809, -518.1503008899604, -791.9352729033599, -1034.920910177727, -849.6202455813967, -878.3370146796489, -553.6211473432435, -502.1919158424673, -696.9409535721932, -586.0176853132299, -998.937666030531, -864.431869177693, -602.0025835532326, -796.7895092014937, -647.2561380776884, -236.0166478699493, -636.2536656975443, -661.0210729432954, -659.2375585738099, -890.6729698007413, -810.4122099881012, -420.23710906097955, -999.1882430694006, -685.1520441618709, -712.5506270730253, -807.3880170914313, -983.3103777503555, -802.3735094427007, -606.1927232251744, -601.4036421112345, -966.0492808920018, -520.5992178428874, -600.5375929979575, -641.8323874065542, -962.5451956320919, -594.3087991486598, -772.9163376438366, -719.9538553926772, -474.6575614205599, -699.51904075112, -638.947254086584, -784.4679001007582, -557.1179618048418, -839.2750058176025, -1075.706434745053, -621.5407325078561, -561.8652645992591, -684.4522993353054, -503.06258249728535, -834.3587733516559, -862.1900956627134, -809.9168935275501, -875.6670549559827, -963.6767032457285, -654.353946812361, -345.0189279420206, -756.4941077139541, -444.8640447618194, -844.0030774970837, -653.7971306917312, -698.15588955326, -806.1105141535306, -778.5286515148268, -836.2556057298376, -702.89886243886, -674.3364089798628, -586.4189195271406, -957.5296487521726, -910.3520816700877, -893.4379223305275, -391.74242097115416, -1264.805319356825, -959.6474938561171, -798.4250593957078, -831.0110031245925, -437.1133817849657, -763.0267766695106, -563.0577289151793, -546.4470888103436, -1100.079136414408, -517.3967538146196, -684.6859154027624, -893.6393460443707, -789.955151911287, -575.2301847628802, -642.4043922466298, -469.7713720859592, -1103.6267050896254, -832.9088887202608, -560.0298103152801, -914.7174592350212, -544.5638309839326, -815.022416278965, -611.9389605369848, -949.353625424887], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.432166533829147, "mean_inference_ms": 0.4157411472027782, "mean_action_processing_ms": 0.09769999294120828, "mean_env_wait_ms": 2.739400201296162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003799915313720703, "StateBufferConnector_ms": 0.002859354019165039, "ViewRequirementAgentConnector_ms": 0.07038760185241699}}, "episode_reward_max": -236.0166478699493, "episode_reward_min": -1264.805319356825, "episode_reward_mean": -730.9568764002787, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-706.0121841492595, -921.3153022098309, -618.2226863519622, -781.9132054701772, -757.9825663255237, -809.3578777297809, -518.1503008899604, -791.9352729033599, -1034.920910177727, -849.6202455813967, -878.3370146796489, -553.6211473432435, -502.1919158424673, -696.9409535721932, -586.0176853132299, -998.937666030531, -864.431869177693, -602.0025835532326, -796.7895092014937, -647.2561380776884, -236.0166478699493, -636.2536656975443, -661.0210729432954, -659.2375585738099, -890.6729698007413, -810.4122099881012, -420.23710906097955, -999.1882430694006, -685.1520441618709, -712.5506270730253, -807.3880170914313, -983.3103777503555, -802.3735094427007, -606.1927232251744, -601.4036421112345, -966.0492808920018, -520.5992178428874, -600.5375929979575, -641.8323874065542, -962.5451956320919, -594.3087991486598, -772.9163376438366, -719.9538553926772, -474.6575614205599, -699.51904075112, -638.947254086584, -784.4679001007582, -557.1179618048418, -839.2750058176025, -1075.706434745053, -621.5407325078561, -561.8652645992591, -684.4522993353054, -503.06258249728535, -834.3587733516559, -862.1900956627134, -809.9168935275501, -875.6670549559827, -963.6767032457285, -654.353946812361, -345.0189279420206, -756.4941077139541, -444.8640447618194, -844.0030774970837, -653.7971306917312, -698.15588955326, -806.1105141535306, -778.5286515148268, -836.2556057298376, -702.89886243886, -674.3364089798628, -586.4189195271406, -957.5296487521726, -910.3520816700877, -893.4379223305275, -391.74242097115416, -1264.805319356825, -959.6474938561171, -798.4250593957078, -831.0110031245925, -437.1133817849657, -763.0267766695106, -563.0577289151793, -546.4470888103436, -1100.079136414408, -517.3967538146196, -684.6859154027624, -893.6393460443707, -789.955151911287, -575.2301847628802, -642.4043922466298, -469.7713720859592, -1103.6267050896254, -832.9088887202608, -560.0298103152801, -914.7174592350212, -544.5638309839326, -815.022416278965, -611.9389605369848, -949.353625424887], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.432166533829147, "mean_inference_ms": 0.4157411472027782, "mean_action_processing_ms": 0.09769999294120828, "mean_env_wait_ms": 2.739400201296162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003799915313720703, "StateBufferConnector_ms": 0.002859354019165039, "ViewRequirementAgentConnector_ms": 0.07038760185241699}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 273120, "num_agent_steps_trained": 273120, "num_env_steps_sampled": 273120, "num_env_steps_trained": 273120, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 42.39285468372854, "num_env_steps_trained_throughput_per_sec": 42.39285468372854, "timesteps_total": 273120, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 273120, "timers": {"training_iteration_time_ms": 2912.246, "sample_time_ms": 2908.494, "load_time_ms": 0.218, "load_throughput": 550674.486, "learn_time_ms": 2.781, "learn_throughput": 43150.906, "synch_weights_time_ms": 0.711}, "counters": {"num_env_steps_sampled": 273120, "num_env_steps_trained": 273120, "num_agent_steps_sampled": 273120, "num_agent_steps_trained": 273120}, "done": false, "episodes_total": 2276, "training_iteration": 570, "trial_id": "53665_00000", "date": "2023-07-26_03-43-02", "timestamp": 1690332182, "time_this_iter_s": 11.325392961502075, "time_total_s": 6921.57169675827, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1300.2462208271027, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 34.40625, "ram_util_percent": 72.91250000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 8.75e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4928283691406, "policy_loss": -68878.8125, "vf_loss": 2305547.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 442.0, "diff_num_grad_updates_vs_sampler_policy": 441.0}}, "num_env_steps_sampled": 273600, "num_env_steps_trained": 273600, "num_agent_steps_sampled": 273600, "num_agent_steps_trained": 273600}, "sampler_results": {"episode_reward_max": -236.0166478699493, "episode_reward_min": -1264.805319356825, "episode_reward_mean": -732.1182984349937, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-757.9825663255237, -809.3578777297809, -518.1503008899604, -791.9352729033599, -1034.920910177727, -849.6202455813967, -878.3370146796489, -553.6211473432435, -502.1919158424673, -696.9409535721932, -586.0176853132299, -998.937666030531, -864.431869177693, -602.0025835532326, -796.7895092014937, -647.2561380776884, -236.0166478699493, -636.2536656975443, -661.0210729432954, -659.2375585738099, -890.6729698007413, -810.4122099881012, -420.23710906097955, -999.1882430694006, -685.1520441618709, -712.5506270730253, -807.3880170914313, -983.3103777503555, -802.3735094427007, -606.1927232251744, -601.4036421112345, -966.0492808920018, -520.5992178428874, -600.5375929979575, -641.8323874065542, -962.5451956320919, -594.3087991486598, -772.9163376438366, -719.9538553926772, -474.6575614205599, -699.51904075112, -638.947254086584, -784.4679001007582, -557.1179618048418, -839.2750058176025, -1075.706434745053, -621.5407325078561, -561.8652645992591, -684.4522993353054, -503.06258249728535, -834.3587733516559, -862.1900956627134, -809.9168935275501, -875.6670549559827, -963.6767032457285, -654.353946812361, -345.0189279420206, -756.4941077139541, -444.8640447618194, -844.0030774970837, -653.7971306917312, -698.15588955326, -806.1105141535306, -778.5286515148268, -836.2556057298376, -702.89886243886, -674.3364089798628, -586.4189195271406, -957.5296487521726, -910.3520816700877, -893.4379223305275, -391.74242097115416, -1264.805319356825, -959.6474938561171, -798.4250593957078, -831.0110031245925, -437.1133817849657, -763.0267766695106, -563.0577289151793, -546.4470888103436, -1100.079136414408, -517.3967538146196, -684.6859154027624, -893.6393460443707, -789.955151911287, -575.2301847628802, -642.4043922466298, -469.7713720859592, -1103.6267050896254, -832.9088887202608, -560.0298103152801, -914.7174592350212, -544.5638309839326, -815.022416278965, -611.9389605369848, -949.353625424887, -984.6556400009515, -696.0354490196511, -850.5998145896981, -612.314678042395], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.430713677477762, "mean_inference_ms": 0.4156163252878505, "mean_action_processing_ms": 0.09768079794581394, "mean_env_wait_ms": 2.738568926183997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038042068481445312, "StateBufferConnector_ms": 0.0028619766235351562, "ViewRequirementAgentConnector_ms": 0.07040286064147949}}, "episode_reward_max": -236.0166478699493, "episode_reward_min": -1264.805319356825, "episode_reward_mean": -732.1182984349937, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-757.9825663255237, -809.3578777297809, -518.1503008899604, -791.9352729033599, -1034.920910177727, -849.6202455813967, -878.3370146796489, -553.6211473432435, -502.1919158424673, -696.9409535721932, -586.0176853132299, -998.937666030531, -864.431869177693, -602.0025835532326, -796.7895092014937, -647.2561380776884, -236.0166478699493, -636.2536656975443, -661.0210729432954, -659.2375585738099, -890.6729698007413, -810.4122099881012, -420.23710906097955, -999.1882430694006, -685.1520441618709, -712.5506270730253, -807.3880170914313, -983.3103777503555, -802.3735094427007, -606.1927232251744, -601.4036421112345, -966.0492808920018, -520.5992178428874, -600.5375929979575, -641.8323874065542, -962.5451956320919, -594.3087991486598, -772.9163376438366, -719.9538553926772, -474.6575614205599, -699.51904075112, -638.947254086584, -784.4679001007582, -557.1179618048418, -839.2750058176025, -1075.706434745053, -621.5407325078561, -561.8652645992591, -684.4522993353054, -503.06258249728535, -834.3587733516559, -862.1900956627134, -809.9168935275501, -875.6670549559827, -963.6767032457285, -654.353946812361, -345.0189279420206, -756.4941077139541, -444.8640447618194, -844.0030774970837, -653.7971306917312, -698.15588955326, -806.1105141535306, -778.5286515148268, -836.2556057298376, -702.89886243886, -674.3364089798628, -586.4189195271406, -957.5296487521726, -910.3520816700877, -893.4379223305275, -391.74242097115416, -1264.805319356825, -959.6474938561171, -798.4250593957078, -831.0110031245925, -437.1133817849657, -763.0267766695106, -563.0577289151793, -546.4470888103436, -1100.079136414408, -517.3967538146196, -684.6859154027624, -893.6393460443707, -789.955151911287, -575.2301847628802, -642.4043922466298, -469.7713720859592, -1103.6267050896254, -832.9088887202608, -560.0298103152801, -914.7174592350212, -544.5638309839326, -815.022416278965, -611.9389605369848, -949.353625424887, -984.6556400009515, -696.0354490196511, -850.5998145896981, -612.314678042395], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.430713677477762, "mean_inference_ms": 0.4156163252878505, "mean_action_processing_ms": 0.09768079794581394, "mean_env_wait_ms": 2.738568926183997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038042068481445312, "StateBufferConnector_ms": 0.0028619766235351562, "ViewRequirementAgentConnector_ms": 0.07040286064147949}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 273600, "num_agent_steps_trained": 273600, "num_env_steps_sampled": 273600, "num_env_steps_trained": 273600, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.92084553234347, "num_env_steps_trained_throughput_per_sec": 41.92084553234347, "timesteps_total": 273600, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 273600, "timers": {"training_iteration_time_ms": 2864.803, "sample_time_ms": 2861.085, "load_time_ms": 0.216, "load_throughput": 556335.227, "learn_time_ms": 2.759, "learn_throughput": 43500.353, "synch_weights_time_ms": 0.702}, "counters": {"num_env_steps_sampled": 273600, "num_env_steps_trained": 273600, "num_agent_steps_sampled": 273600, "num_agent_steps_trained": 273600}, "done": false, "episodes_total": 2280, "training_iteration": 571, "trial_id": "53665_00000", "date": "2023-07-26_03-43-13", "timestamp": 1690332193, "time_this_iter_s": 11.453258991241455, "time_total_s": 6933.024955749512, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1311.6994798183441, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 36.89375, "ram_util_percent": 73.20625000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 7.75e-09, "entropy_coeff": 0.05, "policy_entropy": 267.47711181640625, "policy_loss": -89044.0078125, "vf_loss": 3700392.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 446.0, "diff_num_grad_updates_vs_sampler_policy": 445.0}}, "num_env_steps_sampled": 274080, "num_env_steps_trained": 274080, "num_agent_steps_sampled": 274080, "num_agent_steps_trained": 274080}, "sampler_results": {"episode_reward_max": -236.0166478699493, "episode_reward_min": -1264.805319356825, "episode_reward_mean": -735.1095377965587, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1034.920910177727, -849.6202455813967, -878.3370146796489, -553.6211473432435, -502.1919158424673, -696.9409535721932, -586.0176853132299, -998.937666030531, -864.431869177693, -602.0025835532326, -796.7895092014937, -647.2561380776884, -236.0166478699493, -636.2536656975443, -661.0210729432954, -659.2375585738099, -890.6729698007413, -810.4122099881012, -420.23710906097955, -999.1882430694006, -685.1520441618709, -712.5506270730253, -807.3880170914313, -983.3103777503555, -802.3735094427007, -606.1927232251744, -601.4036421112345, -966.0492808920018, -520.5992178428874, -600.5375929979575, -641.8323874065542, -962.5451956320919, -594.3087991486598, -772.9163376438366, -719.9538553926772, -474.6575614205599, -699.51904075112, -638.947254086584, -784.4679001007582, -557.1179618048418, -839.2750058176025, -1075.706434745053, -621.5407325078561, -561.8652645992591, -684.4522993353054, -503.06258249728535, -834.3587733516559, -862.1900956627134, -809.9168935275501, -875.6670549559827, -963.6767032457285, -654.353946812361, -345.0189279420206, -756.4941077139541, -444.8640447618194, -844.0030774970837, -653.7971306917312, -698.15588955326, -806.1105141535306, -778.5286515148268, -836.2556057298376, -702.89886243886, -674.3364089798628, -586.4189195271406, -957.5296487521726, -910.3520816700877, -893.4379223305275, -391.74242097115416, -1264.805319356825, -959.6474938561171, -798.4250593957078, -831.0110031245925, -437.1133817849657, -763.0267766695106, -563.0577289151793, -546.4470888103436, -1100.079136414408, -517.3967538146196, -684.6859154027624, -893.6393460443707, -789.955151911287, -575.2301847628802, -642.4043922466298, -469.7713720859592, -1103.6267050896254, -832.9088887202608, -560.0298103152801, -914.7174592350212, -544.5638309839326, -815.022416278965, -611.9389605369848, -949.353625424887, -984.6556400009515, -696.0354490196511, -850.5998145896981, -612.314678042395, -761.5693908480316, -762.0242108081395, -913.8990176793252, -739.0573346696534], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.429532300738177, "mean_inference_ms": 0.4154962051786433, "mean_action_processing_ms": 0.09766243913863143, "mean_env_wait_ms": 2.737788247546339, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038030147552490234, "StateBufferConnector_ms": 0.0028634071350097656, "ViewRequirementAgentConnector_ms": 0.07039093971252441}}, "episode_reward_max": -236.0166478699493, "episode_reward_min": -1264.805319356825, "episode_reward_mean": -735.1095377965587, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1034.920910177727, -849.6202455813967, -878.3370146796489, -553.6211473432435, -502.1919158424673, -696.9409535721932, -586.0176853132299, -998.937666030531, -864.431869177693, -602.0025835532326, -796.7895092014937, -647.2561380776884, -236.0166478699493, -636.2536656975443, -661.0210729432954, -659.2375585738099, -890.6729698007413, -810.4122099881012, -420.23710906097955, -999.1882430694006, -685.1520441618709, -712.5506270730253, -807.3880170914313, -983.3103777503555, -802.3735094427007, -606.1927232251744, -601.4036421112345, -966.0492808920018, -520.5992178428874, -600.5375929979575, -641.8323874065542, -962.5451956320919, -594.3087991486598, -772.9163376438366, -719.9538553926772, -474.6575614205599, -699.51904075112, -638.947254086584, -784.4679001007582, -557.1179618048418, -839.2750058176025, -1075.706434745053, -621.5407325078561, -561.8652645992591, -684.4522993353054, -503.06258249728535, -834.3587733516559, -862.1900956627134, -809.9168935275501, -875.6670549559827, -963.6767032457285, -654.353946812361, -345.0189279420206, -756.4941077139541, -444.8640447618194, -844.0030774970837, -653.7971306917312, -698.15588955326, -806.1105141535306, -778.5286515148268, -836.2556057298376, -702.89886243886, -674.3364089798628, -586.4189195271406, -957.5296487521726, -910.3520816700877, -893.4379223305275, -391.74242097115416, -1264.805319356825, -959.6474938561171, -798.4250593957078, -831.0110031245925, -437.1133817849657, -763.0267766695106, -563.0577289151793, -546.4470888103436, -1100.079136414408, -517.3967538146196, -684.6859154027624, -893.6393460443707, -789.955151911287, -575.2301847628802, -642.4043922466298, -469.7713720859592, -1103.6267050896254, -832.9088887202608, -560.0298103152801, -914.7174592350212, -544.5638309839326, -815.022416278965, -611.9389605369848, -949.353625424887, -984.6556400009515, -696.0354490196511, -850.5998145896981, -612.314678042395, -761.5693908480316, -762.0242108081395, -913.8990176793252, -739.0573346696534], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.429532300738177, "mean_inference_ms": 0.4154962051786433, "mean_action_processing_ms": 0.09766243913863143, "mean_env_wait_ms": 2.737788247546339, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038030147552490234, "StateBufferConnector_ms": 0.0028634071350097656, "ViewRequirementAgentConnector_ms": 0.07039093971252441}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 274080, "num_agent_steps_trained": 274080, "num_env_steps_sampled": 274080, "num_env_steps_trained": 274080, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.87499843160628, "num_env_steps_trained_throughput_per_sec": 40.87499843160628, "timesteps_total": 274080, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 274080, "timers": {"training_iteration_time_ms": 2888.916, "sample_time_ms": 2885.164, "load_time_ms": 0.218, "load_throughput": 550674.486, "learn_time_ms": 2.786, "learn_throughput": 43071.882, "synch_weights_time_ms": 0.708}, "counters": {"num_env_steps_sampled": 274080, "num_env_steps_trained": 274080, "num_agent_steps_sampled": 274080, "num_agent_steps_trained": 274080}, "done": false, "episodes_total": 2284, "training_iteration": 572, "trial_id": "53665_00000", "date": "2023-07-26_03-43-25", "timestamp": 1690332205, "time_this_iter_s": 11.745918989181519, "time_total_s": 6944.770874738693, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1323.4453988075256, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 39.370588235294115, "ram_util_percent": 73.89999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 6.75e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4764404296875, "policy_loss": -78356.71875, "vf_loss": 2592459.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 450.0, "diff_num_grad_updates_vs_sampler_policy": 449.0}}, "num_env_steps_sampled": 274560, "num_env_steps_trained": 274560, "num_agent_steps_sampled": 274560, "num_agent_steps_trained": 274560}, "sampler_results": {"episode_reward_max": -236.0166478699493, "episode_reward_min": -1264.805319356825, "episode_reward_mean": -733.3678192357193, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-502.1919158424673, -696.9409535721932, -586.0176853132299, -998.937666030531, -864.431869177693, -602.0025835532326, -796.7895092014937, -647.2561380776884, -236.0166478699493, -636.2536656975443, -661.0210729432954, -659.2375585738099, -890.6729698007413, -810.4122099881012, -420.23710906097955, -999.1882430694006, -685.1520441618709, -712.5506270730253, -807.3880170914313, -983.3103777503555, -802.3735094427007, -606.1927232251744, -601.4036421112345, -966.0492808920018, -520.5992178428874, -600.5375929979575, -641.8323874065542, -962.5451956320919, -594.3087991486598, -772.9163376438366, -719.9538553926772, -474.6575614205599, -699.51904075112, -638.947254086584, -784.4679001007582, -557.1179618048418, -839.2750058176025, -1075.706434745053, -621.5407325078561, -561.8652645992591, -684.4522993353054, -503.06258249728535, -834.3587733516559, -862.1900956627134, -809.9168935275501, -875.6670549559827, -963.6767032457285, -654.353946812361, -345.0189279420206, -756.4941077139541, -444.8640447618194, -844.0030774970837, -653.7971306917312, -698.15588955326, -806.1105141535306, -778.5286515148268, -836.2556057298376, -702.89886243886, -674.3364089798628, -586.4189195271406, -957.5296487521726, -910.3520816700877, -893.4379223305275, -391.74242097115416, -1264.805319356825, -959.6474938561171, -798.4250593957078, -831.0110031245925, -437.1133817849657, -763.0267766695106, -563.0577289151793, -546.4470888103436, -1100.079136414408, -517.3967538146196, -684.6859154027624, -893.6393460443707, -789.955151911287, -575.2301847628802, -642.4043922466298, -469.7713720859592, -1103.6267050896254, -832.9088887202608, -560.0298103152801, -914.7174592350212, -544.5638309839326, -815.022416278965, -611.9389605369848, -949.353625424887, -984.6556400009515, -696.0354490196511, -850.5998145896981, -612.314678042395, -761.5693908480316, -762.0242108081395, -913.8990176793252, -739.0573346696534, -973.6543863618886, -853.885512123146, -685.9431800648692, -628.8443831481497], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.42809067058196, "mean_inference_ms": 0.4153573504467114, "mean_action_processing_ms": 0.09764127919231218, "mean_env_wait_ms": 2.736986955195848, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003809690475463867, "StateBufferConnector_ms": 0.0028662681579589844, "ViewRequirementAgentConnector_ms": 0.0704808235168457}}, "episode_reward_max": -236.0166478699493, "episode_reward_min": -1264.805319356825, "episode_reward_mean": -733.3678192357193, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-502.1919158424673, -696.9409535721932, -586.0176853132299, -998.937666030531, -864.431869177693, -602.0025835532326, -796.7895092014937, -647.2561380776884, -236.0166478699493, -636.2536656975443, -661.0210729432954, -659.2375585738099, -890.6729698007413, -810.4122099881012, -420.23710906097955, -999.1882430694006, -685.1520441618709, -712.5506270730253, -807.3880170914313, -983.3103777503555, -802.3735094427007, -606.1927232251744, -601.4036421112345, -966.0492808920018, -520.5992178428874, -600.5375929979575, -641.8323874065542, -962.5451956320919, -594.3087991486598, -772.9163376438366, -719.9538553926772, -474.6575614205599, -699.51904075112, -638.947254086584, -784.4679001007582, -557.1179618048418, -839.2750058176025, -1075.706434745053, -621.5407325078561, -561.8652645992591, -684.4522993353054, -503.06258249728535, -834.3587733516559, -862.1900956627134, -809.9168935275501, -875.6670549559827, -963.6767032457285, -654.353946812361, -345.0189279420206, -756.4941077139541, -444.8640447618194, -844.0030774970837, -653.7971306917312, -698.15588955326, -806.1105141535306, -778.5286515148268, -836.2556057298376, -702.89886243886, -674.3364089798628, -586.4189195271406, -957.5296487521726, -910.3520816700877, -893.4379223305275, -391.74242097115416, -1264.805319356825, -959.6474938561171, -798.4250593957078, -831.0110031245925, -437.1133817849657, -763.0267766695106, -563.0577289151793, -546.4470888103436, -1100.079136414408, -517.3967538146196, -684.6859154027624, -893.6393460443707, -789.955151911287, -575.2301847628802, -642.4043922466298, -469.7713720859592, -1103.6267050896254, -832.9088887202608, -560.0298103152801, -914.7174592350212, -544.5638309839326, -815.022416278965, -611.9389605369848, -949.353625424887, -984.6556400009515, -696.0354490196511, -850.5998145896981, -612.314678042395, -761.5693908480316, -762.0242108081395, -913.8990176793252, -739.0573346696534, -973.6543863618886, -853.885512123146, -685.9431800648692, -628.8443831481497], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.42809067058196, "mean_inference_ms": 0.4153573504467114, "mean_action_processing_ms": 0.09764127919231218, "mean_env_wait_ms": 2.736986955195848, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003809690475463867, "StateBufferConnector_ms": 0.0028662681579589844, "ViewRequirementAgentConnector_ms": 0.0704808235168457}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 274560, "num_agent_steps_trained": 274560, "num_env_steps_sampled": 274560, "num_env_steps_trained": 274560, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.2364865432026, "num_env_steps_trained_throughput_per_sec": 40.2364865432026, "timesteps_total": 274560, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 274560, "timers": {"training_iteration_time_ms": 2942.957, "sample_time_ms": 2938.935, "load_time_ms": 0.229, "load_throughput": 524834.703, "learn_time_ms": 3.0, "learn_throughput": 39999.084, "synch_weights_time_ms": 0.748}, "counters": {"num_env_steps_sampled": 274560, "num_env_steps_trained": 274560, "num_agent_steps_sampled": 274560, "num_agent_steps_trained": 274560}, "done": false, "episodes_total": 2288, "training_iteration": 573, "trial_id": "53665_00000", "date": "2023-07-26_03-43-37", "timestamp": 1690332217, "time_this_iter_s": 11.932644128799438, "time_total_s": 6956.703518867493, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1335.378042936325, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 39.41764705882354, "ram_util_percent": 74.72352941176469}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5.75e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4811706542969, "policy_loss": -76791.296875, "vf_loss": 2588544.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 454.0, "diff_num_grad_updates_vs_sampler_policy": 453.0}}, "num_env_steps_sampled": 275040, "num_env_steps_trained": 275040, "num_agent_steps_sampled": 275040, "num_agent_steps_trained": 275040}, "sampler_results": {"episode_reward_max": -236.0166478699493, "episode_reward_min": -1264.805319356825, "episode_reward_mean": -736.8388978189247, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-864.431869177693, -602.0025835532326, -796.7895092014937, -647.2561380776884, -236.0166478699493, -636.2536656975443, -661.0210729432954, -659.2375585738099, -890.6729698007413, -810.4122099881012, -420.23710906097955, -999.1882430694006, -685.1520441618709, -712.5506270730253, -807.3880170914313, -983.3103777503555, -802.3735094427007, -606.1927232251744, -601.4036421112345, -966.0492808920018, -520.5992178428874, -600.5375929979575, -641.8323874065542, -962.5451956320919, -594.3087991486598, -772.9163376438366, -719.9538553926772, -474.6575614205599, -699.51904075112, -638.947254086584, -784.4679001007582, -557.1179618048418, -839.2750058176025, -1075.706434745053, -621.5407325078561, -561.8652645992591, -684.4522993353054, -503.06258249728535, -834.3587733516559, -862.1900956627134, -809.9168935275501, -875.6670549559827, -963.6767032457285, -654.353946812361, -345.0189279420206, -756.4941077139541, -444.8640447618194, -844.0030774970837, -653.7971306917312, -698.15588955326, -806.1105141535306, -778.5286515148268, -836.2556057298376, -702.89886243886, -674.3364089798628, -586.4189195271406, -957.5296487521726, -910.3520816700877, -893.4379223305275, -391.74242097115416, -1264.805319356825, -959.6474938561171, -798.4250593957078, -831.0110031245925, -437.1133817849657, -763.0267766695106, -563.0577289151793, -546.4470888103436, -1100.079136414408, -517.3967538146196, -684.6859154027624, -893.6393460443707, -789.955151911287, -575.2301847628802, -642.4043922466298, -469.7713720859592, -1103.6267050896254, -832.9088887202608, -560.0298103152801, -914.7174592350212, -544.5638309839326, -815.022416278965, -611.9389605369848, -949.353625424887, -984.6556400009515, -696.0354490196511, -850.5998145896981, -612.314678042395, -761.5693908480316, -762.0242108081395, -913.8990176793252, -739.0573346696534, -973.6543863618886, -853.885512123146, -685.9431800648692, -628.8443831481497, -793.2244754853593, -938.036210409312, -731.0213689932796, -668.91402419103], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.42557501653586, "mean_inference_ms": 0.4151907756262156, "mean_action_processing_ms": 0.09761511429361266, "mean_env_wait_ms": 2.7361149815571535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037724971771240234, "StateBufferConnector_ms": 0.002844095230102539, "ViewRequirementAgentConnector_ms": 0.06989765167236328}}, "episode_reward_max": -236.0166478699493, "episode_reward_min": -1264.805319356825, "episode_reward_mean": -736.8388978189247, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-864.431869177693, -602.0025835532326, -796.7895092014937, -647.2561380776884, -236.0166478699493, -636.2536656975443, -661.0210729432954, -659.2375585738099, -890.6729698007413, -810.4122099881012, -420.23710906097955, -999.1882430694006, -685.1520441618709, -712.5506270730253, -807.3880170914313, -983.3103777503555, -802.3735094427007, -606.1927232251744, -601.4036421112345, -966.0492808920018, -520.5992178428874, -600.5375929979575, -641.8323874065542, -962.5451956320919, -594.3087991486598, -772.9163376438366, -719.9538553926772, -474.6575614205599, -699.51904075112, -638.947254086584, -784.4679001007582, -557.1179618048418, -839.2750058176025, -1075.706434745053, -621.5407325078561, -561.8652645992591, -684.4522993353054, -503.06258249728535, -834.3587733516559, -862.1900956627134, -809.9168935275501, -875.6670549559827, -963.6767032457285, -654.353946812361, -345.0189279420206, -756.4941077139541, -444.8640447618194, -844.0030774970837, -653.7971306917312, -698.15588955326, -806.1105141535306, -778.5286515148268, -836.2556057298376, -702.89886243886, -674.3364089798628, -586.4189195271406, -957.5296487521726, -910.3520816700877, -893.4379223305275, -391.74242097115416, -1264.805319356825, -959.6474938561171, -798.4250593957078, -831.0110031245925, -437.1133817849657, -763.0267766695106, -563.0577289151793, -546.4470888103436, -1100.079136414408, -517.3967538146196, -684.6859154027624, -893.6393460443707, -789.955151911287, -575.2301847628802, -642.4043922466298, -469.7713720859592, -1103.6267050896254, -832.9088887202608, -560.0298103152801, -914.7174592350212, -544.5638309839326, -815.022416278965, -611.9389605369848, -949.353625424887, -984.6556400009515, -696.0354490196511, -850.5998145896981, -612.314678042395, -761.5693908480316, -762.0242108081395, -913.8990176793252, -739.0573346696534, -973.6543863618886, -853.885512123146, -685.9431800648692, -628.8443831481497, -793.2244754853593, -938.036210409312, -731.0213689932796, -668.91402419103], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.42557501653586, "mean_inference_ms": 0.4151907756262156, "mean_action_processing_ms": 0.09761511429361266, "mean_env_wait_ms": 2.7361149815571535, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037724971771240234, "StateBufferConnector_ms": 0.002844095230102539, "ViewRequirementAgentConnector_ms": 0.06989765167236328}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 275040, "num_agent_steps_trained": 275040, "num_env_steps_sampled": 275040, "num_env_steps_trained": 275040, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.19194689841977, "num_env_steps_trained_throughput_per_sec": 41.19194689841977, "timesteps_total": 275040, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 275040, "timers": {"training_iteration_time_ms": 2939.793, "sample_time_ms": 2935.654, "load_time_ms": 0.231, "load_throughput": 519204.126, "learn_time_ms": 3.034, "learn_throughput": 39557.399, "synch_weights_time_ms": 0.827}, "counters": {"num_env_steps_sampled": 275040, "num_env_steps_trained": 275040, "num_agent_steps_sampled": 275040, "num_agent_steps_trained": 275040}, "done": false, "episodes_total": 2292, "training_iteration": 574, "trial_id": "53665_00000", "date": "2023-07-26_03-43-48", "timestamp": 1690332228, "time_this_iter_s": 11.655600786209106, "time_total_s": 6968.359119653702, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1347.0336437225342, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 36.10588235294118, "ram_util_percent": 74.48823529411766}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-09, "entropy_coeff": 0.05, "policy_entropy": 267.46246337890625, "policy_loss": -115415.9609375, "vf_loss": 5742686.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 458.0, "diff_num_grad_updates_vs_sampler_policy": 457.0}}, "num_env_steps_sampled": 275520, "num_env_steps_trained": 275520, "num_agent_steps_sampled": 275520, "num_agent_steps_trained": 275520}, "sampler_results": {"episode_reward_max": -236.0166478699493, "episode_reward_min": -1264.805319356825, "episode_reward_mean": -739.8731977373586, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-236.0166478699493, -636.2536656975443, -661.0210729432954, -659.2375585738099, -890.6729698007413, -810.4122099881012, -420.23710906097955, -999.1882430694006, -685.1520441618709, -712.5506270730253, -807.3880170914313, -983.3103777503555, -802.3735094427007, -606.1927232251744, -601.4036421112345, -966.0492808920018, -520.5992178428874, -600.5375929979575, -641.8323874065542, -962.5451956320919, -594.3087991486598, -772.9163376438366, -719.9538553926772, -474.6575614205599, -699.51904075112, -638.947254086584, -784.4679001007582, -557.1179618048418, -839.2750058176025, -1075.706434745053, -621.5407325078561, -561.8652645992591, -684.4522993353054, -503.06258249728535, -834.3587733516559, -862.1900956627134, -809.9168935275501, -875.6670549559827, -963.6767032457285, -654.353946812361, -345.0189279420206, -756.4941077139541, -444.8640447618194, -844.0030774970837, -653.7971306917312, -698.15588955326, -806.1105141535306, -778.5286515148268, -836.2556057298376, -702.89886243886, -674.3364089798628, -586.4189195271406, -957.5296487521726, -910.3520816700877, -893.4379223305275, -391.74242097115416, -1264.805319356825, -959.6474938561171, -798.4250593957078, -831.0110031245925, -437.1133817849657, -763.0267766695106, -563.0577289151793, -546.4470888103436, -1100.079136414408, -517.3967538146196, -684.6859154027624, -893.6393460443707, -789.955151911287, -575.2301847628802, -642.4043922466298, -469.7713720859592, -1103.6267050896254, -832.9088887202608, -560.0298103152801, -914.7174592350212, -544.5638309839326, -815.022416278965, -611.9389605369848, -949.353625424887, -984.6556400009515, -696.0354490196511, -850.5998145896981, -612.314678042395, -761.5693908480316, -762.0242108081395, -913.8990176793252, -739.0573346696534, -973.6543863618886, -853.885512123146, -685.9431800648692, -628.8443831481497, -793.2244754853593, -938.036210409312, -731.0213689932796, -668.91402419103, -775.9799250886979, -918.1219868557534, -779.0636381600455, -740.7445417489905], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.422931560930785, "mean_inference_ms": 0.4150192661366441, "mean_action_processing_ms": 0.09758808312891613, "mean_env_wait_ms": 2.735265391458835, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003759145736694336, "StateBufferConnector_ms": 0.002833843231201172, "ViewRequirementAgentConnector_ms": 0.06960630416870117}}, "episode_reward_max": -236.0166478699493, "episode_reward_min": -1264.805319356825, "episode_reward_mean": -739.8731977373586, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-236.0166478699493, -636.2536656975443, -661.0210729432954, -659.2375585738099, -890.6729698007413, -810.4122099881012, -420.23710906097955, -999.1882430694006, -685.1520441618709, -712.5506270730253, -807.3880170914313, -983.3103777503555, -802.3735094427007, -606.1927232251744, -601.4036421112345, -966.0492808920018, -520.5992178428874, -600.5375929979575, -641.8323874065542, -962.5451956320919, -594.3087991486598, -772.9163376438366, -719.9538553926772, -474.6575614205599, -699.51904075112, -638.947254086584, -784.4679001007582, -557.1179618048418, -839.2750058176025, -1075.706434745053, -621.5407325078561, -561.8652645992591, -684.4522993353054, -503.06258249728535, -834.3587733516559, -862.1900956627134, -809.9168935275501, -875.6670549559827, -963.6767032457285, -654.353946812361, -345.0189279420206, -756.4941077139541, -444.8640447618194, -844.0030774970837, -653.7971306917312, -698.15588955326, -806.1105141535306, -778.5286515148268, -836.2556057298376, -702.89886243886, -674.3364089798628, -586.4189195271406, -957.5296487521726, -910.3520816700877, -893.4379223305275, -391.74242097115416, -1264.805319356825, -959.6474938561171, -798.4250593957078, -831.0110031245925, -437.1133817849657, -763.0267766695106, -563.0577289151793, -546.4470888103436, -1100.079136414408, -517.3967538146196, -684.6859154027624, -893.6393460443707, -789.955151911287, -575.2301847628802, -642.4043922466298, -469.7713720859592, -1103.6267050896254, -832.9088887202608, -560.0298103152801, -914.7174592350212, -544.5638309839326, -815.022416278965, -611.9389605369848, -949.353625424887, -984.6556400009515, -696.0354490196511, -850.5998145896981, -612.314678042395, -761.5693908480316, -762.0242108081395, -913.8990176793252, -739.0573346696534, -973.6543863618886, -853.885512123146, -685.9431800648692, -628.8443831481497, -793.2244754853593, -938.036210409312, -731.0213689932796, -668.91402419103, -775.9799250886979, -918.1219868557534, -779.0636381600455, -740.7445417489905], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.422931560930785, "mean_inference_ms": 0.4150192661366441, "mean_action_processing_ms": 0.09758808312891613, "mean_env_wait_ms": 2.735265391458835, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003759145736694336, "StateBufferConnector_ms": 0.002833843231201172, "ViewRequirementAgentConnector_ms": 0.06960630416870117}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 275520, "num_agent_steps_trained": 275520, "num_env_steps_sampled": 275520, "num_env_steps_trained": 275520, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.46534369117379, "num_env_steps_trained_throughput_per_sec": 41.46534369117379, "timesteps_total": 275520, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 275520, "timers": {"training_iteration_time_ms": 2909.546, "sample_time_ms": 2905.452, "load_time_ms": 0.227, "load_throughput": 528139.014, "learn_time_ms": 3.006, "learn_throughput": 39917.24, "synch_weights_time_ms": 0.813}, "counters": {"num_env_steps_sampled": 275520, "num_env_steps_trained": 275520, "num_agent_steps_sampled": 275520, "num_agent_steps_trained": 275520}, "done": false, "episodes_total": 2296, "training_iteration": 575, "trial_id": "53665_00000", "date": "2023-07-26_03-44-00", "timestamp": 1690332240, "time_this_iter_s": 11.578701734542847, "time_total_s": 6979.937821388245, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1358.612345457077, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 33.93125, "ram_util_percent": 72.08749999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-09, "entropy_coeff": 0.05, "policy_entropy": 267.5002136230469, "policy_loss": -134528.875, "vf_loss": 8003662.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 462.0, "diff_num_grad_updates_vs_sampler_policy": 461.0}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "sampler_results": {"episode_reward_max": -345.0189279420206, "episode_reward_min": -1264.805319356825, "episode_reward_mean": -752.8600716935943, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-890.6729698007413, -810.4122099881012, -420.23710906097955, -999.1882430694006, -685.1520441618709, -712.5506270730253, -807.3880170914313, -983.3103777503555, -802.3735094427007, -606.1927232251744, -601.4036421112345, -966.0492808920018, -520.5992178428874, -600.5375929979575, -641.8323874065542, -962.5451956320919, -594.3087991486598, -772.9163376438366, -719.9538553926772, -474.6575614205599, -699.51904075112, -638.947254086584, -784.4679001007582, -557.1179618048418, -839.2750058176025, -1075.706434745053, -621.5407325078561, -561.8652645992591, -684.4522993353054, -503.06258249728535, -834.3587733516559, -862.1900956627134, -809.9168935275501, -875.6670549559827, -963.6767032457285, -654.353946812361, -345.0189279420206, -756.4941077139541, -444.8640447618194, -844.0030774970837, -653.7971306917312, -698.15588955326, -806.1105141535306, -778.5286515148268, -836.2556057298376, -702.89886243886, -674.3364089798628, -586.4189195271406, -957.5296487521726, -910.3520816700877, -893.4379223305275, -391.74242097115416, -1264.805319356825, -959.6474938561171, -798.4250593957078, -831.0110031245925, -437.1133817849657, -763.0267766695106, -563.0577289151793, -546.4470888103436, -1100.079136414408, -517.3967538146196, -684.6859154027624, -893.6393460443707, -789.955151911287, -575.2301847628802, -642.4043922466298, -469.7713720859592, -1103.6267050896254, -832.9088887202608, -560.0298103152801, -914.7174592350212, -544.5638309839326, -815.022416278965, -611.9389605369848, -949.353625424887, -984.6556400009515, -696.0354490196511, -850.5998145896981, -612.314678042395, -761.5693908480316, -762.0242108081395, -913.8990176793252, -739.0573346696534, -973.6543863618886, -853.885512123146, -685.9431800648692, -628.8443831481497, -793.2244754853593, -938.036210409312, -731.0213689932796, -668.91402419103, -775.9799250886979, -918.1219868557534, -779.0636381600455, -740.7445417489905, -627.7987635176951, -846.1734392201507, -1026.1366211636464, -991.1075168066791], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.42037166855725, "mean_inference_ms": 0.41485094427659774, "mean_action_processing_ms": 0.09756148540608603, "mean_env_wait_ms": 2.7344868423458415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037534236907958984, "StateBufferConnector_ms": 0.0028228759765625, "ViewRequirementAgentConnector_ms": 0.06953787803649902}}, "episode_reward_max": -345.0189279420206, "episode_reward_min": -1264.805319356825, "episode_reward_mean": -752.8600716935943, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-890.6729698007413, -810.4122099881012, -420.23710906097955, -999.1882430694006, -685.1520441618709, -712.5506270730253, -807.3880170914313, -983.3103777503555, -802.3735094427007, -606.1927232251744, -601.4036421112345, -966.0492808920018, -520.5992178428874, -600.5375929979575, -641.8323874065542, -962.5451956320919, -594.3087991486598, -772.9163376438366, -719.9538553926772, -474.6575614205599, -699.51904075112, -638.947254086584, -784.4679001007582, -557.1179618048418, -839.2750058176025, -1075.706434745053, -621.5407325078561, -561.8652645992591, -684.4522993353054, -503.06258249728535, -834.3587733516559, -862.1900956627134, -809.9168935275501, -875.6670549559827, -963.6767032457285, -654.353946812361, -345.0189279420206, -756.4941077139541, -444.8640447618194, -844.0030774970837, -653.7971306917312, -698.15588955326, -806.1105141535306, -778.5286515148268, -836.2556057298376, -702.89886243886, -674.3364089798628, -586.4189195271406, -957.5296487521726, -910.3520816700877, -893.4379223305275, -391.74242097115416, -1264.805319356825, -959.6474938561171, -798.4250593957078, -831.0110031245925, -437.1133817849657, -763.0267766695106, -563.0577289151793, -546.4470888103436, -1100.079136414408, -517.3967538146196, -684.6859154027624, -893.6393460443707, -789.955151911287, -575.2301847628802, -642.4043922466298, -469.7713720859592, -1103.6267050896254, -832.9088887202608, -560.0298103152801, -914.7174592350212, -544.5638309839326, -815.022416278965, -611.9389605369848, -949.353625424887, -984.6556400009515, -696.0354490196511, -850.5998145896981, -612.314678042395, -761.5693908480316, -762.0242108081395, -913.8990176793252, -739.0573346696534, -973.6543863618886, -853.885512123146, -685.9431800648692, -628.8443831481497, -793.2244754853593, -938.036210409312, -731.0213689932796, -668.91402419103, -775.9799250886979, -918.1219868557534, -779.0636381600455, -740.7445417489905, -627.7987635176951, -846.1734392201507, -1026.1366211636464, -991.1075168066791], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.42037166855725, "mean_inference_ms": 0.41485094427659774, "mean_action_processing_ms": 0.09756148540608603, "mean_env_wait_ms": 2.7344868423458415, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037534236907958984, "StateBufferConnector_ms": 0.0028228759765625, "ViewRequirementAgentConnector_ms": 0.06953787803649902}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.562412108752866, "num_env_steps_trained_throughput_per_sec": 40.562412108752866, "timesteps_total": 276000, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 276000, "timers": {"training_iteration_time_ms": 2916.255, "sample_time_ms": 2912.495, "load_time_ms": 0.217, "load_throughput": 552003.159, "learn_time_ms": 2.795, "learn_throughput": 42933.004, "synch_weights_time_ms": 0.707}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "done": false, "episodes_total": 2300, "training_iteration": 576, "trial_id": "53665_00000", "date": "2023-07-26_03-44-12", "timestamp": 1690332252, "time_this_iter_s": 11.836603879928589, "time_total_s": 6991.774425268173, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1370.4489493370056, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 38.28235294117648, "ram_util_percent": 72.18235294117646}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-09, "entropy_coeff": 0.05, "policy_entropy": 267.49444580078125, "policy_loss": -128681.109375, "vf_loss": 7256291.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 466.0, "diff_num_grad_updates_vs_sampler_policy": 465.0}}, "num_env_steps_sampled": 276480, "num_env_steps_trained": 276480, "num_agent_steps_sampled": 276480, "num_agent_steps_trained": 276480}, "sampler_results": {"episode_reward_max": -345.0189279420206, "episode_reward_min": -1264.805319356825, "episode_reward_mean": -758.9325256640848, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-685.1520441618709, -712.5506270730253, -807.3880170914313, -983.3103777503555, -802.3735094427007, -606.1927232251744, -601.4036421112345, -966.0492808920018, -520.5992178428874, -600.5375929979575, -641.8323874065542, -962.5451956320919, -594.3087991486598, -772.9163376438366, -719.9538553926772, -474.6575614205599, -699.51904075112, -638.947254086584, -784.4679001007582, -557.1179618048418, -839.2750058176025, -1075.706434745053, -621.5407325078561, -561.8652645992591, -684.4522993353054, -503.06258249728535, -834.3587733516559, -862.1900956627134, -809.9168935275501, -875.6670549559827, -963.6767032457285, -654.353946812361, -345.0189279420206, -756.4941077139541, -444.8640447618194, -844.0030774970837, -653.7971306917312, -698.15588955326, -806.1105141535306, -778.5286515148268, -836.2556057298376, -702.89886243886, -674.3364089798628, -586.4189195271406, -957.5296487521726, -910.3520816700877, -893.4379223305275, -391.74242097115416, -1264.805319356825, -959.6474938561171, -798.4250593957078, -831.0110031245925, -437.1133817849657, -763.0267766695106, -563.0577289151793, -546.4470888103436, -1100.079136414408, -517.3967538146196, -684.6859154027624, -893.6393460443707, -789.955151911287, -575.2301847628802, -642.4043922466298, -469.7713720859592, -1103.6267050896254, -832.9088887202608, -560.0298103152801, -914.7174592350212, -544.5638309839326, -815.022416278965, -611.9389605369848, -949.353625424887, -984.6556400009515, -696.0354490196511, -850.5998145896981, -612.314678042395, -761.5693908480316, -762.0242108081395, -913.8990176793252, -739.0573346696534, -973.6543863618886, -853.885512123146, -685.9431800648692, -628.8443831481497, -793.2244754853593, -938.036210409312, -731.0213689932796, -668.91402419103, -775.9799250886979, -918.1219868557534, -779.0636381600455, -740.7445417489905, -627.7987635176951, -846.1734392201507, -1026.1366211636464, -991.1075168066791, -1158.6117929321103, -634.4079835977203, -1086.3997778712767, -848.3363745671835], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.417762377181997, "mean_inference_ms": 0.414690256992185, "mean_action_processing_ms": 0.09753622535860204, "mean_env_wait_ms": 2.7336962276706265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037403106689453125, "StateBufferConnector_ms": 0.002816438674926758, "ViewRequirementAgentConnector_ms": 0.0694429874420166}}, "episode_reward_max": -345.0189279420206, "episode_reward_min": -1264.805319356825, "episode_reward_mean": -758.9325256640848, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-685.1520441618709, -712.5506270730253, -807.3880170914313, -983.3103777503555, -802.3735094427007, -606.1927232251744, -601.4036421112345, -966.0492808920018, -520.5992178428874, -600.5375929979575, -641.8323874065542, -962.5451956320919, -594.3087991486598, -772.9163376438366, -719.9538553926772, -474.6575614205599, -699.51904075112, -638.947254086584, -784.4679001007582, -557.1179618048418, -839.2750058176025, -1075.706434745053, -621.5407325078561, -561.8652645992591, -684.4522993353054, -503.06258249728535, -834.3587733516559, -862.1900956627134, -809.9168935275501, -875.6670549559827, -963.6767032457285, -654.353946812361, -345.0189279420206, -756.4941077139541, -444.8640447618194, -844.0030774970837, -653.7971306917312, -698.15588955326, -806.1105141535306, -778.5286515148268, -836.2556057298376, -702.89886243886, -674.3364089798628, -586.4189195271406, -957.5296487521726, -910.3520816700877, -893.4379223305275, -391.74242097115416, -1264.805319356825, -959.6474938561171, -798.4250593957078, -831.0110031245925, -437.1133817849657, -763.0267766695106, -563.0577289151793, -546.4470888103436, -1100.079136414408, -517.3967538146196, -684.6859154027624, -893.6393460443707, -789.955151911287, -575.2301847628802, -642.4043922466298, -469.7713720859592, -1103.6267050896254, -832.9088887202608, -560.0298103152801, -914.7174592350212, -544.5638309839326, -815.022416278965, -611.9389605369848, -949.353625424887, -984.6556400009515, -696.0354490196511, -850.5998145896981, -612.314678042395, -761.5693908480316, -762.0242108081395, -913.8990176793252, -739.0573346696534, -973.6543863618886, -853.885512123146, -685.9431800648692, -628.8443831481497, -793.2244754853593, -938.036210409312, -731.0213689932796, -668.91402419103, -775.9799250886979, -918.1219868557534, -779.0636381600455, -740.7445417489905, -627.7987635176951, -846.1734392201507, -1026.1366211636464, -991.1075168066791, -1158.6117929321103, -634.4079835977203, -1086.3997778712767, -848.3363745671835], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.417762377181997, "mean_inference_ms": 0.414690256992185, "mean_action_processing_ms": 0.09753622535860204, "mean_env_wait_ms": 2.7336962276706265, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037403106689453125, "StateBufferConnector_ms": 0.002816438674926758, "ViewRequirementAgentConnector_ms": 0.0694429874420166}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 276480, "num_agent_steps_trained": 276480, "num_env_steps_sampled": 276480, "num_env_steps_trained": 276480, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.723409517921574, "num_env_steps_trained_throughput_per_sec": 40.723409517921574, "timesteps_total": 276480, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 276480, "timers": {"training_iteration_time_ms": 2942.659, "sample_time_ms": 2938.902, "load_time_ms": 0.217, "load_throughput": 553034.26, "learn_time_ms": 2.796, "learn_throughput": 42920.556, "synch_weights_time_ms": 0.703}, "counters": {"num_env_steps_sampled": 276480, "num_env_steps_trained": 276480, "num_agent_steps_sampled": 276480, "num_agent_steps_trained": 276480}, "done": false, "episodes_total": 2304, "training_iteration": 577, "trial_id": "53665_00000", "date": "2023-07-26_03-44-24", "timestamp": 1690332264, "time_this_iter_s": 11.789546966552734, "time_total_s": 7003.563972234726, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1382.2384963035583, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 40.05294117647059, "ram_util_percent": 72.45882352941175}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4756164550781, "policy_loss": -103913.7890625, "vf_loss": 5409126.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 470.0, "diff_num_grad_updates_vs_sampler_policy": 469.0}}, "num_env_steps_sampled": 276960, "num_env_steps_trained": 276960, "num_agent_steps_sampled": 276960, "num_agent_steps_trained": 276960}, "sampler_results": {"episode_reward_max": -345.0189279420206, "episode_reward_min": -1264.805319356825, "episode_reward_mean": -756.4961444295205, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-802.3735094427007, -606.1927232251744, -601.4036421112345, -966.0492808920018, -520.5992178428874, -600.5375929979575, -641.8323874065542, -962.5451956320919, -594.3087991486598, -772.9163376438366, -719.9538553926772, -474.6575614205599, -699.51904075112, -638.947254086584, -784.4679001007582, -557.1179618048418, -839.2750058176025, -1075.706434745053, -621.5407325078561, -561.8652645992591, -684.4522993353054, -503.06258249728535, -834.3587733516559, -862.1900956627134, -809.9168935275501, -875.6670549559827, -963.6767032457285, -654.353946812361, -345.0189279420206, -756.4941077139541, -444.8640447618194, -844.0030774970837, -653.7971306917312, -698.15588955326, -806.1105141535306, -778.5286515148268, -836.2556057298376, -702.89886243886, -674.3364089798628, -586.4189195271406, -957.5296487521726, -910.3520816700877, -893.4379223305275, -391.74242097115416, -1264.805319356825, -959.6474938561171, -798.4250593957078, -831.0110031245925, -437.1133817849657, -763.0267766695106, -563.0577289151793, -546.4470888103436, -1100.079136414408, -517.3967538146196, -684.6859154027624, -893.6393460443707, -789.955151911287, -575.2301847628802, -642.4043922466298, -469.7713720859592, -1103.6267050896254, -832.9088887202608, -560.0298103152801, -914.7174592350212, -544.5638309839326, -815.022416278965, -611.9389605369848, -949.353625424887, -984.6556400009515, -696.0354490196511, -850.5998145896981, -612.314678042395, -761.5693908480316, -762.0242108081395, -913.8990176793252, -739.0573346696534, -973.6543863618886, -853.885512123146, -685.9431800648692, -628.8443831481497, -793.2244754853593, -938.036210409312, -731.0213689932796, -668.91402419103, -775.9799250886979, -918.1219868557534, -779.0636381600455, -740.7445417489905, -627.7987635176951, -846.1734392201507, -1026.1366211636464, -991.1075168066791, -1158.6117929321103, -634.4079835977203, -1086.3997778712767, -848.3363745671835, -609.985177244056, -568.0533195590792, -931.8836352696122, -834.8408105474897], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.41506268881827, "mean_inference_ms": 0.4145399594066349, "mean_action_processing_ms": 0.09751277379378419, "mean_env_wait_ms": 2.7329436226442807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003751516342163086, "StateBufferConnector_ms": 0.0028247833251953125, "ViewRequirementAgentConnector_ms": 0.06951594352722168}}, "episode_reward_max": -345.0189279420206, "episode_reward_min": -1264.805319356825, "episode_reward_mean": -756.4961444295205, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-802.3735094427007, -606.1927232251744, -601.4036421112345, -966.0492808920018, -520.5992178428874, -600.5375929979575, -641.8323874065542, -962.5451956320919, -594.3087991486598, -772.9163376438366, -719.9538553926772, -474.6575614205599, -699.51904075112, -638.947254086584, -784.4679001007582, -557.1179618048418, -839.2750058176025, -1075.706434745053, -621.5407325078561, -561.8652645992591, -684.4522993353054, -503.06258249728535, -834.3587733516559, -862.1900956627134, -809.9168935275501, -875.6670549559827, -963.6767032457285, -654.353946812361, -345.0189279420206, -756.4941077139541, -444.8640447618194, -844.0030774970837, -653.7971306917312, -698.15588955326, -806.1105141535306, -778.5286515148268, -836.2556057298376, -702.89886243886, -674.3364089798628, -586.4189195271406, -957.5296487521726, -910.3520816700877, -893.4379223305275, -391.74242097115416, -1264.805319356825, -959.6474938561171, -798.4250593957078, -831.0110031245925, -437.1133817849657, -763.0267766695106, -563.0577289151793, -546.4470888103436, -1100.079136414408, -517.3967538146196, -684.6859154027624, -893.6393460443707, -789.955151911287, -575.2301847628802, -642.4043922466298, -469.7713720859592, -1103.6267050896254, -832.9088887202608, -560.0298103152801, -914.7174592350212, -544.5638309839326, -815.022416278965, -611.9389605369848, -949.353625424887, -984.6556400009515, -696.0354490196511, -850.5998145896981, -612.314678042395, -761.5693908480316, -762.0242108081395, -913.8990176793252, -739.0573346696534, -973.6543863618886, -853.885512123146, -685.9431800648692, -628.8443831481497, -793.2244754853593, -938.036210409312, -731.0213689932796, -668.91402419103, -775.9799250886979, -918.1219868557534, -779.0636381600455, -740.7445417489905, -627.7987635176951, -846.1734392201507, -1026.1366211636464, -991.1075168066791, -1158.6117929321103, -634.4079835977203, -1086.3997778712767, -848.3363745671835, -609.985177244056, -568.0533195590792, -931.8836352696122, -834.8408105474897], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.41506268881827, "mean_inference_ms": 0.4145399594066349, "mean_action_processing_ms": 0.09751277379378419, "mean_env_wait_ms": 2.7329436226442807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003751516342163086, "StateBufferConnector_ms": 0.0028247833251953125, "ViewRequirementAgentConnector_ms": 0.06951594352722168}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 276960, "num_agent_steps_trained": 276960, "num_env_steps_sampled": 276960, "num_env_steps_trained": 276960, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.10660368461307, "num_env_steps_trained_throughput_per_sec": 41.10660368461307, "timesteps_total": 276960, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 276960, "timers": {"training_iteration_time_ms": 2949.351, "sample_time_ms": 2945.59, "load_time_ms": 0.218, "load_throughput": 551640.158, "learn_time_ms": 2.793, "learn_throughput": 42961.954, "synch_weights_time_ms": 0.709}, "counters": {"num_env_steps_sampled": 276960, "num_env_steps_trained": 276960, "num_agent_steps_sampled": 276960, "num_agent_steps_trained": 276960}, "done": false, "episodes_total": 2308, "training_iteration": 578, "trial_id": "53665_00000", "date": "2023-07-26_03-44-35", "timestamp": 1690332275, "time_this_iter_s": 11.679781913757324, "time_total_s": 7015.243754148483, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1393.9182782173157, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 42.0625, "ram_util_percent": 72.90625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4824523925781, "policy_loss": -110528.96875, "vf_loss": 6328520.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 474.0, "diff_num_grad_updates_vs_sampler_policy": 473.0}}, "num_env_steps_sampled": 277440, "num_env_steps_trained": 277440, "num_agent_steps_sampled": 277440, "num_agent_steps_trained": 277440}, "sampler_results": {"episode_reward_max": -345.0189279420206, "episode_reward_min": -1264.805319356825, "episode_reward_mean": -761.496049298488, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-520.5992178428874, -600.5375929979575, -641.8323874065542, -962.5451956320919, -594.3087991486598, -772.9163376438366, -719.9538553926772, -474.6575614205599, -699.51904075112, -638.947254086584, -784.4679001007582, -557.1179618048418, -839.2750058176025, -1075.706434745053, -621.5407325078561, -561.8652645992591, -684.4522993353054, -503.06258249728535, -834.3587733516559, -862.1900956627134, -809.9168935275501, -875.6670549559827, -963.6767032457285, -654.353946812361, -345.0189279420206, -756.4941077139541, -444.8640447618194, -844.0030774970837, -653.7971306917312, -698.15588955326, -806.1105141535306, -778.5286515148268, -836.2556057298376, -702.89886243886, -674.3364089798628, -586.4189195271406, -957.5296487521726, -910.3520816700877, -893.4379223305275, -391.74242097115416, -1264.805319356825, -959.6474938561171, -798.4250593957078, -831.0110031245925, -437.1133817849657, -763.0267766695106, -563.0577289151793, -546.4470888103436, -1100.079136414408, -517.3967538146196, -684.6859154027624, -893.6393460443707, -789.955151911287, -575.2301847628802, -642.4043922466298, -469.7713720859592, -1103.6267050896254, -832.9088887202608, -560.0298103152801, -914.7174592350212, -544.5638309839326, -815.022416278965, -611.9389605369848, -949.353625424887, -984.6556400009515, -696.0354490196511, -850.5998145896981, -612.314678042395, -761.5693908480316, -762.0242108081395, -913.8990176793252, -739.0573346696534, -973.6543863618886, -853.885512123146, -685.9431800648692, -628.8443831481497, -793.2244754853593, -938.036210409312, -731.0213689932796, -668.91402419103, -775.9799250886979, -918.1219868557534, -779.0636381600455, -740.7445417489905, -627.7987635176951, -846.1734392201507, -1026.1366211636464, -991.1075168066791, -1158.6117929321103, -634.4079835977203, -1086.3997778712767, -848.3363745671835, -609.985177244056, -568.0533195590792, -931.8836352696122, -834.8408105474897, -925.5155738552007, -785.2826896370813, -908.2995469991157, -856.9118320764713], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.41218880627569, "mean_inference_ms": 0.41439485648493246, "mean_action_processing_ms": 0.09749026039077545, "mean_env_wait_ms": 2.732196312357567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003754854202270508, "StateBufferConnector_ms": 0.002820730209350586, "ViewRequirementAgentConnector_ms": 0.06954050064086914}}, "episode_reward_max": -345.0189279420206, "episode_reward_min": -1264.805319356825, "episode_reward_mean": -761.496049298488, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-520.5992178428874, -600.5375929979575, -641.8323874065542, -962.5451956320919, -594.3087991486598, -772.9163376438366, -719.9538553926772, -474.6575614205599, -699.51904075112, -638.947254086584, -784.4679001007582, -557.1179618048418, -839.2750058176025, -1075.706434745053, -621.5407325078561, -561.8652645992591, -684.4522993353054, -503.06258249728535, -834.3587733516559, -862.1900956627134, -809.9168935275501, -875.6670549559827, -963.6767032457285, -654.353946812361, -345.0189279420206, -756.4941077139541, -444.8640447618194, -844.0030774970837, -653.7971306917312, -698.15588955326, -806.1105141535306, -778.5286515148268, -836.2556057298376, -702.89886243886, -674.3364089798628, -586.4189195271406, -957.5296487521726, -910.3520816700877, -893.4379223305275, -391.74242097115416, -1264.805319356825, -959.6474938561171, -798.4250593957078, -831.0110031245925, -437.1133817849657, -763.0267766695106, -563.0577289151793, -546.4470888103436, -1100.079136414408, -517.3967538146196, -684.6859154027624, -893.6393460443707, -789.955151911287, -575.2301847628802, -642.4043922466298, -469.7713720859592, -1103.6267050896254, -832.9088887202608, -560.0298103152801, -914.7174592350212, -544.5638309839326, -815.022416278965, -611.9389605369848, -949.353625424887, -984.6556400009515, -696.0354490196511, -850.5998145896981, -612.314678042395, -761.5693908480316, -762.0242108081395, -913.8990176793252, -739.0573346696534, -973.6543863618886, -853.885512123146, -685.9431800648692, -628.8443831481497, -793.2244754853593, -938.036210409312, -731.0213689932796, -668.91402419103, -775.9799250886979, -918.1219868557534, -779.0636381600455, -740.7445417489905, -627.7987635176951, -846.1734392201507, -1026.1366211636464, -991.1075168066791, -1158.6117929321103, -634.4079835977203, -1086.3997778712767, -848.3363745671835, -609.985177244056, -568.0533195590792, -931.8836352696122, -834.8408105474897, -925.5155738552007, -785.2826896370813, -908.2995469991157, -856.9118320764713], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.41218880627569, "mean_inference_ms": 0.41439485648493246, "mean_action_processing_ms": 0.09749026039077545, "mean_env_wait_ms": 2.732196312357567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003754854202270508, "StateBufferConnector_ms": 0.002820730209350586, "ViewRequirementAgentConnector_ms": 0.06954050064086914}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 277440, "num_agent_steps_trained": 277440, "num_env_steps_sampled": 277440, "num_env_steps_trained": 277440, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.976868983810434, "num_env_steps_trained_throughput_per_sec": 41.976868983810434, "timesteps_total": 277440, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 277440, "timers": {"training_iteration_time_ms": 2904.432, "sample_time_ms": 2900.702, "load_time_ms": 0.217, "load_throughput": 552669.902, "learn_time_ms": 2.772, "learn_throughput": 43287.477, "synch_weights_time_ms": 0.7}, "counters": {"num_env_steps_sampled": 277440, "num_env_steps_trained": 277440, "num_agent_steps_sampled": 277440, "num_agent_steps_trained": 277440}, "done": false, "episodes_total": 2312, "training_iteration": 579, "trial_id": "53665_00000", "date": "2023-07-26_03-44-47", "timestamp": 1690332287, "time_this_iter_s": 11.437479972839355, "time_total_s": 7026.681234121323, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1405.355758190155, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 33.34117647058824, "ram_util_percent": 73.65882352941176}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-09, "entropy_coeff": 0.05, "policy_entropy": 267.5074157714844, "policy_loss": -87847.25, "vf_loss": 3503621.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 478.0, "diff_num_grad_updates_vs_sampler_policy": 477.0}}, "num_env_steps_sampled": 277920, "num_env_steps_trained": 277920, "num_agent_steps_sampled": 277920, "num_agent_steps_trained": 277920}, "sampler_results": {"episode_reward_max": -345.0189279420206, "episode_reward_min": -1264.805319356825, "episode_reward_mean": -760.5389942171666, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-594.3087991486598, -772.9163376438366, -719.9538553926772, -474.6575614205599, -699.51904075112, -638.947254086584, -784.4679001007582, -557.1179618048418, -839.2750058176025, -1075.706434745053, -621.5407325078561, -561.8652645992591, -684.4522993353054, -503.06258249728535, -834.3587733516559, -862.1900956627134, -809.9168935275501, -875.6670549559827, -963.6767032457285, -654.353946812361, -345.0189279420206, -756.4941077139541, -444.8640447618194, -844.0030774970837, -653.7971306917312, -698.15588955326, -806.1105141535306, -778.5286515148268, -836.2556057298376, -702.89886243886, -674.3364089798628, -586.4189195271406, -957.5296487521726, -910.3520816700877, -893.4379223305275, -391.74242097115416, -1264.805319356825, -959.6474938561171, -798.4250593957078, -831.0110031245925, -437.1133817849657, -763.0267766695106, -563.0577289151793, -546.4470888103436, -1100.079136414408, -517.3967538146196, -684.6859154027624, -893.6393460443707, -789.955151911287, -575.2301847628802, -642.4043922466298, -469.7713720859592, -1103.6267050896254, -832.9088887202608, -560.0298103152801, -914.7174592350212, -544.5638309839326, -815.022416278965, -611.9389605369848, -949.353625424887, -984.6556400009515, -696.0354490196511, -850.5998145896981, -612.314678042395, -761.5693908480316, -762.0242108081395, -913.8990176793252, -739.0573346696534, -973.6543863618886, -853.885512123146, -685.9431800648692, -628.8443831481497, -793.2244754853593, -938.036210409312, -731.0213689932796, -668.91402419103, -775.9799250886979, -918.1219868557534, -779.0636381600455, -740.7445417489905, -627.7987635176951, -846.1734392201507, -1026.1366211636464, -991.1075168066791, -1158.6117929321103, -634.4079835977203, -1086.3997778712767, -848.3363745671835, -609.985177244056, -568.0533195590792, -931.8836352696122, -834.8408105474897, -925.5155738552007, -785.2826896370813, -908.2995469991157, -856.9118320764713, -480.97023180184084, -965.3187054622128, -526.9204647026459, -656.5994837806566], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.40949107218369, "mean_inference_ms": 0.4142415357007739, "mean_action_processing_ms": 0.09746613747085768, "mean_env_wait_ms": 2.7315075743517863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037376880645751953, "StateBufferConnector_ms": 0.0028192996978759766, "ViewRequirementAgentConnector_ms": 0.0691683292388916}}, "episode_reward_max": -345.0189279420206, "episode_reward_min": -1264.805319356825, "episode_reward_mean": -760.5389942171666, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-594.3087991486598, -772.9163376438366, -719.9538553926772, -474.6575614205599, -699.51904075112, -638.947254086584, -784.4679001007582, -557.1179618048418, -839.2750058176025, -1075.706434745053, -621.5407325078561, -561.8652645992591, -684.4522993353054, -503.06258249728535, -834.3587733516559, -862.1900956627134, -809.9168935275501, -875.6670549559827, -963.6767032457285, -654.353946812361, -345.0189279420206, -756.4941077139541, -444.8640447618194, -844.0030774970837, -653.7971306917312, -698.15588955326, -806.1105141535306, -778.5286515148268, -836.2556057298376, -702.89886243886, -674.3364089798628, -586.4189195271406, -957.5296487521726, -910.3520816700877, -893.4379223305275, -391.74242097115416, -1264.805319356825, -959.6474938561171, -798.4250593957078, -831.0110031245925, -437.1133817849657, -763.0267766695106, -563.0577289151793, -546.4470888103436, -1100.079136414408, -517.3967538146196, -684.6859154027624, -893.6393460443707, -789.955151911287, -575.2301847628802, -642.4043922466298, -469.7713720859592, -1103.6267050896254, -832.9088887202608, -560.0298103152801, -914.7174592350212, -544.5638309839326, -815.022416278965, -611.9389605369848, -949.353625424887, -984.6556400009515, -696.0354490196511, -850.5998145896981, -612.314678042395, -761.5693908480316, -762.0242108081395, -913.8990176793252, -739.0573346696534, -973.6543863618886, -853.885512123146, -685.9431800648692, -628.8443831481497, -793.2244754853593, -938.036210409312, -731.0213689932796, -668.91402419103, -775.9799250886979, -918.1219868557534, -779.0636381600455, -740.7445417489905, -627.7987635176951, -846.1734392201507, -1026.1366211636464, -991.1075168066791, -1158.6117929321103, -634.4079835977203, -1086.3997778712767, -848.3363745671835, -609.985177244056, -568.0533195590792, -931.8836352696122, -834.8408105474897, -925.5155738552007, -785.2826896370813, -908.2995469991157, -856.9118320764713, -480.97023180184084, -965.3187054622128, -526.9204647026459, -656.5994837806566], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.40949107218369, "mean_inference_ms": 0.4142415357007739, "mean_action_processing_ms": 0.09746613747085768, "mean_env_wait_ms": 2.7315075743517863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037376880645751953, "StateBufferConnector_ms": 0.0028192996978759766, "ViewRequirementAgentConnector_ms": 0.0691683292388916}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 277920, "num_agent_steps_trained": 277920, "num_env_steps_sampled": 277920, "num_env_steps_trained": 277920, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.07843312088135, "num_env_steps_trained_throughput_per_sec": 41.07843312088135, "timesteps_total": 277920, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 277920, "timers": {"training_iteration_time_ms": 2887.269, "sample_time_ms": 2883.089, "load_time_ms": 0.242, "load_throughput": 495878.305, "learn_time_ms": 3.114, "learn_throughput": 38534.65, "synch_weights_time_ms": 0.781}, "counters": {"num_env_steps_sampled": 277920, "num_env_steps_trained": 277920, "num_agent_steps_sampled": 277920, "num_agent_steps_trained": 277920}, "done": false, "episodes_total": 2316, "training_iteration": 580, "trial_id": "53665_00000", "date": "2023-07-26_03-44-59", "timestamp": 1690332299, "time_this_iter_s": 11.691086053848267, "time_total_s": 7038.372320175171, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1417.0468442440033, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 34.9375, "ram_util_percent": 73.66874999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4665222167969, "policy_loss": -63529.3125, "vf_loss": 1784478.625}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 482.0, "diff_num_grad_updates_vs_sampler_policy": 481.0}}, "num_env_steps_sampled": 278400, "num_env_steps_trained": 278400, "num_agent_steps_sampled": 278400, "num_agent_steps_trained": 278400}, "sampler_results": {"episode_reward_max": -345.0189279420206, "episode_reward_min": -1264.805319356825, "episode_reward_mean": -758.9056341235744, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-699.51904075112, -638.947254086584, -784.4679001007582, -557.1179618048418, -839.2750058176025, -1075.706434745053, -621.5407325078561, -561.8652645992591, -684.4522993353054, -503.06258249728535, -834.3587733516559, -862.1900956627134, -809.9168935275501, -875.6670549559827, -963.6767032457285, -654.353946812361, -345.0189279420206, -756.4941077139541, -444.8640447618194, -844.0030774970837, -653.7971306917312, -698.15588955326, -806.1105141535306, -778.5286515148268, -836.2556057298376, -702.89886243886, -674.3364089798628, -586.4189195271406, -957.5296487521726, -910.3520816700877, -893.4379223305275, -391.74242097115416, -1264.805319356825, -959.6474938561171, -798.4250593957078, -831.0110031245925, -437.1133817849657, -763.0267766695106, -563.0577289151793, -546.4470888103436, -1100.079136414408, -517.3967538146196, -684.6859154027624, -893.6393460443707, -789.955151911287, -575.2301847628802, -642.4043922466298, -469.7713720859592, -1103.6267050896254, -832.9088887202608, -560.0298103152801, -914.7174592350212, -544.5638309839326, -815.022416278965, -611.9389605369848, -949.353625424887, -984.6556400009515, -696.0354490196511, -850.5998145896981, -612.314678042395, -761.5693908480316, -762.0242108081395, -913.8990176793252, -739.0573346696534, -973.6543863618886, -853.885512123146, -685.9431800648692, -628.8443831481497, -793.2244754853593, -938.036210409312, -731.0213689932796, -668.91402419103, -775.9799250886979, -918.1219868557534, -779.0636381600455, -740.7445417489905, -627.7987635176951, -846.1734392201507, -1026.1366211636464, -991.1075168066791, -1158.6117929321103, -634.4079835977203, -1086.3997778712767, -848.3363745671835, -609.985177244056, -568.0533195590792, -931.8836352696122, -834.8408105474897, -925.5155738552007, -785.2826896370813, -908.2995469991157, -856.9118320764713, -480.97023180184084, -965.3187054622128, -526.9204647026459, -656.5994837806566, -471.29863448125815, -672.0187467705181, -710.4506096922596, -544.7325533024848], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.407122957869817, "mean_inference_ms": 0.4140954275316857, "mean_action_processing_ms": 0.09744302340577234, "mean_env_wait_ms": 2.7308506539855193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037450790405273438, "StateBufferConnector_ms": 0.0028145313262939453, "ViewRequirementAgentConnector_ms": 0.06935262680053711}}, "episode_reward_max": -345.0189279420206, "episode_reward_min": -1264.805319356825, "episode_reward_mean": -758.9056341235744, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-699.51904075112, -638.947254086584, -784.4679001007582, -557.1179618048418, -839.2750058176025, -1075.706434745053, -621.5407325078561, -561.8652645992591, -684.4522993353054, -503.06258249728535, -834.3587733516559, -862.1900956627134, -809.9168935275501, -875.6670549559827, -963.6767032457285, -654.353946812361, -345.0189279420206, -756.4941077139541, -444.8640447618194, -844.0030774970837, -653.7971306917312, -698.15588955326, -806.1105141535306, -778.5286515148268, -836.2556057298376, -702.89886243886, -674.3364089798628, -586.4189195271406, -957.5296487521726, -910.3520816700877, -893.4379223305275, -391.74242097115416, -1264.805319356825, -959.6474938561171, -798.4250593957078, -831.0110031245925, -437.1133817849657, -763.0267766695106, -563.0577289151793, -546.4470888103436, -1100.079136414408, -517.3967538146196, -684.6859154027624, -893.6393460443707, -789.955151911287, -575.2301847628802, -642.4043922466298, -469.7713720859592, -1103.6267050896254, -832.9088887202608, -560.0298103152801, -914.7174592350212, -544.5638309839326, -815.022416278965, -611.9389605369848, -949.353625424887, -984.6556400009515, -696.0354490196511, -850.5998145896981, -612.314678042395, -761.5693908480316, -762.0242108081395, -913.8990176793252, -739.0573346696534, -973.6543863618886, -853.885512123146, -685.9431800648692, -628.8443831481497, -793.2244754853593, -938.036210409312, -731.0213689932796, -668.91402419103, -775.9799250886979, -918.1219868557534, -779.0636381600455, -740.7445417489905, -627.7987635176951, -846.1734392201507, -1026.1366211636464, -991.1075168066791, -1158.6117929321103, -634.4079835977203, -1086.3997778712767, -848.3363745671835, -609.985177244056, -568.0533195590792, -931.8836352696122, -834.8408105474897, -925.5155738552007, -785.2826896370813, -908.2995469991157, -856.9118320764713, -480.97023180184084, -965.3187054622128, -526.9204647026459, -656.5994837806566, -471.29863448125815, -672.0187467705181, -710.4506096922596, -544.7325533024848], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.407122957869817, "mean_inference_ms": 0.4140954275316857, "mean_action_processing_ms": 0.09744302340577234, "mean_env_wait_ms": 2.7308506539855193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037450790405273438, "StateBufferConnector_ms": 0.0028145313262939453, "ViewRequirementAgentConnector_ms": 0.06935262680053711}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 278400, "num_agent_steps_trained": 278400, "num_env_steps_sampled": 278400, "num_env_steps_trained": 278400, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.62586238588575, "num_env_steps_trained_throughput_per_sec": 39.62586238588575, "timesteps_total": 278400, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 278400, "timers": {"training_iteration_time_ms": 2948.423, "sample_time_ms": 2944.21, "load_time_ms": 0.24, "load_throughput": 499024.866, "learn_time_ms": 3.15, "learn_throughput": 38098.288, "synch_weights_time_ms": 0.779}, "counters": {"num_env_steps_sampled": 278400, "num_env_steps_trained": 278400, "num_agent_steps_sampled": 278400, "num_agent_steps_trained": 278400}, "done": false, "episodes_total": 2320, "training_iteration": 581, "trial_id": "53665_00000", "date": "2023-07-26_03-45-11", "timestamp": 1690332311, "time_this_iter_s": 12.115978002548218, "time_total_s": 7050.488298177719, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1429.1628222465515, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 38.58333333333334, "ram_util_percent": 74.13333333333331}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4682312011719, "policy_loss": -84236.234375, "vf_loss": 3276681.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 486.0, "diff_num_grad_updates_vs_sampler_policy": 485.0}}, "num_env_steps_sampled": 278880, "num_env_steps_trained": 278880, "num_agent_steps_sampled": 278880, "num_agent_steps_trained": 278880}, "sampler_results": {"episode_reward_max": -345.0189279420206, "episode_reward_min": -1264.805319356825, "episode_reward_mean": -762.4773323457449, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-839.2750058176025, -1075.706434745053, -621.5407325078561, -561.8652645992591, -684.4522993353054, -503.06258249728535, -834.3587733516559, -862.1900956627134, -809.9168935275501, -875.6670549559827, -963.6767032457285, -654.353946812361, -345.0189279420206, -756.4941077139541, -444.8640447618194, -844.0030774970837, -653.7971306917312, -698.15588955326, -806.1105141535306, -778.5286515148268, -836.2556057298376, -702.89886243886, -674.3364089798628, -586.4189195271406, -957.5296487521726, -910.3520816700877, -893.4379223305275, -391.74242097115416, -1264.805319356825, -959.6474938561171, -798.4250593957078, -831.0110031245925, -437.1133817849657, -763.0267766695106, -563.0577289151793, -546.4470888103436, -1100.079136414408, -517.3967538146196, -684.6859154027624, -893.6393460443707, -789.955151911287, -575.2301847628802, -642.4043922466298, -469.7713720859592, -1103.6267050896254, -832.9088887202608, -560.0298103152801, -914.7174592350212, -544.5638309839326, -815.022416278965, -611.9389605369848, -949.353625424887, -984.6556400009515, -696.0354490196511, -850.5998145896981, -612.314678042395, -761.5693908480316, -762.0242108081395, -913.8990176793252, -739.0573346696534, -973.6543863618886, -853.885512123146, -685.9431800648692, -628.8443831481497, -793.2244754853593, -938.036210409312, -731.0213689932796, -668.91402419103, -775.9799250886979, -918.1219868557534, -779.0636381600455, -740.7445417489905, -627.7987635176951, -846.1734392201507, -1026.1366211636464, -991.1075168066791, -1158.6117929321103, -634.4079835977203, -1086.3997778712767, -848.3363745671835, -609.985177244056, -568.0533195590792, -931.8836352696122, -834.8408105474897, -925.5155738552007, -785.2826896370813, -908.2995469991157, -856.9118320764713, -480.97023180184084, -965.3187054622128, -526.9204647026459, -656.5994837806566, -471.29863448125815, -672.0187467705181, -710.4506096922596, -544.7325533024848, -763.2048804132796, -739.7691311269479, -824.1495719536343, -710.0983954664807], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.40480213528006, "mean_inference_ms": 0.4139540506015843, "mean_action_processing_ms": 0.09742048004666136, "mean_env_wait_ms": 2.730232727744077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003740549087524414, "StateBufferConnector_ms": 0.0028150081634521484, "ViewRequirementAgentConnector_ms": 0.06934452056884766}}, "episode_reward_max": -345.0189279420206, "episode_reward_min": -1264.805319356825, "episode_reward_mean": -762.4773323457449, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-839.2750058176025, -1075.706434745053, -621.5407325078561, -561.8652645992591, -684.4522993353054, -503.06258249728535, -834.3587733516559, -862.1900956627134, -809.9168935275501, -875.6670549559827, -963.6767032457285, -654.353946812361, -345.0189279420206, -756.4941077139541, -444.8640447618194, -844.0030774970837, -653.7971306917312, -698.15588955326, -806.1105141535306, -778.5286515148268, -836.2556057298376, -702.89886243886, -674.3364089798628, -586.4189195271406, -957.5296487521726, -910.3520816700877, -893.4379223305275, -391.74242097115416, -1264.805319356825, -959.6474938561171, -798.4250593957078, -831.0110031245925, -437.1133817849657, -763.0267766695106, -563.0577289151793, -546.4470888103436, -1100.079136414408, -517.3967538146196, -684.6859154027624, -893.6393460443707, -789.955151911287, -575.2301847628802, -642.4043922466298, -469.7713720859592, -1103.6267050896254, -832.9088887202608, -560.0298103152801, -914.7174592350212, -544.5638309839326, -815.022416278965, -611.9389605369848, -949.353625424887, -984.6556400009515, -696.0354490196511, -850.5998145896981, -612.314678042395, -761.5693908480316, -762.0242108081395, -913.8990176793252, -739.0573346696534, -973.6543863618886, -853.885512123146, -685.9431800648692, -628.8443831481497, -793.2244754853593, -938.036210409312, -731.0213689932796, -668.91402419103, -775.9799250886979, -918.1219868557534, -779.0636381600455, -740.7445417489905, -627.7987635176951, -846.1734392201507, -1026.1366211636464, -991.1075168066791, -1158.6117929321103, -634.4079835977203, -1086.3997778712767, -848.3363745671835, -609.985177244056, -568.0533195590792, -931.8836352696122, -834.8408105474897, -925.5155738552007, -785.2826896370813, -908.2995469991157, -856.9118320764713, -480.97023180184084, -965.3187054622128, -526.9204647026459, -656.5994837806566, -471.29863448125815, -672.0187467705181, -710.4506096922596, -544.7325533024848, -763.2048804132796, -739.7691311269479, -824.1495719536343, -710.0983954664807], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.40480213528006, "mean_inference_ms": 0.4139540506015843, "mean_action_processing_ms": 0.09742048004666136, "mean_env_wait_ms": 2.730232727744077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003740549087524414, "StateBufferConnector_ms": 0.0028150081634521484, "ViewRequirementAgentConnector_ms": 0.06934452056884766}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 278880, "num_agent_steps_trained": 278880, "num_env_steps_sampled": 278880, "num_env_steps_trained": 278880, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.500323959796155, "num_env_steps_trained_throughput_per_sec": 40.500323959796155, "timesteps_total": 278880, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 278880, "timers": {"training_iteration_time_ms": 2985.281, "sample_time_ms": 2981.06, "load_time_ms": 0.243, "load_throughput": 494222.781, "learn_time_ms": 3.157, "learn_throughput": 38007.95, "synch_weights_time_ms": 0.778}, "counters": {"num_env_steps_sampled": 278880, "num_env_steps_trained": 278880, "num_agent_steps_sampled": 278880, "num_agent_steps_trained": 278880}, "done": false, "episodes_total": 2324, "training_iteration": 582, "trial_id": "53665_00000", "date": "2023-07-26_03-45-23", "timestamp": 1690332323, "time_this_iter_s": 11.854501008987427, "time_total_s": 7062.3427991867065, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1441.017323255539, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 37.068749999999994, "ram_util_percent": 74.075}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4725646972656, "policy_loss": -146947.140625, "vf_loss": 9676282.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 490.0, "diff_num_grad_updates_vs_sampler_policy": 489.0}}, "num_env_steps_sampled": 279360, "num_env_steps_trained": 279360, "num_agent_steps_sampled": 279360, "num_agent_steps_trained": 279360}, "sampler_results": {"episode_reward_max": -345.0189279420206, "episode_reward_min": -1264.805319356825, "episode_reward_mean": -763.7710485850625, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-684.4522993353054, -503.06258249728535, -834.3587733516559, -862.1900956627134, -809.9168935275501, -875.6670549559827, -963.6767032457285, -654.353946812361, -345.0189279420206, -756.4941077139541, -444.8640447618194, -844.0030774970837, -653.7971306917312, -698.15588955326, -806.1105141535306, -778.5286515148268, -836.2556057298376, -702.89886243886, -674.3364089798628, -586.4189195271406, -957.5296487521726, -910.3520816700877, -893.4379223305275, -391.74242097115416, -1264.805319356825, -959.6474938561171, -798.4250593957078, -831.0110031245925, -437.1133817849657, -763.0267766695106, -563.0577289151793, -546.4470888103436, -1100.079136414408, -517.3967538146196, -684.6859154027624, -893.6393460443707, -789.955151911287, -575.2301847628802, -642.4043922466298, -469.7713720859592, -1103.6267050896254, -832.9088887202608, -560.0298103152801, -914.7174592350212, -544.5638309839326, -815.022416278965, -611.9389605369848, -949.353625424887, -984.6556400009515, -696.0354490196511, -850.5998145896981, -612.314678042395, -761.5693908480316, -762.0242108081395, -913.8990176793252, -739.0573346696534, -973.6543863618886, -853.885512123146, -685.9431800648692, -628.8443831481497, -793.2244754853593, -938.036210409312, -731.0213689932796, -668.91402419103, -775.9799250886979, -918.1219868557534, -779.0636381600455, -740.7445417489905, -627.7987635176951, -846.1734392201507, -1026.1366211636464, -991.1075168066791, -1158.6117929321103, -634.4079835977203, -1086.3997778712767, -848.3363745671835, -609.985177244056, -568.0533195590792, -931.8836352696122, -834.8408105474897, -925.5155738552007, -785.2826896370813, -908.2995469991157, -856.9118320764713, -480.97023180184084, -965.3187054622128, -526.9204647026459, -656.5994837806566, -471.29863448125815, -672.0187467705181, -710.4506096922596, -544.7325533024848, -763.2048804132796, -739.7691311269479, -824.1495719536343, -710.0983954664807, -569.4301622090443, -620.4315233941855, -970.0045234328868, -1067.8928525654064], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.402498258773985, "mean_inference_ms": 0.4138179682594806, "mean_action_processing_ms": 0.09739878908204755, "mean_env_wait_ms": 2.7295836188207407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003737211227416992, "StateBufferConnector_ms": 0.002797842025756836, "ViewRequirementAgentConnector_ms": 0.06936860084533691}}, "episode_reward_max": -345.0189279420206, "episode_reward_min": -1264.805319356825, "episode_reward_mean": -763.7710485850625, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-684.4522993353054, -503.06258249728535, -834.3587733516559, -862.1900956627134, -809.9168935275501, -875.6670549559827, -963.6767032457285, -654.353946812361, -345.0189279420206, -756.4941077139541, -444.8640447618194, -844.0030774970837, -653.7971306917312, -698.15588955326, -806.1105141535306, -778.5286515148268, -836.2556057298376, -702.89886243886, -674.3364089798628, -586.4189195271406, -957.5296487521726, -910.3520816700877, -893.4379223305275, -391.74242097115416, -1264.805319356825, -959.6474938561171, -798.4250593957078, -831.0110031245925, -437.1133817849657, -763.0267766695106, -563.0577289151793, -546.4470888103436, -1100.079136414408, -517.3967538146196, -684.6859154027624, -893.6393460443707, -789.955151911287, -575.2301847628802, -642.4043922466298, -469.7713720859592, -1103.6267050896254, -832.9088887202608, -560.0298103152801, -914.7174592350212, -544.5638309839326, -815.022416278965, -611.9389605369848, -949.353625424887, -984.6556400009515, -696.0354490196511, -850.5998145896981, -612.314678042395, -761.5693908480316, -762.0242108081395, -913.8990176793252, -739.0573346696534, -973.6543863618886, -853.885512123146, -685.9431800648692, -628.8443831481497, -793.2244754853593, -938.036210409312, -731.0213689932796, -668.91402419103, -775.9799250886979, -918.1219868557534, -779.0636381600455, -740.7445417489905, -627.7987635176951, -846.1734392201507, -1026.1366211636464, -991.1075168066791, -1158.6117929321103, -634.4079835977203, -1086.3997778712767, -848.3363745671835, -609.985177244056, -568.0533195590792, -931.8836352696122, -834.8408105474897, -925.5155738552007, -785.2826896370813, -908.2995469991157, -856.9118320764713, -480.97023180184084, -965.3187054622128, -526.9204647026459, -656.5994837806566, -471.29863448125815, -672.0187467705181, -710.4506096922596, -544.7325533024848, -763.2048804132796, -739.7691311269479, -824.1495719536343, -710.0983954664807, -569.4301622090443, -620.4315233941855, -970.0045234328868, -1067.8928525654064], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.402498258773985, "mean_inference_ms": 0.4138179682594806, "mean_action_processing_ms": 0.09739878908204755, "mean_env_wait_ms": 2.7295836188207407, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003737211227416992, "StateBufferConnector_ms": 0.002797842025756836, "ViewRequirementAgentConnector_ms": 0.06936860084533691}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 279360, "num_agent_steps_trained": 279360, "num_env_steps_sampled": 279360, "num_env_steps_trained": 279360, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.00062441833084, "num_env_steps_trained_throughput_per_sec": 41.00062441833084, "timesteps_total": 279360, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 279360, "timers": {"training_iteration_time_ms": 2960.347, "sample_time_ms": 2956.597, "load_time_ms": 0.218, "load_throughput": 550132.78, "learn_time_ms": 2.789, "learn_throughput": 43028.8, "synch_weights_time_ms": 0.703}, "counters": {"num_env_steps_sampled": 279360, "num_env_steps_trained": 279360, "num_agent_steps_sampled": 279360, "num_agent_steps_trained": 279360}, "done": false, "episodes_total": 2328, "training_iteration": 583, "trial_id": "53665_00000", "date": "2023-07-26_03-45-34", "timestamp": 1690332334, "time_this_iter_s": 11.709942102432251, "time_total_s": 7074.052741289139, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1452.7272653579712, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 35.71764705882353, "ram_util_percent": 72.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-09, "entropy_coeff": 0.05, "policy_entropy": 267.49169921875, "policy_loss": -145114.46875, "vf_loss": 8891032.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 494.0, "diff_num_grad_updates_vs_sampler_policy": 493.0}}, "num_env_steps_sampled": 279840, "num_env_steps_trained": 279840, "num_agent_steps_sampled": 279840, "num_agent_steps_trained": 279840}, "sampler_results": {"episode_reward_max": -345.0189279420206, "episode_reward_min": -1264.805319356825, "episode_reward_mean": -771.3241679709187, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-809.9168935275501, -875.6670549559827, -963.6767032457285, -654.353946812361, -345.0189279420206, -756.4941077139541, -444.8640447618194, -844.0030774970837, -653.7971306917312, -698.15588955326, -806.1105141535306, -778.5286515148268, -836.2556057298376, -702.89886243886, -674.3364089798628, -586.4189195271406, -957.5296487521726, -910.3520816700877, -893.4379223305275, -391.74242097115416, -1264.805319356825, -959.6474938561171, -798.4250593957078, -831.0110031245925, -437.1133817849657, -763.0267766695106, -563.0577289151793, -546.4470888103436, -1100.079136414408, -517.3967538146196, -684.6859154027624, -893.6393460443707, -789.955151911287, -575.2301847628802, -642.4043922466298, -469.7713720859592, -1103.6267050896254, -832.9088887202608, -560.0298103152801, -914.7174592350212, -544.5638309839326, -815.022416278965, -611.9389605369848, -949.353625424887, -984.6556400009515, -696.0354490196511, -850.5998145896981, -612.314678042395, -761.5693908480316, -762.0242108081395, -913.8990176793252, -739.0573346696534, -973.6543863618886, -853.885512123146, -685.9431800648692, -628.8443831481497, -793.2244754853593, -938.036210409312, -731.0213689932796, -668.91402419103, -775.9799250886979, -918.1219868557534, -779.0636381600455, -740.7445417489905, -627.7987635176951, -846.1734392201507, -1026.1366211636464, -991.1075168066791, -1158.6117929321103, -634.4079835977203, -1086.3997778712767, -848.3363745671835, -609.985177244056, -568.0533195590792, -931.8836352696122, -834.8408105474897, -925.5155738552007, -785.2826896370813, -908.2995469991157, -856.9118320764713, -480.97023180184084, -965.3187054622128, -526.9204647026459, -656.5994837806566, -471.29863448125815, -672.0187467705181, -710.4506096922596, -544.7325533024848, -763.2048804132796, -739.7691311269479, -824.1495719536343, -710.0983954664807, -569.4301622090443, -620.4315233941855, -970.0045234328868, -1067.8928525654064, -816.8554156838703, -780.1341603915353, -1054.5756392399649, -987.8104741172193], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.400093230536807, "mean_inference_ms": 0.4136819109869223, "mean_action_processing_ms": 0.09737722363192809, "mean_env_wait_ms": 2.728927292579877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003743886947631836, "StateBufferConnector_ms": 0.002801179885864258, "ViewRequirementAgentConnector_ms": 0.06951355934143066}}, "episode_reward_max": -345.0189279420206, "episode_reward_min": -1264.805319356825, "episode_reward_mean": -771.3241679709187, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-809.9168935275501, -875.6670549559827, -963.6767032457285, -654.353946812361, -345.0189279420206, -756.4941077139541, -444.8640447618194, -844.0030774970837, -653.7971306917312, -698.15588955326, -806.1105141535306, -778.5286515148268, -836.2556057298376, -702.89886243886, -674.3364089798628, -586.4189195271406, -957.5296487521726, -910.3520816700877, -893.4379223305275, -391.74242097115416, -1264.805319356825, -959.6474938561171, -798.4250593957078, -831.0110031245925, -437.1133817849657, -763.0267766695106, -563.0577289151793, -546.4470888103436, -1100.079136414408, -517.3967538146196, -684.6859154027624, -893.6393460443707, -789.955151911287, -575.2301847628802, -642.4043922466298, -469.7713720859592, -1103.6267050896254, -832.9088887202608, -560.0298103152801, -914.7174592350212, -544.5638309839326, -815.022416278965, -611.9389605369848, -949.353625424887, -984.6556400009515, -696.0354490196511, -850.5998145896981, -612.314678042395, -761.5693908480316, -762.0242108081395, -913.8990176793252, -739.0573346696534, -973.6543863618886, -853.885512123146, -685.9431800648692, -628.8443831481497, -793.2244754853593, -938.036210409312, -731.0213689932796, -668.91402419103, -775.9799250886979, -918.1219868557534, -779.0636381600455, -740.7445417489905, -627.7987635176951, -846.1734392201507, -1026.1366211636464, -991.1075168066791, -1158.6117929321103, -634.4079835977203, -1086.3997778712767, -848.3363745671835, -609.985177244056, -568.0533195590792, -931.8836352696122, -834.8408105474897, -925.5155738552007, -785.2826896370813, -908.2995469991157, -856.9118320764713, -480.97023180184084, -965.3187054622128, -526.9204647026459, -656.5994837806566, -471.29863448125815, -672.0187467705181, -710.4506096922596, -544.7325533024848, -763.2048804132796, -739.7691311269479, -824.1495719536343, -710.0983954664807, -569.4301622090443, -620.4315233941855, -970.0045234328868, -1067.8928525654064, -816.8554156838703, -780.1341603915353, -1054.5756392399649, -987.8104741172193], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.400093230536807, "mean_inference_ms": 0.4136819109869223, "mean_action_processing_ms": 0.09737722363192809, "mean_env_wait_ms": 2.728927292579877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003743886947631836, "StateBufferConnector_ms": 0.002801179885864258, "ViewRequirementAgentConnector_ms": 0.06951355934143066}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 279840, "num_agent_steps_trained": 279840, "num_env_steps_sampled": 279840, "num_env_steps_trained": 279840, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 42.16105304860378, "num_env_steps_trained_throughput_per_sec": 42.16105304860378, "timesteps_total": 279840, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 279840, "timers": {"training_iteration_time_ms": 2910.518, "sample_time_ms": 2906.746, "load_time_ms": 0.219, "load_throughput": 547797.649, "learn_time_ms": 2.805, "learn_throughput": 42788.105, "synch_weights_time_ms": 0.707}, "counters": {"num_env_steps_sampled": 279840, "num_env_steps_trained": 279840, "num_agent_steps_sampled": 279840, "num_agent_steps_trained": 279840}, "done": false, "episodes_total": 2332, "training_iteration": 584, "trial_id": "53665_00000", "date": "2023-07-26_03-45-46", "timestamp": 1690332346, "time_this_iter_s": 11.387756109237671, "time_total_s": 7085.4404973983765, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1464.1150214672089, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 36.73125, "ram_util_percent": 73.31875000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4794006347656, "policy_loss": -77763.984375, "vf_loss": 3017582.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 498.0, "diff_num_grad_updates_vs_sampler_policy": 497.0}}, "num_env_steps_sampled": 280320, "num_env_steps_trained": 280320, "num_agent_steps_sampled": 280320, "num_agent_steps_trained": 280320}, "sampler_results": {"episode_reward_max": -345.0189279420206, "episode_reward_min": -1264.805319356825, "episode_reward_mean": -768.5229653404666, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-345.0189279420206, -756.4941077139541, -444.8640447618194, -844.0030774970837, -653.7971306917312, -698.15588955326, -806.1105141535306, -778.5286515148268, -836.2556057298376, -702.89886243886, -674.3364089798628, -586.4189195271406, -957.5296487521726, -910.3520816700877, -893.4379223305275, -391.74242097115416, -1264.805319356825, -959.6474938561171, -798.4250593957078, -831.0110031245925, -437.1133817849657, -763.0267766695106, -563.0577289151793, -546.4470888103436, -1100.079136414408, -517.3967538146196, -684.6859154027624, -893.6393460443707, -789.955151911287, -575.2301847628802, -642.4043922466298, -469.7713720859592, -1103.6267050896254, -832.9088887202608, -560.0298103152801, -914.7174592350212, -544.5638309839326, -815.022416278965, -611.9389605369848, -949.353625424887, -984.6556400009515, -696.0354490196511, -850.5998145896981, -612.314678042395, -761.5693908480316, -762.0242108081395, -913.8990176793252, -739.0573346696534, -973.6543863618886, -853.885512123146, -685.9431800648692, -628.8443831481497, -793.2244754853593, -938.036210409312, -731.0213689932796, -668.91402419103, -775.9799250886979, -918.1219868557534, -779.0636381600455, -740.7445417489905, -627.7987635176951, -846.1734392201507, -1026.1366211636464, -991.1075168066791, -1158.6117929321103, -634.4079835977203, -1086.3997778712767, -848.3363745671835, -609.985177244056, -568.0533195590792, -931.8836352696122, -834.8408105474897, -925.5155738552007, -785.2826896370813, -908.2995469991157, -856.9118320764713, -480.97023180184084, -965.3187054622128, -526.9204647026459, -656.5994837806566, -471.29863448125815, -672.0187467705181, -710.4506096922596, -544.7325533024848, -763.2048804132796, -739.7691311269479, -824.1495719536343, -710.0983954664807, -569.4301622090443, -620.4315233941855, -970.0045234328868, -1067.8928525654064, -816.8554156838703, -780.1341603915353, -1054.5756392399649, -987.8104741172193, -826.7266489458918, -770.713468373902, -783.5125671089766, -642.5416510676502], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.398209647575754, "mean_inference_ms": 0.4135425911920467, "mean_action_processing_ms": 0.0973552969849711, "mean_env_wait_ms": 2.7282940176907844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037441253662109375, "StateBufferConnector_ms": 0.0027990341186523438, "ViewRequirementAgentConnector_ms": 0.06960701942443848}}, "episode_reward_max": -345.0189279420206, "episode_reward_min": -1264.805319356825, "episode_reward_mean": -768.5229653404666, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-345.0189279420206, -756.4941077139541, -444.8640447618194, -844.0030774970837, -653.7971306917312, -698.15588955326, -806.1105141535306, -778.5286515148268, -836.2556057298376, -702.89886243886, -674.3364089798628, -586.4189195271406, -957.5296487521726, -910.3520816700877, -893.4379223305275, -391.74242097115416, -1264.805319356825, -959.6474938561171, -798.4250593957078, -831.0110031245925, -437.1133817849657, -763.0267766695106, -563.0577289151793, -546.4470888103436, -1100.079136414408, -517.3967538146196, -684.6859154027624, -893.6393460443707, -789.955151911287, -575.2301847628802, -642.4043922466298, -469.7713720859592, -1103.6267050896254, -832.9088887202608, -560.0298103152801, -914.7174592350212, -544.5638309839326, -815.022416278965, -611.9389605369848, -949.353625424887, -984.6556400009515, -696.0354490196511, -850.5998145896981, -612.314678042395, -761.5693908480316, -762.0242108081395, -913.8990176793252, -739.0573346696534, -973.6543863618886, -853.885512123146, -685.9431800648692, -628.8443831481497, -793.2244754853593, -938.036210409312, -731.0213689932796, -668.91402419103, -775.9799250886979, -918.1219868557534, -779.0636381600455, -740.7445417489905, -627.7987635176951, -846.1734392201507, -1026.1366211636464, -991.1075168066791, -1158.6117929321103, -634.4079835977203, -1086.3997778712767, -848.3363745671835, -609.985177244056, -568.0533195590792, -931.8836352696122, -834.8408105474897, -925.5155738552007, -785.2826896370813, -908.2995469991157, -856.9118320764713, -480.97023180184084, -965.3187054622128, -526.9204647026459, -656.5994837806566, -471.29863448125815, -672.0187467705181, -710.4506096922596, -544.7325533024848, -763.2048804132796, -739.7691311269479, -824.1495719536343, -710.0983954664807, -569.4301622090443, -620.4315233941855, -970.0045234328868, -1067.8928525654064, -816.8554156838703, -780.1341603915353, -1054.5756392399649, -987.8104741172193, -826.7266489458918, -770.713468373902, -783.5125671089766, -642.5416510676502], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.398209647575754, "mean_inference_ms": 0.4135425911920467, "mean_action_processing_ms": 0.0973552969849711, "mean_env_wait_ms": 2.7282940176907844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037441253662109375, "StateBufferConnector_ms": 0.0027990341186523438, "ViewRequirementAgentConnector_ms": 0.06960701942443848}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280320, "num_agent_steps_trained": 280320, "num_env_steps_sampled": 280320, "num_env_steps_trained": 280320, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.60223131163205, "num_env_steps_trained_throughput_per_sec": 39.60223131163205, "timesteps_total": 280320, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 280320, "timers": {"training_iteration_time_ms": 2934.822, "sample_time_ms": 2931.024, "load_time_ms": 0.218, "load_throughput": 550012.545, "learn_time_ms": 2.836, "learn_throughput": 42311.503, "synch_weights_time_ms": 0.704}, "counters": {"num_env_steps_sampled": 280320, "num_env_steps_trained": 280320, "num_agent_steps_sampled": 280320, "num_agent_steps_trained": 280320}, "done": false, "episodes_total": 2336, "training_iteration": 585, "trial_id": "53665_00000", "date": "2023-07-26_03-45-58", "timestamp": 1690332358, "time_this_iter_s": 12.123188972473145, "time_total_s": 7097.56368637085, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1476.238210439682, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 36.2, "ram_util_percent": 73.26666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-09, "entropy_coeff": 0.05, "policy_entropy": 267.46240234375, "policy_loss": -118835.0390625, "vf_loss": 6185268.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 502.0, "diff_num_grad_updates_vs_sampler_policy": 501.0}}, "num_env_steps_sampled": 280800, "num_env_steps_trained": 280800, "num_agent_steps_sampled": 280800, "num_agent_steps_trained": 280800}, "sampler_results": {"episode_reward_max": -391.74242097115416, "episode_reward_min": -1264.805319356825, "episode_reward_mean": -773.1204522555886, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-653.7971306917312, -698.15588955326, -806.1105141535306, -778.5286515148268, -836.2556057298376, -702.89886243886, -674.3364089798628, -586.4189195271406, -957.5296487521726, -910.3520816700877, -893.4379223305275, -391.74242097115416, -1264.805319356825, -959.6474938561171, -798.4250593957078, -831.0110031245925, -437.1133817849657, -763.0267766695106, -563.0577289151793, -546.4470888103436, -1100.079136414408, -517.3967538146196, -684.6859154027624, -893.6393460443707, -789.955151911287, -575.2301847628802, -642.4043922466298, -469.7713720859592, -1103.6267050896254, -832.9088887202608, -560.0298103152801, -914.7174592350212, -544.5638309839326, -815.022416278965, -611.9389605369848, -949.353625424887, -984.6556400009515, -696.0354490196511, -850.5998145896981, -612.314678042395, -761.5693908480316, -762.0242108081395, -913.8990176793252, -739.0573346696534, -973.6543863618886, -853.885512123146, -685.9431800648692, -628.8443831481497, -793.2244754853593, -938.036210409312, -731.0213689932796, -668.91402419103, -775.9799250886979, -918.1219868557534, -779.0636381600455, -740.7445417489905, -627.7987635176951, -846.1734392201507, -1026.1366211636464, -991.1075168066791, -1158.6117929321103, -634.4079835977203, -1086.3997778712767, -848.3363745671835, -609.985177244056, -568.0533195590792, -931.8836352696122, -834.8408105474897, -925.5155738552007, -785.2826896370813, -908.2995469991157, -856.9118320764713, -480.97023180184084, -965.3187054622128, -526.9204647026459, -656.5994837806566, -471.29863448125815, -672.0187467705181, -710.4506096922596, -544.7325533024848, -763.2048804132796, -739.7691311269479, -824.1495719536343, -710.0983954664807, -569.4301622090443, -620.4315233941855, -970.0045234328868, -1067.8928525654064, -816.8554156838703, -780.1341603915353, -1054.5756392399649, -987.8104741172193, -826.7266489458918, -770.713468373902, -783.5125671089766, -642.5416510676502, -655.1582886824842, -620.6881366171439, -815.8500809726518, -758.4323431547602], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.396579056129294, "mean_inference_ms": 0.41340268915644046, "mean_action_processing_ms": 0.09733321526540738, "mean_env_wait_ms": 2.7277090123793664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037202835083007812, "StateBufferConnector_ms": 0.002794027328491211, "ViewRequirementAgentConnector_ms": 0.06934046745300293}}, "episode_reward_max": -391.74242097115416, "episode_reward_min": -1264.805319356825, "episode_reward_mean": -773.1204522555886, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-653.7971306917312, -698.15588955326, -806.1105141535306, -778.5286515148268, -836.2556057298376, -702.89886243886, -674.3364089798628, -586.4189195271406, -957.5296487521726, -910.3520816700877, -893.4379223305275, -391.74242097115416, -1264.805319356825, -959.6474938561171, -798.4250593957078, -831.0110031245925, -437.1133817849657, -763.0267766695106, -563.0577289151793, -546.4470888103436, -1100.079136414408, -517.3967538146196, -684.6859154027624, -893.6393460443707, -789.955151911287, -575.2301847628802, -642.4043922466298, -469.7713720859592, -1103.6267050896254, -832.9088887202608, -560.0298103152801, -914.7174592350212, -544.5638309839326, -815.022416278965, -611.9389605369848, -949.353625424887, -984.6556400009515, -696.0354490196511, -850.5998145896981, -612.314678042395, -761.5693908480316, -762.0242108081395, -913.8990176793252, -739.0573346696534, -973.6543863618886, -853.885512123146, -685.9431800648692, -628.8443831481497, -793.2244754853593, -938.036210409312, -731.0213689932796, -668.91402419103, -775.9799250886979, -918.1219868557534, -779.0636381600455, -740.7445417489905, -627.7987635176951, -846.1734392201507, -1026.1366211636464, -991.1075168066791, -1158.6117929321103, -634.4079835977203, -1086.3997778712767, -848.3363745671835, -609.985177244056, -568.0533195590792, -931.8836352696122, -834.8408105474897, -925.5155738552007, -785.2826896370813, -908.2995469991157, -856.9118320764713, -480.97023180184084, -965.3187054622128, -526.9204647026459, -656.5994837806566, -471.29863448125815, -672.0187467705181, -710.4506096922596, -544.7325533024848, -763.2048804132796, -739.7691311269479, -824.1495719536343, -710.0983954664807, -569.4301622090443, -620.4315233941855, -970.0045234328868, -1067.8928525654064, -816.8554156838703, -780.1341603915353, -1054.5756392399649, -987.8104741172193, -826.7266489458918, -770.713468373902, -783.5125671089766, -642.5416510676502, -655.1582886824842, -620.6881366171439, -815.8500809726518, -758.4323431547602], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.396579056129294, "mean_inference_ms": 0.41340268915644046, "mean_action_processing_ms": 0.09733321526540738, "mean_env_wait_ms": 2.7277090123793664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037202835083007812, "StateBufferConnector_ms": 0.002794027328491211, "ViewRequirementAgentConnector_ms": 0.06934046745300293}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280800, "num_agent_steps_trained": 280800, "num_env_steps_sampled": 280800, "num_env_steps_trained": 280800, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.40949471897372, "num_env_steps_trained_throughput_per_sec": 39.40949471897372, "timesteps_total": 280800, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 280800, "timers": {"training_iteration_time_ms": 3001.298, "sample_time_ms": 2997.514, "load_time_ms": 0.218, "load_throughput": 550795.01, "learn_time_ms": 2.833, "learn_throughput": 42356.011, "synch_weights_time_ms": 0.693}, "counters": {"num_env_steps_sampled": 280800, "num_env_steps_trained": 280800, "num_agent_steps_sampled": 280800, "num_agent_steps_trained": 280800}, "done": false, "episodes_total": 2340, "training_iteration": 586, "trial_id": "53665_00000", "date": "2023-07-26_03-46-10", "timestamp": 1690332370, "time_this_iter_s": 12.182621240615845, "time_total_s": 7109.746307611465, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1488.4208316802979, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 35.470588235294116, "ram_util_percent": 73.51176470588236}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4753112792969, "policy_loss": -101286.3046875, "vf_loss": 4914740.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 506.0, "diff_num_grad_updates_vs_sampler_policy": 505.0}}, "num_env_steps_sampled": 281280, "num_env_steps_trained": 281280, "num_agent_steps_sampled": 281280, "num_agent_steps_trained": 281280}, "sampler_results": {"episode_reward_max": -391.74242097115416, "episode_reward_min": -1264.805319356825, "episode_reward_mean": -777.753103074626, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-836.2556057298376, -702.89886243886, -674.3364089798628, -586.4189195271406, -957.5296487521726, -910.3520816700877, -893.4379223305275, -391.74242097115416, -1264.805319356825, -959.6474938561171, -798.4250593957078, -831.0110031245925, -437.1133817849657, -763.0267766695106, -563.0577289151793, -546.4470888103436, -1100.079136414408, -517.3967538146196, -684.6859154027624, -893.6393460443707, -789.955151911287, -575.2301847628802, -642.4043922466298, -469.7713720859592, -1103.6267050896254, -832.9088887202608, -560.0298103152801, -914.7174592350212, -544.5638309839326, -815.022416278965, -611.9389605369848, -949.353625424887, -984.6556400009515, -696.0354490196511, -850.5998145896981, -612.314678042395, -761.5693908480316, -762.0242108081395, -913.8990176793252, -739.0573346696534, -973.6543863618886, -853.885512123146, -685.9431800648692, -628.8443831481497, -793.2244754853593, -938.036210409312, -731.0213689932796, -668.91402419103, -775.9799250886979, -918.1219868557534, -779.0636381600455, -740.7445417489905, -627.7987635176951, -846.1734392201507, -1026.1366211636464, -991.1075168066791, -1158.6117929321103, -634.4079835977203, -1086.3997778712767, -848.3363745671835, -609.985177244056, -568.0533195590792, -931.8836352696122, -834.8408105474897, -925.5155738552007, -785.2826896370813, -908.2995469991157, -856.9118320764713, -480.97023180184084, -965.3187054622128, -526.9204647026459, -656.5994837806566, -471.29863448125815, -672.0187467705181, -710.4506096922596, -544.7325533024848, -763.2048804132796, -739.7691311269479, -824.1495719536343, -710.0983954664807, -569.4301622090443, -620.4315233941855, -970.0045234328868, -1067.8928525654064, -816.8554156838703, -780.1341603915353, -1054.5756392399649, -987.8104741172193, -826.7266489458918, -770.713468373902, -783.5125671089766, -642.5416510676502, -655.1582886824842, -620.6881366171439, -815.8500809726518, -758.4323431547602, -846.4322126456299, -694.6635463339022, -1107.573231941316, -751.1882768962611], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.39513501165433, "mean_inference_ms": 0.4132652974149336, "mean_action_processing_ms": 0.09731158643975331, "mean_env_wait_ms": 2.7271673999181725, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037207603454589844, "StateBufferConnector_ms": 0.002795696258544922, "ViewRequirementAgentConnector_ms": 0.06935286521911621}}, "episode_reward_max": -391.74242097115416, "episode_reward_min": -1264.805319356825, "episode_reward_mean": -777.753103074626, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-836.2556057298376, -702.89886243886, -674.3364089798628, -586.4189195271406, -957.5296487521726, -910.3520816700877, -893.4379223305275, -391.74242097115416, -1264.805319356825, -959.6474938561171, -798.4250593957078, -831.0110031245925, -437.1133817849657, -763.0267766695106, -563.0577289151793, -546.4470888103436, -1100.079136414408, -517.3967538146196, -684.6859154027624, -893.6393460443707, -789.955151911287, -575.2301847628802, -642.4043922466298, -469.7713720859592, -1103.6267050896254, -832.9088887202608, -560.0298103152801, -914.7174592350212, -544.5638309839326, -815.022416278965, -611.9389605369848, -949.353625424887, -984.6556400009515, -696.0354490196511, -850.5998145896981, -612.314678042395, -761.5693908480316, -762.0242108081395, -913.8990176793252, -739.0573346696534, -973.6543863618886, -853.885512123146, -685.9431800648692, -628.8443831481497, -793.2244754853593, -938.036210409312, -731.0213689932796, -668.91402419103, -775.9799250886979, -918.1219868557534, -779.0636381600455, -740.7445417489905, -627.7987635176951, -846.1734392201507, -1026.1366211636464, -991.1075168066791, -1158.6117929321103, -634.4079835977203, -1086.3997778712767, -848.3363745671835, -609.985177244056, -568.0533195590792, -931.8836352696122, -834.8408105474897, -925.5155738552007, -785.2826896370813, -908.2995469991157, -856.9118320764713, -480.97023180184084, -965.3187054622128, -526.9204647026459, -656.5994837806566, -471.29863448125815, -672.0187467705181, -710.4506096922596, -544.7325533024848, -763.2048804132796, -739.7691311269479, -824.1495719536343, -710.0983954664807, -569.4301622090443, -620.4315233941855, -970.0045234328868, -1067.8928525654064, -816.8554156838703, -780.1341603915353, -1054.5756392399649, -987.8104741172193, -826.7266489458918, -770.713468373902, -783.5125671089766, -642.5416510676502, -655.1582886824842, -620.6881366171439, -815.8500809726518, -758.4323431547602, -846.4322126456299, -694.6635463339022, -1107.573231941316, -751.1882768962611], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.39513501165433, "mean_inference_ms": 0.4132652974149336, "mean_action_processing_ms": 0.09731158643975331, "mean_env_wait_ms": 2.7271673999181725, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037207603454589844, "StateBufferConnector_ms": 0.002795696258544922, "ViewRequirementAgentConnector_ms": 0.06935286521911621}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 281280, "num_agent_steps_trained": 281280, "num_env_steps_sampled": 281280, "num_env_steps_trained": 281280, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.62613380381364, "num_env_steps_trained_throughput_per_sec": 39.62613380381364, "timesteps_total": 281280, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 281280, "timers": {"training_iteration_time_ms": 3022.598, "sample_time_ms": 3018.869, "load_time_ms": 0.216, "load_throughput": 555046.846, "learn_time_ms": 2.784, "learn_throughput": 43096.961, "synch_weights_time_ms": 0.688}, "counters": {"num_env_steps_sampled": 281280, "num_env_steps_trained": 281280, "num_agent_steps_sampled": 281280, "num_agent_steps_trained": 281280}, "done": false, "episodes_total": 2344, "training_iteration": 587, "trial_id": "53665_00000", "date": "2023-07-26_03-46-22", "timestamp": 1690332382, "time_this_iter_s": 12.115952014923096, "time_total_s": 7121.862259626389, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1500.536783695221, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 37.12941176470588, "ram_util_percent": 74.10588235294118}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4550476074219, "policy_loss": -81460.875, "vf_loss": 2815553.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 510.0, "diff_num_grad_updates_vs_sampler_policy": 509.0}}, "num_env_steps_sampled": 281760, "num_env_steps_trained": 281760, "num_agent_steps_sampled": 281760, "num_agent_steps_trained": 281760}, "sampler_results": {"episode_reward_max": -391.74242097115416, "episode_reward_min": -1264.805319356825, "episode_reward_mean": -771.8420948939452, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-957.5296487521726, -910.3520816700877, -893.4379223305275, -391.74242097115416, -1264.805319356825, -959.6474938561171, -798.4250593957078, -831.0110031245925, -437.1133817849657, -763.0267766695106, -563.0577289151793, -546.4470888103436, -1100.079136414408, -517.3967538146196, -684.6859154027624, -893.6393460443707, -789.955151911287, -575.2301847628802, -642.4043922466298, -469.7713720859592, -1103.6267050896254, -832.9088887202608, -560.0298103152801, -914.7174592350212, -544.5638309839326, -815.022416278965, -611.9389605369848, -949.353625424887, -984.6556400009515, -696.0354490196511, -850.5998145896981, -612.314678042395, -761.5693908480316, -762.0242108081395, -913.8990176793252, -739.0573346696534, -973.6543863618886, -853.885512123146, -685.9431800648692, -628.8443831481497, -793.2244754853593, -938.036210409312, -731.0213689932796, -668.91402419103, -775.9799250886979, -918.1219868557534, -779.0636381600455, -740.7445417489905, -627.7987635176951, -846.1734392201507, -1026.1366211636464, -991.1075168066791, -1158.6117929321103, -634.4079835977203, -1086.3997778712767, -848.3363745671835, -609.985177244056, -568.0533195590792, -931.8836352696122, -834.8408105474897, -925.5155738552007, -785.2826896370813, -908.2995469991157, -856.9118320764713, -480.97023180184084, -965.3187054622128, -526.9204647026459, -656.5994837806566, -471.29863448125815, -672.0187467705181, -710.4506096922596, -544.7325533024848, -763.2048804132796, -739.7691311269479, -824.1495719536343, -710.0983954664807, -569.4301622090443, -620.4315233941855, -970.0045234328868, -1067.8928525654064, -816.8554156838703, -780.1341603915353, -1054.5756392399649, -987.8104741172193, -826.7266489458918, -770.713468373902, -783.5125671089766, -642.5416510676502, -655.1582886824842, -620.6881366171439, -815.8500809726518, -758.4323431547602, -846.4322126456299, -694.6635463339022, -1107.573231941316, -751.1882768962611, -416.1501239530031, -467.050600291204, -720.3908557310855, -605.2173986323484], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.393523943948693, "mean_inference_ms": 0.41312979817284345, "mean_action_processing_ms": 0.09729037358911242, "mean_env_wait_ms": 2.7266304038201885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003724336624145508, "StateBufferConnector_ms": 0.002796649932861328, "ViewRequirementAgentConnector_ms": 0.06939959526062012}}, "episode_reward_max": -391.74242097115416, "episode_reward_min": -1264.805319356825, "episode_reward_mean": -771.8420948939452, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-957.5296487521726, -910.3520816700877, -893.4379223305275, -391.74242097115416, -1264.805319356825, -959.6474938561171, -798.4250593957078, -831.0110031245925, -437.1133817849657, -763.0267766695106, -563.0577289151793, -546.4470888103436, -1100.079136414408, -517.3967538146196, -684.6859154027624, -893.6393460443707, -789.955151911287, -575.2301847628802, -642.4043922466298, -469.7713720859592, -1103.6267050896254, -832.9088887202608, -560.0298103152801, -914.7174592350212, -544.5638309839326, -815.022416278965, -611.9389605369848, -949.353625424887, -984.6556400009515, -696.0354490196511, -850.5998145896981, -612.314678042395, -761.5693908480316, -762.0242108081395, -913.8990176793252, -739.0573346696534, -973.6543863618886, -853.885512123146, -685.9431800648692, -628.8443831481497, -793.2244754853593, -938.036210409312, -731.0213689932796, -668.91402419103, -775.9799250886979, -918.1219868557534, -779.0636381600455, -740.7445417489905, -627.7987635176951, -846.1734392201507, -1026.1366211636464, -991.1075168066791, -1158.6117929321103, -634.4079835977203, -1086.3997778712767, -848.3363745671835, -609.985177244056, -568.0533195590792, -931.8836352696122, -834.8408105474897, -925.5155738552007, -785.2826896370813, -908.2995469991157, -856.9118320764713, -480.97023180184084, -965.3187054622128, -526.9204647026459, -656.5994837806566, -471.29863448125815, -672.0187467705181, -710.4506096922596, -544.7325533024848, -763.2048804132796, -739.7691311269479, -824.1495719536343, -710.0983954664807, -569.4301622090443, -620.4315233941855, -970.0045234328868, -1067.8928525654064, -816.8554156838703, -780.1341603915353, -1054.5756392399649, -987.8104741172193, -826.7266489458918, -770.713468373902, -783.5125671089766, -642.5416510676502, -655.1582886824842, -620.6881366171439, -815.8500809726518, -758.4323431547602, -846.4322126456299, -694.6635463339022, -1107.573231941316, -751.1882768962611, -416.1501239530031, -467.050600291204, -720.3908557310855, -605.2173986323484], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.393523943948693, "mean_inference_ms": 0.41312979817284345, "mean_action_processing_ms": 0.09729037358911242, "mean_env_wait_ms": 2.7266304038201885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003724336624145508, "StateBufferConnector_ms": 0.002796649932861328, "ViewRequirementAgentConnector_ms": 0.06939959526062012}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 281760, "num_agent_steps_trained": 281760, "num_env_steps_sampled": 281760, "num_env_steps_trained": 281760, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.33282880957405, "num_env_steps_trained_throughput_per_sec": 41.33282880957405, "timesteps_total": 281760, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 281760, "timers": {"training_iteration_time_ms": 2978.298, "sample_time_ms": 2974.549, "load_time_ms": 0.216, "load_throughput": 555843.711, "learn_time_ms": 2.796, "learn_throughput": 42921.288, "synch_weights_time_ms": 0.696}, "counters": {"num_env_steps_sampled": 281760, "num_env_steps_trained": 281760, "num_agent_steps_sampled": 281760, "num_agent_steps_trained": 281760}, "done": false, "episodes_total": 2348, "training_iteration": 588, "trial_id": "53665_00000", "date": "2023-07-26_03-46-34", "timestamp": 1690332394, "time_this_iter_s": 11.615776062011719, "time_total_s": 7133.4780356884, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1512.1525597572327, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 35.41764705882353, "ram_util_percent": 73.5235294117647}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-09, "entropy_coeff": 0.05, "policy_entropy": 267.48089599609375, "policy_loss": -81102.15625, "vf_loss": 3354510.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 514.0, "diff_num_grad_updates_vs_sampler_policy": 513.0}}, "num_env_steps_sampled": 282240, "num_env_steps_trained": 282240, "num_agent_steps_sampled": 282240, "num_agent_steps_trained": 282240}, "sampler_results": {"episode_reward_max": -416.1501239530031, "episode_reward_min": -1264.805319356825, "episode_reward_mean": -774.0343539784856, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1264.805319356825, -959.6474938561171, -798.4250593957078, -831.0110031245925, -437.1133817849657, -763.0267766695106, -563.0577289151793, -546.4470888103436, -1100.079136414408, -517.3967538146196, -684.6859154027624, -893.6393460443707, -789.955151911287, -575.2301847628802, -642.4043922466298, -469.7713720859592, -1103.6267050896254, -832.9088887202608, -560.0298103152801, -914.7174592350212, -544.5638309839326, -815.022416278965, -611.9389605369848, -949.353625424887, -984.6556400009515, -696.0354490196511, -850.5998145896981, -612.314678042395, -761.5693908480316, -762.0242108081395, -913.8990176793252, -739.0573346696534, -973.6543863618886, -853.885512123146, -685.9431800648692, -628.8443831481497, -793.2244754853593, -938.036210409312, -731.0213689932796, -668.91402419103, -775.9799250886979, -918.1219868557534, -779.0636381600455, -740.7445417489905, -627.7987635176951, -846.1734392201507, -1026.1366211636464, -991.1075168066791, -1158.6117929321103, -634.4079835977203, -1086.3997778712767, -848.3363745671835, -609.985177244056, -568.0533195590792, -931.8836352696122, -834.8408105474897, -925.5155738552007, -785.2826896370813, -908.2995469991157, -856.9118320764713, -480.97023180184084, -965.3187054622128, -526.9204647026459, -656.5994837806566, -471.29863448125815, -672.0187467705181, -710.4506096922596, -544.7325533024848, -763.2048804132796, -739.7691311269479, -824.1495719536343, -710.0983954664807, -569.4301622090443, -620.4315233941855, -970.0045234328868, -1067.8928525654064, -816.8554156838703, -780.1341603915353, -1054.5756392399649, -987.8104741172193, -826.7266489458918, -770.713468373902, -783.5125671089766, -642.5416510676502, -655.1582886824842, -620.6881366171439, -815.8500809726518, -758.4323431547602, -846.4322126456299, -694.6635463339022, -1107.573231941316, -751.1882768962611, -416.1501239530031, -467.050600291204, -720.3908557310855, -605.2173986323484, -1068.5916564180015, -874.2986752925311, -738.1516152379985, -691.2460352294241], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.39188224933814, "mean_inference_ms": 0.4129934514082134, "mean_action_processing_ms": 0.09726894798798465, "mean_env_wait_ms": 2.726062369561307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003726482391357422, "StateBufferConnector_ms": 0.0028014183044433594, "ViewRequirementAgentConnector_ms": 0.06950736045837402}}, "episode_reward_max": -416.1501239530031, "episode_reward_min": -1264.805319356825, "episode_reward_mean": -774.0343539784856, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1264.805319356825, -959.6474938561171, -798.4250593957078, -831.0110031245925, -437.1133817849657, -763.0267766695106, -563.0577289151793, -546.4470888103436, -1100.079136414408, -517.3967538146196, -684.6859154027624, -893.6393460443707, -789.955151911287, -575.2301847628802, -642.4043922466298, -469.7713720859592, -1103.6267050896254, -832.9088887202608, -560.0298103152801, -914.7174592350212, -544.5638309839326, -815.022416278965, -611.9389605369848, -949.353625424887, -984.6556400009515, -696.0354490196511, -850.5998145896981, -612.314678042395, -761.5693908480316, -762.0242108081395, -913.8990176793252, -739.0573346696534, -973.6543863618886, -853.885512123146, -685.9431800648692, -628.8443831481497, -793.2244754853593, -938.036210409312, -731.0213689932796, -668.91402419103, -775.9799250886979, -918.1219868557534, -779.0636381600455, -740.7445417489905, -627.7987635176951, -846.1734392201507, -1026.1366211636464, -991.1075168066791, -1158.6117929321103, -634.4079835977203, -1086.3997778712767, -848.3363745671835, -609.985177244056, -568.0533195590792, -931.8836352696122, -834.8408105474897, -925.5155738552007, -785.2826896370813, -908.2995469991157, -856.9118320764713, -480.97023180184084, -965.3187054622128, -526.9204647026459, -656.5994837806566, -471.29863448125815, -672.0187467705181, -710.4506096922596, -544.7325533024848, -763.2048804132796, -739.7691311269479, -824.1495719536343, -710.0983954664807, -569.4301622090443, -620.4315233941855, -970.0045234328868, -1067.8928525654064, -816.8554156838703, -780.1341603915353, -1054.5756392399649, -987.8104741172193, -826.7266489458918, -770.713468373902, -783.5125671089766, -642.5416510676502, -655.1582886824842, -620.6881366171439, -815.8500809726518, -758.4323431547602, -846.4322126456299, -694.6635463339022, -1107.573231941316, -751.1882768962611, -416.1501239530031, -467.050600291204, -720.3908557310855, -605.2173986323484, -1068.5916564180015, -874.2986752925311, -738.1516152379985, -691.2460352294241], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.39188224933814, "mean_inference_ms": 0.4129934514082134, "mean_action_processing_ms": 0.09726894798798465, "mean_env_wait_ms": 2.726062369561307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003726482391357422, "StateBufferConnector_ms": 0.0028014183044433594, "ViewRequirementAgentConnector_ms": 0.06950736045837402}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 282240, "num_agent_steps_trained": 282240, "num_env_steps_sampled": 282240, "num_env_steps_trained": 282240, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.55318884792025, "num_env_steps_trained_throughput_per_sec": 41.55318884792025, "timesteps_total": 282240, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 282240, "timers": {"training_iteration_time_ms": 2942.059, "sample_time_ms": 2938.318, "load_time_ms": 0.217, "load_throughput": 554252.263, "learn_time_ms": 2.789, "learn_throughput": 43026.225, "synch_weights_time_ms": 0.696}, "counters": {"num_env_steps_sampled": 282240, "num_env_steps_trained": 282240, "num_agent_steps_sampled": 282240, "num_agent_steps_trained": 282240}, "done": false, "episodes_total": 2352, "training_iteration": 589, "trial_id": "53665_00000", "date": "2023-07-26_03-46-46", "timestamp": 1690332406, "time_this_iter_s": 11.554147005081177, "time_total_s": 7145.032182693481, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1523.7067067623138, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 35.35625, "ram_util_percent": 73.7125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-09, "entropy_coeff": 0.05, "policy_entropy": 267.48358154296875, "policy_loss": -72860.4296875, "vf_loss": 2817685.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 518.0, "diff_num_grad_updates_vs_sampler_policy": 517.0}}, "num_env_steps_sampled": 282720, "num_env_steps_trained": 282720, "num_agent_steps_sampled": 282720, "num_agent_steps_trained": 282720}, "sampler_results": {"episode_reward_max": -416.1501239530031, "episode_reward_min": -1158.6117929321103, "episode_reward_mean": -765.0885692597681, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-437.1133817849657, -763.0267766695106, -563.0577289151793, -546.4470888103436, -1100.079136414408, -517.3967538146196, -684.6859154027624, -893.6393460443707, -789.955151911287, -575.2301847628802, -642.4043922466298, -469.7713720859592, -1103.6267050896254, -832.9088887202608, -560.0298103152801, -914.7174592350212, -544.5638309839326, -815.022416278965, -611.9389605369848, -949.353625424887, -984.6556400009515, -696.0354490196511, -850.5998145896981, -612.314678042395, -761.5693908480316, -762.0242108081395, -913.8990176793252, -739.0573346696534, -973.6543863618886, -853.885512123146, -685.9431800648692, -628.8443831481497, -793.2244754853593, -938.036210409312, -731.0213689932796, -668.91402419103, -775.9799250886979, -918.1219868557534, -779.0636381600455, -740.7445417489905, -627.7987635176951, -846.1734392201507, -1026.1366211636464, -991.1075168066791, -1158.6117929321103, -634.4079835977203, -1086.3997778712767, -848.3363745671835, -609.985177244056, -568.0533195590792, -931.8836352696122, -834.8408105474897, -925.5155738552007, -785.2826896370813, -908.2995469991157, -856.9118320764713, -480.97023180184084, -965.3187054622128, -526.9204647026459, -656.5994837806566, -471.29863448125815, -672.0187467705181, -710.4506096922596, -544.7325533024848, -763.2048804132796, -739.7691311269479, -824.1495719536343, -710.0983954664807, -569.4301622090443, -620.4315233941855, -970.0045234328868, -1067.8928525654064, -816.8554156838703, -780.1341603915353, -1054.5756392399649, -987.8104741172193, -826.7266489458918, -770.713468373902, -783.5125671089766, -642.5416510676502, -655.1582886824842, -620.6881366171439, -815.8500809726518, -758.4323431547602, -846.4322126456299, -694.6635463339022, -1107.573231941316, -751.1882768962611, -416.1501239530031, -467.050600291204, -720.3908557310855, -605.2173986323484, -1068.5916564180015, -874.2986752925311, -738.1516152379985, -691.2460352294241, -801.3893431102525, -716.4853136285915, -825.6934677850077, -615.7422793376439], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.39054113918899, "mean_inference_ms": 0.4128587785011193, "mean_action_processing_ms": 0.09724777586668704, "mean_env_wait_ms": 2.725506018758111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037240982055664062, "StateBufferConnector_ms": 0.0028018951416015625, "ViewRequirementAgentConnector_ms": 0.06952738761901855}}, "episode_reward_max": -416.1501239530031, "episode_reward_min": -1158.6117929321103, "episode_reward_mean": -765.0885692597681, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-437.1133817849657, -763.0267766695106, -563.0577289151793, -546.4470888103436, -1100.079136414408, -517.3967538146196, -684.6859154027624, -893.6393460443707, -789.955151911287, -575.2301847628802, -642.4043922466298, -469.7713720859592, -1103.6267050896254, -832.9088887202608, -560.0298103152801, -914.7174592350212, -544.5638309839326, -815.022416278965, -611.9389605369848, -949.353625424887, -984.6556400009515, -696.0354490196511, -850.5998145896981, -612.314678042395, -761.5693908480316, -762.0242108081395, -913.8990176793252, -739.0573346696534, -973.6543863618886, -853.885512123146, -685.9431800648692, -628.8443831481497, -793.2244754853593, -938.036210409312, -731.0213689932796, -668.91402419103, -775.9799250886979, -918.1219868557534, -779.0636381600455, -740.7445417489905, -627.7987635176951, -846.1734392201507, -1026.1366211636464, -991.1075168066791, -1158.6117929321103, -634.4079835977203, -1086.3997778712767, -848.3363745671835, -609.985177244056, -568.0533195590792, -931.8836352696122, -834.8408105474897, -925.5155738552007, -785.2826896370813, -908.2995469991157, -856.9118320764713, -480.97023180184084, -965.3187054622128, -526.9204647026459, -656.5994837806566, -471.29863448125815, -672.0187467705181, -710.4506096922596, -544.7325533024848, -763.2048804132796, -739.7691311269479, -824.1495719536343, -710.0983954664807, -569.4301622090443, -620.4315233941855, -970.0045234328868, -1067.8928525654064, -816.8554156838703, -780.1341603915353, -1054.5756392399649, -987.8104741172193, -826.7266489458918, -770.713468373902, -783.5125671089766, -642.5416510676502, -655.1582886824842, -620.6881366171439, -815.8500809726518, -758.4323431547602, -846.4322126456299, -694.6635463339022, -1107.573231941316, -751.1882768962611, -416.1501239530031, -467.050600291204, -720.3908557310855, -605.2173986323484, -1068.5916564180015, -874.2986752925311, -738.1516152379985, -691.2460352294241, -801.3893431102525, -716.4853136285915, -825.6934677850077, -615.7422793376439], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.39054113918899, "mean_inference_ms": 0.4128587785011193, "mean_action_processing_ms": 0.09724777586668704, "mean_env_wait_ms": 2.725506018758111, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037240982055664062, "StateBufferConnector_ms": 0.0028018951416015625, "ViewRequirementAgentConnector_ms": 0.06952738761901855}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 282720, "num_agent_steps_trained": 282720, "num_env_steps_sampled": 282720, "num_env_steps_trained": 282720, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.8668191293647, "num_env_steps_trained_throughput_per_sec": 40.8668191293647, "timesteps_total": 282720, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 282720, "timers": {"training_iteration_time_ms": 2916.962, "sample_time_ms": 2913.243, "load_time_ms": 0.215, "load_throughput": 558062.402, "learn_time_ms": 2.777, "learn_throughput": 43215.744, "synch_weights_time_ms": 0.687}, "counters": {"num_env_steps_sampled": 282720, "num_env_steps_trained": 282720, "num_agent_steps_sampled": 282720, "num_agent_steps_trained": 282720}, "done": false, "episodes_total": 2356, "training_iteration": 590, "trial_id": "53665_00000", "date": "2023-07-26_03-46-57", "timestamp": 1690332417, "time_this_iter_s": 11.74816107749939, "time_total_s": 7156.780343770981, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1535.4548678398132, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 36.92352941176471, "ram_util_percent": 73.71764705882352}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-09, "entropy_coeff": 0.05, "policy_entropy": 267.47015380859375, "policy_loss": -75496.9609375, "vf_loss": 2485059.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 522.0, "diff_num_grad_updates_vs_sampler_policy": 521.0}}, "num_env_steps_sampled": 283200, "num_env_steps_trained": 283200, "num_agent_steps_sampled": 283200, "num_agent_steps_trained": 283200}, "sampler_results": {"episode_reward_max": -416.1501239530031, "episode_reward_min": -1158.6117929321103, "episode_reward_mean": -770.0483072551293, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1100.079136414408, -517.3967538146196, -684.6859154027624, -893.6393460443707, -789.955151911287, -575.2301847628802, -642.4043922466298, -469.7713720859592, -1103.6267050896254, -832.9088887202608, -560.0298103152801, -914.7174592350212, -544.5638309839326, -815.022416278965, -611.9389605369848, -949.353625424887, -984.6556400009515, -696.0354490196511, -850.5998145896981, -612.314678042395, -761.5693908480316, -762.0242108081395, -913.8990176793252, -739.0573346696534, -973.6543863618886, -853.885512123146, -685.9431800648692, -628.8443831481497, -793.2244754853593, -938.036210409312, -731.0213689932796, -668.91402419103, -775.9799250886979, -918.1219868557534, -779.0636381600455, -740.7445417489905, -627.7987635176951, -846.1734392201507, -1026.1366211636464, -991.1075168066791, -1158.6117929321103, -634.4079835977203, -1086.3997778712767, -848.3363745671835, -609.985177244056, -568.0533195590792, -931.8836352696122, -834.8408105474897, -925.5155738552007, -785.2826896370813, -908.2995469991157, -856.9118320764713, -480.97023180184084, -965.3187054622128, -526.9204647026459, -656.5994837806566, -471.29863448125815, -672.0187467705181, -710.4506096922596, -544.7325533024848, -763.2048804132796, -739.7691311269479, -824.1495719536343, -710.0983954664807, -569.4301622090443, -620.4315233941855, -970.0045234328868, -1067.8928525654064, -816.8554156838703, -780.1341603915353, -1054.5756392399649, -987.8104741172193, -826.7266489458918, -770.713468373902, -783.5125671089766, -642.5416510676502, -655.1582886824842, -620.6881366171439, -815.8500809726518, -758.4323431547602, -846.4322126456299, -694.6635463339022, -1107.573231941316, -751.1882768962611, -416.1501239530031, -467.050600291204, -720.3908557310855, -605.2173986323484, -1068.5916564180015, -874.2986752925311, -738.1516152379985, -691.2460352294241, -801.3893431102525, -716.4853136285915, -825.6934677850077, -615.7422793376439, -694.2164562904486, -891.9545078165829, -666.6104380247511, -552.8373735843545], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.389361337727586, "mean_inference_ms": 0.41272049351586815, "mean_action_processing_ms": 0.09722584350728553, "mean_env_wait_ms": 2.7250005517548437, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037152767181396484, "StateBufferConnector_ms": 0.002803802490234375, "ViewRequirementAgentConnector_ms": 0.06952977180480957}}, "episode_reward_max": -416.1501239530031, "episode_reward_min": -1158.6117929321103, "episode_reward_mean": -770.0483072551293, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1100.079136414408, -517.3967538146196, -684.6859154027624, -893.6393460443707, -789.955151911287, -575.2301847628802, -642.4043922466298, -469.7713720859592, -1103.6267050896254, -832.9088887202608, -560.0298103152801, -914.7174592350212, -544.5638309839326, -815.022416278965, -611.9389605369848, -949.353625424887, -984.6556400009515, -696.0354490196511, -850.5998145896981, -612.314678042395, -761.5693908480316, -762.0242108081395, -913.8990176793252, -739.0573346696534, -973.6543863618886, -853.885512123146, -685.9431800648692, -628.8443831481497, -793.2244754853593, -938.036210409312, -731.0213689932796, -668.91402419103, -775.9799250886979, -918.1219868557534, -779.0636381600455, -740.7445417489905, -627.7987635176951, -846.1734392201507, -1026.1366211636464, -991.1075168066791, -1158.6117929321103, -634.4079835977203, -1086.3997778712767, -848.3363745671835, -609.985177244056, -568.0533195590792, -931.8836352696122, -834.8408105474897, -925.5155738552007, -785.2826896370813, -908.2995469991157, -856.9118320764713, -480.97023180184084, -965.3187054622128, -526.9204647026459, -656.5994837806566, -471.29863448125815, -672.0187467705181, -710.4506096922596, -544.7325533024848, -763.2048804132796, -739.7691311269479, -824.1495719536343, -710.0983954664807, -569.4301622090443, -620.4315233941855, -970.0045234328868, -1067.8928525654064, -816.8554156838703, -780.1341603915353, -1054.5756392399649, -987.8104741172193, -826.7266489458918, -770.713468373902, -783.5125671089766, -642.5416510676502, -655.1582886824842, -620.6881366171439, -815.8500809726518, -758.4323431547602, -846.4322126456299, -694.6635463339022, -1107.573231941316, -751.1882768962611, -416.1501239530031, -467.050600291204, -720.3908557310855, -605.2173986323484, -1068.5916564180015, -874.2986752925311, -738.1516152379985, -691.2460352294241, -801.3893431102525, -716.4853136285915, -825.6934677850077, -615.7422793376439, -694.2164562904486, -891.9545078165829, -666.6104380247511, -552.8373735843545], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.389361337727586, "mean_inference_ms": 0.41272049351586815, "mean_action_processing_ms": 0.09722584350728553, "mean_env_wait_ms": 2.7250005517548437, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037152767181396484, "StateBufferConnector_ms": 0.002803802490234375, "ViewRequirementAgentConnector_ms": 0.06952977180480957}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 283200, "num_agent_steps_trained": 283200, "num_env_steps_sampled": 283200, "num_env_steps_trained": 283200, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.65886777889223, "num_env_steps_trained_throughput_per_sec": 40.65886777889223, "timesteps_total": 283200, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 283200, "timers": {"training_iteration_time_ms": 2932.003, "sample_time_ms": 2928.291, "load_time_ms": 0.215, "load_throughput": 558124.285, "learn_time_ms": 2.771, "learn_throughput": 43299.021, "synch_weights_time_ms": 0.685}, "counters": {"num_env_steps_sampled": 283200, "num_env_steps_trained": 283200, "num_agent_steps_sampled": 283200, "num_agent_steps_trained": 283200}, "done": false, "episodes_total": 2360, "training_iteration": 591, "trial_id": "53665_00000", "date": "2023-07-26_03-47-09", "timestamp": 1690332429, "time_this_iter_s": 11.808258771896362, "time_total_s": 7168.588602542877, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1547.2631266117096, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 37.85294117647059, "ram_util_percent": 73.81176470588237}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4720764160156, "policy_loss": -52925.921875, "vf_loss": 1270864.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 526.0, "diff_num_grad_updates_vs_sampler_policy": 525.0}}, "num_env_steps_sampled": 283680, "num_env_steps_trained": 283680, "num_agent_steps_sampled": 283680, "num_agent_steps_trained": 283680}, "sampler_results": {"episode_reward_max": -308.28382301090573, "episode_reward_min": -1158.6117929321103, "episode_reward_mean": -761.7362367554193, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-789.955151911287, -575.2301847628802, -642.4043922466298, -469.7713720859592, -1103.6267050896254, -832.9088887202608, -560.0298103152801, -914.7174592350212, -544.5638309839326, -815.022416278965, -611.9389605369848, -949.353625424887, -984.6556400009515, -696.0354490196511, -850.5998145896981, -612.314678042395, -761.5693908480316, -762.0242108081395, -913.8990176793252, -739.0573346696534, -973.6543863618886, -853.885512123146, -685.9431800648692, -628.8443831481497, -793.2244754853593, -938.036210409312, -731.0213689932796, -668.91402419103, -775.9799250886979, -918.1219868557534, -779.0636381600455, -740.7445417489905, -627.7987635176951, -846.1734392201507, -1026.1366211636464, -991.1075168066791, -1158.6117929321103, -634.4079835977203, -1086.3997778712767, -848.3363745671835, -609.985177244056, -568.0533195590792, -931.8836352696122, -834.8408105474897, -925.5155738552007, -785.2826896370813, -908.2995469991157, -856.9118320764713, -480.97023180184084, -965.3187054622128, -526.9204647026459, -656.5994837806566, -471.29863448125815, -672.0187467705181, -710.4506096922596, -544.7325533024848, -763.2048804132796, -739.7691311269479, -824.1495719536343, -710.0983954664807, -569.4301622090443, -620.4315233941855, -970.0045234328868, -1067.8928525654064, -816.8554156838703, -780.1341603915353, -1054.5756392399649, -987.8104741172193, -826.7266489458918, -770.713468373902, -783.5125671089766, -642.5416510676502, -655.1582886824842, -620.6881366171439, -815.8500809726518, -758.4323431547602, -846.4322126456299, -694.6635463339022, -1107.573231941316, -751.1882768962611, -416.1501239530031, -467.050600291204, -720.3908557310855, -605.2173986323484, -1068.5916564180015, -874.2986752925311, -738.1516152379985, -691.2460352294241, -801.3893431102525, -716.4853136285915, -825.6934677850077, -615.7422793376439, -694.2164562904486, -891.9545078165829, -666.6104380247511, -552.8373735843545, -1112.823699856796, -519.9997425741633, -308.28382301090573, -423.48683626330006], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.388117181681956, "mean_inference_ms": 0.4125797145100366, "mean_action_processing_ms": 0.09720323884244937, "mean_env_wait_ms": 2.7244794412158972, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003690958023071289, "StateBufferConnector_ms": 0.002793550491333008, "ViewRequirementAgentConnector_ms": 0.06919002532958984}}, "episode_reward_max": -308.28382301090573, "episode_reward_min": -1158.6117929321103, "episode_reward_mean": -761.7362367554193, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-789.955151911287, -575.2301847628802, -642.4043922466298, -469.7713720859592, -1103.6267050896254, -832.9088887202608, -560.0298103152801, -914.7174592350212, -544.5638309839326, -815.022416278965, -611.9389605369848, -949.353625424887, -984.6556400009515, -696.0354490196511, -850.5998145896981, -612.314678042395, -761.5693908480316, -762.0242108081395, -913.8990176793252, -739.0573346696534, -973.6543863618886, -853.885512123146, -685.9431800648692, -628.8443831481497, -793.2244754853593, -938.036210409312, -731.0213689932796, -668.91402419103, -775.9799250886979, -918.1219868557534, -779.0636381600455, -740.7445417489905, -627.7987635176951, -846.1734392201507, -1026.1366211636464, -991.1075168066791, -1158.6117929321103, -634.4079835977203, -1086.3997778712767, -848.3363745671835, -609.985177244056, -568.0533195590792, -931.8836352696122, -834.8408105474897, -925.5155738552007, -785.2826896370813, -908.2995469991157, -856.9118320764713, -480.97023180184084, -965.3187054622128, -526.9204647026459, -656.5994837806566, -471.29863448125815, -672.0187467705181, -710.4506096922596, -544.7325533024848, -763.2048804132796, -739.7691311269479, -824.1495719536343, -710.0983954664807, -569.4301622090443, -620.4315233941855, -970.0045234328868, -1067.8928525654064, -816.8554156838703, -780.1341603915353, -1054.5756392399649, -987.8104741172193, -826.7266489458918, -770.713468373902, -783.5125671089766, -642.5416510676502, -655.1582886824842, -620.6881366171439, -815.8500809726518, -758.4323431547602, -846.4322126456299, -694.6635463339022, -1107.573231941316, -751.1882768962611, -416.1501239530031, -467.050600291204, -720.3908557310855, -605.2173986323484, -1068.5916564180015, -874.2986752925311, -738.1516152379985, -691.2460352294241, -801.3893431102525, -716.4853136285915, -825.6934677850077, -615.7422793376439, -694.2164562904486, -891.9545078165829, -666.6104380247511, -552.8373735843545, -1112.823699856796, -519.9997425741633, -308.28382301090573, -423.48683626330006], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.388117181681956, "mean_inference_ms": 0.4125797145100366, "mean_action_processing_ms": 0.09720323884244937, "mean_env_wait_ms": 2.7244794412158972, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003690958023071289, "StateBufferConnector_ms": 0.002793550491333008, "ViewRequirementAgentConnector_ms": 0.06919002532958984}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 283680, "num_agent_steps_trained": 283680, "num_env_steps_sampled": 283680, "num_env_steps_trained": 283680, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.80121110330219, "num_env_steps_trained_throughput_per_sec": 41.80121110330219, "timesteps_total": 283680, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 283680, "timers": {"training_iteration_time_ms": 2909.84, "sample_time_ms": 2906.12, "load_time_ms": 0.215, "load_throughput": 557197.476, "learn_time_ms": 2.778, "learn_throughput": 43200.165, "synch_weights_time_ms": 0.687}, "counters": {"num_env_steps_sampled": 283680, "num_env_steps_trained": 283680, "num_agent_steps_sampled": 283680, "num_agent_steps_trained": 283680}, "done": false, "episodes_total": 2364, "training_iteration": 592, "trial_id": "53665_00000", "date": "2023-07-26_03-47-21", "timestamp": 1690332441, "time_this_iter_s": 11.485543966293335, "time_total_s": 7180.0741465091705, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1558.748670578003, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 34.88125, "ram_util_percent": 72.71875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4787902832031, "policy_loss": -89455.6484375, "vf_loss": 3805449.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 530.0, "diff_num_grad_updates_vs_sampler_policy": 529.0}}, "num_env_steps_sampled": 284160, "num_env_steps_trained": 284160, "num_agent_steps_sampled": 284160, "num_agent_steps_trained": 284160}, "sampler_results": {"episode_reward_max": -308.28382301090573, "episode_reward_min": -1158.6117929321103, "episode_reward_mean": -758.3905047344931, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1103.6267050896254, -832.9088887202608, -560.0298103152801, -914.7174592350212, -544.5638309839326, -815.022416278965, -611.9389605369848, -949.353625424887, -984.6556400009515, -696.0354490196511, -850.5998145896981, -612.314678042395, -761.5693908480316, -762.0242108081395, -913.8990176793252, -739.0573346696534, -973.6543863618886, -853.885512123146, -685.9431800648692, -628.8443831481497, -793.2244754853593, -938.036210409312, -731.0213689932796, -668.91402419103, -775.9799250886979, -918.1219868557534, -779.0636381600455, -740.7445417489905, -627.7987635176951, -846.1734392201507, -1026.1366211636464, -991.1075168066791, -1158.6117929321103, -634.4079835977203, -1086.3997778712767, -848.3363745671835, -609.985177244056, -568.0533195590792, -931.8836352696122, -834.8408105474897, -925.5155738552007, -785.2826896370813, -908.2995469991157, -856.9118320764713, -480.97023180184084, -965.3187054622128, -526.9204647026459, -656.5994837806566, -471.29863448125815, -672.0187467705181, -710.4506096922596, -544.7325533024848, -763.2048804132796, -739.7691311269479, -824.1495719536343, -710.0983954664807, -569.4301622090443, -620.4315233941855, -970.0045234328868, -1067.8928525654064, -816.8554156838703, -780.1341603915353, -1054.5756392399649, -987.8104741172193, -826.7266489458918, -770.713468373902, -783.5125671089766, -642.5416510676502, -655.1582886824842, -620.6881366171439, -815.8500809726518, -758.4323431547602, -846.4322126456299, -694.6635463339022, -1107.573231941316, -751.1882768962611, -416.1501239530031, -467.050600291204, -720.3908557310855, -605.2173986323484, -1068.5916564180015, -874.2986752925311, -738.1516152379985, -691.2460352294241, -801.3893431102525, -716.4853136285915, -825.6934677850077, -615.7422793376439, -694.2164562904486, -891.9545078165829, -666.6104380247511, -552.8373735843545, -1112.823699856796, -519.9997425741633, -308.28382301090573, -423.48683626330006, -475.1921603230027, -570.2971677399692, -356.40798923950274, -740.8905816116494], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.38643195820413, "mean_inference_ms": 0.41242898652875937, "mean_action_processing_ms": 0.09717921881372175, "mean_env_wait_ms": 2.723932137133213, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036635398864746094, "StateBufferConnector_ms": 0.0027778148651123047, "ViewRequirementAgentConnector_ms": 0.06879782676696777}}, "episode_reward_max": -308.28382301090573, "episode_reward_min": -1158.6117929321103, "episode_reward_mean": -758.3905047344931, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1103.6267050896254, -832.9088887202608, -560.0298103152801, -914.7174592350212, -544.5638309839326, -815.022416278965, -611.9389605369848, -949.353625424887, -984.6556400009515, -696.0354490196511, -850.5998145896981, -612.314678042395, -761.5693908480316, -762.0242108081395, -913.8990176793252, -739.0573346696534, -973.6543863618886, -853.885512123146, -685.9431800648692, -628.8443831481497, -793.2244754853593, -938.036210409312, -731.0213689932796, -668.91402419103, -775.9799250886979, -918.1219868557534, -779.0636381600455, -740.7445417489905, -627.7987635176951, -846.1734392201507, -1026.1366211636464, -991.1075168066791, -1158.6117929321103, -634.4079835977203, -1086.3997778712767, -848.3363745671835, -609.985177244056, -568.0533195590792, -931.8836352696122, -834.8408105474897, -925.5155738552007, -785.2826896370813, -908.2995469991157, -856.9118320764713, -480.97023180184084, -965.3187054622128, -526.9204647026459, -656.5994837806566, -471.29863448125815, -672.0187467705181, -710.4506096922596, -544.7325533024848, -763.2048804132796, -739.7691311269479, -824.1495719536343, -710.0983954664807, -569.4301622090443, -620.4315233941855, -970.0045234328868, -1067.8928525654064, -816.8554156838703, -780.1341603915353, -1054.5756392399649, -987.8104741172193, -826.7266489458918, -770.713468373902, -783.5125671089766, -642.5416510676502, -655.1582886824842, -620.6881366171439, -815.8500809726518, -758.4323431547602, -846.4322126456299, -694.6635463339022, -1107.573231941316, -751.1882768962611, -416.1501239530031, -467.050600291204, -720.3908557310855, -605.2173986323484, -1068.5916564180015, -874.2986752925311, -738.1516152379985, -691.2460352294241, -801.3893431102525, -716.4853136285915, -825.6934677850077, -615.7422793376439, -694.2164562904486, -891.9545078165829, -666.6104380247511, -552.8373735843545, -1112.823699856796, -519.9997425741633, -308.28382301090573, -423.48683626330006, -475.1921603230027, -570.2971677399692, -356.40798923950274, -740.8905816116494], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.38643195820413, "mean_inference_ms": 0.41242898652875937, "mean_action_processing_ms": 0.09717921881372175, "mean_env_wait_ms": 2.723932137133213, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036635398864746094, "StateBufferConnector_ms": 0.0027778148651123047, "ViewRequirementAgentConnector_ms": 0.06879782676696777}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 284160, "num_agent_steps_trained": 284160, "num_env_steps_sampled": 284160, "num_env_steps_trained": 284160, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.64569235940959, "num_env_steps_trained_throughput_per_sec": 41.64569235940959, "timesteps_total": 284160, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 284160, "timers": {"training_iteration_time_ms": 2884.143, "sample_time_ms": 2880.406, "load_time_ms": 0.216, "load_throughput": 554374.358, "learn_time_ms": 2.784, "learn_throughput": 43097.33, "synch_weights_time_ms": 0.697}, "counters": {"num_env_steps_sampled": 284160, "num_env_steps_trained": 284160, "num_agent_steps_sampled": 284160, "num_agent_steps_trained": 284160}, "done": false, "episodes_total": 2368, "training_iteration": 593, "trial_id": "53665_00000", "date": "2023-07-26_03-47-32", "timestamp": 1690332452, "time_this_iter_s": 11.528743982315063, "time_total_s": 7191.602890491486, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1570.277414560318, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 33.75625, "ram_util_percent": 72.775}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 5e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4676208496094, "policy_loss": -83820.75, "vf_loss": 3011716.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 534.0, "diff_num_grad_updates_vs_sampler_policy": 533.0}}, "num_env_steps_sampled": 284640, "num_env_steps_trained": 284640, "num_agent_steps_sampled": 284640, "num_agent_steps_trained": 284640}, "sampler_results": {"episode_reward_max": -308.28382301090573, "episode_reward_min": -1158.6117929321103, "episode_reward_mean": -750.7177734583051, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-544.5638309839326, -815.022416278965, -611.9389605369848, -949.353625424887, -984.6556400009515, -696.0354490196511, -850.5998145896981, -612.314678042395, -761.5693908480316, -762.0242108081395, -913.8990176793252, -739.0573346696534, -973.6543863618886, -853.885512123146, -685.9431800648692, -628.8443831481497, -793.2244754853593, -938.036210409312, -731.0213689932796, -668.91402419103, -775.9799250886979, -918.1219868557534, -779.0636381600455, -740.7445417489905, -627.7987635176951, -846.1734392201507, -1026.1366211636464, -991.1075168066791, -1158.6117929321103, -634.4079835977203, -1086.3997778712767, -848.3363745671835, -609.985177244056, -568.0533195590792, -931.8836352696122, -834.8408105474897, -925.5155738552007, -785.2826896370813, -908.2995469991157, -856.9118320764713, -480.97023180184084, -965.3187054622128, -526.9204647026459, -656.5994837806566, -471.29863448125815, -672.0187467705181, -710.4506096922596, -544.7325533024848, -763.2048804132796, -739.7691311269479, -824.1495719536343, -710.0983954664807, -569.4301622090443, -620.4315233941855, -970.0045234328868, -1067.8928525654064, -816.8554156838703, -780.1341603915353, -1054.5756392399649, -987.8104741172193, -826.7266489458918, -770.713468373902, -783.5125671089766, -642.5416510676502, -655.1582886824842, -620.6881366171439, -815.8500809726518, -758.4323431547602, -846.4322126456299, -694.6635463339022, -1107.573231941316, -751.1882768962611, -416.1501239530031, -467.050600291204, -720.3908557310855, -605.2173986323484, -1068.5916564180015, -874.2986752925311, -738.1516152379985, -691.2460352294241, -801.3893431102525, -716.4853136285915, -825.6934677850077, -615.7422793376439, -694.2164562904486, -891.9545078165829, -666.6104380247511, -552.8373735843545, -1112.823699856796, -519.9997425741633, -308.28382301090573, -423.48683626330006, -475.1921603230027, -570.2971677399692, -356.40798923950274, -740.8905816116494, -669.9377909848879, -484.53739912788717, -807.7263389712529, -681.8082066573677], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.38482811594949, "mean_inference_ms": 0.4122811467204309, "mean_action_processing_ms": 0.09715573001881576, "mean_env_wait_ms": 2.723336081641968, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036613941192626953, "StateBufferConnector_ms": 0.0027763843536376953, "ViewRequirementAgentConnector_ms": 0.06877636909484863}}, "episode_reward_max": -308.28382301090573, "episode_reward_min": -1158.6117929321103, "episode_reward_mean": -750.7177734583051, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-544.5638309839326, -815.022416278965, -611.9389605369848, -949.353625424887, -984.6556400009515, -696.0354490196511, -850.5998145896981, -612.314678042395, -761.5693908480316, -762.0242108081395, -913.8990176793252, -739.0573346696534, -973.6543863618886, -853.885512123146, -685.9431800648692, -628.8443831481497, -793.2244754853593, -938.036210409312, -731.0213689932796, -668.91402419103, -775.9799250886979, -918.1219868557534, -779.0636381600455, -740.7445417489905, -627.7987635176951, -846.1734392201507, -1026.1366211636464, -991.1075168066791, -1158.6117929321103, -634.4079835977203, -1086.3997778712767, -848.3363745671835, -609.985177244056, -568.0533195590792, -931.8836352696122, -834.8408105474897, -925.5155738552007, -785.2826896370813, -908.2995469991157, -856.9118320764713, -480.97023180184084, -965.3187054622128, -526.9204647026459, -656.5994837806566, -471.29863448125815, -672.0187467705181, -710.4506096922596, -544.7325533024848, -763.2048804132796, -739.7691311269479, -824.1495719536343, -710.0983954664807, -569.4301622090443, -620.4315233941855, -970.0045234328868, -1067.8928525654064, -816.8554156838703, -780.1341603915353, -1054.5756392399649, -987.8104741172193, -826.7266489458918, -770.713468373902, -783.5125671089766, -642.5416510676502, -655.1582886824842, -620.6881366171439, -815.8500809726518, -758.4323431547602, -846.4322126456299, -694.6635463339022, -1107.573231941316, -751.1882768962611, -416.1501239530031, -467.050600291204, -720.3908557310855, -605.2173986323484, -1068.5916564180015, -874.2986752925311, -738.1516152379985, -691.2460352294241, -801.3893431102525, -716.4853136285915, -825.6934677850077, -615.7422793376439, -694.2164562904486, -891.9545078165829, -666.6104380247511, -552.8373735843545, -1112.823699856796, -519.9997425741633, -308.28382301090573, -423.48683626330006, -475.1921603230027, -570.2971677399692, -356.40798923950274, -740.8905816116494, -669.9377909848879, -484.53739912788717, -807.7263389712529, -681.8082066573677], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.38482811594949, "mean_inference_ms": 0.4122811467204309, "mean_action_processing_ms": 0.09715573001881576, "mean_env_wait_ms": 2.723336081641968, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036613941192626953, "StateBufferConnector_ms": 0.0027763843536376953, "ViewRequirementAgentConnector_ms": 0.06877636909484863}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 284640, "num_agent_steps_trained": 284640, "num_env_steps_sampled": 284640, "num_env_steps_trained": 284640, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.03414229690324, "num_env_steps_trained_throughput_per_sec": 41.03414229690324, "timesteps_total": 284640, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 284640, "timers": {"training_iteration_time_ms": 2893.466, "sample_time_ms": 2889.744, "load_time_ms": 0.216, "load_throughput": 556335.227, "learn_time_ms": 2.765, "learn_throughput": 43395.337, "synch_weights_time_ms": 0.703}, "counters": {"num_env_steps_sampled": 284640, "num_env_steps_trained": 284640, "num_agent_steps_sampled": 284640, "num_agent_steps_trained": 284640}, "done": false, "episodes_total": 2372, "training_iteration": 594, "trial_id": "53665_00000", "date": "2023-07-26_03-47-44", "timestamp": 1690332464, "time_this_iter_s": 11.700302839279175, "time_total_s": 7203.303193330765, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1581.9777173995972, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 37.199999999999996, "ram_util_percent": 72.95882352941176}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4.8e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4839782714844, "policy_loss": -69718.90625, "vf_loss": 2352512.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 538.0, "diff_num_grad_updates_vs_sampler_policy": 537.0}}, "num_env_steps_sampled": 285120, "num_env_steps_trained": 285120, "num_agent_steps_sampled": 285120, "num_agent_steps_trained": 285120}, "sampler_results": {"episode_reward_max": -308.28382301090573, "episode_reward_min": -1158.6117929321103, "episode_reward_mean": -747.1203846364815, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-984.6556400009515, -696.0354490196511, -850.5998145896981, -612.314678042395, -761.5693908480316, -762.0242108081395, -913.8990176793252, -739.0573346696534, -973.6543863618886, -853.885512123146, -685.9431800648692, -628.8443831481497, -793.2244754853593, -938.036210409312, -731.0213689932796, -668.91402419103, -775.9799250886979, -918.1219868557534, -779.0636381600455, -740.7445417489905, -627.7987635176951, -846.1734392201507, -1026.1366211636464, -991.1075168066791, -1158.6117929321103, -634.4079835977203, -1086.3997778712767, -848.3363745671835, -609.985177244056, -568.0533195590792, -931.8836352696122, -834.8408105474897, -925.5155738552007, -785.2826896370813, -908.2995469991157, -856.9118320764713, -480.97023180184084, -965.3187054622128, -526.9204647026459, -656.5994837806566, -471.29863448125815, -672.0187467705181, -710.4506096922596, -544.7325533024848, -763.2048804132796, -739.7691311269479, -824.1495719536343, -710.0983954664807, -569.4301622090443, -620.4315233941855, -970.0045234328868, -1067.8928525654064, -816.8554156838703, -780.1341603915353, -1054.5756392399649, -987.8104741172193, -826.7266489458918, -770.713468373902, -783.5125671089766, -642.5416510676502, -655.1582886824842, -620.6881366171439, -815.8500809726518, -758.4323431547602, -846.4322126456299, -694.6635463339022, -1107.573231941316, -751.1882768962611, -416.1501239530031, -467.050600291204, -720.3908557310855, -605.2173986323484, -1068.5916564180015, -874.2986752925311, -738.1516152379985, -691.2460352294241, -801.3893431102525, -716.4853136285915, -825.6934677850077, -615.7422793376439, -694.2164562904486, -891.9545078165829, -666.6104380247511, -552.8373735843545, -1112.823699856796, -519.9997425741633, -308.28382301090573, -423.48683626330006, -475.1921603230027, -570.2971677399692, -356.40798923950274, -740.8905816116494, -669.9377909848879, -484.53739912788717, -807.7263389712529, -681.8082066573677, -666.5934636902222, -881.1046434265544, -544.136104964867, -469.30573896074276], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.383616550912, "mean_inference_ms": 0.41213401348054346, "mean_action_processing_ms": 0.09713226393128327, "mean_env_wait_ms": 2.7227954650784283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036706924438476562, "StateBufferConnector_ms": 0.0027675628662109375, "ViewRequirementAgentConnector_ms": 0.06881237030029297}}, "episode_reward_max": -308.28382301090573, "episode_reward_min": -1158.6117929321103, "episode_reward_mean": -747.1203846364815, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-984.6556400009515, -696.0354490196511, -850.5998145896981, -612.314678042395, -761.5693908480316, -762.0242108081395, -913.8990176793252, -739.0573346696534, -973.6543863618886, -853.885512123146, -685.9431800648692, -628.8443831481497, -793.2244754853593, -938.036210409312, -731.0213689932796, -668.91402419103, -775.9799250886979, -918.1219868557534, -779.0636381600455, -740.7445417489905, -627.7987635176951, -846.1734392201507, -1026.1366211636464, -991.1075168066791, -1158.6117929321103, -634.4079835977203, -1086.3997778712767, -848.3363745671835, -609.985177244056, -568.0533195590792, -931.8836352696122, -834.8408105474897, -925.5155738552007, -785.2826896370813, -908.2995469991157, -856.9118320764713, -480.97023180184084, -965.3187054622128, -526.9204647026459, -656.5994837806566, -471.29863448125815, -672.0187467705181, -710.4506096922596, -544.7325533024848, -763.2048804132796, -739.7691311269479, -824.1495719536343, -710.0983954664807, -569.4301622090443, -620.4315233941855, -970.0045234328868, -1067.8928525654064, -816.8554156838703, -780.1341603915353, -1054.5756392399649, -987.8104741172193, -826.7266489458918, -770.713468373902, -783.5125671089766, -642.5416510676502, -655.1582886824842, -620.6881366171439, -815.8500809726518, -758.4323431547602, -846.4322126456299, -694.6635463339022, -1107.573231941316, -751.1882768962611, -416.1501239530031, -467.050600291204, -720.3908557310855, -605.2173986323484, -1068.5916564180015, -874.2986752925311, -738.1516152379985, -691.2460352294241, -801.3893431102525, -716.4853136285915, -825.6934677850077, -615.7422793376439, -694.2164562904486, -891.9545078165829, -666.6104380247511, -552.8373735843545, -1112.823699856796, -519.9997425741633, -308.28382301090573, -423.48683626330006, -475.1921603230027, -570.2971677399692, -356.40798923950274, -740.8905816116494, -669.9377909848879, -484.53739912788717, -807.7263389712529, -681.8082066573677, -666.5934636902222, -881.1046434265544, -544.136104964867, -469.30573896074276], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.383616550912, "mean_inference_ms": 0.41213401348054346, "mean_action_processing_ms": 0.09713226393128327, "mean_env_wait_ms": 2.7227954650784283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036706924438476562, "StateBufferConnector_ms": 0.0027675628662109375, "ViewRequirementAgentConnector_ms": 0.06881237030029297}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 285120, "num_agent_steps_trained": 285120, "num_env_steps_sampled": 285120, "num_env_steps_trained": 285120, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.36042532064258, "num_env_steps_trained_throughput_per_sec": 40.36042532064258, "timesteps_total": 285120, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 285120, "timers": {"training_iteration_time_ms": 2948.216, "sample_time_ms": 2944.487, "load_time_ms": 0.216, "load_throughput": 555536.954, "learn_time_ms": 2.773, "learn_throughput": 43269.614, "synch_weights_time_ms": 0.701}, "counters": {"num_env_steps_sampled": 285120, "num_env_steps_trained": 285120, "num_agent_steps_sampled": 285120, "num_agent_steps_trained": 285120}, "done": false, "episodes_total": 2376, "training_iteration": 595, "trial_id": "53665_00000", "date": "2023-07-26_03-47-56", "timestamp": 1690332476, "time_this_iter_s": 11.895572900772095, "time_total_s": 7215.198766231537, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1593.8732903003693, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 38.34705882352941, "ram_util_percent": 73.1705882352941}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 4e-09, "entropy_coeff": 0.05, "policy_entropy": 267.47955322265625, "policy_loss": -86035.0, "vf_loss": 3559994.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 542.0, "diff_num_grad_updates_vs_sampler_policy": 541.0}}, "num_env_steps_sampled": 285600, "num_env_steps_trained": 285600, "num_agent_steps_sampled": 285600, "num_agent_steps_trained": 285600}, "sampler_results": {"episode_reward_max": -308.28382301090573, "episode_reward_min": -1158.6117929321103, "episode_reward_mean": -749.4410237558034, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-761.5693908480316, -762.0242108081395, -913.8990176793252, -739.0573346696534, -973.6543863618886, -853.885512123146, -685.9431800648692, -628.8443831481497, -793.2244754853593, -938.036210409312, -731.0213689932796, -668.91402419103, -775.9799250886979, -918.1219868557534, -779.0636381600455, -740.7445417489905, -627.7987635176951, -846.1734392201507, -1026.1366211636464, -991.1075168066791, -1158.6117929321103, -634.4079835977203, -1086.3997778712767, -848.3363745671835, -609.985177244056, -568.0533195590792, -931.8836352696122, -834.8408105474897, -925.5155738552007, -785.2826896370813, -908.2995469991157, -856.9118320764713, -480.97023180184084, -965.3187054622128, -526.9204647026459, -656.5994837806566, -471.29863448125815, -672.0187467705181, -710.4506096922596, -544.7325533024848, -763.2048804132796, -739.7691311269479, -824.1495719536343, -710.0983954664807, -569.4301622090443, -620.4315233941855, -970.0045234328868, -1067.8928525654064, -816.8554156838703, -780.1341603915353, -1054.5756392399649, -987.8104741172193, -826.7266489458918, -770.713468373902, -783.5125671089766, -642.5416510676502, -655.1582886824842, -620.6881366171439, -815.8500809726518, -758.4323431547602, -846.4322126456299, -694.6635463339022, -1107.573231941316, -751.1882768962611, -416.1501239530031, -467.050600291204, -720.3908557310855, -605.2173986323484, -1068.5916564180015, -874.2986752925311, -738.1516152379985, -691.2460352294241, -801.3893431102525, -716.4853136285915, -825.6934677850077, -615.7422793376439, -694.2164562904486, -891.9545078165829, -666.6104380247511, -552.8373735843545, -1112.823699856796, -519.9997425741633, -308.28382301090573, -423.48683626330006, -475.1921603230027, -570.2971677399692, -356.40798923950274, -740.8905816116494, -669.9377909848879, -484.53739912788717, -807.7263389712529, -681.8082066573677, -666.5934636902222, -881.1046434265544, -544.136104964867, -469.30573896074276, -902.9095886165971, -850.5972108992019, -756.4222565494592, -865.7404375196369], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.382666711951615, "mean_inference_ms": 0.4119893203058453, "mean_action_processing_ms": 0.09710915667330651, "mean_env_wait_ms": 2.7222640228661508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036640167236328125, "StateBufferConnector_ms": 0.002768993377685547, "ViewRequirementAgentConnector_ms": 0.06883621215820312}}, "episode_reward_max": -308.28382301090573, "episode_reward_min": -1158.6117929321103, "episode_reward_mean": -749.4410237558034, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-761.5693908480316, -762.0242108081395, -913.8990176793252, -739.0573346696534, -973.6543863618886, -853.885512123146, -685.9431800648692, -628.8443831481497, -793.2244754853593, -938.036210409312, -731.0213689932796, -668.91402419103, -775.9799250886979, -918.1219868557534, -779.0636381600455, -740.7445417489905, -627.7987635176951, -846.1734392201507, -1026.1366211636464, -991.1075168066791, -1158.6117929321103, -634.4079835977203, -1086.3997778712767, -848.3363745671835, -609.985177244056, -568.0533195590792, -931.8836352696122, -834.8408105474897, -925.5155738552007, -785.2826896370813, -908.2995469991157, -856.9118320764713, -480.97023180184084, -965.3187054622128, -526.9204647026459, -656.5994837806566, -471.29863448125815, -672.0187467705181, -710.4506096922596, -544.7325533024848, -763.2048804132796, -739.7691311269479, -824.1495719536343, -710.0983954664807, -569.4301622090443, -620.4315233941855, -970.0045234328868, -1067.8928525654064, -816.8554156838703, -780.1341603915353, -1054.5756392399649, -987.8104741172193, -826.7266489458918, -770.713468373902, -783.5125671089766, -642.5416510676502, -655.1582886824842, -620.6881366171439, -815.8500809726518, -758.4323431547602, -846.4322126456299, -694.6635463339022, -1107.573231941316, -751.1882768962611, -416.1501239530031, -467.050600291204, -720.3908557310855, -605.2173986323484, -1068.5916564180015, -874.2986752925311, -738.1516152379985, -691.2460352294241, -801.3893431102525, -716.4853136285915, -825.6934677850077, -615.7422793376439, -694.2164562904486, -891.9545078165829, -666.6104380247511, -552.8373735843545, -1112.823699856796, -519.9997425741633, -308.28382301090573, -423.48683626330006, -475.1921603230027, -570.2971677399692, -356.40798923950274, -740.8905816116494, -669.9377909848879, -484.53739912788717, -807.7263389712529, -681.8082066573677, -666.5934636902222, -881.1046434265544, -544.136104964867, -469.30573896074276, -902.9095886165971, -850.5972108992019, -756.4222565494592, -865.7404375196369], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.382666711951615, "mean_inference_ms": 0.4119893203058453, "mean_action_processing_ms": 0.09710915667330651, "mean_env_wait_ms": 2.7222640228661508, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036640167236328125, "StateBufferConnector_ms": 0.002768993377685547, "ViewRequirementAgentConnector_ms": 0.06883621215820312}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 285600, "num_agent_steps_trained": 285600, "num_env_steps_sampled": 285600, "num_env_steps_trained": 285600, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.75352938056744, "num_env_steps_trained_throughput_per_sec": 40.75352938056744, "timesteps_total": 285600, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 285600, "timers": {"training_iteration_time_ms": 2965.793, "sample_time_ms": 2962.061, "load_time_ms": 0.216, "load_throughput": 556827.614, "learn_time_ms": 2.783, "learn_throughput": 43114.681, "synch_weights_time_ms": 0.693}, "counters": {"num_env_steps_sampled": 285600, "num_env_steps_trained": 285600, "num_agent_steps_sampled": 285600, "num_agent_steps_trained": 285600}, "done": false, "episodes_total": 2380, "training_iteration": 596, "trial_id": "53665_00000", "date": "2023-07-26_03-48-08", "timestamp": 1690332488, "time_this_iter_s": 11.78103518486023, "time_total_s": 7226.979801416397, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1605.6543254852295, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 38.04117647058824, "ram_util_percent": 73.2470588235294}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 3.1999999999999997e-09, "entropy_coeff": 0.05, "policy_entropy": 267.46514892578125, "policy_loss": -78690.15625, "vf_loss": 2953816.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 546.0, "diff_num_grad_updates_vs_sampler_policy": 545.0}}, "num_env_steps_sampled": 286080, "num_env_steps_trained": 286080, "num_agent_steps_sampled": 286080, "num_agent_steps_trained": 286080}, "sampler_results": {"episode_reward_max": -308.28382301090573, "episode_reward_min": -1258.911760652912, "episode_reward_mean": -749.091201250414, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-973.6543863618886, -853.885512123146, -685.9431800648692, -628.8443831481497, -793.2244754853593, -938.036210409312, -731.0213689932796, -668.91402419103, -775.9799250886979, -918.1219868557534, -779.0636381600455, -740.7445417489905, -627.7987635176951, -846.1734392201507, -1026.1366211636464, -991.1075168066791, -1158.6117929321103, -634.4079835977203, -1086.3997778712767, -848.3363745671835, -609.985177244056, -568.0533195590792, -931.8836352696122, -834.8408105474897, -925.5155738552007, -785.2826896370813, -908.2995469991157, -856.9118320764713, -480.97023180184084, -965.3187054622128, -526.9204647026459, -656.5994837806566, -471.29863448125815, -672.0187467705181, -710.4506096922596, -544.7325533024848, -763.2048804132796, -739.7691311269479, -824.1495719536343, -710.0983954664807, -569.4301622090443, -620.4315233941855, -970.0045234328868, -1067.8928525654064, -816.8554156838703, -780.1341603915353, -1054.5756392399649, -987.8104741172193, -826.7266489458918, -770.713468373902, -783.5125671089766, -642.5416510676502, -655.1582886824842, -620.6881366171439, -815.8500809726518, -758.4323431547602, -846.4322126456299, -694.6635463339022, -1107.573231941316, -751.1882768962611, -416.1501239530031, -467.050600291204, -720.3908557310855, -605.2173986323484, -1068.5916564180015, -874.2986752925311, -738.1516152379985, -691.2460352294241, -801.3893431102525, -716.4853136285915, -825.6934677850077, -615.7422793376439, -694.2164562904486, -891.9545078165829, -666.6104380247511, -552.8373735843545, -1112.823699856796, -519.9997425741633, -308.28382301090573, -423.48683626330006, -475.1921603230027, -570.2971677399692, -356.40798923950274, -740.8905816116494, -669.9377909848879, -484.53739912788717, -807.7263389712529, -681.8082066573677, -666.5934636902222, -881.1046434265544, -544.136104964867, -469.30573896074276, -902.9095886165971, -850.5972108992019, -756.4222565494592, -865.7404375196369, -1258.911760652912, -565.9822236500993, -705.4478638415109, -611.2258553216858], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.38160170462431, "mean_inference_ms": 0.4118491036805693, "mean_action_processing_ms": 0.09708677372923524, "mean_env_wait_ms": 2.721727746600318, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036613941192626953, "StateBufferConnector_ms": 0.0027685165405273438, "ViewRequirementAgentConnector_ms": 0.06888628005981445}}, "episode_reward_max": -308.28382301090573, "episode_reward_min": -1258.911760652912, "episode_reward_mean": -749.091201250414, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-973.6543863618886, -853.885512123146, -685.9431800648692, -628.8443831481497, -793.2244754853593, -938.036210409312, -731.0213689932796, -668.91402419103, -775.9799250886979, -918.1219868557534, -779.0636381600455, -740.7445417489905, -627.7987635176951, -846.1734392201507, -1026.1366211636464, -991.1075168066791, -1158.6117929321103, -634.4079835977203, -1086.3997778712767, -848.3363745671835, -609.985177244056, -568.0533195590792, -931.8836352696122, -834.8408105474897, -925.5155738552007, -785.2826896370813, -908.2995469991157, -856.9118320764713, -480.97023180184084, -965.3187054622128, -526.9204647026459, -656.5994837806566, -471.29863448125815, -672.0187467705181, -710.4506096922596, -544.7325533024848, -763.2048804132796, -739.7691311269479, -824.1495719536343, -710.0983954664807, -569.4301622090443, -620.4315233941855, -970.0045234328868, -1067.8928525654064, -816.8554156838703, -780.1341603915353, -1054.5756392399649, -987.8104741172193, -826.7266489458918, -770.713468373902, -783.5125671089766, -642.5416510676502, -655.1582886824842, -620.6881366171439, -815.8500809726518, -758.4323431547602, -846.4322126456299, -694.6635463339022, -1107.573231941316, -751.1882768962611, -416.1501239530031, -467.050600291204, -720.3908557310855, -605.2173986323484, -1068.5916564180015, -874.2986752925311, -738.1516152379985, -691.2460352294241, -801.3893431102525, -716.4853136285915, -825.6934677850077, -615.7422793376439, -694.2164562904486, -891.9545078165829, -666.6104380247511, -552.8373735843545, -1112.823699856796, -519.9997425741633, -308.28382301090573, -423.48683626330006, -475.1921603230027, -570.2971677399692, -356.40798923950274, -740.8905816116494, -669.9377909848879, -484.53739912788717, -807.7263389712529, -681.8082066573677, -666.5934636902222, -881.1046434265544, -544.136104964867, -469.30573896074276, -902.9095886165971, -850.5972108992019, -756.4222565494592, -865.7404375196369, -1258.911760652912, -565.9822236500993, -705.4478638415109, -611.2258553216858], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.38160170462431, "mean_inference_ms": 0.4118491036805693, "mean_action_processing_ms": 0.09708677372923524, "mean_env_wait_ms": 2.721727746600318, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036613941192626953, "StateBufferConnector_ms": 0.0027685165405273438, "ViewRequirementAgentConnector_ms": 0.06888628005981445}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 286080, "num_agent_steps_trained": 286080, "num_env_steps_sampled": 286080, "num_env_steps_trained": 286080, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.70776303308346, "num_env_steps_trained_throughput_per_sec": 41.70776303308346, "timesteps_total": 286080, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 286080, "timers": {"training_iteration_time_ms": 2918.479, "sample_time_ms": 2914.721, "load_time_ms": 0.215, "load_throughput": 558681.851, "learn_time_ms": 2.804, "learn_throughput": 42800.112, "synch_weights_time_ms": 0.699}, "counters": {"num_env_steps_sampled": 286080, "num_env_steps_trained": 286080, "num_agent_steps_sampled": 286080, "num_agent_steps_trained": 286080}, "done": false, "episodes_total": 2384, "training_iteration": 597, "trial_id": "53665_00000", "date": "2023-07-26_03-48-19", "timestamp": 1690332499, "time_this_iter_s": 11.511372089385986, "time_total_s": 7238.491173505783, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1617.1656975746155, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 33.93125, "ram_util_percent": 72.39999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 2.4e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4888916015625, "policy_loss": -127738.171875, "vf_loss": 7786514.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 550.0, "diff_num_grad_updates_vs_sampler_policy": 549.0}}, "num_env_steps_sampled": 286560, "num_env_steps_trained": 286560, "num_agent_steps_sampled": 286560, "num_agent_steps_trained": 286560}, "sampler_results": {"episode_reward_max": -308.28382301090573, "episode_reward_min": -1258.911760652912, "episode_reward_mean": -750.369050865045, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-793.2244754853593, -938.036210409312, -731.0213689932796, -668.91402419103, -775.9799250886979, -918.1219868557534, -779.0636381600455, -740.7445417489905, -627.7987635176951, -846.1734392201507, -1026.1366211636464, -991.1075168066791, -1158.6117929321103, -634.4079835977203, -1086.3997778712767, -848.3363745671835, -609.985177244056, -568.0533195590792, -931.8836352696122, -834.8408105474897, -925.5155738552007, -785.2826896370813, -908.2995469991157, -856.9118320764713, -480.97023180184084, -965.3187054622128, -526.9204647026459, -656.5994837806566, -471.29863448125815, -672.0187467705181, -710.4506096922596, -544.7325533024848, -763.2048804132796, -739.7691311269479, -824.1495719536343, -710.0983954664807, -569.4301622090443, -620.4315233941855, -970.0045234328868, -1067.8928525654064, -816.8554156838703, -780.1341603915353, -1054.5756392399649, -987.8104741172193, -826.7266489458918, -770.713468373902, -783.5125671089766, -642.5416510676502, -655.1582886824842, -620.6881366171439, -815.8500809726518, -758.4323431547602, -846.4322126456299, -694.6635463339022, -1107.573231941316, -751.1882768962611, -416.1501239530031, -467.050600291204, -720.3908557310855, -605.2173986323484, -1068.5916564180015, -874.2986752925311, -738.1516152379985, -691.2460352294241, -801.3893431102525, -716.4853136285915, -825.6934677850077, -615.7422793376439, -694.2164562904486, -891.9545078165829, -666.6104380247511, -552.8373735843545, -1112.823699856796, -519.9997425741633, -308.28382301090573, -423.48683626330006, -475.1921603230027, -570.2971677399692, -356.40798923950274, -740.8905816116494, -669.9377909848879, -484.53739912788717, -807.7263389712529, -681.8082066573677, -666.5934636902222, -881.1046434265544, -544.136104964867, -469.30573896074276, -902.9095886165971, -850.5972108992019, -756.4222565494592, -865.7404375196369, -1258.911760652912, -565.9822236500993, -705.4478638415109, -611.2258553216858, -653.320410738251, -866.1269169517573, -789.8844987931826, -960.7805966779694], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.380300960959495, "mean_inference_ms": 0.41170990430503307, "mean_action_processing_ms": 0.09706453047400229, "mean_env_wait_ms": 2.7211727603074447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036461353302001953, "StateBufferConnector_ms": 0.002765178680419922, "ViewRequirementAgentConnector_ms": 0.0687112808227539}}, "episode_reward_max": -308.28382301090573, "episode_reward_min": -1258.911760652912, "episode_reward_mean": -750.369050865045, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-793.2244754853593, -938.036210409312, -731.0213689932796, -668.91402419103, -775.9799250886979, -918.1219868557534, -779.0636381600455, -740.7445417489905, -627.7987635176951, -846.1734392201507, -1026.1366211636464, -991.1075168066791, -1158.6117929321103, -634.4079835977203, -1086.3997778712767, -848.3363745671835, -609.985177244056, -568.0533195590792, -931.8836352696122, -834.8408105474897, -925.5155738552007, -785.2826896370813, -908.2995469991157, -856.9118320764713, -480.97023180184084, -965.3187054622128, -526.9204647026459, -656.5994837806566, -471.29863448125815, -672.0187467705181, -710.4506096922596, -544.7325533024848, -763.2048804132796, -739.7691311269479, -824.1495719536343, -710.0983954664807, -569.4301622090443, -620.4315233941855, -970.0045234328868, -1067.8928525654064, -816.8554156838703, -780.1341603915353, -1054.5756392399649, -987.8104741172193, -826.7266489458918, -770.713468373902, -783.5125671089766, -642.5416510676502, -655.1582886824842, -620.6881366171439, -815.8500809726518, -758.4323431547602, -846.4322126456299, -694.6635463339022, -1107.573231941316, -751.1882768962611, -416.1501239530031, -467.050600291204, -720.3908557310855, -605.2173986323484, -1068.5916564180015, -874.2986752925311, -738.1516152379985, -691.2460352294241, -801.3893431102525, -716.4853136285915, -825.6934677850077, -615.7422793376439, -694.2164562904486, -891.9545078165829, -666.6104380247511, -552.8373735843545, -1112.823699856796, -519.9997425741633, -308.28382301090573, -423.48683626330006, -475.1921603230027, -570.2971677399692, -356.40798923950274, -740.8905816116494, -669.9377909848879, -484.53739912788717, -807.7263389712529, -681.8082066573677, -666.5934636902222, -881.1046434265544, -544.136104964867, -469.30573896074276, -902.9095886165971, -850.5972108992019, -756.4222565494592, -865.7404375196369, -1258.911760652912, -565.9822236500993, -705.4478638415109, -611.2258553216858, -653.320410738251, -866.1269169517573, -789.8844987931826, -960.7805966779694], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.380300960959495, "mean_inference_ms": 0.41170990430503307, "mean_action_processing_ms": 0.09706453047400229, "mean_env_wait_ms": 2.7211727603074447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036461353302001953, "StateBufferConnector_ms": 0.002765178680419922, "ViewRequirementAgentConnector_ms": 0.0687112808227539}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 286560, "num_agent_steps_trained": 286560, "num_env_steps_sampled": 286560, "num_env_steps_trained": 286560, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.734768723008266, "num_env_steps_trained_throughput_per_sec": 41.734768723008266, "timesteps_total": 286560, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 286560, "timers": {"training_iteration_time_ms": 2872.325, "sample_time_ms": 2868.56, "load_time_ms": 0.214, "load_throughput": 559924.886, "learn_time_ms": 2.8, "learn_throughput": 42852.221, "synch_weights_time_ms": 0.71}, "counters": {"num_env_steps_sampled": 286560, "num_env_steps_trained": 286560, "num_agent_steps_sampled": 286560, "num_agent_steps_trained": 286560}, "done": false, "episodes_total": 2388, "training_iteration": 598, "trial_id": "53665_00000", "date": "2023-07-26_03-48-31", "timestamp": 1690332511, "time_this_iter_s": 11.503944873809814, "time_total_s": 7249.995118379593, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1628.6696424484253, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 33.57058823529412, "ram_util_percent": 73.04117647058824}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1.5999999999999999e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4587097167969, "policy_loss": -64766.671875, "vf_loss": 1927337.125}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 554.0, "diff_num_grad_updates_vs_sampler_policy": 553.0}}, "num_env_steps_sampled": 287040, "num_env_steps_trained": 287040, "num_agent_steps_sampled": 287040, "num_agent_steps_trained": 287040}, "sampler_results": {"episode_reward_max": -308.28382301090573, "episode_reward_min": -1258.911760652912, "episode_reward_mean": -748.1139233258597, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-775.9799250886979, -918.1219868557534, -779.0636381600455, -740.7445417489905, -627.7987635176951, -846.1734392201507, -1026.1366211636464, -991.1075168066791, -1158.6117929321103, -634.4079835977203, -1086.3997778712767, -848.3363745671835, -609.985177244056, -568.0533195590792, -931.8836352696122, -834.8408105474897, -925.5155738552007, -785.2826896370813, -908.2995469991157, -856.9118320764713, -480.97023180184084, -965.3187054622128, -526.9204647026459, -656.5994837806566, -471.29863448125815, -672.0187467705181, -710.4506096922596, -544.7325533024848, -763.2048804132796, -739.7691311269479, -824.1495719536343, -710.0983954664807, -569.4301622090443, -620.4315233941855, -970.0045234328868, -1067.8928525654064, -816.8554156838703, -780.1341603915353, -1054.5756392399649, -987.8104741172193, -826.7266489458918, -770.713468373902, -783.5125671089766, -642.5416510676502, -655.1582886824842, -620.6881366171439, -815.8500809726518, -758.4323431547602, -846.4322126456299, -694.6635463339022, -1107.573231941316, -751.1882768962611, -416.1501239530031, -467.050600291204, -720.3908557310855, -605.2173986323484, -1068.5916564180015, -874.2986752925311, -738.1516152379985, -691.2460352294241, -801.3893431102525, -716.4853136285915, -825.6934677850077, -615.7422793376439, -694.2164562904486, -891.9545078165829, -666.6104380247511, -552.8373735843545, -1112.823699856796, -519.9997425741633, -308.28382301090573, -423.48683626330006, -475.1921603230027, -570.2971677399692, -356.40798923950274, -740.8905816116494, -669.9377909848879, -484.53739912788717, -807.7263389712529, -681.8082066573677, -666.5934636902222, -881.1046434265544, -544.136104964867, -469.30573896074276, -902.9095886165971, -850.5972108992019, -756.4222565494592, -865.7404375196369, -1258.911760652912, -565.9822236500993, -705.4478638415109, -611.2258553216858, -653.320410738251, -866.1269169517573, -789.8844987931826, -960.7805966779694, -968.6082486048847, -827.9117297349418, -637.6223482786262, -471.54099854198716], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.37911763460803, "mean_inference_ms": 0.4115663976011262, "mean_action_processing_ms": 0.09704163590092704, "mean_env_wait_ms": 2.7206236240821413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003651142120361328, "StateBufferConnector_ms": 0.0027697086334228516, "ViewRequirementAgentConnector_ms": 0.06870532035827637}}, "episode_reward_max": -308.28382301090573, "episode_reward_min": -1258.911760652912, "episode_reward_mean": -748.1139233258597, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-775.9799250886979, -918.1219868557534, -779.0636381600455, -740.7445417489905, -627.7987635176951, -846.1734392201507, -1026.1366211636464, -991.1075168066791, -1158.6117929321103, -634.4079835977203, -1086.3997778712767, -848.3363745671835, -609.985177244056, -568.0533195590792, -931.8836352696122, -834.8408105474897, -925.5155738552007, -785.2826896370813, -908.2995469991157, -856.9118320764713, -480.97023180184084, -965.3187054622128, -526.9204647026459, -656.5994837806566, -471.29863448125815, -672.0187467705181, -710.4506096922596, -544.7325533024848, -763.2048804132796, -739.7691311269479, -824.1495719536343, -710.0983954664807, -569.4301622090443, -620.4315233941855, -970.0045234328868, -1067.8928525654064, -816.8554156838703, -780.1341603915353, -1054.5756392399649, -987.8104741172193, -826.7266489458918, -770.713468373902, -783.5125671089766, -642.5416510676502, -655.1582886824842, -620.6881366171439, -815.8500809726518, -758.4323431547602, -846.4322126456299, -694.6635463339022, -1107.573231941316, -751.1882768962611, -416.1501239530031, -467.050600291204, -720.3908557310855, -605.2173986323484, -1068.5916564180015, -874.2986752925311, -738.1516152379985, -691.2460352294241, -801.3893431102525, -716.4853136285915, -825.6934677850077, -615.7422793376439, -694.2164562904486, -891.9545078165829, -666.6104380247511, -552.8373735843545, -1112.823699856796, -519.9997425741633, -308.28382301090573, -423.48683626330006, -475.1921603230027, -570.2971677399692, -356.40798923950274, -740.8905816116494, -669.9377909848879, -484.53739912788717, -807.7263389712529, -681.8082066573677, -666.5934636902222, -881.1046434265544, -544.136104964867, -469.30573896074276, -902.9095886165971, -850.5972108992019, -756.4222565494592, -865.7404375196369, -1258.911760652912, -565.9822236500993, -705.4478638415109, -611.2258553216858, -653.320410738251, -866.1269169517573, -789.8844987931826, -960.7805966779694, -968.6082486048847, -827.9117297349418, -637.6223482786262, -471.54099854198716], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.37911763460803, "mean_inference_ms": 0.4115663976011262, "mean_action_processing_ms": 0.09704163590092704, "mean_env_wait_ms": 2.7206236240821413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003651142120361328, "StateBufferConnector_ms": 0.0027697086334228516, "ViewRequirementAgentConnector_ms": 0.06870532035827637}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 287040, "num_agent_steps_trained": 287040, "num_env_steps_sampled": 287040, "num_env_steps_trained": 287040, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.763486522988245, "num_env_steps_trained_throughput_per_sec": 40.763486522988245, "timesteps_total": 287040, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 287040, "timers": {"training_iteration_time_ms": 2901.582, "sample_time_ms": 2897.849, "load_time_ms": 0.216, "load_throughput": 554863.279, "learn_time_ms": 2.779, "learn_throughput": 43185.338, "synch_weights_time_ms": 0.697}, "counters": {"num_env_steps_sampled": 287040, "num_env_steps_trained": 287040, "num_agent_steps_sampled": 287040, "num_agent_steps_trained": 287040}, "done": false, "episodes_total": 2392, "training_iteration": 599, "trial_id": "53665_00000", "date": "2023-07-26_03-48-43", "timestamp": 1690332523, "time_this_iter_s": 11.777920007705688, "time_total_s": 7261.773038387299, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1640.447562456131, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 37.53125, "ram_util_percent": 71.40625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.481689453125, "policy_loss": -124102.9140625, "vf_loss": 6791631.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 558.0, "diff_num_grad_updates_vs_sampler_policy": 557.0}}, "num_env_steps_sampled": 287520, "num_env_steps_trained": 287520, "num_agent_steps_sampled": 287520, "num_agent_steps_trained": 287520}, "sampler_results": {"episode_reward_max": -308.28382301090573, "episode_reward_min": -1258.911760652912, "episode_reward_mean": -749.490163501781, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-627.7987635176951, -846.1734392201507, -1026.1366211636464, -991.1075168066791, -1158.6117929321103, -634.4079835977203, -1086.3997778712767, -848.3363745671835, -609.985177244056, -568.0533195590792, -931.8836352696122, -834.8408105474897, -925.5155738552007, -785.2826896370813, -908.2995469991157, -856.9118320764713, -480.97023180184084, -965.3187054622128, -526.9204647026459, -656.5994837806566, -471.29863448125815, -672.0187467705181, -710.4506096922596, -544.7325533024848, -763.2048804132796, -739.7691311269479, -824.1495719536343, -710.0983954664807, -569.4301622090443, -620.4315233941855, -970.0045234328868, -1067.8928525654064, -816.8554156838703, -780.1341603915353, -1054.5756392399649, -987.8104741172193, -826.7266489458918, -770.713468373902, -783.5125671089766, -642.5416510676502, -655.1582886824842, -620.6881366171439, -815.8500809726518, -758.4323431547602, -846.4322126456299, -694.6635463339022, -1107.573231941316, -751.1882768962611, -416.1501239530031, -467.050600291204, -720.3908557310855, -605.2173986323484, -1068.5916564180015, -874.2986752925311, -738.1516152379985, -691.2460352294241, -801.3893431102525, -716.4853136285915, -825.6934677850077, -615.7422793376439, -694.2164562904486, -891.9545078165829, -666.6104380247511, -552.8373735843545, -1112.823699856796, -519.9997425741633, -308.28382301090573, -423.48683626330006, -475.1921603230027, -570.2971677399692, -356.40798923950274, -740.8905816116494, -669.9377909848879, -484.53739912788717, -807.7263389712529, -681.8082066573677, -666.5934636902222, -881.1046434265544, -544.136104964867, -469.30573896074276, -902.9095886165971, -850.5972108992019, -756.4222565494592, -865.7404375196369, -1258.911760652912, -565.9822236500993, -705.4478638415109, -611.2258553216858, -653.320410738251, -866.1269169517573, -789.8844987931826, -960.7805966779694, -968.6082486048847, -827.9117297349418, -637.6223482786262, -471.54099854198716, -562.7613428530823, -1036.7485457166297, -835.1444152936571, -916.8798055822496], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.378177588205244, "mean_inference_ms": 0.41142486228614944, "mean_action_processing_ms": 0.09701897270920483, "mean_env_wait_ms": 2.7201222658209776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036487579345703125, "StateBufferConnector_ms": 0.0027756690979003906, "ViewRequirementAgentConnector_ms": 0.0687260627746582}}, "episode_reward_max": -308.28382301090573, "episode_reward_min": -1258.911760652912, "episode_reward_mean": -749.490163501781, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-627.7987635176951, -846.1734392201507, -1026.1366211636464, -991.1075168066791, -1158.6117929321103, -634.4079835977203, -1086.3997778712767, -848.3363745671835, -609.985177244056, -568.0533195590792, -931.8836352696122, -834.8408105474897, -925.5155738552007, -785.2826896370813, -908.2995469991157, -856.9118320764713, -480.97023180184084, -965.3187054622128, -526.9204647026459, -656.5994837806566, -471.29863448125815, -672.0187467705181, -710.4506096922596, -544.7325533024848, -763.2048804132796, -739.7691311269479, -824.1495719536343, -710.0983954664807, -569.4301622090443, -620.4315233941855, -970.0045234328868, -1067.8928525654064, -816.8554156838703, -780.1341603915353, -1054.5756392399649, -987.8104741172193, -826.7266489458918, -770.713468373902, -783.5125671089766, -642.5416510676502, -655.1582886824842, -620.6881366171439, -815.8500809726518, -758.4323431547602, -846.4322126456299, -694.6635463339022, -1107.573231941316, -751.1882768962611, -416.1501239530031, -467.050600291204, -720.3908557310855, -605.2173986323484, -1068.5916564180015, -874.2986752925311, -738.1516152379985, -691.2460352294241, -801.3893431102525, -716.4853136285915, -825.6934677850077, -615.7422793376439, -694.2164562904486, -891.9545078165829, -666.6104380247511, -552.8373735843545, -1112.823699856796, -519.9997425741633, -308.28382301090573, -423.48683626330006, -475.1921603230027, -570.2971677399692, -356.40798923950274, -740.8905816116494, -669.9377909848879, -484.53739912788717, -807.7263389712529, -681.8082066573677, -666.5934636902222, -881.1046434265544, -544.136104964867, -469.30573896074276, -902.9095886165971, -850.5972108992019, -756.4222565494592, -865.7404375196369, -1258.911760652912, -565.9822236500993, -705.4478638415109, -611.2258553216858, -653.320410738251, -866.1269169517573, -789.8844987931826, -960.7805966779694, -968.6082486048847, -827.9117297349418, -637.6223482786262, -471.54099854198716, -562.7613428530823, -1036.7485457166297, -835.1444152936571, -916.8798055822496], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.378177588205244, "mean_inference_ms": 0.41142486228614944, "mean_action_processing_ms": 0.09701897270920483, "mean_env_wait_ms": 2.7201222658209776, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036487579345703125, "StateBufferConnector_ms": 0.0027756690979003906, "ViewRequirementAgentConnector_ms": 0.0687260627746582}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 287520, "num_agent_steps_trained": 287520, "num_env_steps_sampled": 287520, "num_env_steps_trained": 287520, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.06066927223617, "num_env_steps_trained_throughput_per_sec": 40.06066927223617, "timesteps_total": 287520, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 287520, "timers": {"training_iteration_time_ms": 2953.896, "sample_time_ms": 2950.161, "load_time_ms": 0.217, "load_throughput": 552245.425, "learn_time_ms": 2.776, "learn_throughput": 43222.424, "synch_weights_time_ms": 0.702}, "counters": {"num_env_steps_sampled": 287520, "num_env_steps_trained": 287520, "num_agent_steps_sampled": 287520, "num_agent_steps_trained": 287520}, "done": false, "episodes_total": 2396, "training_iteration": 600, "trial_id": "53665_00000", "date": "2023-07-26_03-48-55", "timestamp": 1690332535, "time_this_iter_s": 11.984578132629395, "time_total_s": 7273.757616519928, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1652.4321405887604, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 37.0, "ram_util_percent": 71.49411764705883}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4715881347656, "policy_loss": -86045.6171875, "vf_loss": 3972896.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 562.0, "diff_num_grad_updates_vs_sampler_policy": 561.0}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "sampler_results": {"episode_reward_max": -308.28382301090573, "episode_reward_min": -1258.911760652912, "episode_reward_mean": -745.5730011977737, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1158.6117929321103, -634.4079835977203, -1086.3997778712767, -848.3363745671835, -609.985177244056, -568.0533195590792, -931.8836352696122, -834.8408105474897, -925.5155738552007, -785.2826896370813, -908.2995469991157, -856.9118320764713, -480.97023180184084, -965.3187054622128, -526.9204647026459, -656.5994837806566, -471.29863448125815, -672.0187467705181, -710.4506096922596, -544.7325533024848, -763.2048804132796, -739.7691311269479, -824.1495719536343, -710.0983954664807, -569.4301622090443, -620.4315233941855, -970.0045234328868, -1067.8928525654064, -816.8554156838703, -780.1341603915353, -1054.5756392399649, -987.8104741172193, -826.7266489458918, -770.713468373902, -783.5125671089766, -642.5416510676502, -655.1582886824842, -620.6881366171439, -815.8500809726518, -758.4323431547602, -846.4322126456299, -694.6635463339022, -1107.573231941316, -751.1882768962611, -416.1501239530031, -467.050600291204, -720.3908557310855, -605.2173986323484, -1068.5916564180015, -874.2986752925311, -738.1516152379985, -691.2460352294241, -801.3893431102525, -716.4853136285915, -825.6934677850077, -615.7422793376439, -694.2164562904486, -891.9545078165829, -666.6104380247511, -552.8373735843545, -1112.823699856796, -519.9997425741633, -308.28382301090573, -423.48683626330006, -475.1921603230027, -570.2971677399692, -356.40798923950274, -740.8905816116494, -669.9377909848879, -484.53739912788717, -807.7263389712529, -681.8082066573677, -666.5934636902222, -881.1046434265544, -544.136104964867, -469.30573896074276, -902.9095886165971, -850.5972108992019, -756.4222565494592, -865.7404375196369, -1258.911760652912, -565.9822236500993, -705.4478638415109, -611.2258553216858, -653.320410738251, -866.1269169517573, -789.8844987931826, -960.7805966779694, -968.6082486048847, -827.9117297349418, -637.6223482786262, -471.54099854198716, -562.7613428530823, -1036.7485457166297, -835.1444152936571, -916.8798055822496, -612.6285304627245, -838.6797304564644, -915.8508553863994, -732.3409940018564], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.37702943460943, "mean_inference_ms": 0.4112840351999185, "mean_action_processing_ms": 0.09699654942184335, "mean_env_wait_ms": 2.7196300097625565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036361217498779297, "StateBufferConnector_ms": 0.002778291702270508, "ViewRequirementAgentConnector_ms": 0.06874251365661621}}, "episode_reward_max": -308.28382301090573, "episode_reward_min": -1258.911760652912, "episode_reward_mean": -745.5730011977737, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1158.6117929321103, -634.4079835977203, -1086.3997778712767, -848.3363745671835, -609.985177244056, -568.0533195590792, -931.8836352696122, -834.8408105474897, -925.5155738552007, -785.2826896370813, -908.2995469991157, -856.9118320764713, -480.97023180184084, -965.3187054622128, -526.9204647026459, -656.5994837806566, -471.29863448125815, -672.0187467705181, -710.4506096922596, -544.7325533024848, -763.2048804132796, -739.7691311269479, -824.1495719536343, -710.0983954664807, -569.4301622090443, -620.4315233941855, -970.0045234328868, -1067.8928525654064, -816.8554156838703, -780.1341603915353, -1054.5756392399649, -987.8104741172193, -826.7266489458918, -770.713468373902, -783.5125671089766, -642.5416510676502, -655.1582886824842, -620.6881366171439, -815.8500809726518, -758.4323431547602, -846.4322126456299, -694.6635463339022, -1107.573231941316, -751.1882768962611, -416.1501239530031, -467.050600291204, -720.3908557310855, -605.2173986323484, -1068.5916564180015, -874.2986752925311, -738.1516152379985, -691.2460352294241, -801.3893431102525, -716.4853136285915, -825.6934677850077, -615.7422793376439, -694.2164562904486, -891.9545078165829, -666.6104380247511, -552.8373735843545, -1112.823699856796, -519.9997425741633, -308.28382301090573, -423.48683626330006, -475.1921603230027, -570.2971677399692, -356.40798923950274, -740.8905816116494, -669.9377909848879, -484.53739912788717, -807.7263389712529, -681.8082066573677, -666.5934636902222, -881.1046434265544, -544.136104964867, -469.30573896074276, -902.9095886165971, -850.5972108992019, -756.4222565494592, -865.7404375196369, -1258.911760652912, -565.9822236500993, -705.4478638415109, -611.2258553216858, -653.320410738251, -866.1269169517573, -789.8844987931826, -960.7805966779694, -968.6082486048847, -827.9117297349418, -637.6223482786262, -471.54099854198716, -562.7613428530823, -1036.7485457166297, -835.1444152936571, -916.8798055822496, -612.6285304627245, -838.6797304564644, -915.8508553863994, -732.3409940018564], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.37702943460943, "mean_inference_ms": 0.4112840351999185, "mean_action_processing_ms": 0.09699654942184335, "mean_env_wait_ms": 2.7196300097625565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036361217498779297, "StateBufferConnector_ms": 0.002778291702270508, "ViewRequirementAgentConnector_ms": 0.06874251365661621}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.82836318520659, "num_env_steps_trained_throughput_per_sec": 41.82836318520659, "timesteps_total": 288000, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 2948.087, "sample_time_ms": 2944.348, "load_time_ms": 0.217, "load_throughput": 552366.637, "learn_time_ms": 2.785, "learn_throughput": 43081.837, "synch_weights_time_ms": 0.697}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "episodes_total": 2400, "training_iteration": 601, "trial_id": "53665_00000", "date": "2023-07-26_03-49-06", "timestamp": 1690332546, "time_this_iter_s": 11.478219032287598, "time_total_s": 7285.235835552216, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1663.910359621048, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 34.66470588235294, "ram_util_percent": 71.11176470588236}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.5128479003906, "policy_loss": -113893.2578125, "vf_loss": 5644369.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 566.0, "diff_num_grad_updates_vs_sampler_policy": 565.0}}, "num_env_steps_sampled": 288480, "num_env_steps_trained": 288480, "num_agent_steps_sampled": 288480, "num_agent_steps_trained": 288480}, "sampler_results": {"episode_reward_max": -308.28382301090573, "episode_reward_min": -1258.911760652912, "episode_reward_mean": -737.9079964783939, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-609.985177244056, -568.0533195590792, -931.8836352696122, -834.8408105474897, -925.5155738552007, -785.2826896370813, -908.2995469991157, -856.9118320764713, -480.97023180184084, -965.3187054622128, -526.9204647026459, -656.5994837806566, -471.29863448125815, -672.0187467705181, -710.4506096922596, -544.7325533024848, -763.2048804132796, -739.7691311269479, -824.1495719536343, -710.0983954664807, -569.4301622090443, -620.4315233941855, -970.0045234328868, -1067.8928525654064, -816.8554156838703, -780.1341603915353, -1054.5756392399649, -987.8104741172193, -826.7266489458918, -770.713468373902, -783.5125671089766, -642.5416510676502, -655.1582886824842, -620.6881366171439, -815.8500809726518, -758.4323431547602, -846.4322126456299, -694.6635463339022, -1107.573231941316, -751.1882768962611, -416.1501239530031, -467.050600291204, -720.3908557310855, -605.2173986323484, -1068.5916564180015, -874.2986752925311, -738.1516152379985, -691.2460352294241, -801.3893431102525, -716.4853136285915, -825.6934677850077, -615.7422793376439, -694.2164562904486, -891.9545078165829, -666.6104380247511, -552.8373735843545, -1112.823699856796, -519.9997425741633, -308.28382301090573, -423.48683626330006, -475.1921603230027, -570.2971677399692, -356.40798923950274, -740.8905816116494, -669.9377909848879, -484.53739912788717, -807.7263389712529, -681.8082066573677, -666.5934636902222, -881.1046434265544, -544.136104964867, -469.30573896074276, -902.9095886165971, -850.5972108992019, -756.4222565494592, -865.7404375196369, -1258.911760652912, -565.9822236500993, -705.4478638415109, -611.2258553216858, -653.320410738251, -866.1269169517573, -789.8844987931826, -960.7805966779694, -968.6082486048847, -827.9117297349418, -637.6223482786262, -471.54099854198716, -562.7613428530823, -1036.7485457166297, -835.1444152936571, -916.8798055822496, -612.6285304627245, -838.6797304564644, -915.8508553863994, -732.3409940018564, -690.1162216488492, -779.6795651570592, -555.1149056104323, -936.3447646139771], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.3757652207822, "mean_inference_ms": 0.4111448698307777, "mean_action_processing_ms": 0.09697436756716873, "mean_env_wait_ms": 2.7191192686800303, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036346912384033203, "StateBufferConnector_ms": 0.0027823448181152344, "ViewRequirementAgentConnector_ms": 0.06870627403259277}}, "episode_reward_max": -308.28382301090573, "episode_reward_min": -1258.911760652912, "episode_reward_mean": -737.9079964783939, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-609.985177244056, -568.0533195590792, -931.8836352696122, -834.8408105474897, -925.5155738552007, -785.2826896370813, -908.2995469991157, -856.9118320764713, -480.97023180184084, -965.3187054622128, -526.9204647026459, -656.5994837806566, -471.29863448125815, -672.0187467705181, -710.4506096922596, -544.7325533024848, -763.2048804132796, -739.7691311269479, -824.1495719536343, -710.0983954664807, -569.4301622090443, -620.4315233941855, -970.0045234328868, -1067.8928525654064, -816.8554156838703, -780.1341603915353, -1054.5756392399649, -987.8104741172193, -826.7266489458918, -770.713468373902, -783.5125671089766, -642.5416510676502, -655.1582886824842, -620.6881366171439, -815.8500809726518, -758.4323431547602, -846.4322126456299, -694.6635463339022, -1107.573231941316, -751.1882768962611, -416.1501239530031, -467.050600291204, -720.3908557310855, -605.2173986323484, -1068.5916564180015, -874.2986752925311, -738.1516152379985, -691.2460352294241, -801.3893431102525, -716.4853136285915, -825.6934677850077, -615.7422793376439, -694.2164562904486, -891.9545078165829, -666.6104380247511, -552.8373735843545, -1112.823699856796, -519.9997425741633, -308.28382301090573, -423.48683626330006, -475.1921603230027, -570.2971677399692, -356.40798923950274, -740.8905816116494, -669.9377909848879, -484.53739912788717, -807.7263389712529, -681.8082066573677, -666.5934636902222, -881.1046434265544, -544.136104964867, -469.30573896074276, -902.9095886165971, -850.5972108992019, -756.4222565494592, -865.7404375196369, -1258.911760652912, -565.9822236500993, -705.4478638415109, -611.2258553216858, -653.320410738251, -866.1269169517573, -789.8844987931826, -960.7805966779694, -968.6082486048847, -827.9117297349418, -637.6223482786262, -471.54099854198716, -562.7613428530823, -1036.7485457166297, -835.1444152936571, -916.8798055822496, -612.6285304627245, -838.6797304564644, -915.8508553863994, -732.3409940018564, -690.1162216488492, -779.6795651570592, -555.1149056104323, -936.3447646139771], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.3757652207822, "mean_inference_ms": 0.4111448698307777, "mean_action_processing_ms": 0.09697436756716873, "mean_env_wait_ms": 2.7191192686800303, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036346912384033203, "StateBufferConnector_ms": 0.0027823448181152344, "ViewRequirementAgentConnector_ms": 0.06870627403259277}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288480, "num_agent_steps_trained": 288480, "num_env_steps_sampled": 288480, "num_env_steps_trained": 288480, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.64826830734894, "num_env_steps_trained_throughput_per_sec": 41.64826830734894, "timesteps_total": 288480, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 288480, "timers": {"training_iteration_time_ms": 2904.701, "sample_time_ms": 2900.963, "load_time_ms": 0.216, "load_throughput": 556396.728, "learn_time_ms": 2.787, "learn_throughput": 43054.934, "synch_weights_time_ms": 0.697}, "counters": {"num_env_steps_sampled": 288480, "num_env_steps_trained": 288480, "num_agent_steps_sampled": 288480, "num_agent_steps_trained": 288480}, "done": false, "episodes_total": 2404, "training_iteration": 602, "trial_id": "53665_00000", "date": "2023-07-26_03-49-18", "timestamp": 1690332558, "time_this_iter_s": 11.52792501449585, "time_total_s": 7296.763760566711, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1675.4382846355438, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 34.8, "ram_util_percent": 71.28125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.45550537109375, "policy_loss": -89796.609375, "vf_loss": 3815151.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 570.0, "diff_num_grad_updates_vs_sampler_policy": 569.0}}, "num_env_steps_sampled": 288960, "num_env_steps_trained": 288960, "num_agent_steps_sampled": 288960, "num_agent_steps_trained": 288960}, "sampler_results": {"episode_reward_max": -308.28382301090573, "episode_reward_min": -1258.911760652912, "episode_reward_mean": -739.8082102094845, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-925.5155738552007, -785.2826896370813, -908.2995469991157, -856.9118320764713, -480.97023180184084, -965.3187054622128, -526.9204647026459, -656.5994837806566, -471.29863448125815, -672.0187467705181, -710.4506096922596, -544.7325533024848, -763.2048804132796, -739.7691311269479, -824.1495719536343, -710.0983954664807, -569.4301622090443, -620.4315233941855, -970.0045234328868, -1067.8928525654064, -816.8554156838703, -780.1341603915353, -1054.5756392399649, -987.8104741172193, -826.7266489458918, -770.713468373902, -783.5125671089766, -642.5416510676502, -655.1582886824842, -620.6881366171439, -815.8500809726518, -758.4323431547602, -846.4322126456299, -694.6635463339022, -1107.573231941316, -751.1882768962611, -416.1501239530031, -467.050600291204, -720.3908557310855, -605.2173986323484, -1068.5916564180015, -874.2986752925311, -738.1516152379985, -691.2460352294241, -801.3893431102525, -716.4853136285915, -825.6934677850077, -615.7422793376439, -694.2164562904486, -891.9545078165829, -666.6104380247511, -552.8373735843545, -1112.823699856796, -519.9997425741633, -308.28382301090573, -423.48683626330006, -475.1921603230027, -570.2971677399692, -356.40798923950274, -740.8905816116494, -669.9377909848879, -484.53739912788717, -807.7263389712529, -681.8082066573677, -666.5934636902222, -881.1046434265544, -544.136104964867, -469.30573896074276, -902.9095886165971, -850.5972108992019, -756.4222565494592, -865.7404375196369, -1258.911760652912, -565.9822236500993, -705.4478638415109, -611.2258553216858, -653.320410738251, -866.1269169517573, -789.8844987931826, -960.7805966779694, -968.6082486048847, -827.9117297349418, -637.6223482786262, -471.54099854198716, -562.7613428530823, -1036.7485457166297, -835.1444152936571, -916.8798055822496, -612.6285304627245, -838.6797304564644, -915.8508553863994, -732.3409940018564, -690.1162216488492, -779.6795651570592, -555.1149056104323, -936.3447646139771, -1042.3464040082167, -468.3265675424672, -939.7922804445831, -684.3190637340327], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.374551030670574, "mean_inference_ms": 0.4110049320444976, "mean_action_processing_ms": 0.0969518858073687, "mean_env_wait_ms": 2.7185967313695643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003623485565185547, "StateBufferConnector_ms": 0.002779722213745117, "ViewRequirementAgentConnector_ms": 0.06863784790039062}}, "episode_reward_max": -308.28382301090573, "episode_reward_min": -1258.911760652912, "episode_reward_mean": -739.8082102094845, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-925.5155738552007, -785.2826896370813, -908.2995469991157, -856.9118320764713, -480.97023180184084, -965.3187054622128, -526.9204647026459, -656.5994837806566, -471.29863448125815, -672.0187467705181, -710.4506096922596, -544.7325533024848, -763.2048804132796, -739.7691311269479, -824.1495719536343, -710.0983954664807, -569.4301622090443, -620.4315233941855, -970.0045234328868, -1067.8928525654064, -816.8554156838703, -780.1341603915353, -1054.5756392399649, -987.8104741172193, -826.7266489458918, -770.713468373902, -783.5125671089766, -642.5416510676502, -655.1582886824842, -620.6881366171439, -815.8500809726518, -758.4323431547602, -846.4322126456299, -694.6635463339022, -1107.573231941316, -751.1882768962611, -416.1501239530031, -467.050600291204, -720.3908557310855, -605.2173986323484, -1068.5916564180015, -874.2986752925311, -738.1516152379985, -691.2460352294241, -801.3893431102525, -716.4853136285915, -825.6934677850077, -615.7422793376439, -694.2164562904486, -891.9545078165829, -666.6104380247511, -552.8373735843545, -1112.823699856796, -519.9997425741633, -308.28382301090573, -423.48683626330006, -475.1921603230027, -570.2971677399692, -356.40798923950274, -740.8905816116494, -669.9377909848879, -484.53739912788717, -807.7263389712529, -681.8082066573677, -666.5934636902222, -881.1046434265544, -544.136104964867, -469.30573896074276, -902.9095886165971, -850.5972108992019, -756.4222565494592, -865.7404375196369, -1258.911760652912, -565.9822236500993, -705.4478638415109, -611.2258553216858, -653.320410738251, -866.1269169517573, -789.8844987931826, -960.7805966779694, -968.6082486048847, -827.9117297349418, -637.6223482786262, -471.54099854198716, -562.7613428530823, -1036.7485457166297, -835.1444152936571, -916.8798055822496, -612.6285304627245, -838.6797304564644, -915.8508553863994, -732.3409940018564, -690.1162216488492, -779.6795651570592, -555.1149056104323, -936.3447646139771, -1042.3464040082167, -468.3265675424672, -939.7922804445831, -684.3190637340327], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.374551030670574, "mean_inference_ms": 0.4110049320444976, "mean_action_processing_ms": 0.0969518858073687, "mean_env_wait_ms": 2.7185967313695643, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003623485565185547, "StateBufferConnector_ms": 0.002779722213745117, "ViewRequirementAgentConnector_ms": 0.06863784790039062}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288960, "num_agent_steps_trained": 288960, "num_env_steps_sampled": 288960, "num_env_steps_trained": 288960, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.101517260234644, "num_env_steps_trained_throughput_per_sec": 41.101517260234644, "timesteps_total": 288960, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 288960, "timers": {"training_iteration_time_ms": 2894.771, "sample_time_ms": 2891.055, "load_time_ms": 0.215, "load_throughput": 558495.872, "learn_time_ms": 2.765, "learn_throughput": 43391.97, "synch_weights_time_ms": 0.695}, "counters": {"num_env_steps_sampled": 288960, "num_env_steps_trained": 288960, "num_agent_steps_sampled": 288960, "num_agent_steps_trained": 288960}, "done": false, "episodes_total": 2408, "training_iteration": 603, "trial_id": "53665_00000", "date": "2023-07-26_03-49-29", "timestamp": 1690332569, "time_this_iter_s": 11.68115782737732, "time_total_s": 7308.444918394089, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1687.1194424629211, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 36.48823529411764, "ram_util_percent": 71.65294117647059}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.508544921875, "policy_loss": -125654.0390625, "vf_loss": 6565640.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 574.0, "diff_num_grad_updates_vs_sampler_policy": 573.0}}, "num_env_steps_sampled": 289440, "num_env_steps_trained": 289440, "num_agent_steps_sampled": 289440, "num_agent_steps_trained": 289440}, "sampler_results": {"episode_reward_max": -308.28382301090573, "episode_reward_min": -1258.911760652912, "episode_reward_mean": -734.6605969736291, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-480.97023180184084, -965.3187054622128, -526.9204647026459, -656.5994837806566, -471.29863448125815, -672.0187467705181, -710.4506096922596, -544.7325533024848, -763.2048804132796, -739.7691311269479, -824.1495719536343, -710.0983954664807, -569.4301622090443, -620.4315233941855, -970.0045234328868, -1067.8928525654064, -816.8554156838703, -780.1341603915353, -1054.5756392399649, -987.8104741172193, -826.7266489458918, -770.713468373902, -783.5125671089766, -642.5416510676502, -655.1582886824842, -620.6881366171439, -815.8500809726518, -758.4323431547602, -846.4322126456299, -694.6635463339022, -1107.573231941316, -751.1882768962611, -416.1501239530031, -467.050600291204, -720.3908557310855, -605.2173986323484, -1068.5916564180015, -874.2986752925311, -738.1516152379985, -691.2460352294241, -801.3893431102525, -716.4853136285915, -825.6934677850077, -615.7422793376439, -694.2164562904486, -891.9545078165829, -666.6104380247511, -552.8373735843545, -1112.823699856796, -519.9997425741633, -308.28382301090573, -423.48683626330006, -475.1921603230027, -570.2971677399692, -356.40798923950274, -740.8905816116494, -669.9377909848879, -484.53739912788717, -807.7263389712529, -681.8082066573677, -666.5934636902222, -881.1046434265544, -544.136104964867, -469.30573896074276, -902.9095886165971, -850.5972108992019, -756.4222565494592, -865.7404375196369, -1258.911760652912, -565.9822236500993, -705.4478638415109, -611.2258553216858, -653.320410738251, -866.1269169517573, -789.8844987931826, -960.7805966779694, -968.6082486048847, -827.9117297349418, -637.6223482786262, -471.54099854198716, -562.7613428530823, -1036.7485457166297, -835.1444152936571, -916.8798055822496, -612.6285304627245, -838.6797304564644, -915.8508553863994, -732.3409940018564, -690.1162216488492, -779.6795651570592, -555.1149056104323, -936.3447646139771, -1042.3464040082167, -468.3265675424672, -939.7922804445831, -684.3190637340327, -540.7743997995757, -783.5540047216905, -673.8388256749915, -963.081088786078], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.373617367341957, "mean_inference_ms": 0.41086659245003576, "mean_action_processing_ms": 0.09692963751778631, "mean_env_wait_ms": 2.718092950622339, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036287307739257812, "StateBufferConnector_ms": 0.0027990341186523438, "ViewRequirementAgentConnector_ms": 0.06866788864135742}}, "episode_reward_max": -308.28382301090573, "episode_reward_min": -1258.911760652912, "episode_reward_mean": -734.6605969736291, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-480.97023180184084, -965.3187054622128, -526.9204647026459, -656.5994837806566, -471.29863448125815, -672.0187467705181, -710.4506096922596, -544.7325533024848, -763.2048804132796, -739.7691311269479, -824.1495719536343, -710.0983954664807, -569.4301622090443, -620.4315233941855, -970.0045234328868, -1067.8928525654064, -816.8554156838703, -780.1341603915353, -1054.5756392399649, -987.8104741172193, -826.7266489458918, -770.713468373902, -783.5125671089766, -642.5416510676502, -655.1582886824842, -620.6881366171439, -815.8500809726518, -758.4323431547602, -846.4322126456299, -694.6635463339022, -1107.573231941316, -751.1882768962611, -416.1501239530031, -467.050600291204, -720.3908557310855, -605.2173986323484, -1068.5916564180015, -874.2986752925311, -738.1516152379985, -691.2460352294241, -801.3893431102525, -716.4853136285915, -825.6934677850077, -615.7422793376439, -694.2164562904486, -891.9545078165829, -666.6104380247511, -552.8373735843545, -1112.823699856796, -519.9997425741633, -308.28382301090573, -423.48683626330006, -475.1921603230027, -570.2971677399692, -356.40798923950274, -740.8905816116494, -669.9377909848879, -484.53739912788717, -807.7263389712529, -681.8082066573677, -666.5934636902222, -881.1046434265544, -544.136104964867, -469.30573896074276, -902.9095886165971, -850.5972108992019, -756.4222565494592, -865.7404375196369, -1258.911760652912, -565.9822236500993, -705.4478638415109, -611.2258553216858, -653.320410738251, -866.1269169517573, -789.8844987931826, -960.7805966779694, -968.6082486048847, -827.9117297349418, -637.6223482786262, -471.54099854198716, -562.7613428530823, -1036.7485457166297, -835.1444152936571, -916.8798055822496, -612.6285304627245, -838.6797304564644, -915.8508553863994, -732.3409940018564, -690.1162216488492, -779.6795651570592, -555.1149056104323, -936.3447646139771, -1042.3464040082167, -468.3265675424672, -939.7922804445831, -684.3190637340327, -540.7743997995757, -783.5540047216905, -673.8388256749915, -963.081088786078], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.373617367341957, "mean_inference_ms": 0.41086659245003576, "mean_action_processing_ms": 0.09692963751778631, "mean_env_wait_ms": 2.718092950622339, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036287307739257812, "StateBufferConnector_ms": 0.0027990341186523438, "ViewRequirementAgentConnector_ms": 0.06866788864135742}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 289440, "num_agent_steps_trained": 289440, "num_env_steps_sampled": 289440, "num_env_steps_trained": 289440, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.53150011004268, "num_env_steps_trained_throughput_per_sec": 40.53150011004268, "timesteps_total": 289440, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 289440, "timers": {"training_iteration_time_ms": 2928.641, "sample_time_ms": 2924.925, "load_time_ms": 0.216, "load_throughput": 556642.867, "learn_time_ms": 2.76, "learn_throughput": 43470.672, "synch_weights_time_ms": 0.699}, "counters": {"num_env_steps_sampled": 289440, "num_env_steps_trained": 289440, "num_agent_steps_sampled": 289440, "num_agent_steps_trained": 289440}, "done": false, "episodes_total": 2412, "training_iteration": 604, "trial_id": "53665_00000", "date": "2023-07-26_03-49-41", "timestamp": 1690332581, "time_this_iter_s": 11.845423221588135, "time_total_s": 7320.290341615677, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1698.9648656845093, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 37.65882352941177, "ram_util_percent": 71.76470588235294}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.49169921875, "policy_loss": -122222.3125, "vf_loss": 6628059.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 578.0, "diff_num_grad_updates_vs_sampler_policy": 577.0}}, "num_env_steps_sampled": 289920, "num_env_steps_trained": 289920, "num_agent_steps_sampled": 289920, "num_agent_steps_trained": 289920}, "sampler_results": {"episode_reward_max": -308.28382301090573, "episode_reward_min": -1258.911760652912, "episode_reward_mean": -741.9545089086773, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-471.29863448125815, -672.0187467705181, -710.4506096922596, -544.7325533024848, -763.2048804132796, -739.7691311269479, -824.1495719536343, -710.0983954664807, -569.4301622090443, -620.4315233941855, -970.0045234328868, -1067.8928525654064, -816.8554156838703, -780.1341603915353, -1054.5756392399649, -987.8104741172193, -826.7266489458918, -770.713468373902, -783.5125671089766, -642.5416510676502, -655.1582886824842, -620.6881366171439, -815.8500809726518, -758.4323431547602, -846.4322126456299, -694.6635463339022, -1107.573231941316, -751.1882768962611, -416.1501239530031, -467.050600291204, -720.3908557310855, -605.2173986323484, -1068.5916564180015, -874.2986752925311, -738.1516152379985, -691.2460352294241, -801.3893431102525, -716.4853136285915, -825.6934677850077, -615.7422793376439, -694.2164562904486, -891.9545078165829, -666.6104380247511, -552.8373735843545, -1112.823699856796, -519.9997425741633, -308.28382301090573, -423.48683626330006, -475.1921603230027, -570.2971677399692, -356.40798923950274, -740.8905816116494, -669.9377909848879, -484.53739912788717, -807.7263389712529, -681.8082066573677, -666.5934636902222, -881.1046434265544, -544.136104964867, -469.30573896074276, -902.9095886165971, -850.5972108992019, -756.4222565494592, -865.7404375196369, -1258.911760652912, -565.9822236500993, -705.4478638415109, -611.2258553216858, -653.320410738251, -866.1269169517573, -789.8844987931826, -960.7805966779694, -968.6082486048847, -827.9117297349418, -637.6223482786262, -471.54099854198716, -562.7613428530823, -1036.7485457166297, -835.1444152936571, -916.8798055822496, -612.6285304627245, -838.6797304564644, -915.8508553863994, -732.3409940018564, -690.1162216488492, -779.6795651570592, -555.1149056104323, -936.3447646139771, -1042.3464040082167, -468.3265675424672, -939.7922804445831, -684.3190637340327, -540.7743997995757, -783.5540047216905, -673.8388256749915, -963.081088786078, -710.1919984333938, -1027.9019545691815, -664.8463262061819, -956.2598000434107], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.372685682569053, "mean_inference_ms": 0.4107296699785292, "mean_action_processing_ms": 0.0969076316412396, "mean_env_wait_ms": 2.717592542009042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036313533782958984, "StateBufferConnector_ms": 0.0027914047241210938, "ViewRequirementAgentConnector_ms": 0.06873416900634766}}, "episode_reward_max": -308.28382301090573, "episode_reward_min": -1258.911760652912, "episode_reward_mean": -741.9545089086773, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-471.29863448125815, -672.0187467705181, -710.4506096922596, -544.7325533024848, -763.2048804132796, -739.7691311269479, -824.1495719536343, -710.0983954664807, -569.4301622090443, -620.4315233941855, -970.0045234328868, -1067.8928525654064, -816.8554156838703, -780.1341603915353, -1054.5756392399649, -987.8104741172193, -826.7266489458918, -770.713468373902, -783.5125671089766, -642.5416510676502, -655.1582886824842, -620.6881366171439, -815.8500809726518, -758.4323431547602, -846.4322126456299, -694.6635463339022, -1107.573231941316, -751.1882768962611, -416.1501239530031, -467.050600291204, -720.3908557310855, -605.2173986323484, -1068.5916564180015, -874.2986752925311, -738.1516152379985, -691.2460352294241, -801.3893431102525, -716.4853136285915, -825.6934677850077, -615.7422793376439, -694.2164562904486, -891.9545078165829, -666.6104380247511, -552.8373735843545, -1112.823699856796, -519.9997425741633, -308.28382301090573, -423.48683626330006, -475.1921603230027, -570.2971677399692, -356.40798923950274, -740.8905816116494, -669.9377909848879, -484.53739912788717, -807.7263389712529, -681.8082066573677, -666.5934636902222, -881.1046434265544, -544.136104964867, -469.30573896074276, -902.9095886165971, -850.5972108992019, -756.4222565494592, -865.7404375196369, -1258.911760652912, -565.9822236500993, -705.4478638415109, -611.2258553216858, -653.320410738251, -866.1269169517573, -789.8844987931826, -960.7805966779694, -968.6082486048847, -827.9117297349418, -637.6223482786262, -471.54099854198716, -562.7613428530823, -1036.7485457166297, -835.1444152936571, -916.8798055822496, -612.6285304627245, -838.6797304564644, -915.8508553863994, -732.3409940018564, -690.1162216488492, -779.6795651570592, -555.1149056104323, -936.3447646139771, -1042.3464040082167, -468.3265675424672, -939.7922804445831, -684.3190637340327, -540.7743997995757, -783.5540047216905, -673.8388256749915, -963.081088786078, -710.1919984333938, -1027.9019545691815, -664.8463262061819, -956.2598000434107], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.372685682569053, "mean_inference_ms": 0.4107296699785292, "mean_action_processing_ms": 0.0969076316412396, "mean_env_wait_ms": 2.717592542009042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036313533782958984, "StateBufferConnector_ms": 0.0027914047241210938, "ViewRequirementAgentConnector_ms": 0.06873416900634766}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 289920, "num_agent_steps_trained": 289920, "num_env_steps_sampled": 289920, "num_env_steps_trained": 289920, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.2610050422978, "num_env_steps_trained_throughput_per_sec": 41.2610050422978, "timesteps_total": 289920, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 289920, "timers": {"training_iteration_time_ms": 2930.948, "sample_time_ms": 2927.198, "load_time_ms": 0.216, "load_throughput": 555291.792, "learn_time_ms": 2.783, "learn_throughput": 43120.591, "synch_weights_time_ms": 0.712}, "counters": {"num_env_steps_sampled": 289920, "num_env_steps_trained": 289920, "num_agent_steps_sampled": 289920, "num_agent_steps_trained": 289920}, "done": false, "episodes_total": 2416, "training_iteration": 605, "trial_id": "53665_00000", "date": "2023-07-26_03-49-53", "timestamp": 1690332593, "time_this_iter_s": 11.636327028274536, "time_total_s": 7331.926668643951, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1710.6011927127838, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 35.125, "ram_util_percent": 71.45625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4443359375, "policy_loss": -81689.8125, "vf_loss": 3068137.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 582.0, "diff_num_grad_updates_vs_sampler_policy": 581.0}}, "num_env_steps_sampled": 290400, "num_env_steps_trained": 290400, "num_agent_steps_sampled": 290400, "num_agent_steps_trained": 290400}, "sampler_results": {"episode_reward_max": -308.28382301090573, "episode_reward_min": -1258.911760652912, "episode_reward_mean": -744.7659875939082, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-763.2048804132796, -739.7691311269479, -824.1495719536343, -710.0983954664807, -569.4301622090443, -620.4315233941855, -970.0045234328868, -1067.8928525654064, -816.8554156838703, -780.1341603915353, -1054.5756392399649, -987.8104741172193, -826.7266489458918, -770.713468373902, -783.5125671089766, -642.5416510676502, -655.1582886824842, -620.6881366171439, -815.8500809726518, -758.4323431547602, -846.4322126456299, -694.6635463339022, -1107.573231941316, -751.1882768962611, -416.1501239530031, -467.050600291204, -720.3908557310855, -605.2173986323484, -1068.5916564180015, -874.2986752925311, -738.1516152379985, -691.2460352294241, -801.3893431102525, -716.4853136285915, -825.6934677850077, -615.7422793376439, -694.2164562904486, -891.9545078165829, -666.6104380247511, -552.8373735843545, -1112.823699856796, -519.9997425741633, -308.28382301090573, -423.48683626330006, -475.1921603230027, -570.2971677399692, -356.40798923950274, -740.8905816116494, -669.9377909848879, -484.53739912788717, -807.7263389712529, -681.8082066573677, -666.5934636902222, -881.1046434265544, -544.136104964867, -469.30573896074276, -902.9095886165971, -850.5972108992019, -756.4222565494592, -865.7404375196369, -1258.911760652912, -565.9822236500993, -705.4478638415109, -611.2258553216858, -653.320410738251, -866.1269169517573, -789.8844987931826, -960.7805966779694, -968.6082486048847, -827.9117297349418, -637.6223482786262, -471.54099854198716, -562.7613428530823, -1036.7485457166297, -835.1444152936571, -916.8798055822496, -612.6285304627245, -838.6797304564644, -915.8508553863994, -732.3409940018564, -690.1162216488492, -779.6795651570592, -555.1149056104323, -936.3447646139771, -1042.3464040082167, -468.3265675424672, -939.7922804445831, -684.3190637340327, -540.7743997995757, -783.5540047216905, -673.8388256749915, -963.081088786078, -710.1919984333938, -1027.9019545691815, -664.8463262061819, -956.2598000434107, -549.9045453916402, -816.0290535357641, -698.6277163614873, -615.0870974807135], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.371428826912638, "mean_inference_ms": 0.41059158589260775, "mean_action_processing_ms": 0.0968855311067945, "mean_env_wait_ms": 2.7170661821066515, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003620624542236328, "StateBufferConnector_ms": 0.0027964115142822266, "ViewRequirementAgentConnector_ms": 0.06853866577148438}}, "episode_reward_max": -308.28382301090573, "episode_reward_min": -1258.911760652912, "episode_reward_mean": -744.7659875939082, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-763.2048804132796, -739.7691311269479, -824.1495719536343, -710.0983954664807, -569.4301622090443, -620.4315233941855, -970.0045234328868, -1067.8928525654064, -816.8554156838703, -780.1341603915353, -1054.5756392399649, -987.8104741172193, -826.7266489458918, -770.713468373902, -783.5125671089766, -642.5416510676502, -655.1582886824842, -620.6881366171439, -815.8500809726518, -758.4323431547602, -846.4322126456299, -694.6635463339022, -1107.573231941316, -751.1882768962611, -416.1501239530031, -467.050600291204, -720.3908557310855, -605.2173986323484, -1068.5916564180015, -874.2986752925311, -738.1516152379985, -691.2460352294241, -801.3893431102525, -716.4853136285915, -825.6934677850077, -615.7422793376439, -694.2164562904486, -891.9545078165829, -666.6104380247511, -552.8373735843545, -1112.823699856796, -519.9997425741633, -308.28382301090573, -423.48683626330006, -475.1921603230027, -570.2971677399692, -356.40798923950274, -740.8905816116494, -669.9377909848879, -484.53739912788717, -807.7263389712529, -681.8082066573677, -666.5934636902222, -881.1046434265544, -544.136104964867, -469.30573896074276, -902.9095886165971, -850.5972108992019, -756.4222565494592, -865.7404375196369, -1258.911760652912, -565.9822236500993, -705.4478638415109, -611.2258553216858, -653.320410738251, -866.1269169517573, -789.8844987931826, -960.7805966779694, -968.6082486048847, -827.9117297349418, -637.6223482786262, -471.54099854198716, -562.7613428530823, -1036.7485457166297, -835.1444152936571, -916.8798055822496, -612.6285304627245, -838.6797304564644, -915.8508553863994, -732.3409940018564, -690.1162216488492, -779.6795651570592, -555.1149056104323, -936.3447646139771, -1042.3464040082167, -468.3265675424672, -939.7922804445831, -684.3190637340327, -540.7743997995757, -783.5540047216905, -673.8388256749915, -963.081088786078, -710.1919984333938, -1027.9019545691815, -664.8463262061819, -956.2598000434107, -549.9045453916402, -816.0290535357641, -698.6277163614873, -615.0870974807135], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.371428826912638, "mean_inference_ms": 0.41059158589260775, "mean_action_processing_ms": 0.0968855311067945, "mean_env_wait_ms": 2.7170661821066515, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003620624542236328, "StateBufferConnector_ms": 0.0027964115142822266, "ViewRequirementAgentConnector_ms": 0.06853866577148438}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 290400, "num_agent_steps_trained": 290400, "num_env_steps_sampled": 290400, "num_env_steps_trained": 290400, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.62214970123772, "num_env_steps_trained_throughput_per_sec": 41.62214970123772, "timesteps_total": 290400, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 290400, "timers": {"training_iteration_time_ms": 2908.015, "sample_time_ms": 2904.263, "load_time_ms": 0.217, "load_throughput": 552184.838, "learn_time_ms": 2.771, "learn_throughput": 43303.864, "synch_weights_time_ms": 0.724}, "counters": {"num_env_steps_sampled": 290400, "num_env_steps_trained": 290400, "num_agent_steps_sampled": 290400, "num_agent_steps_trained": 290400}, "done": false, "episodes_total": 2420, "training_iteration": 606, "trial_id": "53665_00000", "date": "2023-07-26_03-50-04", "timestamp": 1690332604, "time_this_iter_s": 11.535130739212036, "time_total_s": 7343.461799383163, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1722.1363234519958, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 34.175000000000004, "ram_util_percent": 71.33125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.48211669921875, "policy_loss": -107615.078125, "vf_loss": 4781709.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 586.0, "diff_num_grad_updates_vs_sampler_policy": 585.0}}, "num_env_steps_sampled": 290880, "num_env_steps_trained": 290880, "num_agent_steps_sampled": 290880, "num_agent_steps_trained": 290880}, "sampler_results": {"episode_reward_max": -308.28382301090573, "episode_reward_min": -1258.911760652912, "episode_reward_mean": -744.654782895219, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-569.4301622090443, -620.4315233941855, -970.0045234328868, -1067.8928525654064, -816.8554156838703, -780.1341603915353, -1054.5756392399649, -987.8104741172193, -826.7266489458918, -770.713468373902, -783.5125671089766, -642.5416510676502, -655.1582886824842, -620.6881366171439, -815.8500809726518, -758.4323431547602, -846.4322126456299, -694.6635463339022, -1107.573231941316, -751.1882768962611, -416.1501239530031, -467.050600291204, -720.3908557310855, -605.2173986323484, -1068.5916564180015, -874.2986752925311, -738.1516152379985, -691.2460352294241, -801.3893431102525, -716.4853136285915, -825.6934677850077, -615.7422793376439, -694.2164562904486, -891.9545078165829, -666.6104380247511, -552.8373735843545, -1112.823699856796, -519.9997425741633, -308.28382301090573, -423.48683626330006, -475.1921603230027, -570.2971677399692, -356.40798923950274, -740.8905816116494, -669.9377909848879, -484.53739912788717, -807.7263389712529, -681.8082066573677, -666.5934636902222, -881.1046434265544, -544.136104964867, -469.30573896074276, -902.9095886165971, -850.5972108992019, -756.4222565494592, -865.7404375196369, -1258.911760652912, -565.9822236500993, -705.4478638415109, -611.2258553216858, -653.320410738251, -866.1269169517573, -789.8844987931826, -960.7805966779694, -968.6082486048847, -827.9117297349418, -637.6223482786262, -471.54099854198716, -562.7613428530823, -1036.7485457166297, -835.1444152936571, -916.8798055822496, -612.6285304627245, -838.6797304564644, -915.8508553863994, -732.3409940018564, -690.1162216488492, -779.6795651570592, -555.1149056104323, -936.3447646139771, -1042.3464040082167, -468.3265675424672, -939.7922804445831, -684.3190637340327, -540.7743997995757, -783.5540047216905, -673.8388256749915, -963.081088786078, -710.1919984333938, -1027.9019545691815, -664.8463262061819, -956.2598000434107, -549.9045453916402, -816.0290535357641, -698.6277163614873, -615.0870974807135, -750.0913896161829, -582.127437945606, -860.9710669091851, -832.9116146204669], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.370068599092136, "mean_inference_ms": 0.41045598513245823, "mean_action_processing_ms": 0.09686389627782299, "mean_env_wait_ms": 2.716530317926115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003624439239501953, "StateBufferConnector_ms": 0.0027968883514404297, "ViewRequirementAgentConnector_ms": 0.06853032112121582}}, "episode_reward_max": -308.28382301090573, "episode_reward_min": -1258.911760652912, "episode_reward_mean": -744.654782895219, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-569.4301622090443, -620.4315233941855, -970.0045234328868, -1067.8928525654064, -816.8554156838703, -780.1341603915353, -1054.5756392399649, -987.8104741172193, -826.7266489458918, -770.713468373902, -783.5125671089766, -642.5416510676502, -655.1582886824842, -620.6881366171439, -815.8500809726518, -758.4323431547602, -846.4322126456299, -694.6635463339022, -1107.573231941316, -751.1882768962611, -416.1501239530031, -467.050600291204, -720.3908557310855, -605.2173986323484, -1068.5916564180015, -874.2986752925311, -738.1516152379985, -691.2460352294241, -801.3893431102525, -716.4853136285915, -825.6934677850077, -615.7422793376439, -694.2164562904486, -891.9545078165829, -666.6104380247511, -552.8373735843545, -1112.823699856796, -519.9997425741633, -308.28382301090573, -423.48683626330006, -475.1921603230027, -570.2971677399692, -356.40798923950274, -740.8905816116494, -669.9377909848879, -484.53739912788717, -807.7263389712529, -681.8082066573677, -666.5934636902222, -881.1046434265544, -544.136104964867, -469.30573896074276, -902.9095886165971, -850.5972108992019, -756.4222565494592, -865.7404375196369, -1258.911760652912, -565.9822236500993, -705.4478638415109, -611.2258553216858, -653.320410738251, -866.1269169517573, -789.8844987931826, -960.7805966779694, -968.6082486048847, -827.9117297349418, -637.6223482786262, -471.54099854198716, -562.7613428530823, -1036.7485457166297, -835.1444152936571, -916.8798055822496, -612.6285304627245, -838.6797304564644, -915.8508553863994, -732.3409940018564, -690.1162216488492, -779.6795651570592, -555.1149056104323, -936.3447646139771, -1042.3464040082167, -468.3265675424672, -939.7922804445831, -684.3190637340327, -540.7743997995757, -783.5540047216905, -673.8388256749915, -963.081088786078, -710.1919984333938, -1027.9019545691815, -664.8463262061819, -956.2598000434107, -549.9045453916402, -816.0290535357641, -698.6277163614873, -615.0870974807135, -750.0913896161829, -582.127437945606, -860.9710669091851, -832.9116146204669], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.370068599092136, "mean_inference_ms": 0.41045598513245823, "mean_action_processing_ms": 0.09686389627782299, "mean_env_wait_ms": 2.716530317926115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003624439239501953, "StateBufferConnector_ms": 0.0027968883514404297, "ViewRequirementAgentConnector_ms": 0.06853032112121582}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 290880, "num_agent_steps_trained": 290880, "num_env_steps_sampled": 290880, "num_env_steps_trained": 290880, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.252668006603656, "num_env_steps_trained_throughput_per_sec": 41.252668006603656, "timesteps_total": 290880, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 290880, "timers": {"training_iteration_time_ms": 2903.766, "sample_time_ms": 2900.009, "load_time_ms": 0.218, "load_throughput": 551217.26, "learn_time_ms": 2.777, "learn_throughput": 43216.486, "synch_weights_time_ms": 0.723}, "counters": {"num_env_steps_sampled": 290880, "num_env_steps_trained": 290880, "num_agent_steps_sampled": 290880, "num_agent_steps_trained": 290880}, "done": false, "episodes_total": 2424, "training_iteration": 607, "trial_id": "53665_00000", "date": "2023-07-26_03-50-16", "timestamp": 1690332616, "time_this_iter_s": 11.638399839401245, "time_total_s": 7355.100199222565, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1733.774723291397, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 38.38235294117648, "ram_util_percent": 71.8235294117647}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4644775390625, "policy_loss": -60436.41015625, "vf_loss": 1889468.375}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 590.0, "diff_num_grad_updates_vs_sampler_policy": 589.0}}, "num_env_steps_sampled": 291360, "num_env_steps_trained": 291360, "num_agent_steps_sampled": 291360, "num_agent_steps_trained": 291360}, "sampler_results": {"episode_reward_max": -308.28382301090573, "episode_reward_min": -1258.911760652912, "episode_reward_mean": -742.0562380020465, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-816.8554156838703, -780.1341603915353, -1054.5756392399649, -987.8104741172193, -826.7266489458918, -770.713468373902, -783.5125671089766, -642.5416510676502, -655.1582886824842, -620.6881366171439, -815.8500809726518, -758.4323431547602, -846.4322126456299, -694.6635463339022, -1107.573231941316, -751.1882768962611, -416.1501239530031, -467.050600291204, -720.3908557310855, -605.2173986323484, -1068.5916564180015, -874.2986752925311, -738.1516152379985, -691.2460352294241, -801.3893431102525, -716.4853136285915, -825.6934677850077, -615.7422793376439, -694.2164562904486, -891.9545078165829, -666.6104380247511, -552.8373735843545, -1112.823699856796, -519.9997425741633, -308.28382301090573, -423.48683626330006, -475.1921603230027, -570.2971677399692, -356.40798923950274, -740.8905816116494, -669.9377909848879, -484.53739912788717, -807.7263389712529, -681.8082066573677, -666.5934636902222, -881.1046434265544, -544.136104964867, -469.30573896074276, -902.9095886165971, -850.5972108992019, -756.4222565494592, -865.7404375196369, -1258.911760652912, -565.9822236500993, -705.4478638415109, -611.2258553216858, -653.320410738251, -866.1269169517573, -789.8844987931826, -960.7805966779694, -968.6082486048847, -827.9117297349418, -637.6223482786262, -471.54099854198716, -562.7613428530823, -1036.7485457166297, -835.1444152936571, -916.8798055822496, -612.6285304627245, -838.6797304564644, -915.8508553863994, -732.3409940018564, -690.1162216488492, -779.6795651570592, -555.1149056104323, -936.3447646139771, -1042.3464040082167, -468.3265675424672, -939.7922804445831, -684.3190637340327, -540.7743997995757, -783.5540047216905, -673.8388256749915, -963.081088786078, -710.1919984333938, -1027.9019545691815, -664.8463262061819, -956.2598000434107, -549.9045453916402, -816.0290535357641, -698.6277163614873, -615.0870974807135, -750.0913896161829, -582.127437945606, -860.9710669091851, -832.9116146204669, -934.1471091532792, -942.6333953506391, -644.3010386931793, -446.82302908714126], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.368783292993324, "mean_inference_ms": 0.4103208888362153, "mean_action_processing_ms": 0.09684229948045413, "mean_env_wait_ms": 2.716008268024563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003618001937866211, "StateBufferConnector_ms": 0.0027875900268554688, "ViewRequirementAgentConnector_ms": 0.06838512420654297}}, "episode_reward_max": -308.28382301090573, "episode_reward_min": -1258.911760652912, "episode_reward_mean": -742.0562380020465, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-816.8554156838703, -780.1341603915353, -1054.5756392399649, -987.8104741172193, -826.7266489458918, -770.713468373902, -783.5125671089766, -642.5416510676502, -655.1582886824842, -620.6881366171439, -815.8500809726518, -758.4323431547602, -846.4322126456299, -694.6635463339022, -1107.573231941316, -751.1882768962611, -416.1501239530031, -467.050600291204, -720.3908557310855, -605.2173986323484, -1068.5916564180015, -874.2986752925311, -738.1516152379985, -691.2460352294241, -801.3893431102525, -716.4853136285915, -825.6934677850077, -615.7422793376439, -694.2164562904486, -891.9545078165829, -666.6104380247511, -552.8373735843545, -1112.823699856796, -519.9997425741633, -308.28382301090573, -423.48683626330006, -475.1921603230027, -570.2971677399692, -356.40798923950274, -740.8905816116494, -669.9377909848879, -484.53739912788717, -807.7263389712529, -681.8082066573677, -666.5934636902222, -881.1046434265544, -544.136104964867, -469.30573896074276, -902.9095886165971, -850.5972108992019, -756.4222565494592, -865.7404375196369, -1258.911760652912, -565.9822236500993, -705.4478638415109, -611.2258553216858, -653.320410738251, -866.1269169517573, -789.8844987931826, -960.7805966779694, -968.6082486048847, -827.9117297349418, -637.6223482786262, -471.54099854198716, -562.7613428530823, -1036.7485457166297, -835.1444152936571, -916.8798055822496, -612.6285304627245, -838.6797304564644, -915.8508553863994, -732.3409940018564, -690.1162216488492, -779.6795651570592, -555.1149056104323, -936.3447646139771, -1042.3464040082167, -468.3265675424672, -939.7922804445831, -684.3190637340327, -540.7743997995757, -783.5540047216905, -673.8388256749915, -963.081088786078, -710.1919984333938, -1027.9019545691815, -664.8463262061819, -956.2598000434107, -549.9045453916402, -816.0290535357641, -698.6277163614873, -615.0870974807135, -750.0913896161829, -582.127437945606, -860.9710669091851, -832.9116146204669, -934.1471091532792, -942.6333953506391, -644.3010386931793, -446.82302908714126], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.368783292993324, "mean_inference_ms": 0.4103208888362153, "mean_action_processing_ms": 0.09684229948045413, "mean_env_wait_ms": 2.716008268024563, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003618001937866211, "StateBufferConnector_ms": 0.0027875900268554688, "ViewRequirementAgentConnector_ms": 0.06838512420654297}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 291360, "num_agent_steps_trained": 291360, "num_env_steps_sampled": 291360, "num_env_steps_trained": 291360, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.642931059616274, "num_env_steps_trained_throughput_per_sec": 40.642931059616274, "timesteps_total": 291360, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 291360, "timers": {"training_iteration_time_ms": 2928.578, "sample_time_ms": 2924.849, "load_time_ms": 0.215, "load_throughput": 558124.285, "learn_time_ms": 2.769, "learn_throughput": 43342.646, "synch_weights_time_ms": 0.707}, "counters": {"num_env_steps_sampled": 291360, "num_env_steps_trained": 291360, "num_agent_steps_sampled": 291360, "num_agent_steps_trained": 291360}, "done": false, "episodes_total": 2428, "training_iteration": 608, "trial_id": "53665_00000", "date": "2023-07-26_03-50-28", "timestamp": 1690332628, "time_this_iter_s": 11.812956094741821, "time_total_s": 7366.9131553173065, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1745.587679386139, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 37.982352941176465, "ram_util_percent": 72.51764705882353}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4422302246094, "policy_loss": -55132.46875, "vf_loss": 1585516.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 594.0, "diff_num_grad_updates_vs_sampler_policy": 593.0}}, "num_env_steps_sampled": 291840, "num_env_steps_trained": 291840, "num_agent_steps_sampled": 291840, "num_agent_steps_trained": 291840}, "sampler_results": {"episode_reward_max": -308.28382301090573, "episode_reward_min": -1258.911760652912, "episode_reward_mean": -731.0647975309721, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-826.7266489458918, -770.713468373902, -783.5125671089766, -642.5416510676502, -655.1582886824842, -620.6881366171439, -815.8500809726518, -758.4323431547602, -846.4322126456299, -694.6635463339022, -1107.573231941316, -751.1882768962611, -416.1501239530031, -467.050600291204, -720.3908557310855, -605.2173986323484, -1068.5916564180015, -874.2986752925311, -738.1516152379985, -691.2460352294241, -801.3893431102525, -716.4853136285915, -825.6934677850077, -615.7422793376439, -694.2164562904486, -891.9545078165829, -666.6104380247511, -552.8373735843545, -1112.823699856796, -519.9997425741633, -308.28382301090573, -423.48683626330006, -475.1921603230027, -570.2971677399692, -356.40798923950274, -740.8905816116494, -669.9377909848879, -484.53739912788717, -807.7263389712529, -681.8082066573677, -666.5934636902222, -881.1046434265544, -544.136104964867, -469.30573896074276, -902.9095886165971, -850.5972108992019, -756.4222565494592, -865.7404375196369, -1258.911760652912, -565.9822236500993, -705.4478638415109, -611.2258553216858, -653.320410738251, -866.1269169517573, -789.8844987931826, -960.7805966779694, -968.6082486048847, -827.9117297349418, -637.6223482786262, -471.54099854198716, -562.7613428530823, -1036.7485457166297, -835.1444152936571, -916.8798055822496, -612.6285304627245, -838.6797304564644, -915.8508553863994, -732.3409940018564, -690.1162216488492, -779.6795651570592, -555.1149056104323, -936.3447646139771, -1042.3464040082167, -468.3265675424672, -939.7922804445831, -684.3190637340327, -540.7743997995757, -783.5540047216905, -673.8388256749915, -963.081088786078, -710.1919984333938, -1027.9019545691815, -664.8463262061819, -956.2598000434107, -549.9045453916402, -816.0290535357641, -698.6277163614873, -615.0870974807135, -750.0913896161829, -582.127437945606, -860.9710669091851, -832.9116146204669, -934.1471091532792, -942.6333953506391, -644.3010386931793, -446.82302908714126, -562.8365451590711, -899.4382101971137, -681.7546898899897, -396.20219707899054], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.367790477357545, "mean_inference_ms": 0.41019180799712884, "mean_action_processing_ms": 0.09682167715286621, "mean_env_wait_ms": 2.715518932398358, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003600597381591797, "StateBufferConnector_ms": 0.002779245376586914, "ViewRequirementAgentConnector_ms": 0.06819534301757812}}, "episode_reward_max": -308.28382301090573, "episode_reward_min": -1258.911760652912, "episode_reward_mean": -731.0647975309721, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-826.7266489458918, -770.713468373902, -783.5125671089766, -642.5416510676502, -655.1582886824842, -620.6881366171439, -815.8500809726518, -758.4323431547602, -846.4322126456299, -694.6635463339022, -1107.573231941316, -751.1882768962611, -416.1501239530031, -467.050600291204, -720.3908557310855, -605.2173986323484, -1068.5916564180015, -874.2986752925311, -738.1516152379985, -691.2460352294241, -801.3893431102525, -716.4853136285915, -825.6934677850077, -615.7422793376439, -694.2164562904486, -891.9545078165829, -666.6104380247511, -552.8373735843545, -1112.823699856796, -519.9997425741633, -308.28382301090573, -423.48683626330006, -475.1921603230027, -570.2971677399692, -356.40798923950274, -740.8905816116494, -669.9377909848879, -484.53739912788717, -807.7263389712529, -681.8082066573677, -666.5934636902222, -881.1046434265544, -544.136104964867, -469.30573896074276, -902.9095886165971, -850.5972108992019, -756.4222565494592, -865.7404375196369, -1258.911760652912, -565.9822236500993, -705.4478638415109, -611.2258553216858, -653.320410738251, -866.1269169517573, -789.8844987931826, -960.7805966779694, -968.6082486048847, -827.9117297349418, -637.6223482786262, -471.54099854198716, -562.7613428530823, -1036.7485457166297, -835.1444152936571, -916.8798055822496, -612.6285304627245, -838.6797304564644, -915.8508553863994, -732.3409940018564, -690.1162216488492, -779.6795651570592, -555.1149056104323, -936.3447646139771, -1042.3464040082167, -468.3265675424672, -939.7922804445831, -684.3190637340327, -540.7743997995757, -783.5540047216905, -673.8388256749915, -963.081088786078, -710.1919984333938, -1027.9019545691815, -664.8463262061819, -956.2598000434107, -549.9045453916402, -816.0290535357641, -698.6277163614873, -615.0870974807135, -750.0913896161829, -582.127437945606, -860.9710669091851, -832.9116146204669, -934.1471091532792, -942.6333953506391, -644.3010386931793, -446.82302908714126, -562.8365451590711, -899.4382101971137, -681.7546898899897, -396.20219707899054], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.367790477357545, "mean_inference_ms": 0.41019180799712884, "mean_action_processing_ms": 0.09682167715286621, "mean_env_wait_ms": 2.715518932398358, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003600597381591797, "StateBufferConnector_ms": 0.002779245376586914, "ViewRequirementAgentConnector_ms": 0.06819534301757812}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 291840, "num_agent_steps_trained": 291840, "num_env_steps_sampled": 291840, "num_env_steps_trained": 291840, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.47672102812009, "num_env_steps_trained_throughput_per_sec": 40.47672102812009, "timesteps_total": 291840, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 291840, "timers": {"training_iteration_time_ms": 2944.927, "sample_time_ms": 2941.189, "load_time_ms": 0.216, "load_throughput": 554985.643, "learn_time_ms": 2.784, "learn_throughput": 43102.128, "synch_weights_time_ms": 0.7}, "counters": {"num_env_steps_sampled": 291840, "num_env_steps_trained": 291840, "num_agent_steps_sampled": 291840, "num_agent_steps_trained": 291840}, "done": false, "episodes_total": 2432, "training_iteration": 609, "trial_id": "53665_00000", "date": "2023-07-26_03-50-40", "timestamp": 1690332640, "time_this_iter_s": 11.861544847488403, "time_total_s": 7378.774700164795, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1757.4492242336273, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 36.475, "ram_util_percent": 72.3125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.46856689453125, "policy_loss": -94669.765625, "vf_loss": 3518733.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 598.0, "diff_num_grad_updates_vs_sampler_policy": 597.0}}, "num_env_steps_sampled": 292320, "num_env_steps_trained": 292320, "num_agent_steps_sampled": 292320, "num_agent_steps_trained": 292320}, "sampler_results": {"episode_reward_max": -308.28382301090573, "episode_reward_min": -1258.911760652912, "episode_reward_mean": -735.0653188558516, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-655.1582886824842, -620.6881366171439, -815.8500809726518, -758.4323431547602, -846.4322126456299, -694.6635463339022, -1107.573231941316, -751.1882768962611, -416.1501239530031, -467.050600291204, -720.3908557310855, -605.2173986323484, -1068.5916564180015, -874.2986752925311, -738.1516152379985, -691.2460352294241, -801.3893431102525, -716.4853136285915, -825.6934677850077, -615.7422793376439, -694.2164562904486, -891.9545078165829, -666.6104380247511, -552.8373735843545, -1112.823699856796, -519.9997425741633, -308.28382301090573, -423.48683626330006, -475.1921603230027, -570.2971677399692, -356.40798923950274, -740.8905816116494, -669.9377909848879, -484.53739912788717, -807.7263389712529, -681.8082066573677, -666.5934636902222, -881.1046434265544, -544.136104964867, -469.30573896074276, -902.9095886165971, -850.5972108992019, -756.4222565494592, -865.7404375196369, -1258.911760652912, -565.9822236500993, -705.4478638415109, -611.2258553216858, -653.320410738251, -866.1269169517573, -789.8844987931826, -960.7805966779694, -968.6082486048847, -827.9117297349418, -637.6223482786262, -471.54099854198716, -562.7613428530823, -1036.7485457166297, -835.1444152936571, -916.8798055822496, -612.6285304627245, -838.6797304564644, -915.8508553863994, -732.3409940018564, -690.1162216488492, -779.6795651570592, -555.1149056104323, -936.3447646139771, -1042.3464040082167, -468.3265675424672, -939.7922804445831, -684.3190637340327, -540.7743997995757, -783.5540047216905, -673.8388256749915, -963.081088786078, -710.1919984333938, -1027.9019545691815, -664.8463262061819, -956.2598000434107, -549.9045453916402, -816.0290535357641, -698.6277163614873, -615.0870974807135, -750.0913896161829, -582.127437945606, -860.9710669091851, -832.9116146204669, -934.1471091532792, -942.6333953506391, -644.3010386931793, -446.82302908714126, -562.8365451590711, -899.4382101971137, -681.7546898899897, -396.20219707899054, -1153.319216414967, -906.6698809109502, -724.3444934773449, -639.2128771811185], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.366483693028893, "mean_inference_ms": 0.41006601218725364, "mean_action_processing_ms": 0.09680161652575209, "mean_env_wait_ms": 2.7150107310885527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003597259521484375, "StateBufferConnector_ms": 0.0027840137481689453, "ViewRequirementAgentConnector_ms": 0.06812596321105957}}, "episode_reward_max": -308.28382301090573, "episode_reward_min": -1258.911760652912, "episode_reward_mean": -735.0653188558516, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-655.1582886824842, -620.6881366171439, -815.8500809726518, -758.4323431547602, -846.4322126456299, -694.6635463339022, -1107.573231941316, -751.1882768962611, -416.1501239530031, -467.050600291204, -720.3908557310855, -605.2173986323484, -1068.5916564180015, -874.2986752925311, -738.1516152379985, -691.2460352294241, -801.3893431102525, -716.4853136285915, -825.6934677850077, -615.7422793376439, -694.2164562904486, -891.9545078165829, -666.6104380247511, -552.8373735843545, -1112.823699856796, -519.9997425741633, -308.28382301090573, -423.48683626330006, -475.1921603230027, -570.2971677399692, -356.40798923950274, -740.8905816116494, -669.9377909848879, -484.53739912788717, -807.7263389712529, -681.8082066573677, -666.5934636902222, -881.1046434265544, -544.136104964867, -469.30573896074276, -902.9095886165971, -850.5972108992019, -756.4222565494592, -865.7404375196369, -1258.911760652912, -565.9822236500993, -705.4478638415109, -611.2258553216858, -653.320410738251, -866.1269169517573, -789.8844987931826, -960.7805966779694, -968.6082486048847, -827.9117297349418, -637.6223482786262, -471.54099854198716, -562.7613428530823, -1036.7485457166297, -835.1444152936571, -916.8798055822496, -612.6285304627245, -838.6797304564644, -915.8508553863994, -732.3409940018564, -690.1162216488492, -779.6795651570592, -555.1149056104323, -936.3447646139771, -1042.3464040082167, -468.3265675424672, -939.7922804445831, -684.3190637340327, -540.7743997995757, -783.5540047216905, -673.8388256749915, -963.081088786078, -710.1919984333938, -1027.9019545691815, -664.8463262061819, -956.2598000434107, -549.9045453916402, -816.0290535357641, -698.6277163614873, -615.0870974807135, -750.0913896161829, -582.127437945606, -860.9710669091851, -832.9116146204669, -934.1471091532792, -942.6333953506391, -644.3010386931793, -446.82302908714126, -562.8365451590711, -899.4382101971137, -681.7546898899897, -396.20219707899054, -1153.319216414967, -906.6698809109502, -724.3444934773449, -639.2128771811185], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.366483693028893, "mean_inference_ms": 0.41006601218725364, "mean_action_processing_ms": 0.09680161652575209, "mean_env_wait_ms": 2.7150107310885527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003597259521484375, "StateBufferConnector_ms": 0.0027840137481689453, "ViewRequirementAgentConnector_ms": 0.06812596321105957}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 292320, "num_agent_steps_trained": 292320, "num_env_steps_sampled": 292320, "num_env_steps_trained": 292320, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.50129160604286, "num_env_steps_trained_throughput_per_sec": 41.50129160604286, "timesteps_total": 292320, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 292320, "timers": {"training_iteration_time_ms": 2922.799, "sample_time_ms": 2919.073, "load_time_ms": 0.216, "load_throughput": 556704.435, "learn_time_ms": 2.775, "learn_throughput": 43244.706, "synch_weights_time_ms": 0.697}, "counters": {"num_env_steps_sampled": 292320, "num_env_steps_trained": 292320, "num_agent_steps_sampled": 292320, "num_agent_steps_trained": 292320}, "done": false, "episodes_total": 2436, "training_iteration": 610, "trial_id": "53665_00000", "date": "2023-07-26_03-50-51", "timestamp": 1690332651, "time_this_iter_s": 11.568654775619507, "time_total_s": 7390.343354940414, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1769.0178790092468, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 32.2235294117647, "ram_util_percent": 71.42941176470588}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.48333740234375, "policy_loss": -97863.9453125, "vf_loss": 4437905.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 602.0, "diff_num_grad_updates_vs_sampler_policy": 601.0}}, "num_env_steps_sampled": 292800, "num_env_steps_trained": 292800, "num_agent_steps_sampled": 292800, "num_agent_steps_trained": 292800}, "sampler_results": {"episode_reward_max": -308.28382301090573, "episode_reward_min": -1258.911760652912, "episode_reward_mean": -743.2603415458232, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-846.4322126456299, -694.6635463339022, -1107.573231941316, -751.1882768962611, -416.1501239530031, -467.050600291204, -720.3908557310855, -605.2173986323484, -1068.5916564180015, -874.2986752925311, -738.1516152379985, -691.2460352294241, -801.3893431102525, -716.4853136285915, -825.6934677850077, -615.7422793376439, -694.2164562904486, -891.9545078165829, -666.6104380247511, -552.8373735843545, -1112.823699856796, -519.9997425741633, -308.28382301090573, -423.48683626330006, -475.1921603230027, -570.2971677399692, -356.40798923950274, -740.8905816116494, -669.9377909848879, -484.53739912788717, -807.7263389712529, -681.8082066573677, -666.5934636902222, -881.1046434265544, -544.136104964867, -469.30573896074276, -902.9095886165971, -850.5972108992019, -756.4222565494592, -865.7404375196369, -1258.911760652912, -565.9822236500993, -705.4478638415109, -611.2258553216858, -653.320410738251, -866.1269169517573, -789.8844987931826, -960.7805966779694, -968.6082486048847, -827.9117297349418, -637.6223482786262, -471.54099854198716, -562.7613428530823, -1036.7485457166297, -835.1444152936571, -916.8798055822496, -612.6285304627245, -838.6797304564644, -915.8508553863994, -732.3409940018564, -690.1162216488492, -779.6795651570592, -555.1149056104323, -936.3447646139771, -1042.3464040082167, -468.3265675424672, -939.7922804445831, -684.3190637340327, -540.7743997995757, -783.5540047216905, -673.8388256749915, -963.081088786078, -710.1919984333938, -1027.9019545691815, -664.8463262061819, -956.2598000434107, -549.9045453916402, -816.0290535357641, -698.6277163614873, -615.0870974807135, -750.0913896161829, -582.127437945606, -860.9710669091851, -832.9116146204669, -934.1471091532792, -942.6333953506391, -644.3010386931793, -446.82302908714126, -562.8365451590711, -899.4382101971137, -681.7546898899897, -396.20219707899054, -1153.319216414967, -906.6698809109502, -724.3444934773449, -639.2128771811185, -1068.6151542301675, -885.8256411502261, -974.4476874015886, -740.7426356422269], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.36487942267354, "mean_inference_ms": 0.40994216912370957, "mean_action_processing_ms": 0.09678189565432033, "mean_env_wait_ms": 2.714492684176251, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003603219985961914, "StateBufferConnector_ms": 0.0027878284454345703, "ViewRequirementAgentConnector_ms": 0.06817984580993652}}, "episode_reward_max": -308.28382301090573, "episode_reward_min": -1258.911760652912, "episode_reward_mean": -743.2603415458232, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-846.4322126456299, -694.6635463339022, -1107.573231941316, -751.1882768962611, -416.1501239530031, -467.050600291204, -720.3908557310855, -605.2173986323484, -1068.5916564180015, -874.2986752925311, -738.1516152379985, -691.2460352294241, -801.3893431102525, -716.4853136285915, -825.6934677850077, -615.7422793376439, -694.2164562904486, -891.9545078165829, -666.6104380247511, -552.8373735843545, -1112.823699856796, -519.9997425741633, -308.28382301090573, -423.48683626330006, -475.1921603230027, -570.2971677399692, -356.40798923950274, -740.8905816116494, -669.9377909848879, -484.53739912788717, -807.7263389712529, -681.8082066573677, -666.5934636902222, -881.1046434265544, -544.136104964867, -469.30573896074276, -902.9095886165971, -850.5972108992019, -756.4222565494592, -865.7404375196369, -1258.911760652912, -565.9822236500993, -705.4478638415109, -611.2258553216858, -653.320410738251, -866.1269169517573, -789.8844987931826, -960.7805966779694, -968.6082486048847, -827.9117297349418, -637.6223482786262, -471.54099854198716, -562.7613428530823, -1036.7485457166297, -835.1444152936571, -916.8798055822496, -612.6285304627245, -838.6797304564644, -915.8508553863994, -732.3409940018564, -690.1162216488492, -779.6795651570592, -555.1149056104323, -936.3447646139771, -1042.3464040082167, -468.3265675424672, -939.7922804445831, -684.3190637340327, -540.7743997995757, -783.5540047216905, -673.8388256749915, -963.081088786078, -710.1919984333938, -1027.9019545691815, -664.8463262061819, -956.2598000434107, -549.9045453916402, -816.0290535357641, -698.6277163614873, -615.0870974807135, -750.0913896161829, -582.127437945606, -860.9710669091851, -832.9116146204669, -934.1471091532792, -942.6333953506391, -644.3010386931793, -446.82302908714126, -562.8365451590711, -899.4382101971137, -681.7546898899897, -396.20219707899054, -1153.319216414967, -906.6698809109502, -724.3444934773449, -639.2128771811185, -1068.6151542301675, -885.8256411502261, -974.4476874015886, -740.7426356422269], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.36487942267354, "mean_inference_ms": 0.40994216912370957, "mean_action_processing_ms": 0.09678189565432033, "mean_env_wait_ms": 2.714492684176251, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003603219985961914, "StateBufferConnector_ms": 0.0027878284454345703, "ViewRequirementAgentConnector_ms": 0.06817984580993652}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 292800, "num_agent_steps_trained": 292800, "num_env_steps_sampled": 292800, "num_env_steps_trained": 292800, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.12693593318746, "num_env_steps_trained_throughput_per_sec": 41.12693593318746, "timesteps_total": 292800, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 292800, "timers": {"training_iteration_time_ms": 2908.289, "sample_time_ms": 2904.556, "load_time_ms": 0.216, "load_throughput": 555536.954, "learn_time_ms": 2.782, "learn_throughput": 43141.289, "synch_weights_time_ms": 0.696}, "counters": {"num_env_steps_sampled": 292800, "num_env_steps_trained": 292800, "num_agent_steps_sampled": 292800, "num_agent_steps_trained": 292800}, "done": false, "episodes_total": 2440, "training_iteration": 611, "trial_id": "53665_00000", "date": "2023-07-26_03-51-03", "timestamp": 1690332663, "time_this_iter_s": 11.673882722854614, "time_total_s": 7402.017237663269, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1780.6917617321014, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 33.25625, "ram_util_percent": 71.93124999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4864501953125, "policy_loss": -81415.59375, "vf_loss": 3415751.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 606.0, "diff_num_grad_updates_vs_sampler_policy": 605.0}}, "num_env_steps_sampled": 293280, "num_env_steps_trained": 293280, "num_agent_steps_sampled": 293280, "num_agent_steps_trained": 293280}, "sampler_results": {"episode_reward_max": -308.28382301090573, "episode_reward_min": -1258.911760652912, "episode_reward_mean": -738.2148851135923, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-416.1501239530031, -467.050600291204, -720.3908557310855, -605.2173986323484, -1068.5916564180015, -874.2986752925311, -738.1516152379985, -691.2460352294241, -801.3893431102525, -716.4853136285915, -825.6934677850077, -615.7422793376439, -694.2164562904486, -891.9545078165829, -666.6104380247511, -552.8373735843545, -1112.823699856796, -519.9997425741633, -308.28382301090573, -423.48683626330006, -475.1921603230027, -570.2971677399692, -356.40798923950274, -740.8905816116494, -669.9377909848879, -484.53739912788717, -807.7263389712529, -681.8082066573677, -666.5934636902222, -881.1046434265544, -544.136104964867, -469.30573896074276, -902.9095886165971, -850.5972108992019, -756.4222565494592, -865.7404375196369, -1258.911760652912, -565.9822236500993, -705.4478638415109, -611.2258553216858, -653.320410738251, -866.1269169517573, -789.8844987931826, -960.7805966779694, -968.6082486048847, -827.9117297349418, -637.6223482786262, -471.54099854198716, -562.7613428530823, -1036.7485457166297, -835.1444152936571, -916.8798055822496, -612.6285304627245, -838.6797304564644, -915.8508553863994, -732.3409940018564, -690.1162216488492, -779.6795651570592, -555.1149056104323, -936.3447646139771, -1042.3464040082167, -468.3265675424672, -939.7922804445831, -684.3190637340327, -540.7743997995757, -783.5540047216905, -673.8388256749915, -963.081088786078, -710.1919984333938, -1027.9019545691815, -664.8463262061819, -956.2598000434107, -549.9045453916402, -816.0290535357641, -698.6277163614873, -615.0870974807135, -750.0913896161829, -582.127437945606, -860.9710669091851, -832.9116146204669, -934.1471091532792, -942.6333953506391, -644.3010386931793, -446.82302908714126, -562.8365451590711, -899.4382101971137, -681.7546898899897, -396.20219707899054, -1153.319216414967, -906.6698809109502, -724.3444934773449, -639.2128771811185, -1068.6151542301675, -885.8256411502261, -974.4476874015886, -740.7426356422269, -701.5522770266058, -939.2311313049262, -582.0840716295429, -672.4441446329135], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.363258798215664, "mean_inference_ms": 0.40981885170603066, "mean_action_processing_ms": 0.09676233791038032, "mean_env_wait_ms": 2.713965733651144, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003603219985961914, "StateBufferConnector_ms": 0.0027866363525390625, "ViewRequirementAgentConnector_ms": 0.06812429428100586}}, "episode_reward_max": -308.28382301090573, "episode_reward_min": -1258.911760652912, "episode_reward_mean": -738.2148851135923, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-416.1501239530031, -467.050600291204, -720.3908557310855, -605.2173986323484, -1068.5916564180015, -874.2986752925311, -738.1516152379985, -691.2460352294241, -801.3893431102525, -716.4853136285915, -825.6934677850077, -615.7422793376439, -694.2164562904486, -891.9545078165829, -666.6104380247511, -552.8373735843545, -1112.823699856796, -519.9997425741633, -308.28382301090573, -423.48683626330006, -475.1921603230027, -570.2971677399692, -356.40798923950274, -740.8905816116494, -669.9377909848879, -484.53739912788717, -807.7263389712529, -681.8082066573677, -666.5934636902222, -881.1046434265544, -544.136104964867, -469.30573896074276, -902.9095886165971, -850.5972108992019, -756.4222565494592, -865.7404375196369, -1258.911760652912, -565.9822236500993, -705.4478638415109, -611.2258553216858, -653.320410738251, -866.1269169517573, -789.8844987931826, -960.7805966779694, -968.6082486048847, -827.9117297349418, -637.6223482786262, -471.54099854198716, -562.7613428530823, -1036.7485457166297, -835.1444152936571, -916.8798055822496, -612.6285304627245, -838.6797304564644, -915.8508553863994, -732.3409940018564, -690.1162216488492, -779.6795651570592, -555.1149056104323, -936.3447646139771, -1042.3464040082167, -468.3265675424672, -939.7922804445831, -684.3190637340327, -540.7743997995757, -783.5540047216905, -673.8388256749915, -963.081088786078, -710.1919984333938, -1027.9019545691815, -664.8463262061819, -956.2598000434107, -549.9045453916402, -816.0290535357641, -698.6277163614873, -615.0870974807135, -750.0913896161829, -582.127437945606, -860.9710669091851, -832.9116146204669, -934.1471091532792, -942.6333953506391, -644.3010386931793, -446.82302908714126, -562.8365451590711, -899.4382101971137, -681.7546898899897, -396.20219707899054, -1153.319216414967, -906.6698809109502, -724.3444934773449, -639.2128771811185, -1068.6151542301675, -885.8256411502261, -974.4476874015886, -740.7426356422269, -701.5522770266058, -939.2311313049262, -582.0840716295429, -672.4441446329135], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.363258798215664, "mean_inference_ms": 0.40981885170603066, "mean_action_processing_ms": 0.09676233791038032, "mean_env_wait_ms": 2.713965733651144, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003603219985961914, "StateBufferConnector_ms": 0.0027866363525390625, "ViewRequirementAgentConnector_ms": 0.06812429428100586}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 293280, "num_agent_steps_trained": 293280, "num_env_steps_sampled": 293280, "num_env_steps_trained": 293280, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.6943211474982, "num_env_steps_trained_throughput_per_sec": 39.6943211474982, "timesteps_total": 293280, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 293280, "timers": {"training_iteration_time_ms": 2964.589, "sample_time_ms": 2960.862, "load_time_ms": 0.216, "load_throughput": 554863.279, "learn_time_ms": 2.773, "learn_throughput": 43277.427, "synch_weights_time_ms": 0.699}, "counters": {"num_env_steps_sampled": 293280, "num_env_steps_trained": 293280, "num_agent_steps_sampled": 293280, "num_agent_steps_trained": 293280}, "done": false, "episodes_total": 2444, "training_iteration": 612, "trial_id": "53665_00000", "date": "2023-07-26_03-51-15", "timestamp": 1690332675, "time_this_iter_s": 12.095141887664795, "time_total_s": 7414.112379550934, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1792.7869036197662, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 38.205555555555556, "ram_util_percent": 72.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4627380371094, "policy_loss": -66086.9140625, "vf_loss": 2269351.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 610.0, "diff_num_grad_updates_vs_sampler_policy": 609.0}}, "num_env_steps_sampled": 293760, "num_env_steps_trained": 293760, "num_agent_steps_sampled": 293760, "num_agent_steps_trained": 293760}, "sampler_results": {"episode_reward_max": -308.28382301090573, "episode_reward_min": -1258.911760652912, "episode_reward_mean": -749.3538815165928, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1068.5916564180015, -874.2986752925311, -738.1516152379985, -691.2460352294241, -801.3893431102525, -716.4853136285915, -825.6934677850077, -615.7422793376439, -694.2164562904486, -891.9545078165829, -666.6104380247511, -552.8373735843545, -1112.823699856796, -519.9997425741633, -308.28382301090573, -423.48683626330006, -475.1921603230027, -570.2971677399692, -356.40798923950274, -740.8905816116494, -669.9377909848879, -484.53739912788717, -807.7263389712529, -681.8082066573677, -666.5934636902222, -881.1046434265544, -544.136104964867, -469.30573896074276, -902.9095886165971, -850.5972108992019, -756.4222565494592, -865.7404375196369, -1258.911760652912, -565.9822236500993, -705.4478638415109, -611.2258553216858, -653.320410738251, -866.1269169517573, -789.8844987931826, -960.7805966779694, -968.6082486048847, -827.9117297349418, -637.6223482786262, -471.54099854198716, -562.7613428530823, -1036.7485457166297, -835.1444152936571, -916.8798055822496, -612.6285304627245, -838.6797304564644, -915.8508553863994, -732.3409940018564, -690.1162216488492, -779.6795651570592, -555.1149056104323, -936.3447646139771, -1042.3464040082167, -468.3265675424672, -939.7922804445831, -684.3190637340327, -540.7743997995757, -783.5540047216905, -673.8388256749915, -963.081088786078, -710.1919984333938, -1027.9019545691815, -664.8463262061819, -956.2598000434107, -549.9045453916402, -816.0290535357641, -698.6277163614873, -615.0870974807135, -750.0913896161829, -582.127437945606, -860.9710669091851, -832.9116146204669, -934.1471091532792, -942.6333953506391, -644.3010386931793, -446.82302908714126, -562.8365451590711, -899.4382101971137, -681.7546898899897, -396.20219707899054, -1153.319216414967, -906.6698809109502, -724.3444934773449, -639.2128771811185, -1068.6151542301675, -885.8256411502261, -974.4476874015886, -740.7426356422269, -701.5522770266058, -939.2311313049262, -582.0840716295429, -672.4441446329135, -640.3641846789762, -1223.3009114164038, -913.6345980516116, -545.4089247607222], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.361735017047568, "mean_inference_ms": 0.409695936624958, "mean_action_processing_ms": 0.09674277610363817, "mean_env_wait_ms": 2.7134735910223298, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003598451614379883, "StateBufferConnector_ms": 0.002784252166748047, "ViewRequirementAgentConnector_ms": 0.06805920600891113}}, "episode_reward_max": -308.28382301090573, "episode_reward_min": -1258.911760652912, "episode_reward_mean": -749.3538815165928, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1068.5916564180015, -874.2986752925311, -738.1516152379985, -691.2460352294241, -801.3893431102525, -716.4853136285915, -825.6934677850077, -615.7422793376439, -694.2164562904486, -891.9545078165829, -666.6104380247511, -552.8373735843545, -1112.823699856796, -519.9997425741633, -308.28382301090573, -423.48683626330006, -475.1921603230027, -570.2971677399692, -356.40798923950274, -740.8905816116494, -669.9377909848879, -484.53739912788717, -807.7263389712529, -681.8082066573677, -666.5934636902222, -881.1046434265544, -544.136104964867, -469.30573896074276, -902.9095886165971, -850.5972108992019, -756.4222565494592, -865.7404375196369, -1258.911760652912, -565.9822236500993, -705.4478638415109, -611.2258553216858, -653.320410738251, -866.1269169517573, -789.8844987931826, -960.7805966779694, -968.6082486048847, -827.9117297349418, -637.6223482786262, -471.54099854198716, -562.7613428530823, -1036.7485457166297, -835.1444152936571, -916.8798055822496, -612.6285304627245, -838.6797304564644, -915.8508553863994, -732.3409940018564, -690.1162216488492, -779.6795651570592, -555.1149056104323, -936.3447646139771, -1042.3464040082167, -468.3265675424672, -939.7922804445831, -684.3190637340327, -540.7743997995757, -783.5540047216905, -673.8388256749915, -963.081088786078, -710.1919984333938, -1027.9019545691815, -664.8463262061819, -956.2598000434107, -549.9045453916402, -816.0290535357641, -698.6277163614873, -615.0870974807135, -750.0913896161829, -582.127437945606, -860.9710669091851, -832.9116146204669, -934.1471091532792, -942.6333953506391, -644.3010386931793, -446.82302908714126, -562.8365451590711, -899.4382101971137, -681.7546898899897, -396.20219707899054, -1153.319216414967, -906.6698809109502, -724.3444934773449, -639.2128771811185, -1068.6151542301675, -885.8256411502261, -974.4476874015886, -740.7426356422269, -701.5522770266058, -939.2311313049262, -582.0840716295429, -672.4441446329135, -640.3641846789762, -1223.3009114164038, -913.6345980516116, -545.4089247607222], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.361735017047568, "mean_inference_ms": 0.409695936624958, "mean_action_processing_ms": 0.09674277610363817, "mean_env_wait_ms": 2.7134735910223298, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003598451614379883, "StateBufferConnector_ms": 0.002784252166748047, "ViewRequirementAgentConnector_ms": 0.06805920600891113}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 293760, "num_agent_steps_trained": 293760, "num_env_steps_sampled": 293760, "num_env_steps_trained": 293760, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.751764882079705, "num_env_steps_trained_throughput_per_sec": 40.751764882079705, "timesteps_total": 293760, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 293760, "timers": {"training_iteration_time_ms": 2973.379, "sample_time_ms": 2969.635, "load_time_ms": 0.217, "load_throughput": 552124.265, "learn_time_ms": 2.79, "learn_throughput": 43008.578, "synch_weights_time_ms": 0.697}, "counters": {"num_env_steps_sampled": 293760, "num_env_steps_trained": 293760, "num_agent_steps_sampled": 293760, "num_agent_steps_trained": 293760}, "done": false, "episodes_total": 2448, "training_iteration": 613, "trial_id": "53665_00000", "date": "2023-07-26_03-51-27", "timestamp": 1690332687, "time_this_iter_s": 11.781268835067749, "time_total_s": 7425.893648386002, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1804.568172454834, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 34.83125, "ram_util_percent": 71.9625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4751281738281, "policy_loss": -68653.71875, "vf_loss": 2112269.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 614.0, "diff_num_grad_updates_vs_sampler_policy": 613.0}}, "num_env_steps_sampled": 294240, "num_env_steps_trained": 294240, "num_agent_steps_sampled": 294240, "num_agent_steps_trained": 294240}, "sampler_results": {"episode_reward_max": -308.28382301090573, "episode_reward_min": -1258.911760652912, "episode_reward_mean": -741.2177740176003, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-801.3893431102525, -716.4853136285915, -825.6934677850077, -615.7422793376439, -694.2164562904486, -891.9545078165829, -666.6104380247511, -552.8373735843545, -1112.823699856796, -519.9997425741633, -308.28382301090573, -423.48683626330006, -475.1921603230027, -570.2971677399692, -356.40798923950274, -740.8905816116494, -669.9377909848879, -484.53739912788717, -807.7263389712529, -681.8082066573677, -666.5934636902222, -881.1046434265544, -544.136104964867, -469.30573896074276, -902.9095886165971, -850.5972108992019, -756.4222565494592, -865.7404375196369, -1258.911760652912, -565.9822236500993, -705.4478638415109, -611.2258553216858, -653.320410738251, -866.1269169517573, -789.8844987931826, -960.7805966779694, -968.6082486048847, -827.9117297349418, -637.6223482786262, -471.54099854198716, -562.7613428530823, -1036.7485457166297, -835.1444152936571, -916.8798055822496, -612.6285304627245, -838.6797304564644, -915.8508553863994, -732.3409940018564, -690.1162216488492, -779.6795651570592, -555.1149056104323, -936.3447646139771, -1042.3464040082167, -468.3265675424672, -939.7922804445831, -684.3190637340327, -540.7743997995757, -783.5540047216905, -673.8388256749915, -963.081088786078, -710.1919984333938, -1027.9019545691815, -664.8463262061819, -956.2598000434107, -549.9045453916402, -816.0290535357641, -698.6277163614873, -615.0870974807135, -750.0913896161829, -582.127437945606, -860.9710669091851, -832.9116146204669, -934.1471091532792, -942.6333953506391, -644.3010386931793, -446.82302908714126, -562.8365451590711, -899.4382101971137, -681.7546898899897, -396.20219707899054, -1153.319216414967, -906.6698809109502, -724.3444934773449, -639.2128771811185, -1068.6151542301675, -885.8256411502261, -974.4476874015886, -740.7426356422269, -701.5522770266058, -939.2311313049262, -582.0840716295429, -672.4441446329135, -640.3641846789762, -1223.3009114164038, -913.6345980516116, -545.4089247607222, -810.0440549897335, -663.930560828732, -559.3303000967367, -525.3723163635021], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.360152625957916, "mean_inference_ms": 0.40957373802065766, "mean_action_processing_ms": 0.09672339376739535, "mean_env_wait_ms": 2.7129970261972236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003595113754272461, "StateBufferConnector_ms": 0.0027823448181152344, "ViewRequirementAgentConnector_ms": 0.0679476261138916}}, "episode_reward_max": -308.28382301090573, "episode_reward_min": -1258.911760652912, "episode_reward_mean": -741.2177740176003, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-801.3893431102525, -716.4853136285915, -825.6934677850077, -615.7422793376439, -694.2164562904486, -891.9545078165829, -666.6104380247511, -552.8373735843545, -1112.823699856796, -519.9997425741633, -308.28382301090573, -423.48683626330006, -475.1921603230027, -570.2971677399692, -356.40798923950274, -740.8905816116494, -669.9377909848879, -484.53739912788717, -807.7263389712529, -681.8082066573677, -666.5934636902222, -881.1046434265544, -544.136104964867, -469.30573896074276, -902.9095886165971, -850.5972108992019, -756.4222565494592, -865.7404375196369, -1258.911760652912, -565.9822236500993, -705.4478638415109, -611.2258553216858, -653.320410738251, -866.1269169517573, -789.8844987931826, -960.7805966779694, -968.6082486048847, -827.9117297349418, -637.6223482786262, -471.54099854198716, -562.7613428530823, -1036.7485457166297, -835.1444152936571, -916.8798055822496, -612.6285304627245, -838.6797304564644, -915.8508553863994, -732.3409940018564, -690.1162216488492, -779.6795651570592, -555.1149056104323, -936.3447646139771, -1042.3464040082167, -468.3265675424672, -939.7922804445831, -684.3190637340327, -540.7743997995757, -783.5540047216905, -673.8388256749915, -963.081088786078, -710.1919984333938, -1027.9019545691815, -664.8463262061819, -956.2598000434107, -549.9045453916402, -816.0290535357641, -698.6277163614873, -615.0870974807135, -750.0913896161829, -582.127437945606, -860.9710669091851, -832.9116146204669, -934.1471091532792, -942.6333953506391, -644.3010386931793, -446.82302908714126, -562.8365451590711, -899.4382101971137, -681.7546898899897, -396.20219707899054, -1153.319216414967, -906.6698809109502, -724.3444934773449, -639.2128771811185, -1068.6151542301675, -885.8256411502261, -974.4476874015886, -740.7426356422269, -701.5522770266058, -939.2311313049262, -582.0840716295429, -672.4441446329135, -640.3641846789762, -1223.3009114164038, -913.6345980516116, -545.4089247607222, -810.0440549897335, -663.930560828732, -559.3303000967367, -525.3723163635021], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.360152625957916, "mean_inference_ms": 0.40957373802065766, "mean_action_processing_ms": 0.09672339376739535, "mean_env_wait_ms": 2.7129970261972236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003595113754272461, "StateBufferConnector_ms": 0.0027823448181152344, "ViewRequirementAgentConnector_ms": 0.0679476261138916}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 294240, "num_agent_steps_trained": 294240, "num_env_steps_sampled": 294240, "num_env_steps_trained": 294240, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 42.14433892283669, "num_env_steps_trained_throughput_per_sec": 42.14433892283669, "timesteps_total": 294240, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 294240, "timers": {"training_iteration_time_ms": 2942.093, "sample_time_ms": 2938.339, "load_time_ms": 0.216, "load_throughput": 554679.832, "learn_time_ms": 2.799, "learn_throughput": 42879.237, "synch_weights_time_ms": 0.7}, "counters": {"num_env_steps_sampled": 294240, "num_env_steps_trained": 294240, "num_agent_steps_sampled": 294240, "num_agent_steps_trained": 294240}, "done": false, "episodes_total": 2452, "training_iteration": 614, "trial_id": "53665_00000", "date": "2023-07-26_03-51-38", "timestamp": 1690332698, "time_this_iter_s": 11.392234086990356, "time_total_s": 7437.285882472992, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1815.9604065418243, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 34.90625, "ram_util_percent": 70.42500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.45703125, "policy_loss": -76109.7578125, "vf_loss": 2572469.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 618.0, "diff_num_grad_updates_vs_sampler_policy": 617.0}}, "num_env_steps_sampled": 294720, "num_env_steps_trained": 294720, "num_agent_steps_sampled": 294720, "num_agent_steps_trained": 294720}, "sampler_results": {"episode_reward_max": -308.28382301090573, "episode_reward_min": -1258.911760652912, "episode_reward_mean": -738.5094234028704, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-694.2164562904486, -891.9545078165829, -666.6104380247511, -552.8373735843545, -1112.823699856796, -519.9997425741633, -308.28382301090573, -423.48683626330006, -475.1921603230027, -570.2971677399692, -356.40798923950274, -740.8905816116494, -669.9377909848879, -484.53739912788717, -807.7263389712529, -681.8082066573677, -666.5934636902222, -881.1046434265544, -544.136104964867, -469.30573896074276, -902.9095886165971, -850.5972108992019, -756.4222565494592, -865.7404375196369, -1258.911760652912, -565.9822236500993, -705.4478638415109, -611.2258553216858, -653.320410738251, -866.1269169517573, -789.8844987931826, -960.7805966779694, -968.6082486048847, -827.9117297349418, -637.6223482786262, -471.54099854198716, -562.7613428530823, -1036.7485457166297, -835.1444152936571, -916.8798055822496, -612.6285304627245, -838.6797304564644, -915.8508553863994, -732.3409940018564, -690.1162216488492, -779.6795651570592, -555.1149056104323, -936.3447646139771, -1042.3464040082167, -468.3265675424672, -939.7922804445831, -684.3190637340327, -540.7743997995757, -783.5540047216905, -673.8388256749915, -963.081088786078, -710.1919984333938, -1027.9019545691815, -664.8463262061819, -956.2598000434107, -549.9045453916402, -816.0290535357641, -698.6277163614873, -615.0870974807135, -750.0913896161829, -582.127437945606, -860.9710669091851, -832.9116146204669, -934.1471091532792, -942.6333953506391, -644.3010386931793, -446.82302908714126, -562.8365451590711, -899.4382101971137, -681.7546898899897, -396.20219707899054, -1153.319216414967, -906.6698809109502, -724.3444934773449, -639.2128771811185, -1068.6151542301675, -885.8256411502261, -974.4476874015886, -740.7426356422269, -701.5522770266058, -939.2311313049262, -582.0840716295429, -672.4441446329135, -640.3641846789762, -1223.3009114164038, -913.6345980516116, -545.4089247607222, -810.0440549897335, -663.930560828732, -559.3303000967367, -525.3723163635021, -683.9959750337031, -776.4869422892696, -611.2292571485175, -616.76316791701], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.358482998622982, "mean_inference_ms": 0.40945313733838856, "mean_action_processing_ms": 0.09670444767760739, "mean_env_wait_ms": 2.7125306693033666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035963058471679688, "StateBufferConnector_ms": 0.0027756690979003906, "ViewRequirementAgentConnector_ms": 0.06788754463195801}}, "episode_reward_max": -308.28382301090573, "episode_reward_min": -1258.911760652912, "episode_reward_mean": -738.5094234028704, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-694.2164562904486, -891.9545078165829, -666.6104380247511, -552.8373735843545, -1112.823699856796, -519.9997425741633, -308.28382301090573, -423.48683626330006, -475.1921603230027, -570.2971677399692, -356.40798923950274, -740.8905816116494, -669.9377909848879, -484.53739912788717, -807.7263389712529, -681.8082066573677, -666.5934636902222, -881.1046434265544, -544.136104964867, -469.30573896074276, -902.9095886165971, -850.5972108992019, -756.4222565494592, -865.7404375196369, -1258.911760652912, -565.9822236500993, -705.4478638415109, -611.2258553216858, -653.320410738251, -866.1269169517573, -789.8844987931826, -960.7805966779694, -968.6082486048847, -827.9117297349418, -637.6223482786262, -471.54099854198716, -562.7613428530823, -1036.7485457166297, -835.1444152936571, -916.8798055822496, -612.6285304627245, -838.6797304564644, -915.8508553863994, -732.3409940018564, -690.1162216488492, -779.6795651570592, -555.1149056104323, -936.3447646139771, -1042.3464040082167, -468.3265675424672, -939.7922804445831, -684.3190637340327, -540.7743997995757, -783.5540047216905, -673.8388256749915, -963.081088786078, -710.1919984333938, -1027.9019545691815, -664.8463262061819, -956.2598000434107, -549.9045453916402, -816.0290535357641, -698.6277163614873, -615.0870974807135, -750.0913896161829, -582.127437945606, -860.9710669091851, -832.9116146204669, -934.1471091532792, -942.6333953506391, -644.3010386931793, -446.82302908714126, -562.8365451590711, -899.4382101971137, -681.7546898899897, -396.20219707899054, -1153.319216414967, -906.6698809109502, -724.3444934773449, -639.2128771811185, -1068.6151542301675, -885.8256411502261, -974.4476874015886, -740.7426356422269, -701.5522770266058, -939.2311313049262, -582.0840716295429, -672.4441446329135, -640.3641846789762, -1223.3009114164038, -913.6345980516116, -545.4089247607222, -810.0440549897335, -663.930560828732, -559.3303000967367, -525.3723163635021, -683.9959750337031, -776.4869422892696, -611.2292571485175, -616.76316791701], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.358482998622982, "mean_inference_ms": 0.40945313733838856, "mean_action_processing_ms": 0.09670444767760739, "mean_env_wait_ms": 2.7125306693033666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035963058471679688, "StateBufferConnector_ms": 0.0027756690979003906, "ViewRequirementAgentConnector_ms": 0.06788754463195801}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 294720, "num_agent_steps_trained": 294720, "num_env_steps_sampled": 294720, "num_env_steps_trained": 294720, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.52207450295433, "num_env_steps_trained_throughput_per_sec": 41.52207450295433, "timesteps_total": 294720, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 294720, "timers": {"training_iteration_time_ms": 2880.158, "sample_time_ms": 2876.389, "load_time_ms": 0.215, "load_throughput": 559302.678, "learn_time_ms": 2.811, "learn_throughput": 42683.238, "synch_weights_time_ms": 0.703}, "counters": {"num_env_steps_sampled": 294720, "num_env_steps_trained": 294720, "num_agent_steps_sampled": 294720, "num_agent_steps_trained": 294720}, "done": false, "episodes_total": 2456, "training_iteration": 615, "trial_id": "53665_00000", "date": "2023-07-26_03-51-50", "timestamp": 1690332710, "time_this_iter_s": 11.56285285949707, "time_total_s": 7448.848735332489, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1827.5232594013214, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 34.92352941176471, "ram_util_percent": 70.98235294117647}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.47418212890625, "policy_loss": -117188.3046875, "vf_loss": 6385236.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 622.0, "diff_num_grad_updates_vs_sampler_policy": 621.0}}, "num_env_steps_sampled": 295200, "num_env_steps_trained": 295200, "num_agent_steps_sampled": 295200, "num_agent_steps_trained": 295200}, "sampler_results": {"episode_reward_max": -308.28382301090573, "episode_reward_min": -1258.911760652912, "episode_reward_mean": -746.1704994435005, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1112.823699856796, -519.9997425741633, -308.28382301090573, -423.48683626330006, -475.1921603230027, -570.2971677399692, -356.40798923950274, -740.8905816116494, -669.9377909848879, -484.53739912788717, -807.7263389712529, -681.8082066573677, -666.5934636902222, -881.1046434265544, -544.136104964867, -469.30573896074276, -902.9095886165971, -850.5972108992019, -756.4222565494592, -865.7404375196369, -1258.911760652912, -565.9822236500993, -705.4478638415109, -611.2258553216858, -653.320410738251, -866.1269169517573, -789.8844987931826, -960.7805966779694, -968.6082486048847, -827.9117297349418, -637.6223482786262, -471.54099854198716, -562.7613428530823, -1036.7485457166297, -835.1444152936571, -916.8798055822496, -612.6285304627245, -838.6797304564644, -915.8508553863994, -732.3409940018564, -690.1162216488492, -779.6795651570592, -555.1149056104323, -936.3447646139771, -1042.3464040082167, -468.3265675424672, -939.7922804445831, -684.3190637340327, -540.7743997995757, -783.5540047216905, -673.8388256749915, -963.081088786078, -710.1919984333938, -1027.9019545691815, -664.8463262061819, -956.2598000434107, -549.9045453916402, -816.0290535357641, -698.6277163614873, -615.0870974807135, -750.0913896161829, -582.127437945606, -860.9710669091851, -832.9116146204669, -934.1471091532792, -942.6333953506391, -644.3010386931793, -446.82302908714126, -562.8365451590711, -899.4382101971137, -681.7546898899897, -396.20219707899054, -1153.319216414967, -906.6698809109502, -724.3444934773449, -639.2128771811185, -1068.6151542301675, -885.8256411502261, -974.4476874015886, -740.7426356422269, -701.5522770266058, -939.2311313049262, -582.0840716295429, -672.4441446329135, -640.3641846789762, -1223.3009114164038, -913.6345980516116, -545.4089247607222, -810.0440549897335, -663.930560828732, -559.3303000967367, -525.3723163635021, -683.9959750337031, -776.4869422892696, -611.2292571485175, -616.76316791701, -923.4003012002925, -871.7526413853368, -840.2026916801607, -936.3707455133615], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.356868547847625, "mean_inference_ms": 0.4093333308947075, "mean_action_processing_ms": 0.09668586866888151, "mean_env_wait_ms": 2.712072259359634, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003584146499633789, "StateBufferConnector_ms": 0.0027730464935302734, "ViewRequirementAgentConnector_ms": 0.06785941123962402}}, "episode_reward_max": -308.28382301090573, "episode_reward_min": -1258.911760652912, "episode_reward_mean": -746.1704994435005, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1112.823699856796, -519.9997425741633, -308.28382301090573, -423.48683626330006, -475.1921603230027, -570.2971677399692, -356.40798923950274, -740.8905816116494, -669.9377909848879, -484.53739912788717, -807.7263389712529, -681.8082066573677, -666.5934636902222, -881.1046434265544, -544.136104964867, -469.30573896074276, -902.9095886165971, -850.5972108992019, -756.4222565494592, -865.7404375196369, -1258.911760652912, -565.9822236500993, -705.4478638415109, -611.2258553216858, -653.320410738251, -866.1269169517573, -789.8844987931826, -960.7805966779694, -968.6082486048847, -827.9117297349418, -637.6223482786262, -471.54099854198716, -562.7613428530823, -1036.7485457166297, -835.1444152936571, -916.8798055822496, -612.6285304627245, -838.6797304564644, -915.8508553863994, -732.3409940018564, -690.1162216488492, -779.6795651570592, -555.1149056104323, -936.3447646139771, -1042.3464040082167, -468.3265675424672, -939.7922804445831, -684.3190637340327, -540.7743997995757, -783.5540047216905, -673.8388256749915, -963.081088786078, -710.1919984333938, -1027.9019545691815, -664.8463262061819, -956.2598000434107, -549.9045453916402, -816.0290535357641, -698.6277163614873, -615.0870974807135, -750.0913896161829, -582.127437945606, -860.9710669091851, -832.9116146204669, -934.1471091532792, -942.6333953506391, -644.3010386931793, -446.82302908714126, -562.8365451590711, -899.4382101971137, -681.7546898899897, -396.20219707899054, -1153.319216414967, -906.6698809109502, -724.3444934773449, -639.2128771811185, -1068.6151542301675, -885.8256411502261, -974.4476874015886, -740.7426356422269, -701.5522770266058, -939.2311313049262, -582.0840716295429, -672.4441446329135, -640.3641846789762, -1223.3009114164038, -913.6345980516116, -545.4089247607222, -810.0440549897335, -663.930560828732, -559.3303000967367, -525.3723163635021, -683.9959750337031, -776.4869422892696, -611.2292571485175, -616.76316791701, -923.4003012002925, -871.7526413853368, -840.2026916801607, -936.3707455133615], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.356868547847625, "mean_inference_ms": 0.4093333308947075, "mean_action_processing_ms": 0.09668586866888151, "mean_env_wait_ms": 2.712072259359634, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003584146499633789, "StateBufferConnector_ms": 0.0027730464935302734, "ViewRequirementAgentConnector_ms": 0.06785941123962402}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 295200, "num_agent_steps_trained": 295200, "num_env_steps_sampled": 295200, "num_env_steps_trained": 295200, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.369193178351075, "num_env_steps_trained_throughput_per_sec": 40.369193178351075, "timesteps_total": 295200, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 295200, "timers": {"training_iteration_time_ms": 2908.356, "sample_time_ms": 2904.596, "load_time_ms": 0.215, "load_throughput": 558000.532, "learn_time_ms": 2.806, "learn_throughput": 42765.928, "synch_weights_time_ms": 0.7}, "counters": {"num_env_steps_sampled": 295200, "num_env_steps_trained": 295200, "num_agent_steps_sampled": 295200, "num_agent_steps_trained": 295200}, "done": false, "episodes_total": 2460, "training_iteration": 616, "trial_id": "53665_00000", "date": "2023-07-26_03-52-02", "timestamp": 1690332722, "time_this_iter_s": 11.892902851104736, "time_total_s": 7460.741638183594, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1839.4161622524261, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 36.32941176470588, "ram_util_percent": 71.01764705882351}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.50341796875, "policy_loss": -113771.4453125, "vf_loss": 6531983.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 626.0, "diff_num_grad_updates_vs_sampler_policy": 625.0}}, "num_env_steps_sampled": 295680, "num_env_steps_trained": 295680, "num_agent_steps_sampled": 295680, "num_agent_steps_trained": 295680}, "sampler_results": {"episode_reward_max": -356.40798923950274, "episode_reward_min": -1258.911760652912, "episode_reward_mean": -757.7503927920483, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-475.1921603230027, -570.2971677399692, -356.40798923950274, -740.8905816116494, -669.9377909848879, -484.53739912788717, -807.7263389712529, -681.8082066573677, -666.5934636902222, -881.1046434265544, -544.136104964867, -469.30573896074276, -902.9095886165971, -850.5972108992019, -756.4222565494592, -865.7404375196369, -1258.911760652912, -565.9822236500993, -705.4478638415109, -611.2258553216858, -653.320410738251, -866.1269169517573, -789.8844987931826, -960.7805966779694, -968.6082486048847, -827.9117297349418, -637.6223482786262, -471.54099854198716, -562.7613428530823, -1036.7485457166297, -835.1444152936571, -916.8798055822496, -612.6285304627245, -838.6797304564644, -915.8508553863994, -732.3409940018564, -690.1162216488492, -779.6795651570592, -555.1149056104323, -936.3447646139771, -1042.3464040082167, -468.3265675424672, -939.7922804445831, -684.3190637340327, -540.7743997995757, -783.5540047216905, -673.8388256749915, -963.081088786078, -710.1919984333938, -1027.9019545691815, -664.8463262061819, -956.2598000434107, -549.9045453916402, -816.0290535357641, -698.6277163614873, -615.0870974807135, -750.0913896161829, -582.127437945606, -860.9710669091851, -832.9116146204669, -934.1471091532792, -942.6333953506391, -644.3010386931793, -446.82302908714126, -562.8365451590711, -899.4382101971137, -681.7546898899897, -396.20219707899054, -1153.319216414967, -906.6698809109502, -724.3444934773449, -639.2128771811185, -1068.6151542301675, -885.8256411502261, -974.4476874015886, -740.7426356422269, -701.5522770266058, -939.2311313049262, -582.0840716295429, -672.4441446329135, -640.3641846789762, -1223.3009114164038, -913.6345980516116, -545.4089247607222, -810.0440549897335, -663.930560828732, -559.3303000967367, -525.3723163635021, -683.9959750337031, -776.4869422892696, -611.2292571485175, -616.76316791701, -923.4003012002925, -871.7526413853368, -840.2026916801607, -936.3707455133615, -663.2200970908967, -1226.797570888034, -718.2796093497702, -914.2861592312288], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.355428922679994, "mean_inference_ms": 0.40921612009825103, "mean_action_processing_ms": 0.09666774432229776, "mean_env_wait_ms": 2.7116454866241413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035848617553710938, "StateBufferConnector_ms": 0.0027709007263183594, "ViewRequirementAgentConnector_ms": 0.06778717041015625}}, "episode_reward_max": -356.40798923950274, "episode_reward_min": -1258.911760652912, "episode_reward_mean": -757.7503927920483, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-475.1921603230027, -570.2971677399692, -356.40798923950274, -740.8905816116494, -669.9377909848879, -484.53739912788717, -807.7263389712529, -681.8082066573677, -666.5934636902222, -881.1046434265544, -544.136104964867, -469.30573896074276, -902.9095886165971, -850.5972108992019, -756.4222565494592, -865.7404375196369, -1258.911760652912, -565.9822236500993, -705.4478638415109, -611.2258553216858, -653.320410738251, -866.1269169517573, -789.8844987931826, -960.7805966779694, -968.6082486048847, -827.9117297349418, -637.6223482786262, -471.54099854198716, -562.7613428530823, -1036.7485457166297, -835.1444152936571, -916.8798055822496, -612.6285304627245, -838.6797304564644, -915.8508553863994, -732.3409940018564, -690.1162216488492, -779.6795651570592, -555.1149056104323, -936.3447646139771, -1042.3464040082167, -468.3265675424672, -939.7922804445831, -684.3190637340327, -540.7743997995757, -783.5540047216905, -673.8388256749915, -963.081088786078, -710.1919984333938, -1027.9019545691815, -664.8463262061819, -956.2598000434107, -549.9045453916402, -816.0290535357641, -698.6277163614873, -615.0870974807135, -750.0913896161829, -582.127437945606, -860.9710669091851, -832.9116146204669, -934.1471091532792, -942.6333953506391, -644.3010386931793, -446.82302908714126, -562.8365451590711, -899.4382101971137, -681.7546898899897, -396.20219707899054, -1153.319216414967, -906.6698809109502, -724.3444934773449, -639.2128771811185, -1068.6151542301675, -885.8256411502261, -974.4476874015886, -740.7426356422269, -701.5522770266058, -939.2311313049262, -582.0840716295429, -672.4441446329135, -640.3641846789762, -1223.3009114164038, -913.6345980516116, -545.4089247607222, -810.0440549897335, -663.930560828732, -559.3303000967367, -525.3723163635021, -683.9959750337031, -776.4869422892696, -611.2292571485175, -616.76316791701, -923.4003012002925, -871.7526413853368, -840.2026916801607, -936.3707455133615, -663.2200970908967, -1226.797570888034, -718.2796093497702, -914.2861592312288], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.355428922679994, "mean_inference_ms": 0.40921612009825103, "mean_action_processing_ms": 0.09666774432229776, "mean_env_wait_ms": 2.7116454866241413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035848617553710938, "StateBufferConnector_ms": 0.0027709007263183594, "ViewRequirementAgentConnector_ms": 0.06778717041015625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 295680, "num_agent_steps_trained": 295680, "num_env_steps_sampled": 295680, "num_env_steps_trained": 295680, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.73153150965956, "num_env_steps_trained_throughput_per_sec": 40.73153150965956, "timesteps_total": 295680, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 295680, "timers": {"training_iteration_time_ms": 2938.497, "sample_time_ms": 2934.619, "load_time_ms": 0.217, "load_throughput": 553520.818, "learn_time_ms": 2.874, "learn_throughput": 41748.215, "synch_weights_time_ms": 0.746}, "counters": {"num_env_steps_sampled": 295680, "num_env_steps_trained": 295680, "num_agent_steps_sampled": 295680, "num_agent_steps_trained": 295680}, "done": false, "episodes_total": 2464, "training_iteration": 617, "trial_id": "53665_00000", "date": "2023-07-26_03-52-14", "timestamp": 1690332734, "time_this_iter_s": 11.787270069122314, "time_total_s": 7472.528908252716, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1851.2034323215485, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 39.78125, "ram_util_percent": 71.3375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4696044921875, "policy_loss": -80021.9921875, "vf_loss": 3047345.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 630.0, "diff_num_grad_updates_vs_sampler_policy": 629.0}}, "num_env_steps_sampled": 296160, "num_env_steps_trained": 296160, "num_agent_steps_sampled": 296160, "num_agent_steps_trained": 296160}, "sampler_results": {"episode_reward_max": -396.20219707899054, "episode_reward_min": -1258.911760652912, "episode_reward_mean": -769.188923561229, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-669.9377909848879, -484.53739912788717, -807.7263389712529, -681.8082066573677, -666.5934636902222, -881.1046434265544, -544.136104964867, -469.30573896074276, -902.9095886165971, -850.5972108992019, -756.4222565494592, -865.7404375196369, -1258.911760652912, -565.9822236500993, -705.4478638415109, -611.2258553216858, -653.320410738251, -866.1269169517573, -789.8844987931826, -960.7805966779694, -968.6082486048847, -827.9117297349418, -637.6223482786262, -471.54099854198716, -562.7613428530823, -1036.7485457166297, -835.1444152936571, -916.8798055822496, -612.6285304627245, -838.6797304564644, -915.8508553863994, -732.3409940018564, -690.1162216488492, -779.6795651570592, -555.1149056104323, -936.3447646139771, -1042.3464040082167, -468.3265675424672, -939.7922804445831, -684.3190637340327, -540.7743997995757, -783.5540047216905, -673.8388256749915, -963.081088786078, -710.1919984333938, -1027.9019545691815, -664.8463262061819, -956.2598000434107, -549.9045453916402, -816.0290535357641, -698.6277163614873, -615.0870974807135, -750.0913896161829, -582.127437945606, -860.9710669091851, -832.9116146204669, -934.1471091532792, -942.6333953506391, -644.3010386931793, -446.82302908714126, -562.8365451590711, -899.4382101971137, -681.7546898899897, -396.20219707899054, -1153.319216414967, -906.6698809109502, -724.3444934773449, -639.2128771811185, -1068.6151542301675, -885.8256411502261, -974.4476874015886, -740.7426356422269, -701.5522770266058, -939.2311313049262, -582.0840716295429, -672.4441446329135, -640.3641846789762, -1223.3009114164038, -913.6345980516116, -545.4089247607222, -810.0440549897335, -663.930560828732, -559.3303000967367, -525.3723163635021, -683.9959750337031, -776.4869422892696, -611.2292571485175, -616.76316791701, -923.4003012002925, -871.7526413853368, -840.2026916801607, -936.3707455133615, -663.2200970908967, -1226.797570888034, -718.2796093497702, -914.2861592312288, -655.065744427001, -1082.2097938096156, -927.692195471006, -621.6732421245882], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.35402994842462, "mean_inference_ms": 0.4091010201341423, "mean_action_processing_ms": 0.09664984531084814, "mean_env_wait_ms": 2.7112306181250267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003582000732421875, "StateBufferConnector_ms": 0.002764463424682617, "ViewRequirementAgentConnector_ms": 0.06776237487792969}}, "episode_reward_max": -396.20219707899054, "episode_reward_min": -1258.911760652912, "episode_reward_mean": -769.188923561229, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-669.9377909848879, -484.53739912788717, -807.7263389712529, -681.8082066573677, -666.5934636902222, -881.1046434265544, -544.136104964867, -469.30573896074276, -902.9095886165971, -850.5972108992019, -756.4222565494592, -865.7404375196369, -1258.911760652912, -565.9822236500993, -705.4478638415109, -611.2258553216858, -653.320410738251, -866.1269169517573, -789.8844987931826, -960.7805966779694, -968.6082486048847, -827.9117297349418, -637.6223482786262, -471.54099854198716, -562.7613428530823, -1036.7485457166297, -835.1444152936571, -916.8798055822496, -612.6285304627245, -838.6797304564644, -915.8508553863994, -732.3409940018564, -690.1162216488492, -779.6795651570592, -555.1149056104323, -936.3447646139771, -1042.3464040082167, -468.3265675424672, -939.7922804445831, -684.3190637340327, -540.7743997995757, -783.5540047216905, -673.8388256749915, -963.081088786078, -710.1919984333938, -1027.9019545691815, -664.8463262061819, -956.2598000434107, -549.9045453916402, -816.0290535357641, -698.6277163614873, -615.0870974807135, -750.0913896161829, -582.127437945606, -860.9710669091851, -832.9116146204669, -934.1471091532792, -942.6333953506391, -644.3010386931793, -446.82302908714126, -562.8365451590711, -899.4382101971137, -681.7546898899897, -396.20219707899054, -1153.319216414967, -906.6698809109502, -724.3444934773449, -639.2128771811185, -1068.6151542301675, -885.8256411502261, -974.4476874015886, -740.7426356422269, -701.5522770266058, -939.2311313049262, -582.0840716295429, -672.4441446329135, -640.3641846789762, -1223.3009114164038, -913.6345980516116, -545.4089247607222, -810.0440549897335, -663.930560828732, -559.3303000967367, -525.3723163635021, -683.9959750337031, -776.4869422892696, -611.2292571485175, -616.76316791701, -923.4003012002925, -871.7526413853368, -840.2026916801607, -936.3707455133615, -663.2200970908967, -1226.797570888034, -718.2796093497702, -914.2861592312288, -655.065744427001, -1082.2097938096156, -927.692195471006, -621.6732421245882], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.35402994842462, "mean_inference_ms": 0.4091010201341423, "mean_action_processing_ms": 0.09664984531084814, "mean_env_wait_ms": 2.7112306181250267, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003582000732421875, "StateBufferConnector_ms": 0.002764463424682617, "ViewRequirementAgentConnector_ms": 0.06776237487792969}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 296160, "num_agent_steps_trained": 296160, "num_env_steps_sampled": 296160, "num_env_steps_trained": 296160, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.57588079817874, "num_env_steps_trained_throughput_per_sec": 41.57588079817874, "timesteps_total": 296160, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 296160, "timers": {"training_iteration_time_ms": 2923.68, "sample_time_ms": 2919.824, "load_time_ms": 0.216, "load_throughput": 556212.267, "learn_time_ms": 2.844, "learn_throughput": 42193.387, "synch_weights_time_ms": 0.756}, "counters": {"num_env_steps_sampled": 296160, "num_env_steps_trained": 296160, "num_agent_steps_sampled": 296160, "num_agent_steps_trained": 296160}, "done": false, "episodes_total": 2468, "training_iteration": 618, "trial_id": "53665_00000", "date": "2023-07-26_03-52-25", "timestamp": 1690332745, "time_this_iter_s": 11.548048257827759, "time_total_s": 7484.076956510544, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1862.7514805793762, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 33.19411764705882, "ram_util_percent": 70.61176470588236}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4446716308594, "policy_loss": -56943.171875, "vf_loss": 1677017.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 634.0, "diff_num_grad_updates_vs_sampler_policy": 633.0}}, "num_env_steps_sampled": 296640, "num_env_steps_trained": 296640, "num_agent_steps_sampled": 296640, "num_agent_steps_trained": 296640}, "sampler_results": {"episode_reward_max": -396.20219707899054, "episode_reward_min": -1258.911760652912, "episode_reward_mean": -764.7188460198072, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-666.5934636902222, -881.1046434265544, -544.136104964867, -469.30573896074276, -902.9095886165971, -850.5972108992019, -756.4222565494592, -865.7404375196369, -1258.911760652912, -565.9822236500993, -705.4478638415109, -611.2258553216858, -653.320410738251, -866.1269169517573, -789.8844987931826, -960.7805966779694, -968.6082486048847, -827.9117297349418, -637.6223482786262, -471.54099854198716, -562.7613428530823, -1036.7485457166297, -835.1444152936571, -916.8798055822496, -612.6285304627245, -838.6797304564644, -915.8508553863994, -732.3409940018564, -690.1162216488492, -779.6795651570592, -555.1149056104323, -936.3447646139771, -1042.3464040082167, -468.3265675424672, -939.7922804445831, -684.3190637340327, -540.7743997995757, -783.5540047216905, -673.8388256749915, -963.081088786078, -710.1919984333938, -1027.9019545691815, -664.8463262061819, -956.2598000434107, -549.9045453916402, -816.0290535357641, -698.6277163614873, -615.0870974807135, -750.0913896161829, -582.127437945606, -860.9710669091851, -832.9116146204669, -934.1471091532792, -942.6333953506391, -644.3010386931793, -446.82302908714126, -562.8365451590711, -899.4382101971137, -681.7546898899897, -396.20219707899054, -1153.319216414967, -906.6698809109502, -724.3444934773449, -639.2128771811185, -1068.6151542301675, -885.8256411502261, -974.4476874015886, -740.7426356422269, -701.5522770266058, -939.2311313049262, -582.0840716295429, -672.4441446329135, -640.3641846789762, -1223.3009114164038, -913.6345980516116, -545.4089247607222, -810.0440549897335, -663.930560828732, -559.3303000967367, -525.3723163635021, -683.9959750337031, -776.4869422892696, -611.2292571485175, -616.76316791701, -923.4003012002925, -871.7526413853368, -840.2026916801607, -936.3707455133615, -663.2200970908967, -1226.797570888034, -718.2796093497702, -914.2861592312288, -655.065744427001, -1082.2097938096156, -927.692195471006, -621.6732421245882, -544.7591865826065, -646.8707180877126, -517.5628746402506, -487.8092022886465], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.352732647411194, "mean_inference_ms": 0.4089980700005965, "mean_action_processing_ms": 0.09663398286294962, "mean_env_wait_ms": 2.710807651214061, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035877227783203125, "StateBufferConnector_ms": 0.0027582645416259766, "ViewRequirementAgentConnector_ms": 0.06782293319702148}}, "episode_reward_max": -396.20219707899054, "episode_reward_min": -1258.911760652912, "episode_reward_mean": -764.7188460198072, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-666.5934636902222, -881.1046434265544, -544.136104964867, -469.30573896074276, -902.9095886165971, -850.5972108992019, -756.4222565494592, -865.7404375196369, -1258.911760652912, -565.9822236500993, -705.4478638415109, -611.2258553216858, -653.320410738251, -866.1269169517573, -789.8844987931826, -960.7805966779694, -968.6082486048847, -827.9117297349418, -637.6223482786262, -471.54099854198716, -562.7613428530823, -1036.7485457166297, -835.1444152936571, -916.8798055822496, -612.6285304627245, -838.6797304564644, -915.8508553863994, -732.3409940018564, -690.1162216488492, -779.6795651570592, -555.1149056104323, -936.3447646139771, -1042.3464040082167, -468.3265675424672, -939.7922804445831, -684.3190637340327, -540.7743997995757, -783.5540047216905, -673.8388256749915, -963.081088786078, -710.1919984333938, -1027.9019545691815, -664.8463262061819, -956.2598000434107, -549.9045453916402, -816.0290535357641, -698.6277163614873, -615.0870974807135, -750.0913896161829, -582.127437945606, -860.9710669091851, -832.9116146204669, -934.1471091532792, -942.6333953506391, -644.3010386931793, -446.82302908714126, -562.8365451590711, -899.4382101971137, -681.7546898899897, -396.20219707899054, -1153.319216414967, -906.6698809109502, -724.3444934773449, -639.2128771811185, -1068.6151542301675, -885.8256411502261, -974.4476874015886, -740.7426356422269, -701.5522770266058, -939.2311313049262, -582.0840716295429, -672.4441446329135, -640.3641846789762, -1223.3009114164038, -913.6345980516116, -545.4089247607222, -810.0440549897335, -663.930560828732, -559.3303000967367, -525.3723163635021, -683.9959750337031, -776.4869422892696, -611.2292571485175, -616.76316791701, -923.4003012002925, -871.7526413853368, -840.2026916801607, -936.3707455133615, -663.2200970908967, -1226.797570888034, -718.2796093497702, -914.2861592312288, -655.065744427001, -1082.2097938096156, -927.692195471006, -621.6732421245882, -544.7591865826065, -646.8707180877126, -517.5628746402506, -487.8092022886465], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.352732647411194, "mean_inference_ms": 0.4089980700005965, "mean_action_processing_ms": 0.09663398286294962, "mean_env_wait_ms": 2.710807651214061, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0035877227783203125, "StateBufferConnector_ms": 0.0027582645416259766, "ViewRequirementAgentConnector_ms": 0.06782293319702148}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 296640, "num_agent_steps_trained": 296640, "num_env_steps_sampled": 296640, "num_env_steps_trained": 296640, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.49071400860027, "num_env_steps_trained_throughput_per_sec": 40.49071400860027, "timesteps_total": 296640, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 296640, "timers": {"training_iteration_time_ms": 2937.502, "sample_time_ms": 2933.612, "load_time_ms": 0.217, "load_throughput": 552609.223, "learn_time_ms": 2.85, "learn_throughput": 42107.963, "synch_weights_time_ms": 0.782}, "counters": {"num_env_steps_sampled": 296640, "num_env_steps_trained": 296640, "num_agent_steps_sampled": 296640, "num_agent_steps_trained": 296640}, "done": false, "episodes_total": 2472, "training_iteration": 619, "trial_id": "53665_00000", "date": "2023-07-26_03-52-37", "timestamp": 1690332757, "time_this_iter_s": 11.857402086257935, "time_total_s": 7495.934358596802, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1874.6088826656342, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 41.005882352941185, "ram_util_percent": 71.78823529411764}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4541015625, "policy_loss": -64939.6796875, "vf_loss": 2119738.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 638.0, "diff_num_grad_updates_vs_sampler_policy": 637.0}}, "num_env_steps_sampled": 297120, "num_env_steps_trained": 297120, "num_agent_steps_sampled": 297120, "num_agent_steps_trained": 297120}, "sampler_results": {"episode_reward_max": -396.20219707899054, "episode_reward_min": -1258.911760652912, "episode_reward_mean": -764.8576961744898, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-902.9095886165971, -850.5972108992019, -756.4222565494592, -865.7404375196369, -1258.911760652912, -565.9822236500993, -705.4478638415109, -611.2258553216858, -653.320410738251, -866.1269169517573, -789.8844987931826, -960.7805966779694, -968.6082486048847, -827.9117297349418, -637.6223482786262, -471.54099854198716, -562.7613428530823, -1036.7485457166297, -835.1444152936571, -916.8798055822496, -612.6285304627245, -838.6797304564644, -915.8508553863994, -732.3409940018564, -690.1162216488492, -779.6795651570592, -555.1149056104323, -936.3447646139771, -1042.3464040082167, -468.3265675424672, -939.7922804445831, -684.3190637340327, -540.7743997995757, -783.5540047216905, -673.8388256749915, -963.081088786078, -710.1919984333938, -1027.9019545691815, -664.8463262061819, -956.2598000434107, -549.9045453916402, -816.0290535357641, -698.6277163614873, -615.0870974807135, -750.0913896161829, -582.127437945606, -860.9710669091851, -832.9116146204669, -934.1471091532792, -942.6333953506391, -644.3010386931793, -446.82302908714126, -562.8365451590711, -899.4382101971137, -681.7546898899897, -396.20219707899054, -1153.319216414967, -906.6698809109502, -724.3444934773449, -639.2128771811185, -1068.6151542301675, -885.8256411502261, -974.4476874015886, -740.7426356422269, -701.5522770266058, -939.2311313049262, -582.0840716295429, -672.4441446329135, -640.3641846789762, -1223.3009114164038, -913.6345980516116, -545.4089247607222, -810.0440549897335, -663.930560828732, -559.3303000967367, -525.3723163635021, -683.9959750337031, -776.4869422892696, -611.2292571485175, -616.76316791701, -923.4003012002925, -871.7526413853368, -840.2026916801607, -936.3707455133615, -663.2200970908967, -1226.797570888034, -718.2796093497702, -914.2861592312288, -655.065744427001, -1082.2097938096156, -927.692195471006, -621.6732421245882, -544.7591865826065, -646.8707180877126, -517.5628746402506, -487.8092022886465, -687.1596566903298, -643.4548666039393, -651.6337263764176, -592.7767168399545], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.351263529925856, "mean_inference_ms": 0.4088968871589735, "mean_action_processing_ms": 0.09661837144925453, "mean_env_wait_ms": 2.710375556304044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003579854965209961, "StateBufferConnector_ms": 0.0027692317962646484, "ViewRequirementAgentConnector_ms": 0.0677330493927002}}, "episode_reward_max": -396.20219707899054, "episode_reward_min": -1258.911760652912, "episode_reward_mean": -764.8576961744898, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-902.9095886165971, -850.5972108992019, -756.4222565494592, -865.7404375196369, -1258.911760652912, -565.9822236500993, -705.4478638415109, -611.2258553216858, -653.320410738251, -866.1269169517573, -789.8844987931826, -960.7805966779694, -968.6082486048847, -827.9117297349418, -637.6223482786262, -471.54099854198716, -562.7613428530823, -1036.7485457166297, -835.1444152936571, -916.8798055822496, -612.6285304627245, -838.6797304564644, -915.8508553863994, -732.3409940018564, -690.1162216488492, -779.6795651570592, -555.1149056104323, -936.3447646139771, -1042.3464040082167, -468.3265675424672, -939.7922804445831, -684.3190637340327, -540.7743997995757, -783.5540047216905, -673.8388256749915, -963.081088786078, -710.1919984333938, -1027.9019545691815, -664.8463262061819, -956.2598000434107, -549.9045453916402, -816.0290535357641, -698.6277163614873, -615.0870974807135, -750.0913896161829, -582.127437945606, -860.9710669091851, -832.9116146204669, -934.1471091532792, -942.6333953506391, -644.3010386931793, -446.82302908714126, -562.8365451590711, -899.4382101971137, -681.7546898899897, -396.20219707899054, -1153.319216414967, -906.6698809109502, -724.3444934773449, -639.2128771811185, -1068.6151542301675, -885.8256411502261, -974.4476874015886, -740.7426356422269, -701.5522770266058, -939.2311313049262, -582.0840716295429, -672.4441446329135, -640.3641846789762, -1223.3009114164038, -913.6345980516116, -545.4089247607222, -810.0440549897335, -663.930560828732, -559.3303000967367, -525.3723163635021, -683.9959750337031, -776.4869422892696, -611.2292571485175, -616.76316791701, -923.4003012002925, -871.7526413853368, -840.2026916801607, -936.3707455133615, -663.2200970908967, -1226.797570888034, -718.2796093497702, -914.2861592312288, -655.065744427001, -1082.2097938096156, -927.692195471006, -621.6732421245882, -544.7591865826065, -646.8707180877126, -517.5628746402506, -487.8092022886465, -687.1596566903298, -643.4548666039393, -651.6337263764176, -592.7767168399545], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.351263529925856, "mean_inference_ms": 0.4088968871589735, "mean_action_processing_ms": 0.09661837144925453, "mean_env_wait_ms": 2.710375556304044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003579854965209961, "StateBufferConnector_ms": 0.0027692317962646484, "ViewRequirementAgentConnector_ms": 0.0677330493927002}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 297120, "num_agent_steps_trained": 297120, "num_env_steps_sampled": 297120, "num_env_steps_trained": 297120, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.602940296713975, "num_env_steps_trained_throughput_per_sec": 41.602940296713975, "timesteps_total": 297120, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 297120, "timers": {"training_iteration_time_ms": 2917.201, "sample_time_ms": 2913.419, "load_time_ms": 0.215, "load_throughput": 558992.092, "learn_time_ms": 2.806, "learn_throughput": 42772.469, "synch_weights_time_ms": 0.721}, "counters": {"num_env_steps_sampled": 297120, "num_env_steps_trained": 297120, "num_agent_steps_sampled": 297120, "num_agent_steps_trained": 297120}, "done": false, "episodes_total": 2476, "training_iteration": 620, "trial_id": "53665_00000", "date": "2023-07-26_03-52-49", "timestamp": 1690332769, "time_this_iter_s": 11.54033613204956, "time_total_s": 7507.474694728851, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1886.1492187976837, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 44.4375, "ram_util_percent": 72.20625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.45721435546875, "policy_loss": -97491.359375, "vf_loss": 4385134.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 642.0, "diff_num_grad_updates_vs_sampler_policy": 641.0}}, "num_env_steps_sampled": 297600, "num_env_steps_trained": 297600, "num_agent_steps_sampled": 297600, "num_agent_steps_trained": 297600}, "sampler_results": {"episode_reward_max": -396.20219707899054, "episode_reward_min": -1258.911760652912, "episode_reward_mean": -762.355100741686, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1258.911760652912, -565.9822236500993, -705.4478638415109, -611.2258553216858, -653.320410738251, -866.1269169517573, -789.8844987931826, -960.7805966779694, -968.6082486048847, -827.9117297349418, -637.6223482786262, -471.54099854198716, -562.7613428530823, -1036.7485457166297, -835.1444152936571, -916.8798055822496, -612.6285304627245, -838.6797304564644, -915.8508553863994, -732.3409940018564, -690.1162216488492, -779.6795651570592, -555.1149056104323, -936.3447646139771, -1042.3464040082167, -468.3265675424672, -939.7922804445831, -684.3190637340327, -540.7743997995757, -783.5540047216905, -673.8388256749915, -963.081088786078, -710.1919984333938, -1027.9019545691815, -664.8463262061819, -956.2598000434107, -549.9045453916402, -816.0290535357641, -698.6277163614873, -615.0870974807135, -750.0913896161829, -582.127437945606, -860.9710669091851, -832.9116146204669, -934.1471091532792, -942.6333953506391, -644.3010386931793, -446.82302908714126, -562.8365451590711, -899.4382101971137, -681.7546898899897, -396.20219707899054, -1153.319216414967, -906.6698809109502, -724.3444934773449, -639.2128771811185, -1068.6151542301675, -885.8256411502261, -974.4476874015886, -740.7426356422269, -701.5522770266058, -939.2311313049262, -582.0840716295429, -672.4441446329135, -640.3641846789762, -1223.3009114164038, -913.6345980516116, -545.4089247607222, -810.0440549897335, -663.930560828732, -559.3303000967367, -525.3723163635021, -683.9959750337031, -776.4869422892696, -611.2292571485175, -616.76316791701, -923.4003012002925, -871.7526413853368, -840.2026916801607, -936.3707455133615, -663.2200970908967, -1226.797570888034, -718.2796093497702, -914.2861592312288, -655.065744427001, -1082.2097938096156, -927.692195471006, -621.6732421245882, -544.7591865826065, -646.8707180877126, -517.5628746402506, -487.8092022886465, -687.1596566903298, -643.4548666039393, -651.6337263764176, -592.7767168399545, -802.5153282624101, -1099.1762628277393, -445.1529978284388, -778.5653613859414], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.34987069271493, "mean_inference_ms": 0.4087978519479512, "mean_action_processing_ms": 0.09660318616081649, "mean_env_wait_ms": 2.709944371902571, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003587007522583008, "StateBufferConnector_ms": 0.002772092819213867, "ViewRequirementAgentConnector_ms": 0.06776046752929688}}, "episode_reward_max": -396.20219707899054, "episode_reward_min": -1258.911760652912, "episode_reward_mean": -762.355100741686, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1258.911760652912, -565.9822236500993, -705.4478638415109, -611.2258553216858, -653.320410738251, -866.1269169517573, -789.8844987931826, -960.7805966779694, -968.6082486048847, -827.9117297349418, -637.6223482786262, -471.54099854198716, -562.7613428530823, -1036.7485457166297, -835.1444152936571, -916.8798055822496, -612.6285304627245, -838.6797304564644, -915.8508553863994, -732.3409940018564, -690.1162216488492, -779.6795651570592, -555.1149056104323, -936.3447646139771, -1042.3464040082167, -468.3265675424672, -939.7922804445831, -684.3190637340327, -540.7743997995757, -783.5540047216905, -673.8388256749915, -963.081088786078, -710.1919984333938, -1027.9019545691815, -664.8463262061819, -956.2598000434107, -549.9045453916402, -816.0290535357641, -698.6277163614873, -615.0870974807135, -750.0913896161829, -582.127437945606, -860.9710669091851, -832.9116146204669, -934.1471091532792, -942.6333953506391, -644.3010386931793, -446.82302908714126, -562.8365451590711, -899.4382101971137, -681.7546898899897, -396.20219707899054, -1153.319216414967, -906.6698809109502, -724.3444934773449, -639.2128771811185, -1068.6151542301675, -885.8256411502261, -974.4476874015886, -740.7426356422269, -701.5522770266058, -939.2311313049262, -582.0840716295429, -672.4441446329135, -640.3641846789762, -1223.3009114164038, -913.6345980516116, -545.4089247607222, -810.0440549897335, -663.930560828732, -559.3303000967367, -525.3723163635021, -683.9959750337031, -776.4869422892696, -611.2292571485175, -616.76316791701, -923.4003012002925, -871.7526413853368, -840.2026916801607, -936.3707455133615, -663.2200970908967, -1226.797570888034, -718.2796093497702, -914.2861592312288, -655.065744427001, -1082.2097938096156, -927.692195471006, -621.6732421245882, -544.7591865826065, -646.8707180877126, -517.5628746402506, -487.8092022886465, -687.1596566903298, -643.4548666039393, -651.6337263764176, -592.7767168399545, -802.5153282624101, -1099.1762628277393, -445.1529978284388, -778.5653613859414], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.34987069271493, "mean_inference_ms": 0.4087978519479512, "mean_action_processing_ms": 0.09660318616081649, "mean_env_wait_ms": 2.709944371902571, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003587007522583008, "StateBufferConnector_ms": 0.002772092819213867, "ViewRequirementAgentConnector_ms": 0.06776046752929688}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 297600, "num_agent_steps_trained": 297600, "num_env_steps_sampled": 297600, "num_env_steps_trained": 297600, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.34998558174589, "num_env_steps_trained_throughput_per_sec": 40.34998558174589, "timesteps_total": 297600, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 297600, "timers": {"training_iteration_time_ms": 2938.979, "sample_time_ms": 2935.217, "load_time_ms": 0.215, "load_throughput": 558124.285, "learn_time_ms": 2.803, "learn_throughput": 42805.208, "synch_weights_time_ms": 0.704}, "counters": {"num_env_steps_sampled": 297600, "num_env_steps_trained": 297600, "num_agent_steps_sampled": 297600, "num_agent_steps_trained": 297600}, "done": false, "episodes_total": 2480, "training_iteration": 621, "trial_id": "53665_00000", "date": "2023-07-26_03-53-01", "timestamp": 1690332781, "time_this_iter_s": 11.898669958114624, "time_total_s": 7519.373364686966, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1898.0478887557983, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 37.194117647058825, "ram_util_percent": 72.33529411764707}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.47393798828125, "policy_loss": -77411.3125, "vf_loss": 2925060.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 646.0, "diff_num_grad_updates_vs_sampler_policy": 645.0}}, "num_env_steps_sampled": 298080, "num_env_steps_trained": 298080, "num_agent_steps_sampled": 298080, "num_agent_steps_trained": 298080}, "sampler_results": {"episode_reward_max": -396.20219707899054, "episode_reward_min": -1226.797570888034, "episode_reward_mean": -754.6685874275784, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-653.320410738251, -866.1269169517573, -789.8844987931826, -960.7805966779694, -968.6082486048847, -827.9117297349418, -637.6223482786262, -471.54099854198716, -562.7613428530823, -1036.7485457166297, -835.1444152936571, -916.8798055822496, -612.6285304627245, -838.6797304564644, -915.8508553863994, -732.3409940018564, -690.1162216488492, -779.6795651570592, -555.1149056104323, -936.3447646139771, -1042.3464040082167, -468.3265675424672, -939.7922804445831, -684.3190637340327, -540.7743997995757, -783.5540047216905, -673.8388256749915, -963.081088786078, -710.1919984333938, -1027.9019545691815, -664.8463262061819, -956.2598000434107, -549.9045453916402, -816.0290535357641, -698.6277163614873, -615.0870974807135, -750.0913896161829, -582.127437945606, -860.9710669091851, -832.9116146204669, -934.1471091532792, -942.6333953506391, -644.3010386931793, -446.82302908714126, -562.8365451590711, -899.4382101971137, -681.7546898899897, -396.20219707899054, -1153.319216414967, -906.6698809109502, -724.3444934773449, -639.2128771811185, -1068.6151542301675, -885.8256411502261, -974.4476874015886, -740.7426356422269, -701.5522770266058, -939.2311313049262, -582.0840716295429, -672.4441446329135, -640.3641846789762, -1223.3009114164038, -913.6345980516116, -545.4089247607222, -810.0440549897335, -663.930560828732, -559.3303000967367, -525.3723163635021, -683.9959750337031, -776.4869422892696, -611.2292571485175, -616.76316791701, -923.4003012002925, -871.7526413853368, -840.2026916801607, -936.3707455133615, -663.2200970908967, -1226.797570888034, -718.2796093497702, -914.2861592312288, -655.065744427001, -1082.2097938096156, -927.692195471006, -621.6732421245882, -544.7591865826065, -646.8707180877126, -517.5628746402506, -487.8092022886465, -687.1596566903298, -643.4548666039393, -651.6337263764176, -592.7767168399545, -802.5153282624101, -1099.1762628277393, -445.1529978284388, -778.5653613859414, -610.1975378198206, -673.272634866685, -523.2399561542325, -566.206243214677], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.348809999219156, "mean_inference_ms": 0.40869958251191313, "mean_action_processing_ms": 0.09658799191450218, "mean_env_wait_ms": 2.709523780967028, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036046504974365234, "StateBufferConnector_ms": 0.0027751922607421875, "ViewRequirementAgentConnector_ms": 0.0678706169128418}}, "episode_reward_max": -396.20219707899054, "episode_reward_min": -1226.797570888034, "episode_reward_mean": -754.6685874275784, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-653.320410738251, -866.1269169517573, -789.8844987931826, -960.7805966779694, -968.6082486048847, -827.9117297349418, -637.6223482786262, -471.54099854198716, -562.7613428530823, -1036.7485457166297, -835.1444152936571, -916.8798055822496, -612.6285304627245, -838.6797304564644, -915.8508553863994, -732.3409940018564, -690.1162216488492, -779.6795651570592, -555.1149056104323, -936.3447646139771, -1042.3464040082167, -468.3265675424672, -939.7922804445831, -684.3190637340327, -540.7743997995757, -783.5540047216905, -673.8388256749915, -963.081088786078, -710.1919984333938, -1027.9019545691815, -664.8463262061819, -956.2598000434107, -549.9045453916402, -816.0290535357641, -698.6277163614873, -615.0870974807135, -750.0913896161829, -582.127437945606, -860.9710669091851, -832.9116146204669, -934.1471091532792, -942.6333953506391, -644.3010386931793, -446.82302908714126, -562.8365451590711, -899.4382101971137, -681.7546898899897, -396.20219707899054, -1153.319216414967, -906.6698809109502, -724.3444934773449, -639.2128771811185, -1068.6151542301675, -885.8256411502261, -974.4476874015886, -740.7426356422269, -701.5522770266058, -939.2311313049262, -582.0840716295429, -672.4441446329135, -640.3641846789762, -1223.3009114164038, -913.6345980516116, -545.4089247607222, -810.0440549897335, -663.930560828732, -559.3303000967367, -525.3723163635021, -683.9959750337031, -776.4869422892696, -611.2292571485175, -616.76316791701, -923.4003012002925, -871.7526413853368, -840.2026916801607, -936.3707455133615, -663.2200970908967, -1226.797570888034, -718.2796093497702, -914.2861592312288, -655.065744427001, -1082.2097938096156, -927.692195471006, -621.6732421245882, -544.7591865826065, -646.8707180877126, -517.5628746402506, -487.8092022886465, -687.1596566903298, -643.4548666039393, -651.6337263764176, -592.7767168399545, -802.5153282624101, -1099.1762628277393, -445.1529978284388, -778.5653613859414, -610.1975378198206, -673.272634866685, -523.2399561542325, -566.206243214677], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.348809999219156, "mean_inference_ms": 0.40869958251191313, "mean_action_processing_ms": 0.09658799191450218, "mean_env_wait_ms": 2.709523780967028, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0036046504974365234, "StateBufferConnector_ms": 0.0027751922607421875, "ViewRequirementAgentConnector_ms": 0.0678706169128418}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 298080, "num_agent_steps_trained": 298080, "num_env_steps_sampled": 298080, "num_env_steps_trained": 298080, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.6762318951341, "num_env_steps_trained_throughput_per_sec": 39.6762318951341, "timesteps_total": 298080, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 298080, "timers": {"training_iteration_time_ms": 2969.356, "sample_time_ms": 2965.26, "load_time_ms": 0.265, "load_throughput": 452867.087, "learn_time_ms": 3.022, "learn_throughput": 39705.941, "synch_weights_time_ms": 0.747}, "counters": {"num_env_steps_sampled": 298080, "num_env_steps_trained": 298080, "num_agent_steps_sampled": 298080, "num_agent_steps_trained": 298080}, "done": false, "episodes_total": 2484, "training_iteration": 622, "trial_id": "53665_00000", "date": "2023-07-26_03-53-13", "timestamp": 1690332793, "time_this_iter_s": 12.101765871047974, "time_total_s": 7531.475130558014, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1910.1496546268463, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 45.535294117647055, "ram_util_percent": 73.04705882352943}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.47247314453125, "policy_loss": -134689.09375, "vf_loss": 8115378.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 650.0, "diff_num_grad_updates_vs_sampler_policy": 649.0}}, "num_env_steps_sampled": 298560, "num_env_steps_trained": 298560, "num_agent_steps_sampled": 298560, "num_agent_steps_trained": 298560}, "sampler_results": {"episode_reward_max": -396.20219707899054, "episode_reward_min": -1226.797570888034, "episode_reward_mean": -750.3035997700438, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-968.6082486048847, -827.9117297349418, -637.6223482786262, -471.54099854198716, -562.7613428530823, -1036.7485457166297, -835.1444152936571, -916.8798055822496, -612.6285304627245, -838.6797304564644, -915.8508553863994, -732.3409940018564, -690.1162216488492, -779.6795651570592, -555.1149056104323, -936.3447646139771, -1042.3464040082167, -468.3265675424672, -939.7922804445831, -684.3190637340327, -540.7743997995757, -783.5540047216905, -673.8388256749915, -963.081088786078, -710.1919984333938, -1027.9019545691815, -664.8463262061819, -956.2598000434107, -549.9045453916402, -816.0290535357641, -698.6277163614873, -615.0870974807135, -750.0913896161829, -582.127437945606, -860.9710669091851, -832.9116146204669, -934.1471091532792, -942.6333953506391, -644.3010386931793, -446.82302908714126, -562.8365451590711, -899.4382101971137, -681.7546898899897, -396.20219707899054, -1153.319216414967, -906.6698809109502, -724.3444934773449, -639.2128771811185, -1068.6151542301675, -885.8256411502261, -974.4476874015886, -740.7426356422269, -701.5522770266058, -939.2311313049262, -582.0840716295429, -672.4441446329135, -640.3641846789762, -1223.3009114164038, -913.6345980516116, -545.4089247607222, -810.0440549897335, -663.930560828732, -559.3303000967367, -525.3723163635021, -683.9959750337031, -776.4869422892696, -611.2292571485175, -616.76316791701, -923.4003012002925, -871.7526413853368, -840.2026916801607, -936.3707455133615, -663.2200970908967, -1226.797570888034, -718.2796093497702, -914.2861592312288, -655.065744427001, -1082.2097938096156, -927.692195471006, -621.6732421245882, -544.7591865826065, -646.8707180877126, -517.5628746402506, -487.8092022886465, -687.1596566903298, -643.4548666039393, -651.6337263764176, -592.7767168399545, -802.5153282624101, -1099.1762628277393, -445.1529978284388, -778.5653613859414, -610.1975378198206, -673.272634866685, -523.2399561542325, -566.206243214677, -531.0503328488047, -566.9073212997645, -850.6987402180574, -884.9572630410971], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.34780013100307, "mean_inference_ms": 0.4086157023475454, "mean_action_processing_ms": 0.0965760573777904, "mean_env_wait_ms": 2.709122342552445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003725767135620117, "StateBufferConnector_ms": 0.0027921199798583984, "ViewRequirementAgentConnector_ms": 0.06834149360656738}}, "episode_reward_max": -396.20219707899054, "episode_reward_min": -1226.797570888034, "episode_reward_mean": -750.3035997700438, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-968.6082486048847, -827.9117297349418, -637.6223482786262, -471.54099854198716, -562.7613428530823, -1036.7485457166297, -835.1444152936571, -916.8798055822496, -612.6285304627245, -838.6797304564644, -915.8508553863994, -732.3409940018564, -690.1162216488492, -779.6795651570592, -555.1149056104323, -936.3447646139771, -1042.3464040082167, -468.3265675424672, -939.7922804445831, -684.3190637340327, -540.7743997995757, -783.5540047216905, -673.8388256749915, -963.081088786078, -710.1919984333938, -1027.9019545691815, -664.8463262061819, -956.2598000434107, -549.9045453916402, -816.0290535357641, -698.6277163614873, -615.0870974807135, -750.0913896161829, -582.127437945606, -860.9710669091851, -832.9116146204669, -934.1471091532792, -942.6333953506391, -644.3010386931793, -446.82302908714126, -562.8365451590711, -899.4382101971137, -681.7546898899897, -396.20219707899054, -1153.319216414967, -906.6698809109502, -724.3444934773449, -639.2128771811185, -1068.6151542301675, -885.8256411502261, -974.4476874015886, -740.7426356422269, -701.5522770266058, -939.2311313049262, -582.0840716295429, -672.4441446329135, -640.3641846789762, -1223.3009114164038, -913.6345980516116, -545.4089247607222, -810.0440549897335, -663.930560828732, -559.3303000967367, -525.3723163635021, -683.9959750337031, -776.4869422892696, -611.2292571485175, -616.76316791701, -923.4003012002925, -871.7526413853368, -840.2026916801607, -936.3707455133615, -663.2200970908967, -1226.797570888034, -718.2796093497702, -914.2861592312288, -655.065744427001, -1082.2097938096156, -927.692195471006, -621.6732421245882, -544.7591865826065, -646.8707180877126, -517.5628746402506, -487.8092022886465, -687.1596566903298, -643.4548666039393, -651.6337263764176, -592.7767168399545, -802.5153282624101, -1099.1762628277393, -445.1529978284388, -778.5653613859414, -610.1975378198206, -673.272634866685, -523.2399561542325, -566.206243214677, -531.0503328488047, -566.9073212997645, -850.6987402180574, -884.9572630410971], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.34780013100307, "mean_inference_ms": 0.4086157023475454, "mean_action_processing_ms": 0.0965760573777904, "mean_env_wait_ms": 2.709122342552445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003725767135620117, "StateBufferConnector_ms": 0.0027921199798583984, "ViewRequirementAgentConnector_ms": 0.06834149360656738}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 298560, "num_agent_steps_trained": 298560, "num_env_steps_sampled": 298560, "num_env_steps_trained": 298560, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.40888522238869, "num_env_steps_trained_throughput_per_sec": 41.40888522238869, "timesteps_total": 298560, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 298560, "timers": {"training_iteration_time_ms": 2953.213, "sample_time_ms": 2949.1, "load_time_ms": 0.266, "load_throughput": 451850.687, "learn_time_ms": 3.035, "learn_throughput": 39534.717, "synch_weights_time_ms": 0.751}, "counters": {"num_env_steps_sampled": 298560, "num_env_steps_trained": 298560, "num_agent_steps_sampled": 298560, "num_agent_steps_trained": 298560}, "done": false, "episodes_total": 2488, "training_iteration": 623, "trial_id": "53665_00000", "date": "2023-07-26_03-53-25", "timestamp": 1690332805, "time_this_iter_s": 11.594533681869507, "time_total_s": 7543.069664239883, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1921.7441883087158, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 41.71176470588235, "ram_util_percent": 72.24705882352941}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.44378662109375, "policy_loss": -97271.9765625, "vf_loss": 4649868.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 654.0, "diff_num_grad_updates_vs_sampler_policy": 653.0}}, "num_env_steps_sampled": 299040, "num_env_steps_trained": 299040, "num_agent_steps_sampled": 299040, "num_agent_steps_trained": 299040}, "sampler_results": {"episode_reward_max": -396.20219707899054, "episode_reward_min": -1226.797570888034, "episode_reward_mean": -745.2219038460684, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-562.7613428530823, -1036.7485457166297, -835.1444152936571, -916.8798055822496, -612.6285304627245, -838.6797304564644, -915.8508553863994, -732.3409940018564, -690.1162216488492, -779.6795651570592, -555.1149056104323, -936.3447646139771, -1042.3464040082167, -468.3265675424672, -939.7922804445831, -684.3190637340327, -540.7743997995757, -783.5540047216905, -673.8388256749915, -963.081088786078, -710.1919984333938, -1027.9019545691815, -664.8463262061819, -956.2598000434107, -549.9045453916402, -816.0290535357641, -698.6277163614873, -615.0870974807135, -750.0913896161829, -582.127437945606, -860.9710669091851, -832.9116146204669, -934.1471091532792, -942.6333953506391, -644.3010386931793, -446.82302908714126, -562.8365451590711, -899.4382101971137, -681.7546898899897, -396.20219707899054, -1153.319216414967, -906.6698809109502, -724.3444934773449, -639.2128771811185, -1068.6151542301675, -885.8256411502261, -974.4476874015886, -740.7426356422269, -701.5522770266058, -939.2311313049262, -582.0840716295429, -672.4441446329135, -640.3641846789762, -1223.3009114164038, -913.6345980516116, -545.4089247607222, -810.0440549897335, -663.930560828732, -559.3303000967367, -525.3723163635021, -683.9959750337031, -776.4869422892696, -611.2292571485175, -616.76316791701, -923.4003012002925, -871.7526413853368, -840.2026916801607, -936.3707455133615, -663.2200970908967, -1226.797570888034, -718.2796093497702, -914.2861592312288, -655.065744427001, -1082.2097938096156, -927.692195471006, -621.6732421245882, -544.7591865826065, -646.8707180877126, -517.5628746402506, -487.8092022886465, -687.1596566903298, -643.4548666039393, -651.6337263764176, -592.7767168399545, -802.5153282624101, -1099.1762628277393, -445.1529978284388, -778.5653613859414, -610.1975378198206, -673.272634866685, -523.2399561542325, -566.206243214677, -531.0503328488047, -566.9073212997645, -850.6987402180574, -884.9572630410971, -694.6014679172719, -541.0020284251477, -465.3649278818729, -696.5453085385882], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.346725270510284, "mean_inference_ms": 0.40853581740744105, "mean_action_processing_ms": 0.09656467480965976, "mean_env_wait_ms": 2.7087201821637974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037279129028320312, "StateBufferConnector_ms": 0.002801179885864258, "ViewRequirementAgentConnector_ms": 0.06852531433105469}}, "episode_reward_max": -396.20219707899054, "episode_reward_min": -1226.797570888034, "episode_reward_mean": -745.2219038460684, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-562.7613428530823, -1036.7485457166297, -835.1444152936571, -916.8798055822496, -612.6285304627245, -838.6797304564644, -915.8508553863994, -732.3409940018564, -690.1162216488492, -779.6795651570592, -555.1149056104323, -936.3447646139771, -1042.3464040082167, -468.3265675424672, -939.7922804445831, -684.3190637340327, -540.7743997995757, -783.5540047216905, -673.8388256749915, -963.081088786078, -710.1919984333938, -1027.9019545691815, -664.8463262061819, -956.2598000434107, -549.9045453916402, -816.0290535357641, -698.6277163614873, -615.0870974807135, -750.0913896161829, -582.127437945606, -860.9710669091851, -832.9116146204669, -934.1471091532792, -942.6333953506391, -644.3010386931793, -446.82302908714126, -562.8365451590711, -899.4382101971137, -681.7546898899897, -396.20219707899054, -1153.319216414967, -906.6698809109502, -724.3444934773449, -639.2128771811185, -1068.6151542301675, -885.8256411502261, -974.4476874015886, -740.7426356422269, -701.5522770266058, -939.2311313049262, -582.0840716295429, -672.4441446329135, -640.3641846789762, -1223.3009114164038, -913.6345980516116, -545.4089247607222, -810.0440549897335, -663.930560828732, -559.3303000967367, -525.3723163635021, -683.9959750337031, -776.4869422892696, -611.2292571485175, -616.76316791701, -923.4003012002925, -871.7526413853368, -840.2026916801607, -936.3707455133615, -663.2200970908967, -1226.797570888034, -718.2796093497702, -914.2861592312288, -655.065744427001, -1082.2097938096156, -927.692195471006, -621.6732421245882, -544.7591865826065, -646.8707180877126, -517.5628746402506, -487.8092022886465, -687.1596566903298, -643.4548666039393, -651.6337263764176, -592.7767168399545, -802.5153282624101, -1099.1762628277393, -445.1529978284388, -778.5653613859414, -610.1975378198206, -673.272634866685, -523.2399561542325, -566.206243214677, -531.0503328488047, -566.9073212997645, -850.6987402180574, -884.9572630410971, -694.6014679172719, -541.0020284251477, -465.3649278818729, -696.5453085385882], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.346725270510284, "mean_inference_ms": 0.40853581740744105, "mean_action_processing_ms": 0.09656467480965976, "mean_env_wait_ms": 2.7087201821637974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037279129028320312, "StateBufferConnector_ms": 0.002801179885864258, "ViewRequirementAgentConnector_ms": 0.06852531433105469}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 299040, "num_agent_steps_trained": 299040, "num_env_steps_sampled": 299040, "num_env_steps_trained": 299040, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.28170366711091, "num_env_steps_trained_throughput_per_sec": 41.28170366711091, "timesteps_total": 299040, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 299040, "timers": {"training_iteration_time_ms": 2943.87, "sample_time_ms": 2939.763, "load_time_ms": 0.266, "load_throughput": 451485.899, "learn_time_ms": 3.015, "learn_throughput": 39802.338, "synch_weights_time_ms": 0.764}, "counters": {"num_env_steps_sampled": 299040, "num_env_steps_trained": 299040, "num_agent_steps_sampled": 299040, "num_agent_steps_trained": 299040}, "done": false, "episodes_total": 2492, "training_iteration": 624, "trial_id": "53665_00000", "date": "2023-07-26_03-53-36", "timestamp": 1690332816, "time_this_iter_s": 11.630141973495483, "time_total_s": 7554.699806213379, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1933.3743302822113, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 39.66875, "ram_util_percent": 70.6875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4713134765625, "policy_loss": -78005.890625, "vf_loss": 3017103.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 658.0, "diff_num_grad_updates_vs_sampler_policy": 657.0}}, "num_env_steps_sampled": 299520, "num_env_steps_trained": 299520, "num_agent_steps_sampled": 299520, "num_agent_steps_trained": 299520}, "sampler_results": {"episode_reward_max": -396.20219707899054, "episode_reward_min": -1226.797570888034, "episode_reward_mean": -735.275626748146, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-612.6285304627245, -838.6797304564644, -915.8508553863994, -732.3409940018564, -690.1162216488492, -779.6795651570592, -555.1149056104323, -936.3447646139771, -1042.3464040082167, -468.3265675424672, -939.7922804445831, -684.3190637340327, -540.7743997995757, -783.5540047216905, -673.8388256749915, -963.081088786078, -710.1919984333938, -1027.9019545691815, -664.8463262061819, -956.2598000434107, -549.9045453916402, -816.0290535357641, -698.6277163614873, -615.0870974807135, -750.0913896161829, -582.127437945606, -860.9710669091851, -832.9116146204669, -934.1471091532792, -942.6333953506391, -644.3010386931793, -446.82302908714126, -562.8365451590711, -899.4382101971137, -681.7546898899897, -396.20219707899054, -1153.319216414967, -906.6698809109502, -724.3444934773449, -639.2128771811185, -1068.6151542301675, -885.8256411502261, -974.4476874015886, -740.7426356422269, -701.5522770266058, -939.2311313049262, -582.0840716295429, -672.4441446329135, -640.3641846789762, -1223.3009114164038, -913.6345980516116, -545.4089247607222, -810.0440549897335, -663.930560828732, -559.3303000967367, -525.3723163635021, -683.9959750337031, -776.4869422892696, -611.2292571485175, -616.76316791701, -923.4003012002925, -871.7526413853368, -840.2026916801607, -936.3707455133615, -663.2200970908967, -1226.797570888034, -718.2796093497702, -914.2861592312288, -655.065744427001, -1082.2097938096156, -927.692195471006, -621.6732421245882, -544.7591865826065, -646.8707180877126, -517.5628746402506, -487.8092022886465, -687.1596566903298, -643.4548666039393, -651.6337263764176, -592.7767168399545, -802.5153282624101, -1099.1762628277393, -445.1529978284388, -778.5653613859414, -610.1975378198206, -673.272634866685, -523.2399561542325, -566.206243214677, -531.0503328488047, -566.9073212997645, -850.6987402180574, -884.9572630410971, -694.6014679172719, -541.0020284251477, -465.3649278818729, -696.5453085385882, -414.31184606427246, -723.5138060119428, -615.7874241350772, -603.2933234420765], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.345478325820025, "mean_inference_ms": 0.40846561584465035, "mean_action_processing_ms": 0.09655599827633637, "mean_env_wait_ms": 2.7083019858074517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003728151321411133, "StateBufferConnector_ms": 0.0027959346771240234, "ViewRequirementAgentConnector_ms": 0.06857013702392578}}, "episode_reward_max": -396.20219707899054, "episode_reward_min": -1226.797570888034, "episode_reward_mean": -735.275626748146, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-612.6285304627245, -838.6797304564644, -915.8508553863994, -732.3409940018564, -690.1162216488492, -779.6795651570592, -555.1149056104323, -936.3447646139771, -1042.3464040082167, -468.3265675424672, -939.7922804445831, -684.3190637340327, -540.7743997995757, -783.5540047216905, -673.8388256749915, -963.081088786078, -710.1919984333938, -1027.9019545691815, -664.8463262061819, -956.2598000434107, -549.9045453916402, -816.0290535357641, -698.6277163614873, -615.0870974807135, -750.0913896161829, -582.127437945606, -860.9710669091851, -832.9116146204669, -934.1471091532792, -942.6333953506391, -644.3010386931793, -446.82302908714126, -562.8365451590711, -899.4382101971137, -681.7546898899897, -396.20219707899054, -1153.319216414967, -906.6698809109502, -724.3444934773449, -639.2128771811185, -1068.6151542301675, -885.8256411502261, -974.4476874015886, -740.7426356422269, -701.5522770266058, -939.2311313049262, -582.0840716295429, -672.4441446329135, -640.3641846789762, -1223.3009114164038, -913.6345980516116, -545.4089247607222, -810.0440549897335, -663.930560828732, -559.3303000967367, -525.3723163635021, -683.9959750337031, -776.4869422892696, -611.2292571485175, -616.76316791701, -923.4003012002925, -871.7526413853368, -840.2026916801607, -936.3707455133615, -663.2200970908967, -1226.797570888034, -718.2796093497702, -914.2861592312288, -655.065744427001, -1082.2097938096156, -927.692195471006, -621.6732421245882, -544.7591865826065, -646.8707180877126, -517.5628746402506, -487.8092022886465, -687.1596566903298, -643.4548666039393, -651.6337263764176, -592.7767168399545, -802.5153282624101, -1099.1762628277393, -445.1529978284388, -778.5653613859414, -610.1975378198206, -673.272634866685, -523.2399561542325, -566.206243214677, -531.0503328488047, -566.9073212997645, -850.6987402180574, -884.9572630410971, -694.6014679172719, -541.0020284251477, -465.3649278818729, -696.5453085385882, -414.31184606427246, -723.5138060119428, -615.7874241350772, -603.2933234420765], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.345478325820025, "mean_inference_ms": 0.40846561584465035, "mean_action_processing_ms": 0.09655599827633637, "mean_env_wait_ms": 2.7083019858074517, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003728151321411133, "StateBufferConnector_ms": 0.0027959346771240234, "ViewRequirementAgentConnector_ms": 0.06857013702392578}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 299520, "num_agent_steps_trained": 299520, "num_env_steps_sampled": 299520, "num_env_steps_trained": 299520, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.22704813720745, "num_env_steps_trained_throughput_per_sec": 41.22704813720745, "timesteps_total": 299520, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 299520, "timers": {"training_iteration_time_ms": 2900.44, "sample_time_ms": 2896.678, "load_time_ms": 0.215, "load_throughput": 557259.167, "learn_time_ms": 2.791, "learn_throughput": 42990.944, "synch_weights_time_ms": 0.715}, "counters": {"num_env_steps_sampled": 299520, "num_env_steps_trained": 299520, "num_agent_steps_sampled": 299520, "num_agent_steps_trained": 299520}, "done": false, "episodes_total": 2496, "training_iteration": 625, "trial_id": "53665_00000", "date": "2023-07-26_03-53-48", "timestamp": 1690332828, "time_this_iter_s": 11.645570039749146, "time_total_s": 7566.345376253128, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1945.0199003219604, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 41.311764705882354, "ram_util_percent": 70.65294117647059}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.47100830078125, "policy_loss": -99230.953125, "vf_loss": 4578675.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 662.0, "diff_num_grad_updates_vs_sampler_policy": 661.0}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "sampler_results": {"episode_reward_max": -396.20219707899054, "episode_reward_min": -1226.797570888034, "episode_reward_mean": -734.580999937632, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-690.1162216488492, -779.6795651570592, -555.1149056104323, -936.3447646139771, -1042.3464040082167, -468.3265675424672, -939.7922804445831, -684.3190637340327, -540.7743997995757, -783.5540047216905, -673.8388256749915, -963.081088786078, -710.1919984333938, -1027.9019545691815, -664.8463262061819, -956.2598000434107, -549.9045453916402, -816.0290535357641, -698.6277163614873, -615.0870974807135, -750.0913896161829, -582.127437945606, -860.9710669091851, -832.9116146204669, -934.1471091532792, -942.6333953506391, -644.3010386931793, -446.82302908714126, -562.8365451590711, -899.4382101971137, -681.7546898899897, -396.20219707899054, -1153.319216414967, -906.6698809109502, -724.3444934773449, -639.2128771811185, -1068.6151542301675, -885.8256411502261, -974.4476874015886, -740.7426356422269, -701.5522770266058, -939.2311313049262, -582.0840716295429, -672.4441446329135, -640.3641846789762, -1223.3009114164038, -913.6345980516116, -545.4089247607222, -810.0440549897335, -663.930560828732, -559.3303000967367, -525.3723163635021, -683.9959750337031, -776.4869422892696, -611.2292571485175, -616.76316791701, -923.4003012002925, -871.7526413853368, -840.2026916801607, -936.3707455133615, -663.2200970908967, -1226.797570888034, -718.2796093497702, -914.2861592312288, -655.065744427001, -1082.2097938096156, -927.692195471006, -621.6732421245882, -544.7591865826065, -646.8707180877126, -517.5628746402506, -487.8092022886465, -687.1596566903298, -643.4548666039393, -651.6337263764176, -592.7767168399545, -802.5153282624101, -1099.1762628277393, -445.1529978284388, -778.5653613859414, -610.1975378198206, -673.272634866685, -523.2399561542325, -566.206243214677, -531.0503328488047, -566.9073212997645, -850.6987402180574, -884.9572630410971, -694.6014679172719, -541.0020284251477, -465.3649278818729, -696.5453085385882, -414.31184606427246, -723.5138060119428, -615.7874241350772, -603.2933234420765, -739.4105484160322, -959.4067956660626, -587.3315243529139, -743.8885608210755], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.344435468732105, "mean_inference_ms": 0.40839834224111216, "mean_action_processing_ms": 0.09654766576383364, "mean_env_wait_ms": 2.7078754054295597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003732919692993164, "StateBufferConnector_ms": 0.0027976036071777344, "ViewRequirementAgentConnector_ms": 0.06857180595397949}}, "episode_reward_max": -396.20219707899054, "episode_reward_min": -1226.797570888034, "episode_reward_mean": -734.580999937632, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-690.1162216488492, -779.6795651570592, -555.1149056104323, -936.3447646139771, -1042.3464040082167, -468.3265675424672, -939.7922804445831, -684.3190637340327, -540.7743997995757, -783.5540047216905, -673.8388256749915, -963.081088786078, -710.1919984333938, -1027.9019545691815, -664.8463262061819, -956.2598000434107, -549.9045453916402, -816.0290535357641, -698.6277163614873, -615.0870974807135, -750.0913896161829, -582.127437945606, -860.9710669091851, -832.9116146204669, -934.1471091532792, -942.6333953506391, -644.3010386931793, -446.82302908714126, -562.8365451590711, -899.4382101971137, -681.7546898899897, -396.20219707899054, -1153.319216414967, -906.6698809109502, -724.3444934773449, -639.2128771811185, -1068.6151542301675, -885.8256411502261, -974.4476874015886, -740.7426356422269, -701.5522770266058, -939.2311313049262, -582.0840716295429, -672.4441446329135, -640.3641846789762, -1223.3009114164038, -913.6345980516116, -545.4089247607222, -810.0440549897335, -663.930560828732, -559.3303000967367, -525.3723163635021, -683.9959750337031, -776.4869422892696, -611.2292571485175, -616.76316791701, -923.4003012002925, -871.7526413853368, -840.2026916801607, -936.3707455133615, -663.2200970908967, -1226.797570888034, -718.2796093497702, -914.2861592312288, -655.065744427001, -1082.2097938096156, -927.692195471006, -621.6732421245882, -544.7591865826065, -646.8707180877126, -517.5628746402506, -487.8092022886465, -687.1596566903298, -643.4548666039393, -651.6337263764176, -592.7767168399545, -802.5153282624101, -1099.1762628277393, -445.1529978284388, -778.5653613859414, -610.1975378198206, -673.272634866685, -523.2399561542325, -566.206243214677, -531.0503328488047, -566.9073212997645, -850.6987402180574, -884.9572630410971, -694.6014679172719, -541.0020284251477, -465.3649278818729, -696.5453085385882, -414.31184606427246, -723.5138060119428, -615.7874241350772, -603.2933234420765, -739.4105484160322, -959.4067956660626, -587.3315243529139, -743.8885608210755], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.344435468732105, "mean_inference_ms": 0.40839834224111216, "mean_action_processing_ms": 0.09654766576383364, "mean_env_wait_ms": 2.7078754054295597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003732919692993164, "StateBufferConnector_ms": 0.0027976036071777344, "ViewRequirementAgentConnector_ms": 0.06857180595397949}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.72743220956584, "num_env_steps_trained_throughput_per_sec": 40.72743220956584, "timesteps_total": 300000, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 300000, "timers": {"training_iteration_time_ms": 2926.554, "sample_time_ms": 2922.779, "load_time_ms": 0.214, "load_throughput": 559613.609, "learn_time_ms": 2.803, "learn_throughput": 42813.583, "synch_weights_time_ms": 0.718}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "done": false, "episodes_total": 2500, "training_iteration": 626, "trial_id": "53665_00000", "date": "2023-07-26_03-54-00", "timestamp": 1690332840, "time_this_iter_s": 11.788393020629883, "time_total_s": 7578.133769273758, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1956.8082933425903, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 40.61176470588235, "ram_util_percent": 72.56470588235294}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4535217285156, "policy_loss": -78857.6875, "vf_loss": 3075041.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 666.0, "diff_num_grad_updates_vs_sampler_policy": 665.0}}, "num_env_steps_sampled": 300480, "num_env_steps_trained": 300480, "num_agent_steps_sampled": 300480, "num_agent_steps_trained": 300480}, "sampler_results": {"episode_reward_max": -396.20219707899054, "episode_reward_min": -1226.797570888034, "episode_reward_mean": -731.8199367218263, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1042.3464040082167, -468.3265675424672, -939.7922804445831, -684.3190637340327, -540.7743997995757, -783.5540047216905, -673.8388256749915, -963.081088786078, -710.1919984333938, -1027.9019545691815, -664.8463262061819, -956.2598000434107, -549.9045453916402, -816.0290535357641, -698.6277163614873, -615.0870974807135, -750.0913896161829, -582.127437945606, -860.9710669091851, -832.9116146204669, -934.1471091532792, -942.6333953506391, -644.3010386931793, -446.82302908714126, -562.8365451590711, -899.4382101971137, -681.7546898899897, -396.20219707899054, -1153.319216414967, -906.6698809109502, -724.3444934773449, -639.2128771811185, -1068.6151542301675, -885.8256411502261, -974.4476874015886, -740.7426356422269, -701.5522770266058, -939.2311313049262, -582.0840716295429, -672.4441446329135, -640.3641846789762, -1223.3009114164038, -913.6345980516116, -545.4089247607222, -810.0440549897335, -663.930560828732, -559.3303000967367, -525.3723163635021, -683.9959750337031, -776.4869422892696, -611.2292571485175, -616.76316791701, -923.4003012002925, -871.7526413853368, -840.2026916801607, -936.3707455133615, -663.2200970908967, -1226.797570888034, -718.2796093497702, -914.2861592312288, -655.065744427001, -1082.2097938096156, -927.692195471006, -621.6732421245882, -544.7591865826065, -646.8707180877126, -517.5628746402506, -487.8092022886465, -687.1596566903298, -643.4548666039393, -651.6337263764176, -592.7767168399545, -802.5153282624101, -1099.1762628277393, -445.1529978284388, -778.5653613859414, -610.1975378198206, -673.272634866685, -523.2399561542325, -566.206243214677, -531.0503328488047, -566.9073212997645, -850.6987402180574, -884.9572630410971, -694.6014679172719, -541.0020284251477, -465.3649278818729, -696.5453085385882, -414.31184606427246, -723.5138060119428, -615.7874241350772, -603.2933234420765, -739.4105484160322, -959.4067956660626, -587.3315243529139, -743.8885608210755, -699.8833499917077, -950.5467068459807, -413.51370488978205, -621.2053737222399], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.343413971678945, "mean_inference_ms": 0.40833635564207676, "mean_action_processing_ms": 0.09654030188772106, "mean_env_wait_ms": 2.7074620602227695, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003739595413208008, "StateBufferConnector_ms": 0.0028045177459716797, "ViewRequirementAgentConnector_ms": 0.06864595413208008}}, "episode_reward_max": -396.20219707899054, "episode_reward_min": -1226.797570888034, "episode_reward_mean": -731.8199367218263, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1042.3464040082167, -468.3265675424672, -939.7922804445831, -684.3190637340327, -540.7743997995757, -783.5540047216905, -673.8388256749915, -963.081088786078, -710.1919984333938, -1027.9019545691815, -664.8463262061819, -956.2598000434107, -549.9045453916402, -816.0290535357641, -698.6277163614873, -615.0870974807135, -750.0913896161829, -582.127437945606, -860.9710669091851, -832.9116146204669, -934.1471091532792, -942.6333953506391, -644.3010386931793, -446.82302908714126, -562.8365451590711, -899.4382101971137, -681.7546898899897, -396.20219707899054, -1153.319216414967, -906.6698809109502, -724.3444934773449, -639.2128771811185, -1068.6151542301675, -885.8256411502261, -974.4476874015886, -740.7426356422269, -701.5522770266058, -939.2311313049262, -582.0840716295429, -672.4441446329135, -640.3641846789762, -1223.3009114164038, -913.6345980516116, -545.4089247607222, -810.0440549897335, -663.930560828732, -559.3303000967367, -525.3723163635021, -683.9959750337031, -776.4869422892696, -611.2292571485175, -616.76316791701, -923.4003012002925, -871.7526413853368, -840.2026916801607, -936.3707455133615, -663.2200970908967, -1226.797570888034, -718.2796093497702, -914.2861592312288, -655.065744427001, -1082.2097938096156, -927.692195471006, -621.6732421245882, -544.7591865826065, -646.8707180877126, -517.5628746402506, -487.8092022886465, -687.1596566903298, -643.4548666039393, -651.6337263764176, -592.7767168399545, -802.5153282624101, -1099.1762628277393, -445.1529978284388, -778.5653613859414, -610.1975378198206, -673.272634866685, -523.2399561542325, -566.206243214677, -531.0503328488047, -566.9073212997645, -850.6987402180574, -884.9572630410971, -694.6014679172719, -541.0020284251477, -465.3649278818729, -696.5453085385882, -414.31184606427246, -723.5138060119428, -615.7874241350772, -603.2933234420765, -739.4105484160322, -959.4067956660626, -587.3315243529139, -743.8885608210755, -699.8833499917077, -950.5467068459807, -413.51370488978205, -621.2053737222399], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.343413971678945, "mean_inference_ms": 0.40833635564207676, "mean_action_processing_ms": 0.09654030188772106, "mean_env_wait_ms": 2.7074620602227695, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003739595413208008, "StateBufferConnector_ms": 0.0028045177459716797, "ViewRequirementAgentConnector_ms": 0.06864595413208008}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300480, "num_agent_steps_trained": 300480, "num_env_steps_sampled": 300480, "num_env_steps_trained": 300480, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.616419599831914, "num_env_steps_trained_throughput_per_sec": 41.616419599831914, "timesteps_total": 300480, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 300480, "timers": {"training_iteration_time_ms": 2915.748, "sample_time_ms": 2911.958, "load_time_ms": 0.216, "load_throughput": 556273.74, "learn_time_ms": 2.826, "learn_throughput": 42460.707, "synch_weights_time_ms": 0.707}, "counters": {"num_env_steps_sampled": 300480, "num_env_steps_trained": 300480, "num_agent_steps_sampled": 300480, "num_agent_steps_trained": 300480}, "done": false, "episodes_total": 2504, "training_iteration": 627, "trial_id": "53665_00000", "date": "2023-07-26_03-54-11", "timestamp": 1690332851, "time_this_iter_s": 11.536707162857056, "time_total_s": 7589.670476436615, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1968.3450005054474, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 37.66875, "ram_util_percent": 68.3125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4793701171875, "policy_loss": -130026.625, "vf_loss": 6453280.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 670.0, "diff_num_grad_updates_vs_sampler_policy": 669.0}}, "num_env_steps_sampled": 300960, "num_env_steps_trained": 300960, "num_agent_steps_sampled": 300960, "num_agent_steps_trained": 300960}, "sampler_results": {"episode_reward_max": -308.1558841359608, "episode_reward_min": -1226.797570888034, "episode_reward_mean": -727.3228600086597, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-540.7743997995757, -783.5540047216905, -673.8388256749915, -963.081088786078, -710.1919984333938, -1027.9019545691815, -664.8463262061819, -956.2598000434107, -549.9045453916402, -816.0290535357641, -698.6277163614873, -615.0870974807135, -750.0913896161829, -582.127437945606, -860.9710669091851, -832.9116146204669, -934.1471091532792, -942.6333953506391, -644.3010386931793, -446.82302908714126, -562.8365451590711, -899.4382101971137, -681.7546898899897, -396.20219707899054, -1153.319216414967, -906.6698809109502, -724.3444934773449, -639.2128771811185, -1068.6151542301675, -885.8256411502261, -974.4476874015886, -740.7426356422269, -701.5522770266058, -939.2311313049262, -582.0840716295429, -672.4441446329135, -640.3641846789762, -1223.3009114164038, -913.6345980516116, -545.4089247607222, -810.0440549897335, -663.930560828732, -559.3303000967367, -525.3723163635021, -683.9959750337031, -776.4869422892696, -611.2292571485175, -616.76316791701, -923.4003012002925, -871.7526413853368, -840.2026916801607, -936.3707455133615, -663.2200970908967, -1226.797570888034, -718.2796093497702, -914.2861592312288, -655.065744427001, -1082.2097938096156, -927.692195471006, -621.6732421245882, -544.7591865826065, -646.8707180877126, -517.5628746402506, -487.8092022886465, -687.1596566903298, -643.4548666039393, -651.6337263764176, -592.7767168399545, -802.5153282624101, -1099.1762628277393, -445.1529978284388, -778.5653613859414, -610.1975378198206, -673.272634866685, -523.2399561542325, -566.206243214677, -531.0503328488047, -566.9073212997645, -850.6987402180574, -884.9572630410971, -694.6014679172719, -541.0020284251477, -465.3649278818729, -696.5453085385882, -414.31184606427246, -723.5138060119428, -615.7874241350772, -603.2933234420765, -739.4105484160322, -959.4067956660626, -587.3315243529139, -743.8885608210755, -699.8833499917077, -950.5467068459807, -413.51370488978205, -621.2053737222399, -724.7038425344531, -308.1558841359608, -717.7591497649998, -934.4577679772444], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.342460701653707, "mean_inference_ms": 0.4082749919285725, "mean_action_processing_ms": 0.09653307282030886, "mean_env_wait_ms": 2.707058105050042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003734111785888672, "StateBufferConnector_ms": 0.002794981002807617, "ViewRequirementAgentConnector_ms": 0.06859159469604492}}, "episode_reward_max": -308.1558841359608, "episode_reward_min": -1226.797570888034, "episode_reward_mean": -727.3228600086597, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-540.7743997995757, -783.5540047216905, -673.8388256749915, -963.081088786078, -710.1919984333938, -1027.9019545691815, -664.8463262061819, -956.2598000434107, -549.9045453916402, -816.0290535357641, -698.6277163614873, -615.0870974807135, -750.0913896161829, -582.127437945606, -860.9710669091851, -832.9116146204669, -934.1471091532792, -942.6333953506391, -644.3010386931793, -446.82302908714126, -562.8365451590711, -899.4382101971137, -681.7546898899897, -396.20219707899054, -1153.319216414967, -906.6698809109502, -724.3444934773449, -639.2128771811185, -1068.6151542301675, -885.8256411502261, -974.4476874015886, -740.7426356422269, -701.5522770266058, -939.2311313049262, -582.0840716295429, -672.4441446329135, -640.3641846789762, -1223.3009114164038, -913.6345980516116, -545.4089247607222, -810.0440549897335, -663.930560828732, -559.3303000967367, -525.3723163635021, -683.9959750337031, -776.4869422892696, -611.2292571485175, -616.76316791701, -923.4003012002925, -871.7526413853368, -840.2026916801607, -936.3707455133615, -663.2200970908967, -1226.797570888034, -718.2796093497702, -914.2861592312288, -655.065744427001, -1082.2097938096156, -927.692195471006, -621.6732421245882, -544.7591865826065, -646.8707180877126, -517.5628746402506, -487.8092022886465, -687.1596566903298, -643.4548666039393, -651.6337263764176, -592.7767168399545, -802.5153282624101, -1099.1762628277393, -445.1529978284388, -778.5653613859414, -610.1975378198206, -673.272634866685, -523.2399561542325, -566.206243214677, -531.0503328488047, -566.9073212997645, -850.6987402180574, -884.9572630410971, -694.6014679172719, -541.0020284251477, -465.3649278818729, -696.5453085385882, -414.31184606427246, -723.5138060119428, -615.7874241350772, -603.2933234420765, -739.4105484160322, -959.4067956660626, -587.3315243529139, -743.8885608210755, -699.8833499917077, -950.5467068459807, -413.51370488978205, -621.2053737222399, -724.7038425344531, -308.1558841359608, -717.7591497649998, -934.4577679772444], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.342460701653707, "mean_inference_ms": 0.4082749919285725, "mean_action_processing_ms": 0.09653307282030886, "mean_env_wait_ms": 2.707058105050042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003734111785888672, "StateBufferConnector_ms": 0.002794981002807617, "ViewRequirementAgentConnector_ms": 0.06859159469604492}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300960, "num_agent_steps_trained": 300960, "num_env_steps_sampled": 300960, "num_env_steps_trained": 300960, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.69721844468863, "num_env_steps_trained_throughput_per_sec": 40.69721844468863, "timesteps_total": 300960, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 300960, "timers": {"training_iteration_time_ms": 2915.97, "sample_time_ms": 2911.941, "load_time_ms": 0.225, "load_throughput": 532666.399, "learn_time_ms": 3.014, "learn_throughput": 39818.712, "synch_weights_time_ms": 0.748}, "counters": {"num_env_steps_sampled": 300960, "num_env_steps_trained": 300960, "num_agent_steps_sampled": 300960, "num_agent_steps_trained": 300960}, "done": false, "episodes_total": 2508, "training_iteration": 628, "trial_id": "53665_00000", "date": "2023-07-26_03-54-23", "timestamp": 1690332863, "time_this_iter_s": 11.798510074615479, "time_total_s": 7601.4689865112305, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1980.1435105800629, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 39.311764705882354, "ram_util_percent": 68.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4924011230469, "policy_loss": -72815.5859375, "vf_loss": 2425979.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 674.0, "diff_num_grad_updates_vs_sampler_policy": 673.0}}, "num_env_steps_sampled": 301440, "num_env_steps_trained": 301440, "num_agent_steps_sampled": 301440, "num_agent_steps_trained": 301440}, "sampler_results": {"episode_reward_max": -308.1558841359608, "episode_reward_min": -1226.797570888034, "episode_reward_mean": -726.4244438641065, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-710.1919984333938, -1027.9019545691815, -664.8463262061819, -956.2598000434107, -549.9045453916402, -816.0290535357641, -698.6277163614873, -615.0870974807135, -750.0913896161829, -582.127437945606, -860.9710669091851, -832.9116146204669, -934.1471091532792, -942.6333953506391, -644.3010386931793, -446.82302908714126, -562.8365451590711, -899.4382101971137, -681.7546898899897, -396.20219707899054, -1153.319216414967, -906.6698809109502, -724.3444934773449, -639.2128771811185, -1068.6151542301675, -885.8256411502261, -974.4476874015886, -740.7426356422269, -701.5522770266058, -939.2311313049262, -582.0840716295429, -672.4441446329135, -640.3641846789762, -1223.3009114164038, -913.6345980516116, -545.4089247607222, -810.0440549897335, -663.930560828732, -559.3303000967367, -525.3723163635021, -683.9959750337031, -776.4869422892696, -611.2292571485175, -616.76316791701, -923.4003012002925, -871.7526413853368, -840.2026916801607, -936.3707455133615, -663.2200970908967, -1226.797570888034, -718.2796093497702, -914.2861592312288, -655.065744427001, -1082.2097938096156, -927.692195471006, -621.6732421245882, -544.7591865826065, -646.8707180877126, -517.5628746402506, -487.8092022886465, -687.1596566903298, -643.4548666039393, -651.6337263764176, -592.7767168399545, -802.5153282624101, -1099.1762628277393, -445.1529978284388, -778.5653613859414, -610.1975378198206, -673.272634866685, -523.2399561542325, -566.206243214677, -531.0503328488047, -566.9073212997645, -850.6987402180574, -884.9572630410971, -694.6014679172719, -541.0020284251477, -465.3649278818729, -696.5453085385882, -414.31184606427246, -723.5138060119428, -615.7874241350772, -603.2933234420765, -739.4105484160322, -959.4067956660626, -587.3315243529139, -743.8885608210755, -699.8833499917077, -950.5467068459807, -413.51370488978205, -621.2053737222399, -724.7038425344531, -308.1558841359608, -717.7591497649998, -934.4577679772444, -923.8105750860786, -800.3754143231071, -557.1646893174938, -590.0560258003314], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.341596003135763, "mean_inference_ms": 0.40823935758912533, "mean_action_processing_ms": 0.09652997674066896, "mean_env_wait_ms": 2.70669771983964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037841796875, "StateBufferConnector_ms": 0.002805471420288086, "ViewRequirementAgentConnector_ms": 0.06959772109985352}}, "episode_reward_max": -308.1558841359608, "episode_reward_min": -1226.797570888034, "episode_reward_mean": -726.4244438641065, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-710.1919984333938, -1027.9019545691815, -664.8463262061819, -956.2598000434107, -549.9045453916402, -816.0290535357641, -698.6277163614873, -615.0870974807135, -750.0913896161829, -582.127437945606, -860.9710669091851, -832.9116146204669, -934.1471091532792, -942.6333953506391, -644.3010386931793, -446.82302908714126, -562.8365451590711, -899.4382101971137, -681.7546898899897, -396.20219707899054, -1153.319216414967, -906.6698809109502, -724.3444934773449, -639.2128771811185, -1068.6151542301675, -885.8256411502261, -974.4476874015886, -740.7426356422269, -701.5522770266058, -939.2311313049262, -582.0840716295429, -672.4441446329135, -640.3641846789762, -1223.3009114164038, -913.6345980516116, -545.4089247607222, -810.0440549897335, -663.930560828732, -559.3303000967367, -525.3723163635021, -683.9959750337031, -776.4869422892696, -611.2292571485175, -616.76316791701, -923.4003012002925, -871.7526413853368, -840.2026916801607, -936.3707455133615, -663.2200970908967, -1226.797570888034, -718.2796093497702, -914.2861592312288, -655.065744427001, -1082.2097938096156, -927.692195471006, -621.6732421245882, -544.7591865826065, -646.8707180877126, -517.5628746402506, -487.8092022886465, -687.1596566903298, -643.4548666039393, -651.6337263764176, -592.7767168399545, -802.5153282624101, -1099.1762628277393, -445.1529978284388, -778.5653613859414, -610.1975378198206, -673.272634866685, -523.2399561542325, -566.206243214677, -531.0503328488047, -566.9073212997645, -850.6987402180574, -884.9572630410971, -694.6014679172719, -541.0020284251477, -465.3649278818729, -696.5453085385882, -414.31184606427246, -723.5138060119428, -615.7874241350772, -603.2933234420765, -739.4105484160322, -959.4067956660626, -587.3315243529139, -743.8885608210755, -699.8833499917077, -950.5467068459807, -413.51370488978205, -621.2053737222399, -724.7038425344531, -308.1558841359608, -717.7591497649998, -934.4577679772444, -923.8105750860786, -800.3754143231071, -557.1646893174938, -590.0560258003314], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.341596003135763, "mean_inference_ms": 0.40823935758912533, "mean_action_processing_ms": 0.09652997674066896, "mean_env_wait_ms": 2.70669771983964, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037841796875, "StateBufferConnector_ms": 0.002805471420288086, "ViewRequirementAgentConnector_ms": 0.06959772109985352}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 301440, "num_agent_steps_trained": 301440, "num_env_steps_sampled": 301440, "num_env_steps_trained": 301440, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.48600755030432, "num_env_steps_trained_throughput_per_sec": 39.48600755030432, "timesteps_total": 301440, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 301440, "timers": {"training_iteration_time_ms": 2959.252, "sample_time_ms": 2955.24, "load_time_ms": 0.226, "load_throughput": 530365.1, "learn_time_ms": 2.974, "learn_throughput": 40352.156, "synch_weights_time_ms": 0.77}, "counters": {"num_env_steps_sampled": 301440, "num_env_steps_trained": 301440, "num_agent_steps_sampled": 301440, "num_agent_steps_trained": 301440}, "done": false, "episodes_total": 2512, "training_iteration": 629, "trial_id": "53665_00000", "date": "2023-07-26_03-54-35", "timestamp": 1690332875, "time_this_iter_s": 12.162376880645752, "time_total_s": 7613.631363391876, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 1992.3058874607086, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 46.923529411764704, "ram_util_percent": 69.01176470588234}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.480712890625, "policy_loss": -86364.375, "vf_loss": 3575235.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 678.0, "diff_num_grad_updates_vs_sampler_policy": 677.0}}, "num_env_steps_sampled": 301920, "num_env_steps_trained": 301920, "num_agent_steps_sampled": 301920, "num_agent_steps_trained": 301920}, "sampler_results": {"episode_reward_max": -308.1558841359608, "episode_reward_min": -1226.797570888034, "episode_reward_mean": -720.3128862258908, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-549.9045453916402, -816.0290535357641, -698.6277163614873, -615.0870974807135, -750.0913896161829, -582.127437945606, -860.9710669091851, -832.9116146204669, -934.1471091532792, -942.6333953506391, -644.3010386931793, -446.82302908714126, -562.8365451590711, -899.4382101971137, -681.7546898899897, -396.20219707899054, -1153.319216414967, -906.6698809109502, -724.3444934773449, -639.2128771811185, -1068.6151542301675, -885.8256411502261, -974.4476874015886, -740.7426356422269, -701.5522770266058, -939.2311313049262, -582.0840716295429, -672.4441446329135, -640.3641846789762, -1223.3009114164038, -913.6345980516116, -545.4089247607222, -810.0440549897335, -663.930560828732, -559.3303000967367, -525.3723163635021, -683.9959750337031, -776.4869422892696, -611.2292571485175, -616.76316791701, -923.4003012002925, -871.7526413853368, -840.2026916801607, -936.3707455133615, -663.2200970908967, -1226.797570888034, -718.2796093497702, -914.2861592312288, -655.065744427001, -1082.2097938096156, -927.692195471006, -621.6732421245882, -544.7591865826065, -646.8707180877126, -517.5628746402506, -487.8092022886465, -687.1596566903298, -643.4548666039393, -651.6337263764176, -592.7767168399545, -802.5153282624101, -1099.1762628277393, -445.1529978284388, -778.5653613859414, -610.1975378198206, -673.272634866685, -523.2399561542325, -566.206243214677, -531.0503328488047, -566.9073212997645, -850.6987402180574, -884.9572630410971, -694.6014679172719, -541.0020284251477, -465.3649278818729, -696.5453085385882, -414.31184606427246, -723.5138060119428, -615.7874241350772, -603.2933234420765, -739.4105484160322, -959.4067956660626, -587.3315243529139, -743.8885608210755, -699.8833499917077, -950.5467068459807, -413.51370488978205, -621.2053737222399, -724.7038425344531, -308.1558841359608, -717.7591497649998, -934.4577679772444, -923.8105750860786, -800.3754143231071, -557.1646893174938, -590.0560258003314, -415.4778116010488, -816.1223866499049, -761.675271187059, -754.7688459926044], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.34082342921909, "mean_inference_ms": 0.4082114717930555, "mean_action_processing_ms": 0.09652815855112656, "mean_env_wait_ms": 2.7063672892187434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00379180908203125, "StateBufferConnector_ms": 0.0028176307678222656, "ViewRequirementAgentConnector_ms": 0.0697016716003418}}, "episode_reward_max": -308.1558841359608, "episode_reward_min": -1226.797570888034, "episode_reward_mean": -720.3128862258908, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-549.9045453916402, -816.0290535357641, -698.6277163614873, -615.0870974807135, -750.0913896161829, -582.127437945606, -860.9710669091851, -832.9116146204669, -934.1471091532792, -942.6333953506391, -644.3010386931793, -446.82302908714126, -562.8365451590711, -899.4382101971137, -681.7546898899897, -396.20219707899054, -1153.319216414967, -906.6698809109502, -724.3444934773449, -639.2128771811185, -1068.6151542301675, -885.8256411502261, -974.4476874015886, -740.7426356422269, -701.5522770266058, -939.2311313049262, -582.0840716295429, -672.4441446329135, -640.3641846789762, -1223.3009114164038, -913.6345980516116, -545.4089247607222, -810.0440549897335, -663.930560828732, -559.3303000967367, -525.3723163635021, -683.9959750337031, -776.4869422892696, -611.2292571485175, -616.76316791701, -923.4003012002925, -871.7526413853368, -840.2026916801607, -936.3707455133615, -663.2200970908967, -1226.797570888034, -718.2796093497702, -914.2861592312288, -655.065744427001, -1082.2097938096156, -927.692195471006, -621.6732421245882, -544.7591865826065, -646.8707180877126, -517.5628746402506, -487.8092022886465, -687.1596566903298, -643.4548666039393, -651.6337263764176, -592.7767168399545, -802.5153282624101, -1099.1762628277393, -445.1529978284388, -778.5653613859414, -610.1975378198206, -673.272634866685, -523.2399561542325, -566.206243214677, -531.0503328488047, -566.9073212997645, -850.6987402180574, -884.9572630410971, -694.6014679172719, -541.0020284251477, -465.3649278818729, -696.5453085385882, -414.31184606427246, -723.5138060119428, -615.7874241350772, -603.2933234420765, -739.4105484160322, -959.4067956660626, -587.3315243529139, -743.8885608210755, -699.8833499917077, -950.5467068459807, -413.51370488978205, -621.2053737222399, -724.7038425344531, -308.1558841359608, -717.7591497649998, -934.4577679772444, -923.8105750860786, -800.3754143231071, -557.1646893174938, -590.0560258003314, -415.4778116010488, -816.1223866499049, -761.675271187059, -754.7688459926044], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.34082342921909, "mean_inference_ms": 0.4082114717930555, "mean_action_processing_ms": 0.09652815855112656, "mean_env_wait_ms": 2.7063672892187434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00379180908203125, "StateBufferConnector_ms": 0.0028176307678222656, "ViewRequirementAgentConnector_ms": 0.0697016716003418}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 301920, "num_agent_steps_trained": 301920, "num_env_steps_sampled": 301920, "num_env_steps_trained": 301920, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.506349814316096, "num_env_steps_trained_throughput_per_sec": 40.506349814316096, "timesteps_total": 301920, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 301920, "timers": {"training_iteration_time_ms": 3001.426, "sample_time_ms": 2997.465, "load_time_ms": 0.222, "load_throughput": 540735.367, "learn_time_ms": 2.936, "learn_throughput": 40878.496, "synch_weights_time_ms": 0.761}, "counters": {"num_env_steps_sampled": 301920, "num_env_steps_trained": 301920, "num_agent_steps_sampled": 301920, "num_agent_steps_trained": 301920}, "done": false, "episodes_total": 2516, "training_iteration": 630, "trial_id": "53665_00000", "date": "2023-07-26_03-54-47", "timestamp": 1690332887, "time_this_iter_s": 11.852670907974243, "time_total_s": 7625.4840342998505, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2004.1585583686829, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 39.023529411764706, "ram_util_percent": 69.74117647058823}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.486572265625, "policy_loss": -129539.6328125, "vf_loss": 7105608.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 682.0, "diff_num_grad_updates_vs_sampler_policy": 681.0}}, "num_env_steps_sampled": 302400, "num_env_steps_trained": 302400, "num_agent_steps_sampled": 302400, "num_agent_steps_trained": 302400}, "sampler_results": {"episode_reward_max": -308.1558841359608, "episode_reward_min": -1226.797570888034, "episode_reward_mean": -722.9634499125101, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-750.0913896161829, -582.127437945606, -860.9710669091851, -832.9116146204669, -934.1471091532792, -942.6333953506391, -644.3010386931793, -446.82302908714126, -562.8365451590711, -899.4382101971137, -681.7546898899897, -396.20219707899054, -1153.319216414967, -906.6698809109502, -724.3444934773449, -639.2128771811185, -1068.6151542301675, -885.8256411502261, -974.4476874015886, -740.7426356422269, -701.5522770266058, -939.2311313049262, -582.0840716295429, -672.4441446329135, -640.3641846789762, -1223.3009114164038, -913.6345980516116, -545.4089247607222, -810.0440549897335, -663.930560828732, -559.3303000967367, -525.3723163635021, -683.9959750337031, -776.4869422892696, -611.2292571485175, -616.76316791701, -923.4003012002925, -871.7526413853368, -840.2026916801607, -936.3707455133615, -663.2200970908967, -1226.797570888034, -718.2796093497702, -914.2861592312288, -655.065744427001, -1082.2097938096156, -927.692195471006, -621.6732421245882, -544.7591865826065, -646.8707180877126, -517.5628746402506, -487.8092022886465, -687.1596566903298, -643.4548666039393, -651.6337263764176, -592.7767168399545, -802.5153282624101, -1099.1762628277393, -445.1529978284388, -778.5653613859414, -610.1975378198206, -673.272634866685, -523.2399561542325, -566.206243214677, -531.0503328488047, -566.9073212997645, -850.6987402180574, -884.9572630410971, -694.6014679172719, -541.0020284251477, -465.3649278818729, -696.5453085385882, -414.31184606427246, -723.5138060119428, -615.7874241350772, -603.2933234420765, -739.4105484160322, -959.4067956660626, -587.3315243529139, -743.8885608210755, -699.8833499917077, -950.5467068459807, -413.51370488978205, -621.2053737222399, -724.7038425344531, -308.1558841359608, -717.7591497649998, -934.4577679772444, -923.8105750860786, -800.3754143231071, -557.1646893174938, -590.0560258003314, -415.4778116010488, -816.1223866499049, -761.675271187059, -754.7688459926044, -500.8624242522775, -602.6506671710208, -877.1573800286106, -964.03430997962], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.34007743154389, "mean_inference_ms": 0.4081853541571896, "mean_action_processing_ms": 0.09652652340489837, "mean_env_wait_ms": 2.706074577492379, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037980079650878906, "StateBufferConnector_ms": 0.002809762954711914, "ViewRequirementAgentConnector_ms": 0.06972360610961914}}, "episode_reward_max": -308.1558841359608, "episode_reward_min": -1226.797570888034, "episode_reward_mean": -722.9634499125101, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-750.0913896161829, -582.127437945606, -860.9710669091851, -832.9116146204669, -934.1471091532792, -942.6333953506391, -644.3010386931793, -446.82302908714126, -562.8365451590711, -899.4382101971137, -681.7546898899897, -396.20219707899054, -1153.319216414967, -906.6698809109502, -724.3444934773449, -639.2128771811185, -1068.6151542301675, -885.8256411502261, -974.4476874015886, -740.7426356422269, -701.5522770266058, -939.2311313049262, -582.0840716295429, -672.4441446329135, -640.3641846789762, -1223.3009114164038, -913.6345980516116, -545.4089247607222, -810.0440549897335, -663.930560828732, -559.3303000967367, -525.3723163635021, -683.9959750337031, -776.4869422892696, -611.2292571485175, -616.76316791701, -923.4003012002925, -871.7526413853368, -840.2026916801607, -936.3707455133615, -663.2200970908967, -1226.797570888034, -718.2796093497702, -914.2861592312288, -655.065744427001, -1082.2097938096156, -927.692195471006, -621.6732421245882, -544.7591865826065, -646.8707180877126, -517.5628746402506, -487.8092022886465, -687.1596566903298, -643.4548666039393, -651.6337263764176, -592.7767168399545, -802.5153282624101, -1099.1762628277393, -445.1529978284388, -778.5653613859414, -610.1975378198206, -673.272634866685, -523.2399561542325, -566.206243214677, -531.0503328488047, -566.9073212997645, -850.6987402180574, -884.9572630410971, -694.6014679172719, -541.0020284251477, -465.3649278818729, -696.5453085385882, -414.31184606427246, -723.5138060119428, -615.7874241350772, -603.2933234420765, -739.4105484160322, -959.4067956660626, -587.3315243529139, -743.8885608210755, -699.8833499917077, -950.5467068459807, -413.51370488978205, -621.2053737222399, -724.7038425344531, -308.1558841359608, -717.7591497649998, -934.4577679772444, -923.8105750860786, -800.3754143231071, -557.1646893174938, -590.0560258003314, -415.4778116010488, -816.1223866499049, -761.675271187059, -754.7688459926044, -500.8624242522775, -602.6506671710208, -877.1573800286106, -964.03430997962], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.34007743154389, "mean_inference_ms": 0.4081853541571896, "mean_action_processing_ms": 0.09652652340489837, "mean_env_wait_ms": 2.706074577492379, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0037980079650878906, "StateBufferConnector_ms": 0.002809762954711914, "ViewRequirementAgentConnector_ms": 0.06972360610961914}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 302400, "num_agent_steps_trained": 302400, "num_env_steps_sampled": 302400, "num_env_steps_trained": 302400, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.36649788296434, "num_env_steps_trained_throughput_per_sec": 41.36649788296434, "timesteps_total": 302400, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 302400, "timers": {"training_iteration_time_ms": 2956.53, "sample_time_ms": 2952.73, "load_time_ms": 0.216, "load_throughput": 554863.279, "learn_time_ms": 2.811, "learn_throughput": 42695.187, "synch_weights_time_ms": 0.732}, "counters": {"num_env_steps_sampled": 302400, "num_env_steps_trained": 302400, "num_agent_steps_sampled": 302400, "num_agent_steps_trained": 302400}, "done": false, "episodes_total": 2520, "training_iteration": 631, "trial_id": "53665_00000", "date": "2023-07-26_03-54-59", "timestamp": 1690332899, "time_this_iter_s": 11.606240034103394, "time_total_s": 7637.090274333954, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2015.7647984027863, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 36.99411764705883, "ram_util_percent": 72.71176470588236}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.47283935546875, "policy_loss": -102526.6796875, "vf_loss": 4773565.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 686.0, "diff_num_grad_updates_vs_sampler_policy": 685.0}}, "num_env_steps_sampled": 302880, "num_env_steps_trained": 302880, "num_agent_steps_sampled": 302880, "num_agent_steps_trained": 302880}, "sampler_results": {"episode_reward_max": -308.1558841359608, "episode_reward_min": -1302.0509621184951, "episode_reward_mean": -729.1250672130918, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-934.1471091532792, -942.6333953506391, -644.3010386931793, -446.82302908714126, -562.8365451590711, -899.4382101971137, -681.7546898899897, -396.20219707899054, -1153.319216414967, -906.6698809109502, -724.3444934773449, -639.2128771811185, -1068.6151542301675, -885.8256411502261, -974.4476874015886, -740.7426356422269, -701.5522770266058, -939.2311313049262, -582.0840716295429, -672.4441446329135, -640.3641846789762, -1223.3009114164038, -913.6345980516116, -545.4089247607222, -810.0440549897335, -663.930560828732, -559.3303000967367, -525.3723163635021, -683.9959750337031, -776.4869422892696, -611.2292571485175, -616.76316791701, -923.4003012002925, -871.7526413853368, -840.2026916801607, -936.3707455133615, -663.2200970908967, -1226.797570888034, -718.2796093497702, -914.2861592312288, -655.065744427001, -1082.2097938096156, -927.692195471006, -621.6732421245882, -544.7591865826065, -646.8707180877126, -517.5628746402506, -487.8092022886465, -687.1596566903298, -643.4548666039393, -651.6337263764176, -592.7767168399545, -802.5153282624101, -1099.1762628277393, -445.1529978284388, -778.5653613859414, -610.1975378198206, -673.272634866685, -523.2399561542325, -566.206243214677, -531.0503328488047, -566.9073212997645, -850.6987402180574, -884.9572630410971, -694.6014679172719, -541.0020284251477, -465.3649278818729, -696.5453085385882, -414.31184606427246, -723.5138060119428, -615.7874241350772, -603.2933234420765, -739.4105484160322, -959.4067956660626, -587.3315243529139, -743.8885608210755, -699.8833499917077, -950.5467068459807, -413.51370488978205, -621.2053737222399, -724.7038425344531, -308.1558841359608, -717.7591497649998, -934.4577679772444, -923.8105750860786, -800.3754143231071, -557.1646893174938, -590.0560258003314, -415.4778116010488, -816.1223866499049, -761.675271187059, -754.7688459926044, -500.8624242522775, -602.6506671710208, -877.1573800286106, -964.03430997962, -758.1048815117643, -909.6811484896951, -1302.0509621184951, -672.4262470296612], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.339394105396924, "mean_inference_ms": 0.40816508883563907, "mean_action_processing_ms": 0.09652578132333846, "mean_env_wait_ms": 2.705795010329148, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003844738006591797, "StateBufferConnector_ms": 0.0028350353240966797, "ViewRequirementAgentConnector_ms": 0.07051467895507812}}, "episode_reward_max": -308.1558841359608, "episode_reward_min": -1302.0509621184951, "episode_reward_mean": -729.1250672130918, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-934.1471091532792, -942.6333953506391, -644.3010386931793, -446.82302908714126, -562.8365451590711, -899.4382101971137, -681.7546898899897, -396.20219707899054, -1153.319216414967, -906.6698809109502, -724.3444934773449, -639.2128771811185, -1068.6151542301675, -885.8256411502261, -974.4476874015886, -740.7426356422269, -701.5522770266058, -939.2311313049262, -582.0840716295429, -672.4441446329135, -640.3641846789762, -1223.3009114164038, -913.6345980516116, -545.4089247607222, -810.0440549897335, -663.930560828732, -559.3303000967367, -525.3723163635021, -683.9959750337031, -776.4869422892696, -611.2292571485175, -616.76316791701, -923.4003012002925, -871.7526413853368, -840.2026916801607, -936.3707455133615, -663.2200970908967, -1226.797570888034, -718.2796093497702, -914.2861592312288, -655.065744427001, -1082.2097938096156, -927.692195471006, -621.6732421245882, -544.7591865826065, -646.8707180877126, -517.5628746402506, -487.8092022886465, -687.1596566903298, -643.4548666039393, -651.6337263764176, -592.7767168399545, -802.5153282624101, -1099.1762628277393, -445.1529978284388, -778.5653613859414, -610.1975378198206, -673.272634866685, -523.2399561542325, -566.206243214677, -531.0503328488047, -566.9073212997645, -850.6987402180574, -884.9572630410971, -694.6014679172719, -541.0020284251477, -465.3649278818729, -696.5453085385882, -414.31184606427246, -723.5138060119428, -615.7874241350772, -603.2933234420765, -739.4105484160322, -959.4067956660626, -587.3315243529139, -743.8885608210755, -699.8833499917077, -950.5467068459807, -413.51370488978205, -621.2053737222399, -724.7038425344531, -308.1558841359608, -717.7591497649998, -934.4577679772444, -923.8105750860786, -800.3754143231071, -557.1646893174938, -590.0560258003314, -415.4778116010488, -816.1223866499049, -761.675271187059, -754.7688459926044, -500.8624242522775, -602.6506671710208, -877.1573800286106, -964.03430997962, -758.1048815117643, -909.6811484896951, -1302.0509621184951, -672.4262470296612], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.339394105396924, "mean_inference_ms": 0.40816508883563907, "mean_action_processing_ms": 0.09652578132333846, "mean_env_wait_ms": 2.705795010329148, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003844738006591797, "StateBufferConnector_ms": 0.0028350353240966797, "ViewRequirementAgentConnector_ms": 0.07051467895507812}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 302880, "num_agent_steps_trained": 302880, "num_env_steps_sampled": 302880, "num_env_steps_trained": 302880, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.815226021713144, "num_env_steps_trained_throughput_per_sec": 40.815226021713144, "timesteps_total": 302880, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 302880, "timers": {"training_iteration_time_ms": 2934.77, "sample_time_ms": 2930.982, "load_time_ms": 0.214, "load_throughput": 560174.157, "learn_time_ms": 2.817, "learn_throughput": 42602.311, "synch_weights_time_ms": 0.717}, "counters": {"num_env_steps_sampled": 302880, "num_env_steps_trained": 302880, "num_agent_steps_sampled": 302880, "num_agent_steps_trained": 302880}, "done": false, "episodes_total": 2524, "training_iteration": 632, "trial_id": "53665_00000", "date": "2023-07-26_03-55-11", "timestamp": 1690332911, "time_this_iter_s": 11.763044118881226, "time_total_s": 7648.853318452835, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2027.5278425216675, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 41.78125, "ram_util_percent": 73.5375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.47003173828125, "policy_loss": -54959.98046875, "vf_loss": 1508390.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 690.0, "diff_num_grad_updates_vs_sampler_policy": 689.0}}, "num_env_steps_sampled": 303360, "num_env_steps_trained": 303360, "num_agent_steps_sampled": 303360, "num_agent_steps_trained": 303360}, "sampler_results": {"episode_reward_max": -308.1558841359608, "episode_reward_min": -1302.0509621184951, "episode_reward_mean": -728.1674846534646, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-562.8365451590711, -899.4382101971137, -681.7546898899897, -396.20219707899054, -1153.319216414967, -906.6698809109502, -724.3444934773449, -639.2128771811185, -1068.6151542301675, -885.8256411502261, -974.4476874015886, -740.7426356422269, -701.5522770266058, -939.2311313049262, -582.0840716295429, -672.4441446329135, -640.3641846789762, -1223.3009114164038, -913.6345980516116, -545.4089247607222, -810.0440549897335, -663.930560828732, -559.3303000967367, -525.3723163635021, -683.9959750337031, -776.4869422892696, -611.2292571485175, -616.76316791701, -923.4003012002925, -871.7526413853368, -840.2026916801607, -936.3707455133615, -663.2200970908967, -1226.797570888034, -718.2796093497702, -914.2861592312288, -655.065744427001, -1082.2097938096156, -927.692195471006, -621.6732421245882, -544.7591865826065, -646.8707180877126, -517.5628746402506, -487.8092022886465, -687.1596566903298, -643.4548666039393, -651.6337263764176, -592.7767168399545, -802.5153282624101, -1099.1762628277393, -445.1529978284388, -778.5653613859414, -610.1975378198206, -673.272634866685, -523.2399561542325, -566.206243214677, -531.0503328488047, -566.9073212997645, -850.6987402180574, -884.9572630410971, -694.6014679172719, -541.0020284251477, -465.3649278818729, -696.5453085385882, -414.31184606427246, -723.5138060119428, -615.7874241350772, -603.2933234420765, -739.4105484160322, -959.4067956660626, -587.3315243529139, -743.8885608210755, -699.8833499917077, -950.5467068459807, -413.51370488978205, -621.2053737222399, -724.7038425344531, -308.1558841359608, -717.7591497649998, -934.4577679772444, -923.8105750860786, -800.3754143231071, -557.1646893174938, -590.0560258003314, -415.4778116010488, -816.1223866499049, -761.675271187059, -754.7688459926044, -500.8624242522775, -602.6506671710208, -877.1573800286106, -964.03430997962, -758.1048815117643, -909.6811484896951, -1302.0509621184951, -672.4262470296612, -774.2150450003941, -707.2905721421914, -880.4044582012302, -510.23624097769374], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.338830396398542, "mean_inference_ms": 0.4081503291161281, "mean_action_processing_ms": 0.09652585007701665, "mean_env_wait_ms": 2.7055180092199382, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038444995880126953, "StateBufferConnector_ms": 0.0028426647186279297, "ViewRequirementAgentConnector_ms": 0.07053756713867188}}, "episode_reward_max": -308.1558841359608, "episode_reward_min": -1302.0509621184951, "episode_reward_mean": -728.1674846534646, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-562.8365451590711, -899.4382101971137, -681.7546898899897, -396.20219707899054, -1153.319216414967, -906.6698809109502, -724.3444934773449, -639.2128771811185, -1068.6151542301675, -885.8256411502261, -974.4476874015886, -740.7426356422269, -701.5522770266058, -939.2311313049262, -582.0840716295429, -672.4441446329135, -640.3641846789762, -1223.3009114164038, -913.6345980516116, -545.4089247607222, -810.0440549897335, -663.930560828732, -559.3303000967367, -525.3723163635021, -683.9959750337031, -776.4869422892696, -611.2292571485175, -616.76316791701, -923.4003012002925, -871.7526413853368, -840.2026916801607, -936.3707455133615, -663.2200970908967, -1226.797570888034, -718.2796093497702, -914.2861592312288, -655.065744427001, -1082.2097938096156, -927.692195471006, -621.6732421245882, -544.7591865826065, -646.8707180877126, -517.5628746402506, -487.8092022886465, -687.1596566903298, -643.4548666039393, -651.6337263764176, -592.7767168399545, -802.5153282624101, -1099.1762628277393, -445.1529978284388, -778.5653613859414, -610.1975378198206, -673.272634866685, -523.2399561542325, -566.206243214677, -531.0503328488047, -566.9073212997645, -850.6987402180574, -884.9572630410971, -694.6014679172719, -541.0020284251477, -465.3649278818729, -696.5453085385882, -414.31184606427246, -723.5138060119428, -615.7874241350772, -603.2933234420765, -739.4105484160322, -959.4067956660626, -587.3315243529139, -743.8885608210755, -699.8833499917077, -950.5467068459807, -413.51370488978205, -621.2053737222399, -724.7038425344531, -308.1558841359608, -717.7591497649998, -934.4577679772444, -923.8105750860786, -800.3754143231071, -557.1646893174938, -590.0560258003314, -415.4778116010488, -816.1223866499049, -761.675271187059, -754.7688459926044, -500.8624242522775, -602.6506671710208, -877.1573800286106, -964.03430997962, -758.1048815117643, -909.6811484896951, -1302.0509621184951, -672.4262470296612, -774.2150450003941, -707.2905721421914, -880.4044582012302, -510.23624097769374], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.338830396398542, "mean_inference_ms": 0.4081503291161281, "mean_action_processing_ms": 0.09652585007701665, "mean_env_wait_ms": 2.7055180092199382, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038444995880126953, "StateBufferConnector_ms": 0.0028426647186279297, "ViewRequirementAgentConnector_ms": 0.07053756713867188}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 303360, "num_agent_steps_trained": 303360, "num_env_steps_sampled": 303360, "num_env_steps_trained": 303360, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.77755645612149, "num_env_steps_trained_throughput_per_sec": 39.77755645612149, "timesteps_total": 303360, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 303360, "timers": {"training_iteration_time_ms": 2961.73, "sample_time_ms": 2957.672, "load_time_ms": 0.216, "load_throughput": 555536.954, "learn_time_ms": 2.992, "learn_throughput": 40102.342, "synch_weights_time_ms": 0.807}, "counters": {"num_env_steps_sampled": 303360, "num_env_steps_trained": 303360, "num_agent_steps_sampled": 303360, "num_agent_steps_trained": 303360}, "done": false, "episodes_total": 2528, "training_iteration": 633, "trial_id": "53665_00000", "date": "2023-07-26_03-55-23", "timestamp": 1690332923, "time_this_iter_s": 12.075026035308838, "time_total_s": 7660.928344488144, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2039.6028685569763, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 41.71111111111111, "ram_util_percent": 71.5611111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4691467285156, "policy_loss": -57344.63671875, "vf_loss": 1627029.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 694.0, "diff_num_grad_updates_vs_sampler_policy": 693.0}}, "num_env_steps_sampled": 303840, "num_env_steps_trained": 303840, "num_agent_steps_sampled": 303840, "num_agent_steps_trained": 303840}, "sampler_results": {"episode_reward_max": -308.1558841359608, "episode_reward_min": -1302.0509621184951, "episode_reward_mean": -732.9115043479662, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1153.319216414967, -906.6698809109502, -724.3444934773449, -639.2128771811185, -1068.6151542301675, -885.8256411502261, -974.4476874015886, -740.7426356422269, -701.5522770266058, -939.2311313049262, -582.0840716295429, -672.4441446329135, -640.3641846789762, -1223.3009114164038, -913.6345980516116, -545.4089247607222, -810.0440549897335, -663.930560828732, -559.3303000967367, -525.3723163635021, -683.9959750337031, -776.4869422892696, -611.2292571485175, -616.76316791701, -923.4003012002925, -871.7526413853368, -840.2026916801607, -936.3707455133615, -663.2200970908967, -1226.797570888034, -718.2796093497702, -914.2861592312288, -655.065744427001, -1082.2097938096156, -927.692195471006, -621.6732421245882, -544.7591865826065, -646.8707180877126, -517.5628746402506, -487.8092022886465, -687.1596566903298, -643.4548666039393, -651.6337263764176, -592.7767168399545, -802.5153282624101, -1099.1762628277393, -445.1529978284388, -778.5653613859414, -610.1975378198206, -673.272634866685, -523.2399561542325, -566.206243214677, -531.0503328488047, -566.9073212997645, -850.6987402180574, -884.9572630410971, -694.6014679172719, -541.0020284251477, -465.3649278818729, -696.5453085385882, -414.31184606427246, -723.5138060119428, -615.7874241350772, -603.2933234420765, -739.4105484160322, -959.4067956660626, -587.3315243529139, -743.8885608210755, -699.8833499917077, -950.5467068459807, -413.51370488978205, -621.2053737222399, -724.7038425344531, -308.1558841359608, -717.7591497649998, -934.4577679772444, -923.8105750860786, -800.3754143231071, -557.1646893174938, -590.0560258003314, -415.4778116010488, -816.1223866499049, -761.675271187059, -754.7688459926044, -500.8624242522775, -602.6506671710208, -877.1573800286106, -964.03430997962, -758.1048815117643, -909.6811484896951, -1302.0509621184951, -672.4262470296612, -774.2150450003941, -707.2905721421914, -880.4044582012302, -510.23624097769374, -756.7596885822063, -750.503674906108, -970.4569044562797, -536.9133438307292], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.338323338854835, "mean_inference_ms": 0.4081597316871687, "mean_action_processing_ms": 0.09653018694186663, "mean_env_wait_ms": 2.7053039769191662, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039010047912597656, "StateBufferConnector_ms": 0.0028786659240722656, "ViewRequirementAgentConnector_ms": 0.0716397762298584}}, "episode_reward_max": -308.1558841359608, "episode_reward_min": -1302.0509621184951, "episode_reward_mean": -732.9115043479662, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1153.319216414967, -906.6698809109502, -724.3444934773449, -639.2128771811185, -1068.6151542301675, -885.8256411502261, -974.4476874015886, -740.7426356422269, -701.5522770266058, -939.2311313049262, -582.0840716295429, -672.4441446329135, -640.3641846789762, -1223.3009114164038, -913.6345980516116, -545.4089247607222, -810.0440549897335, -663.930560828732, -559.3303000967367, -525.3723163635021, -683.9959750337031, -776.4869422892696, -611.2292571485175, -616.76316791701, -923.4003012002925, -871.7526413853368, -840.2026916801607, -936.3707455133615, -663.2200970908967, -1226.797570888034, -718.2796093497702, -914.2861592312288, -655.065744427001, -1082.2097938096156, -927.692195471006, -621.6732421245882, -544.7591865826065, -646.8707180877126, -517.5628746402506, -487.8092022886465, -687.1596566903298, -643.4548666039393, -651.6337263764176, -592.7767168399545, -802.5153282624101, -1099.1762628277393, -445.1529978284388, -778.5653613859414, -610.1975378198206, -673.272634866685, -523.2399561542325, -566.206243214677, -531.0503328488047, -566.9073212997645, -850.6987402180574, -884.9572630410971, -694.6014679172719, -541.0020284251477, -465.3649278818729, -696.5453085385882, -414.31184606427246, -723.5138060119428, -615.7874241350772, -603.2933234420765, -739.4105484160322, -959.4067956660626, -587.3315243529139, -743.8885608210755, -699.8833499917077, -950.5467068459807, -413.51370488978205, -621.2053737222399, -724.7038425344531, -308.1558841359608, -717.7591497649998, -934.4577679772444, -923.8105750860786, -800.3754143231071, -557.1646893174938, -590.0560258003314, -415.4778116010488, -816.1223866499049, -761.675271187059, -754.7688459926044, -500.8624242522775, -602.6506671710208, -877.1573800286106, -964.03430997962, -758.1048815117643, -909.6811484896951, -1302.0509621184951, -672.4262470296612, -774.2150450003941, -707.2905721421914, -880.4044582012302, -510.23624097769374, -756.7596885822063, -750.503674906108, -970.4569044562797, -536.9133438307292], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.338323338854835, "mean_inference_ms": 0.4081597316871687, "mean_action_processing_ms": 0.09653018694186663, "mean_env_wait_ms": 2.7053039769191662, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039010047912597656, "StateBufferConnector_ms": 0.0028786659240722656, "ViewRequirementAgentConnector_ms": 0.0716397762298584}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 303840, "num_agent_steps_trained": 303840, "num_env_steps_sampled": 303840, "num_env_steps_trained": 303840, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.459397301941316, "num_env_steps_trained_throughput_per_sec": 39.459397301941316, "timesteps_total": 303840, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 303840, "timers": {"training_iteration_time_ms": 3009.876, "sample_time_ms": 3005.801, "load_time_ms": 0.22, "load_throughput": 545659.67, "learn_time_ms": 3.011, "learn_throughput": 39855.287, "synch_weights_time_ms": 0.801}, "counters": {"num_env_steps_sampled": 303840, "num_env_steps_trained": 303840, "num_agent_steps_sampled": 303840, "num_agent_steps_trained": 303840}, "done": false, "episodes_total": 2532, "training_iteration": 634, "trial_id": "53665_00000", "date": "2023-07-26_03-55-35", "timestamp": 1690332935, "time_this_iter_s": 12.167208909988403, "time_total_s": 7673.095553398132, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2051.7700774669647, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 45.911764705882355, "ram_util_percent": 71.82941176470588}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4962158203125, "policy_loss": -138095.890625, "vf_loss": 8081125.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 698.0, "diff_num_grad_updates_vs_sampler_policy": 697.0}}, "num_env_steps_sampled": 304320, "num_env_steps_trained": 304320, "num_agent_steps_sampled": 304320, "num_agent_steps_trained": 304320}, "sampler_results": {"episode_reward_max": -308.1558841359608, "episode_reward_min": -1302.0509621184951, "episode_reward_mean": -735.6982277748511, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1068.6151542301675, -885.8256411502261, -974.4476874015886, -740.7426356422269, -701.5522770266058, -939.2311313049262, -582.0840716295429, -672.4441446329135, -640.3641846789762, -1223.3009114164038, -913.6345980516116, -545.4089247607222, -810.0440549897335, -663.930560828732, -559.3303000967367, -525.3723163635021, -683.9959750337031, -776.4869422892696, -611.2292571485175, -616.76316791701, -923.4003012002925, -871.7526413853368, -840.2026916801607, -936.3707455133615, -663.2200970908967, -1226.797570888034, -718.2796093497702, -914.2861592312288, -655.065744427001, -1082.2097938096156, -927.692195471006, -621.6732421245882, -544.7591865826065, -646.8707180877126, -517.5628746402506, -487.8092022886465, -687.1596566903298, -643.4548666039393, -651.6337263764176, -592.7767168399545, -802.5153282624101, -1099.1762628277393, -445.1529978284388, -778.5653613859414, -610.1975378198206, -673.272634866685, -523.2399561542325, -566.206243214677, -531.0503328488047, -566.9073212997645, -850.6987402180574, -884.9572630410971, -694.6014679172719, -541.0020284251477, -465.3649278818729, -696.5453085385882, -414.31184606427246, -723.5138060119428, -615.7874241350772, -603.2933234420765, -739.4105484160322, -959.4067956660626, -587.3315243529139, -743.8885608210755, -699.8833499917077, -950.5467068459807, -413.51370488978205, -621.2053737222399, -724.7038425344531, -308.1558841359608, -717.7591497649998, -934.4577679772444, -923.8105750860786, -800.3754143231071, -557.1646893174938, -590.0560258003314, -415.4778116010488, -816.1223866499049, -761.675271187059, -754.7688459926044, -500.8624242522775, -602.6506671710208, -877.1573800286106, -964.03430997962, -758.1048815117643, -909.6811484896951, -1302.0509621184951, -672.4262470296612, -774.2150450003941, -707.2905721421914, -880.4044582012302, -510.23624097769374, -756.7596885822063, -750.503674906108, -970.4569044562797, -536.9133438307292, -969.1189538969094, -828.6557497044836, -921.1167522249553, -983.3273548465268], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.337883338313283, "mean_inference_ms": 0.40816932180195464, "mean_action_processing_ms": 0.09653449643556251, "mean_env_wait_ms": 2.705101756979827, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038983821868896484, "StateBufferConnector_ms": 0.0028684139251708984, "ViewRequirementAgentConnector_ms": 0.07163453102111816}}, "episode_reward_max": -308.1558841359608, "episode_reward_min": -1302.0509621184951, "episode_reward_mean": -735.6982277748511, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1068.6151542301675, -885.8256411502261, -974.4476874015886, -740.7426356422269, -701.5522770266058, -939.2311313049262, -582.0840716295429, -672.4441446329135, -640.3641846789762, -1223.3009114164038, -913.6345980516116, -545.4089247607222, -810.0440549897335, -663.930560828732, -559.3303000967367, -525.3723163635021, -683.9959750337031, -776.4869422892696, -611.2292571485175, -616.76316791701, -923.4003012002925, -871.7526413853368, -840.2026916801607, -936.3707455133615, -663.2200970908967, -1226.797570888034, -718.2796093497702, -914.2861592312288, -655.065744427001, -1082.2097938096156, -927.692195471006, -621.6732421245882, -544.7591865826065, -646.8707180877126, -517.5628746402506, -487.8092022886465, -687.1596566903298, -643.4548666039393, -651.6337263764176, -592.7767168399545, -802.5153282624101, -1099.1762628277393, -445.1529978284388, -778.5653613859414, -610.1975378198206, -673.272634866685, -523.2399561542325, -566.206243214677, -531.0503328488047, -566.9073212997645, -850.6987402180574, -884.9572630410971, -694.6014679172719, -541.0020284251477, -465.3649278818729, -696.5453085385882, -414.31184606427246, -723.5138060119428, -615.7874241350772, -603.2933234420765, -739.4105484160322, -959.4067956660626, -587.3315243529139, -743.8885608210755, -699.8833499917077, -950.5467068459807, -413.51370488978205, -621.2053737222399, -724.7038425344531, -308.1558841359608, -717.7591497649998, -934.4577679772444, -923.8105750860786, -800.3754143231071, -557.1646893174938, -590.0560258003314, -415.4778116010488, -816.1223866499049, -761.675271187059, -754.7688459926044, -500.8624242522775, -602.6506671710208, -877.1573800286106, -964.03430997962, -758.1048815117643, -909.6811484896951, -1302.0509621184951, -672.4262470296612, -774.2150450003941, -707.2905721421914, -880.4044582012302, -510.23624097769374, -756.7596885822063, -750.503674906108, -970.4569044562797, -536.9133438307292, -969.1189538969094, -828.6557497044836, -921.1167522249553, -983.3273548465268], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.337883338313283, "mean_inference_ms": 0.40816932180195464, "mean_action_processing_ms": 0.09653449643556251, "mean_env_wait_ms": 2.705101756979827, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038983821868896484, "StateBufferConnector_ms": 0.0028684139251708984, "ViewRequirementAgentConnector_ms": 0.07163453102111816}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304320, "num_agent_steps_trained": 304320, "num_env_steps_sampled": 304320, "num_env_steps_trained": 304320, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.097498356419266, "num_env_steps_trained_throughput_per_sec": 41.097498356419266, "timesteps_total": 304320, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 304320, "timers": {"training_iteration_time_ms": 3013.881, "sample_time_ms": 3009.844, "load_time_ms": 0.221, "load_throughput": 542308.458, "learn_time_ms": 2.985, "learn_throughput": 40199.07, "synch_weights_time_ms": 0.788}, "counters": {"num_env_steps_sampled": 304320, "num_env_steps_trained": 304320, "num_agent_steps_sampled": 304320, "num_agent_steps_trained": 304320}, "done": false, "episodes_total": 2536, "training_iteration": 635, "trial_id": "53665_00000", "date": "2023-07-26_03-55-47", "timestamp": 1690332947, "time_this_iter_s": 11.682235717773438, "time_total_s": 7684.777789115906, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2063.452313184738, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 35.61176470588236, "ram_util_percent": 71.93529411764706}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4569396972656, "policy_loss": -54212.76171875, "vf_loss": 1494837.125}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 702.0, "diff_num_grad_updates_vs_sampler_policy": 701.0}}, "num_env_steps_sampled": 304800, "num_env_steps_trained": 304800, "num_agent_steps_sampled": 304800, "num_agent_steps_trained": 304800}, "sampler_results": {"episode_reward_max": -308.1558841359608, "episode_reward_min": -1302.0509621184951, "episode_reward_mean": -730.3534670704075, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-701.5522770266058, -939.2311313049262, -582.0840716295429, -672.4441446329135, -640.3641846789762, -1223.3009114164038, -913.6345980516116, -545.4089247607222, -810.0440549897335, -663.930560828732, -559.3303000967367, -525.3723163635021, -683.9959750337031, -776.4869422892696, -611.2292571485175, -616.76316791701, -923.4003012002925, -871.7526413853368, -840.2026916801607, -936.3707455133615, -663.2200970908967, -1226.797570888034, -718.2796093497702, -914.2861592312288, -655.065744427001, -1082.2097938096156, -927.692195471006, -621.6732421245882, -544.7591865826065, -646.8707180877126, -517.5628746402506, -487.8092022886465, -687.1596566903298, -643.4548666039393, -651.6337263764176, -592.7767168399545, -802.5153282624101, -1099.1762628277393, -445.1529978284388, -778.5653613859414, -610.1975378198206, -673.272634866685, -523.2399561542325, -566.206243214677, -531.0503328488047, -566.9073212997645, -850.6987402180574, -884.9572630410971, -694.6014679172719, -541.0020284251477, -465.3649278818729, -696.5453085385882, -414.31184606427246, -723.5138060119428, -615.7874241350772, -603.2933234420765, -739.4105484160322, -959.4067956660626, -587.3315243529139, -743.8885608210755, -699.8833499917077, -950.5467068459807, -413.51370488978205, -621.2053737222399, -724.7038425344531, -308.1558841359608, -717.7591497649998, -934.4577679772444, -923.8105750860786, -800.3754143231071, -557.1646893174938, -590.0560258003314, -415.4778116010488, -816.1223866499049, -761.675271187059, -754.7688459926044, -500.8624242522775, -602.6506671710208, -877.1573800286106, -964.03430997962, -758.1048815117643, -909.6811484896951, -1302.0509621184951, -672.4262470296612, -774.2150450003941, -707.2905721421914, -880.4044582012302, -510.23624097769374, -756.7596885822063, -750.503674906108, -970.4569044562797, -536.9133438307292, -969.1189538969094, -828.6557497044836, -921.1167522249553, -983.3273548465268, -786.8166913876576, -971.8472588541715, -839.0337560248918, -537.4573417131165], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.33735376119617, "mean_inference_ms": 0.4081786069085237, "mean_action_processing_ms": 0.09653866663326563, "mean_env_wait_ms": 2.7048793056045715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039017200469970703, "StateBufferConnector_ms": 0.0028693675994873047, "ViewRequirementAgentConnector_ms": 0.07164907455444336}}, "episode_reward_max": -308.1558841359608, "episode_reward_min": -1302.0509621184951, "episode_reward_mean": -730.3534670704075, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-701.5522770266058, -939.2311313049262, -582.0840716295429, -672.4441446329135, -640.3641846789762, -1223.3009114164038, -913.6345980516116, -545.4089247607222, -810.0440549897335, -663.930560828732, -559.3303000967367, -525.3723163635021, -683.9959750337031, -776.4869422892696, -611.2292571485175, -616.76316791701, -923.4003012002925, -871.7526413853368, -840.2026916801607, -936.3707455133615, -663.2200970908967, -1226.797570888034, -718.2796093497702, -914.2861592312288, -655.065744427001, -1082.2097938096156, -927.692195471006, -621.6732421245882, -544.7591865826065, -646.8707180877126, -517.5628746402506, -487.8092022886465, -687.1596566903298, -643.4548666039393, -651.6337263764176, -592.7767168399545, -802.5153282624101, -1099.1762628277393, -445.1529978284388, -778.5653613859414, -610.1975378198206, -673.272634866685, -523.2399561542325, -566.206243214677, -531.0503328488047, -566.9073212997645, -850.6987402180574, -884.9572630410971, -694.6014679172719, -541.0020284251477, -465.3649278818729, -696.5453085385882, -414.31184606427246, -723.5138060119428, -615.7874241350772, -603.2933234420765, -739.4105484160322, -959.4067956660626, -587.3315243529139, -743.8885608210755, -699.8833499917077, -950.5467068459807, -413.51370488978205, -621.2053737222399, -724.7038425344531, -308.1558841359608, -717.7591497649998, -934.4577679772444, -923.8105750860786, -800.3754143231071, -557.1646893174938, -590.0560258003314, -415.4778116010488, -816.1223866499049, -761.675271187059, -754.7688459926044, -500.8624242522775, -602.6506671710208, -877.1573800286106, -964.03430997962, -758.1048815117643, -909.6811484896951, -1302.0509621184951, -672.4262470296612, -774.2150450003941, -707.2905721421914, -880.4044582012302, -510.23624097769374, -756.7596885822063, -750.503674906108, -970.4569044562797, -536.9133438307292, -969.1189538969094, -828.6557497044836, -921.1167522249553, -983.3273548465268, -786.8166913876576, -971.8472588541715, -839.0337560248918, -537.4573417131165], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.33735376119617, "mean_inference_ms": 0.4081786069085237, "mean_action_processing_ms": 0.09653866663326563, "mean_env_wait_ms": 2.7048793056045715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039017200469970703, "StateBufferConnector_ms": 0.0028693675994873047, "ViewRequirementAgentConnector_ms": 0.07164907455444336}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304800, "num_agent_steps_trained": 304800, "num_env_steps_sampled": 304800, "num_env_steps_trained": 304800, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 42.084007396776734, "num_env_steps_trained_throughput_per_sec": 42.084007396776734, "timesteps_total": 304800, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 304800, "timers": {"training_iteration_time_ms": 2916.079, "sample_time_ms": 2912.277, "load_time_ms": 0.22, "load_throughput": 546311.169, "learn_time_ms": 2.824, "learn_throughput": 42492.611, "synch_weights_time_ms": 0.718}, "counters": {"num_env_steps_sampled": 304800, "num_env_steps_trained": 304800, "num_agent_steps_sampled": 304800, "num_agent_steps_trained": 304800}, "done": false, "episodes_total": 2540, "training_iteration": 636, "trial_id": "53665_00000", "date": "2023-07-26_03-55-58", "timestamp": 1690332958, "time_this_iter_s": 11.408530235290527, "time_total_s": 7696.186319351196, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2074.8608434200287, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 35.6875, "ram_util_percent": 71.63125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.5081481933594, "policy_loss": -90300.109375, "vf_loss": 3947087.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 706.0, "diff_num_grad_updates_vs_sampler_policy": 705.0}}, "num_env_steps_sampled": 305280, "num_env_steps_trained": 305280, "num_agent_steps_sampled": 305280, "num_agent_steps_trained": 305280}, "sampler_results": {"episode_reward_max": -308.1558841359608, "episode_reward_min": -1302.0509621184951, "episode_reward_mean": -729.9379268593724, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-640.3641846789762, -1223.3009114164038, -913.6345980516116, -545.4089247607222, -810.0440549897335, -663.930560828732, -559.3303000967367, -525.3723163635021, -683.9959750337031, -776.4869422892696, -611.2292571485175, -616.76316791701, -923.4003012002925, -871.7526413853368, -840.2026916801607, -936.3707455133615, -663.2200970908967, -1226.797570888034, -718.2796093497702, -914.2861592312288, -655.065744427001, -1082.2097938096156, -927.692195471006, -621.6732421245882, -544.7591865826065, -646.8707180877126, -517.5628746402506, -487.8092022886465, -687.1596566903298, -643.4548666039393, -651.6337263764176, -592.7767168399545, -802.5153282624101, -1099.1762628277393, -445.1529978284388, -778.5653613859414, -610.1975378198206, -673.272634866685, -523.2399561542325, -566.206243214677, -531.0503328488047, -566.9073212997645, -850.6987402180574, -884.9572630410971, -694.6014679172719, -541.0020284251477, -465.3649278818729, -696.5453085385882, -414.31184606427246, -723.5138060119428, -615.7874241350772, -603.2933234420765, -739.4105484160322, -959.4067956660626, -587.3315243529139, -743.8885608210755, -699.8833499917077, -950.5467068459807, -413.51370488978205, -621.2053737222399, -724.7038425344531, -308.1558841359608, -717.7591497649998, -934.4577679772444, -923.8105750860786, -800.3754143231071, -557.1646893174938, -590.0560258003314, -415.4778116010488, -816.1223866499049, -761.675271187059, -754.7688459926044, -500.8624242522775, -602.6506671710208, -877.1573800286106, -964.03430997962, -758.1048815117643, -909.6811484896951, -1302.0509621184951, -672.4262470296612, -774.2150450003941, -707.2905721421914, -880.4044582012302, -510.23624097769374, -756.7596885822063, -750.503674906108, -970.4569044562797, -536.9133438307292, -969.1189538969094, -828.6557497044836, -921.1167522249553, -983.3273548465268, -786.8166913876576, -971.8472588541715, -839.0337560248918, -537.4573417131165, -736.6672726824571, -726.1648467480247, -703.5500142618337, -687.3754697981695], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.33659119743883, "mean_inference_ms": 0.40818843551497475, "mean_action_processing_ms": 0.09654292014876541, "mean_env_wait_ms": 2.704633086425214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003903627395629883, "StateBufferConnector_ms": 0.0028672218322753906, "ViewRequirementAgentConnector_ms": 0.07170438766479492}}, "episode_reward_max": -308.1558841359608, "episode_reward_min": -1302.0509621184951, "episode_reward_mean": -729.9379268593724, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-640.3641846789762, -1223.3009114164038, -913.6345980516116, -545.4089247607222, -810.0440549897335, -663.930560828732, -559.3303000967367, -525.3723163635021, -683.9959750337031, -776.4869422892696, -611.2292571485175, -616.76316791701, -923.4003012002925, -871.7526413853368, -840.2026916801607, -936.3707455133615, -663.2200970908967, -1226.797570888034, -718.2796093497702, -914.2861592312288, -655.065744427001, -1082.2097938096156, -927.692195471006, -621.6732421245882, -544.7591865826065, -646.8707180877126, -517.5628746402506, -487.8092022886465, -687.1596566903298, -643.4548666039393, -651.6337263764176, -592.7767168399545, -802.5153282624101, -1099.1762628277393, -445.1529978284388, -778.5653613859414, -610.1975378198206, -673.272634866685, -523.2399561542325, -566.206243214677, -531.0503328488047, -566.9073212997645, -850.6987402180574, -884.9572630410971, -694.6014679172719, -541.0020284251477, -465.3649278818729, -696.5453085385882, -414.31184606427246, -723.5138060119428, -615.7874241350772, -603.2933234420765, -739.4105484160322, -959.4067956660626, -587.3315243529139, -743.8885608210755, -699.8833499917077, -950.5467068459807, -413.51370488978205, -621.2053737222399, -724.7038425344531, -308.1558841359608, -717.7591497649998, -934.4577679772444, -923.8105750860786, -800.3754143231071, -557.1646893174938, -590.0560258003314, -415.4778116010488, -816.1223866499049, -761.675271187059, -754.7688459926044, -500.8624242522775, -602.6506671710208, -877.1573800286106, -964.03430997962, -758.1048815117643, -909.6811484896951, -1302.0509621184951, -672.4262470296612, -774.2150450003941, -707.2905721421914, -880.4044582012302, -510.23624097769374, -756.7596885822063, -750.503674906108, -970.4569044562797, -536.9133438307292, -969.1189538969094, -828.6557497044836, -921.1167522249553, -983.3273548465268, -786.8166913876576, -971.8472588541715, -839.0337560248918, -537.4573417131165, -736.6672726824571, -726.1648467480247, -703.5500142618337, -687.3754697981695], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.33659119743883, "mean_inference_ms": 0.40818843551497475, "mean_action_processing_ms": 0.09654292014876541, "mean_env_wait_ms": 2.704633086425214, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003903627395629883, "StateBufferConnector_ms": 0.0028672218322753906, "ViewRequirementAgentConnector_ms": 0.07170438766479492}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 305280, "num_agent_steps_trained": 305280, "num_env_steps_sampled": 305280, "num_env_steps_trained": 305280, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.42905645285505, "num_env_steps_trained_throughput_per_sec": 41.42905645285505, "timesteps_total": 305280, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 305280, "timers": {"training_iteration_time_ms": 2881.795, "sample_time_ms": 2878.01, "load_time_ms": 0.217, "load_throughput": 553581.698, "learn_time_ms": 2.82, "learn_throughput": 42548.649, "synch_weights_time_ms": 0.708}, "counters": {"num_env_steps_sampled": 305280, "num_env_steps_trained": 305280, "num_agent_steps_sampled": 305280, "num_agent_steps_trained": 305280}, "done": false, "episodes_total": 2544, "training_iteration": 637, "trial_id": "53665_00000", "date": "2023-07-26_03-56-10", "timestamp": 1690332970, "time_this_iter_s": 11.58887791633606, "time_total_s": 7707.775197267532, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2086.4497213363647, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 39.6375, "ram_util_percent": 72.73125000000002}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4729919433594, "policy_loss": -99127.421875, "vf_loss": 4708785.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 710.0, "diff_num_grad_updates_vs_sampler_policy": 709.0}}, "num_env_steps_sampled": 305760, "num_env_steps_trained": 305760, "num_agent_steps_sampled": 305760, "num_agent_steps_trained": 305760}, "sampler_results": {"episode_reward_max": -308.1558841359608, "episode_reward_min": -1302.0509621184951, "episode_reward_mean": -730.8966153409399, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-810.0440549897335, -663.930560828732, -559.3303000967367, -525.3723163635021, -683.9959750337031, -776.4869422892696, -611.2292571485175, -616.76316791701, -923.4003012002925, -871.7526413853368, -840.2026916801607, -936.3707455133615, -663.2200970908967, -1226.797570888034, -718.2796093497702, -914.2861592312288, -655.065744427001, -1082.2097938096156, -927.692195471006, -621.6732421245882, -544.7591865826065, -646.8707180877126, -517.5628746402506, -487.8092022886465, -687.1596566903298, -643.4548666039393, -651.6337263764176, -592.7767168399545, -802.5153282624101, -1099.1762628277393, -445.1529978284388, -778.5653613859414, -610.1975378198206, -673.272634866685, -523.2399561542325, -566.206243214677, -531.0503328488047, -566.9073212997645, -850.6987402180574, -884.9572630410971, -694.6014679172719, -541.0020284251477, -465.3649278818729, -696.5453085385882, -414.31184606427246, -723.5138060119428, -615.7874241350772, -603.2933234420765, -739.4105484160322, -959.4067956660626, -587.3315243529139, -743.8885608210755, -699.8833499917077, -950.5467068459807, -413.51370488978205, -621.2053737222399, -724.7038425344531, -308.1558841359608, -717.7591497649998, -934.4577679772444, -923.8105750860786, -800.3754143231071, -557.1646893174938, -590.0560258003314, -415.4778116010488, -816.1223866499049, -761.675271187059, -754.7688459926044, -500.8624242522775, -602.6506671710208, -877.1573800286106, -964.03430997962, -758.1048815117643, -909.6811484896951, -1302.0509621184951, -672.4262470296612, -774.2150450003941, -707.2905721421914, -880.4044582012302, -510.23624097769374, -756.7596885822063, -750.503674906108, -970.4569044562797, -536.9133438307292, -969.1189538969094, -828.6557497044836, -921.1167522249553, -983.3273548465268, -786.8166913876576, -971.8472588541715, -839.0337560248918, -537.4573417131165, -736.6672726824571, -726.1648467480247, -703.5500142618337, -687.3754697981695, -1028.8533235816103, -1016.9399185373081, -547.7700884733886, -825.0141364721521], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.335884906918828, "mean_inference_ms": 0.40819897550621803, "mean_action_processing_ms": 0.09654716744838371, "mean_env_wait_ms": 2.70438922523093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038983821868896484, "StateBufferConnector_ms": 0.002870798110961914, "ViewRequirementAgentConnector_ms": 0.07178831100463867}}, "episode_reward_max": -308.1558841359608, "episode_reward_min": -1302.0509621184951, "episode_reward_mean": -730.8966153409399, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-810.0440549897335, -663.930560828732, -559.3303000967367, -525.3723163635021, -683.9959750337031, -776.4869422892696, -611.2292571485175, -616.76316791701, -923.4003012002925, -871.7526413853368, -840.2026916801607, -936.3707455133615, -663.2200970908967, -1226.797570888034, -718.2796093497702, -914.2861592312288, -655.065744427001, -1082.2097938096156, -927.692195471006, -621.6732421245882, -544.7591865826065, -646.8707180877126, -517.5628746402506, -487.8092022886465, -687.1596566903298, -643.4548666039393, -651.6337263764176, -592.7767168399545, -802.5153282624101, -1099.1762628277393, -445.1529978284388, -778.5653613859414, -610.1975378198206, -673.272634866685, -523.2399561542325, -566.206243214677, -531.0503328488047, -566.9073212997645, -850.6987402180574, -884.9572630410971, -694.6014679172719, -541.0020284251477, -465.3649278818729, -696.5453085385882, -414.31184606427246, -723.5138060119428, -615.7874241350772, -603.2933234420765, -739.4105484160322, -959.4067956660626, -587.3315243529139, -743.8885608210755, -699.8833499917077, -950.5467068459807, -413.51370488978205, -621.2053737222399, -724.7038425344531, -308.1558841359608, -717.7591497649998, -934.4577679772444, -923.8105750860786, -800.3754143231071, -557.1646893174938, -590.0560258003314, -415.4778116010488, -816.1223866499049, -761.675271187059, -754.7688459926044, -500.8624242522775, -602.6506671710208, -877.1573800286106, -964.03430997962, -758.1048815117643, -909.6811484896951, -1302.0509621184951, -672.4262470296612, -774.2150450003941, -707.2905721421914, -880.4044582012302, -510.23624097769374, -756.7596885822063, -750.503674906108, -970.4569044562797, -536.9133438307292, -969.1189538969094, -828.6557497044836, -921.1167522249553, -983.3273548465268, -786.8166913876576, -971.8472588541715, -839.0337560248918, -537.4573417131165, -736.6672726824571, -726.1648467480247, -703.5500142618337, -687.3754697981695, -1028.8533235816103, -1016.9399185373081, -547.7700884733886, -825.0141364721521], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.335884906918828, "mean_inference_ms": 0.40819897550621803, "mean_action_processing_ms": 0.09654716744838371, "mean_env_wait_ms": 2.70438922523093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038983821868896484, "StateBufferConnector_ms": 0.002870798110961914, "ViewRequirementAgentConnector_ms": 0.07178831100463867}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 305760, "num_agent_steps_trained": 305760, "num_env_steps_sampled": 305760, "num_env_steps_trained": 305760, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.38510870945398, "num_env_steps_trained_throughput_per_sec": 40.38510870945398, "timesteps_total": 305760, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 305760, "timers": {"training_iteration_time_ms": 2921.285, "sample_time_ms": 2917.544, "load_time_ms": 0.215, "load_throughput": 557691.391, "learn_time_ms": 2.791, "learn_throughput": 42994.617, "synch_weights_time_ms": 0.694}, "counters": {"num_env_steps_sampled": 305760, "num_env_steps_trained": 305760, "num_agent_steps_sampled": 305760, "num_agent_steps_trained": 305760}, "done": false, "episodes_total": 2548, "training_iteration": 638, "trial_id": "53665_00000", "date": "2023-07-26_03-56-22", "timestamp": 1690332982, "time_this_iter_s": 11.888195037841797, "time_total_s": 7719.663392305374, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2098.3379163742065, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 38.50588235294118, "ram_util_percent": 73.52352941176471}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4873046875, "policy_loss": -153316.734375, "vf_loss": 10671688.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 714.0, "diff_num_grad_updates_vs_sampler_policy": 713.0}}, "num_env_steps_sampled": 306240, "num_env_steps_trained": 306240, "num_agent_steps_sampled": 306240, "num_agent_steps_trained": 306240}, "sampler_results": {"episode_reward_max": -308.1558841359608, "episode_reward_min": -1302.0509621184951, "episode_reward_mean": -739.247717139998, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-683.9959750337031, -776.4869422892696, -611.2292571485175, -616.76316791701, -923.4003012002925, -871.7526413853368, -840.2026916801607, -936.3707455133615, -663.2200970908967, -1226.797570888034, -718.2796093497702, -914.2861592312288, -655.065744427001, -1082.2097938096156, -927.692195471006, -621.6732421245882, -544.7591865826065, -646.8707180877126, -517.5628746402506, -487.8092022886465, -687.1596566903298, -643.4548666039393, -651.6337263764176, -592.7767168399545, -802.5153282624101, -1099.1762628277393, -445.1529978284388, -778.5653613859414, -610.1975378198206, -673.272634866685, -523.2399561542325, -566.206243214677, -531.0503328488047, -566.9073212997645, -850.6987402180574, -884.9572630410971, -694.6014679172719, -541.0020284251477, -465.3649278818729, -696.5453085385882, -414.31184606427246, -723.5138060119428, -615.7874241350772, -603.2933234420765, -739.4105484160322, -959.4067956660626, -587.3315243529139, -743.8885608210755, -699.8833499917077, -950.5467068459807, -413.51370488978205, -621.2053737222399, -724.7038425344531, -308.1558841359608, -717.7591497649998, -934.4577679772444, -923.8105750860786, -800.3754143231071, -557.1646893174938, -590.0560258003314, -415.4778116010488, -816.1223866499049, -761.675271187059, -754.7688459926044, -500.8624242522775, -602.6506671710208, -877.1573800286106, -964.03430997962, -758.1048815117643, -909.6811484896951, -1302.0509621184951, -672.4262470296612, -774.2150450003941, -707.2905721421914, -880.4044582012302, -510.23624097769374, -756.7596885822063, -750.503674906108, -970.4569044562797, -536.9133438307292, -969.1189538969094, -828.6557497044836, -921.1167522249553, -983.3273548465268, -786.8166913876576, -971.8472588541715, -839.0337560248918, -537.4573417131165, -736.6672726824571, -726.1648467480247, -703.5500142618337, -687.3754697981695, -1028.8533235816103, -1016.9399185373081, -547.7700884733886, -825.0141364721521, -854.5119491982765, -761.8485401322998, -645.2999114695314, -1132.127011384424], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.33544801252394, "mean_inference_ms": 0.4082096772193475, "mean_action_processing_ms": 0.0965513170680562, "mean_env_wait_ms": 2.7041490283699154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038971900939941406, "StateBufferConnector_ms": 0.002875089645385742, "ViewRequirementAgentConnector_ms": 0.07177329063415527}}, "episode_reward_max": -308.1558841359608, "episode_reward_min": -1302.0509621184951, "episode_reward_mean": -739.247717139998, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-683.9959750337031, -776.4869422892696, -611.2292571485175, -616.76316791701, -923.4003012002925, -871.7526413853368, -840.2026916801607, -936.3707455133615, -663.2200970908967, -1226.797570888034, -718.2796093497702, -914.2861592312288, -655.065744427001, -1082.2097938096156, -927.692195471006, -621.6732421245882, -544.7591865826065, -646.8707180877126, -517.5628746402506, -487.8092022886465, -687.1596566903298, -643.4548666039393, -651.6337263764176, -592.7767168399545, -802.5153282624101, -1099.1762628277393, -445.1529978284388, -778.5653613859414, -610.1975378198206, -673.272634866685, -523.2399561542325, -566.206243214677, -531.0503328488047, -566.9073212997645, -850.6987402180574, -884.9572630410971, -694.6014679172719, -541.0020284251477, -465.3649278818729, -696.5453085385882, -414.31184606427246, -723.5138060119428, -615.7874241350772, -603.2933234420765, -739.4105484160322, -959.4067956660626, -587.3315243529139, -743.8885608210755, -699.8833499917077, -950.5467068459807, -413.51370488978205, -621.2053737222399, -724.7038425344531, -308.1558841359608, -717.7591497649998, -934.4577679772444, -923.8105750860786, -800.3754143231071, -557.1646893174938, -590.0560258003314, -415.4778116010488, -816.1223866499049, -761.675271187059, -754.7688459926044, -500.8624242522775, -602.6506671710208, -877.1573800286106, -964.03430997962, -758.1048815117643, -909.6811484896951, -1302.0509621184951, -672.4262470296612, -774.2150450003941, -707.2905721421914, -880.4044582012302, -510.23624097769374, -756.7596885822063, -750.503674906108, -970.4569044562797, -536.9133438307292, -969.1189538969094, -828.6557497044836, -921.1167522249553, -983.3273548465268, -786.8166913876576, -971.8472588541715, -839.0337560248918, -537.4573417131165, -736.6672726824571, -726.1648467480247, -703.5500142618337, -687.3754697981695, -1028.8533235816103, -1016.9399185373081, -547.7700884733886, -825.0141364721521, -854.5119491982765, -761.8485401322998, -645.2999114695314, -1132.127011384424], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.33544801252394, "mean_inference_ms": 0.4082096772193475, "mean_action_processing_ms": 0.0965513170680562, "mean_env_wait_ms": 2.7041490283699154, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038971900939941406, "StateBufferConnector_ms": 0.002875089645385742, "ViewRequirementAgentConnector_ms": 0.07177329063415527}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 306240, "num_agent_steps_trained": 306240, "num_env_steps_sampled": 306240, "num_env_steps_trained": 306240, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.36203390564471, "num_env_steps_trained_throughput_per_sec": 40.36203390564471, "timesteps_total": 306240, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 306240, "timers": {"training_iteration_time_ms": 2961.622, "sample_time_ms": 2957.895, "load_time_ms": 0.214, "load_throughput": 561988.03, "learn_time_ms": 2.779, "learn_throughput": 43180.522, "synch_weights_time_ms": 0.694}, "counters": {"num_env_steps_sampled": 306240, "num_env_steps_trained": 306240, "num_agent_steps_sampled": 306240, "num_agent_steps_trained": 306240}, "done": false, "episodes_total": 2552, "training_iteration": 639, "trial_id": "53665_00000", "date": "2023-07-26_03-56-33", "timestamp": 1690332993, "time_this_iter_s": 11.895246982574463, "time_total_s": 7731.558639287949, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2110.233163356781, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 36.24705882352941, "ram_util_percent": 73.18235294117648}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4409484863281, "policy_loss": -80992.125, "vf_loss": 2917997.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 718.0, "diff_num_grad_updates_vs_sampler_policy": 717.0}}, "num_env_steps_sampled": 306720, "num_env_steps_trained": 306720, "num_agent_steps_sampled": 306720, "num_agent_steps_trained": 306720}, "sampler_results": {"episode_reward_max": -308.1558841359608, "episode_reward_min": -1302.0509621184951, "episode_reward_mean": -747.25983758835, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-923.4003012002925, -871.7526413853368, -840.2026916801607, -936.3707455133615, -663.2200970908967, -1226.797570888034, -718.2796093497702, -914.2861592312288, -655.065744427001, -1082.2097938096156, -927.692195471006, -621.6732421245882, -544.7591865826065, -646.8707180877126, -517.5628746402506, -487.8092022886465, -687.1596566903298, -643.4548666039393, -651.6337263764176, -592.7767168399545, -802.5153282624101, -1099.1762628277393, -445.1529978284388, -778.5653613859414, -610.1975378198206, -673.272634866685, -523.2399561542325, -566.206243214677, -531.0503328488047, -566.9073212997645, -850.6987402180574, -884.9572630410971, -694.6014679172719, -541.0020284251477, -465.3649278818729, -696.5453085385882, -414.31184606427246, -723.5138060119428, -615.7874241350772, -603.2933234420765, -739.4105484160322, -959.4067956660626, -587.3315243529139, -743.8885608210755, -699.8833499917077, -950.5467068459807, -413.51370488978205, -621.2053737222399, -724.7038425344531, -308.1558841359608, -717.7591497649998, -934.4577679772444, -923.8105750860786, -800.3754143231071, -557.1646893174938, -590.0560258003314, -415.4778116010488, -816.1223866499049, -761.675271187059, -754.7688459926044, -500.8624242522775, -602.6506671710208, -877.1573800286106, -964.03430997962, -758.1048815117643, -909.6811484896951, -1302.0509621184951, -672.4262470296612, -774.2150450003941, -707.2905721421914, -880.4044582012302, -510.23624097769374, -756.7596885822063, -750.503674906108, -970.4569044562797, -536.9133438307292, -969.1189538969094, -828.6557497044836, -921.1167522249553, -983.3273548465268, -786.8166913876576, -971.8472588541715, -839.0337560248918, -537.4573417131165, -736.6672726824571, -726.1648467480247, -703.5500142618337, -687.3754697981695, -1028.8533235816103, -1016.9399185373081, -547.7700884733886, -825.0141364721521, -854.5119491982765, -761.8485401322998, -645.2999114695314, -1132.127011384424, -832.7684630380427, -868.1055907336586, -1220.2179116393079, -568.5954218126869], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.334968535091452, "mean_inference_ms": 0.4082207137826067, "mean_action_processing_ms": 0.09655550986329484, "mean_env_wait_ms": 2.7039141845803796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038907527923583984, "StateBufferConnector_ms": 0.002871990203857422, "ViewRequirementAgentConnector_ms": 0.07173562049865723}}, "episode_reward_max": -308.1558841359608, "episode_reward_min": -1302.0509621184951, "episode_reward_mean": -747.25983758835, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-923.4003012002925, -871.7526413853368, -840.2026916801607, -936.3707455133615, -663.2200970908967, -1226.797570888034, -718.2796093497702, -914.2861592312288, -655.065744427001, -1082.2097938096156, -927.692195471006, -621.6732421245882, -544.7591865826065, -646.8707180877126, -517.5628746402506, -487.8092022886465, -687.1596566903298, -643.4548666039393, -651.6337263764176, -592.7767168399545, -802.5153282624101, -1099.1762628277393, -445.1529978284388, -778.5653613859414, -610.1975378198206, -673.272634866685, -523.2399561542325, -566.206243214677, -531.0503328488047, -566.9073212997645, -850.6987402180574, -884.9572630410971, -694.6014679172719, -541.0020284251477, -465.3649278818729, -696.5453085385882, -414.31184606427246, -723.5138060119428, -615.7874241350772, -603.2933234420765, -739.4105484160322, -959.4067956660626, -587.3315243529139, -743.8885608210755, -699.8833499917077, -950.5467068459807, -413.51370488978205, -621.2053737222399, -724.7038425344531, -308.1558841359608, -717.7591497649998, -934.4577679772444, -923.8105750860786, -800.3754143231071, -557.1646893174938, -590.0560258003314, -415.4778116010488, -816.1223866499049, -761.675271187059, -754.7688459926044, -500.8624242522775, -602.6506671710208, -877.1573800286106, -964.03430997962, -758.1048815117643, -909.6811484896951, -1302.0509621184951, -672.4262470296612, -774.2150450003941, -707.2905721421914, -880.4044582012302, -510.23624097769374, -756.7596885822063, -750.503674906108, -970.4569044562797, -536.9133438307292, -969.1189538969094, -828.6557497044836, -921.1167522249553, -983.3273548465268, -786.8166913876576, -971.8472588541715, -839.0337560248918, -537.4573417131165, -736.6672726824571, -726.1648467480247, -703.5500142618337, -687.3754697981695, -1028.8533235816103, -1016.9399185373081, -547.7700884733886, -825.0141364721521, -854.5119491982765, -761.8485401322998, -645.2999114695314, -1132.127011384424, -832.7684630380427, -868.1055907336586, -1220.2179116393079, -568.5954218126869], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.334968535091452, "mean_inference_ms": 0.4082207137826067, "mean_action_processing_ms": 0.09655550986329484, "mean_env_wait_ms": 2.7039141845803796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0038907527923583984, "StateBufferConnector_ms": 0.002871990203857422, "ViewRequirementAgentConnector_ms": 0.07173562049865723}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 306720, "num_agent_steps_trained": 306720, "num_env_steps_sampled": 306720, "num_env_steps_trained": 306720, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.994702232642446, "num_env_steps_trained_throughput_per_sec": 41.994702232642446, "timesteps_total": 306720, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 306720, "timers": {"training_iteration_time_ms": 2917.295, "sample_time_ms": 2913.549, "load_time_ms": 0.214, "load_throughput": 559489.195, "learn_time_ms": 2.781, "learn_throughput": 43142.399, "synch_weights_time_ms": 0.709}, "counters": {"num_env_steps_sampled": 306720, "num_env_steps_trained": 306720, "num_agent_steps_sampled": 306720, "num_agent_steps_trained": 306720}, "done": false, "episodes_total": 2556, "training_iteration": 640, "trial_id": "53665_00000", "date": "2023-07-26_03-56-45", "timestamp": 1690333005, "time_this_iter_s": 11.432962894439697, "time_total_s": 7742.991602182388, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2121.6661262512207, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 33.66875, "ram_util_percent": 72.75}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.47125244140625, "policy_loss": -118068.4609375, "vf_loss": 6270327.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 722.0, "diff_num_grad_updates_vs_sampler_policy": 721.0}}, "num_env_steps_sampled": 307200, "num_env_steps_trained": 307200, "num_agent_steps_sampled": 307200, "num_agent_steps_trained": 307200}, "sampler_results": {"episode_reward_max": -308.1558841359608, "episode_reward_min": -1302.0509621184951, "episode_reward_mean": -741.0284083102379, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-663.2200970908967, -1226.797570888034, -718.2796093497702, -914.2861592312288, -655.065744427001, -1082.2097938096156, -927.692195471006, -621.6732421245882, -544.7591865826065, -646.8707180877126, -517.5628746402506, -487.8092022886465, -687.1596566903298, -643.4548666039393, -651.6337263764176, -592.7767168399545, -802.5153282624101, -1099.1762628277393, -445.1529978284388, -778.5653613859414, -610.1975378198206, -673.272634866685, -523.2399561542325, -566.206243214677, -531.0503328488047, -566.9073212997645, -850.6987402180574, -884.9572630410971, -694.6014679172719, -541.0020284251477, -465.3649278818729, -696.5453085385882, -414.31184606427246, -723.5138060119428, -615.7874241350772, -603.2933234420765, -739.4105484160322, -959.4067956660626, -587.3315243529139, -743.8885608210755, -699.8833499917077, -950.5467068459807, -413.51370488978205, -621.2053737222399, -724.7038425344531, -308.1558841359608, -717.7591497649998, -934.4577679772444, -923.8105750860786, -800.3754143231071, -557.1646893174938, -590.0560258003314, -415.4778116010488, -816.1223866499049, -761.675271187059, -754.7688459926044, -500.8624242522775, -602.6506671710208, -877.1573800286106, -964.03430997962, -758.1048815117643, -909.6811484896951, -1302.0509621184951, -672.4262470296612, -774.2150450003941, -707.2905721421914, -880.4044582012302, -510.23624097769374, -756.7596885822063, -750.503674906108, -970.4569044562797, -536.9133438307292, -969.1189538969094, -828.6557497044836, -921.1167522249553, -983.3273548465268, -786.8166913876576, -971.8472588541715, -839.0337560248918, -537.4573417131165, -736.6672726824571, -726.1648467480247, -703.5500142618337, -687.3754697981695, -1028.8533235816103, -1016.9399185373081, -547.7700884733886, -825.0141364721521, -854.5119491982765, -761.8485401322998, -645.2999114695314, -1132.127011384424, -832.7684630380427, -868.1055907336586, -1220.2179116393079, -568.5954218126869, -629.2427040522272, -778.7447216149754, -731.5489109251408, -809.0471153755772], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.33446402120965, "mean_inference_ms": 0.40823724099250186, "mean_action_processing_ms": 0.096560333757281, "mean_env_wait_ms": 2.703663084616937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039348602294921875, "StateBufferConnector_ms": 0.002875089645385742, "ViewRequirementAgentConnector_ms": 0.07185745239257812}}, "episode_reward_max": -308.1558841359608, "episode_reward_min": -1302.0509621184951, "episode_reward_mean": -741.0284083102379, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-663.2200970908967, -1226.797570888034, -718.2796093497702, -914.2861592312288, -655.065744427001, -1082.2097938096156, -927.692195471006, -621.6732421245882, -544.7591865826065, -646.8707180877126, -517.5628746402506, -487.8092022886465, -687.1596566903298, -643.4548666039393, -651.6337263764176, -592.7767168399545, -802.5153282624101, -1099.1762628277393, -445.1529978284388, -778.5653613859414, -610.1975378198206, -673.272634866685, -523.2399561542325, -566.206243214677, -531.0503328488047, -566.9073212997645, -850.6987402180574, -884.9572630410971, -694.6014679172719, -541.0020284251477, -465.3649278818729, -696.5453085385882, -414.31184606427246, -723.5138060119428, -615.7874241350772, -603.2933234420765, -739.4105484160322, -959.4067956660626, -587.3315243529139, -743.8885608210755, -699.8833499917077, -950.5467068459807, -413.51370488978205, -621.2053737222399, -724.7038425344531, -308.1558841359608, -717.7591497649998, -934.4577679772444, -923.8105750860786, -800.3754143231071, -557.1646893174938, -590.0560258003314, -415.4778116010488, -816.1223866499049, -761.675271187059, -754.7688459926044, -500.8624242522775, -602.6506671710208, -877.1573800286106, -964.03430997962, -758.1048815117643, -909.6811484896951, -1302.0509621184951, -672.4262470296612, -774.2150450003941, -707.2905721421914, -880.4044582012302, -510.23624097769374, -756.7596885822063, -750.503674906108, -970.4569044562797, -536.9133438307292, -969.1189538969094, -828.6557497044836, -921.1167522249553, -983.3273548465268, -786.8166913876576, -971.8472588541715, -839.0337560248918, -537.4573417131165, -736.6672726824571, -726.1648467480247, -703.5500142618337, -687.3754697981695, -1028.8533235816103, -1016.9399185373081, -547.7700884733886, -825.0141364721521, -854.5119491982765, -761.8485401322998, -645.2999114695314, -1132.127011384424, -832.7684630380427, -868.1055907336586, -1220.2179116393079, -568.5954218126869, -629.2427040522272, -778.7447216149754, -731.5489109251408, -809.0471153755772], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.33446402120965, "mean_inference_ms": 0.40823724099250186, "mean_action_processing_ms": 0.096560333757281, "mean_env_wait_ms": 2.703663084616937, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0039348602294921875, "StateBufferConnector_ms": 0.002875089645385742, "ViewRequirementAgentConnector_ms": 0.07185745239257812}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 307200, "num_agent_steps_trained": 307200, "num_env_steps_sampled": 307200, "num_env_steps_trained": 307200, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.61757349377328, "num_env_steps_trained_throughput_per_sec": 40.61757349377328, "timesteps_total": 307200, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 307200, "timers": {"training_iteration_time_ms": 2905.848, "sample_time_ms": 2902.05, "load_time_ms": 0.216, "load_throughput": 556335.227, "learn_time_ms": 2.814, "learn_throughput": 42645.627, "synch_weights_time_ms": 0.727}, "counters": {"num_env_steps_sampled": 307200, "num_env_steps_trained": 307200, "num_agent_steps_sampled": 307200, "num_agent_steps_trained": 307200}, "done": false, "episodes_total": 2560, "training_iteration": 641, "trial_id": "53665_00000", "date": "2023-07-26_03-56-57", "timestamp": 1690333017, "time_this_iter_s": 11.82030701637268, "time_total_s": 7754.811909198761, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2133.4864332675934, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 40.00588235294118, "ram_util_percent": 73.61176470588235}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.5198059082031, "policy_loss": -116380.421875, "vf_loss": 6379995.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 726.0, "diff_num_grad_updates_vs_sampler_policy": 725.0}}, "num_env_steps_sampled": 307680, "num_env_steps_trained": 307680, "num_agent_steps_sampled": 307680, "num_agent_steps_trained": 307680}, "sampler_results": {"episode_reward_max": -308.1558841359608, "episode_reward_min": -1302.0509621184951, "episode_reward_mean": -733.3182126745567, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-655.065744427001, -1082.2097938096156, -927.692195471006, -621.6732421245882, -544.7591865826065, -646.8707180877126, -517.5628746402506, -487.8092022886465, -687.1596566903298, -643.4548666039393, -651.6337263764176, -592.7767168399545, -802.5153282624101, -1099.1762628277393, -445.1529978284388, -778.5653613859414, -610.1975378198206, -673.272634866685, -523.2399561542325, -566.206243214677, -531.0503328488047, -566.9073212997645, -850.6987402180574, -884.9572630410971, -694.6014679172719, -541.0020284251477, -465.3649278818729, -696.5453085385882, -414.31184606427246, -723.5138060119428, -615.7874241350772, -603.2933234420765, -739.4105484160322, -959.4067956660626, -587.3315243529139, -743.8885608210755, -699.8833499917077, -950.5467068459807, -413.51370488978205, -621.2053737222399, -724.7038425344531, -308.1558841359608, -717.7591497649998, -934.4577679772444, -923.8105750860786, -800.3754143231071, -557.1646893174938, -590.0560258003314, -415.4778116010488, -816.1223866499049, -761.675271187059, -754.7688459926044, -500.8624242522775, -602.6506671710208, -877.1573800286106, -964.03430997962, -758.1048815117643, -909.6811484896951, -1302.0509621184951, -672.4262470296612, -774.2150450003941, -707.2905721421914, -880.4044582012302, -510.23624097769374, -756.7596885822063, -750.503674906108, -970.4569044562797, -536.9133438307292, -969.1189538969094, -828.6557497044836, -921.1167522249553, -983.3273548465268, -786.8166913876576, -971.8472588541715, -839.0337560248918, -537.4573417131165, -736.6672726824571, -726.1648467480247, -703.5500142618337, -687.3754697981695, -1028.8533235816103, -1016.9399185373081, -547.7700884733886, -825.0141364721521, -854.5119491982765, -761.8485401322998, -645.2999114695314, -1132.127011384424, -832.7684630380427, -868.1055907336586, -1220.2179116393079, -568.5954218126869, -629.2427040522272, -778.7447216149754, -731.5489109251408, -809.0471153755772, -505.6045948871234, -724.7878642917971, -694.744406775047, -826.4270070378494], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.333986538648272, "mean_inference_ms": 0.40825669092620953, "mean_action_processing_ms": 0.09656562445297837, "mean_env_wait_ms": 2.70341761473321, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003932952880859375, "StateBufferConnector_ms": 0.0028772354125976562, "ViewRequirementAgentConnector_ms": 0.07190895080566406}}, "episode_reward_max": -308.1558841359608, "episode_reward_min": -1302.0509621184951, "episode_reward_mean": -733.3182126745567, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-655.065744427001, -1082.2097938096156, -927.692195471006, -621.6732421245882, -544.7591865826065, -646.8707180877126, -517.5628746402506, -487.8092022886465, -687.1596566903298, -643.4548666039393, -651.6337263764176, -592.7767168399545, -802.5153282624101, -1099.1762628277393, -445.1529978284388, -778.5653613859414, -610.1975378198206, -673.272634866685, -523.2399561542325, -566.206243214677, -531.0503328488047, -566.9073212997645, -850.6987402180574, -884.9572630410971, -694.6014679172719, -541.0020284251477, -465.3649278818729, -696.5453085385882, -414.31184606427246, -723.5138060119428, -615.7874241350772, -603.2933234420765, -739.4105484160322, -959.4067956660626, -587.3315243529139, -743.8885608210755, -699.8833499917077, -950.5467068459807, -413.51370488978205, -621.2053737222399, -724.7038425344531, -308.1558841359608, -717.7591497649998, -934.4577679772444, -923.8105750860786, -800.3754143231071, -557.1646893174938, -590.0560258003314, -415.4778116010488, -816.1223866499049, -761.675271187059, -754.7688459926044, -500.8624242522775, -602.6506671710208, -877.1573800286106, -964.03430997962, -758.1048815117643, -909.6811484896951, -1302.0509621184951, -672.4262470296612, -774.2150450003941, -707.2905721421914, -880.4044582012302, -510.23624097769374, -756.7596885822063, -750.503674906108, -970.4569044562797, -536.9133438307292, -969.1189538969094, -828.6557497044836, -921.1167522249553, -983.3273548465268, -786.8166913876576, -971.8472588541715, -839.0337560248918, -537.4573417131165, -736.6672726824571, -726.1648467480247, -703.5500142618337, -687.3754697981695, -1028.8533235816103, -1016.9399185373081, -547.7700884733886, -825.0141364721521, -854.5119491982765, -761.8485401322998, -645.2999114695314, -1132.127011384424, -832.7684630380427, -868.1055907336586, -1220.2179116393079, -568.5954218126869, -629.2427040522272, -778.7447216149754, -731.5489109251408, -809.0471153755772, -505.6045948871234, -724.7878642917971, -694.744406775047, -826.4270070378494], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.333986538648272, "mean_inference_ms": 0.40825669092620953, "mean_action_processing_ms": 0.09656562445297837, "mean_env_wait_ms": 2.70341761473321, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003932952880859375, "StateBufferConnector_ms": 0.0028772354125976562, "ViewRequirementAgentConnector_ms": 0.07190895080566406}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 307680, "num_agent_steps_trained": 307680, "num_env_steps_sampled": 307680, "num_env_steps_trained": 307680, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.527074669877805, "num_env_steps_trained_throughput_per_sec": 40.527074669877805, "timesteps_total": 307680, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 307680, "timers": {"training_iteration_time_ms": 2939.744, "sample_time_ms": 2935.955, "load_time_ms": 0.216, "load_throughput": 554985.643, "learn_time_ms": 2.808, "learn_throughput": 42733.975, "synch_weights_time_ms": 0.724}, "counters": {"num_env_steps_sampled": 307680, "num_env_steps_trained": 307680, "num_agent_steps_sampled": 307680, "num_agent_steps_trained": 307680}, "done": false, "episodes_total": 2564, "training_iteration": 642, "trial_id": "53665_00000", "date": "2023-07-26_03-57-09", "timestamp": 1690333029, "time_this_iter_s": 11.846678972244263, "time_total_s": 7766.658588171005, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2145.3331122398376, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 40.1, "ram_util_percent": 73.38823529411764}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.48406982421875, "policy_loss": -97304.296875, "vf_loss": 4744830.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 730.0, "diff_num_grad_updates_vs_sampler_policy": 729.0}}, "num_env_steps_sampled": 308160, "num_env_steps_trained": 308160, "num_agent_steps_sampled": 308160, "num_agent_steps_trained": 308160}, "sampler_results": {"episode_reward_max": -308.1558841359608, "episode_reward_min": -1302.0509621184951, "episode_reward_mean": -729.8742299063648, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-544.7591865826065, -646.8707180877126, -517.5628746402506, -487.8092022886465, -687.1596566903298, -643.4548666039393, -651.6337263764176, -592.7767168399545, -802.5153282624101, -1099.1762628277393, -445.1529978284388, -778.5653613859414, -610.1975378198206, -673.272634866685, -523.2399561542325, -566.206243214677, -531.0503328488047, -566.9073212997645, -850.6987402180574, -884.9572630410971, -694.6014679172719, -541.0020284251477, -465.3649278818729, -696.5453085385882, -414.31184606427246, -723.5138060119428, -615.7874241350772, -603.2933234420765, -739.4105484160322, -959.4067956660626, -587.3315243529139, -743.8885608210755, -699.8833499917077, -950.5467068459807, -413.51370488978205, -621.2053737222399, -724.7038425344531, -308.1558841359608, -717.7591497649998, -934.4577679772444, -923.8105750860786, -800.3754143231071, -557.1646893174938, -590.0560258003314, -415.4778116010488, -816.1223866499049, -761.675271187059, -754.7688459926044, -500.8624242522775, -602.6506671710208, -877.1573800286106, -964.03430997962, -758.1048815117643, -909.6811484896951, -1302.0509621184951, -672.4262470296612, -774.2150450003941, -707.2905721421914, -880.4044582012302, -510.23624097769374, -756.7596885822063, -750.503674906108, -970.4569044562797, -536.9133438307292, -969.1189538969094, -828.6557497044836, -921.1167522249553, -983.3273548465268, -786.8166913876576, -971.8472588541715, -839.0337560248918, -537.4573417131165, -736.6672726824571, -726.1648467480247, -703.5500142618337, -687.3754697981695, -1028.8533235816103, -1016.9399185373081, -547.7700884733886, -825.0141364721521, -854.5119491982765, -761.8485401322998, -645.2999114695314, -1132.127011384424, -832.7684630380427, -868.1055907336586, -1220.2179116393079, -568.5954218126869, -629.2427040522272, -778.7447216149754, -731.5489109251408, -809.0471153755772, -505.6045948871234, -724.7878642917971, -694.744406775047, -826.4270070378494, -820.173605473203, -768.5212560632556, -604.5459644699913, -749.0018730065776], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.33383240837423, "mean_inference_ms": 0.40827999109997265, "mean_action_processing_ms": 0.09657153843230716, "mean_env_wait_ms": 2.703190050060565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003939628601074219, "StateBufferConnector_ms": 0.0028853416442871094, "ViewRequirementAgentConnector_ms": 0.07202959060668945}}, "episode_reward_max": -308.1558841359608, "episode_reward_min": -1302.0509621184951, "episode_reward_mean": -729.8742299063648, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-544.7591865826065, -646.8707180877126, -517.5628746402506, -487.8092022886465, -687.1596566903298, -643.4548666039393, -651.6337263764176, -592.7767168399545, -802.5153282624101, -1099.1762628277393, -445.1529978284388, -778.5653613859414, -610.1975378198206, -673.272634866685, -523.2399561542325, -566.206243214677, -531.0503328488047, -566.9073212997645, -850.6987402180574, -884.9572630410971, -694.6014679172719, -541.0020284251477, -465.3649278818729, -696.5453085385882, -414.31184606427246, -723.5138060119428, -615.7874241350772, -603.2933234420765, -739.4105484160322, -959.4067956660626, -587.3315243529139, -743.8885608210755, -699.8833499917077, -950.5467068459807, -413.51370488978205, -621.2053737222399, -724.7038425344531, -308.1558841359608, -717.7591497649998, -934.4577679772444, -923.8105750860786, -800.3754143231071, -557.1646893174938, -590.0560258003314, -415.4778116010488, -816.1223866499049, -761.675271187059, -754.7688459926044, -500.8624242522775, -602.6506671710208, -877.1573800286106, -964.03430997962, -758.1048815117643, -909.6811484896951, -1302.0509621184951, -672.4262470296612, -774.2150450003941, -707.2905721421914, -880.4044582012302, -510.23624097769374, -756.7596885822063, -750.503674906108, -970.4569044562797, -536.9133438307292, -969.1189538969094, -828.6557497044836, -921.1167522249553, -983.3273548465268, -786.8166913876576, -971.8472588541715, -839.0337560248918, -537.4573417131165, -736.6672726824571, -726.1648467480247, -703.5500142618337, -687.3754697981695, -1028.8533235816103, -1016.9399185373081, -547.7700884733886, -825.0141364721521, -854.5119491982765, -761.8485401322998, -645.2999114695314, -1132.127011384424, -832.7684630380427, -868.1055907336586, -1220.2179116393079, -568.5954218126869, -629.2427040522272, -778.7447216149754, -731.5489109251408, -809.0471153755772, -505.6045948871234, -724.7878642917971, -694.744406775047, -826.4270070378494, -820.173605473203, -768.5212560632556, -604.5459644699913, -749.0018730065776], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.33383240837423, "mean_inference_ms": 0.40827999109997265, "mean_action_processing_ms": 0.09657153843230716, "mean_env_wait_ms": 2.703190050060565, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003939628601074219, "StateBufferConnector_ms": 0.0028853416442871094, "ViewRequirementAgentConnector_ms": 0.07202959060668945}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 308160, "num_agent_steps_trained": 308160, "num_env_steps_sampled": 308160, "num_env_steps_trained": 308160, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.177812073349315, "num_env_steps_trained_throughput_per_sec": 39.177812073349315, "timesteps_total": 308160, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 308160, "timers": {"training_iteration_time_ms": 3008.224, "sample_time_ms": 3004.384, "load_time_ms": 0.219, "load_throughput": 548155.609, "learn_time_ms": 2.861, "learn_throughput": 41936.749, "synch_weights_time_ms": 0.718}, "counters": {"num_env_steps_sampled": 308160, "num_env_steps_trained": 308160, "num_agent_steps_sampled": 308160, "num_agent_steps_trained": 308160}, "done": false, "episodes_total": 2568, "training_iteration": 643, "trial_id": "53665_00000", "date": "2023-07-26_03-57-21", "timestamp": 1690333041, "time_this_iter_s": 12.254642963409424, "time_total_s": 7778.913231134415, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2157.587755203247, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 39.75000000000001, "ram_util_percent": 73.1222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.49237060546875, "policy_loss": -101692.4453125, "vf_loss": 4470835.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 734.0, "diff_num_grad_updates_vs_sampler_policy": 733.0}}, "num_env_steps_sampled": 308640, "num_env_steps_trained": 308640, "num_agent_steps_sampled": 308640, "num_agent_steps_trained": 308640}, "sampler_results": {"episode_reward_max": -308.1558841359608, "episode_reward_min": -1302.0509621184951, "episode_reward_mean": -739.5616009609353, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-687.1596566903298, -643.4548666039393, -651.6337263764176, -592.7767168399545, -802.5153282624101, -1099.1762628277393, -445.1529978284388, -778.5653613859414, -610.1975378198206, -673.272634866685, -523.2399561542325, -566.206243214677, -531.0503328488047, -566.9073212997645, -850.6987402180574, -884.9572630410971, -694.6014679172719, -541.0020284251477, -465.3649278818729, -696.5453085385882, -414.31184606427246, -723.5138060119428, -615.7874241350772, -603.2933234420765, -739.4105484160322, -959.4067956660626, -587.3315243529139, -743.8885608210755, -699.8833499917077, -950.5467068459807, -413.51370488978205, -621.2053737222399, -724.7038425344531, -308.1558841359608, -717.7591497649998, -934.4577679772444, -923.8105750860786, -800.3754143231071, -557.1646893174938, -590.0560258003314, -415.4778116010488, -816.1223866499049, -761.675271187059, -754.7688459926044, -500.8624242522775, -602.6506671710208, -877.1573800286106, -964.03430997962, -758.1048815117643, -909.6811484896951, -1302.0509621184951, -672.4262470296612, -774.2150450003941, -707.2905721421914, -880.4044582012302, -510.23624097769374, -756.7596885822063, -750.503674906108, -970.4569044562797, -536.9133438307292, -969.1189538969094, -828.6557497044836, -921.1167522249553, -983.3273548465268, -786.8166913876576, -971.8472588541715, -839.0337560248918, -537.4573417131165, -736.6672726824571, -726.1648467480247, -703.5500142618337, -687.3754697981695, -1028.8533235816103, -1016.9399185373081, -547.7700884733886, -825.0141364721521, -854.5119491982765, -761.8485401322998, -645.2999114695314, -1132.127011384424, -832.7684630380427, -868.1055907336586, -1220.2179116393079, -568.5954218126869, -629.2427040522272, -778.7447216149754, -731.5489109251408, -809.0471153755772, -505.6045948871234, -724.7878642917971, -694.744406775047, -826.4270070378494, -820.173605473203, -768.5212560632556, -604.5459644699913, -749.0018730065776, -1025.864595518578, -769.7976833526562, -648.5470854658201, -721.529722719201], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.333715041901947, "mean_inference_ms": 0.40830589483784124, "mean_action_processing_ms": 0.09657777949147511, "mean_env_wait_ms": 2.7029960024568798, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003942728042602539, "StateBufferConnector_ms": 0.0028870105743408203, "ViewRequirementAgentConnector_ms": 0.07203841209411621}}, "episode_reward_max": -308.1558841359608, "episode_reward_min": -1302.0509621184951, "episode_reward_mean": -739.5616009609353, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-687.1596566903298, -643.4548666039393, -651.6337263764176, -592.7767168399545, -802.5153282624101, -1099.1762628277393, -445.1529978284388, -778.5653613859414, -610.1975378198206, -673.272634866685, -523.2399561542325, -566.206243214677, -531.0503328488047, -566.9073212997645, -850.6987402180574, -884.9572630410971, -694.6014679172719, -541.0020284251477, -465.3649278818729, -696.5453085385882, -414.31184606427246, -723.5138060119428, -615.7874241350772, -603.2933234420765, -739.4105484160322, -959.4067956660626, -587.3315243529139, -743.8885608210755, -699.8833499917077, -950.5467068459807, -413.51370488978205, -621.2053737222399, -724.7038425344531, -308.1558841359608, -717.7591497649998, -934.4577679772444, -923.8105750860786, -800.3754143231071, -557.1646893174938, -590.0560258003314, -415.4778116010488, -816.1223866499049, -761.675271187059, -754.7688459926044, -500.8624242522775, -602.6506671710208, -877.1573800286106, -964.03430997962, -758.1048815117643, -909.6811484896951, -1302.0509621184951, -672.4262470296612, -774.2150450003941, -707.2905721421914, -880.4044582012302, -510.23624097769374, -756.7596885822063, -750.503674906108, -970.4569044562797, -536.9133438307292, -969.1189538969094, -828.6557497044836, -921.1167522249553, -983.3273548465268, -786.8166913876576, -971.8472588541715, -839.0337560248918, -537.4573417131165, -736.6672726824571, -726.1648467480247, -703.5500142618337, -687.3754697981695, -1028.8533235816103, -1016.9399185373081, -547.7700884733886, -825.0141364721521, -854.5119491982765, -761.8485401322998, -645.2999114695314, -1132.127011384424, -832.7684630380427, -868.1055907336586, -1220.2179116393079, -568.5954218126869, -629.2427040522272, -778.7447216149754, -731.5489109251408, -809.0471153755772, -505.6045948871234, -724.7878642917971, -694.744406775047, -826.4270070378494, -820.173605473203, -768.5212560632556, -604.5459644699913, -749.0018730065776, -1025.864595518578, -769.7976833526562, -648.5470854658201, -721.529722719201], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.333715041901947, "mean_inference_ms": 0.40830589483784124, "mean_action_processing_ms": 0.09657777949147511, "mean_env_wait_ms": 2.7029960024568798, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003942728042602539, "StateBufferConnector_ms": 0.0028870105743408203, "ViewRequirementAgentConnector_ms": 0.07203841209411621}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 308640, "num_agent_steps_trained": 308640, "num_env_steps_sampled": 308640, "num_env_steps_trained": 308640, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.945485285147996, "num_env_steps_trained_throughput_per_sec": 39.945485285147996, "timesteps_total": 308640, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 308640, "timers": {"training_iteration_time_ms": 3020.849, "sample_time_ms": 3016.988, "load_time_ms": 0.221, "load_throughput": 543010.551, "learn_time_ms": 2.87, "learn_throughput": 41809.598, "synch_weights_time_ms": 0.728}, "counters": {"num_env_steps_sampled": 308640, "num_env_steps_trained": 308640, "num_agent_steps_sampled": 308640, "num_agent_steps_trained": 308640}, "done": false, "episodes_total": 2572, "training_iteration": 644, "trial_id": "53665_00000", "date": "2023-07-26_03-57-33", "timestamp": 1690333053, "time_this_iter_s": 12.019244194030762, "time_total_s": 7790.932475328445, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2169.606999397278, "iterations_since_restore": 184, "perf": {"cpu_util_percent": 39.00588235294118, "ram_util_percent": 72.19999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4990234375, "policy_loss": -140659.03125, "vf_loss": 8816892.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 738.0, "diff_num_grad_updates_vs_sampler_policy": 737.0}}, "num_env_steps_sampled": 309120, "num_env_steps_trained": 309120, "num_agent_steps_sampled": 309120, "num_agent_steps_trained": 309120}, "sampler_results": {"episode_reward_max": -308.1558841359608, "episode_reward_min": -1302.0509621184951, "episode_reward_mean": -748.3852473359981, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-802.5153282624101, -1099.1762628277393, -445.1529978284388, -778.5653613859414, -610.1975378198206, -673.272634866685, -523.2399561542325, -566.206243214677, -531.0503328488047, -566.9073212997645, -850.6987402180574, -884.9572630410971, -694.6014679172719, -541.0020284251477, -465.3649278818729, -696.5453085385882, -414.31184606427246, -723.5138060119428, -615.7874241350772, -603.2933234420765, -739.4105484160322, -959.4067956660626, -587.3315243529139, -743.8885608210755, -699.8833499917077, -950.5467068459807, -413.51370488978205, -621.2053737222399, -724.7038425344531, -308.1558841359608, -717.7591497649998, -934.4577679772444, -923.8105750860786, -800.3754143231071, -557.1646893174938, -590.0560258003314, -415.4778116010488, -816.1223866499049, -761.675271187059, -754.7688459926044, -500.8624242522775, -602.6506671710208, -877.1573800286106, -964.03430997962, -758.1048815117643, -909.6811484896951, -1302.0509621184951, -672.4262470296612, -774.2150450003941, -707.2905721421914, -880.4044582012302, -510.23624097769374, -756.7596885822063, -750.503674906108, -970.4569044562797, -536.9133438307292, -969.1189538969094, -828.6557497044836, -921.1167522249553, -983.3273548465268, -786.8166913876576, -971.8472588541715, -839.0337560248918, -537.4573417131165, -736.6672726824571, -726.1648467480247, -703.5500142618337, -687.3754697981695, -1028.8533235816103, -1016.9399185373081, -547.7700884733886, -825.0141364721521, -854.5119491982765, -761.8485401322998, -645.2999114695314, -1132.127011384424, -832.7684630380427, -868.1055907336586, -1220.2179116393079, -568.5954218126869, -629.2427040522272, -778.7447216149754, -731.5489109251408, -809.0471153755772, -505.6045948871234, -724.7878642917971, -694.744406775047, -826.4270070378494, -820.173605473203, -768.5212560632556, -604.5459644699913, -749.0018730065776, -1025.864595518578, -769.7976833526562, -648.5470854658201, -721.529722719201, -740.6662003606299, -844.9133663279711, -760.7070604717552, -1111.1029768565718], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.33370034577489, "mean_inference_ms": 0.40834686353381655, "mean_action_processing_ms": 0.09658603835487937, "mean_env_wait_ms": 2.7028384401504386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003973722457885742, "StateBufferConnector_ms": 0.0029065608978271484, "ViewRequirementAgentConnector_ms": 0.07238602638244629}}, "episode_reward_max": -308.1558841359608, "episode_reward_min": -1302.0509621184951, "episode_reward_mean": -748.3852473359981, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-802.5153282624101, -1099.1762628277393, -445.1529978284388, -778.5653613859414, -610.1975378198206, -673.272634866685, -523.2399561542325, -566.206243214677, -531.0503328488047, -566.9073212997645, -850.6987402180574, -884.9572630410971, -694.6014679172719, -541.0020284251477, -465.3649278818729, -696.5453085385882, -414.31184606427246, -723.5138060119428, -615.7874241350772, -603.2933234420765, -739.4105484160322, -959.4067956660626, -587.3315243529139, -743.8885608210755, -699.8833499917077, -950.5467068459807, -413.51370488978205, -621.2053737222399, -724.7038425344531, -308.1558841359608, -717.7591497649998, -934.4577679772444, -923.8105750860786, -800.3754143231071, -557.1646893174938, -590.0560258003314, -415.4778116010488, -816.1223866499049, -761.675271187059, -754.7688459926044, -500.8624242522775, -602.6506671710208, -877.1573800286106, -964.03430997962, -758.1048815117643, -909.6811484896951, -1302.0509621184951, -672.4262470296612, -774.2150450003941, -707.2905721421914, -880.4044582012302, -510.23624097769374, -756.7596885822063, -750.503674906108, -970.4569044562797, -536.9133438307292, -969.1189538969094, -828.6557497044836, -921.1167522249553, -983.3273548465268, -786.8166913876576, -971.8472588541715, -839.0337560248918, -537.4573417131165, -736.6672726824571, -726.1648467480247, -703.5500142618337, -687.3754697981695, -1028.8533235816103, -1016.9399185373081, -547.7700884733886, -825.0141364721521, -854.5119491982765, -761.8485401322998, -645.2999114695314, -1132.127011384424, -832.7684630380427, -868.1055907336586, -1220.2179116393079, -568.5954218126869, -629.2427040522272, -778.7447216149754, -731.5489109251408, -809.0471153755772, -505.6045948871234, -724.7878642917971, -694.744406775047, -826.4270070378494, -820.173605473203, -768.5212560632556, -604.5459644699913, -749.0018730065776, -1025.864595518578, -769.7976833526562, -648.5470854658201, -721.529722719201, -740.6662003606299, -844.9133663279711, -760.7070604717552, -1111.1029768565718], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.33370034577489, "mean_inference_ms": 0.40834686353381655, "mean_action_processing_ms": 0.09658603835487937, "mean_env_wait_ms": 2.7028384401504386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003973722457885742, "StateBufferConnector_ms": 0.0029065608978271484, "ViewRequirementAgentConnector_ms": 0.07238602638244629}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 309120, "num_agent_steps_trained": 309120, "num_env_steps_sampled": 309120, "num_env_steps_trained": 309120, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.5492572752033, "num_env_steps_trained_throughput_per_sec": 40.5492572752033, "timesteps_total": 309120, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 309120, "timers": {"training_iteration_time_ms": 3024.799, "sample_time_ms": 3020.906, "load_time_ms": 0.221, "load_throughput": 542308.458, "learn_time_ms": 2.879, "learn_throughput": 41674.586, "synch_weights_time_ms": 0.751}, "counters": {"num_env_steps_sampled": 309120, "num_env_steps_trained": 309120, "num_agent_steps_sampled": 309120, "num_agent_steps_trained": 309120}, "done": false, "episodes_total": 2576, "training_iteration": 645, "trial_id": "53665_00000", "date": "2023-07-26_03-57-45", "timestamp": 1690333065, "time_this_iter_s": 11.84023666381836, "time_total_s": 7802.772711992264, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2181.447236061096, "iterations_since_restore": 185, "perf": {"cpu_util_percent": 42.076470588235296, "ram_util_percent": 73.04705882352943}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4607849121094, "policy_loss": -74228.625, "vf_loss": 2681231.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 742.0, "diff_num_grad_updates_vs_sampler_policy": 741.0}}, "num_env_steps_sampled": 309600, "num_env_steps_trained": 309600, "num_agent_steps_sampled": 309600, "num_agent_steps_trained": 309600}, "sampler_results": {"episode_reward_max": -308.1558841359608, "episode_reward_min": -1302.0509621184951, "episode_reward_mean": -743.9488426201107, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-610.1975378198206, -673.272634866685, -523.2399561542325, -566.206243214677, -531.0503328488047, -566.9073212997645, -850.6987402180574, -884.9572630410971, -694.6014679172719, -541.0020284251477, -465.3649278818729, -696.5453085385882, -414.31184606427246, -723.5138060119428, -615.7874241350772, -603.2933234420765, -739.4105484160322, -959.4067956660626, -587.3315243529139, -743.8885608210755, -699.8833499917077, -950.5467068459807, -413.51370488978205, -621.2053737222399, -724.7038425344531, -308.1558841359608, -717.7591497649998, -934.4577679772444, -923.8105750860786, -800.3754143231071, -557.1646893174938, -590.0560258003314, -415.4778116010488, -816.1223866499049, -761.675271187059, -754.7688459926044, -500.8624242522775, -602.6506671710208, -877.1573800286106, -964.03430997962, -758.1048815117643, -909.6811484896951, -1302.0509621184951, -672.4262470296612, -774.2150450003941, -707.2905721421914, -880.4044582012302, -510.23624097769374, -756.7596885822063, -750.503674906108, -970.4569044562797, -536.9133438307292, -969.1189538969094, -828.6557497044836, -921.1167522249553, -983.3273548465268, -786.8166913876576, -971.8472588541715, -839.0337560248918, -537.4573417131165, -736.6672726824571, -726.1648467480247, -703.5500142618337, -687.3754697981695, -1028.8533235816103, -1016.9399185373081, -547.7700884733886, -825.0141364721521, -854.5119491982765, -761.8485401322998, -645.2999114695314, -1132.127011384424, -832.7684630380427, -868.1055907336586, -1220.2179116393079, -568.5954218126869, -629.2427040522272, -778.7447216149754, -731.5489109251408, -809.0471153755772, -505.6045948871234, -724.7878642917971, -694.744406775047, -826.4270070378494, -820.173605473203, -768.5212560632556, -604.5459644699913, -749.0018730065776, -1025.864595518578, -769.7976833526562, -648.5470854658201, -721.529722719201, -740.6662003606299, -844.9133663279711, -760.7070604717552, -1111.1029768565718, -692.2693691598017, -663.3715201323328, -613.3569157791644, -712.7716736444878], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.33375868645706, "mean_inference_ms": 0.4083883507482021, "mean_action_processing_ms": 0.09659426195525028, "mean_env_wait_ms": 2.7026725148685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003970623016357422, "StateBufferConnector_ms": 0.0029065608978271484, "ViewRequirementAgentConnector_ms": 0.07243919372558594}}, "episode_reward_max": -308.1558841359608, "episode_reward_min": -1302.0509621184951, "episode_reward_mean": -743.9488426201107, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-610.1975378198206, -673.272634866685, -523.2399561542325, -566.206243214677, -531.0503328488047, -566.9073212997645, -850.6987402180574, -884.9572630410971, -694.6014679172719, -541.0020284251477, -465.3649278818729, -696.5453085385882, -414.31184606427246, -723.5138060119428, -615.7874241350772, -603.2933234420765, -739.4105484160322, -959.4067956660626, -587.3315243529139, -743.8885608210755, -699.8833499917077, -950.5467068459807, -413.51370488978205, -621.2053737222399, -724.7038425344531, -308.1558841359608, -717.7591497649998, -934.4577679772444, -923.8105750860786, -800.3754143231071, -557.1646893174938, -590.0560258003314, -415.4778116010488, -816.1223866499049, -761.675271187059, -754.7688459926044, -500.8624242522775, -602.6506671710208, -877.1573800286106, -964.03430997962, -758.1048815117643, -909.6811484896951, -1302.0509621184951, -672.4262470296612, -774.2150450003941, -707.2905721421914, -880.4044582012302, -510.23624097769374, -756.7596885822063, -750.503674906108, -970.4569044562797, -536.9133438307292, -969.1189538969094, -828.6557497044836, -921.1167522249553, -983.3273548465268, -786.8166913876576, -971.8472588541715, -839.0337560248918, -537.4573417131165, -736.6672726824571, -726.1648467480247, -703.5500142618337, -687.3754697981695, -1028.8533235816103, -1016.9399185373081, -547.7700884733886, -825.0141364721521, -854.5119491982765, -761.8485401322998, -645.2999114695314, -1132.127011384424, -832.7684630380427, -868.1055907336586, -1220.2179116393079, -568.5954218126869, -629.2427040522272, -778.7447216149754, -731.5489109251408, -809.0471153755772, -505.6045948871234, -724.7878642917971, -694.744406775047, -826.4270070378494, -820.173605473203, -768.5212560632556, -604.5459644699913, -749.0018730065776, -1025.864595518578, -769.7976833526562, -648.5470854658201, -721.529722719201, -740.6662003606299, -844.9133663279711, -760.7070604717552, -1111.1029768565718, -692.2693691598017, -663.3715201323328, -613.3569157791644, -712.7716736444878], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.33375868645706, "mean_inference_ms": 0.4083883507482021, "mean_action_processing_ms": 0.09659426195525028, "mean_env_wait_ms": 2.7026725148685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003970623016357422, "StateBufferConnector_ms": 0.0029065608978271484, "ViewRequirementAgentConnector_ms": 0.07243919372558594}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 309600, "num_agent_steps_trained": 309600, "num_env_steps_sampled": 309600, "num_env_steps_trained": 309600, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.82749002287968, "num_env_steps_trained_throughput_per_sec": 39.82749002287968, "timesteps_total": 309600, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 309600, "timers": {"training_iteration_time_ms": 2995.274, "sample_time_ms": 2991.451, "load_time_ms": 0.218, "load_throughput": 550915.587, "learn_time_ms": 2.836, "learn_throughput": 42308.657, "synch_weights_time_ms": 0.73}, "counters": {"num_env_steps_sampled": 309600, "num_env_steps_trained": 309600, "num_agent_steps_sampled": 309600, "num_agent_steps_trained": 309600}, "done": false, "episodes_total": 2580, "training_iteration": 646, "trial_id": "53665_00000", "date": "2023-07-26_03-57-57", "timestamp": 1690333077, "time_this_iter_s": 12.054726123809814, "time_total_s": 7814.827438116074, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2193.501962184906, "iterations_since_restore": 186, "perf": {"cpu_util_percent": 40.7235294117647, "ram_util_percent": 73.18823529411763}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4696350097656, "policy_loss": -85797.2265625, "vf_loss": 3346665.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 746.0, "diff_num_grad_updates_vs_sampler_policy": 745.0}}, "num_env_steps_sampled": 310080, "num_env_steps_trained": 310080, "num_agent_steps_sampled": 310080, "num_agent_steps_trained": 310080}, "sampler_results": {"episode_reward_max": -308.1558841359608, "episode_reward_min": -1302.0509621184951, "episode_reward_mean": -747.3129440058759, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-531.0503328488047, -566.9073212997645, -850.6987402180574, -884.9572630410971, -694.6014679172719, -541.0020284251477, -465.3649278818729, -696.5453085385882, -414.31184606427246, -723.5138060119428, -615.7874241350772, -603.2933234420765, -739.4105484160322, -959.4067956660626, -587.3315243529139, -743.8885608210755, -699.8833499917077, -950.5467068459807, -413.51370488978205, -621.2053737222399, -724.7038425344531, -308.1558841359608, -717.7591497649998, -934.4577679772444, -923.8105750860786, -800.3754143231071, -557.1646893174938, -590.0560258003314, -415.4778116010488, -816.1223866499049, -761.675271187059, -754.7688459926044, -500.8624242522775, -602.6506671710208, -877.1573800286106, -964.03430997962, -758.1048815117643, -909.6811484896951, -1302.0509621184951, -672.4262470296612, -774.2150450003941, -707.2905721421914, -880.4044582012302, -510.23624097769374, -756.7596885822063, -750.503674906108, -970.4569044562797, -536.9133438307292, -969.1189538969094, -828.6557497044836, -921.1167522249553, -983.3273548465268, -786.8166913876576, -971.8472588541715, -839.0337560248918, -537.4573417131165, -736.6672726824571, -726.1648467480247, -703.5500142618337, -687.3754697981695, -1028.8533235816103, -1016.9399185373081, -547.7700884733886, -825.0141364721521, -854.5119491982765, -761.8485401322998, -645.2999114695314, -1132.127011384424, -832.7684630380427, -868.1055907336586, -1220.2179116393079, -568.5954218126869, -629.2427040522272, -778.7447216149754, -731.5489109251408, -809.0471153755772, -505.6045948871234, -724.7878642917971, -694.744406775047, -826.4270070378494, -820.173605473203, -768.5212560632556, -604.5459644699913, -749.0018730065776, -1025.864595518578, -769.7976833526562, -648.5470854658201, -721.529722719201, -740.6662003606299, -844.9133663279711, -760.7070604717552, -1111.1029768565718, -692.2693691598017, -663.3715201323328, -613.3569157791644, -712.7716736444878, -969.3761222584264, -682.1853674091266, -430.859253196766, -626.9057677676295], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.3337164053573, "mean_inference_ms": 0.4084307524693567, "mean_action_processing_ms": 0.09660276043149661, "mean_env_wait_ms": 2.7025086174164987, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003954410552978516, "StateBufferConnector_ms": 0.0029032230377197266, "ViewRequirementAgentConnector_ms": 0.07230424880981445}}, "episode_reward_max": -308.1558841359608, "episode_reward_min": -1302.0509621184951, "episode_reward_mean": -747.3129440058759, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-531.0503328488047, -566.9073212997645, -850.6987402180574, -884.9572630410971, -694.6014679172719, -541.0020284251477, -465.3649278818729, -696.5453085385882, -414.31184606427246, -723.5138060119428, -615.7874241350772, -603.2933234420765, -739.4105484160322, -959.4067956660626, -587.3315243529139, -743.8885608210755, -699.8833499917077, -950.5467068459807, -413.51370488978205, -621.2053737222399, -724.7038425344531, -308.1558841359608, -717.7591497649998, -934.4577679772444, -923.8105750860786, -800.3754143231071, -557.1646893174938, -590.0560258003314, -415.4778116010488, -816.1223866499049, -761.675271187059, -754.7688459926044, -500.8624242522775, -602.6506671710208, -877.1573800286106, -964.03430997962, -758.1048815117643, -909.6811484896951, -1302.0509621184951, -672.4262470296612, -774.2150450003941, -707.2905721421914, -880.4044582012302, -510.23624097769374, -756.7596885822063, -750.503674906108, -970.4569044562797, -536.9133438307292, -969.1189538969094, -828.6557497044836, -921.1167522249553, -983.3273548465268, -786.8166913876576, -971.8472588541715, -839.0337560248918, -537.4573417131165, -736.6672726824571, -726.1648467480247, -703.5500142618337, -687.3754697981695, -1028.8533235816103, -1016.9399185373081, -547.7700884733886, -825.0141364721521, -854.5119491982765, -761.8485401322998, -645.2999114695314, -1132.127011384424, -832.7684630380427, -868.1055907336586, -1220.2179116393079, -568.5954218126869, -629.2427040522272, -778.7447216149754, -731.5489109251408, -809.0471153755772, -505.6045948871234, -724.7878642917971, -694.744406775047, -826.4270070378494, -820.173605473203, -768.5212560632556, -604.5459644699913, -749.0018730065776, -1025.864595518578, -769.7976833526562, -648.5470854658201, -721.529722719201, -740.6662003606299, -844.9133663279711, -760.7070604717552, -1111.1029768565718, -692.2693691598017, -663.3715201323328, -613.3569157791644, -712.7716736444878, -969.3761222584264, -682.1853674091266, -430.859253196766, -626.9057677676295], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.3337164053573, "mean_inference_ms": 0.4084307524693567, "mean_action_processing_ms": 0.09660276043149661, "mean_env_wait_ms": 2.7025086174164987, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003954410552978516, "StateBufferConnector_ms": 0.0029032230377197266, "ViewRequirementAgentConnector_ms": 0.07230424880981445}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 310080, "num_agent_steps_trained": 310080, "num_env_steps_sampled": 310080, "num_env_steps_trained": 310080, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.289043812120084, "num_env_steps_trained_throughput_per_sec": 40.289043812120084, "timesteps_total": 310080, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 310080, "timers": {"training_iteration_time_ms": 2977.241, "sample_time_ms": 2973.446, "load_time_ms": 0.217, "load_throughput": 552912.754, "learn_time_ms": 2.802, "learn_throughput": 42824.511, "synch_weights_time_ms": 0.736}, "counters": {"num_env_steps_sampled": 310080, "num_env_steps_trained": 310080, "num_agent_steps_sampled": 310080, "num_agent_steps_trained": 310080}, "done": false, "episodes_total": 2584, "training_iteration": 647, "trial_id": "53665_00000", "date": "2023-07-26_03-58-09", "timestamp": 1690333089, "time_this_iter_s": 11.916838884353638, "time_total_s": 7826.744277000427, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2205.4188010692596, "iterations_since_restore": 187, "perf": {"cpu_util_percent": 40.88235294117647, "ram_util_percent": 72.70588235294117}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4595947265625, "policy_loss": -69120.1796875, "vf_loss": 2400534.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 750.0, "diff_num_grad_updates_vs_sampler_policy": 749.0}}, "num_env_steps_sampled": 310560, "num_env_steps_trained": 310560, "num_agent_steps_sampled": 310560, "num_agent_steps_trained": 310560}, "sampler_results": {"episode_reward_max": -308.1558841359608, "episode_reward_min": -1302.0509621184951, "episode_reward_mean": -744.4705008575019, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-694.6014679172719, -541.0020284251477, -465.3649278818729, -696.5453085385882, -414.31184606427246, -723.5138060119428, -615.7874241350772, -603.2933234420765, -739.4105484160322, -959.4067956660626, -587.3315243529139, -743.8885608210755, -699.8833499917077, -950.5467068459807, -413.51370488978205, -621.2053737222399, -724.7038425344531, -308.1558841359608, -717.7591497649998, -934.4577679772444, -923.8105750860786, -800.3754143231071, -557.1646893174938, -590.0560258003314, -415.4778116010488, -816.1223866499049, -761.675271187059, -754.7688459926044, -500.8624242522775, -602.6506671710208, -877.1573800286106, -964.03430997962, -758.1048815117643, -909.6811484896951, -1302.0509621184951, -672.4262470296612, -774.2150450003941, -707.2905721421914, -880.4044582012302, -510.23624097769374, -756.7596885822063, -750.503674906108, -970.4569044562797, -536.9133438307292, -969.1189538969094, -828.6557497044836, -921.1167522249553, -983.3273548465268, -786.8166913876576, -971.8472588541715, -839.0337560248918, -537.4573417131165, -736.6672726824571, -726.1648467480247, -703.5500142618337, -687.3754697981695, -1028.8533235816103, -1016.9399185373081, -547.7700884733886, -825.0141364721521, -854.5119491982765, -761.8485401322998, -645.2999114695314, -1132.127011384424, -832.7684630380427, -868.1055907336586, -1220.2179116393079, -568.5954218126869, -629.2427040522272, -778.7447216149754, -731.5489109251408, -809.0471153755772, -505.6045948871234, -724.7878642917971, -694.744406775047, -826.4270070378494, -820.173605473203, -768.5212560632556, -604.5459644699913, -749.0018730065776, -1025.864595518578, -769.7976833526562, -648.5470854658201, -721.529722719201, -740.6662003606299, -844.9133663279711, -760.7070604717552, -1111.1029768565718, -692.2693691598017, -663.3715201323328, -613.3569157791644, -712.7716736444878, -969.3761222584264, -682.1853674091266, -430.859253196766, -626.9057677676295, -394.174631242734, -881.8621199270841, -701.8105128347617, -571.5220785657247], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.3337108023197, "mean_inference_ms": 0.4084771614551791, "mean_action_processing_ms": 0.09661105810849815, "mean_env_wait_ms": 2.7023544696045514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00392603874206543, "StateBufferConnector_ms": 0.002911090850830078, "ViewRequirementAgentConnector_ms": 0.07270359992980957}}, "episode_reward_max": -308.1558841359608, "episode_reward_min": -1302.0509621184951, "episode_reward_mean": -744.4705008575019, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-694.6014679172719, -541.0020284251477, -465.3649278818729, -696.5453085385882, -414.31184606427246, -723.5138060119428, -615.7874241350772, -603.2933234420765, -739.4105484160322, -959.4067956660626, -587.3315243529139, -743.8885608210755, -699.8833499917077, -950.5467068459807, -413.51370488978205, -621.2053737222399, -724.7038425344531, -308.1558841359608, -717.7591497649998, -934.4577679772444, -923.8105750860786, -800.3754143231071, -557.1646893174938, -590.0560258003314, -415.4778116010488, -816.1223866499049, -761.675271187059, -754.7688459926044, -500.8624242522775, -602.6506671710208, -877.1573800286106, -964.03430997962, -758.1048815117643, -909.6811484896951, -1302.0509621184951, -672.4262470296612, -774.2150450003941, -707.2905721421914, -880.4044582012302, -510.23624097769374, -756.7596885822063, -750.503674906108, -970.4569044562797, -536.9133438307292, -969.1189538969094, -828.6557497044836, -921.1167522249553, -983.3273548465268, -786.8166913876576, -971.8472588541715, -839.0337560248918, -537.4573417131165, -736.6672726824571, -726.1648467480247, -703.5500142618337, -687.3754697981695, -1028.8533235816103, -1016.9399185373081, -547.7700884733886, -825.0141364721521, -854.5119491982765, -761.8485401322998, -645.2999114695314, -1132.127011384424, -832.7684630380427, -868.1055907336586, -1220.2179116393079, -568.5954218126869, -629.2427040522272, -778.7447216149754, -731.5489109251408, -809.0471153755772, -505.6045948871234, -724.7878642917971, -694.744406775047, -826.4270070378494, -820.173605473203, -768.5212560632556, -604.5459644699913, -749.0018730065776, -1025.864595518578, -769.7976833526562, -648.5470854658201, -721.529722719201, -740.6662003606299, -844.9133663279711, -760.7070604717552, -1111.1029768565718, -692.2693691598017, -663.3715201323328, -613.3569157791644, -712.7716736444878, -969.3761222584264, -682.1853674091266, -430.859253196766, -626.9057677676295, -394.174631242734, -881.8621199270841, -701.8105128347617, -571.5220785657247], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.3337108023197, "mean_inference_ms": 0.4084771614551791, "mean_action_processing_ms": 0.09661105810849815, "mean_env_wait_ms": 2.7023544696045514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00392603874206543, "StateBufferConnector_ms": 0.002911090850830078, "ViewRequirementAgentConnector_ms": 0.07270359992980957}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 310560, "num_agent_steps_trained": 310560, "num_env_steps_sampled": 310560, "num_env_steps_trained": 310560, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.13469356698731, "num_env_steps_trained_throughput_per_sec": 41.13469356698731, "timesteps_total": 310560, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 310560, "timers": {"training_iteration_time_ms": 2968.228, "sample_time_ms": 2964.418, "load_time_ms": 0.222, "load_throughput": 541549.903, "learn_time_ms": 2.809, "learn_throughput": 42718.741, "synch_weights_time_ms": 0.739}, "counters": {"num_env_steps_sampled": 310560, "num_env_steps_trained": 310560, "num_agent_steps_sampled": 310560, "num_agent_steps_trained": 310560}, "done": false, "episodes_total": 2588, "training_iteration": 648, "trial_id": "53665_00000", "date": "2023-07-26_03-58-21", "timestamp": 1690333101, "time_this_iter_s": 11.671834945678711, "time_total_s": 7838.416111946106, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2217.0906360149384, "iterations_since_restore": 188, "perf": {"cpu_util_percent": 42.743750000000006, "ram_util_percent": 72.15625}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4732971191406, "policy_loss": -109931.15625, "vf_loss": 5444535.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 754.0, "diff_num_grad_updates_vs_sampler_policy": 753.0}}, "num_env_steps_sampled": 311040, "num_env_steps_trained": 311040, "num_agent_steps_sampled": 311040, "num_agent_steps_trained": 311040}, "sampler_results": {"episode_reward_max": -308.1558841359608, "episode_reward_min": -1302.0509621184951, "episode_reward_mean": -751.6032356352247, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-414.31184606427246, -723.5138060119428, -615.7874241350772, -603.2933234420765, -739.4105484160322, -959.4067956660626, -587.3315243529139, -743.8885608210755, -699.8833499917077, -950.5467068459807, -413.51370488978205, -621.2053737222399, -724.7038425344531, -308.1558841359608, -717.7591497649998, -934.4577679772444, -923.8105750860786, -800.3754143231071, -557.1646893174938, -590.0560258003314, -415.4778116010488, -816.1223866499049, -761.675271187059, -754.7688459926044, -500.8624242522775, -602.6506671710208, -877.1573800286106, -964.03430997962, -758.1048815117643, -909.6811484896951, -1302.0509621184951, -672.4262470296612, -774.2150450003941, -707.2905721421914, -880.4044582012302, -510.23624097769374, -756.7596885822063, -750.503674906108, -970.4569044562797, -536.9133438307292, -969.1189538969094, -828.6557497044836, -921.1167522249553, -983.3273548465268, -786.8166913876576, -971.8472588541715, -839.0337560248918, -537.4573417131165, -736.6672726824571, -726.1648467480247, -703.5500142618337, -687.3754697981695, -1028.8533235816103, -1016.9399185373081, -547.7700884733886, -825.0141364721521, -854.5119491982765, -761.8485401322998, -645.2999114695314, -1132.127011384424, -832.7684630380427, -868.1055907336586, -1220.2179116393079, -568.5954218126869, -629.2427040522272, -778.7447216149754, -731.5489109251408, -809.0471153755772, -505.6045948871234, -724.7878642917971, -694.744406775047, -826.4270070378494, -820.173605473203, -768.5212560632556, -604.5459644699913, -749.0018730065776, -1025.864595518578, -769.7976833526562, -648.5470854658201, -721.529722719201, -740.6662003606299, -844.9133663279711, -760.7070604717552, -1111.1029768565718, -692.2693691598017, -663.3715201323328, -613.3569157791644, -712.7716736444878, -969.3761222584264, -682.1853674091266, -430.859253196766, -626.9057677676295, -394.174631242734, -881.8621199270841, -701.8105128347617, -571.5220785657247, -802.2847505080613, -778.1681600158208, -764.856613003843, -765.477687007436], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.333849534844447, "mean_inference_ms": 0.4085391166143384, "mean_action_processing_ms": 0.09662133768110164, "mean_env_wait_ms": 2.7022314692807994, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003932952880859375, "StateBufferConnector_ms": 0.0029120445251464844, "ViewRequirementAgentConnector_ms": 0.07269406318664551}}, "episode_reward_max": -308.1558841359608, "episode_reward_min": -1302.0509621184951, "episode_reward_mean": -751.6032356352247, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-414.31184606427246, -723.5138060119428, -615.7874241350772, -603.2933234420765, -739.4105484160322, -959.4067956660626, -587.3315243529139, -743.8885608210755, -699.8833499917077, -950.5467068459807, -413.51370488978205, -621.2053737222399, -724.7038425344531, -308.1558841359608, -717.7591497649998, -934.4577679772444, -923.8105750860786, -800.3754143231071, -557.1646893174938, -590.0560258003314, -415.4778116010488, -816.1223866499049, -761.675271187059, -754.7688459926044, -500.8624242522775, -602.6506671710208, -877.1573800286106, -964.03430997962, -758.1048815117643, -909.6811484896951, -1302.0509621184951, -672.4262470296612, -774.2150450003941, -707.2905721421914, -880.4044582012302, -510.23624097769374, -756.7596885822063, -750.503674906108, -970.4569044562797, -536.9133438307292, -969.1189538969094, -828.6557497044836, -921.1167522249553, -983.3273548465268, -786.8166913876576, -971.8472588541715, -839.0337560248918, -537.4573417131165, -736.6672726824571, -726.1648467480247, -703.5500142618337, -687.3754697981695, -1028.8533235816103, -1016.9399185373081, -547.7700884733886, -825.0141364721521, -854.5119491982765, -761.8485401322998, -645.2999114695314, -1132.127011384424, -832.7684630380427, -868.1055907336586, -1220.2179116393079, -568.5954218126869, -629.2427040522272, -778.7447216149754, -731.5489109251408, -809.0471153755772, -505.6045948871234, -724.7878642917971, -694.744406775047, -826.4270070378494, -820.173605473203, -768.5212560632556, -604.5459644699913, -749.0018730065776, -1025.864595518578, -769.7976833526562, -648.5470854658201, -721.529722719201, -740.6662003606299, -844.9133663279711, -760.7070604717552, -1111.1029768565718, -692.2693691598017, -663.3715201323328, -613.3569157791644, -712.7716736444878, -969.3761222584264, -682.1853674091266, -430.859253196766, -626.9057677676295, -394.174631242734, -881.8621199270841, -701.8105128347617, -571.5220785657247, -802.2847505080613, -778.1681600158208, -764.856613003843, -765.477687007436], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.333849534844447, "mean_inference_ms": 0.4085391166143384, "mean_action_processing_ms": 0.09662133768110164, "mean_env_wait_ms": 2.7022314692807994, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003932952880859375, "StateBufferConnector_ms": 0.0029120445251464844, "ViewRequirementAgentConnector_ms": 0.07269406318664551}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 311040, "num_agent_steps_trained": 311040, "num_env_steps_sampled": 311040, "num_env_steps_trained": 311040, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.88804688170069, "num_env_steps_trained_throughput_per_sec": 39.88804688170069, "timesteps_total": 311040, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 311040, "timers": {"training_iteration_time_ms": 2971.26, "sample_time_ms": 2967.411, "load_time_ms": 0.222, "load_throughput": 541258.716, "learn_time_ms": 2.81, "learn_throughput": 42710.766, "synch_weights_time_ms": 0.776}, "counters": {"num_env_steps_sampled": 311040, "num_env_steps_trained": 311040, "num_agent_steps_sampled": 311040, "num_agent_steps_trained": 311040}, "done": false, "episodes_total": 2592, "training_iteration": 649, "trial_id": "53665_00000", "date": "2023-07-26_03-58-33", "timestamp": 1690333113, "time_this_iter_s": 12.036795854568481, "time_total_s": 7850.452907800674, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2229.127431869507, "iterations_since_restore": 189, "perf": {"cpu_util_percent": 43.05, "ram_util_percent": 72.85}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.5177307128906, "policy_loss": -139952.640625, "vf_loss": 8535327.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 758.0, "diff_num_grad_updates_vs_sampler_policy": 757.0}}, "num_env_steps_sampled": 311520, "num_env_steps_trained": 311520, "num_agent_steps_sampled": 311520, "num_agent_steps_trained": 311520}, "sampler_results": {"episode_reward_max": -308.1558841359608, "episode_reward_min": -1302.0509621184951, "episode_reward_mean": -758.9185123977941, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-739.4105484160322, -959.4067956660626, -587.3315243529139, -743.8885608210755, -699.8833499917077, -950.5467068459807, -413.51370488978205, -621.2053737222399, -724.7038425344531, -308.1558841359608, -717.7591497649998, -934.4577679772444, -923.8105750860786, -800.3754143231071, -557.1646893174938, -590.0560258003314, -415.4778116010488, -816.1223866499049, -761.675271187059, -754.7688459926044, -500.8624242522775, -602.6506671710208, -877.1573800286106, -964.03430997962, -758.1048815117643, -909.6811484896951, -1302.0509621184951, -672.4262470296612, -774.2150450003941, -707.2905721421914, -880.4044582012302, -510.23624097769374, -756.7596885822063, -750.503674906108, -970.4569044562797, -536.9133438307292, -969.1189538969094, -828.6557497044836, -921.1167522249553, -983.3273548465268, -786.8166913876576, -971.8472588541715, -839.0337560248918, -537.4573417131165, -736.6672726824571, -726.1648467480247, -703.5500142618337, -687.3754697981695, -1028.8533235816103, -1016.9399185373081, -547.7700884733886, -825.0141364721521, -854.5119491982765, -761.8485401322998, -645.2999114695314, -1132.127011384424, -832.7684630380427, -868.1055907336586, -1220.2179116393079, -568.5954218126869, -629.2427040522272, -778.7447216149754, -731.5489109251408, -809.0471153755772, -505.6045948871234, -724.7878642917971, -694.744406775047, -826.4270070378494, -820.173605473203, -768.5212560632556, -604.5459644699913, -749.0018730065776, -1025.864595518578, -769.7976833526562, -648.5470854658201, -721.529722719201, -740.6662003606299, -844.9133663279711, -760.7070604717552, -1111.1029768565718, -692.2693691598017, -663.3715201323328, -613.3569157791644, -712.7716736444878, -969.3761222584264, -682.1853674091266, -430.859253196766, -626.9057677676295, -394.174631242734, -881.8621199270841, -701.8105128347617, -571.5220785657247, -802.2847505080613, -778.1681600158208, -764.856613003843, -765.477687007436, -863.9423302498174, -588.7892968141871, -713.8304580899942, -921.8719907563013], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.33412430800594, "mean_inference_ms": 0.40859629711404993, "mean_action_processing_ms": 0.09662972950883027, "mean_env_wait_ms": 2.702109040773222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003932952880859375, "StateBufferConnector_ms": 0.002923727035522461, "ViewRequirementAgentConnector_ms": 0.07279133796691895}}, "episode_reward_max": -308.1558841359608, "episode_reward_min": -1302.0509621184951, "episode_reward_mean": -758.9185123977941, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-739.4105484160322, -959.4067956660626, -587.3315243529139, -743.8885608210755, -699.8833499917077, -950.5467068459807, -413.51370488978205, -621.2053737222399, -724.7038425344531, -308.1558841359608, -717.7591497649998, -934.4577679772444, -923.8105750860786, -800.3754143231071, -557.1646893174938, -590.0560258003314, -415.4778116010488, -816.1223866499049, -761.675271187059, -754.7688459926044, -500.8624242522775, -602.6506671710208, -877.1573800286106, -964.03430997962, -758.1048815117643, -909.6811484896951, -1302.0509621184951, -672.4262470296612, -774.2150450003941, -707.2905721421914, -880.4044582012302, -510.23624097769374, -756.7596885822063, -750.503674906108, -970.4569044562797, -536.9133438307292, -969.1189538969094, -828.6557497044836, -921.1167522249553, -983.3273548465268, -786.8166913876576, -971.8472588541715, -839.0337560248918, -537.4573417131165, -736.6672726824571, -726.1648467480247, -703.5500142618337, -687.3754697981695, -1028.8533235816103, -1016.9399185373081, -547.7700884733886, -825.0141364721521, -854.5119491982765, -761.8485401322998, -645.2999114695314, -1132.127011384424, -832.7684630380427, -868.1055907336586, -1220.2179116393079, -568.5954218126869, -629.2427040522272, -778.7447216149754, -731.5489109251408, -809.0471153755772, -505.6045948871234, -724.7878642917971, -694.744406775047, -826.4270070378494, -820.173605473203, -768.5212560632556, -604.5459644699913, -749.0018730065776, -1025.864595518578, -769.7976833526562, -648.5470854658201, -721.529722719201, -740.6662003606299, -844.9133663279711, -760.7070604717552, -1111.1029768565718, -692.2693691598017, -663.3715201323328, -613.3569157791644, -712.7716736444878, -969.3761222584264, -682.1853674091266, -430.859253196766, -626.9057677676295, -394.174631242734, -881.8621199270841, -701.8105128347617, -571.5220785657247, -802.2847505080613, -778.1681600158208, -764.856613003843, -765.477687007436, -863.9423302498174, -588.7892968141871, -713.8304580899942, -921.8719907563013], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.33412430800594, "mean_inference_ms": 0.40859629711404993, "mean_action_processing_ms": 0.09662972950883027, "mean_env_wait_ms": 2.702109040773222, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003932952880859375, "StateBufferConnector_ms": 0.002923727035522461, "ViewRequirementAgentConnector_ms": 0.07279133796691895}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 311520, "num_agent_steps_trained": 311520, "num_env_steps_sampled": 311520, "num_env_steps_trained": 311520, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.29447225656707, "num_env_steps_trained_throughput_per_sec": 40.29447225656707, "timesteps_total": 311520, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 311520, "timers": {"training_iteration_time_ms": 2979.501, "sample_time_ms": 2975.7, "load_time_ms": 0.217, "load_throughput": 552912.754, "learn_time_ms": 2.79, "learn_throughput": 43010.783, "synch_weights_time_ms": 0.753}, "counters": {"num_env_steps_sampled": 311520, "num_env_steps_trained": 311520, "num_agent_steps_sampled": 311520, "num_agent_steps_trained": 311520}, "done": false, "episodes_total": 2596, "training_iteration": 650, "trial_id": "53665_00000", "date": "2023-07-26_03-58-45", "timestamp": 1690333125, "time_this_iter_s": 11.914932012557983, "time_total_s": 7862.367839813232, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2241.042363882065, "iterations_since_restore": 190, "perf": {"cpu_util_percent": 42.95625, "ram_util_percent": 72.9375}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.45928955078125, "policy_loss": -70762.0390625, "vf_loss": 2365384.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 762.0, "diff_num_grad_updates_vs_sampler_policy": 761.0}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "sampler_results": {"episode_reward_max": -308.1558841359608, "episode_reward_min": -1302.0509621184951, "episode_reward_mean": -756.8387727683628, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-699.8833499917077, -950.5467068459807, -413.51370488978205, -621.2053737222399, -724.7038425344531, -308.1558841359608, -717.7591497649998, -934.4577679772444, -923.8105750860786, -800.3754143231071, -557.1646893174938, -590.0560258003314, -415.4778116010488, -816.1223866499049, -761.675271187059, -754.7688459926044, -500.8624242522775, -602.6506671710208, -877.1573800286106, -964.03430997962, -758.1048815117643, -909.6811484896951, -1302.0509621184951, -672.4262470296612, -774.2150450003941, -707.2905721421914, -880.4044582012302, -510.23624097769374, -756.7596885822063, -750.503674906108, -970.4569044562797, -536.9133438307292, -969.1189538969094, -828.6557497044836, -921.1167522249553, -983.3273548465268, -786.8166913876576, -971.8472588541715, -839.0337560248918, -537.4573417131165, -736.6672726824571, -726.1648467480247, -703.5500142618337, -687.3754697981695, -1028.8533235816103, -1016.9399185373081, -547.7700884733886, -825.0141364721521, -854.5119491982765, -761.8485401322998, -645.2999114695314, -1132.127011384424, -832.7684630380427, -868.1055907336586, -1220.2179116393079, -568.5954218126869, -629.2427040522272, -778.7447216149754, -731.5489109251408, -809.0471153755772, -505.6045948871234, -724.7878642917971, -694.744406775047, -826.4270070378494, -820.173605473203, -768.5212560632556, -604.5459644699913, -749.0018730065776, -1025.864595518578, -769.7976833526562, -648.5470854658201, -721.529722719201, -740.6662003606299, -844.9133663279711, -760.7070604717552, -1111.1029768565718, -692.2693691598017, -663.3715201323328, -613.3569157791644, -712.7716736444878, -969.3761222584264, -682.1853674091266, -430.859253196766, -626.9057677676295, -394.174631242734, -881.8621199270841, -701.8105128347617, -571.5220785657247, -802.2847505080613, -778.1681600158208, -764.856613003843, -765.477687007436, -863.9423302498174, -588.7892968141871, -713.8304580899942, -921.8719907563013, -515.9857948358177, -728.3332052937448, -1058.6597146773095, -519.0847515061027], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.334415169658296, "mean_inference_ms": 0.40865266926309685, "mean_action_processing_ms": 0.0966381005542975, "mean_env_wait_ms": 2.7019690860030035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003924131393432617, "StateBufferConnector_ms": 0.002928018569946289, "ViewRequirementAgentConnector_ms": 0.07276320457458496}}, "episode_reward_max": -308.1558841359608, "episode_reward_min": -1302.0509621184951, "episode_reward_mean": -756.8387727683628, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-699.8833499917077, -950.5467068459807, -413.51370488978205, -621.2053737222399, -724.7038425344531, -308.1558841359608, -717.7591497649998, -934.4577679772444, -923.8105750860786, -800.3754143231071, -557.1646893174938, -590.0560258003314, -415.4778116010488, -816.1223866499049, -761.675271187059, -754.7688459926044, -500.8624242522775, -602.6506671710208, -877.1573800286106, -964.03430997962, -758.1048815117643, -909.6811484896951, -1302.0509621184951, -672.4262470296612, -774.2150450003941, -707.2905721421914, -880.4044582012302, -510.23624097769374, -756.7596885822063, -750.503674906108, -970.4569044562797, -536.9133438307292, -969.1189538969094, -828.6557497044836, -921.1167522249553, -983.3273548465268, -786.8166913876576, -971.8472588541715, -839.0337560248918, -537.4573417131165, -736.6672726824571, -726.1648467480247, -703.5500142618337, -687.3754697981695, -1028.8533235816103, -1016.9399185373081, -547.7700884733886, -825.0141364721521, -854.5119491982765, -761.8485401322998, -645.2999114695314, -1132.127011384424, -832.7684630380427, -868.1055907336586, -1220.2179116393079, -568.5954218126869, -629.2427040522272, -778.7447216149754, -731.5489109251408, -809.0471153755772, -505.6045948871234, -724.7878642917971, -694.744406775047, -826.4270070378494, -820.173605473203, -768.5212560632556, -604.5459644699913, -749.0018730065776, -1025.864595518578, -769.7976833526562, -648.5470854658201, -721.529722719201, -740.6662003606299, -844.9133663279711, -760.7070604717552, -1111.1029768565718, -692.2693691598017, -663.3715201323328, -613.3569157791644, -712.7716736444878, -969.3761222584264, -682.1853674091266, -430.859253196766, -626.9057677676295, -394.174631242734, -881.8621199270841, -701.8105128347617, -571.5220785657247, -802.2847505080613, -778.1681600158208, -764.856613003843, -765.477687007436, -863.9423302498174, -588.7892968141871, -713.8304580899942, -921.8719907563013, -515.9857948358177, -728.3332052937448, -1058.6597146773095, -519.0847515061027], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.334415169658296, "mean_inference_ms": 0.40865266926309685, "mean_action_processing_ms": 0.0966381005542975, "mean_env_wait_ms": 2.7019690860030035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003924131393432617, "StateBufferConnector_ms": 0.002928018569946289, "ViewRequirementAgentConnector_ms": 0.07276320457458496}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.754789123038165, "num_env_steps_trained_throughput_per_sec": 40.754789123038165, "timesteps_total": 312000, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 312000, "timers": {"training_iteration_time_ms": 2959.943, "sample_time_ms": 2956.167, "load_time_ms": 0.215, "load_throughput": 558248.092, "learn_time_ms": 2.791, "learn_throughput": 42989.108, "synch_weights_time_ms": 0.73}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "done": false, "episodes_total": 2600, "training_iteration": 651, "trial_id": "53665_00000", "date": "2023-07-26_03-58-56", "timestamp": 1690333136, "time_this_iter_s": 11.780860900878906, "time_total_s": 7874.148700714111, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2252.8232247829437, "iterations_since_restore": 191, "perf": {"cpu_util_percent": 38.188235294117646, "ram_util_percent": 72.5764705882353}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4747619628906, "policy_loss": -92083.5078125, "vf_loss": 4085312.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 766.0, "diff_num_grad_updates_vs_sampler_policy": 765.0}}, "num_env_steps_sampled": 312480, "num_env_steps_trained": 312480, "num_agent_steps_sampled": 312480, "num_agent_steps_trained": 312480}, "sampler_results": {"episode_reward_max": -308.1558841359608, "episode_reward_min": -1302.0509621184951, "episode_reward_mean": -761.5240889176785, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-724.7038425344531, -308.1558841359608, -717.7591497649998, -934.4577679772444, -923.8105750860786, -800.3754143231071, -557.1646893174938, -590.0560258003314, -415.4778116010488, -816.1223866499049, -761.675271187059, -754.7688459926044, -500.8624242522775, -602.6506671710208, -877.1573800286106, -964.03430997962, -758.1048815117643, -909.6811484896951, -1302.0509621184951, -672.4262470296612, -774.2150450003941, -707.2905721421914, -880.4044582012302, -510.23624097769374, -756.7596885822063, -750.503674906108, -970.4569044562797, -536.9133438307292, -969.1189538969094, -828.6557497044836, -921.1167522249553, -983.3273548465268, -786.8166913876576, -971.8472588541715, -839.0337560248918, -537.4573417131165, -736.6672726824571, -726.1648467480247, -703.5500142618337, -687.3754697981695, -1028.8533235816103, -1016.9399185373081, -547.7700884733886, -825.0141364721521, -854.5119491982765, -761.8485401322998, -645.2999114695314, -1132.127011384424, -832.7684630380427, -868.1055907336586, -1220.2179116393079, -568.5954218126869, -629.2427040522272, -778.7447216149754, -731.5489109251408, -809.0471153755772, -505.6045948871234, -724.7878642917971, -694.744406775047, -826.4270070378494, -820.173605473203, -768.5212560632556, -604.5459644699913, -749.0018730065776, -1025.864595518578, -769.7976833526562, -648.5470854658201, -721.529722719201, -740.6662003606299, -844.9133663279711, -760.7070604717552, -1111.1029768565718, -692.2693691598017, -663.3715201323328, -613.3569157791644, -712.7716736444878, -969.3761222584264, -682.1853674091266, -430.859253196766, -626.9057677676295, -394.174631242734, -881.8621199270841, -701.8105128347617, -571.5220785657247, -802.2847505080613, -778.1681600158208, -764.856613003843, -765.477687007436, -863.9423302498174, -588.7892968141871, -713.8304580899942, -921.8719907563013, -515.9857948358177, -728.3332052937448, -1058.6597146773095, -519.0847515061027, -800.501593661656, -733.5674465909572, -843.7243069065254, -775.8874032221368], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.3347502234058, "mean_inference_ms": 0.40870432848693894, "mean_action_processing_ms": 0.0966456926437771, "mean_env_wait_ms": 2.7018263795913993, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003913402557373047, "StateBufferConnector_ms": 0.0029230117797851562, "ViewRequirementAgentConnector_ms": 0.0726935863494873}}, "episode_reward_max": -308.1558841359608, "episode_reward_min": -1302.0509621184951, "episode_reward_mean": -761.5240889176785, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-724.7038425344531, -308.1558841359608, -717.7591497649998, -934.4577679772444, -923.8105750860786, -800.3754143231071, -557.1646893174938, -590.0560258003314, -415.4778116010488, -816.1223866499049, -761.675271187059, -754.7688459926044, -500.8624242522775, -602.6506671710208, -877.1573800286106, -964.03430997962, -758.1048815117643, -909.6811484896951, -1302.0509621184951, -672.4262470296612, -774.2150450003941, -707.2905721421914, -880.4044582012302, -510.23624097769374, -756.7596885822063, -750.503674906108, -970.4569044562797, -536.9133438307292, -969.1189538969094, -828.6557497044836, -921.1167522249553, -983.3273548465268, -786.8166913876576, -971.8472588541715, -839.0337560248918, -537.4573417131165, -736.6672726824571, -726.1648467480247, -703.5500142618337, -687.3754697981695, -1028.8533235816103, -1016.9399185373081, -547.7700884733886, -825.0141364721521, -854.5119491982765, -761.8485401322998, -645.2999114695314, -1132.127011384424, -832.7684630380427, -868.1055907336586, -1220.2179116393079, -568.5954218126869, -629.2427040522272, -778.7447216149754, -731.5489109251408, -809.0471153755772, -505.6045948871234, -724.7878642917971, -694.744406775047, -826.4270070378494, -820.173605473203, -768.5212560632556, -604.5459644699913, -749.0018730065776, -1025.864595518578, -769.7976833526562, -648.5470854658201, -721.529722719201, -740.6662003606299, -844.9133663279711, -760.7070604717552, -1111.1029768565718, -692.2693691598017, -663.3715201323328, -613.3569157791644, -712.7716736444878, -969.3761222584264, -682.1853674091266, -430.859253196766, -626.9057677676295, -394.174631242734, -881.8621199270841, -701.8105128347617, -571.5220785657247, -802.2847505080613, -778.1681600158208, -764.856613003843, -765.477687007436, -863.9423302498174, -588.7892968141871, -713.8304580899942, -921.8719907563013, -515.9857948358177, -728.3332052937448, -1058.6597146773095, -519.0847515061027, -800.501593661656, -733.5674465909572, -843.7243069065254, -775.8874032221368], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.3347502234058, "mean_inference_ms": 0.40870432848693894, "mean_action_processing_ms": 0.0966456926437771, "mean_env_wait_ms": 2.7018263795913993, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003913402557373047, "StateBufferConnector_ms": 0.0029230117797851562, "ViewRequirementAgentConnector_ms": 0.0726935863494873}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312480, "num_agent_steps_trained": 312480, "num_env_steps_sampled": 312480, "num_env_steps_trained": 312480, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.46601667195651, "num_env_steps_trained_throughput_per_sec": 41.46601667195651, "timesteps_total": 312480, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 312480, "timers": {"training_iteration_time_ms": 2927.664, "sample_time_ms": 2923.909, "load_time_ms": 0.214, "load_throughput": 560111.818, "learn_time_ms": 2.794, "learn_throughput": 42951.689, "synch_weights_time_ms": 0.708}, "counters": {"num_env_steps_sampled": 312480, "num_env_steps_trained": 312480, "num_agent_steps_sampled": 312480, "num_agent_steps_trained": 312480}, "done": false, "episodes_total": 2604, "training_iteration": 652, "trial_id": "53665_00000", "date": "2023-07-26_03-59-08", "timestamp": 1690333148, "time_this_iter_s": 11.578354835510254, "time_total_s": 7885.727055549622, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2264.401579618454, "iterations_since_restore": 192, "perf": {"cpu_util_percent": 36.3235294117647, "ram_util_percent": 71.57058823529412}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4649963378906, "policy_loss": -53091.515625, "vf_loss": 1417440.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 770.0, "diff_num_grad_updates_vs_sampler_policy": 769.0}}, "num_env_steps_sampled": 312960, "num_env_steps_trained": 312960, "num_agent_steps_sampled": 312960, "num_agent_steps_trained": 312960}, "sampler_results": {"episode_reward_max": -394.174631242734, "episode_reward_min": -1302.0509621184951, "episode_reward_mean": -755.6502715111347, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-923.8105750860786, -800.3754143231071, -557.1646893174938, -590.0560258003314, -415.4778116010488, -816.1223866499049, -761.675271187059, -754.7688459926044, -500.8624242522775, -602.6506671710208, -877.1573800286106, -964.03430997962, -758.1048815117643, -909.6811484896951, -1302.0509621184951, -672.4262470296612, -774.2150450003941, -707.2905721421914, -880.4044582012302, -510.23624097769374, -756.7596885822063, -750.503674906108, -970.4569044562797, -536.9133438307292, -969.1189538969094, -828.6557497044836, -921.1167522249553, -983.3273548465268, -786.8166913876576, -971.8472588541715, -839.0337560248918, -537.4573417131165, -736.6672726824571, -726.1648467480247, -703.5500142618337, -687.3754697981695, -1028.8533235816103, -1016.9399185373081, -547.7700884733886, -825.0141364721521, -854.5119491982765, -761.8485401322998, -645.2999114695314, -1132.127011384424, -832.7684630380427, -868.1055907336586, -1220.2179116393079, -568.5954218126869, -629.2427040522272, -778.7447216149754, -731.5489109251408, -809.0471153755772, -505.6045948871234, -724.7878642917971, -694.744406775047, -826.4270070378494, -820.173605473203, -768.5212560632556, -604.5459644699913, -749.0018730065776, -1025.864595518578, -769.7976833526562, -648.5470854658201, -721.529722719201, -740.6662003606299, -844.9133663279711, -760.7070604717552, -1111.1029768565718, -692.2693691598017, -663.3715201323328, -613.3569157791644, -712.7716736444878, -969.3761222584264, -682.1853674091266, -430.859253196766, -626.9057677676295, -394.174631242734, -881.8621199270841, -701.8105128347617, -571.5220785657247, -802.2847505080613, -778.1681600158208, -764.856613003843, -765.477687007436, -863.9423302498174, -588.7892968141871, -713.8304580899942, -921.8719907563013, -515.9857948358177, -728.3332052937448, -1058.6597146773095, -519.0847515061027, -800.501593661656, -733.5674465909572, -843.7243069065254, -775.8874032221368, -492.42814381428286, -510.1217799759738, -674.2841542415847, -420.860825726447], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.335276182797717, "mean_inference_ms": 0.4087757112760677, "mean_action_processing_ms": 0.09665659181486685, "mean_env_wait_ms": 2.7017490758541873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003966808319091797, "StateBufferConnector_ms": 0.0029718875885009766, "ViewRequirementAgentConnector_ms": 0.07376217842102051}}, "episode_reward_max": -394.174631242734, "episode_reward_min": -1302.0509621184951, "episode_reward_mean": -755.6502715111347, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-923.8105750860786, -800.3754143231071, -557.1646893174938, -590.0560258003314, -415.4778116010488, -816.1223866499049, -761.675271187059, -754.7688459926044, -500.8624242522775, -602.6506671710208, -877.1573800286106, -964.03430997962, -758.1048815117643, -909.6811484896951, -1302.0509621184951, -672.4262470296612, -774.2150450003941, -707.2905721421914, -880.4044582012302, -510.23624097769374, -756.7596885822063, -750.503674906108, -970.4569044562797, -536.9133438307292, -969.1189538969094, -828.6557497044836, -921.1167522249553, -983.3273548465268, -786.8166913876576, -971.8472588541715, -839.0337560248918, -537.4573417131165, -736.6672726824571, -726.1648467480247, -703.5500142618337, -687.3754697981695, -1028.8533235816103, -1016.9399185373081, -547.7700884733886, -825.0141364721521, -854.5119491982765, -761.8485401322998, -645.2999114695314, -1132.127011384424, -832.7684630380427, -868.1055907336586, -1220.2179116393079, -568.5954218126869, -629.2427040522272, -778.7447216149754, -731.5489109251408, -809.0471153755772, -505.6045948871234, -724.7878642917971, -694.744406775047, -826.4270070378494, -820.173605473203, -768.5212560632556, -604.5459644699913, -749.0018730065776, -1025.864595518578, -769.7976833526562, -648.5470854658201, -721.529722719201, -740.6662003606299, -844.9133663279711, -760.7070604717552, -1111.1029768565718, -692.2693691598017, -663.3715201323328, -613.3569157791644, -712.7716736444878, -969.3761222584264, -682.1853674091266, -430.859253196766, -626.9057677676295, -394.174631242734, -881.8621199270841, -701.8105128347617, -571.5220785657247, -802.2847505080613, -778.1681600158208, -764.856613003843, -765.477687007436, -863.9423302498174, -588.7892968141871, -713.8304580899942, -921.8719907563013, -515.9857948358177, -728.3332052937448, -1058.6597146773095, -519.0847515061027, -800.501593661656, -733.5674465909572, -843.7243069065254, -775.8874032221368, -492.42814381428286, -510.1217799759738, -674.2841542415847, -420.860825726447], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.335276182797717, "mean_inference_ms": 0.4087757112760677, "mean_action_processing_ms": 0.09665659181486685, "mean_env_wait_ms": 2.7017490758541873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003966808319091797, "StateBufferConnector_ms": 0.0029718875885009766, "ViewRequirementAgentConnector_ms": 0.07376217842102051}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312960, "num_agent_steps_trained": 312960, "num_env_steps_sampled": 312960, "num_env_steps_trained": 312960, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.59168944866603, "num_env_steps_trained_throughput_per_sec": 38.59168944866603, "timesteps_total": 312960, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 312960, "timers": {"training_iteration_time_ms": 2990.597, "sample_time_ms": 2986.775, "load_time_ms": 0.219, "load_throughput": 547380.62, "learn_time_ms": 2.84, "learn_throughput": 42250.412, "synch_weights_time_ms": 0.721}, "counters": {"num_env_steps_sampled": 312960, "num_env_steps_trained": 312960, "num_agent_steps_sampled": 312960, "num_agent_steps_trained": 312960}, "done": false, "episodes_total": 2608, "training_iteration": 653, "trial_id": "53665_00000", "date": "2023-07-26_03-59-20", "timestamp": 1690333160, "time_this_iter_s": 12.440831184387207, "time_total_s": 7898.167886734009, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2276.842410802841, "iterations_since_restore": 193, "perf": {"cpu_util_percent": 44.34117647058824, "ram_util_percent": 73.48823529411764}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.491943359375, "policy_loss": -141473.0625, "vf_loss": 8427352.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 774.0, "diff_num_grad_updates_vs_sampler_policy": 773.0}}, "num_env_steps_sampled": 313440, "num_env_steps_trained": 313440, "num_agent_steps_sampled": 313440, "num_agent_steps_trained": 313440}, "sampler_results": {"episode_reward_max": -322.71637248421234, "episode_reward_min": -1302.0509621184951, "episode_reward_mean": -755.2985032637074, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-415.4778116010488, -816.1223866499049, -761.675271187059, -754.7688459926044, -500.8624242522775, -602.6506671710208, -877.1573800286106, -964.03430997962, -758.1048815117643, -909.6811484896951, -1302.0509621184951, -672.4262470296612, -774.2150450003941, -707.2905721421914, -880.4044582012302, -510.23624097769374, -756.7596885822063, -750.503674906108, -970.4569044562797, -536.9133438307292, -969.1189538969094, -828.6557497044836, -921.1167522249553, -983.3273548465268, -786.8166913876576, -971.8472588541715, -839.0337560248918, -537.4573417131165, -736.6672726824571, -726.1648467480247, -703.5500142618337, -687.3754697981695, -1028.8533235816103, -1016.9399185373081, -547.7700884733886, -825.0141364721521, -854.5119491982765, -761.8485401322998, -645.2999114695314, -1132.127011384424, -832.7684630380427, -868.1055907336586, -1220.2179116393079, -568.5954218126869, -629.2427040522272, -778.7447216149754, -731.5489109251408, -809.0471153755772, -505.6045948871234, -724.7878642917971, -694.744406775047, -826.4270070378494, -820.173605473203, -768.5212560632556, -604.5459644699913, -749.0018730065776, -1025.864595518578, -769.7976833526562, -648.5470854658201, -721.529722719201, -740.6662003606299, -844.9133663279711, -760.7070604717552, -1111.1029768565718, -692.2693691598017, -663.3715201323328, -613.3569157791644, -712.7716736444878, -969.3761222584264, -682.1853674091266, -430.859253196766, -626.9057677676295, -394.174631242734, -881.8621199270841, -701.8105128347617, -571.5220785657247, -802.2847505080613, -778.1681600158208, -764.856613003843, -765.477687007436, -863.9423302498174, -588.7892968141871, -713.8304580899942, -921.8719907563013, -515.9857948358177, -728.3332052937448, -1058.6597146773095, -519.0847515061027, -800.501593661656, -733.5674465909572, -843.7243069065254, -775.8874032221368, -492.42814381428286, -510.1217799759738, -674.2841542415847, -420.860825726447, -803.962597155909, -641.1798927495181, -322.71637248421234, -1068.3710173946247], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.335822320588132, "mean_inference_ms": 0.40883666609646085, "mean_action_processing_ms": 0.09666669461194961, "mean_env_wait_ms": 2.7016806666875977, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003962516784667969, "StateBufferConnector_ms": 0.0029692649841308594, "ViewRequirementAgentConnector_ms": 0.07364201545715332}}, "episode_reward_max": -322.71637248421234, "episode_reward_min": -1302.0509621184951, "episode_reward_mean": -755.2985032637074, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-415.4778116010488, -816.1223866499049, -761.675271187059, -754.7688459926044, -500.8624242522775, -602.6506671710208, -877.1573800286106, -964.03430997962, -758.1048815117643, -909.6811484896951, -1302.0509621184951, -672.4262470296612, -774.2150450003941, -707.2905721421914, -880.4044582012302, -510.23624097769374, -756.7596885822063, -750.503674906108, -970.4569044562797, -536.9133438307292, -969.1189538969094, -828.6557497044836, -921.1167522249553, -983.3273548465268, -786.8166913876576, -971.8472588541715, -839.0337560248918, -537.4573417131165, -736.6672726824571, -726.1648467480247, -703.5500142618337, -687.3754697981695, -1028.8533235816103, -1016.9399185373081, -547.7700884733886, -825.0141364721521, -854.5119491982765, -761.8485401322998, -645.2999114695314, -1132.127011384424, -832.7684630380427, -868.1055907336586, -1220.2179116393079, -568.5954218126869, -629.2427040522272, -778.7447216149754, -731.5489109251408, -809.0471153755772, -505.6045948871234, -724.7878642917971, -694.744406775047, -826.4270070378494, -820.173605473203, -768.5212560632556, -604.5459644699913, -749.0018730065776, -1025.864595518578, -769.7976833526562, -648.5470854658201, -721.529722719201, -740.6662003606299, -844.9133663279711, -760.7070604717552, -1111.1029768565718, -692.2693691598017, -663.3715201323328, -613.3569157791644, -712.7716736444878, -969.3761222584264, -682.1853674091266, -430.859253196766, -626.9057677676295, -394.174631242734, -881.8621199270841, -701.8105128347617, -571.5220785657247, -802.2847505080613, -778.1681600158208, -764.856613003843, -765.477687007436, -863.9423302498174, -588.7892968141871, -713.8304580899942, -921.8719907563013, -515.9857948358177, -728.3332052937448, -1058.6597146773095, -519.0847515061027, -800.501593661656, -733.5674465909572, -843.7243069065254, -775.8874032221368, -492.42814381428286, -510.1217799759738, -674.2841542415847, -420.860825726447, -803.962597155909, -641.1798927495181, -322.71637248421234, -1068.3710173946247], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.335822320588132, "mean_inference_ms": 0.40883666609646085, "mean_action_processing_ms": 0.09666669461194961, "mean_env_wait_ms": 2.7016806666875977, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003962516784667969, "StateBufferConnector_ms": 0.0029692649841308594, "ViewRequirementAgentConnector_ms": 0.07364201545715332}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 313440, "num_agent_steps_trained": 313440, "num_env_steps_sampled": 313440, "num_env_steps_trained": 313440, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.140723987143474, "num_env_steps_trained_throughput_per_sec": 39.140723987143474, "timesteps_total": 313440, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 313440, "timers": {"training_iteration_time_ms": 3055.543, "sample_time_ms": 3051.164, "load_time_ms": 0.263, "load_throughput": 455778.756, "learn_time_ms": 3.241, "learn_throughput": 37025.172, "synch_weights_time_ms": 0.806}, "counters": {"num_env_steps_sampled": 313440, "num_env_steps_trained": 313440, "num_agent_steps_sampled": 313440, "num_agent_steps_trained": 313440}, "done": false, "episodes_total": 2612, "training_iteration": 654, "trial_id": "53665_00000", "date": "2023-07-26_03-59-33", "timestamp": 1690333173, "time_this_iter_s": 12.266624212265015, "time_total_s": 7910.434510946274, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2289.109035015106, "iterations_since_restore": 194, "perf": {"cpu_util_percent": 45.59444444444445, "ram_util_percent": 73.77222222222221}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4864807128906, "policy_loss": -128159.8359375, "vf_loss": 8311563.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 778.0, "diff_num_grad_updates_vs_sampler_policy": 777.0}}, "num_env_steps_sampled": 313920, "num_env_steps_trained": 313920, "num_agent_steps_sampled": 313920, "num_agent_steps_trained": 313920}, "sampler_results": {"episode_reward_max": -322.71637248421234, "episode_reward_min": -1302.0509621184951, "episode_reward_mean": -761.996002914208, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-500.8624242522775, -602.6506671710208, -877.1573800286106, -964.03430997962, -758.1048815117643, -909.6811484896951, -1302.0509621184951, -672.4262470296612, -774.2150450003941, -707.2905721421914, -880.4044582012302, -510.23624097769374, -756.7596885822063, -750.503674906108, -970.4569044562797, -536.9133438307292, -969.1189538969094, -828.6557497044836, -921.1167522249553, -983.3273548465268, -786.8166913876576, -971.8472588541715, -839.0337560248918, -537.4573417131165, -736.6672726824571, -726.1648467480247, -703.5500142618337, -687.3754697981695, -1028.8533235816103, -1016.9399185373081, -547.7700884733886, -825.0141364721521, -854.5119491982765, -761.8485401322998, -645.2999114695314, -1132.127011384424, -832.7684630380427, -868.1055907336586, -1220.2179116393079, -568.5954218126869, -629.2427040522272, -778.7447216149754, -731.5489109251408, -809.0471153755772, -505.6045948871234, -724.7878642917971, -694.744406775047, -826.4270070378494, -820.173605473203, -768.5212560632556, -604.5459644699913, -749.0018730065776, -1025.864595518578, -769.7976833526562, -648.5470854658201, -721.529722719201, -740.6662003606299, -844.9133663279711, -760.7070604717552, -1111.1029768565718, -692.2693691598017, -663.3715201323328, -613.3569157791644, -712.7716736444878, -969.3761222584264, -682.1853674091266, -430.859253196766, -626.9057677676295, -394.174631242734, -881.8621199270841, -701.8105128347617, -571.5220785657247, -802.2847505080613, -778.1681600158208, -764.856613003843, -765.477687007436, -863.9423302498174, -588.7892968141871, -713.8304580899942, -921.8719907563013, -515.9857948358177, -728.3332052937448, -1058.6597146773095, -519.0847515061027, -800.501593661656, -733.5674465909572, -843.7243069065254, -775.8874032221368, -492.42814381428286, -510.1217799759738, -674.2841542415847, -420.860825726447, -803.962597155909, -641.1798927495181, -322.71637248421234, -1068.3710173946247, -783.8140081094656, -778.1751815208966, -749.5082392107654, -1106.2968516395651], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.336359112254577, "mean_inference_ms": 0.4089061221623533, "mean_action_processing_ms": 0.09667848223698483, "mean_env_wait_ms": 2.7016346822063313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003981351852416992, "StateBufferConnector_ms": 0.002981424331665039, "ViewRequirementAgentConnector_ms": 0.07406115531921387}}, "episode_reward_max": -322.71637248421234, "episode_reward_min": -1302.0509621184951, "episode_reward_mean": -761.996002914208, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-500.8624242522775, -602.6506671710208, -877.1573800286106, -964.03430997962, -758.1048815117643, -909.6811484896951, -1302.0509621184951, -672.4262470296612, -774.2150450003941, -707.2905721421914, -880.4044582012302, -510.23624097769374, -756.7596885822063, -750.503674906108, -970.4569044562797, -536.9133438307292, -969.1189538969094, -828.6557497044836, -921.1167522249553, -983.3273548465268, -786.8166913876576, -971.8472588541715, -839.0337560248918, -537.4573417131165, -736.6672726824571, -726.1648467480247, -703.5500142618337, -687.3754697981695, -1028.8533235816103, -1016.9399185373081, -547.7700884733886, -825.0141364721521, -854.5119491982765, -761.8485401322998, -645.2999114695314, -1132.127011384424, -832.7684630380427, -868.1055907336586, -1220.2179116393079, -568.5954218126869, -629.2427040522272, -778.7447216149754, -731.5489109251408, -809.0471153755772, -505.6045948871234, -724.7878642917971, -694.744406775047, -826.4270070378494, -820.173605473203, -768.5212560632556, -604.5459644699913, -749.0018730065776, -1025.864595518578, -769.7976833526562, -648.5470854658201, -721.529722719201, -740.6662003606299, -844.9133663279711, -760.7070604717552, -1111.1029768565718, -692.2693691598017, -663.3715201323328, -613.3569157791644, -712.7716736444878, -969.3761222584264, -682.1853674091266, -430.859253196766, -626.9057677676295, -394.174631242734, -881.8621199270841, -701.8105128347617, -571.5220785657247, -802.2847505080613, -778.1681600158208, -764.856613003843, -765.477687007436, -863.9423302498174, -588.7892968141871, -713.8304580899942, -921.8719907563013, -515.9857948358177, -728.3332052937448, -1058.6597146773095, -519.0847515061027, -800.501593661656, -733.5674465909572, -843.7243069065254, -775.8874032221368, -492.42814381428286, -510.1217799759738, -674.2841542415847, -420.860825726447, -803.962597155909, -641.1798927495181, -322.71637248421234, -1068.3710173946247, -783.8140081094656, -778.1751815208966, -749.5082392107654, -1106.2968516395651], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.336359112254577, "mean_inference_ms": 0.4089061221623533, "mean_action_processing_ms": 0.09667848223698483, "mean_env_wait_ms": 2.7016346822063313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003981351852416992, "StateBufferConnector_ms": 0.002981424331665039, "ViewRequirementAgentConnector_ms": 0.07406115531921387}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 313920, "num_agent_steps_trained": 313920, "num_env_steps_sampled": 313920, "num_env_steps_trained": 313920, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.27621392139002, "num_env_steps_trained_throughput_per_sec": 40.27621392139002, "timesteps_total": 313920, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 313920, "timers": {"training_iteration_time_ms": 3066.563, "sample_time_ms": 3062.138, "load_time_ms": 0.262, "load_throughput": 457477.259, "learn_time_ms": 3.27, "learn_throughput": 36697.446, "synch_weights_time_ms": 0.823}, "counters": {"num_env_steps_sampled": 313920, "num_env_steps_trained": 313920, "num_agent_steps_sampled": 313920, "num_agent_steps_trained": 313920}, "done": false, "episodes_total": 2616, "training_iteration": 655, "trial_id": "53665_00000", "date": "2023-07-26_03-59-45", "timestamp": 1690333185, "time_this_iter_s": 11.920408248901367, "time_total_s": 7922.354919195175, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2301.0294432640076, "iterations_since_restore": 195, "perf": {"cpu_util_percent": 48.94705882352941, "ram_util_percent": 74.95882352941177}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.481689453125, "policy_loss": -112121.1484375, "vf_loss": 6352884.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 782.0, "diff_num_grad_updates_vs_sampler_policy": 781.0}}, "num_env_steps_sampled": 314400, "num_env_steps_trained": 314400, "num_agent_steps_sampled": 314400, "num_agent_steps_trained": 314400}, "sampler_results": {"episode_reward_max": -322.71637248421234, "episode_reward_min": -1302.0509621184951, "episode_reward_mean": -757.1713094439878, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-758.1048815117643, -909.6811484896951, -1302.0509621184951, -672.4262470296612, -774.2150450003941, -707.2905721421914, -880.4044582012302, -510.23624097769374, -756.7596885822063, -750.503674906108, -970.4569044562797, -536.9133438307292, -969.1189538969094, -828.6557497044836, -921.1167522249553, -983.3273548465268, -786.8166913876576, -971.8472588541715, -839.0337560248918, -537.4573417131165, -736.6672726824571, -726.1648467480247, -703.5500142618337, -687.3754697981695, -1028.8533235816103, -1016.9399185373081, -547.7700884733886, -825.0141364721521, -854.5119491982765, -761.8485401322998, -645.2999114695314, -1132.127011384424, -832.7684630380427, -868.1055907336586, -1220.2179116393079, -568.5954218126869, -629.2427040522272, -778.7447216149754, -731.5489109251408, -809.0471153755772, -505.6045948871234, -724.7878642917971, -694.744406775047, -826.4270070378494, -820.173605473203, -768.5212560632556, -604.5459644699913, -749.0018730065776, -1025.864595518578, -769.7976833526562, -648.5470854658201, -721.529722719201, -740.6662003606299, -844.9133663279711, -760.7070604717552, -1111.1029768565718, -692.2693691598017, -663.3715201323328, -613.3569157791644, -712.7716736444878, -969.3761222584264, -682.1853674091266, -430.859253196766, -626.9057677676295, -394.174631242734, -881.8621199270841, -701.8105128347617, -571.5220785657247, -802.2847505080613, -778.1681600158208, -764.856613003843, -765.477687007436, -863.9423302498174, -588.7892968141871, -713.8304580899942, -921.8719907563013, -515.9857948358177, -728.3332052937448, -1058.6597146773095, -519.0847515061027, -800.501593661656, -733.5674465909572, -843.7243069065254, -775.8874032221368, -492.42814381428286, -510.1217799759738, -674.2841542415847, -420.860825726447, -803.962597155909, -641.1798927495181, -322.71637248421234, -1068.3710173946247, -783.8140081094656, -778.1751815208966, -749.5082392107654, -1106.2968516395651, -716.1747253111616, -431.89278021635204, -510.7795792231949, -803.3883496587829], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.336980221576834, "mean_inference_ms": 0.4089768986117088, "mean_action_processing_ms": 0.0966905907672587, "mean_env_wait_ms": 2.7015617441503514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003983259201049805, "StateBufferConnector_ms": 0.0029845237731933594, "ViewRequirementAgentConnector_ms": 0.07403850555419922}}, "episode_reward_max": -322.71637248421234, "episode_reward_min": -1302.0509621184951, "episode_reward_mean": -757.1713094439878, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-758.1048815117643, -909.6811484896951, -1302.0509621184951, -672.4262470296612, -774.2150450003941, -707.2905721421914, -880.4044582012302, -510.23624097769374, -756.7596885822063, -750.503674906108, -970.4569044562797, -536.9133438307292, -969.1189538969094, -828.6557497044836, -921.1167522249553, -983.3273548465268, -786.8166913876576, -971.8472588541715, -839.0337560248918, -537.4573417131165, -736.6672726824571, -726.1648467480247, -703.5500142618337, -687.3754697981695, -1028.8533235816103, -1016.9399185373081, -547.7700884733886, -825.0141364721521, -854.5119491982765, -761.8485401322998, -645.2999114695314, -1132.127011384424, -832.7684630380427, -868.1055907336586, -1220.2179116393079, -568.5954218126869, -629.2427040522272, -778.7447216149754, -731.5489109251408, -809.0471153755772, -505.6045948871234, -724.7878642917971, -694.744406775047, -826.4270070378494, -820.173605473203, -768.5212560632556, -604.5459644699913, -749.0018730065776, -1025.864595518578, -769.7976833526562, -648.5470854658201, -721.529722719201, -740.6662003606299, -844.9133663279711, -760.7070604717552, -1111.1029768565718, -692.2693691598017, -663.3715201323328, -613.3569157791644, -712.7716736444878, -969.3761222584264, -682.1853674091266, -430.859253196766, -626.9057677676295, -394.174631242734, -881.8621199270841, -701.8105128347617, -571.5220785657247, -802.2847505080613, -778.1681600158208, -764.856613003843, -765.477687007436, -863.9423302498174, -588.7892968141871, -713.8304580899942, -921.8719907563013, -515.9857948358177, -728.3332052937448, -1058.6597146773095, -519.0847515061027, -800.501593661656, -733.5674465909572, -843.7243069065254, -775.8874032221368, -492.42814381428286, -510.1217799759738, -674.2841542415847, -420.860825726447, -803.962597155909, -641.1798927495181, -322.71637248421234, -1068.3710173946247, -783.8140081094656, -778.1751815208966, -749.5082392107654, -1106.2968516395651, -716.1747253111616, -431.89278021635204, -510.7795792231949, -803.3883496587829], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.336980221576834, "mean_inference_ms": 0.4089768986117088, "mean_action_processing_ms": 0.0966905907672587, "mean_env_wait_ms": 2.7015617441503514, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003983259201049805, "StateBufferConnector_ms": 0.0029845237731933594, "ViewRequirementAgentConnector_ms": 0.07403850555419922}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 314400, "num_agent_steps_trained": 314400, "num_env_steps_sampled": 314400, "num_env_steps_trained": 314400, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.960710012307345, "num_env_steps_trained_throughput_per_sec": 40.960710012307345, "timesteps_total": 314400, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 314400, "timers": {"training_iteration_time_ms": 2995.385, "sample_time_ms": 2991.434, "load_time_ms": 0.222, "load_throughput": 539923.278, "learn_time_ms": 2.938, "learn_throughput": 40842.67, "synch_weights_time_ms": 0.749}, "counters": {"num_env_steps_sampled": 314400, "num_env_steps_trained": 314400, "num_agent_steps_sampled": 314400, "num_agent_steps_trained": 314400}, "done": false, "episodes_total": 2620, "training_iteration": 656, "trial_id": "53665_00000", "date": "2023-07-26_03-59-56", "timestamp": 1690333196, "time_this_iter_s": 11.721643924713135, "time_total_s": 7934.076563119888, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2312.7510871887207, "iterations_since_restore": 196, "perf": {"cpu_util_percent": 38.71176470588235, "ram_util_percent": 73.01176470588234}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4809265136719, "policy_loss": -95577.125, "vf_loss": 4170066.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 786.0, "diff_num_grad_updates_vs_sampler_policy": 785.0}}, "num_env_steps_sampled": 314880, "num_env_steps_trained": 314880, "num_agent_steps_sampled": 314880, "num_agent_steps_trained": 314880}, "sampler_results": {"episode_reward_max": -322.71637248421234, "episode_reward_min": -1220.2179116393079, "episode_reward_mean": -753.5216536180831, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-774.2150450003941, -707.2905721421914, -880.4044582012302, -510.23624097769374, -756.7596885822063, -750.503674906108, -970.4569044562797, -536.9133438307292, -969.1189538969094, -828.6557497044836, -921.1167522249553, -983.3273548465268, -786.8166913876576, -971.8472588541715, -839.0337560248918, -537.4573417131165, -736.6672726824571, -726.1648467480247, -703.5500142618337, -687.3754697981695, -1028.8533235816103, -1016.9399185373081, -547.7700884733886, -825.0141364721521, -854.5119491982765, -761.8485401322998, -645.2999114695314, -1132.127011384424, -832.7684630380427, -868.1055907336586, -1220.2179116393079, -568.5954218126869, -629.2427040522272, -778.7447216149754, -731.5489109251408, -809.0471153755772, -505.6045948871234, -724.7878642917971, -694.744406775047, -826.4270070378494, -820.173605473203, -768.5212560632556, -604.5459644699913, -749.0018730065776, -1025.864595518578, -769.7976833526562, -648.5470854658201, -721.529722719201, -740.6662003606299, -844.9133663279711, -760.7070604717552, -1111.1029768565718, -692.2693691598017, -663.3715201323328, -613.3569157791644, -712.7716736444878, -969.3761222584264, -682.1853674091266, -430.859253196766, -626.9057677676295, -394.174631242734, -881.8621199270841, -701.8105128347617, -571.5220785657247, -802.2847505080613, -778.1681600158208, -764.856613003843, -765.477687007436, -863.9423302498174, -588.7892968141871, -713.8304580899942, -921.8719907563013, -515.9857948358177, -728.3332052937448, -1058.6597146773095, -519.0847515061027, -800.501593661656, -733.5674465909572, -843.7243069065254, -775.8874032221368, -492.42814381428286, -510.1217799759738, -674.2841542415847, -420.860825726447, -803.962597155909, -641.1798927495181, -322.71637248421234, -1068.3710173946247, -783.8140081094656, -778.1751815208966, -749.5082392107654, -1106.2968516395651, -716.1747253111616, -431.89278021635204, -510.7795792231949, -803.3883496587829, -1183.897304565789, -687.2759648547272, -658.7328140597681, -747.3915730788775], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.337746948482508, "mean_inference_ms": 0.4090518243213764, "mean_action_processing_ms": 0.09670382388130318, "mean_env_wait_ms": 2.7015047589774372, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00402522087097168, "StateBufferConnector_ms": 0.003102540969848633, "ViewRequirementAgentConnector_ms": 0.07492423057556152}}, "episode_reward_max": -322.71637248421234, "episode_reward_min": -1220.2179116393079, "episode_reward_mean": -753.5216536180831, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-774.2150450003941, -707.2905721421914, -880.4044582012302, -510.23624097769374, -756.7596885822063, -750.503674906108, -970.4569044562797, -536.9133438307292, -969.1189538969094, -828.6557497044836, -921.1167522249553, -983.3273548465268, -786.8166913876576, -971.8472588541715, -839.0337560248918, -537.4573417131165, -736.6672726824571, -726.1648467480247, -703.5500142618337, -687.3754697981695, -1028.8533235816103, -1016.9399185373081, -547.7700884733886, -825.0141364721521, -854.5119491982765, -761.8485401322998, -645.2999114695314, -1132.127011384424, -832.7684630380427, -868.1055907336586, -1220.2179116393079, -568.5954218126869, -629.2427040522272, -778.7447216149754, -731.5489109251408, -809.0471153755772, -505.6045948871234, -724.7878642917971, -694.744406775047, -826.4270070378494, -820.173605473203, -768.5212560632556, -604.5459644699913, -749.0018730065776, -1025.864595518578, -769.7976833526562, -648.5470854658201, -721.529722719201, -740.6662003606299, -844.9133663279711, -760.7070604717552, -1111.1029768565718, -692.2693691598017, -663.3715201323328, -613.3569157791644, -712.7716736444878, -969.3761222584264, -682.1853674091266, -430.859253196766, -626.9057677676295, -394.174631242734, -881.8621199270841, -701.8105128347617, -571.5220785657247, -802.2847505080613, -778.1681600158208, -764.856613003843, -765.477687007436, -863.9423302498174, -588.7892968141871, -713.8304580899942, -921.8719907563013, -515.9857948358177, -728.3332052937448, -1058.6597146773095, -519.0847515061027, -800.501593661656, -733.5674465909572, -843.7243069065254, -775.8874032221368, -492.42814381428286, -510.1217799759738, -674.2841542415847, -420.860825726447, -803.962597155909, -641.1798927495181, -322.71637248421234, -1068.3710173946247, -783.8140081094656, -778.1751815208966, -749.5082392107654, -1106.2968516395651, -716.1747253111616, -431.89278021635204, -510.7795792231949, -803.3883496587829, -1183.897304565789, -687.2759648547272, -658.7328140597681, -747.3915730788775], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.337746948482508, "mean_inference_ms": 0.4090518243213764, "mean_action_processing_ms": 0.09670382388130318, "mean_env_wait_ms": 2.7015047589774372, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00402522087097168, "StateBufferConnector_ms": 0.003102540969848633, "ViewRequirementAgentConnector_ms": 0.07492423057556152}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 314880, "num_agent_steps_trained": 314880, "num_env_steps_sampled": 314880, "num_env_steps_trained": 314880, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.493710814829484, "num_env_steps_trained_throughput_per_sec": 39.493710814829484, "timesteps_total": 314880, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 314880, "timers": {"training_iteration_time_ms": 2973.223, "sample_time_ms": 2969.383, "load_time_ms": 0.216, "load_throughput": 555475.643, "learn_time_ms": 2.855, "learn_throughput": 42024.287, "synch_weights_time_ms": 0.726}, "counters": {"num_env_steps_sampled": 314880, "num_env_steps_trained": 314880, "num_agent_steps_sampled": 314880, "num_agent_steps_trained": 314880}, "done": false, "episodes_total": 2624, "training_iteration": 657, "trial_id": "53665_00000", "date": "2023-07-26_04-00-09", "timestamp": 1690333209, "time_this_iter_s": 12.15656304359436, "time_total_s": 7946.233126163483, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2324.907650232315, "iterations_since_restore": 197, "perf": {"cpu_util_percent": 41.6, "ram_util_percent": 74.61764705882354}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4765625, "policy_loss": -107002.96875, "vf_loss": 5168693.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 790.0, "diff_num_grad_updates_vs_sampler_policy": 789.0}}, "num_env_steps_sampled": 315360, "num_env_steps_trained": 315360, "num_agent_steps_sampled": 315360, "num_agent_steps_trained": 315360}, "sampler_results": {"episode_reward_max": -322.71637248421234, "episode_reward_min": -1220.2179116393079, "episode_reward_mean": -754.3658154306762, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-756.7596885822063, -750.503674906108, -970.4569044562797, -536.9133438307292, -969.1189538969094, -828.6557497044836, -921.1167522249553, -983.3273548465268, -786.8166913876576, -971.8472588541715, -839.0337560248918, -537.4573417131165, -736.6672726824571, -726.1648467480247, -703.5500142618337, -687.3754697981695, -1028.8533235816103, -1016.9399185373081, -547.7700884733886, -825.0141364721521, -854.5119491982765, -761.8485401322998, -645.2999114695314, -1132.127011384424, -832.7684630380427, -868.1055907336586, -1220.2179116393079, -568.5954218126869, -629.2427040522272, -778.7447216149754, -731.5489109251408, -809.0471153755772, -505.6045948871234, -724.7878642917971, -694.744406775047, -826.4270070378494, -820.173605473203, -768.5212560632556, -604.5459644699913, -749.0018730065776, -1025.864595518578, -769.7976833526562, -648.5470854658201, -721.529722719201, -740.6662003606299, -844.9133663279711, -760.7070604717552, -1111.1029768565718, -692.2693691598017, -663.3715201323328, -613.3569157791644, -712.7716736444878, -969.3761222584264, -682.1853674091266, -430.859253196766, -626.9057677676295, -394.174631242734, -881.8621199270841, -701.8105128347617, -571.5220785657247, -802.2847505080613, -778.1681600158208, -764.856613003843, -765.477687007436, -863.9423302498174, -588.7892968141871, -713.8304580899942, -921.8719907563013, -515.9857948358177, -728.3332052937448, -1058.6597146773095, -519.0847515061027, -800.501593661656, -733.5674465909572, -843.7243069065254, -775.8874032221368, -492.42814381428286, -510.1217799759738, -674.2841542415847, -420.860825726447, -803.962597155909, -641.1798927495181, -322.71637248421234, -1068.3710173946247, -783.8140081094656, -778.1751815208966, -749.5082392107654, -1106.2968516395651, -716.1747253111616, -431.89278021635204, -510.7795792231949, -803.3883496587829, -1183.897304565789, -687.2759648547272, -658.7328140597681, -747.3915730788775, -528.2065014873695, -713.9229522500578, -968.8361075338797, -745.5969363095093], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.338366228018995, "mean_inference_ms": 0.40912343218424035, "mean_action_processing_ms": 0.0967164993094692, "mean_env_wait_ms": 2.701468283272368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004027605056762695, "StateBufferConnector_ms": 0.003103494644165039, "ViewRequirementAgentConnector_ms": 0.07491111755371094}}, "episode_reward_max": -322.71637248421234, "episode_reward_min": -1220.2179116393079, "episode_reward_mean": -754.3658154306762, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-756.7596885822063, -750.503674906108, -970.4569044562797, -536.9133438307292, -969.1189538969094, -828.6557497044836, -921.1167522249553, -983.3273548465268, -786.8166913876576, -971.8472588541715, -839.0337560248918, -537.4573417131165, -736.6672726824571, -726.1648467480247, -703.5500142618337, -687.3754697981695, -1028.8533235816103, -1016.9399185373081, -547.7700884733886, -825.0141364721521, -854.5119491982765, -761.8485401322998, -645.2999114695314, -1132.127011384424, -832.7684630380427, -868.1055907336586, -1220.2179116393079, -568.5954218126869, -629.2427040522272, -778.7447216149754, -731.5489109251408, -809.0471153755772, -505.6045948871234, -724.7878642917971, -694.744406775047, -826.4270070378494, -820.173605473203, -768.5212560632556, -604.5459644699913, -749.0018730065776, -1025.864595518578, -769.7976833526562, -648.5470854658201, -721.529722719201, -740.6662003606299, -844.9133663279711, -760.7070604717552, -1111.1029768565718, -692.2693691598017, -663.3715201323328, -613.3569157791644, -712.7716736444878, -969.3761222584264, -682.1853674091266, -430.859253196766, -626.9057677676295, -394.174631242734, -881.8621199270841, -701.8105128347617, -571.5220785657247, -802.2847505080613, -778.1681600158208, -764.856613003843, -765.477687007436, -863.9423302498174, -588.7892968141871, -713.8304580899942, -921.8719907563013, -515.9857948358177, -728.3332052937448, -1058.6597146773095, -519.0847515061027, -800.501593661656, -733.5674465909572, -843.7243069065254, -775.8874032221368, -492.42814381428286, -510.1217799759738, -674.2841542415847, -420.860825726447, -803.962597155909, -641.1798927495181, -322.71637248421234, -1068.3710173946247, -783.8140081094656, -778.1751815208966, -749.5082392107654, -1106.2968516395651, -716.1747253111616, -431.89278021635204, -510.7795792231949, -803.3883496587829, -1183.897304565789, -687.2759648547272, -658.7328140597681, -747.3915730788775, -528.2065014873695, -713.9229522500578, -968.8361075338797, -745.5969363095093], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.338366228018995, "mean_inference_ms": 0.40912343218424035, "mean_action_processing_ms": 0.0967164993094692, "mean_env_wait_ms": 2.701468283272368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004027605056762695, "StateBufferConnector_ms": 0.003103494644165039, "ViewRequirementAgentConnector_ms": 0.07491111755371094}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 315360, "num_agent_steps_trained": 315360, "num_env_steps_sampled": 315360, "num_env_steps_trained": 315360, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.68618936234469, "num_env_steps_trained_throughput_per_sec": 40.68618936234469, "timesteps_total": 315360, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 315360, "timers": {"training_iteration_time_ms": 2975.103, "sample_time_ms": 2971.255, "load_time_ms": 0.216, "load_throughput": 556027.928, "learn_time_ms": 2.868, "learn_throughput": 41846.444, "synch_weights_time_ms": 0.722}, "counters": {"num_env_steps_sampled": 315360, "num_env_steps_trained": 315360, "num_agent_steps_sampled": 315360, "num_agent_steps_trained": 315360}, "done": false, "episodes_total": 2628, "training_iteration": 658, "trial_id": "53665_00000", "date": "2023-07-26_04-00-20", "timestamp": 1690333220, "time_this_iter_s": 11.800448179244995, "time_total_s": 7958.033574342728, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2336.70809841156, "iterations_since_restore": 198, "perf": {"cpu_util_percent": 38.54705882352941, "ram_util_percent": 74.25882352941176}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4682312011719, "policy_loss": -73031.25, "vf_loss": 2609685.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 794.0, "diff_num_grad_updates_vs_sampler_policy": 793.0}}, "num_env_steps_sampled": 315840, "num_env_steps_trained": 315840, "num_agent_steps_sampled": 315840, "num_agent_steps_trained": 315840}, "sampler_results": {"episode_reward_max": -322.71637248421234, "episode_reward_min": -1220.2179116393079, "episode_reward_mean": -752.4502725163209, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-969.1189538969094, -828.6557497044836, -921.1167522249553, -983.3273548465268, -786.8166913876576, -971.8472588541715, -839.0337560248918, -537.4573417131165, -736.6672726824571, -726.1648467480247, -703.5500142618337, -687.3754697981695, -1028.8533235816103, -1016.9399185373081, -547.7700884733886, -825.0141364721521, -854.5119491982765, -761.8485401322998, -645.2999114695314, -1132.127011384424, -832.7684630380427, -868.1055907336586, -1220.2179116393079, -568.5954218126869, -629.2427040522272, -778.7447216149754, -731.5489109251408, -809.0471153755772, -505.6045948871234, -724.7878642917971, -694.744406775047, -826.4270070378494, -820.173605473203, -768.5212560632556, -604.5459644699913, -749.0018730065776, -1025.864595518578, -769.7976833526562, -648.5470854658201, -721.529722719201, -740.6662003606299, -844.9133663279711, -760.7070604717552, -1111.1029768565718, -692.2693691598017, -663.3715201323328, -613.3569157791644, -712.7716736444878, -969.3761222584264, -682.1853674091266, -430.859253196766, -626.9057677676295, -394.174631242734, -881.8621199270841, -701.8105128347617, -571.5220785657247, -802.2847505080613, -778.1681600158208, -764.856613003843, -765.477687007436, -863.9423302498174, -588.7892968141871, -713.8304580899942, -921.8719907563013, -515.9857948358177, -728.3332052937448, -1058.6597146773095, -519.0847515061027, -800.501593661656, -733.5674465909572, -843.7243069065254, -775.8874032221368, -492.42814381428286, -510.1217799759738, -674.2841542415847, -420.860825726447, -803.962597155909, -641.1798927495181, -322.71637248421234, -1068.3710173946247, -783.8140081094656, -778.1751815208966, -749.5082392107654, -1106.2968516395651, -716.1747253111616, -431.89278021635204, -510.7795792231949, -803.3883496587829, -1183.897304565789, -687.2759648547272, -658.7328140597681, -747.3915730788775, -528.2065014873695, -713.9229522500578, -968.8361075338797, -745.5969363095093, -925.1504055452456, -781.9658152033769, -482.1656370712828, -633.7974625198785], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.33897048587105, "mean_inference_ms": 0.4091972951413422, "mean_action_processing_ms": 0.09672970400347028, "mean_env_wait_ms": 2.7014406369856236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004027605056762695, "StateBufferConnector_ms": 0.0031926631927490234, "ViewRequirementAgentConnector_ms": 0.0746455192565918}}, "episode_reward_max": -322.71637248421234, "episode_reward_min": -1220.2179116393079, "episode_reward_mean": -752.4502725163209, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-969.1189538969094, -828.6557497044836, -921.1167522249553, -983.3273548465268, -786.8166913876576, -971.8472588541715, -839.0337560248918, -537.4573417131165, -736.6672726824571, -726.1648467480247, -703.5500142618337, -687.3754697981695, -1028.8533235816103, -1016.9399185373081, -547.7700884733886, -825.0141364721521, -854.5119491982765, -761.8485401322998, -645.2999114695314, -1132.127011384424, -832.7684630380427, -868.1055907336586, -1220.2179116393079, -568.5954218126869, -629.2427040522272, -778.7447216149754, -731.5489109251408, -809.0471153755772, -505.6045948871234, -724.7878642917971, -694.744406775047, -826.4270070378494, -820.173605473203, -768.5212560632556, -604.5459644699913, -749.0018730065776, -1025.864595518578, -769.7976833526562, -648.5470854658201, -721.529722719201, -740.6662003606299, -844.9133663279711, -760.7070604717552, -1111.1029768565718, -692.2693691598017, -663.3715201323328, -613.3569157791644, -712.7716736444878, -969.3761222584264, -682.1853674091266, -430.859253196766, -626.9057677676295, -394.174631242734, -881.8621199270841, -701.8105128347617, -571.5220785657247, -802.2847505080613, -778.1681600158208, -764.856613003843, -765.477687007436, -863.9423302498174, -588.7892968141871, -713.8304580899942, -921.8719907563013, -515.9857948358177, -728.3332052937448, -1058.6597146773095, -519.0847515061027, -800.501593661656, -733.5674465909572, -843.7243069065254, -775.8874032221368, -492.42814381428286, -510.1217799759738, -674.2841542415847, -420.860825726447, -803.962597155909, -641.1798927495181, -322.71637248421234, -1068.3710173946247, -783.8140081094656, -778.1751815208966, -749.5082392107654, -1106.2968516395651, -716.1747253111616, -431.89278021635204, -510.7795792231949, -803.3883496587829, -1183.897304565789, -687.2759648547272, -658.7328140597681, -747.3915730788775, -528.2065014873695, -713.9229522500578, -968.8361075338797, -745.5969363095093, -925.1504055452456, -781.9658152033769, -482.1656370712828, -633.7974625198785], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.33897048587105, "mean_inference_ms": 0.4091972951413422, "mean_action_processing_ms": 0.09672970400347028, "mean_env_wait_ms": 2.7014406369856236, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004027605056762695, "StateBufferConnector_ms": 0.0031926631927490234, "ViewRequirementAgentConnector_ms": 0.0746455192565918}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 315840, "num_agent_steps_trained": 315840, "num_env_steps_sampled": 315840, "num_env_steps_trained": 315840, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.29597702747925, "num_env_steps_trained_throughput_per_sec": 39.29597702747925, "timesteps_total": 315840, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 315840, "timers": {"training_iteration_time_ms": 3000.746, "sample_time_ms": 2996.893, "load_time_ms": 0.216, "load_throughput": 555720.967, "learn_time_ms": 2.87, "learn_throughput": 41808.209, "synch_weights_time_ms": 0.727}, "counters": {"num_env_steps_sampled": 315840, "num_env_steps_trained": 315840, "num_agent_steps_sampled": 315840, "num_agent_steps_trained": 315840}, "done": false, "episodes_total": 2632, "training_iteration": 659, "trial_id": "53665_00000", "date": "2023-07-26_04-00-33", "timestamp": 1690333233, "time_this_iter_s": 12.217956781387329, "time_total_s": 7970.251531124115, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2348.9260551929474, "iterations_since_restore": 199, "perf": {"cpu_util_percent": 45.57058823529412, "ram_util_percent": 74.73529411764706}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.48486328125, "policy_loss": -39173.84375, "vf_loss": 780769.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 798.0, "diff_num_grad_updates_vs_sampler_policy": 797.0}}, "num_env_steps_sampled": 316320, "num_env_steps_trained": 316320, "num_agent_steps_sampled": 316320, "num_agent_steps_trained": 316320}, "sampler_results": {"episode_reward_max": -322.71637248421234, "episode_reward_min": -1220.2179116393079, "episode_reward_mean": -740.168333123973, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-786.8166913876576, -971.8472588541715, -839.0337560248918, -537.4573417131165, -736.6672726824571, -726.1648467480247, -703.5500142618337, -687.3754697981695, -1028.8533235816103, -1016.9399185373081, -547.7700884733886, -825.0141364721521, -854.5119491982765, -761.8485401322998, -645.2999114695314, -1132.127011384424, -832.7684630380427, -868.1055907336586, -1220.2179116393079, -568.5954218126869, -629.2427040522272, -778.7447216149754, -731.5489109251408, -809.0471153755772, -505.6045948871234, -724.7878642917971, -694.744406775047, -826.4270070378494, -820.173605473203, -768.5212560632556, -604.5459644699913, -749.0018730065776, -1025.864595518578, -769.7976833526562, -648.5470854658201, -721.529722719201, -740.6662003606299, -844.9133663279711, -760.7070604717552, -1111.1029768565718, -692.2693691598017, -663.3715201323328, -613.3569157791644, -712.7716736444878, -969.3761222584264, -682.1853674091266, -430.859253196766, -626.9057677676295, -394.174631242734, -881.8621199270841, -701.8105128347617, -571.5220785657247, -802.2847505080613, -778.1681600158208, -764.856613003843, -765.477687007436, -863.9423302498174, -588.7892968141871, -713.8304580899942, -921.8719907563013, -515.9857948358177, -728.3332052937448, -1058.6597146773095, -519.0847515061027, -800.501593661656, -733.5674465909572, -843.7243069065254, -775.8874032221368, -492.42814381428286, -510.1217799759738, -674.2841542415847, -420.860825726447, -803.962597155909, -641.1798927495181, -322.71637248421234, -1068.3710173946247, -783.8140081094656, -778.1751815208966, -749.5082392107654, -1106.2968516395651, -716.1747253111616, -431.89278021635204, -510.7795792231949, -803.3883496587829, -1183.897304565789, -687.2759648547272, -658.7328140597681, -747.3915730788775, -528.2065014873695, -713.9229522500578, -968.8361075338797, -745.5969363095093, -925.1504055452456, -781.9658152033769, -482.1656370712828, -633.7974625198785, -843.1419560493296, -494.9268878267914, -728.7710160549568, -407.1850115070204], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.33958607979727, "mean_inference_ms": 0.4092708334193875, "mean_action_processing_ms": 0.09674276426434694, "mean_env_wait_ms": 2.7014057463152823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004038333892822266, "StateBufferConnector_ms": 0.0032112598419189453, "ViewRequirementAgentConnector_ms": 0.07484102249145508}}, "episode_reward_max": -322.71637248421234, "episode_reward_min": -1220.2179116393079, "episode_reward_mean": -740.168333123973, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-786.8166913876576, -971.8472588541715, -839.0337560248918, -537.4573417131165, -736.6672726824571, -726.1648467480247, -703.5500142618337, -687.3754697981695, -1028.8533235816103, -1016.9399185373081, -547.7700884733886, -825.0141364721521, -854.5119491982765, -761.8485401322998, -645.2999114695314, -1132.127011384424, -832.7684630380427, -868.1055907336586, -1220.2179116393079, -568.5954218126869, -629.2427040522272, -778.7447216149754, -731.5489109251408, -809.0471153755772, -505.6045948871234, -724.7878642917971, -694.744406775047, -826.4270070378494, -820.173605473203, -768.5212560632556, -604.5459644699913, -749.0018730065776, -1025.864595518578, -769.7976833526562, -648.5470854658201, -721.529722719201, -740.6662003606299, -844.9133663279711, -760.7070604717552, -1111.1029768565718, -692.2693691598017, -663.3715201323328, -613.3569157791644, -712.7716736444878, -969.3761222584264, -682.1853674091266, -430.859253196766, -626.9057677676295, -394.174631242734, -881.8621199270841, -701.8105128347617, -571.5220785657247, -802.2847505080613, -778.1681600158208, -764.856613003843, -765.477687007436, -863.9423302498174, -588.7892968141871, -713.8304580899942, -921.8719907563013, -515.9857948358177, -728.3332052937448, -1058.6597146773095, -519.0847515061027, -800.501593661656, -733.5674465909572, -843.7243069065254, -775.8874032221368, -492.42814381428286, -510.1217799759738, -674.2841542415847, -420.860825726447, -803.962597155909, -641.1798927495181, -322.71637248421234, -1068.3710173946247, -783.8140081094656, -778.1751815208966, -749.5082392107654, -1106.2968516395651, -716.1747253111616, -431.89278021635204, -510.7795792231949, -803.3883496587829, -1183.897304565789, -687.2759648547272, -658.7328140597681, -747.3915730788775, -528.2065014873695, -713.9229522500578, -968.8361075338797, -745.5969363095093, -925.1504055452456, -781.9658152033769, -482.1656370712828, -633.7974625198785, -843.1419560493296, -494.9268878267914, -728.7710160549568, -407.1850115070204], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.33958607979727, "mean_inference_ms": 0.4092708334193875, "mean_action_processing_ms": 0.09674276426434694, "mean_env_wait_ms": 2.7014057463152823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004038333892822266, "StateBufferConnector_ms": 0.0032112598419189453, "ViewRequirementAgentConnector_ms": 0.07484102249145508}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 316320, "num_agent_steps_trained": 316320, "num_env_steps_sampled": 316320, "num_env_steps_trained": 316320, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.11184583979182, "num_env_steps_trained_throughput_per_sec": 41.11184583979182, "timesteps_total": 316320, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 316320, "timers": {"training_iteration_time_ms": 2987.875, "sample_time_ms": 2984.034, "load_time_ms": 0.215, "load_throughput": 557259.167, "learn_time_ms": 2.856, "learn_throughput": 42021.48, "synch_weights_time_ms": 0.73}, "counters": {"num_env_steps_sampled": 316320, "num_env_steps_trained": 316320, "num_agent_steps_sampled": 316320, "num_agent_steps_trained": 316320}, "done": false, "episodes_total": 2636, "training_iteration": 660, "trial_id": "53665_00000", "date": "2023-07-26_04-00-44", "timestamp": 1690333244, "time_this_iter_s": 11.67837405204773, "time_total_s": 7981.929905176163, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2360.604429244995, "iterations_since_restore": 200, "perf": {"cpu_util_percent": 39.870588235294115, "ram_util_percent": 74.79411764705883}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4658508300781, "policy_loss": -99021.3515625, "vf_loss": 4825356.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 802.0, "diff_num_grad_updates_vs_sampler_policy": 801.0}}, "num_env_steps_sampled": 316800, "num_env_steps_trained": 316800, "num_agent_steps_sampled": 316800, "num_agent_steps_trained": 316800}, "sampler_results": {"episode_reward_max": -322.71637248421234, "episode_reward_min": -1220.2179116393079, "episode_reward_mean": -736.296904220077, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-736.6672726824571, -726.1648467480247, -703.5500142618337, -687.3754697981695, -1028.8533235816103, -1016.9399185373081, -547.7700884733886, -825.0141364721521, -854.5119491982765, -761.8485401322998, -645.2999114695314, -1132.127011384424, -832.7684630380427, -868.1055907336586, -1220.2179116393079, -568.5954218126869, -629.2427040522272, -778.7447216149754, -731.5489109251408, -809.0471153755772, -505.6045948871234, -724.7878642917971, -694.744406775047, -826.4270070378494, -820.173605473203, -768.5212560632556, -604.5459644699913, -749.0018730065776, -1025.864595518578, -769.7976833526562, -648.5470854658201, -721.529722719201, -740.6662003606299, -844.9133663279711, -760.7070604717552, -1111.1029768565718, -692.2693691598017, -663.3715201323328, -613.3569157791644, -712.7716736444878, -969.3761222584264, -682.1853674091266, -430.859253196766, -626.9057677676295, -394.174631242734, -881.8621199270841, -701.8105128347617, -571.5220785657247, -802.2847505080613, -778.1681600158208, -764.856613003843, -765.477687007436, -863.9423302498174, -588.7892968141871, -713.8304580899942, -921.8719907563013, -515.9857948358177, -728.3332052937448, -1058.6597146773095, -519.0847515061027, -800.501593661656, -733.5674465909572, -843.7243069065254, -775.8874032221368, -492.42814381428286, -510.1217799759738, -674.2841542415847, -420.860825726447, -803.962597155909, -641.1798927495181, -322.71637248421234, -1068.3710173946247, -783.8140081094656, -778.1751815208966, -749.5082392107654, -1106.2968516395651, -716.1747253111616, -431.89278021635204, -510.7795792231949, -803.3883496587829, -1183.897304565789, -687.2759648547272, -658.7328140597681, -747.3915730788775, -528.2065014873695, -713.9229522500578, -968.8361075338797, -745.5969363095093, -925.1504055452456, -781.9658152033769, -482.1656370712828, -633.7974625198785, -843.1419560493296, -494.9268878267914, -728.7710160549568, -407.1850115070204, -556.4423050944647, -752.4553015690863, -683.1511278189711, -755.9634231077051], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.340402867684038, "mean_inference_ms": 0.4093514470808084, "mean_action_processing_ms": 0.09675685710574002, "mean_env_wait_ms": 2.7013863278742156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040585994720458984, "StateBufferConnector_ms": 0.0032160282135009766, "ViewRequirementAgentConnector_ms": 0.07504487037658691}}, "episode_reward_max": -322.71637248421234, "episode_reward_min": -1220.2179116393079, "episode_reward_mean": -736.296904220077, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-736.6672726824571, -726.1648467480247, -703.5500142618337, -687.3754697981695, -1028.8533235816103, -1016.9399185373081, -547.7700884733886, -825.0141364721521, -854.5119491982765, -761.8485401322998, -645.2999114695314, -1132.127011384424, -832.7684630380427, -868.1055907336586, -1220.2179116393079, -568.5954218126869, -629.2427040522272, -778.7447216149754, -731.5489109251408, -809.0471153755772, -505.6045948871234, -724.7878642917971, -694.744406775047, -826.4270070378494, -820.173605473203, -768.5212560632556, -604.5459644699913, -749.0018730065776, -1025.864595518578, -769.7976833526562, -648.5470854658201, -721.529722719201, -740.6662003606299, -844.9133663279711, -760.7070604717552, -1111.1029768565718, -692.2693691598017, -663.3715201323328, -613.3569157791644, -712.7716736444878, -969.3761222584264, -682.1853674091266, -430.859253196766, -626.9057677676295, -394.174631242734, -881.8621199270841, -701.8105128347617, -571.5220785657247, -802.2847505080613, -778.1681600158208, -764.856613003843, -765.477687007436, -863.9423302498174, -588.7892968141871, -713.8304580899942, -921.8719907563013, -515.9857948358177, -728.3332052937448, -1058.6597146773095, -519.0847515061027, -800.501593661656, -733.5674465909572, -843.7243069065254, -775.8874032221368, -492.42814381428286, -510.1217799759738, -674.2841542415847, -420.860825726447, -803.962597155909, -641.1798927495181, -322.71637248421234, -1068.3710173946247, -783.8140081094656, -778.1751815208966, -749.5082392107654, -1106.2968516395651, -716.1747253111616, -431.89278021635204, -510.7795792231949, -803.3883496587829, -1183.897304565789, -687.2759648547272, -658.7328140597681, -747.3915730788775, -528.2065014873695, -713.9229522500578, -968.8361075338797, -745.5969363095093, -925.1504055452456, -781.9658152033769, -482.1656370712828, -633.7974625198785, -843.1419560493296, -494.9268878267914, -728.7710160549568, -407.1850115070204, -556.4423050944647, -752.4553015690863, -683.1511278189711, -755.9634231077051], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.340402867684038, "mean_inference_ms": 0.4093514470808084, "mean_action_processing_ms": 0.09675685710574002, "mean_env_wait_ms": 2.7013863278742156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0040585994720458984, "StateBufferConnector_ms": 0.0032160282135009766, "ViewRequirementAgentConnector_ms": 0.07504487037658691}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 316800, "num_agent_steps_trained": 316800, "num_env_steps_sampled": 316800, "num_env_steps_trained": 316800, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.306794898086025, "num_env_steps_trained_throughput_per_sec": 40.306794898086025, "timesteps_total": 316800, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 316800, "timers": {"training_iteration_time_ms": 2944.96, "sample_time_ms": 2940.529, "load_time_ms": 0.242, "load_throughput": 495341.482, "learn_time_ms": 3.248, "learn_throughput": 36943.642, "synch_weights_time_ms": 0.889}, "counters": {"num_env_steps_sampled": 316800, "num_env_steps_trained": 316800, "num_agent_steps_sampled": 316800, "num_agent_steps_trained": 316800}, "done": false, "episodes_total": 2640, "training_iteration": 661, "trial_id": "53665_00000", "date": "2023-07-26_04-00-56", "timestamp": 1690333256, "time_this_iter_s": 11.917227983474731, "time_total_s": 7993.847133159637, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2372.52165722847, "iterations_since_restore": 201, "perf": {"cpu_util_percent": 44.152941176470584, "ram_util_percent": 74.73529411764704}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4746398925781, "policy_loss": -71652.421875, "vf_loss": 2715597.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 806.0, "diff_num_grad_updates_vs_sampler_policy": 805.0}}, "num_env_steps_sampled": 317280, "num_env_steps_trained": 317280, "num_agent_steps_sampled": 317280, "num_agent_steps_trained": 317280}, "sampler_results": {"episode_reward_max": -322.71637248421234, "episode_reward_min": -1220.2179116393079, "episode_reward_mean": -738.6824628180053, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1028.8533235816103, -1016.9399185373081, -547.7700884733886, -825.0141364721521, -854.5119491982765, -761.8485401322998, -645.2999114695314, -1132.127011384424, -832.7684630380427, -868.1055907336586, -1220.2179116393079, -568.5954218126869, -629.2427040522272, -778.7447216149754, -731.5489109251408, -809.0471153755772, -505.6045948871234, -724.7878642917971, -694.744406775047, -826.4270070378494, -820.173605473203, -768.5212560632556, -604.5459644699913, -749.0018730065776, -1025.864595518578, -769.7976833526562, -648.5470854658201, -721.529722719201, -740.6662003606299, -844.9133663279711, -760.7070604717552, -1111.1029768565718, -692.2693691598017, -663.3715201323328, -613.3569157791644, -712.7716736444878, -969.3761222584264, -682.1853674091266, -430.859253196766, -626.9057677676295, -394.174631242734, -881.8621199270841, -701.8105128347617, -571.5220785657247, -802.2847505080613, -778.1681600158208, -764.856613003843, -765.477687007436, -863.9423302498174, -588.7892968141871, -713.8304580899942, -921.8719907563013, -515.9857948358177, -728.3332052937448, -1058.6597146773095, -519.0847515061027, -800.501593661656, -733.5674465909572, -843.7243069065254, -775.8874032221368, -492.42814381428286, -510.1217799759738, -674.2841542415847, -420.860825726447, -803.962597155909, -641.1798927495181, -322.71637248421234, -1068.3710173946247, -783.8140081094656, -778.1751815208966, -749.5082392107654, -1106.2968516395651, -716.1747253111616, -431.89278021635204, -510.7795792231949, -803.3883496587829, -1183.897304565789, -687.2759648547272, -658.7328140597681, -747.3915730788775, -528.2065014873695, -713.9229522500578, -968.8361075338797, -745.5969363095093, -925.1504055452456, -781.9658152033769, -482.1656370712828, -633.7974625198785, -843.1419560493296, -494.9268878267914, -728.7710160549568, -407.1850115070204, -556.4423050944647, -752.4553015690863, -683.1511278189711, -755.9634231077051, -879.4087224106784, -597.8825103006533, -929.6118089726612, -685.4104215993268], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.341491740286248, "mean_inference_ms": 0.40947521241154505, "mean_action_processing_ms": 0.0967785569696262, "mean_env_wait_ms": 2.7015266209373476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042171478271484375, "StateBufferConnector_ms": 0.003308534622192383, "ViewRequirementAgentConnector_ms": 0.0769965648651123}}, "episode_reward_max": -322.71637248421234, "episode_reward_min": -1220.2179116393079, "episode_reward_mean": -738.6824628180053, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1028.8533235816103, -1016.9399185373081, -547.7700884733886, -825.0141364721521, -854.5119491982765, -761.8485401322998, -645.2999114695314, -1132.127011384424, -832.7684630380427, -868.1055907336586, -1220.2179116393079, -568.5954218126869, -629.2427040522272, -778.7447216149754, -731.5489109251408, -809.0471153755772, -505.6045948871234, -724.7878642917971, -694.744406775047, -826.4270070378494, -820.173605473203, -768.5212560632556, -604.5459644699913, -749.0018730065776, -1025.864595518578, -769.7976833526562, -648.5470854658201, -721.529722719201, -740.6662003606299, -844.9133663279711, -760.7070604717552, -1111.1029768565718, -692.2693691598017, -663.3715201323328, -613.3569157791644, -712.7716736444878, -969.3761222584264, -682.1853674091266, -430.859253196766, -626.9057677676295, -394.174631242734, -881.8621199270841, -701.8105128347617, -571.5220785657247, -802.2847505080613, -778.1681600158208, -764.856613003843, -765.477687007436, -863.9423302498174, -588.7892968141871, -713.8304580899942, -921.8719907563013, -515.9857948358177, -728.3332052937448, -1058.6597146773095, -519.0847515061027, -800.501593661656, -733.5674465909572, -843.7243069065254, -775.8874032221368, -492.42814381428286, -510.1217799759738, -674.2841542415847, -420.860825726447, -803.962597155909, -641.1798927495181, -322.71637248421234, -1068.3710173946247, -783.8140081094656, -778.1751815208966, -749.5082392107654, -1106.2968516395651, -716.1747253111616, -431.89278021635204, -510.7795792231949, -803.3883496587829, -1183.897304565789, -687.2759648547272, -658.7328140597681, -747.3915730788775, -528.2065014873695, -713.9229522500578, -968.8361075338797, -745.5969363095093, -925.1504055452456, -781.9658152033769, -482.1656370712828, -633.7974625198785, -843.1419560493296, -494.9268878267914, -728.7710160549568, -407.1850115070204, -556.4423050944647, -752.4553015690863, -683.1511278189711, -755.9634231077051, -879.4087224106784, -597.8825103006533, -929.6118089726612, -685.4104215993268], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.341491740286248, "mean_inference_ms": 0.40947521241154505, "mean_action_processing_ms": 0.0967785569696262, "mean_env_wait_ms": 2.7015266209373476, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042171478271484375, "StateBufferConnector_ms": 0.003308534622192383, "ViewRequirementAgentConnector_ms": 0.0769965648651123}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 317280, "num_agent_steps_trained": 317280, "num_env_steps_sampled": 317280, "num_env_steps_trained": 317280, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 37.60746637312932, "num_env_steps_trained_throughput_per_sec": 37.60746637312932, "timesteps_total": 317280, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 317280, "timers": {"training_iteration_time_ms": 3044.11, "sample_time_ms": 3037.847, "load_time_ms": 0.291, "load_throughput": 411980.421, "learn_time_ms": 4.726, "learn_throughput": 25393.092, "synch_weights_time_ms": 1.15}, "counters": {"num_env_steps_sampled": 317280, "num_env_steps_trained": 317280, "num_agent_steps_sampled": 317280, "num_agent_steps_trained": 317280}, "done": false, "episodes_total": 2644, "training_iteration": 662, "trial_id": "53665_00000", "date": "2023-07-26_04-01-09", "timestamp": 1690333269, "time_this_iter_s": 12.766769886016846, "time_total_s": 8006.613903045654, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2385.2884271144867, "iterations_since_restore": 202, "perf": {"cpu_util_percent": 42.72222222222222, "ram_util_percent": 77.35555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4927978515625, "policy_loss": -125891.984375, "vf_loss": 6919057.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 810.0, "diff_num_grad_updates_vs_sampler_policy": 809.0}}, "num_env_steps_sampled": 317760, "num_env_steps_trained": 317760, "num_agent_steps_sampled": 317760, "num_agent_steps_trained": 317760}, "sampler_results": {"episode_reward_max": -322.71637248421234, "episode_reward_min": -1220.2179116393079, "episode_reward_mean": -732.2128568212174, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-854.5119491982765, -761.8485401322998, -645.2999114695314, -1132.127011384424, -832.7684630380427, -868.1055907336586, -1220.2179116393079, -568.5954218126869, -629.2427040522272, -778.7447216149754, -731.5489109251408, -809.0471153755772, -505.6045948871234, -724.7878642917971, -694.744406775047, -826.4270070378494, -820.173605473203, -768.5212560632556, -604.5459644699913, -749.0018730065776, -1025.864595518578, -769.7976833526562, -648.5470854658201, -721.529722719201, -740.6662003606299, -844.9133663279711, -760.7070604717552, -1111.1029768565718, -692.2693691598017, -663.3715201323328, -613.3569157791644, -712.7716736444878, -969.3761222584264, -682.1853674091266, -430.859253196766, -626.9057677676295, -394.174631242734, -881.8621199270841, -701.8105128347617, -571.5220785657247, -802.2847505080613, -778.1681600158208, -764.856613003843, -765.477687007436, -863.9423302498174, -588.7892968141871, -713.8304580899942, -921.8719907563013, -515.9857948358177, -728.3332052937448, -1058.6597146773095, -519.0847515061027, -800.501593661656, -733.5674465909572, -843.7243069065254, -775.8874032221368, -492.42814381428286, -510.1217799759738, -674.2841542415847, -420.860825726447, -803.962597155909, -641.1798927495181, -322.71637248421234, -1068.3710173946247, -783.8140081094656, -778.1751815208966, -749.5082392107654, -1106.2968516395651, -716.1747253111616, -431.89278021635204, -510.7795792231949, -803.3883496587829, -1183.897304565789, -687.2759648547272, -658.7328140597681, -747.3915730788775, -528.2065014873695, -713.9229522500578, -968.8361075338797, -745.5969363095093, -925.1504055452456, -781.9658152033769, -482.1656370712828, -633.7974625198785, -843.1419560493296, -494.9268878267914, -728.7710160549568, -407.1850115070204, -556.4423050944647, -752.4553015690863, -683.1511278189711, -755.9634231077051, -879.4087224106784, -597.8825103006533, -929.6118089726612, -685.4104215993268, -792.4918267035575, -375.23106874514923, -718.2694750728991, -885.6244968640651], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.34276927682664, "mean_inference_ms": 0.4096023318293794, "mean_action_processing_ms": 0.09680082031829333, "mean_env_wait_ms": 2.701664411842225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004260063171386719, "StateBufferConnector_ms": 0.003325223922729492, "ViewRequirementAgentConnector_ms": 0.07757401466369629}}, "episode_reward_max": -322.71637248421234, "episode_reward_min": -1220.2179116393079, "episode_reward_mean": -732.2128568212174, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-854.5119491982765, -761.8485401322998, -645.2999114695314, -1132.127011384424, -832.7684630380427, -868.1055907336586, -1220.2179116393079, -568.5954218126869, -629.2427040522272, -778.7447216149754, -731.5489109251408, -809.0471153755772, -505.6045948871234, -724.7878642917971, -694.744406775047, -826.4270070378494, -820.173605473203, -768.5212560632556, -604.5459644699913, -749.0018730065776, -1025.864595518578, -769.7976833526562, -648.5470854658201, -721.529722719201, -740.6662003606299, -844.9133663279711, -760.7070604717552, -1111.1029768565718, -692.2693691598017, -663.3715201323328, -613.3569157791644, -712.7716736444878, -969.3761222584264, -682.1853674091266, -430.859253196766, -626.9057677676295, -394.174631242734, -881.8621199270841, -701.8105128347617, -571.5220785657247, -802.2847505080613, -778.1681600158208, -764.856613003843, -765.477687007436, -863.9423302498174, -588.7892968141871, -713.8304580899942, -921.8719907563013, -515.9857948358177, -728.3332052937448, -1058.6597146773095, -519.0847515061027, -800.501593661656, -733.5674465909572, -843.7243069065254, -775.8874032221368, -492.42814381428286, -510.1217799759738, -674.2841542415847, -420.860825726447, -803.962597155909, -641.1798927495181, -322.71637248421234, -1068.3710173946247, -783.8140081094656, -778.1751815208966, -749.5082392107654, -1106.2968516395651, -716.1747253111616, -431.89278021635204, -510.7795792231949, -803.3883496587829, -1183.897304565789, -687.2759648547272, -658.7328140597681, -747.3915730788775, -528.2065014873695, -713.9229522500578, -968.8361075338797, -745.5969363095093, -925.1504055452456, -781.9658152033769, -482.1656370712828, -633.7974625198785, -843.1419560493296, -494.9268878267914, -728.7710160549568, -407.1850115070204, -556.4423050944647, -752.4553015690863, -683.1511278189711, -755.9634231077051, -879.4087224106784, -597.8825103006533, -929.6118089726612, -685.4104215993268, -792.4918267035575, -375.23106874514923, -718.2694750728991, -885.6244968640651], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.34276927682664, "mean_inference_ms": 0.4096023318293794, "mean_action_processing_ms": 0.09680082031829333, "mean_env_wait_ms": 2.701664411842225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004260063171386719, "StateBufferConnector_ms": 0.003325223922729492, "ViewRequirementAgentConnector_ms": 0.07757401466369629}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 317760, "num_agent_steps_trained": 317760, "num_env_steps_sampled": 317760, "num_env_steps_trained": 317760, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.76063220810659, "num_env_steps_trained_throughput_per_sec": 38.76063220810659, "timesteps_total": 317760, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 317760, "timers": {"training_iteration_time_ms": 3122.406, "sample_time_ms": 3115.606, "load_time_ms": 0.331, "load_throughput": 362567.699, "learn_time_ms": 5.147, "learn_throughput": 23312.698, "synch_weights_time_ms": 1.205}, "counters": {"num_env_steps_sampled": 317760, "num_env_steps_trained": 317760, "num_agent_steps_sampled": 317760, "num_agent_steps_trained": 317760}, "done": false, "episodes_total": 2648, "training_iteration": 663, "trial_id": "53665_00000", "date": "2023-07-26_04-01-22", "timestamp": 1690333282, "time_this_iter_s": 12.38682770729065, "time_total_s": 8019.000730752945, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2397.6752548217773, "iterations_since_restore": 203, "perf": {"cpu_util_percent": 41.64444444444445, "ram_util_percent": 79.69999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4997863769531, "policy_loss": -127641.953125, "vf_loss": 7507028.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 814.0, "diff_num_grad_updates_vs_sampler_policy": 813.0}}, "num_env_steps_sampled": 318240, "num_env_steps_trained": 318240, "num_agent_steps_sampled": 318240, "num_agent_steps_trained": 318240}, "sampler_results": {"episode_reward_max": -322.71637248421234, "episode_reward_min": -1220.2179116393079, "episode_reward_mean": -731.349129772172, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-832.7684630380427, -868.1055907336586, -1220.2179116393079, -568.5954218126869, -629.2427040522272, -778.7447216149754, -731.5489109251408, -809.0471153755772, -505.6045948871234, -724.7878642917971, -694.744406775047, -826.4270070378494, -820.173605473203, -768.5212560632556, -604.5459644699913, -749.0018730065776, -1025.864595518578, -769.7976833526562, -648.5470854658201, -721.529722719201, -740.6662003606299, -844.9133663279711, -760.7070604717552, -1111.1029768565718, -692.2693691598017, -663.3715201323328, -613.3569157791644, -712.7716736444878, -969.3761222584264, -682.1853674091266, -430.859253196766, -626.9057677676295, -394.174631242734, -881.8621199270841, -701.8105128347617, -571.5220785657247, -802.2847505080613, -778.1681600158208, -764.856613003843, -765.477687007436, -863.9423302498174, -588.7892968141871, -713.8304580899942, -921.8719907563013, -515.9857948358177, -728.3332052937448, -1058.6597146773095, -519.0847515061027, -800.501593661656, -733.5674465909572, -843.7243069065254, -775.8874032221368, -492.42814381428286, -510.1217799759738, -674.2841542415847, -420.860825726447, -803.962597155909, -641.1798927495181, -322.71637248421234, -1068.3710173946247, -783.8140081094656, -778.1751815208966, -749.5082392107654, -1106.2968516395651, -716.1747253111616, -431.89278021635204, -510.7795792231949, -803.3883496587829, -1183.897304565789, -687.2759648547272, -658.7328140597681, -747.3915730788775, -528.2065014873695, -713.9229522500578, -968.8361075338797, -745.5969363095093, -925.1504055452456, -781.9658152033769, -482.1656370712828, -633.7974625198785, -843.1419560493296, -494.9268878267914, -728.7710160549568, -407.1850115070204, -556.4423050944647, -752.4553015690863, -683.1511278189711, -755.9634231077051, -879.4087224106784, -597.8825103006533, -929.6118089726612, -685.4104215993268, -792.4918267035575, -375.23106874514923, -718.2694750728991, -885.6244968640651, -857.5168079049236, -726.005393145418, -707.4462002130316, -1016.4463060166293], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.344057695827015, "mean_inference_ms": 0.4097293518418114, "mean_action_processing_ms": 0.09682311789129909, "mean_env_wait_ms": 2.701821316702345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004256725311279297, "StateBufferConnector_ms": 0.0033159255981445312, "ViewRequirementAgentConnector_ms": 0.07758283615112305}}, "episode_reward_max": -322.71637248421234, "episode_reward_min": -1220.2179116393079, "episode_reward_mean": -731.349129772172, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-832.7684630380427, -868.1055907336586, -1220.2179116393079, -568.5954218126869, -629.2427040522272, -778.7447216149754, -731.5489109251408, -809.0471153755772, -505.6045948871234, -724.7878642917971, -694.744406775047, -826.4270070378494, -820.173605473203, -768.5212560632556, -604.5459644699913, -749.0018730065776, -1025.864595518578, -769.7976833526562, -648.5470854658201, -721.529722719201, -740.6662003606299, -844.9133663279711, -760.7070604717552, -1111.1029768565718, -692.2693691598017, -663.3715201323328, -613.3569157791644, -712.7716736444878, -969.3761222584264, -682.1853674091266, -430.859253196766, -626.9057677676295, -394.174631242734, -881.8621199270841, -701.8105128347617, -571.5220785657247, -802.2847505080613, -778.1681600158208, -764.856613003843, -765.477687007436, -863.9423302498174, -588.7892968141871, -713.8304580899942, -921.8719907563013, -515.9857948358177, -728.3332052937448, -1058.6597146773095, -519.0847515061027, -800.501593661656, -733.5674465909572, -843.7243069065254, -775.8874032221368, -492.42814381428286, -510.1217799759738, -674.2841542415847, -420.860825726447, -803.962597155909, -641.1798927495181, -322.71637248421234, -1068.3710173946247, -783.8140081094656, -778.1751815208966, -749.5082392107654, -1106.2968516395651, -716.1747253111616, -431.89278021635204, -510.7795792231949, -803.3883496587829, -1183.897304565789, -687.2759648547272, -658.7328140597681, -747.3915730788775, -528.2065014873695, -713.9229522500578, -968.8361075338797, -745.5969363095093, -925.1504055452456, -781.9658152033769, -482.1656370712828, -633.7974625198785, -843.1419560493296, -494.9268878267914, -728.7710160549568, -407.1850115070204, -556.4423050944647, -752.4553015690863, -683.1511278189711, -755.9634231077051, -879.4087224106784, -597.8825103006533, -929.6118089726612, -685.4104215993268, -792.4918267035575, -375.23106874514923, -718.2694750728991, -885.6244968640651, -857.5168079049236, -726.005393145418, -707.4462002130316, -1016.4463060166293], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.344057695827015, "mean_inference_ms": 0.4097293518418114, "mean_action_processing_ms": 0.09682311789129909, "mean_env_wait_ms": 2.701821316702345, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004256725311279297, "StateBufferConnector_ms": 0.0033159255981445312, "ViewRequirementAgentConnector_ms": 0.07758283615112305}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 318240, "num_agent_steps_trained": 318240, "num_env_steps_sampled": 318240, "num_env_steps_trained": 318240, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.01431182307877, "num_env_steps_trained_throughput_per_sec": 40.01431182307877, "timesteps_total": 318240, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 318240, "timers": {"training_iteration_time_ms": 3071.822, "sample_time_ms": 3066.072, "load_time_ms": 0.298, "load_throughput": 402814.31, "learn_time_ms": 4.31, "learn_throughput": 27840.303, "synch_weights_time_ms": 1.038}, "counters": {"num_env_steps_sampled": 318240, "num_env_steps_trained": 318240, "num_agent_steps_sampled": 318240, "num_agent_steps_trained": 318240}, "done": false, "episodes_total": 2652, "training_iteration": 664, "trial_id": "53665_00000", "date": "2023-07-26_04-01-34", "timestamp": 1690333294, "time_this_iter_s": 11.999068975448608, "time_total_s": 8030.999799728394, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2409.674323797226, "iterations_since_restore": 204, "perf": {"cpu_util_percent": 37.88823529411765, "ram_util_percent": 77.6705882352941}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.48046875, "policy_loss": -53813.421875, "vf_loss": 1421167.125}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 818.0, "diff_num_grad_updates_vs_sampler_policy": 817.0}}, "num_env_steps_sampled": 318720, "num_env_steps_trained": 318720, "num_agent_steps_sampled": 318720, "num_agent_steps_trained": 318720}, "sampler_results": {"episode_reward_max": -322.71637248421234, "episode_reward_min": -1183.897304565789, "episode_reward_mean": -719.1649778746374, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-629.2427040522272, -778.7447216149754, -731.5489109251408, -809.0471153755772, -505.6045948871234, -724.7878642917971, -694.744406775047, -826.4270070378494, -820.173605473203, -768.5212560632556, -604.5459644699913, -749.0018730065776, -1025.864595518578, -769.7976833526562, -648.5470854658201, -721.529722719201, -740.6662003606299, -844.9133663279711, -760.7070604717552, -1111.1029768565718, -692.2693691598017, -663.3715201323328, -613.3569157791644, -712.7716736444878, -969.3761222584264, -682.1853674091266, -430.859253196766, -626.9057677676295, -394.174631242734, -881.8621199270841, -701.8105128347617, -571.5220785657247, -802.2847505080613, -778.1681600158208, -764.856613003843, -765.477687007436, -863.9423302498174, -588.7892968141871, -713.8304580899942, -921.8719907563013, -515.9857948358177, -728.3332052937448, -1058.6597146773095, -519.0847515061027, -800.501593661656, -733.5674465909572, -843.7243069065254, -775.8874032221368, -492.42814381428286, -510.1217799759738, -674.2841542415847, -420.860825726447, -803.962597155909, -641.1798927495181, -322.71637248421234, -1068.3710173946247, -783.8140081094656, -778.1751815208966, -749.5082392107654, -1106.2968516395651, -716.1747253111616, -431.89278021635204, -510.7795792231949, -803.3883496587829, -1183.897304565789, -687.2759648547272, -658.7328140597681, -747.3915730788775, -528.2065014873695, -713.9229522500578, -968.8361075338797, -745.5969363095093, -925.1504055452456, -781.9658152033769, -482.1656370712828, -633.7974625198785, -843.1419560493296, -494.9268878267914, -728.7710160549568, -407.1850115070204, -556.4423050944647, -752.4553015690863, -683.1511278189711, -755.9634231077051, -879.4087224106784, -597.8825103006533, -929.6118089726612, -685.4104215993268, -792.4918267035575, -375.23106874514923, -718.2694750728991, -885.6244968640651, -857.5168079049236, -726.005393145418, -707.4462002130316, -1016.4463060166293, -638.7713585906026, -631.3172503155583, -441.13005998883165, -560.0535285752172], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.34538315830093, "mean_inference_ms": 0.409856695029401, "mean_action_processing_ms": 0.09684545921587154, "mean_env_wait_ms": 2.7019768230820893, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004254579544067383, "StateBufferConnector_ms": 0.0033173561096191406, "ViewRequirementAgentConnector_ms": 0.07757353782653809}}, "episode_reward_max": -322.71637248421234, "episode_reward_min": -1183.897304565789, "episode_reward_mean": -719.1649778746374, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-629.2427040522272, -778.7447216149754, -731.5489109251408, -809.0471153755772, -505.6045948871234, -724.7878642917971, -694.744406775047, -826.4270070378494, -820.173605473203, -768.5212560632556, -604.5459644699913, -749.0018730065776, -1025.864595518578, -769.7976833526562, -648.5470854658201, -721.529722719201, -740.6662003606299, -844.9133663279711, -760.7070604717552, -1111.1029768565718, -692.2693691598017, -663.3715201323328, -613.3569157791644, -712.7716736444878, -969.3761222584264, -682.1853674091266, -430.859253196766, -626.9057677676295, -394.174631242734, -881.8621199270841, -701.8105128347617, -571.5220785657247, -802.2847505080613, -778.1681600158208, -764.856613003843, -765.477687007436, -863.9423302498174, -588.7892968141871, -713.8304580899942, -921.8719907563013, -515.9857948358177, -728.3332052937448, -1058.6597146773095, -519.0847515061027, -800.501593661656, -733.5674465909572, -843.7243069065254, -775.8874032221368, -492.42814381428286, -510.1217799759738, -674.2841542415847, -420.860825726447, -803.962597155909, -641.1798927495181, -322.71637248421234, -1068.3710173946247, -783.8140081094656, -778.1751815208966, -749.5082392107654, -1106.2968516395651, -716.1747253111616, -431.89278021635204, -510.7795792231949, -803.3883496587829, -1183.897304565789, -687.2759648547272, -658.7328140597681, -747.3915730788775, -528.2065014873695, -713.9229522500578, -968.8361075338797, -745.5969363095093, -925.1504055452456, -781.9658152033769, -482.1656370712828, -633.7974625198785, -843.1419560493296, -494.9268878267914, -728.7710160549568, -407.1850115070204, -556.4423050944647, -752.4553015690863, -683.1511278189711, -755.9634231077051, -879.4087224106784, -597.8825103006533, -929.6118089726612, -685.4104215993268, -792.4918267035575, -375.23106874514923, -718.2694750728991, -885.6244968640651, -857.5168079049236, -726.005393145418, -707.4462002130316, -1016.4463060166293, -638.7713585906026, -631.3172503155583, -441.13005998883165, -560.0535285752172], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.34538315830093, "mean_inference_ms": 0.409856695029401, "mean_action_processing_ms": 0.09684545921587154, "mean_env_wait_ms": 2.7019768230820893, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004254579544067383, "StateBufferConnector_ms": 0.0033173561096191406, "ViewRequirementAgentConnector_ms": 0.07757353782653809}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 318720, "num_agent_steps_trained": 318720, "num_env_steps_sampled": 318720, "num_env_steps_trained": 318720, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.796045918756604, "num_env_steps_trained_throughput_per_sec": 41.796045918756604, "timesteps_total": 318720, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 318720, "timers": {"training_iteration_time_ms": 2944.52, "sample_time_ms": 2940.631, "load_time_ms": 0.214, "load_throughput": 561298.628, "learn_time_ms": 2.909, "learn_throughput": 41250.715, "synch_weights_time_ms": 0.726}, "counters": {"num_env_steps_sampled": 318720, "num_env_steps_trained": 318720, "num_agent_steps_sampled": 318720, "num_agent_steps_trained": 318720}, "done": false, "episodes_total": 2656, "training_iteration": 665, "trial_id": "53665_00000", "date": "2023-07-26_04-01-45", "timestamp": 1690333305, "time_this_iter_s": 11.487107992172241, "time_total_s": 8042.486907720566, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2421.161431789398, "iterations_since_restore": 205, "perf": {"cpu_util_percent": 37.956250000000004, "ram_util_percent": 75.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.48681640625, "policy_loss": -130660.0390625, "vf_loss": 7632002.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 822.0, "diff_num_grad_updates_vs_sampler_policy": 821.0}}, "num_env_steps_sampled": 319200, "num_env_steps_trained": 319200, "num_agent_steps_sampled": 319200, "num_agent_steps_trained": 319200}, "sampler_results": {"episode_reward_max": -322.71637248421234, "episode_reward_min": -1183.897304565789, "episode_reward_mean": -721.9826904069222, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-505.6045948871234, -724.7878642917971, -694.744406775047, -826.4270070378494, -820.173605473203, -768.5212560632556, -604.5459644699913, -749.0018730065776, -1025.864595518578, -769.7976833526562, -648.5470854658201, -721.529722719201, -740.6662003606299, -844.9133663279711, -760.7070604717552, -1111.1029768565718, -692.2693691598017, -663.3715201323328, -613.3569157791644, -712.7716736444878, -969.3761222584264, -682.1853674091266, -430.859253196766, -626.9057677676295, -394.174631242734, -881.8621199270841, -701.8105128347617, -571.5220785657247, -802.2847505080613, -778.1681600158208, -764.856613003843, -765.477687007436, -863.9423302498174, -588.7892968141871, -713.8304580899942, -921.8719907563013, -515.9857948358177, -728.3332052937448, -1058.6597146773095, -519.0847515061027, -800.501593661656, -733.5674465909572, -843.7243069065254, -775.8874032221368, -492.42814381428286, -510.1217799759738, -674.2841542415847, -420.860825726447, -803.962597155909, -641.1798927495181, -322.71637248421234, -1068.3710173946247, -783.8140081094656, -778.1751815208966, -749.5082392107654, -1106.2968516395651, -716.1747253111616, -431.89278021635204, -510.7795792231949, -803.3883496587829, -1183.897304565789, -687.2759648547272, -658.7328140597681, -747.3915730788775, -528.2065014873695, -713.9229522500578, -968.8361075338797, -745.5969363095093, -925.1504055452456, -781.9658152033769, -482.1656370712828, -633.7974625198785, -843.1419560493296, -494.9268878267914, -728.7710160549568, -407.1850115070204, -556.4423050944647, -752.4553015690863, -683.1511278189711, -755.9634231077051, -879.4087224106784, -597.8825103006533, -929.6118089726612, -685.4104215993268, -792.4918267035575, -375.23106874514923, -718.2694750728991, -885.6244968640651, -857.5168079049236, -726.005393145418, -707.4462002130316, -1016.4463060166293, -638.7713585906026, -631.3172503155583, -441.13005998883165, -560.0535285752172, -835.5559653520096, -843.424134268684, -611.3110755033473, -940.0635300723793], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.346687043359978, "mean_inference_ms": 0.40998301529069153, "mean_action_processing_ms": 0.0968679246754159, "mean_env_wait_ms": 2.702132408472189, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004225254058837891, "StateBufferConnector_ms": 0.0033218860626220703, "ViewRequirementAgentConnector_ms": 0.07755374908447266}}, "episode_reward_max": -322.71637248421234, "episode_reward_min": -1183.897304565789, "episode_reward_mean": -721.9826904069222, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-505.6045948871234, -724.7878642917971, -694.744406775047, -826.4270070378494, -820.173605473203, -768.5212560632556, -604.5459644699913, -749.0018730065776, -1025.864595518578, -769.7976833526562, -648.5470854658201, -721.529722719201, -740.6662003606299, -844.9133663279711, -760.7070604717552, -1111.1029768565718, -692.2693691598017, -663.3715201323328, -613.3569157791644, -712.7716736444878, -969.3761222584264, -682.1853674091266, -430.859253196766, -626.9057677676295, -394.174631242734, -881.8621199270841, -701.8105128347617, -571.5220785657247, -802.2847505080613, -778.1681600158208, -764.856613003843, -765.477687007436, -863.9423302498174, -588.7892968141871, -713.8304580899942, -921.8719907563013, -515.9857948358177, -728.3332052937448, -1058.6597146773095, -519.0847515061027, -800.501593661656, -733.5674465909572, -843.7243069065254, -775.8874032221368, -492.42814381428286, -510.1217799759738, -674.2841542415847, -420.860825726447, -803.962597155909, -641.1798927495181, -322.71637248421234, -1068.3710173946247, -783.8140081094656, -778.1751815208966, -749.5082392107654, -1106.2968516395651, -716.1747253111616, -431.89278021635204, -510.7795792231949, -803.3883496587829, -1183.897304565789, -687.2759648547272, -658.7328140597681, -747.3915730788775, -528.2065014873695, -713.9229522500578, -968.8361075338797, -745.5969363095093, -925.1504055452456, -781.9658152033769, -482.1656370712828, -633.7974625198785, -843.1419560493296, -494.9268878267914, -728.7710160549568, -407.1850115070204, -556.4423050944647, -752.4553015690863, -683.1511278189711, -755.9634231077051, -879.4087224106784, -597.8825103006533, -929.6118089726612, -685.4104215993268, -792.4918267035575, -375.23106874514923, -718.2694750728991, -885.6244968640651, -857.5168079049236, -726.005393145418, -707.4462002130316, -1016.4463060166293, -638.7713585906026, -631.3172503155583, -441.13005998883165, -560.0535285752172, -835.5559653520096, -843.424134268684, -611.3110755033473, -940.0635300723793], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.346687043359978, "mean_inference_ms": 0.40998301529069153, "mean_action_processing_ms": 0.0968679246754159, "mean_env_wait_ms": 2.702132408472189, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004225254058837891, "StateBufferConnector_ms": 0.0033218860626220703, "ViewRequirementAgentConnector_ms": 0.07755374908447266}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 319200, "num_agent_steps_trained": 319200, "num_env_steps_sampled": 319200, "num_env_steps_trained": 319200, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.73107251182254, "num_env_steps_trained_throughput_per_sec": 40.73107251182254, "timesteps_total": 319200, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 319200, "timers": {"training_iteration_time_ms": 2923.369, "sample_time_ms": 2919.407, "load_time_ms": 0.223, "load_throughput": 538767.373, "learn_time_ms": 2.955, "learn_throughput": 40612.965, "synch_weights_time_ms": 0.74}, "counters": {"num_env_steps_sampled": 319200, "num_env_steps_trained": 319200, "num_agent_steps_sampled": 319200, "num_agent_steps_trained": 319200}, "done": false, "episodes_total": 2660, "training_iteration": 666, "trial_id": "53665_00000", "date": "2023-07-26_04-01-57", "timestamp": 1690333317, "time_this_iter_s": 11.787266969680786, "time_total_s": 8054.274174690247, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2432.948698759079, "iterations_since_restore": 206, "perf": {"cpu_util_percent": 38.92941176470588, "ram_util_percent": 77.64117647058822}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4739074707031, "policy_loss": -85042.7578125, "vf_loss": 3825399.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 826.0, "diff_num_grad_updates_vs_sampler_policy": 825.0}}, "num_env_steps_sampled": 319680, "num_env_steps_trained": 319680, "num_agent_steps_sampled": 319680, "num_agent_steps_trained": 319680}, "sampler_results": {"episode_reward_max": -322.71637248421234, "episode_reward_min": -1183.897304565789, "episode_reward_mean": -722.9325673584989, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-820.173605473203, -768.5212560632556, -604.5459644699913, -749.0018730065776, -1025.864595518578, -769.7976833526562, -648.5470854658201, -721.529722719201, -740.6662003606299, -844.9133663279711, -760.7070604717552, -1111.1029768565718, -692.2693691598017, -663.3715201323328, -613.3569157791644, -712.7716736444878, -969.3761222584264, -682.1853674091266, -430.859253196766, -626.9057677676295, -394.174631242734, -881.8621199270841, -701.8105128347617, -571.5220785657247, -802.2847505080613, -778.1681600158208, -764.856613003843, -765.477687007436, -863.9423302498174, -588.7892968141871, -713.8304580899942, -921.8719907563013, -515.9857948358177, -728.3332052937448, -1058.6597146773095, -519.0847515061027, -800.501593661656, -733.5674465909572, -843.7243069065254, -775.8874032221368, -492.42814381428286, -510.1217799759738, -674.2841542415847, -420.860825726447, -803.962597155909, -641.1798927495181, -322.71637248421234, -1068.3710173946247, -783.8140081094656, -778.1751815208966, -749.5082392107654, -1106.2968516395651, -716.1747253111616, -431.89278021635204, -510.7795792231949, -803.3883496587829, -1183.897304565789, -687.2759648547272, -658.7328140597681, -747.3915730788775, -528.2065014873695, -713.9229522500578, -968.8361075338797, -745.5969363095093, -925.1504055452456, -781.9658152033769, -482.1656370712828, -633.7974625198785, -843.1419560493296, -494.9268878267914, -728.7710160549568, -407.1850115070204, -556.4423050944647, -752.4553015690863, -683.1511278189711, -755.9634231077051, -879.4087224106784, -597.8825103006533, -929.6118089726612, -685.4104215993268, -792.4918267035575, -375.23106874514923, -718.2694750728991, -885.6244968640651, -857.5168079049236, -726.005393145418, -707.4462002130316, -1016.4463060166293, -638.7713585906026, -631.3172503155583, -441.13005998883165, -560.0535285752172, -835.5559653520096, -843.424134268684, -611.3110755033473, -940.0635300723793, -589.5815624494086, -769.948185224762, -782.6043779841912, -704.4174424911336], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.347976536589503, "mean_inference_ms": 0.41010854778308753, "mean_action_processing_ms": 0.09689025361539988, "mean_env_wait_ms": 2.702290867175276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042378902435302734, "StateBufferConnector_ms": 0.0033288002014160156, "ViewRequirementAgentConnector_ms": 0.07776427268981934}}, "episode_reward_max": -322.71637248421234, "episode_reward_min": -1183.897304565789, "episode_reward_mean": -722.9325673584989, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-820.173605473203, -768.5212560632556, -604.5459644699913, -749.0018730065776, -1025.864595518578, -769.7976833526562, -648.5470854658201, -721.529722719201, -740.6662003606299, -844.9133663279711, -760.7070604717552, -1111.1029768565718, -692.2693691598017, -663.3715201323328, -613.3569157791644, -712.7716736444878, -969.3761222584264, -682.1853674091266, -430.859253196766, -626.9057677676295, -394.174631242734, -881.8621199270841, -701.8105128347617, -571.5220785657247, -802.2847505080613, -778.1681600158208, -764.856613003843, -765.477687007436, -863.9423302498174, -588.7892968141871, -713.8304580899942, -921.8719907563013, -515.9857948358177, -728.3332052937448, -1058.6597146773095, -519.0847515061027, -800.501593661656, -733.5674465909572, -843.7243069065254, -775.8874032221368, -492.42814381428286, -510.1217799759738, -674.2841542415847, -420.860825726447, -803.962597155909, -641.1798927495181, -322.71637248421234, -1068.3710173946247, -783.8140081094656, -778.1751815208966, -749.5082392107654, -1106.2968516395651, -716.1747253111616, -431.89278021635204, -510.7795792231949, -803.3883496587829, -1183.897304565789, -687.2759648547272, -658.7328140597681, -747.3915730788775, -528.2065014873695, -713.9229522500578, -968.8361075338797, -745.5969363095093, -925.1504055452456, -781.9658152033769, -482.1656370712828, -633.7974625198785, -843.1419560493296, -494.9268878267914, -728.7710160549568, -407.1850115070204, -556.4423050944647, -752.4553015690863, -683.1511278189711, -755.9634231077051, -879.4087224106784, -597.8825103006533, -929.6118089726612, -685.4104215993268, -792.4918267035575, -375.23106874514923, -718.2694750728991, -885.6244968640651, -857.5168079049236, -726.005393145418, -707.4462002130316, -1016.4463060166293, -638.7713585906026, -631.3172503155583, -441.13005998883165, -560.0535285752172, -835.5559653520096, -843.424134268684, -611.3110755033473, -940.0635300723793, -589.5815624494086, -769.948185224762, -782.6043779841912, -704.4174424911336], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.347976536589503, "mean_inference_ms": 0.41010854778308753, "mean_action_processing_ms": 0.09689025361539988, "mean_env_wait_ms": 2.702290867175276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042378902435302734, "StateBufferConnector_ms": 0.0033288002014160156, "ViewRequirementAgentConnector_ms": 0.07776427268981934}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 319680, "num_agent_steps_trained": 319680, "num_env_steps_sampled": 319680, "num_env_steps_trained": 319680, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.54317047764421, "num_env_steps_trained_throughput_per_sec": 40.54317047764421, "timesteps_total": 319680, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 319680, "timers": {"training_iteration_time_ms": 2932.554, "sample_time_ms": 2928.55, "load_time_ms": 0.231, "load_throughput": 518882.969, "learn_time_ms": 2.956, "learn_throughput": 40589.711, "synch_weights_time_ms": 0.766}, "counters": {"num_env_steps_sampled": 319680, "num_env_steps_trained": 319680, "num_agent_steps_sampled": 319680, "num_agent_steps_trained": 319680}, "done": false, "episodes_total": 2664, "training_iteration": 667, "trial_id": "53665_00000", "date": "2023-07-26_04-02-09", "timestamp": 1690333329, "time_this_iter_s": 11.84192180633545, "time_total_s": 8066.116096496582, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2444.7906205654144, "iterations_since_restore": 207, "perf": {"cpu_util_percent": 39.864705882352936, "ram_util_percent": 78.18823529411765}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4825439453125, "policy_loss": -61971.9375, "vf_loss": 1727821.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 830.0, "diff_num_grad_updates_vs_sampler_policy": 829.0}}, "num_env_steps_sampled": 320160, "num_env_steps_trained": 320160, "num_agent_steps_sampled": 320160, "num_agent_steps_trained": 320160}, "sampler_results": {"episode_reward_max": -322.71637248421234, "episode_reward_min": -1183.897304565789, "episode_reward_mean": -724.6150711248192, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1025.864595518578, -769.7976833526562, -648.5470854658201, -721.529722719201, -740.6662003606299, -844.9133663279711, -760.7070604717552, -1111.1029768565718, -692.2693691598017, -663.3715201323328, -613.3569157791644, -712.7716736444878, -969.3761222584264, -682.1853674091266, -430.859253196766, -626.9057677676295, -394.174631242734, -881.8621199270841, -701.8105128347617, -571.5220785657247, -802.2847505080613, -778.1681600158208, -764.856613003843, -765.477687007436, -863.9423302498174, -588.7892968141871, -713.8304580899942, -921.8719907563013, -515.9857948358177, -728.3332052937448, -1058.6597146773095, -519.0847515061027, -800.501593661656, -733.5674465909572, -843.7243069065254, -775.8874032221368, -492.42814381428286, -510.1217799759738, -674.2841542415847, -420.860825726447, -803.962597155909, -641.1798927495181, -322.71637248421234, -1068.3710173946247, -783.8140081094656, -778.1751815208966, -749.5082392107654, -1106.2968516395651, -716.1747253111616, -431.89278021635204, -510.7795792231949, -803.3883496587829, -1183.897304565789, -687.2759648547272, -658.7328140597681, -747.3915730788775, -528.2065014873695, -713.9229522500578, -968.8361075338797, -745.5969363095093, -925.1504055452456, -781.9658152033769, -482.1656370712828, -633.7974625198785, -843.1419560493296, -494.9268878267914, -728.7710160549568, -407.1850115070204, -556.4423050944647, -752.4553015690863, -683.1511278189711, -755.9634231077051, -879.4087224106784, -597.8825103006533, -929.6118089726612, -685.4104215993268, -792.4918267035575, -375.23106874514923, -718.2694750728991, -885.6244968640651, -857.5168079049236, -726.005393145418, -707.4462002130316, -1016.4463060166293, -638.7713585906026, -631.3172503155583, -441.13005998883165, -560.0535285752172, -835.5559653520096, -843.424134268684, -611.3110755033473, -940.0635300723793, -589.5815624494086, -769.948185224762, -782.6043779841912, -704.4174424911336, -714.7293239381523, -1083.910615176363, -769.1968810199785, -542.6562555105581], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.34907670175771, "mean_inference_ms": 0.41022831192990467, "mean_action_processing_ms": 0.09691168073112873, "mean_env_wait_ms": 2.7024532220482906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004220724105834961, "StateBufferConnector_ms": 0.0033271312713623047, "ViewRequirementAgentConnector_ms": 0.07762861251831055}}, "episode_reward_max": -322.71637248421234, "episode_reward_min": -1183.897304565789, "episode_reward_mean": -724.6150711248192, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1025.864595518578, -769.7976833526562, -648.5470854658201, -721.529722719201, -740.6662003606299, -844.9133663279711, -760.7070604717552, -1111.1029768565718, -692.2693691598017, -663.3715201323328, -613.3569157791644, -712.7716736444878, -969.3761222584264, -682.1853674091266, -430.859253196766, -626.9057677676295, -394.174631242734, -881.8621199270841, -701.8105128347617, -571.5220785657247, -802.2847505080613, -778.1681600158208, -764.856613003843, -765.477687007436, -863.9423302498174, -588.7892968141871, -713.8304580899942, -921.8719907563013, -515.9857948358177, -728.3332052937448, -1058.6597146773095, -519.0847515061027, -800.501593661656, -733.5674465909572, -843.7243069065254, -775.8874032221368, -492.42814381428286, -510.1217799759738, -674.2841542415847, -420.860825726447, -803.962597155909, -641.1798927495181, -322.71637248421234, -1068.3710173946247, -783.8140081094656, -778.1751815208966, -749.5082392107654, -1106.2968516395651, -716.1747253111616, -431.89278021635204, -510.7795792231949, -803.3883496587829, -1183.897304565789, -687.2759648547272, -658.7328140597681, -747.3915730788775, -528.2065014873695, -713.9229522500578, -968.8361075338797, -745.5969363095093, -925.1504055452456, -781.9658152033769, -482.1656370712828, -633.7974625198785, -843.1419560493296, -494.9268878267914, -728.7710160549568, -407.1850115070204, -556.4423050944647, -752.4553015690863, -683.1511278189711, -755.9634231077051, -879.4087224106784, -597.8825103006533, -929.6118089726612, -685.4104215993268, -792.4918267035575, -375.23106874514923, -718.2694750728991, -885.6244968640651, -857.5168079049236, -726.005393145418, -707.4462002130316, -1016.4463060166293, -638.7713585906026, -631.3172503155583, -441.13005998883165, -560.0535285752172, -835.5559653520096, -843.424134268684, -611.3110755033473, -940.0635300723793, -589.5815624494086, -769.948185224762, -782.6043779841912, -704.4174424911336, -714.7293239381523, -1083.910615176363, -769.1968810199785, -542.6562555105581], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.34907670175771, "mean_inference_ms": 0.41022831192990467, "mean_action_processing_ms": 0.09691168073112873, "mean_env_wait_ms": 2.7024532220482906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004220724105834961, "StateBufferConnector_ms": 0.0033271312713623047, "ViewRequirementAgentConnector_ms": 0.07762861251831055}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320160, "num_agent_steps_trained": 320160, "num_env_steps_sampled": 320160, "num_env_steps_trained": 320160, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.50410386367166, "num_env_steps_trained_throughput_per_sec": 40.50410386367166, "timesteps_total": 320160, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 320160, "timers": {"training_iteration_time_ms": 2941.54, "sample_time_ms": 2937.662, "load_time_ms": 0.222, "load_throughput": 540851.58, "learn_time_ms": 2.864, "learn_throughput": 41902.185, "synch_weights_time_ms": 0.747}, "counters": {"num_env_steps_sampled": 320160, "num_env_steps_trained": 320160, "num_agent_steps_sampled": 320160, "num_agent_steps_trained": 320160}, "done": false, "episodes_total": 2668, "training_iteration": 668, "trial_id": "53665_00000", "date": "2023-07-26_04-02-21", "timestamp": 1690333341, "time_this_iter_s": 11.853466987609863, "time_total_s": 8077.969563484192, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2456.6440875530243, "iterations_since_restore": 208, "perf": {"cpu_util_percent": 41.188235294117646, "ram_util_percent": 77.69411764705883}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4720458984375, "policy_loss": -85605.640625, "vf_loss": 3345910.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 834.0, "diff_num_grad_updates_vs_sampler_policy": 833.0}}, "num_env_steps_sampled": 320640, "num_env_steps_trained": 320640, "num_agent_steps_sampled": 320640, "num_agent_steps_trained": 320640}, "sampler_results": {"episode_reward_max": -322.71637248421234, "episode_reward_min": -1183.897304565789, "episode_reward_mean": -719.497213612916, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-740.6662003606299, -844.9133663279711, -760.7070604717552, -1111.1029768565718, -692.2693691598017, -663.3715201323328, -613.3569157791644, -712.7716736444878, -969.3761222584264, -682.1853674091266, -430.859253196766, -626.9057677676295, -394.174631242734, -881.8621199270841, -701.8105128347617, -571.5220785657247, -802.2847505080613, -778.1681600158208, -764.856613003843, -765.477687007436, -863.9423302498174, -588.7892968141871, -713.8304580899942, -921.8719907563013, -515.9857948358177, -728.3332052937448, -1058.6597146773095, -519.0847515061027, -800.501593661656, -733.5674465909572, -843.7243069065254, -775.8874032221368, -492.42814381428286, -510.1217799759738, -674.2841542415847, -420.860825726447, -803.962597155909, -641.1798927495181, -322.71637248421234, -1068.3710173946247, -783.8140081094656, -778.1751815208966, -749.5082392107654, -1106.2968516395651, -716.1747253111616, -431.89278021635204, -510.7795792231949, -803.3883496587829, -1183.897304565789, -687.2759648547272, -658.7328140597681, -747.3915730788775, -528.2065014873695, -713.9229522500578, -968.8361075338797, -745.5969363095093, -925.1504055452456, -781.9658152033769, -482.1656370712828, -633.7974625198785, -843.1419560493296, -494.9268878267914, -728.7710160549568, -407.1850115070204, -556.4423050944647, -752.4553015690863, -683.1511278189711, -755.9634231077051, -879.4087224106784, -597.8825103006533, -929.6118089726612, -685.4104215993268, -792.4918267035575, -375.23106874514923, -718.2694750728991, -885.6244968640651, -857.5168079049236, -726.005393145418, -707.4462002130316, -1016.4463060166293, -638.7713585906026, -631.3172503155583, -441.13005998883165, -560.0535285752172, -835.5559653520096, -843.424134268684, -611.3110755033473, -940.0635300723793, -589.5815624494086, -769.948185224762, -782.6043779841912, -704.4174424911336, -714.7293239381523, -1083.910615176363, -769.1968810199785, -542.6562555105581, -887.1834975034957, -646.3894723048414, -415.3002837498957, -705.0800823076884], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.350011232348383, "mean_inference_ms": 0.41033678362861264, "mean_action_processing_ms": 0.09693120314097076, "mean_env_wait_ms": 2.7025920957710867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004218578338623047, "StateBufferConnector_ms": 0.003325223922729492, "ViewRequirementAgentConnector_ms": 0.07768368721008301}}, "episode_reward_max": -322.71637248421234, "episode_reward_min": -1183.897304565789, "episode_reward_mean": -719.497213612916, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-740.6662003606299, -844.9133663279711, -760.7070604717552, -1111.1029768565718, -692.2693691598017, -663.3715201323328, -613.3569157791644, -712.7716736444878, -969.3761222584264, -682.1853674091266, -430.859253196766, -626.9057677676295, -394.174631242734, -881.8621199270841, -701.8105128347617, -571.5220785657247, -802.2847505080613, -778.1681600158208, -764.856613003843, -765.477687007436, -863.9423302498174, -588.7892968141871, -713.8304580899942, -921.8719907563013, -515.9857948358177, -728.3332052937448, -1058.6597146773095, -519.0847515061027, -800.501593661656, -733.5674465909572, -843.7243069065254, -775.8874032221368, -492.42814381428286, -510.1217799759738, -674.2841542415847, -420.860825726447, -803.962597155909, -641.1798927495181, -322.71637248421234, -1068.3710173946247, -783.8140081094656, -778.1751815208966, -749.5082392107654, -1106.2968516395651, -716.1747253111616, -431.89278021635204, -510.7795792231949, -803.3883496587829, -1183.897304565789, -687.2759648547272, -658.7328140597681, -747.3915730788775, -528.2065014873695, -713.9229522500578, -968.8361075338797, -745.5969363095093, -925.1504055452456, -781.9658152033769, -482.1656370712828, -633.7974625198785, -843.1419560493296, -494.9268878267914, -728.7710160549568, -407.1850115070204, -556.4423050944647, -752.4553015690863, -683.1511278189711, -755.9634231077051, -879.4087224106784, -597.8825103006533, -929.6118089726612, -685.4104215993268, -792.4918267035575, -375.23106874514923, -718.2694750728991, -885.6244968640651, -857.5168079049236, -726.005393145418, -707.4462002130316, -1016.4463060166293, -638.7713585906026, -631.3172503155583, -441.13005998883165, -560.0535285752172, -835.5559653520096, -843.424134268684, -611.3110755033473, -940.0635300723793, -589.5815624494086, -769.948185224762, -782.6043779841912, -704.4174424911336, -714.7293239381523, -1083.910615176363, -769.1968810199785, -542.6562555105581, -887.1834975034957, -646.3894723048414, -415.3002837498957, -705.0800823076884], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.350011232348383, "mean_inference_ms": 0.41033678362861264, "mean_action_processing_ms": 0.09693120314097076, "mean_env_wait_ms": 2.7025920957710867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004218578338623047, "StateBufferConnector_ms": 0.003325223922729492, "ViewRequirementAgentConnector_ms": 0.07768368721008301}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320640, "num_agent_steps_trained": 320640, "num_env_steps_sampled": 320640, "num_env_steps_trained": 320640, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.55134413536593, "num_env_steps_trained_throughput_per_sec": 41.55134413536593, "timesteps_total": 320640, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 320640, "timers": {"training_iteration_time_ms": 2925.808, "sample_time_ms": 2922.039, "load_time_ms": 0.213, "load_throughput": 564003.227, "learn_time_ms": 2.811, "learn_throughput": 42685.41, "synch_weights_time_ms": 0.703}, "counters": {"num_env_steps_sampled": 320640, "num_env_steps_trained": 320640, "num_agent_steps_sampled": 320640, "num_agent_steps_trained": 320640}, "done": false, "episodes_total": 2672, "training_iteration": 669, "trial_id": "53665_00000", "date": "2023-07-26_04-02-32", "timestamp": 1690333352, "time_this_iter_s": 11.554905891418457, "time_total_s": 8089.52446937561, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2468.1989934444427, "iterations_since_restore": 209, "perf": {"cpu_util_percent": 50.181250000000006, "ram_util_percent": 76.325}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4859313964844, "policy_loss": -121482.7734375, "vf_loss": 6805061.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 838.0, "diff_num_grad_updates_vs_sampler_policy": 837.0}}, "num_env_steps_sampled": 321120, "num_env_steps_trained": 321120, "num_agent_steps_sampled": 321120, "num_agent_steps_trained": 321120}, "sampler_results": {"episode_reward_max": -322.71637248421234, "episode_reward_min": -1392.0773174553171, "episode_reward_mean": -727.3246591457649, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-692.2693691598017, -663.3715201323328, -613.3569157791644, -712.7716736444878, -969.3761222584264, -682.1853674091266, -430.859253196766, -626.9057677676295, -394.174631242734, -881.8621199270841, -701.8105128347617, -571.5220785657247, -802.2847505080613, -778.1681600158208, -764.856613003843, -765.477687007436, -863.9423302498174, -588.7892968141871, -713.8304580899942, -921.8719907563013, -515.9857948358177, -728.3332052937448, -1058.6597146773095, -519.0847515061027, -800.501593661656, -733.5674465909572, -843.7243069065254, -775.8874032221368, -492.42814381428286, -510.1217799759738, -674.2841542415847, -420.860825726447, -803.962597155909, -641.1798927495181, -322.71637248421234, -1068.3710173946247, -783.8140081094656, -778.1751815208966, -749.5082392107654, -1106.2968516395651, -716.1747253111616, -431.89278021635204, -510.7795792231949, -803.3883496587829, -1183.897304565789, -687.2759648547272, -658.7328140597681, -747.3915730788775, -528.2065014873695, -713.9229522500578, -968.8361075338797, -745.5969363095093, -925.1504055452456, -781.9658152033769, -482.1656370712828, -633.7974625198785, -843.1419560493296, -494.9268878267914, -728.7710160549568, -407.1850115070204, -556.4423050944647, -752.4553015690863, -683.1511278189711, -755.9634231077051, -879.4087224106784, -597.8825103006533, -929.6118089726612, -685.4104215993268, -792.4918267035575, -375.23106874514923, -718.2694750728991, -885.6244968640651, -857.5168079049236, -726.005393145418, -707.4462002130316, -1016.4463060166293, -638.7713585906026, -631.3172503155583, -441.13005998883165, -560.0535285752172, -835.5559653520096, -843.424134268684, -611.3110755033473, -940.0635300723793, -589.5815624494086, -769.948185224762, -782.6043779841912, -704.4174424911336, -714.7293239381523, -1083.910615176363, -769.1968810199785, -542.6562555105581, -887.1834975034957, -646.3894723048414, -415.3002837498957, -705.0800823076884, -1392.0773174553171, -1020.9090882897663, -864.4122305929538, -962.7355209637891], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.351109214708746, "mean_inference_ms": 0.4104520966342325, "mean_action_processing_ms": 0.09695006734242374, "mean_env_wait_ms": 2.7027417629565975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004190206527709961, "StateBufferConnector_ms": 0.0033006668090820312, "ViewRequirementAgentConnector_ms": 0.07744646072387695}}, "episode_reward_max": -322.71637248421234, "episode_reward_min": -1392.0773174553171, "episode_reward_mean": -727.3246591457649, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-692.2693691598017, -663.3715201323328, -613.3569157791644, -712.7716736444878, -969.3761222584264, -682.1853674091266, -430.859253196766, -626.9057677676295, -394.174631242734, -881.8621199270841, -701.8105128347617, -571.5220785657247, -802.2847505080613, -778.1681600158208, -764.856613003843, -765.477687007436, -863.9423302498174, -588.7892968141871, -713.8304580899942, -921.8719907563013, -515.9857948358177, -728.3332052937448, -1058.6597146773095, -519.0847515061027, -800.501593661656, -733.5674465909572, -843.7243069065254, -775.8874032221368, -492.42814381428286, -510.1217799759738, -674.2841542415847, -420.860825726447, -803.962597155909, -641.1798927495181, -322.71637248421234, -1068.3710173946247, -783.8140081094656, -778.1751815208966, -749.5082392107654, -1106.2968516395651, -716.1747253111616, -431.89278021635204, -510.7795792231949, -803.3883496587829, -1183.897304565789, -687.2759648547272, -658.7328140597681, -747.3915730788775, -528.2065014873695, -713.9229522500578, -968.8361075338797, -745.5969363095093, -925.1504055452456, -781.9658152033769, -482.1656370712828, -633.7974625198785, -843.1419560493296, -494.9268878267914, -728.7710160549568, -407.1850115070204, -556.4423050944647, -752.4553015690863, -683.1511278189711, -755.9634231077051, -879.4087224106784, -597.8825103006533, -929.6118089726612, -685.4104215993268, -792.4918267035575, -375.23106874514923, -718.2694750728991, -885.6244968640651, -857.5168079049236, -726.005393145418, -707.4462002130316, -1016.4463060166293, -638.7713585906026, -631.3172503155583, -441.13005998883165, -560.0535285752172, -835.5559653520096, -843.424134268684, -611.3110755033473, -940.0635300723793, -589.5815624494086, -769.948185224762, -782.6043779841912, -704.4174424911336, -714.7293239381523, -1083.910615176363, -769.1968810199785, -542.6562555105581, -887.1834975034957, -646.3894723048414, -415.3002837498957, -705.0800823076884, -1392.0773174553171, -1020.9090882897663, -864.4122305929538, -962.7355209637891], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.351109214708746, "mean_inference_ms": 0.4104520966342325, "mean_action_processing_ms": 0.09695006734242374, "mean_env_wait_ms": 2.7027417629565975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004190206527709961, "StateBufferConnector_ms": 0.0033006668090820312, "ViewRequirementAgentConnector_ms": 0.07744646072387695}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 321120, "num_agent_steps_trained": 321120, "num_env_steps_sampled": 321120, "num_env_steps_trained": 321120, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.91186264631818, "num_env_steps_trained_throughput_per_sec": 38.91186264631818, "timesteps_total": 321120, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 321120, "timers": {"training_iteration_time_ms": 2996.393, "sample_time_ms": 2990.391, "load_time_ms": 0.224, "load_throughput": 534874.049, "learn_time_ms": 4.898, "learn_throughput": 24499.916, "synch_weights_time_ms": 0.834}, "counters": {"num_env_steps_sampled": 321120, "num_env_steps_trained": 321120, "num_agent_steps_sampled": 321120, "num_agent_steps_trained": 321120}, "done": false, "episodes_total": 2676, "training_iteration": 670, "trial_id": "53665_00000", "date": "2023-07-26_04-02-45", "timestamp": 1690333365, "time_this_iter_s": 12.338337898254395, "time_total_s": 8101.862807273865, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2480.537331342697, "iterations_since_restore": 210, "perf": {"cpu_util_percent": 46.0611111111111, "ram_util_percent": 74.81666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.49700927734375, "policy_loss": -95443.5078125, "vf_loss": 4456058.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 841.0, "diff_num_grad_updates_vs_sampler_policy": 840.0}}, "num_env_steps_sampled": 321480, "num_env_steps_trained": 321480, "num_agent_steps_sampled": 321480, "num_agent_steps_trained": 321480}, "sampler_results": {"episode_reward_max": -322.71637248421234, "episode_reward_min": -1394.7960535385373, "episode_reward_mean": -731.6488008626604, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-712.7716736444878, -969.3761222584264, -682.1853674091266, -430.859253196766, -626.9057677676295, -394.174631242734, -881.8621199270841, -701.8105128347617, -571.5220785657247, -802.2847505080613, -778.1681600158208, -764.856613003843, -765.477687007436, -863.9423302498174, -588.7892968141871, -713.8304580899942, -921.8719907563013, -515.9857948358177, -728.3332052937448, -1058.6597146773095, -519.0847515061027, -800.501593661656, -733.5674465909572, -843.7243069065254, -775.8874032221368, -492.42814381428286, -510.1217799759738, -674.2841542415847, -420.860825726447, -803.962597155909, -641.1798927495181, -322.71637248421234, -1068.3710173946247, -783.8140081094656, -778.1751815208966, -749.5082392107654, -1106.2968516395651, -716.1747253111616, -431.89278021635204, -510.7795792231949, -803.3883496587829, -1183.897304565789, -687.2759648547272, -658.7328140597681, -747.3915730788775, -528.2065014873695, -713.9229522500578, -968.8361075338797, -745.5969363095093, -925.1504055452456, -781.9658152033769, -482.1656370712828, -633.7974625198785, -843.1419560493296, -494.9268878267914, -728.7710160549568, -407.1850115070204, -556.4423050944647, -752.4553015690863, -683.1511278189711, -755.9634231077051, -879.4087224106784, -597.8825103006533, -929.6118089726612, -685.4104215993268, -792.4918267035575, -375.23106874514923, -718.2694750728991, -885.6244968640651, -857.5168079049236, -726.005393145418, -707.4462002130316, -1016.4463060166293, -638.7713585906026, -631.3172503155583, -441.13005998883165, -560.0535285752172, -835.5559653520096, -843.424134268684, -611.3110755033473, -940.0635300723793, -589.5815624494086, -769.948185224762, -782.6043779841912, -704.4174424911336, -714.7293239381523, -1083.910615176363, -769.1968810199785, -542.6562555105581, -887.1834975034957, -646.3894723048414, -415.3002837498957, -705.0800823076884, -1392.0773174553171, -1020.9090882897663, -864.4122305929538, -962.7355209637891, -395.6942547300457, -1394.7960535385373, -610.9216684922756], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.352268036211953, "mean_inference_ms": 0.4105512582416951, "mean_action_processing_ms": 0.09696613296415287, "mean_env_wait_ms": 2.7028858023203206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042340755462646484, "StateBufferConnector_ms": 0.0033235549926757812, "ViewRequirementAgentConnector_ms": 0.0780329704284668}}, "episode_reward_max": -322.71637248421234, "episode_reward_min": -1394.7960535385373, "episode_reward_mean": -731.6488008626604, "episode_len_mean": 120.0, "episodes_this_iter": 3, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-712.7716736444878, -969.3761222584264, -682.1853674091266, -430.859253196766, -626.9057677676295, -394.174631242734, -881.8621199270841, -701.8105128347617, -571.5220785657247, -802.2847505080613, -778.1681600158208, -764.856613003843, -765.477687007436, -863.9423302498174, -588.7892968141871, -713.8304580899942, -921.8719907563013, -515.9857948358177, -728.3332052937448, -1058.6597146773095, -519.0847515061027, -800.501593661656, -733.5674465909572, -843.7243069065254, -775.8874032221368, -492.42814381428286, -510.1217799759738, -674.2841542415847, -420.860825726447, -803.962597155909, -641.1798927495181, -322.71637248421234, -1068.3710173946247, -783.8140081094656, -778.1751815208966, -749.5082392107654, -1106.2968516395651, -716.1747253111616, -431.89278021635204, -510.7795792231949, -803.3883496587829, -1183.897304565789, -687.2759648547272, -658.7328140597681, -747.3915730788775, -528.2065014873695, -713.9229522500578, -968.8361075338797, -745.5969363095093, -925.1504055452456, -781.9658152033769, -482.1656370712828, -633.7974625198785, -843.1419560493296, -494.9268878267914, -728.7710160549568, -407.1850115070204, -556.4423050944647, -752.4553015690863, -683.1511278189711, -755.9634231077051, -879.4087224106784, -597.8825103006533, -929.6118089726612, -685.4104215993268, -792.4918267035575, -375.23106874514923, -718.2694750728991, -885.6244968640651, -857.5168079049236, -726.005393145418, -707.4462002130316, -1016.4463060166293, -638.7713585906026, -631.3172503155583, -441.13005998883165, -560.0535285752172, -835.5559653520096, -843.424134268684, -611.3110755033473, -940.0635300723793, -589.5815624494086, -769.948185224762, -782.6043779841912, -704.4174424911336, -714.7293239381523, -1083.910615176363, -769.1968810199785, -542.6562555105581, -887.1834975034957, -646.3894723048414, -415.3002837498957, -705.0800823076884, -1392.0773174553171, -1020.9090882897663, -864.4122305929538, -962.7355209637891, -395.6942547300457, -1394.7960535385373, -610.9216684922756], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.352268036211953, "mean_inference_ms": 0.4105512582416951, "mean_action_processing_ms": 0.09696613296415287, "mean_env_wait_ms": 2.7028858023203206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042340755462646484, "StateBufferConnector_ms": 0.0033235549926757812, "ViewRequirementAgentConnector_ms": 0.0780329704284668}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 321480, "num_agent_steps_trained": 321480, "num_env_steps_sampled": 321480, "num_env_steps_trained": 321480, "num_env_steps_sampled_this_iter": 360, "num_env_steps_trained_this_iter": 360, "num_env_steps_sampled_throughput_per_sec": 34.511127228524956, "num_env_steps_trained_throughput_per_sec": 34.511127228524956, "timesteps_total": 321480, "num_steps_trained_this_iter": 360, "agent_timesteps_total": 321480, "timers": {"training_iteration_time_ms": 3139.269, "sample_time_ms": 3133.069, "load_time_ms": 0.235, "load_throughput": 511136.874, "learn_time_ms": 5.012, "learn_throughput": 23944.077, "synch_weights_time_ms": 0.904}, "counters": {"num_env_steps_sampled": 321480, "num_env_steps_trained": 321480, "num_agent_steps_sampled": 321480, "num_agent_steps_trained": 321480}, "done": false, "episodes_total": 2679, "training_iteration": 671, "trial_id": "53665_00000", "date": "2023-07-26_04-02-55", "timestamp": 1690333375, "time_this_iter_s": 10.436173915863037, "time_total_s": 8112.298981189728, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2490.97350525856, "iterations_since_restore": 211, "perf": {"cpu_util_percent": 51.75714285714286, "ram_util_percent": 76.84285714285714}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4820861816406, "policy_loss": -74370.6875, "vf_loss": 2442143.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 845.0, "diff_num_grad_updates_vs_sampler_policy": 844.0}}, "num_env_steps_sampled": 321960, "num_env_steps_trained": 321960, "num_agent_steps_sampled": 321960, "num_agent_steps_trained": 321960}, "sampler_results": {"episode_reward_max": -322.71637248421234, "episode_reward_min": -1394.7960535385373, "episode_reward_mean": -726.5435043660071, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-626.9057677676295, -394.174631242734, -881.8621199270841, -701.8105128347617, -571.5220785657247, -802.2847505080613, -778.1681600158208, -764.856613003843, -765.477687007436, -863.9423302498174, -588.7892968141871, -713.8304580899942, -921.8719907563013, -515.9857948358177, -728.3332052937448, -1058.6597146773095, -519.0847515061027, -800.501593661656, -733.5674465909572, -843.7243069065254, -775.8874032221368, -492.42814381428286, -510.1217799759738, -674.2841542415847, -420.860825726447, -803.962597155909, -641.1798927495181, -322.71637248421234, -1068.3710173946247, -783.8140081094656, -778.1751815208966, -749.5082392107654, -1106.2968516395651, -716.1747253111616, -431.89278021635204, -510.7795792231949, -803.3883496587829, -1183.897304565789, -687.2759648547272, -658.7328140597681, -747.3915730788775, -528.2065014873695, -713.9229522500578, -968.8361075338797, -745.5969363095093, -925.1504055452456, -781.9658152033769, -482.1656370712828, -633.7974625198785, -843.1419560493296, -494.9268878267914, -728.7710160549568, -407.1850115070204, -556.4423050944647, -752.4553015690863, -683.1511278189711, -755.9634231077051, -879.4087224106784, -597.8825103006533, -929.6118089726612, -685.4104215993268, -792.4918267035575, -375.23106874514923, -718.2694750728991, -885.6244968640651, -857.5168079049236, -726.005393145418, -707.4462002130316, -1016.4463060166293, -638.7713585906026, -631.3172503155583, -441.13005998883165, -560.0535285752172, -835.5559653520096, -843.424134268684, -611.3110755033473, -940.0635300723793, -589.5815624494086, -769.948185224762, -782.6043779841912, -704.4174424911336, -714.7293239381523, -1083.910615176363, -769.1968810199785, -542.6562555105581, -887.1834975034957, -646.3894723048414, -415.3002837498957, -705.0800823076884, -1392.0773174553171, -1020.9090882897663, -864.4122305929538, -962.7355209637891, -395.6942547300457, -1394.7960535385373, -610.9216684922756, -530.8434302800124, -520.6665755719677, -657.9661195557549, -575.1866414357245], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.353729510692425, "mean_inference_ms": 0.41068765851132016, "mean_action_processing_ms": 0.09698832470525975, "mean_env_wait_ms": 2.7030690762304697, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042285919189453125, "StateBufferConnector_ms": 0.0033211708068847656, "ViewRequirementAgentConnector_ms": 0.07800889015197754}}, "episode_reward_max": -322.71637248421234, "episode_reward_min": -1394.7960535385373, "episode_reward_mean": -726.5435043660071, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-626.9057677676295, -394.174631242734, -881.8621199270841, -701.8105128347617, -571.5220785657247, -802.2847505080613, -778.1681600158208, -764.856613003843, -765.477687007436, -863.9423302498174, -588.7892968141871, -713.8304580899942, -921.8719907563013, -515.9857948358177, -728.3332052937448, -1058.6597146773095, -519.0847515061027, -800.501593661656, -733.5674465909572, -843.7243069065254, -775.8874032221368, -492.42814381428286, -510.1217799759738, -674.2841542415847, -420.860825726447, -803.962597155909, -641.1798927495181, -322.71637248421234, -1068.3710173946247, -783.8140081094656, -778.1751815208966, -749.5082392107654, -1106.2968516395651, -716.1747253111616, -431.89278021635204, -510.7795792231949, -803.3883496587829, -1183.897304565789, -687.2759648547272, -658.7328140597681, -747.3915730788775, -528.2065014873695, -713.9229522500578, -968.8361075338797, -745.5969363095093, -925.1504055452456, -781.9658152033769, -482.1656370712828, -633.7974625198785, -843.1419560493296, -494.9268878267914, -728.7710160549568, -407.1850115070204, -556.4423050944647, -752.4553015690863, -683.1511278189711, -755.9634231077051, -879.4087224106784, -597.8825103006533, -929.6118089726612, -685.4104215993268, -792.4918267035575, -375.23106874514923, -718.2694750728991, -885.6244968640651, -857.5168079049236, -726.005393145418, -707.4462002130316, -1016.4463060166293, -638.7713585906026, -631.3172503155583, -441.13005998883165, -560.0535285752172, -835.5559653520096, -843.424134268684, -611.3110755033473, -940.0635300723793, -589.5815624494086, -769.948185224762, -782.6043779841912, -704.4174424911336, -714.7293239381523, -1083.910615176363, -769.1968810199785, -542.6562555105581, -887.1834975034957, -646.3894723048414, -415.3002837498957, -705.0800823076884, -1392.0773174553171, -1020.9090882897663, -864.4122305929538, -962.7355209637891, -395.6942547300457, -1394.7960535385373, -610.9216684922756, -530.8434302800124, -520.6665755719677, -657.9661195557549, -575.1866414357245], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.353729510692425, "mean_inference_ms": 0.41068765851132016, "mean_action_processing_ms": 0.09698832470525975, "mean_env_wait_ms": 2.7030690762304697, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042285919189453125, "StateBufferConnector_ms": 0.0033211708068847656, "ViewRequirementAgentConnector_ms": 0.07800889015197754}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 321960, "num_agent_steps_trained": 321960, "num_env_steps_sampled": 321960, "num_env_steps_trained": 321960, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.023060268995856, "num_env_steps_trained_throughput_per_sec": 41.023060268995856, "timesteps_total": 321960, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 321960, "timers": {"training_iteration_time_ms": 3132.148, "sample_time_ms": 3128.13, "load_time_ms": 0.227, "load_throughput": 527585.409, "learn_time_ms": 2.965, "learn_throughput": 40478.071, "synch_weights_time_ms": 0.78}, "counters": {"num_env_steps_sampled": 321960, "num_env_steps_trained": 321960, "num_agent_steps_sampled": 321960, "num_agent_steps_trained": 321960}, "done": false, "episodes_total": 2683, "training_iteration": 672, "trial_id": "53665_00000", "date": "2023-07-26_04-03-07", "timestamp": 1690333387, "time_this_iter_s": 11.703521013259888, "time_total_s": 8124.002502202988, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2502.67702627182, "iterations_since_restore": 212, "perf": {"cpu_util_percent": 43.47058823529411, "ram_util_percent": 75.5764705882353}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4707336425781, "policy_loss": -107362.3359375, "vf_loss": 5083864.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 849.0, "diff_num_grad_updates_vs_sampler_policy": 848.0}}, "num_env_steps_sampled": 322440, "num_env_steps_trained": 322440, "num_agent_steps_sampled": 322440, "num_agent_steps_trained": 322440}, "sampler_results": {"episode_reward_max": -322.71637248421234, "episode_reward_min": -1394.7960535385373, "episode_reward_mean": -730.6763094495764, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-571.5220785657247, -802.2847505080613, -778.1681600158208, -764.856613003843, -765.477687007436, -863.9423302498174, -588.7892968141871, -713.8304580899942, -921.8719907563013, -515.9857948358177, -728.3332052937448, -1058.6597146773095, -519.0847515061027, -800.501593661656, -733.5674465909572, -843.7243069065254, -775.8874032221368, -492.42814381428286, -510.1217799759738, -674.2841542415847, -420.860825726447, -803.962597155909, -641.1798927495181, -322.71637248421234, -1068.3710173946247, -783.8140081094656, -778.1751815208966, -749.5082392107654, -1106.2968516395651, -716.1747253111616, -431.89278021635204, -510.7795792231949, -803.3883496587829, -1183.897304565789, -687.2759648547272, -658.7328140597681, -747.3915730788775, -528.2065014873695, -713.9229522500578, -968.8361075338797, -745.5969363095093, -925.1504055452456, -781.9658152033769, -482.1656370712828, -633.7974625198785, -843.1419560493296, -494.9268878267914, -728.7710160549568, -407.1850115070204, -556.4423050944647, -752.4553015690863, -683.1511278189711, -755.9634231077051, -879.4087224106784, -597.8825103006533, -929.6118089726612, -685.4104215993268, -792.4918267035575, -375.23106874514923, -718.2694750728991, -885.6244968640651, -857.5168079049236, -726.005393145418, -707.4462002130316, -1016.4463060166293, -638.7713585906026, -631.3172503155583, -441.13005998883165, -560.0535285752172, -835.5559653520096, -843.424134268684, -611.3110755033473, -940.0635300723793, -589.5815624494086, -769.948185224762, -782.6043779841912, -704.4174424911336, -714.7293239381523, -1083.910615176363, -769.1968810199785, -542.6562555105581, -887.1834975034957, -646.3894723048414, -415.3002837498957, -705.0800823076884, -1392.0773174553171, -1020.9090882897663, -864.4122305929538, -962.7355209637891, -395.6942547300457, -1394.7960535385373, -610.9216684922756, -530.8434302800124, -520.6665755719677, -657.9661195557549, -575.1866414357245, -899.6489232610088, -678.0447401003436, -661.9423248794734, -778.3975518883043], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.35532521788506, "mean_inference_ms": 0.41081624219333635, "mean_action_processing_ms": 0.09700909976545596, "mean_env_wait_ms": 2.703245741611679, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004150390625, "StateBufferConnector_ms": 0.003293752670288086, "ViewRequirementAgentConnector_ms": 0.07726073265075684}}, "episode_reward_max": -322.71637248421234, "episode_reward_min": -1394.7960535385373, "episode_reward_mean": -730.6763094495764, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-571.5220785657247, -802.2847505080613, -778.1681600158208, -764.856613003843, -765.477687007436, -863.9423302498174, -588.7892968141871, -713.8304580899942, -921.8719907563013, -515.9857948358177, -728.3332052937448, -1058.6597146773095, -519.0847515061027, -800.501593661656, -733.5674465909572, -843.7243069065254, -775.8874032221368, -492.42814381428286, -510.1217799759738, -674.2841542415847, -420.860825726447, -803.962597155909, -641.1798927495181, -322.71637248421234, -1068.3710173946247, -783.8140081094656, -778.1751815208966, -749.5082392107654, -1106.2968516395651, -716.1747253111616, -431.89278021635204, -510.7795792231949, -803.3883496587829, -1183.897304565789, -687.2759648547272, -658.7328140597681, -747.3915730788775, -528.2065014873695, -713.9229522500578, -968.8361075338797, -745.5969363095093, -925.1504055452456, -781.9658152033769, -482.1656370712828, -633.7974625198785, -843.1419560493296, -494.9268878267914, -728.7710160549568, -407.1850115070204, -556.4423050944647, -752.4553015690863, -683.1511278189711, -755.9634231077051, -879.4087224106784, -597.8825103006533, -929.6118089726612, -685.4104215993268, -792.4918267035575, -375.23106874514923, -718.2694750728991, -885.6244968640651, -857.5168079049236, -726.005393145418, -707.4462002130316, -1016.4463060166293, -638.7713585906026, -631.3172503155583, -441.13005998883165, -560.0535285752172, -835.5559653520096, -843.424134268684, -611.3110755033473, -940.0635300723793, -589.5815624494086, -769.948185224762, -782.6043779841912, -704.4174424911336, -714.7293239381523, -1083.910615176363, -769.1968810199785, -542.6562555105581, -887.1834975034957, -646.3894723048414, -415.3002837498957, -705.0800823076884, -1392.0773174553171, -1020.9090882897663, -864.4122305929538, -962.7355209637891, -395.6942547300457, -1394.7960535385373, -610.9216684922756, -530.8434302800124, -520.6665755719677, -657.9661195557549, -575.1866414357245, -899.6489232610088, -678.0447401003436, -661.9423248794734, -778.3975518883043], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.35532521788506, "mean_inference_ms": 0.41081624219333635, "mean_action_processing_ms": 0.09700909976545596, "mean_env_wait_ms": 2.703245741611679, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004150390625, "StateBufferConnector_ms": 0.003293752670288086, "ViewRequirementAgentConnector_ms": 0.07726073265075684}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 322440, "num_agent_steps_trained": 322440, "num_env_steps_sampled": 322440, "num_env_steps_trained": 322440, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.8535941075623, "num_env_steps_trained_throughput_per_sec": 39.8535941075623, "timesteps_total": 322440, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 322440, "timers": {"training_iteration_time_ms": 3127.056, "sample_time_ms": 3122.879, "load_time_ms": 0.238, "load_throughput": 504022.111, "learn_time_ms": 3.071, "learn_throughput": 39074.333, "synch_weights_time_ms": 0.817}, "counters": {"num_env_steps_sampled": 322440, "num_env_steps_trained": 322440, "num_agent_steps_sampled": 322440, "num_agent_steps_trained": 322440}, "done": false, "episodes_total": 2687, "training_iteration": 673, "trial_id": "53665_00000", "date": "2023-07-26_04-03-19", "timestamp": 1690333399, "time_this_iter_s": 12.0485360622406, "time_total_s": 8136.051038265228, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2514.7255623340607, "iterations_since_restore": 213, "perf": {"cpu_util_percent": 47.66470588235295, "ram_util_percent": 74.24117647058823}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4982604980469, "policy_loss": -140225.25, "vf_loss": 8236258.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 853.0, "diff_num_grad_updates_vs_sampler_policy": 852.0}}, "num_env_steps_sampled": 322920, "num_env_steps_trained": 322920, "num_agent_steps_sampled": 322920, "num_agent_steps_trained": 322920}, "sampler_results": {"episode_reward_max": -322.71637248421234, "episode_reward_min": -1394.7960535385373, "episode_reward_mean": -731.1760337940693, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-765.477687007436, -863.9423302498174, -588.7892968141871, -713.8304580899942, -921.8719907563013, -515.9857948358177, -728.3332052937448, -1058.6597146773095, -519.0847515061027, -800.501593661656, -733.5674465909572, -843.7243069065254, -775.8874032221368, -492.42814381428286, -510.1217799759738, -674.2841542415847, -420.860825726447, -803.962597155909, -641.1798927495181, -322.71637248421234, -1068.3710173946247, -783.8140081094656, -778.1751815208966, -749.5082392107654, -1106.2968516395651, -716.1747253111616, -431.89278021635204, -510.7795792231949, -803.3883496587829, -1183.897304565789, -687.2759648547272, -658.7328140597681, -747.3915730788775, -528.2065014873695, -713.9229522500578, -968.8361075338797, -745.5969363095093, -925.1504055452456, -781.9658152033769, -482.1656370712828, -633.7974625198785, -843.1419560493296, -494.9268878267914, -728.7710160549568, -407.1850115070204, -556.4423050944647, -752.4553015690863, -683.1511278189711, -755.9634231077051, -879.4087224106784, -597.8825103006533, -929.6118089726612, -685.4104215993268, -792.4918267035575, -375.23106874514923, -718.2694750728991, -885.6244968640651, -857.5168079049236, -726.005393145418, -707.4462002130316, -1016.4463060166293, -638.7713585906026, -631.3172503155583, -441.13005998883165, -560.0535285752172, -835.5559653520096, -843.424134268684, -611.3110755033473, -940.0635300723793, -589.5815624494086, -769.948185224762, -782.6043779841912, -704.4174424911336, -714.7293239381523, -1083.910615176363, -769.1968810199785, -542.6562555105581, -887.1834975034957, -646.3894723048414, -415.3002837498957, -705.0800823076884, -1392.0773174553171, -1020.9090882897663, -864.4122305929538, -962.7355209637891, -395.6942547300457, -1394.7960535385373, -610.9216684922756, -530.8434302800124, -520.6665755719677, -657.9661195557549, -575.1866414357245, -899.6489232610088, -678.0447401003436, -661.9423248794734, -778.3975518883043, -749.6262845382524, -659.496500060774, -547.3716511321522, -1010.3096008115671], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.357061329495465, "mean_inference_ms": 0.4109363375035514, "mean_action_processing_ms": 0.09702998072519829, "mean_env_wait_ms": 2.703490664264754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004174470901489258, "StateBufferConnector_ms": 0.003306150436401367, "ViewRequirementAgentConnector_ms": 0.07783842086791992}}, "episode_reward_max": -322.71637248421234, "episode_reward_min": -1394.7960535385373, "episode_reward_mean": -731.1760337940693, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-765.477687007436, -863.9423302498174, -588.7892968141871, -713.8304580899942, -921.8719907563013, -515.9857948358177, -728.3332052937448, -1058.6597146773095, -519.0847515061027, -800.501593661656, -733.5674465909572, -843.7243069065254, -775.8874032221368, -492.42814381428286, -510.1217799759738, -674.2841542415847, -420.860825726447, -803.962597155909, -641.1798927495181, -322.71637248421234, -1068.3710173946247, -783.8140081094656, -778.1751815208966, -749.5082392107654, -1106.2968516395651, -716.1747253111616, -431.89278021635204, -510.7795792231949, -803.3883496587829, -1183.897304565789, -687.2759648547272, -658.7328140597681, -747.3915730788775, -528.2065014873695, -713.9229522500578, -968.8361075338797, -745.5969363095093, -925.1504055452456, -781.9658152033769, -482.1656370712828, -633.7974625198785, -843.1419560493296, -494.9268878267914, -728.7710160549568, -407.1850115070204, -556.4423050944647, -752.4553015690863, -683.1511278189711, -755.9634231077051, -879.4087224106784, -597.8825103006533, -929.6118089726612, -685.4104215993268, -792.4918267035575, -375.23106874514923, -718.2694750728991, -885.6244968640651, -857.5168079049236, -726.005393145418, -707.4462002130316, -1016.4463060166293, -638.7713585906026, -631.3172503155583, -441.13005998883165, -560.0535285752172, -835.5559653520096, -843.424134268684, -611.3110755033473, -940.0635300723793, -589.5815624494086, -769.948185224762, -782.6043779841912, -704.4174424911336, -714.7293239381523, -1083.910615176363, -769.1968810199785, -542.6562555105581, -887.1834975034957, -646.3894723048414, -415.3002837498957, -705.0800823076884, -1392.0773174553171, -1020.9090882897663, -864.4122305929538, -962.7355209637891, -395.6942547300457, -1394.7960535385373, -610.9216684922756, -530.8434302800124, -520.6665755719677, -657.9661195557549, -575.1866414357245, -899.6489232610088, -678.0447401003436, -661.9423248794734, -778.3975518883043, -749.6262845382524, -659.496500060774, -547.3716511321522, -1010.3096008115671], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.357061329495465, "mean_inference_ms": 0.4109363375035514, "mean_action_processing_ms": 0.09702998072519829, "mean_env_wait_ms": 2.703490664264754, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004174470901489258, "StateBufferConnector_ms": 0.003306150436401367, "ViewRequirementAgentConnector_ms": 0.07783842086791992}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 322920, "num_agent_steps_trained": 322920, "num_env_steps_sampled": 322920, "num_env_steps_trained": 322920, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.42055616418765, "num_env_steps_trained_throughput_per_sec": 38.42055616418765, "timesteps_total": 322920, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 322920, "timers": {"training_iteration_time_ms": 3042.419, "sample_time_ms": 3038.424, "load_time_ms": 0.232, "load_throughput": 518081.812, "learn_time_ms": 2.959, "learn_throughput": 40552.756, "synch_weights_time_ms": 0.758}, "counters": {"num_env_steps_sampled": 322920, "num_env_steps_trained": 322920, "num_agent_steps_sampled": 322920, "num_agent_steps_trained": 322920}, "done": false, "episodes_total": 2691, "training_iteration": 674, "trial_id": "53665_00000", "date": "2023-07-26_04-03-31", "timestamp": 1690333411, "time_this_iter_s": 12.496158838272095, "time_total_s": 8148.5471971035, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2527.2217211723328, "iterations_since_restore": 214, "perf": {"cpu_util_percent": 43.71666666666667, "ram_util_percent": 71.61111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4832458496094, "policy_loss": -75163.25, "vf_loss": 2368551.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 857.0, "diff_num_grad_updates_vs_sampler_policy": 856.0}}, "num_env_steps_sampled": 323400, "num_env_steps_trained": 323400, "num_agent_steps_sampled": 323400, "num_agent_steps_trained": 323400}, "sampler_results": {"episode_reward_max": -322.71637248421234, "episode_reward_min": -1394.7960535385373, "episode_reward_mean": -726.8237903353636, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-921.8719907563013, -515.9857948358177, -728.3332052937448, -1058.6597146773095, -519.0847515061027, -800.501593661656, -733.5674465909572, -843.7243069065254, -775.8874032221368, -492.42814381428286, -510.1217799759738, -674.2841542415847, -420.860825726447, -803.962597155909, -641.1798927495181, -322.71637248421234, -1068.3710173946247, -783.8140081094656, -778.1751815208966, -749.5082392107654, -1106.2968516395651, -716.1747253111616, -431.89278021635204, -510.7795792231949, -803.3883496587829, -1183.897304565789, -687.2759648547272, -658.7328140597681, -747.3915730788775, -528.2065014873695, -713.9229522500578, -968.8361075338797, -745.5969363095093, -925.1504055452456, -781.9658152033769, -482.1656370712828, -633.7974625198785, -843.1419560493296, -494.9268878267914, -728.7710160549568, -407.1850115070204, -556.4423050944647, -752.4553015690863, -683.1511278189711, -755.9634231077051, -879.4087224106784, -597.8825103006533, -929.6118089726612, -685.4104215993268, -792.4918267035575, -375.23106874514923, -718.2694750728991, -885.6244968640651, -857.5168079049236, -726.005393145418, -707.4462002130316, -1016.4463060166293, -638.7713585906026, -631.3172503155583, -441.13005998883165, -560.0535285752172, -835.5559653520096, -843.424134268684, -611.3110755033473, -940.0635300723793, -589.5815624494086, -769.948185224762, -782.6043779841912, -704.4174424911336, -714.7293239381523, -1083.910615176363, -769.1968810199785, -542.6562555105581, -887.1834975034957, -646.3894723048414, -415.3002837498957, -705.0800823076884, -1392.0773174553171, -1020.9090882897663, -864.4122305929538, -962.7355209637891, -395.6942547300457, -1394.7960535385373, -610.9216684922756, -530.8434302800124, -520.6665755719677, -657.9661195557549, -575.1866414357245, -899.6489232610088, -678.0447401003436, -661.9423248794734, -778.3975518883043, -749.6262845382524, -659.496500060774, -547.3716511321522, -1010.3096008115671, -732.6523420487819, -690.5860687472027, -403.6352442306562, -669.9417712642462], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.358746691961997, "mean_inference_ms": 0.41105538148227966, "mean_action_processing_ms": 0.09705085034324372, "mean_env_wait_ms": 2.7037170413327156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004179716110229492, "StateBufferConnector_ms": 0.003302335739135742, "ViewRequirementAgentConnector_ms": 0.0778813362121582}}, "episode_reward_max": -322.71637248421234, "episode_reward_min": -1394.7960535385373, "episode_reward_mean": -726.8237903353636, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-921.8719907563013, -515.9857948358177, -728.3332052937448, -1058.6597146773095, -519.0847515061027, -800.501593661656, -733.5674465909572, -843.7243069065254, -775.8874032221368, -492.42814381428286, -510.1217799759738, -674.2841542415847, -420.860825726447, -803.962597155909, -641.1798927495181, -322.71637248421234, -1068.3710173946247, -783.8140081094656, -778.1751815208966, -749.5082392107654, -1106.2968516395651, -716.1747253111616, -431.89278021635204, -510.7795792231949, -803.3883496587829, -1183.897304565789, -687.2759648547272, -658.7328140597681, -747.3915730788775, -528.2065014873695, -713.9229522500578, -968.8361075338797, -745.5969363095093, -925.1504055452456, -781.9658152033769, -482.1656370712828, -633.7974625198785, -843.1419560493296, -494.9268878267914, -728.7710160549568, -407.1850115070204, -556.4423050944647, -752.4553015690863, -683.1511278189711, -755.9634231077051, -879.4087224106784, -597.8825103006533, -929.6118089726612, -685.4104215993268, -792.4918267035575, -375.23106874514923, -718.2694750728991, -885.6244968640651, -857.5168079049236, -726.005393145418, -707.4462002130316, -1016.4463060166293, -638.7713585906026, -631.3172503155583, -441.13005998883165, -560.0535285752172, -835.5559653520096, -843.424134268684, -611.3110755033473, -940.0635300723793, -589.5815624494086, -769.948185224762, -782.6043779841912, -704.4174424911336, -714.7293239381523, -1083.910615176363, -769.1968810199785, -542.6562555105581, -887.1834975034957, -646.3894723048414, -415.3002837498957, -705.0800823076884, -1392.0773174553171, -1020.9090882897663, -864.4122305929538, -962.7355209637891, -395.6942547300457, -1394.7960535385373, -610.9216684922756, -530.8434302800124, -520.6665755719677, -657.9661195557549, -575.1866414357245, -899.6489232610088, -678.0447401003436, -661.9423248794734, -778.3975518883043, -749.6262845382524, -659.496500060774, -547.3716511321522, -1010.3096008115671, -732.6523420487819, -690.5860687472027, -403.6352442306562, -669.9417712642462], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.358746691961997, "mean_inference_ms": 0.41105538148227966, "mean_action_processing_ms": 0.09705085034324372, "mean_env_wait_ms": 2.7037170413327156, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004179716110229492, "StateBufferConnector_ms": 0.003302335739135742, "ViewRequirementAgentConnector_ms": 0.0778813362121582}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 323400, "num_agent_steps_trained": 323400, "num_env_steps_sampled": 323400, "num_env_steps_trained": 323400, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.662407958163605, "num_env_steps_trained_throughput_per_sec": 40.662407958163605, "timesteps_total": 323400, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 323400, "timers": {"training_iteration_time_ms": 3035.301, "sample_time_ms": 3031.411, "load_time_ms": 0.222, "load_throughput": 541142.329, "learn_time_ms": 2.841, "learn_throughput": 42241.901, "synch_weights_time_ms": 0.786}, "counters": {"num_env_steps_sampled": 323400, "num_env_steps_trained": 323400, "num_agent_steps_sampled": 323400, "num_agent_steps_trained": 323400}, "done": false, "episodes_total": 2695, "training_iteration": 675, "trial_id": "53665_00000", "date": "2023-07-26_04-03-43", "timestamp": 1690333423, "time_this_iter_s": 11.807430982589722, "time_total_s": 8160.35462808609, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2539.0291521549225, "iterations_since_restore": 215, "perf": {"cpu_util_percent": 46.652941176470584, "ram_util_percent": 73.24117647058824}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.46099853515625, "policy_loss": -79455.5390625, "vf_loss": 3319543.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 861.0, "diff_num_grad_updates_vs_sampler_policy": 860.0}}, "num_env_steps_sampled": 323880, "num_env_steps_trained": 323880, "num_agent_steps_sampled": 323880, "num_agent_steps_trained": 323880}, "sampler_results": {"episode_reward_max": -322.71637248421234, "episode_reward_min": -1394.7960535385373, "episode_reward_mean": -723.147816857461, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-519.0847515061027, -800.501593661656, -733.5674465909572, -843.7243069065254, -775.8874032221368, -492.42814381428286, -510.1217799759738, -674.2841542415847, -420.860825726447, -803.962597155909, -641.1798927495181, -322.71637248421234, -1068.3710173946247, -783.8140081094656, -778.1751815208966, -749.5082392107654, -1106.2968516395651, -716.1747253111616, -431.89278021635204, -510.7795792231949, -803.3883496587829, -1183.897304565789, -687.2759648547272, -658.7328140597681, -747.3915730788775, -528.2065014873695, -713.9229522500578, -968.8361075338797, -745.5969363095093, -925.1504055452456, -781.9658152033769, -482.1656370712828, -633.7974625198785, -843.1419560493296, -494.9268878267914, -728.7710160549568, -407.1850115070204, -556.4423050944647, -752.4553015690863, -683.1511278189711, -755.9634231077051, -879.4087224106784, -597.8825103006533, -929.6118089726612, -685.4104215993268, -792.4918267035575, -375.23106874514923, -718.2694750728991, -885.6244968640651, -857.5168079049236, -726.005393145418, -707.4462002130316, -1016.4463060166293, -638.7713585906026, -631.3172503155583, -441.13005998883165, -560.0535285752172, -835.5559653520096, -843.424134268684, -611.3110755033473, -940.0635300723793, -589.5815624494086, -769.948185224762, -782.6043779841912, -704.4174424911336, -714.7293239381523, -1083.910615176363, -769.1968810199785, -542.6562555105581, -887.1834975034957, -646.3894723048414, -415.3002837498957, -705.0800823076884, -1392.0773174553171, -1020.9090882897663, -864.4122305929538, -962.7355209637891, -395.6942547300457, -1394.7960535385373, -610.9216684922756, -530.8434302800124, -520.6665755719677, -657.9661195557549, -575.1866414357245, -899.6489232610088, -678.0447401003436, -661.9423248794734, -778.3975518883043, -749.6262845382524, -659.496500060774, -547.3716511321522, -1010.3096008115671, -732.6523420487819, -690.5860687472027, -403.6352442306562, -669.9417712642462, -576.1111165643176, -796.5359348072446, -851.7970741912089, -632.8092322101086], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.360337846255785, "mean_inference_ms": 0.41117283467126, "mean_action_processing_ms": 0.09707144735156867, "mean_env_wait_ms": 2.7039389643712246, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004187822341918945, "StateBufferConnector_ms": 0.003301858901977539, "ViewRequirementAgentConnector_ms": 0.07800841331481934}}, "episode_reward_max": -322.71637248421234, "episode_reward_min": -1394.7960535385373, "episode_reward_mean": -723.147816857461, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-519.0847515061027, -800.501593661656, -733.5674465909572, -843.7243069065254, -775.8874032221368, -492.42814381428286, -510.1217799759738, -674.2841542415847, -420.860825726447, -803.962597155909, -641.1798927495181, -322.71637248421234, -1068.3710173946247, -783.8140081094656, -778.1751815208966, -749.5082392107654, -1106.2968516395651, -716.1747253111616, -431.89278021635204, -510.7795792231949, -803.3883496587829, -1183.897304565789, -687.2759648547272, -658.7328140597681, -747.3915730788775, -528.2065014873695, -713.9229522500578, -968.8361075338797, -745.5969363095093, -925.1504055452456, -781.9658152033769, -482.1656370712828, -633.7974625198785, -843.1419560493296, -494.9268878267914, -728.7710160549568, -407.1850115070204, -556.4423050944647, -752.4553015690863, -683.1511278189711, -755.9634231077051, -879.4087224106784, -597.8825103006533, -929.6118089726612, -685.4104215993268, -792.4918267035575, -375.23106874514923, -718.2694750728991, -885.6244968640651, -857.5168079049236, -726.005393145418, -707.4462002130316, -1016.4463060166293, -638.7713585906026, -631.3172503155583, -441.13005998883165, -560.0535285752172, -835.5559653520096, -843.424134268684, -611.3110755033473, -940.0635300723793, -589.5815624494086, -769.948185224762, -782.6043779841912, -704.4174424911336, -714.7293239381523, -1083.910615176363, -769.1968810199785, -542.6562555105581, -887.1834975034957, -646.3894723048414, -415.3002837498957, -705.0800823076884, -1392.0773174553171, -1020.9090882897663, -864.4122305929538, -962.7355209637891, -395.6942547300457, -1394.7960535385373, -610.9216684922756, -530.8434302800124, -520.6665755719677, -657.9661195557549, -575.1866414357245, -899.6489232610088, -678.0447401003436, -661.9423248794734, -778.3975518883043, -749.6262845382524, -659.496500060774, -547.3716511321522, -1010.3096008115671, -732.6523420487819, -690.5860687472027, -403.6352442306562, -669.9417712642462, -576.1111165643176, -796.5359348072446, -851.7970741912089, -632.8092322101086], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.360337846255785, "mean_inference_ms": 0.41117283467126, "mean_action_processing_ms": 0.09707144735156867, "mean_env_wait_ms": 2.7039389643712246, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004187822341918945, "StateBufferConnector_ms": 0.003301858901977539, "ViewRequirementAgentConnector_ms": 0.07800841331481934}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 323880, "num_agent_steps_trained": 323880, "num_env_steps_sampled": 323880, "num_env_steps_trained": 323880, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.46411393500793, "num_env_steps_trained_throughput_per_sec": 41.46411393500793, "timesteps_total": 323880, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 323880, "timers": {"training_iteration_time_ms": 2922.865, "sample_time_ms": 2918.969, "load_time_ms": 0.218, "load_throughput": 551217.26, "learn_time_ms": 2.869, "learn_throughput": 41820.367, "synch_weights_time_ms": 0.766}, "counters": {"num_env_steps_sampled": 323880, "num_env_steps_trained": 323880, "num_agent_steps_sampled": 323880, "num_agent_steps_trained": 323880}, "done": false, "episodes_total": 2699, "training_iteration": 676, "trial_id": "53665_00000", "date": "2023-07-26_04-03-55", "timestamp": 1690333435, "time_this_iter_s": 11.57916808128357, "time_total_s": 8171.933796167374, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2550.608320236206, "iterations_since_restore": 216, "perf": {"cpu_util_percent": 43.162499999999994, "ram_util_percent": 75.48124999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.43994140625, "policy_loss": -48925.05859375, "vf_loss": 1069405.625}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 865.0, "diff_num_grad_updates_vs_sampler_policy": 864.0}}, "num_env_steps_sampled": 324360, "num_env_steps_trained": 324360, "num_agent_steps_sampled": 324360, "num_agent_steps_trained": 324360}, "sampler_results": {"episode_reward_max": -322.71637248421234, "episode_reward_min": -1394.7960535385373, "episode_reward_mean": -719.4571938540172, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-775.8874032221368, -492.42814381428286, -510.1217799759738, -674.2841542415847, -420.860825726447, -803.962597155909, -641.1798927495181, -322.71637248421234, -1068.3710173946247, -783.8140081094656, -778.1751815208966, -749.5082392107654, -1106.2968516395651, -716.1747253111616, -431.89278021635204, -510.7795792231949, -803.3883496587829, -1183.897304565789, -687.2759648547272, -658.7328140597681, -747.3915730788775, -528.2065014873695, -713.9229522500578, -968.8361075338797, -745.5969363095093, -925.1504055452456, -781.9658152033769, -482.1656370712828, -633.7974625198785, -843.1419560493296, -494.9268878267914, -728.7710160549568, -407.1850115070204, -556.4423050944647, -752.4553015690863, -683.1511278189711, -755.9634231077051, -879.4087224106784, -597.8825103006533, -929.6118089726612, -685.4104215993268, -792.4918267035575, -375.23106874514923, -718.2694750728991, -885.6244968640651, -857.5168079049236, -726.005393145418, -707.4462002130316, -1016.4463060166293, -638.7713585906026, -631.3172503155583, -441.13005998883165, -560.0535285752172, -835.5559653520096, -843.424134268684, -611.3110755033473, -940.0635300723793, -589.5815624494086, -769.948185224762, -782.6043779841912, -704.4174424911336, -714.7293239381523, -1083.910615176363, -769.1968810199785, -542.6562555105581, -887.1834975034957, -646.3894723048414, -415.3002837498957, -705.0800823076884, -1392.0773174553171, -1020.9090882897663, -864.4122305929538, -962.7355209637891, -395.6942547300457, -1394.7960535385373, -610.9216684922756, -530.8434302800124, -520.6665755719677, -657.9661195557549, -575.1866414357245, -899.6489232610088, -678.0447401003436, -661.9423248794734, -778.3975518883043, -749.6262845382524, -659.496500060774, -547.3716511321522, -1010.3096008115671, -732.6523420487819, -690.5860687472027, -403.6352442306562, -669.9417712642462, -576.1111165643176, -796.5359348072446, -851.7970741912089, -632.8092322101086, -810.7710614262986, -847.8961301431667, -471.1639878496019, -397.98461890179334], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.36207154645294, "mean_inference_ms": 0.4112939408620669, "mean_action_processing_ms": 0.0970924852901871, "mean_env_wait_ms": 2.704162410988647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004220008850097656, "StateBufferConnector_ms": 0.003324270248413086, "ViewRequirementAgentConnector_ms": 0.07866287231445312}}, "episode_reward_max": -322.71637248421234, "episode_reward_min": -1394.7960535385373, "episode_reward_mean": -719.4571938540172, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-775.8874032221368, -492.42814381428286, -510.1217799759738, -674.2841542415847, -420.860825726447, -803.962597155909, -641.1798927495181, -322.71637248421234, -1068.3710173946247, -783.8140081094656, -778.1751815208966, -749.5082392107654, -1106.2968516395651, -716.1747253111616, -431.89278021635204, -510.7795792231949, -803.3883496587829, -1183.897304565789, -687.2759648547272, -658.7328140597681, -747.3915730788775, -528.2065014873695, -713.9229522500578, -968.8361075338797, -745.5969363095093, -925.1504055452456, -781.9658152033769, -482.1656370712828, -633.7974625198785, -843.1419560493296, -494.9268878267914, -728.7710160549568, -407.1850115070204, -556.4423050944647, -752.4553015690863, -683.1511278189711, -755.9634231077051, -879.4087224106784, -597.8825103006533, -929.6118089726612, -685.4104215993268, -792.4918267035575, -375.23106874514923, -718.2694750728991, -885.6244968640651, -857.5168079049236, -726.005393145418, -707.4462002130316, -1016.4463060166293, -638.7713585906026, -631.3172503155583, -441.13005998883165, -560.0535285752172, -835.5559653520096, -843.424134268684, -611.3110755033473, -940.0635300723793, -589.5815624494086, -769.948185224762, -782.6043779841912, -704.4174424911336, -714.7293239381523, -1083.910615176363, -769.1968810199785, -542.6562555105581, -887.1834975034957, -646.3894723048414, -415.3002837498957, -705.0800823076884, -1392.0773174553171, -1020.9090882897663, -864.4122305929538, -962.7355209637891, -395.6942547300457, -1394.7960535385373, -610.9216684922756, -530.8434302800124, -520.6665755719677, -657.9661195557549, -575.1866414357245, -899.6489232610088, -678.0447401003436, -661.9423248794734, -778.3975518883043, -749.6262845382524, -659.496500060774, -547.3716511321522, -1010.3096008115671, -732.6523420487819, -690.5860687472027, -403.6352442306562, -669.9417712642462, -576.1111165643176, -796.5359348072446, -851.7970741912089, -632.8092322101086, -810.7710614262986, -847.8961301431667, -471.1639878496019, -397.98461890179334], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.36207154645294, "mean_inference_ms": 0.4112939408620669, "mean_action_processing_ms": 0.0970924852901871, "mean_env_wait_ms": 2.704162410988647, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004220008850097656, "StateBufferConnector_ms": 0.003324270248413086, "ViewRequirementAgentConnector_ms": 0.07866287231445312}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324360, "num_agent_steps_trained": 324360, "num_env_steps_sampled": 324360, "num_env_steps_trained": 324360, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.93582943666596, "num_env_steps_trained_throughput_per_sec": 39.93582943666596, "timesteps_total": 324360, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 324360, "timers": {"training_iteration_time_ms": 2968.426, "sample_time_ms": 2963.977, "load_time_ms": 0.266, "load_throughput": 450960.022, "learn_time_ms": 3.253, "learn_throughput": 36885.973, "synch_weights_time_ms": 0.862}, "counters": {"num_env_steps_sampled": 324360, "num_env_steps_trained": 324360, "num_agent_steps_sampled": 324360, "num_agent_steps_trained": 324360}, "done": false, "episodes_total": 2703, "training_iteration": 677, "trial_id": "53665_00000", "date": "2023-07-26_04-04-07", "timestamp": 1690333447, "time_this_iter_s": 12.022280931472778, "time_total_s": 8183.956077098846, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2562.630601167679, "iterations_since_restore": 217, "perf": {"cpu_util_percent": 41.42222222222222, "ram_util_percent": 75.60555555555555}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4783630371094, "policy_loss": -90059.8125, "vf_loss": 3486881.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 869.0, "diff_num_grad_updates_vs_sampler_policy": 868.0}}, "num_env_steps_sampled": 324840, "num_env_steps_trained": 324840, "num_agent_steps_sampled": 324840, "num_agent_steps_trained": 324840}, "sampler_results": {"episode_reward_max": -322.71637248421234, "episode_reward_min": -1394.7960535385373, "episode_reward_mean": -722.9874943976797, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-420.860825726447, -803.962597155909, -641.1798927495181, -322.71637248421234, -1068.3710173946247, -783.8140081094656, -778.1751815208966, -749.5082392107654, -1106.2968516395651, -716.1747253111616, -431.89278021635204, -510.7795792231949, -803.3883496587829, -1183.897304565789, -687.2759648547272, -658.7328140597681, -747.3915730788775, -528.2065014873695, -713.9229522500578, -968.8361075338797, -745.5969363095093, -925.1504055452456, -781.9658152033769, -482.1656370712828, -633.7974625198785, -843.1419560493296, -494.9268878267914, -728.7710160549568, -407.1850115070204, -556.4423050944647, -752.4553015690863, -683.1511278189711, -755.9634231077051, -879.4087224106784, -597.8825103006533, -929.6118089726612, -685.4104215993268, -792.4918267035575, -375.23106874514923, -718.2694750728991, -885.6244968640651, -857.5168079049236, -726.005393145418, -707.4462002130316, -1016.4463060166293, -638.7713585906026, -631.3172503155583, -441.13005998883165, -560.0535285752172, -835.5559653520096, -843.424134268684, -611.3110755033473, -940.0635300723793, -589.5815624494086, -769.948185224762, -782.6043779841912, -704.4174424911336, -714.7293239381523, -1083.910615176363, -769.1968810199785, -542.6562555105581, -887.1834975034957, -646.3894723048414, -415.3002837498957, -705.0800823076884, -1392.0773174553171, -1020.9090882897663, -864.4122305929538, -962.7355209637891, -395.6942547300457, -1394.7960535385373, -610.9216684922756, -530.8434302800124, -520.6665755719677, -657.9661195557549, -575.1866414357245, -899.6489232610088, -678.0447401003436, -661.9423248794734, -778.3975518883043, -749.6262845382524, -659.496500060774, -547.3716511321522, -1010.3096008115671, -732.6523420487819, -690.5860687472027, -403.6352442306562, -669.9417712642462, -576.1111165643176, -796.5359348072446, -851.7970741912089, -632.8092322101086, -810.7710614262986, -847.8961301431667, -471.1639878496019, -397.98461890179334, -626.0417642357235, -714.9277423333384, -829.4023967007583, -635.3796323504288], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.36373570740859, "mean_inference_ms": 0.41140447266191993, "mean_action_processing_ms": 0.09711163864860181, "mean_env_wait_ms": 2.704359557575489, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004260063171386719, "StateBufferConnector_ms": 0.0033409595489501953, "ViewRequirementAgentConnector_ms": 0.07973456382751465}}, "episode_reward_max": -322.71637248421234, "episode_reward_min": -1394.7960535385373, "episode_reward_mean": -722.9874943976797, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-420.860825726447, -803.962597155909, -641.1798927495181, -322.71637248421234, -1068.3710173946247, -783.8140081094656, -778.1751815208966, -749.5082392107654, -1106.2968516395651, -716.1747253111616, -431.89278021635204, -510.7795792231949, -803.3883496587829, -1183.897304565789, -687.2759648547272, -658.7328140597681, -747.3915730788775, -528.2065014873695, -713.9229522500578, -968.8361075338797, -745.5969363095093, -925.1504055452456, -781.9658152033769, -482.1656370712828, -633.7974625198785, -843.1419560493296, -494.9268878267914, -728.7710160549568, -407.1850115070204, -556.4423050944647, -752.4553015690863, -683.1511278189711, -755.9634231077051, -879.4087224106784, -597.8825103006533, -929.6118089726612, -685.4104215993268, -792.4918267035575, -375.23106874514923, -718.2694750728991, -885.6244968640651, -857.5168079049236, -726.005393145418, -707.4462002130316, -1016.4463060166293, -638.7713585906026, -631.3172503155583, -441.13005998883165, -560.0535285752172, -835.5559653520096, -843.424134268684, -611.3110755033473, -940.0635300723793, -589.5815624494086, -769.948185224762, -782.6043779841912, -704.4174424911336, -714.7293239381523, -1083.910615176363, -769.1968810199785, -542.6562555105581, -887.1834975034957, -646.3894723048414, -415.3002837498957, -705.0800823076884, -1392.0773174553171, -1020.9090882897663, -864.4122305929538, -962.7355209637891, -395.6942547300457, -1394.7960535385373, -610.9216684922756, -530.8434302800124, -520.6665755719677, -657.9661195557549, -575.1866414357245, -899.6489232610088, -678.0447401003436, -661.9423248794734, -778.3975518883043, -749.6262845382524, -659.496500060774, -547.3716511321522, -1010.3096008115671, -732.6523420487819, -690.5860687472027, -403.6352442306562, -669.9417712642462, -576.1111165643176, -796.5359348072446, -851.7970741912089, -632.8092322101086, -810.7710614262986, -847.8961301431667, -471.1639878496019, -397.98461890179334, -626.0417642357235, -714.9277423333384, -829.4023967007583, -635.3796323504288], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.36373570740859, "mean_inference_ms": 0.41140447266191993, "mean_action_processing_ms": 0.09711163864860181, "mean_env_wait_ms": 2.704359557575489, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004260063171386719, "StateBufferConnector_ms": 0.0033409595489501953, "ViewRequirementAgentConnector_ms": 0.07973456382751465}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324840, "num_agent_steps_trained": 324840, "num_env_steps_sampled": 324840, "num_env_steps_trained": 324840, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.941877860300416, "num_env_steps_trained_throughput_per_sec": 39.941877860300416, "timesteps_total": 324840, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 324840, "timers": {"training_iteration_time_ms": 2981.046, "sample_time_ms": 2976.719, "load_time_ms": 0.262, "load_throughput": 458143.528, "learn_time_ms": 3.175, "learn_throughput": 37795.603, "synch_weights_time_ms": 0.823}, "counters": {"num_env_steps_sampled": 324840, "num_env_steps_trained": 324840, "num_agent_steps_sampled": 324840, "num_agent_steps_trained": 324840}, "done": false, "episodes_total": 2707, "training_iteration": 678, "trial_id": "53665_00000", "date": "2023-07-26_04-04-19", "timestamp": 1690333459, "time_this_iter_s": 12.02026891708374, "time_total_s": 8195.97634601593, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2574.6508700847626, "iterations_since_restore": 218, "perf": {"cpu_util_percent": 43.829411764705874, "ram_util_percent": 76.65294117647059}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.44580078125, "policy_loss": -78195.8984375, "vf_loss": 2790066.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 873.0, "diff_num_grad_updates_vs_sampler_policy": 872.0}}, "num_env_steps_sampled": 325320, "num_env_steps_trained": 325320, "num_agent_steps_sampled": 325320, "num_agent_steps_trained": 325320}, "sampler_results": {"episode_reward_max": -375.23106874514923, "episode_reward_min": -1394.7960535385373, "episode_reward_mean": -728.7750232306689, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1068.3710173946247, -783.8140081094656, -778.1751815208966, -749.5082392107654, -1106.2968516395651, -716.1747253111616, -431.89278021635204, -510.7795792231949, -803.3883496587829, -1183.897304565789, -687.2759648547272, -658.7328140597681, -747.3915730788775, -528.2065014873695, -713.9229522500578, -968.8361075338797, -745.5969363095093, -925.1504055452456, -781.9658152033769, -482.1656370712828, -633.7974625198785, -843.1419560493296, -494.9268878267914, -728.7710160549568, -407.1850115070204, -556.4423050944647, -752.4553015690863, -683.1511278189711, -755.9634231077051, -879.4087224106784, -597.8825103006533, -929.6118089726612, -685.4104215993268, -792.4918267035575, -375.23106874514923, -718.2694750728991, -885.6244968640651, -857.5168079049236, -726.005393145418, -707.4462002130316, -1016.4463060166293, -638.7713585906026, -631.3172503155583, -441.13005998883165, -560.0535285752172, -835.5559653520096, -843.424134268684, -611.3110755033473, -940.0635300723793, -589.5815624494086, -769.948185224762, -782.6043779841912, -704.4174424911336, -714.7293239381523, -1083.910615176363, -769.1968810199785, -542.6562555105581, -887.1834975034957, -646.3894723048414, -415.3002837498957, -705.0800823076884, -1392.0773174553171, -1020.9090882897663, -864.4122305929538, -962.7355209637891, -395.6942547300457, -1394.7960535385373, -610.9216684922756, -530.8434302800124, -520.6665755719677, -657.9661195557549, -575.1866414357245, -899.6489232610088, -678.0447401003436, -661.9423248794734, -778.3975518883043, -749.6262845382524, -659.496500060774, -547.3716511321522, -1010.3096008115671, -732.6523420487819, -690.5860687472027, -403.6352442306562, -669.9417712642462, -576.1111165643176, -796.5359348072446, -851.7970741912089, -632.8092322101086, -810.7710614262986, -847.8961301431667, -471.1639878496019, -397.98461890179334, -626.0417642357235, -714.9277423333384, -829.4023967007583, -635.3796323504288, -556.2189432498506, -919.5731590167197, -754.1360318051926, -537.5444373432422], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.365467169893677, "mean_inference_ms": 0.4115172652506726, "mean_action_processing_ms": 0.0971313356011569, "mean_env_wait_ms": 2.7045672507508893, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004251956939697266, "StateBufferConnector_ms": 0.003332853317260742, "ViewRequirementAgentConnector_ms": 0.0798492431640625}}, "episode_reward_max": -375.23106874514923, "episode_reward_min": -1394.7960535385373, "episode_reward_mean": -728.7750232306689, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1068.3710173946247, -783.8140081094656, -778.1751815208966, -749.5082392107654, -1106.2968516395651, -716.1747253111616, -431.89278021635204, -510.7795792231949, -803.3883496587829, -1183.897304565789, -687.2759648547272, -658.7328140597681, -747.3915730788775, -528.2065014873695, -713.9229522500578, -968.8361075338797, -745.5969363095093, -925.1504055452456, -781.9658152033769, -482.1656370712828, -633.7974625198785, -843.1419560493296, -494.9268878267914, -728.7710160549568, -407.1850115070204, -556.4423050944647, -752.4553015690863, -683.1511278189711, -755.9634231077051, -879.4087224106784, -597.8825103006533, -929.6118089726612, -685.4104215993268, -792.4918267035575, -375.23106874514923, -718.2694750728991, -885.6244968640651, -857.5168079049236, -726.005393145418, -707.4462002130316, -1016.4463060166293, -638.7713585906026, -631.3172503155583, -441.13005998883165, -560.0535285752172, -835.5559653520096, -843.424134268684, -611.3110755033473, -940.0635300723793, -589.5815624494086, -769.948185224762, -782.6043779841912, -704.4174424911336, -714.7293239381523, -1083.910615176363, -769.1968810199785, -542.6562555105581, -887.1834975034957, -646.3894723048414, -415.3002837498957, -705.0800823076884, -1392.0773174553171, -1020.9090882897663, -864.4122305929538, -962.7355209637891, -395.6942547300457, -1394.7960535385373, -610.9216684922756, -530.8434302800124, -520.6665755719677, -657.9661195557549, -575.1866414357245, -899.6489232610088, -678.0447401003436, -661.9423248794734, -778.3975518883043, -749.6262845382524, -659.496500060774, -547.3716511321522, -1010.3096008115671, -732.6523420487819, -690.5860687472027, -403.6352442306562, -669.9417712642462, -576.1111165643176, -796.5359348072446, -851.7970741912089, -632.8092322101086, -810.7710614262986, -847.8961301431667, -471.1639878496019, -397.98461890179334, -626.0417642357235, -714.9277423333384, -829.4023967007583, -635.3796323504288, -556.2189432498506, -919.5731590167197, -754.1360318051926, -537.5444373432422], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.365467169893677, "mean_inference_ms": 0.4115172652506726, "mean_action_processing_ms": 0.0971313356011569, "mean_env_wait_ms": 2.7045672507508893, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004251956939697266, "StateBufferConnector_ms": 0.003332853317260742, "ViewRequirementAgentConnector_ms": 0.0798492431640625}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 325320, "num_agent_steps_trained": 325320, "num_env_steps_sampled": 325320, "num_env_steps_trained": 325320, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 38.09514107011636, "num_env_steps_trained_throughput_per_sec": 38.09514107011636, "timesteps_total": 325320, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 325320, "timers": {"training_iteration_time_ms": 3046.414, "sample_time_ms": 3042.549, "load_time_ms": 0.224, "load_throughput": 536813.652, "learn_time_ms": 2.857, "learn_throughput": 41996.235, "synch_weights_time_ms": 0.742}, "counters": {"num_env_steps_sampled": 325320, "num_env_steps_trained": 325320, "num_agent_steps_sampled": 325320, "num_agent_steps_trained": 325320}, "done": false, "episodes_total": 2711, "training_iteration": 679, "trial_id": "53665_00000", "date": "2023-07-26_04-04-32", "timestamp": 1690333472, "time_this_iter_s": 12.602838039398193, "time_total_s": 8208.579184055328, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2587.2537081241608, "iterations_since_restore": 219, "perf": {"cpu_util_percent": 44.74444444444444, "ram_util_percent": 74.59444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4949951171875, "policy_loss": -144825.828125, "vf_loss": 9004190.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 877.0, "diff_num_grad_updates_vs_sampler_policy": 876.0}}, "num_env_steps_sampled": 325800, "num_env_steps_trained": 325800, "num_agent_steps_sampled": 325800, "num_agent_steps_trained": 325800}, "sampler_results": {"episode_reward_max": -375.23106874514923, "episode_reward_min": -1394.7960535385373, "episode_reward_mean": -729.4924422468118, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1106.2968516395651, -716.1747253111616, -431.89278021635204, -510.7795792231949, -803.3883496587829, -1183.897304565789, -687.2759648547272, -658.7328140597681, -747.3915730788775, -528.2065014873695, -713.9229522500578, -968.8361075338797, -745.5969363095093, -925.1504055452456, -781.9658152033769, -482.1656370712828, -633.7974625198785, -843.1419560493296, -494.9268878267914, -728.7710160549568, -407.1850115070204, -556.4423050944647, -752.4553015690863, -683.1511278189711, -755.9634231077051, -879.4087224106784, -597.8825103006533, -929.6118089726612, -685.4104215993268, -792.4918267035575, -375.23106874514923, -718.2694750728991, -885.6244968640651, -857.5168079049236, -726.005393145418, -707.4462002130316, -1016.4463060166293, -638.7713585906026, -631.3172503155583, -441.13005998883165, -560.0535285752172, -835.5559653520096, -843.424134268684, -611.3110755033473, -940.0635300723793, -589.5815624494086, -769.948185224762, -782.6043779841912, -704.4174424911336, -714.7293239381523, -1083.910615176363, -769.1968810199785, -542.6562555105581, -887.1834975034957, -646.3894723048414, -415.3002837498957, -705.0800823076884, -1392.0773174553171, -1020.9090882897663, -864.4122305929538, -962.7355209637891, -395.6942547300457, -1394.7960535385373, -610.9216684922756, -530.8434302800124, -520.6665755719677, -657.9661195557549, -575.1866414357245, -899.6489232610088, -678.0447401003436, -661.9423248794734, -778.3975518883043, -749.6262845382524, -659.496500060774, -547.3716511321522, -1010.3096008115671, -732.6523420487819, -690.5860687472027, -403.6352442306562, -669.9417712642462, -576.1111165643176, -796.5359348072446, -851.7970741912089, -632.8092322101086, -810.7710614262986, -847.8961301431667, -471.1639878496019, -397.98461890179334, -626.0417642357235, -714.9277423333384, -829.4023967007583, -635.3796323504288, -556.2189432498506, -919.5731590167197, -754.1360318051926, -537.5444373432422, -905.7087849992973, -779.3920143593093, -664.7945392241998, -1101.7150092672578], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.367167568726217, "mean_inference_ms": 0.4116232157580357, "mean_action_processing_ms": 0.0971496341090162, "mean_env_wait_ms": 2.704749730186228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004300117492675781, "StateBufferConnector_ms": 0.003314971923828125, "ViewRequirementAgentConnector_ms": 0.08051085472106934}}, "episode_reward_max": -375.23106874514923, "episode_reward_min": -1394.7960535385373, "episode_reward_mean": -729.4924422468118, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-1106.2968516395651, -716.1747253111616, -431.89278021635204, -510.7795792231949, -803.3883496587829, -1183.897304565789, -687.2759648547272, -658.7328140597681, -747.3915730788775, -528.2065014873695, -713.9229522500578, -968.8361075338797, -745.5969363095093, -925.1504055452456, -781.9658152033769, -482.1656370712828, -633.7974625198785, -843.1419560493296, -494.9268878267914, -728.7710160549568, -407.1850115070204, -556.4423050944647, -752.4553015690863, -683.1511278189711, -755.9634231077051, -879.4087224106784, -597.8825103006533, -929.6118089726612, -685.4104215993268, -792.4918267035575, -375.23106874514923, -718.2694750728991, -885.6244968640651, -857.5168079049236, -726.005393145418, -707.4462002130316, -1016.4463060166293, -638.7713585906026, -631.3172503155583, -441.13005998883165, -560.0535285752172, -835.5559653520096, -843.424134268684, -611.3110755033473, -940.0635300723793, -589.5815624494086, -769.948185224762, -782.6043779841912, -704.4174424911336, -714.7293239381523, -1083.910615176363, -769.1968810199785, -542.6562555105581, -887.1834975034957, -646.3894723048414, -415.3002837498957, -705.0800823076884, -1392.0773174553171, -1020.9090882897663, -864.4122305929538, -962.7355209637891, -395.6942547300457, -1394.7960535385373, -610.9216684922756, -530.8434302800124, -520.6665755719677, -657.9661195557549, -575.1866414357245, -899.6489232610088, -678.0447401003436, -661.9423248794734, -778.3975518883043, -749.6262845382524, -659.496500060774, -547.3716511321522, -1010.3096008115671, -732.6523420487819, -690.5860687472027, -403.6352442306562, -669.9417712642462, -576.1111165643176, -796.5359348072446, -851.7970741912089, -632.8092322101086, -810.7710614262986, -847.8961301431667, -471.1639878496019, -397.98461890179334, -626.0417642357235, -714.9277423333384, -829.4023967007583, -635.3796323504288, -556.2189432498506, -919.5731590167197, -754.1360318051926, -537.5444373432422, -905.7087849992973, -779.3920143593093, -664.7945392241998, -1101.7150092672578], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.367167568726217, "mean_inference_ms": 0.4116232157580357, "mean_action_processing_ms": 0.0971496341090162, "mean_env_wait_ms": 2.704749730186228, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004300117492675781, "StateBufferConnector_ms": 0.003314971923828125, "ViewRequirementAgentConnector_ms": 0.08051085472106934}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 325800, "num_agent_steps_trained": 325800, "num_env_steps_sampled": 325800, "num_env_steps_trained": 325800, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.405424208442774, "num_env_steps_trained_throughput_per_sec": 40.405424208442774, "timesteps_total": 325800, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 325800, "timers": {"training_iteration_time_ms": 3068.025, "sample_time_ms": 3064.154, "load_time_ms": 0.224, "load_throughput": 535557.012, "learn_time_ms": 2.863, "learn_throughput": 41911.955, "synch_weights_time_ms": 0.741}, "counters": {"num_env_steps_sampled": 325800, "num_env_steps_trained": 325800, "num_agent_steps_sampled": 325800, "num_agent_steps_trained": 325800}, "done": false, "episodes_total": 2715, "training_iteration": 680, "trial_id": "53665_00000", "date": "2023-07-26_04-04-44", "timestamp": 1690333484, "time_this_iter_s": 11.882197141647339, "time_total_s": 8220.461381196976, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2599.135905265808, "iterations_since_restore": 220, "perf": {"cpu_util_percent": 44.56470588235294, "ram_util_percent": 71.56470588235295}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.44512939453125, "policy_loss": -109786.75, "vf_loss": 5407679.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 881.0, "diff_num_grad_updates_vs_sampler_policy": 880.0}}, "num_env_steps_sampled": 326280, "num_env_steps_trained": 326280, "num_agent_steps_sampled": 326280, "num_agent_steps_trained": 326280}, "sampler_results": {"episode_reward_max": -375.23106874514923, "episode_reward_min": -1394.7960535385373, "episode_reward_mean": -730.1785131115997, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-803.3883496587829, -1183.897304565789, -687.2759648547272, -658.7328140597681, -747.3915730788775, -528.2065014873695, -713.9229522500578, -968.8361075338797, -745.5969363095093, -925.1504055452456, -781.9658152033769, -482.1656370712828, -633.7974625198785, -843.1419560493296, -494.9268878267914, -728.7710160549568, -407.1850115070204, -556.4423050944647, -752.4553015690863, -683.1511278189711, -755.9634231077051, -879.4087224106784, -597.8825103006533, -929.6118089726612, -685.4104215993268, -792.4918267035575, -375.23106874514923, -718.2694750728991, -885.6244968640651, -857.5168079049236, -726.005393145418, -707.4462002130316, -1016.4463060166293, -638.7713585906026, -631.3172503155583, -441.13005998883165, -560.0535285752172, -835.5559653520096, -843.424134268684, -611.3110755033473, -940.0635300723793, -589.5815624494086, -769.948185224762, -782.6043779841912, -704.4174424911336, -714.7293239381523, -1083.910615176363, -769.1968810199785, -542.6562555105581, -887.1834975034957, -646.3894723048414, -415.3002837498957, -705.0800823076884, -1392.0773174553171, -1020.9090882897663, -864.4122305929538, -962.7355209637891, -395.6942547300457, -1394.7960535385373, -610.9216684922756, -530.8434302800124, -520.6665755719677, -657.9661195557549, -575.1866414357245, -899.6489232610088, -678.0447401003436, -661.9423248794734, -778.3975518883043, -749.6262845382524, -659.496500060774, -547.3716511321522, -1010.3096008115671, -732.6523420487819, -690.5860687472027, -403.6352442306562, -669.9417712642462, -576.1111165643176, -796.5359348072446, -851.7970741912089, -632.8092322101086, -810.7710614262986, -847.8961301431667, -471.1639878496019, -397.98461890179334, -626.0417642357235, -714.9277423333384, -829.4023967007583, -635.3796323504288, -556.2189432498506, -919.5731590167197, -754.1360318051926, -537.5444373432422, -905.7087849992973, -779.3920143593093, -664.7945392241998, -1101.7150092672578, -802.5362655413315, -560.9110034789785, -763.3839636604931, -706.9197901882482], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.36879591258169, "mean_inference_ms": 0.41172522048678073, "mean_action_processing_ms": 0.09716709746682817, "mean_env_wait_ms": 2.704922052403597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043070316314697266, "StateBufferConnector_ms": 0.0033206939697265625, "ViewRequirementAgentConnector_ms": 0.0806877613067627}}, "episode_reward_max": -375.23106874514923, "episode_reward_min": -1394.7960535385373, "episode_reward_mean": -730.1785131115997, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-803.3883496587829, -1183.897304565789, -687.2759648547272, -658.7328140597681, -747.3915730788775, -528.2065014873695, -713.9229522500578, -968.8361075338797, -745.5969363095093, -925.1504055452456, -781.9658152033769, -482.1656370712828, -633.7974625198785, -843.1419560493296, -494.9268878267914, -728.7710160549568, -407.1850115070204, -556.4423050944647, -752.4553015690863, -683.1511278189711, -755.9634231077051, -879.4087224106784, -597.8825103006533, -929.6118089726612, -685.4104215993268, -792.4918267035575, -375.23106874514923, -718.2694750728991, -885.6244968640651, -857.5168079049236, -726.005393145418, -707.4462002130316, -1016.4463060166293, -638.7713585906026, -631.3172503155583, -441.13005998883165, -560.0535285752172, -835.5559653520096, -843.424134268684, -611.3110755033473, -940.0635300723793, -589.5815624494086, -769.948185224762, -782.6043779841912, -704.4174424911336, -714.7293239381523, -1083.910615176363, -769.1968810199785, -542.6562555105581, -887.1834975034957, -646.3894723048414, -415.3002837498957, -705.0800823076884, -1392.0773174553171, -1020.9090882897663, -864.4122305929538, -962.7355209637891, -395.6942547300457, -1394.7960535385373, -610.9216684922756, -530.8434302800124, -520.6665755719677, -657.9661195557549, -575.1866414357245, -899.6489232610088, -678.0447401003436, -661.9423248794734, -778.3975518883043, -749.6262845382524, -659.496500060774, -547.3716511321522, -1010.3096008115671, -732.6523420487819, -690.5860687472027, -403.6352442306562, -669.9417712642462, -576.1111165643176, -796.5359348072446, -851.7970741912089, -632.8092322101086, -810.7710614262986, -847.8961301431667, -471.1639878496019, -397.98461890179334, -626.0417642357235, -714.9277423333384, -829.4023967007583, -635.3796323504288, -556.2189432498506, -919.5731590167197, -754.1360318051926, -537.5444373432422, -905.7087849992973, -779.3920143593093, -664.7945392241998, -1101.7150092672578, -802.5362655413315, -560.9110034789785, -763.3839636604931, -706.9197901882482], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.36879591258169, "mean_inference_ms": 0.41172522048678073, "mean_action_processing_ms": 0.09716709746682817, "mean_env_wait_ms": 2.704922052403597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0043070316314697266, "StateBufferConnector_ms": 0.0033206939697265625, "ViewRequirementAgentConnector_ms": 0.0806877613067627}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 326280, "num_agent_steps_trained": 326280, "num_env_steps_sampled": 326280, "num_env_steps_trained": 326280, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.54460387995158, "num_env_steps_trained_throughput_per_sec": 41.54460387995158, "timesteps_total": 326280, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 326280, "timers": {"training_iteration_time_ms": 2952.288, "sample_time_ms": 2948.524, "load_time_ms": 0.217, "load_throughput": 553642.592, "learn_time_ms": 2.793, "learn_throughput": 42960.854, "synch_weights_time_ms": 0.714}, "counters": {"num_env_steps_sampled": 326280, "num_env_steps_trained": 326280, "num_agent_steps_sampled": 326280, "num_agent_steps_trained": 326280}, "done": false, "episodes_total": 2719, "training_iteration": 681, "trial_id": "53665_00000", "date": "2023-07-26_04-04-55", "timestamp": 1690333495, "time_this_iter_s": 11.556555986404419, "time_total_s": 8232.01793718338, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2610.6924612522125, "iterations_since_restore": 221, "perf": {"cpu_util_percent": 41.53125, "ram_util_percent": 72.21875}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.47052001953125, "policy_loss": -96055.859375, "vf_loss": 3913945.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 885.0, "diff_num_grad_updates_vs_sampler_policy": 884.0}}, "num_env_steps_sampled": 326760, "num_env_steps_trained": 326760, "num_agent_steps_sampled": 326760, "num_agent_steps_trained": 326760}, "sampler_results": {"episode_reward_max": -375.23106874514923, "episode_reward_min": -1394.7960535385373, "episode_reward_mean": -727.4784190141385, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-747.3915730788775, -528.2065014873695, -713.9229522500578, -968.8361075338797, -745.5969363095093, -925.1504055452456, -781.9658152033769, -482.1656370712828, -633.7974625198785, -843.1419560493296, -494.9268878267914, -728.7710160549568, -407.1850115070204, -556.4423050944647, -752.4553015690863, -683.1511278189711, -755.9634231077051, -879.4087224106784, -597.8825103006533, -929.6118089726612, -685.4104215993268, -792.4918267035575, -375.23106874514923, -718.2694750728991, -885.6244968640651, -857.5168079049236, -726.005393145418, -707.4462002130316, -1016.4463060166293, -638.7713585906026, -631.3172503155583, -441.13005998883165, -560.0535285752172, -835.5559653520096, -843.424134268684, -611.3110755033473, -940.0635300723793, -589.5815624494086, -769.948185224762, -782.6043779841912, -704.4174424911336, -714.7293239381523, -1083.910615176363, -769.1968810199785, -542.6562555105581, -887.1834975034957, -646.3894723048414, -415.3002837498957, -705.0800823076884, -1392.0773174553171, -1020.9090882897663, -864.4122305929538, -962.7355209637891, -395.6942547300457, -1394.7960535385373, -610.9216684922756, -530.8434302800124, -520.6665755719677, -657.9661195557549, -575.1866414357245, -899.6489232610088, -678.0447401003436, -661.9423248794734, -778.3975518883043, -749.6262845382524, -659.496500060774, -547.3716511321522, -1010.3096008115671, -732.6523420487819, -690.5860687472027, -403.6352442306562, -669.9417712642462, -576.1111165643176, -796.5359348072446, -851.7970741912089, -632.8092322101086, -810.7710614262986, -847.8961301431667, -471.1639878496019, -397.98461890179334, -626.0417642357235, -714.9277423333384, -829.4023967007583, -635.3796323504288, -556.2189432498506, -919.5731590167197, -754.1360318051926, -537.5444373432422, -905.7087849992973, -779.3920143593093, -664.7945392241998, -1101.7150092672578, -802.5362655413315, -560.9110034789785, -763.3839636604931, -706.9197901882482, -970.3672057228564, -381.2838877620823, -974.4620992989214, -737.171830609087], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.370429008477494, "mean_inference_ms": 0.4118234713468636, "mean_action_processing_ms": 0.09718346433285165, "mean_env_wait_ms": 2.705084363194944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00422215461730957, "StateBufferConnector_ms": 0.003184080123901367, "ViewRequirementAgentConnector_ms": 0.07914900779724121}}, "episode_reward_max": -375.23106874514923, "episode_reward_min": -1394.7960535385373, "episode_reward_mean": -727.4784190141385, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-747.3915730788775, -528.2065014873695, -713.9229522500578, -968.8361075338797, -745.5969363095093, -925.1504055452456, -781.9658152033769, -482.1656370712828, -633.7974625198785, -843.1419560493296, -494.9268878267914, -728.7710160549568, -407.1850115070204, -556.4423050944647, -752.4553015690863, -683.1511278189711, -755.9634231077051, -879.4087224106784, -597.8825103006533, -929.6118089726612, -685.4104215993268, -792.4918267035575, -375.23106874514923, -718.2694750728991, -885.6244968640651, -857.5168079049236, -726.005393145418, -707.4462002130316, -1016.4463060166293, -638.7713585906026, -631.3172503155583, -441.13005998883165, -560.0535285752172, -835.5559653520096, -843.424134268684, -611.3110755033473, -940.0635300723793, -589.5815624494086, -769.948185224762, -782.6043779841912, -704.4174424911336, -714.7293239381523, -1083.910615176363, -769.1968810199785, -542.6562555105581, -887.1834975034957, -646.3894723048414, -415.3002837498957, -705.0800823076884, -1392.0773174553171, -1020.9090882897663, -864.4122305929538, -962.7355209637891, -395.6942547300457, -1394.7960535385373, -610.9216684922756, -530.8434302800124, -520.6665755719677, -657.9661195557549, -575.1866414357245, -899.6489232610088, -678.0447401003436, -661.9423248794734, -778.3975518883043, -749.6262845382524, -659.496500060774, -547.3716511321522, -1010.3096008115671, -732.6523420487819, -690.5860687472027, -403.6352442306562, -669.9417712642462, -576.1111165643176, -796.5359348072446, -851.7970741912089, -632.8092322101086, -810.7710614262986, -847.8961301431667, -471.1639878496019, -397.98461890179334, -626.0417642357235, -714.9277423333384, -829.4023967007583, -635.3796323504288, -556.2189432498506, -919.5731590167197, -754.1360318051926, -537.5444373432422, -905.7087849992973, -779.3920143593093, -664.7945392241998, -1101.7150092672578, -802.5362655413315, -560.9110034789785, -763.3839636604931, -706.9197901882482, -970.3672057228564, -381.2838877620823, -974.4620992989214, -737.171830609087], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.370429008477494, "mean_inference_ms": 0.4118234713468636, "mean_action_processing_ms": 0.09718346433285165, "mean_env_wait_ms": 2.705084363194944, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00422215461730957, "StateBufferConnector_ms": 0.003184080123901367, "ViewRequirementAgentConnector_ms": 0.07914900779724121}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 326760, "num_agent_steps_trained": 326760, "num_env_steps_sampled": 326760, "num_env_steps_trained": 326760, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 39.762488334519794, "num_env_steps_trained_throughput_per_sec": 39.762488334519794, "timesteps_total": 326760, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 326760, "timers": {"training_iteration_time_ms": 2970.71, "sample_time_ms": 2966.8, "load_time_ms": 0.226, "load_throughput": 530365.1, "learn_time_ms": 2.899, "learn_throughput": 41392.519, "synch_weights_time_ms": 0.739}, "counters": {"num_env_steps_sampled": 326760, "num_env_steps_trained": 326760, "num_agent_steps_sampled": 326760, "num_agent_steps_trained": 326760}, "done": false, "episodes_total": 2723, "training_iteration": 682, "trial_id": "53665_00000", "date": "2023-07-26_04-05-07", "timestamp": 1690333507, "time_this_iter_s": 12.074678182601929, "time_total_s": 8244.092615365982, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2622.7671394348145, "iterations_since_restore": 222, "perf": {"cpu_util_percent": 44.59411764705882, "ram_util_percent": 76.41176470588235}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4588623046875, "policy_loss": -76622.4375, "vf_loss": 2815941.25}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 889.0, "diff_num_grad_updates_vs_sampler_policy": 888.0}}, "num_env_steps_sampled": 327240, "num_env_steps_trained": 327240, "num_agent_steps_sampled": 327240, "num_agent_steps_trained": 327240}, "sampler_results": {"episode_reward_max": -375.23106874514923, "episode_reward_min": -1394.7960535385373, "episode_reward_mean": -722.4763116698043, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-745.5969363095093, -925.1504055452456, -781.9658152033769, -482.1656370712828, -633.7974625198785, -843.1419560493296, -494.9268878267914, -728.7710160549568, -407.1850115070204, -556.4423050944647, -752.4553015690863, -683.1511278189711, -755.9634231077051, -879.4087224106784, -597.8825103006533, -929.6118089726612, -685.4104215993268, -792.4918267035575, -375.23106874514923, -718.2694750728991, -885.6244968640651, -857.5168079049236, -726.005393145418, -707.4462002130316, -1016.4463060166293, -638.7713585906026, -631.3172503155583, -441.13005998883165, -560.0535285752172, -835.5559653520096, -843.424134268684, -611.3110755033473, -940.0635300723793, -589.5815624494086, -769.948185224762, -782.6043779841912, -704.4174424911336, -714.7293239381523, -1083.910615176363, -769.1968810199785, -542.6562555105581, -887.1834975034957, -646.3894723048414, -415.3002837498957, -705.0800823076884, -1392.0773174553171, -1020.9090882897663, -864.4122305929538, -962.7355209637891, -395.6942547300457, -1394.7960535385373, -610.9216684922756, -530.8434302800124, -520.6665755719677, -657.9661195557549, -575.1866414357245, -899.6489232610088, -678.0447401003436, -661.9423248794734, -778.3975518883043, -749.6262845382524, -659.496500060774, -547.3716511321522, -1010.3096008115671, -732.6523420487819, -690.5860687472027, -403.6352442306562, -669.9417712642462, -576.1111165643176, -796.5359348072446, -851.7970741912089, -632.8092322101086, -810.7710614262986, -847.8961301431667, -471.1639878496019, -397.98461890179334, -626.0417642357235, -714.9277423333384, -829.4023967007583, -635.3796323504288, -556.2189432498506, -919.5731590167197, -754.1360318051926, -537.5444373432422, -905.7087849992973, -779.3920143593093, -664.7945392241998, -1101.7150092672578, -802.5362655413315, -560.9110034789785, -763.3839636604931, -706.9197901882482, -970.3672057228564, -381.2838877620823, -974.4620992989214, -737.171830609087, -599.3994534413603, -586.6191543822376, -674.8609996673108, -597.2667924258568], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.372006684366397, "mean_inference_ms": 0.41192231072071445, "mean_action_processing_ms": 0.0971998420366584, "mean_env_wait_ms": 2.7052410184932363, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042154788970947266, "StateBufferConnector_ms": 0.0031821727752685547, "ViewRequirementAgentConnector_ms": 0.0791463851928711}}, "episode_reward_max": -375.23106874514923, "episode_reward_min": -1394.7960535385373, "episode_reward_mean": -722.4763116698043, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-745.5969363095093, -925.1504055452456, -781.9658152033769, -482.1656370712828, -633.7974625198785, -843.1419560493296, -494.9268878267914, -728.7710160549568, -407.1850115070204, -556.4423050944647, -752.4553015690863, -683.1511278189711, -755.9634231077051, -879.4087224106784, -597.8825103006533, -929.6118089726612, -685.4104215993268, -792.4918267035575, -375.23106874514923, -718.2694750728991, -885.6244968640651, -857.5168079049236, -726.005393145418, -707.4462002130316, -1016.4463060166293, -638.7713585906026, -631.3172503155583, -441.13005998883165, -560.0535285752172, -835.5559653520096, -843.424134268684, -611.3110755033473, -940.0635300723793, -589.5815624494086, -769.948185224762, -782.6043779841912, -704.4174424911336, -714.7293239381523, -1083.910615176363, -769.1968810199785, -542.6562555105581, -887.1834975034957, -646.3894723048414, -415.3002837498957, -705.0800823076884, -1392.0773174553171, -1020.9090882897663, -864.4122305929538, -962.7355209637891, -395.6942547300457, -1394.7960535385373, -610.9216684922756, -530.8434302800124, -520.6665755719677, -657.9661195557549, -575.1866414357245, -899.6489232610088, -678.0447401003436, -661.9423248794734, -778.3975518883043, -749.6262845382524, -659.496500060774, -547.3716511321522, -1010.3096008115671, -732.6523420487819, -690.5860687472027, -403.6352442306562, -669.9417712642462, -576.1111165643176, -796.5359348072446, -851.7970741912089, -632.8092322101086, -810.7710614262986, -847.8961301431667, -471.1639878496019, -397.98461890179334, -626.0417642357235, -714.9277423333384, -829.4023967007583, -635.3796323504288, -556.2189432498506, -919.5731590167197, -754.1360318051926, -537.5444373432422, -905.7087849992973, -779.3920143593093, -664.7945392241998, -1101.7150092672578, -802.5362655413315, -560.9110034789785, -763.3839636604931, -706.9197901882482, -970.3672057228564, -381.2838877620823, -974.4620992989214, -737.171830609087, -599.3994534413603, -586.6191543822376, -674.8609996673108, -597.2667924258568], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.372006684366397, "mean_inference_ms": 0.41192231072071445, "mean_action_processing_ms": 0.0971998420366584, "mean_env_wait_ms": 2.7052410184932363, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0042154788970947266, "StateBufferConnector_ms": 0.0031821727752685547, "ViewRequirementAgentConnector_ms": 0.0791463851928711}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 327240, "num_agent_steps_trained": 327240, "num_env_steps_sampled": 327240, "num_env_steps_trained": 327240, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 40.81917997455353, "num_env_steps_trained_throughput_per_sec": 40.81917997455353, "timesteps_total": 327240, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 327240, "timers": {"training_iteration_time_ms": 2949.021, "sample_time_ms": 2944.958, "load_time_ms": 0.234, "load_throughput": 511968.752, "learn_time_ms": 3.02, "learn_throughput": 39730.388, "synch_weights_time_ms": 0.762}, "counters": {"num_env_steps_sampled": 327240, "num_env_steps_trained": 327240, "num_agent_steps_sampled": 327240, "num_agent_steps_trained": 327240}, "done": false, "episodes_total": 2727, "training_iteration": 683, "trial_id": "53665_00000", "date": "2023-07-26_04-05-19", "timestamp": 1690333519, "time_this_iter_s": 11.762519121170044, "time_total_s": 8255.855134487152, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2634.5296585559845, "iterations_since_restore": 223, "perf": {"cpu_util_percent": 41.49411764705882, "ram_util_percent": 70.95882352941177}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.48046875, "policy_loss": -101115.078125, "vf_loss": 4227576.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 893.0, "diff_num_grad_updates_vs_sampler_policy": 892.0}}, "num_env_steps_sampled": 327720, "num_env_steps_trained": 327720, "num_agent_steps_sampled": 327720, "num_agent_steps_trained": 327720}, "sampler_results": {"episode_reward_max": -375.23106874514923, "episode_reward_min": -1394.7960535385373, "episode_reward_mean": -724.8629263364651, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-633.7974625198785, -843.1419560493296, -494.9268878267914, -728.7710160549568, -407.1850115070204, -556.4423050944647, -752.4553015690863, -683.1511278189711, -755.9634231077051, -879.4087224106784, -597.8825103006533, -929.6118089726612, -685.4104215993268, -792.4918267035575, -375.23106874514923, -718.2694750728991, -885.6244968640651, -857.5168079049236, -726.005393145418, -707.4462002130316, -1016.4463060166293, -638.7713585906026, -631.3172503155583, -441.13005998883165, -560.0535285752172, -835.5559653520096, -843.424134268684, -611.3110755033473, -940.0635300723793, -589.5815624494086, -769.948185224762, -782.6043779841912, -704.4174424911336, -714.7293239381523, -1083.910615176363, -769.1968810199785, -542.6562555105581, -887.1834975034957, -646.3894723048414, -415.3002837498957, -705.0800823076884, -1392.0773174553171, -1020.9090882897663, -864.4122305929538, -962.7355209637891, -395.6942547300457, -1394.7960535385373, -610.9216684922756, -530.8434302800124, -520.6665755719677, -657.9661195557549, -575.1866414357245, -899.6489232610088, -678.0447401003436, -661.9423248794734, -778.3975518883043, -749.6262845382524, -659.496500060774, -547.3716511321522, -1010.3096008115671, -732.6523420487819, -690.5860687472027, -403.6352442306562, -669.9417712642462, -576.1111165643176, -796.5359348072446, -851.7970741912089, -632.8092322101086, -810.7710614262986, -847.8961301431667, -471.1639878496019, -397.98461890179334, -626.0417642357235, -714.9277423333384, -829.4023967007583, -635.3796323504288, -556.2189432498506, -919.5731590167197, -754.1360318051926, -537.5444373432422, -905.7087849992973, -779.3920143593093, -664.7945392241998, -1101.7150092672578, -802.5362655413315, -560.9110034789785, -763.3839636604931, -706.9197901882482, -970.3672057228564, -381.2838877620823, -974.4620992989214, -737.171830609087, -599.3994534413603, -586.6191543822376, -674.8609996673108, -597.2667924258568, -833.3362260052252, -818.3292188067306, -770.9348475132427, -750.9399684702933], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.37339868558356, "mean_inference_ms": 0.41200960624743244, "mean_action_processing_ms": 0.09721424348352432, "mean_env_wait_ms": 2.705366395632402, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041656494140625, "StateBufferConnector_ms": 0.0030715465545654297, "ViewRequirementAgentConnector_ms": 0.07855653762817383}}, "episode_reward_max": -375.23106874514923, "episode_reward_min": -1394.7960535385373, "episode_reward_mean": -724.8629263364651, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-633.7974625198785, -843.1419560493296, -494.9268878267914, -728.7710160549568, -407.1850115070204, -556.4423050944647, -752.4553015690863, -683.1511278189711, -755.9634231077051, -879.4087224106784, -597.8825103006533, -929.6118089726612, -685.4104215993268, -792.4918267035575, -375.23106874514923, -718.2694750728991, -885.6244968640651, -857.5168079049236, -726.005393145418, -707.4462002130316, -1016.4463060166293, -638.7713585906026, -631.3172503155583, -441.13005998883165, -560.0535285752172, -835.5559653520096, -843.424134268684, -611.3110755033473, -940.0635300723793, -589.5815624494086, -769.948185224762, -782.6043779841912, -704.4174424911336, -714.7293239381523, -1083.910615176363, -769.1968810199785, -542.6562555105581, -887.1834975034957, -646.3894723048414, -415.3002837498957, -705.0800823076884, -1392.0773174553171, -1020.9090882897663, -864.4122305929538, -962.7355209637891, -395.6942547300457, -1394.7960535385373, -610.9216684922756, -530.8434302800124, -520.6665755719677, -657.9661195557549, -575.1866414357245, -899.6489232610088, -678.0447401003436, -661.9423248794734, -778.3975518883043, -749.6262845382524, -659.496500060774, -547.3716511321522, -1010.3096008115671, -732.6523420487819, -690.5860687472027, -403.6352442306562, -669.9417712642462, -576.1111165643176, -796.5359348072446, -851.7970741912089, -632.8092322101086, -810.7710614262986, -847.8961301431667, -471.1639878496019, -397.98461890179334, -626.0417642357235, -714.9277423333384, -829.4023967007583, -635.3796323504288, -556.2189432498506, -919.5731590167197, -754.1360318051926, -537.5444373432422, -905.7087849992973, -779.3920143593093, -664.7945392241998, -1101.7150092672578, -802.5362655413315, -560.9110034789785, -763.3839636604931, -706.9197901882482, -970.3672057228564, -381.2838877620823, -974.4620992989214, -737.171830609087, -599.3994534413603, -586.6191543822376, -674.8609996673108, -597.2667924258568, -833.3362260052252, -818.3292188067306, -770.9348475132427, -750.9399684702933], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.37339868558356, "mean_inference_ms": 0.41200960624743244, "mean_action_processing_ms": 0.09721424348352432, "mean_env_wait_ms": 2.705366395632402, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0041656494140625, "StateBufferConnector_ms": 0.0030715465545654297, "ViewRequirementAgentConnector_ms": 0.07855653762817383}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 327720, "num_agent_steps_trained": 327720, "num_env_steps_sampled": 327720, "num_env_steps_trained": 327720, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.562100833060384, "num_env_steps_trained_throughput_per_sec": 41.562100833060384, "timesteps_total": 327720, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 327720, "timers": {"training_iteration_time_ms": 2930.844, "sample_time_ms": 2926.926, "load_time_ms": 0.225, "load_throughput": 532215.798, "learn_time_ms": 2.903, "learn_throughput": 41330.318, "synch_weights_time_ms": 0.748}, "counters": {"num_env_steps_sampled": 327720, "num_env_steps_trained": 327720, "num_agent_steps_sampled": 327720, "num_agent_steps_trained": 327720}, "done": false, "episodes_total": 2731, "training_iteration": 684, "trial_id": "53665_00000", "date": "2023-07-26_04-05-31", "timestamp": 1690333531, "time_this_iter_s": 11.55175495147705, "time_total_s": 8267.40688943863, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2646.0814135074615, "iterations_since_restore": 224, "perf": {"cpu_util_percent": 41.756249999999994, "ram_util_percent": 66.16874999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4854431152344, "policy_loss": -108129.515625, "vf_loss": 4490266.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 897.0, "diff_num_grad_updates_vs_sampler_policy": 896.0}}, "num_env_steps_sampled": 328200, "num_env_steps_trained": 328200, "num_agent_steps_sampled": 328200, "num_agent_steps_trained": 328200}, "sampler_results": {"episode_reward_max": -375.23106874514923, "episode_reward_min": -1394.7960535385373, "episode_reward_mean": -726.9427648020861, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-407.1850115070204, -556.4423050944647, -752.4553015690863, -683.1511278189711, -755.9634231077051, -879.4087224106784, -597.8825103006533, -929.6118089726612, -685.4104215993268, -792.4918267035575, -375.23106874514923, -718.2694750728991, -885.6244968640651, -857.5168079049236, -726.005393145418, -707.4462002130316, -1016.4463060166293, -638.7713585906026, -631.3172503155583, -441.13005998883165, -560.0535285752172, -835.5559653520096, -843.424134268684, -611.3110755033473, -940.0635300723793, -589.5815624494086, -769.948185224762, -782.6043779841912, -704.4174424911336, -714.7293239381523, -1083.910615176363, -769.1968810199785, -542.6562555105581, -887.1834975034957, -646.3894723048414, -415.3002837498957, -705.0800823076884, -1392.0773174553171, -1020.9090882897663, -864.4122305929538, -962.7355209637891, -395.6942547300457, -1394.7960535385373, -610.9216684922756, -530.8434302800124, -520.6665755719677, -657.9661195557549, -575.1866414357245, -899.6489232610088, -678.0447401003436, -661.9423248794734, -778.3975518883043, -749.6262845382524, -659.496500060774, -547.3716511321522, -1010.3096008115671, -732.6523420487819, -690.5860687472027, -403.6352442306562, -669.9417712642462, -576.1111165643176, -796.5359348072446, -851.7970741912089, -632.8092322101086, -810.7710614262986, -847.8961301431667, -471.1639878496019, -397.98461890179334, -626.0417642357235, -714.9277423333384, -829.4023967007583, -635.3796323504288, -556.2189432498506, -919.5731590167197, -754.1360318051926, -537.5444373432422, -905.7087849992973, -779.3920143593093, -664.7945392241998, -1101.7150092672578, -802.5362655413315, -560.9110034789785, -763.3839636604931, -706.9197901882482, -970.3672057228564, -381.2838877620823, -974.4620992989214, -737.171830609087, -599.3994534413603, -586.6191543822376, -674.8609996673108, -597.2667924258568, -833.3362260052252, -818.3292188067306, -770.9348475132427, -750.9399684702933, -393.68778639551795, -769.3267209620735, -1040.349867238919, -705.2567944165421], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.37472863115813, "mean_inference_ms": 0.41209100760353623, "mean_action_processing_ms": 0.09722750262871908, "mean_env_wait_ms": 2.7054760925635746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00415492057800293, "StateBufferConnector_ms": 0.003055095672607422, "ViewRequirementAgentConnector_ms": 0.07831215858459473}}, "episode_reward_max": -375.23106874514923, "episode_reward_min": -1394.7960535385373, "episode_reward_mean": -726.9427648020861, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-407.1850115070204, -556.4423050944647, -752.4553015690863, -683.1511278189711, -755.9634231077051, -879.4087224106784, -597.8825103006533, -929.6118089726612, -685.4104215993268, -792.4918267035575, -375.23106874514923, -718.2694750728991, -885.6244968640651, -857.5168079049236, -726.005393145418, -707.4462002130316, -1016.4463060166293, -638.7713585906026, -631.3172503155583, -441.13005998883165, -560.0535285752172, -835.5559653520096, -843.424134268684, -611.3110755033473, -940.0635300723793, -589.5815624494086, -769.948185224762, -782.6043779841912, -704.4174424911336, -714.7293239381523, -1083.910615176363, -769.1968810199785, -542.6562555105581, -887.1834975034957, -646.3894723048414, -415.3002837498957, -705.0800823076884, -1392.0773174553171, -1020.9090882897663, -864.4122305929538, -962.7355209637891, -395.6942547300457, -1394.7960535385373, -610.9216684922756, -530.8434302800124, -520.6665755719677, -657.9661195557549, -575.1866414357245, -899.6489232610088, -678.0447401003436, -661.9423248794734, -778.3975518883043, -749.6262845382524, -659.496500060774, -547.3716511321522, -1010.3096008115671, -732.6523420487819, -690.5860687472027, -403.6352442306562, -669.9417712642462, -576.1111165643176, -796.5359348072446, -851.7970741912089, -632.8092322101086, -810.7710614262986, -847.8961301431667, -471.1639878496019, -397.98461890179334, -626.0417642357235, -714.9277423333384, -829.4023967007583, -635.3796323504288, -556.2189432498506, -919.5731590167197, -754.1360318051926, -537.5444373432422, -905.7087849992973, -779.3920143593093, -664.7945392241998, -1101.7150092672578, -802.5362655413315, -560.9110034789785, -763.3839636604931, -706.9197901882482, -970.3672057228564, -381.2838877620823, -974.4620992989214, -737.171830609087, -599.3994534413603, -586.6191543822376, -674.8609996673108, -597.2667924258568, -833.3362260052252, -818.3292188067306, -770.9348475132427, -750.9399684702933, -393.68778639551795, -769.3267209620735, -1040.349867238919, -705.2567944165421], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.37472863115813, "mean_inference_ms": 0.41209100760353623, "mean_action_processing_ms": 0.09722750262871908, "mean_env_wait_ms": 2.7054760925635746, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00415492057800293, "StateBufferConnector_ms": 0.003055095672607422, "ViewRequirementAgentConnector_ms": 0.07831215858459473}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 328200, "num_agent_steps_trained": 328200, "num_env_steps_sampled": 328200, "num_env_steps_trained": 328200, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.38248577965559, "num_env_steps_trained_throughput_per_sec": 41.38248577965559, "timesteps_total": 328200, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 328200, "timers": {"training_iteration_time_ms": 2897.094, "sample_time_ms": 2893.226, "load_time_ms": 0.222, "load_throughput": 540155.055, "learn_time_ms": 2.882, "learn_throughput": 41638.73, "synch_weights_time_ms": 0.724}, "counters": {"num_env_steps_sampled": 328200, "num_env_steps_trained": 328200, "num_agent_steps_sampled": 328200, "num_agent_steps_trained": 328200}, "done": false, "episodes_total": 2735, "training_iteration": 685, "trial_id": "53665_00000", "date": "2023-07-26_04-05-42", "timestamp": 1690333542, "time_this_iter_s": 11.601848840713501, "time_total_s": 8279.008738279343, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2657.683262348175, "iterations_since_restore": 225, "perf": {"cpu_util_percent": 41.01764705882354, "ram_util_percent": 64.24117647058823}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4757995605469, "policy_loss": -104307.09375, "vf_loss": 5465398.5}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 901.0, "diff_num_grad_updates_vs_sampler_policy": 900.0}}, "num_env_steps_sampled": 328680, "num_env_steps_trained": 328680, "num_agent_steps_sampled": 328680, "num_agent_steps_trained": 328680}, "sampler_results": {"episode_reward_max": -375.23106874514923, "episode_reward_min": -1394.7960535385373, "episode_reward_mean": -734.7297391531222, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-755.9634231077051, -879.4087224106784, -597.8825103006533, -929.6118089726612, -685.4104215993268, -792.4918267035575, -375.23106874514923, -718.2694750728991, -885.6244968640651, -857.5168079049236, -726.005393145418, -707.4462002130316, -1016.4463060166293, -638.7713585906026, -631.3172503155583, -441.13005998883165, -560.0535285752172, -835.5559653520096, -843.424134268684, -611.3110755033473, -940.0635300723793, -589.5815624494086, -769.948185224762, -782.6043779841912, -704.4174424911336, -714.7293239381523, -1083.910615176363, -769.1968810199785, -542.6562555105581, -887.1834975034957, -646.3894723048414, -415.3002837498957, -705.0800823076884, -1392.0773174553171, -1020.9090882897663, -864.4122305929538, -962.7355209637891, -395.6942547300457, -1394.7960535385373, -610.9216684922756, -530.8434302800124, -520.6665755719677, -657.9661195557549, -575.1866414357245, -899.6489232610088, -678.0447401003436, -661.9423248794734, -778.3975518883043, -749.6262845382524, -659.496500060774, -547.3716511321522, -1010.3096008115671, -732.6523420487819, -690.5860687472027, -403.6352442306562, -669.9417712642462, -576.1111165643176, -796.5359348072446, -851.7970741912089, -632.8092322101086, -810.7710614262986, -847.8961301431667, -471.1639878496019, -397.98461890179334, -626.0417642357235, -714.9277423333384, -829.4023967007583, -635.3796323504288, -556.2189432498506, -919.5731590167197, -754.1360318051926, -537.5444373432422, -905.7087849992973, -779.3920143593093, -664.7945392241998, -1101.7150092672578, -802.5362655413315, -560.9110034789785, -763.3839636604931, -706.9197901882482, -970.3672057228564, -381.2838877620823, -974.4620992989214, -737.171830609087, -599.3994534413603, -586.6191543822376, -674.8609996673108, -597.2667924258568, -833.3362260052252, -818.3292188067306, -770.9348475132427, -750.9399684702933, -393.68778639551795, -769.3267209620735, -1040.349867238919, -705.2567944165421, -1001.7650616954843, -669.1852585333245, -611.8230950371137, -895.1577658272226], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.37595968373785, "mean_inference_ms": 0.41217060308593145, "mean_action_processing_ms": 0.097240491817712, "mean_env_wait_ms": 2.7055864384167627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004136562347412109, "StateBufferConnector_ms": 0.0030438899993896484, "ViewRequirementAgentConnector_ms": 0.07815670967102051}}, "episode_reward_max": -375.23106874514923, "episode_reward_min": -1394.7960535385373, "episode_reward_mean": -734.7297391531222, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-755.9634231077051, -879.4087224106784, -597.8825103006533, -929.6118089726612, -685.4104215993268, -792.4918267035575, -375.23106874514923, -718.2694750728991, -885.6244968640651, -857.5168079049236, -726.005393145418, -707.4462002130316, -1016.4463060166293, -638.7713585906026, -631.3172503155583, -441.13005998883165, -560.0535285752172, -835.5559653520096, -843.424134268684, -611.3110755033473, -940.0635300723793, -589.5815624494086, -769.948185224762, -782.6043779841912, -704.4174424911336, -714.7293239381523, -1083.910615176363, -769.1968810199785, -542.6562555105581, -887.1834975034957, -646.3894723048414, -415.3002837498957, -705.0800823076884, -1392.0773174553171, -1020.9090882897663, -864.4122305929538, -962.7355209637891, -395.6942547300457, -1394.7960535385373, -610.9216684922756, -530.8434302800124, -520.6665755719677, -657.9661195557549, -575.1866414357245, -899.6489232610088, -678.0447401003436, -661.9423248794734, -778.3975518883043, -749.6262845382524, -659.496500060774, -547.3716511321522, -1010.3096008115671, -732.6523420487819, -690.5860687472027, -403.6352442306562, -669.9417712642462, -576.1111165643176, -796.5359348072446, -851.7970741912089, -632.8092322101086, -810.7710614262986, -847.8961301431667, -471.1639878496019, -397.98461890179334, -626.0417642357235, -714.9277423333384, -829.4023967007583, -635.3796323504288, -556.2189432498506, -919.5731590167197, -754.1360318051926, -537.5444373432422, -905.7087849992973, -779.3920143593093, -664.7945392241998, -1101.7150092672578, -802.5362655413315, -560.9110034789785, -763.3839636604931, -706.9197901882482, -970.3672057228564, -381.2838877620823, -974.4620992989214, -737.171830609087, -599.3994534413603, -586.6191543822376, -674.8609996673108, -597.2667924258568, -833.3362260052252, -818.3292188067306, -770.9348475132427, -750.9399684702933, -393.68778639551795, -769.3267209620735, -1040.349867238919, -705.2567944165421, -1001.7650616954843, -669.1852585333245, -611.8230950371137, -895.1577658272226], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.37595968373785, "mean_inference_ms": 0.41217060308593145, "mean_action_processing_ms": 0.097240491817712, "mean_env_wait_ms": 2.7055864384167627, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004136562347412109, "StateBufferConnector_ms": 0.0030438899993896484, "ViewRequirementAgentConnector_ms": 0.07815670967102051}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 328680, "num_agent_steps_trained": 328680, "num_env_steps_sampled": 328680, "num_env_steps_trained": 328680, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.4125393318306, "num_env_steps_trained_throughput_per_sec": 41.4125393318306, "timesteps_total": 328680, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 328680, "timers": {"training_iteration_time_ms": 2904.341, "sample_time_ms": 2900.54, "load_time_ms": 0.217, "load_throughput": 554008.233, "learn_time_ms": 2.821, "learn_throughput": 42531.75, "synch_weights_time_ms": 0.723}, "counters": {"num_env_steps_sampled": 328680, "num_env_steps_trained": 328680, "num_agent_steps_sampled": 328680, "num_agent_steps_trained": 328680}, "done": false, "episodes_total": 2739, "training_iteration": 686, "trial_id": "53665_00000", "date": "2023-07-26_04-05-54", "timestamp": 1690333554, "time_this_iter_s": 11.593745946884155, "time_total_s": 8290.602484226227, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2669.277008295059, "iterations_since_restore": 226, "perf": {"cpu_util_percent": 42.824999999999996, "ram_util_percent": 67.43125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4736633300781, "policy_loss": -104791.3125, "vf_loss": 4875606.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 905.0, "diff_num_grad_updates_vs_sampler_policy": 904.0}}, "num_env_steps_sampled": 329160, "num_env_steps_trained": 329160, "num_agent_steps_sampled": 329160, "num_agent_steps_trained": 329160}, "sampler_results": {"episode_reward_max": -375.23106874514923, "episode_reward_min": -1394.7960535385373, "episode_reward_mean": -738.4215094404622, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-685.4104215993268, -792.4918267035575, -375.23106874514923, -718.2694750728991, -885.6244968640651, -857.5168079049236, -726.005393145418, -707.4462002130316, -1016.4463060166293, -638.7713585906026, -631.3172503155583, -441.13005998883165, -560.0535285752172, -835.5559653520096, -843.424134268684, -611.3110755033473, -940.0635300723793, -589.5815624494086, -769.948185224762, -782.6043779841912, -704.4174424911336, -714.7293239381523, -1083.910615176363, -769.1968810199785, -542.6562555105581, -887.1834975034957, -646.3894723048414, -415.3002837498957, -705.0800823076884, -1392.0773174553171, -1020.9090882897663, -864.4122305929538, -962.7355209637891, -395.6942547300457, -1394.7960535385373, -610.9216684922756, -530.8434302800124, -520.6665755719677, -657.9661195557549, -575.1866414357245, -899.6489232610088, -678.0447401003436, -661.9423248794734, -778.3975518883043, -749.6262845382524, -659.496500060774, -547.3716511321522, -1010.3096008115671, -732.6523420487819, -690.5860687472027, -403.6352442306562, -669.9417712642462, -576.1111165643176, -796.5359348072446, -851.7970741912089, -632.8092322101086, -810.7710614262986, -847.8961301431667, -471.1639878496019, -397.98461890179334, -626.0417642357235, -714.9277423333384, -829.4023967007583, -635.3796323504288, -556.2189432498506, -919.5731590167197, -754.1360318051926, -537.5444373432422, -905.7087849992973, -779.3920143593093, -664.7945392241998, -1101.7150092672578, -802.5362655413315, -560.9110034789785, -763.3839636604931, -706.9197901882482, -970.3672057228564, -381.2838877620823, -974.4620992989214, -737.171830609087, -599.3994534413603, -586.6191543822376, -674.8609996673108, -597.2667924258568, -833.3362260052252, -818.3292188067306, -770.9348475132427, -750.9399684702933, -393.68778639551795, -769.3267209620735, -1040.349867238919, -705.2567944165421, -1001.7650616954843, -669.1852585333245, -611.8230950371137, -895.1577658272226, -883.0842883987327, -817.2666552135533, -1037.4125053981531, -794.2800445152567], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.376944430287004, "mean_inference_ms": 0.4122201353042661, "mean_action_processing_ms": 0.09724807637803522, "mean_env_wait_ms": 2.7055925667553424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003983974456787109, "StateBufferConnector_ms": 0.0029609203338623047, "ViewRequirementAgentConnector_ms": 0.07631134986877441}}, "episode_reward_max": -375.23106874514923, "episode_reward_min": -1394.7960535385373, "episode_reward_mean": -738.4215094404622, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-685.4104215993268, -792.4918267035575, -375.23106874514923, -718.2694750728991, -885.6244968640651, -857.5168079049236, -726.005393145418, -707.4462002130316, -1016.4463060166293, -638.7713585906026, -631.3172503155583, -441.13005998883165, -560.0535285752172, -835.5559653520096, -843.424134268684, -611.3110755033473, -940.0635300723793, -589.5815624494086, -769.948185224762, -782.6043779841912, -704.4174424911336, -714.7293239381523, -1083.910615176363, -769.1968810199785, -542.6562555105581, -887.1834975034957, -646.3894723048414, -415.3002837498957, -705.0800823076884, -1392.0773174553171, -1020.9090882897663, -864.4122305929538, -962.7355209637891, -395.6942547300457, -1394.7960535385373, -610.9216684922756, -530.8434302800124, -520.6665755719677, -657.9661195557549, -575.1866414357245, -899.6489232610088, -678.0447401003436, -661.9423248794734, -778.3975518883043, -749.6262845382524, -659.496500060774, -547.3716511321522, -1010.3096008115671, -732.6523420487819, -690.5860687472027, -403.6352442306562, -669.9417712642462, -576.1111165643176, -796.5359348072446, -851.7970741912089, -632.8092322101086, -810.7710614262986, -847.8961301431667, -471.1639878496019, -397.98461890179334, -626.0417642357235, -714.9277423333384, -829.4023967007583, -635.3796323504288, -556.2189432498506, -919.5731590167197, -754.1360318051926, -537.5444373432422, -905.7087849992973, -779.3920143593093, -664.7945392241998, -1101.7150092672578, -802.5362655413315, -560.9110034789785, -763.3839636604931, -706.9197901882482, -970.3672057228564, -381.2838877620823, -974.4620992989214, -737.171830609087, -599.3994534413603, -586.6191543822376, -674.8609996673108, -597.2667924258568, -833.3362260052252, -818.3292188067306, -770.9348475132427, -750.9399684702933, -393.68778639551795, -769.3267209620735, -1040.349867238919, -705.2567944165421, -1001.7650616954843, -669.1852585333245, -611.8230950371137, -895.1577658272226, -883.0842883987327, -817.2666552135533, -1037.4125053981531, -794.2800445152567], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.376944430287004, "mean_inference_ms": 0.4122201353042661, "mean_action_processing_ms": 0.09724807637803522, "mean_env_wait_ms": 2.7055925667553424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003983974456787109, "StateBufferConnector_ms": 0.0029609203338623047, "ViewRequirementAgentConnector_ms": 0.07631134986877441}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 329160, "num_agent_steps_trained": 329160, "num_env_steps_sampled": 329160, "num_env_steps_trained": 329160, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.45628705129574, "num_env_steps_trained_throughput_per_sec": 41.45628705129574, "timesteps_total": 329160, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 329160, "timers": {"training_iteration_time_ms": 2910.661, "sample_time_ms": 2906.844, "load_time_ms": 0.219, "load_throughput": 548573.82, "learn_time_ms": 2.818, "learn_throughput": 42588.612, "synch_weights_time_ms": 0.74}, "counters": {"num_env_steps_sampled": 329160, "num_env_steps_trained": 329160, "num_agent_steps_sampled": 329160, "num_agent_steps_trained": 329160}, "done": false, "episodes_total": 2743, "training_iteration": 687, "trial_id": "53665_00000", "date": "2023-07-26_04-06-06", "timestamp": 1690333566, "time_this_iter_s": 11.58153223991394, "time_total_s": 8302.18401646614, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2680.858540534973, "iterations_since_restore": 227, "perf": {"cpu_util_percent": 46.07647058823529, "ram_util_percent": 72.90588235294118}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"default_policy": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.0, "cur_lr": 1e-09, "entropy_coeff": 0.05, "policy_entropy": 267.4662170410156, "policy_loss": -90544.6171875, "vf_loss": 4119537.75}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 64.0, "num_grad_updates_lifetime": 909.0, "diff_num_grad_updates_vs_sampler_policy": 908.0}}, "num_env_steps_sampled": 329640, "num_env_steps_trained": 329640, "num_agent_steps_sampled": 329640, "num_agent_steps_trained": 329640}, "sampler_results": {"episode_reward_max": -381.2838877620823, "episode_reward_min": -1394.7960535385373, "episode_reward_mean": -742.3951555277827, "episode_len_mean": 120.0, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-885.6244968640651, -857.5168079049236, -726.005393145418, -707.4462002130316, -1016.4463060166293, -638.7713585906026, -631.3172503155583, -441.13005998883165, -560.0535285752172, -835.5559653520096, -843.424134268684, -611.3110755033473, -940.0635300723793, -589.5815624494086, -769.948185224762, -782.6043779841912, -704.4174424911336, -714.7293239381523, -1083.910615176363, -769.1968810199785, -542.6562555105581, -887.1834975034957, -646.3894723048414, -415.3002837498957, -705.0800823076884, -1392.0773174553171, -1020.9090882897663, -864.4122305929538, -962.7355209637891, -395.6942547300457, -1394.7960535385373, -610.9216684922756, -530.8434302800124, -520.6665755719677, -657.9661195557549, -575.1866414357245, -899.6489232610088, -678.0447401003436, -661.9423248794734, -778.3975518883043, -749.6262845382524, -659.496500060774, -547.3716511321522, -1010.3096008115671, -732.6523420487819, -690.5860687472027, -403.6352442306562, -669.9417712642462, -576.1111165643176, -796.5359348072446, -851.7970741912089, -632.8092322101086, -810.7710614262986, -847.8961301431667, -471.1639878496019, -397.98461890179334, -626.0417642357235, -714.9277423333384, -829.4023967007583, -635.3796323504288, -556.2189432498506, -919.5731590167197, -754.1360318051926, -537.5444373432422, -905.7087849992973, -779.3920143593093, -664.7945392241998, -1101.7150092672578, -802.5362655413315, -560.9110034789785, -763.3839636604931, -706.9197901882482, -970.3672057228564, -381.2838877620823, -974.4620992989214, -737.171830609087, -599.3994534413603, -586.6191543822376, -674.8609996673108, -597.2667924258568, -833.3362260052252, -818.3292188067306, -770.9348475132427, -750.9399684702933, -393.68778639551795, -769.3267209620735, -1040.349867238919, -705.2567944165421, -1001.7650616954843, -669.1852585333245, -611.8230950371137, -895.1577658272226, -883.0842883987327, -817.2666552135533, -1037.4125053981531, -794.2800445152567, -786.5204914171204, -681.4394255379233, -798.4763346505836, -702.3311492473624], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.377613555234873, "mean_inference_ms": 0.4122687788562638, "mean_action_processing_ms": 0.0972551664684838, "mean_env_wait_ms": 2.705553290972751, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003981113433837891, "StateBufferConnector_ms": 0.002954244613647461, "ViewRequirementAgentConnector_ms": 0.07613801956176758}}, "episode_reward_max": -381.2838877620823, "episode_reward_min": -1394.7960535385373, "episode_reward_mean": -742.3951555277827, "episode_len_mean": 120.0, "episodes_this_iter": 4, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [-885.6244968640651, -857.5168079049236, -726.005393145418, -707.4462002130316, -1016.4463060166293, -638.7713585906026, -631.3172503155583, -441.13005998883165, -560.0535285752172, -835.5559653520096, -843.424134268684, -611.3110755033473, -940.0635300723793, -589.5815624494086, -769.948185224762, -782.6043779841912, -704.4174424911336, -714.7293239381523, -1083.910615176363, -769.1968810199785, -542.6562555105581, -887.1834975034957, -646.3894723048414, -415.3002837498957, -705.0800823076884, -1392.0773174553171, -1020.9090882897663, -864.4122305929538, -962.7355209637891, -395.6942547300457, -1394.7960535385373, -610.9216684922756, -530.8434302800124, -520.6665755719677, -657.9661195557549, -575.1866414357245, -899.6489232610088, -678.0447401003436, -661.9423248794734, -778.3975518883043, -749.6262845382524, -659.496500060774, -547.3716511321522, -1010.3096008115671, -732.6523420487819, -690.5860687472027, -403.6352442306562, -669.9417712642462, -576.1111165643176, -796.5359348072446, -851.7970741912089, -632.8092322101086, -810.7710614262986, -847.8961301431667, -471.1639878496019, -397.98461890179334, -626.0417642357235, -714.9277423333384, -829.4023967007583, -635.3796323504288, -556.2189432498506, -919.5731590167197, -754.1360318051926, -537.5444373432422, -905.7087849992973, -779.3920143593093, -664.7945392241998, -1101.7150092672578, -802.5362655413315, -560.9110034789785, -763.3839636604931, -706.9197901882482, -970.3672057228564, -381.2838877620823, -974.4620992989214, -737.171830609087, -599.3994534413603, -586.6191543822376, -674.8609996673108, -597.2667924258568, -833.3362260052252, -818.3292188067306, -770.9348475132427, -750.9399684702933, -393.68778639551795, -769.3267209620735, -1040.349867238919, -705.2567944165421, -1001.7650616954843, -669.1852585333245, -611.8230950371137, -895.1577658272226, -883.0842883987327, -817.2666552135533, -1037.4125053981531, -794.2800445152567, -786.5204914171204, -681.4394255379233, -798.4763346505836, -702.3311492473624], "episode_lengths": [120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120, 120]}, "sampler_perf": {"mean_raw_obs_processing_ms": 21.377613555234873, "mean_inference_ms": 0.4122687788562638, "mean_action_processing_ms": 0.0972551664684838, "mean_env_wait_ms": 2.705553290972751, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.003981113433837891, "StateBufferConnector_ms": 0.002954244613647461, "ViewRequirementAgentConnector_ms": 0.07613801956176758}, "num_healthy_workers": 1, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 329640, "num_agent_steps_trained": 329640, "num_env_steps_sampled": 329640, "num_env_steps_trained": 329640, "num_env_steps_sampled_this_iter": 480, "num_env_steps_trained_this_iter": 480, "num_env_steps_sampled_throughput_per_sec": 41.491096502550285, "num_env_steps_trained_throughput_per_sec": 41.491096502550285, "timesteps_total": 329640, "num_steps_trained_this_iter": 480, "agent_timesteps_total": 329640, "timers": {"training_iteration_time_ms": 2900.117, "sample_time_ms": 2896.204, "load_time_ms": 0.222, "load_throughput": 541666.466, "learn_time_ms": 2.897, "learn_throughput": 41421.134, "synch_weights_time_ms": 0.752}, "counters": {"num_env_steps_sampled": 329640, "num_env_steps_trained": 329640, "num_agent_steps_sampled": 329640, "num_agent_steps_trained": 329640}, "done": false, "episodes_total": 2747, "training_iteration": 688, "trial_id": "53665_00000", "date": "2023-07-26_04-06-17", "timestamp": 1690333577, "time_this_iter_s": 11.572077989578247, "time_total_s": 8313.756094455719, "pid": 94453, "hostname": "MacBook-Air-Bulat-2.local", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 6, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "DataCenterEnv", "env_config": {"eplus_path": "/Applications/EnergyPlus-23-1-0/", "weather_file": "weather/Moscow.epw", "days": 1, "timestep": 5, "verbose": 1}, "observation_space": null, "action_space": "Box(0.0, 1.0, (3,), float32)", "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": true, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": 120, "batch_mode": "complete_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 0.0001, "lr_schedule": [[253680, 5e-08], [256080, 5e-08], [258480, 2.5e-08], [260880, 2.5e-08], [263280, 2.5e-08], [265680, 2.5e-08], [268080, 1e-08], [270480, 1e-08], [272880, 1e-08], [275280, 5e-09], [277680, 5e-09], [280080, 5e-09], [282480, 5e-09], [284880, 5e-09], [287280, 1e-09], [289680, 1e-09], [292080, 1e-09]], "grad_clip": 10, "grad_clip_by": "global_norm", "train_batch_size": 120, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [256, 256], "fcnet_activation": "tanh", "conv_filters": null, "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": true, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": 10, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": false, "metrics_smoothing_episodes": 1, "timesteps_per_iteration": 120, "replay_sequence_length": null, "horizon": 120, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "vf_loss_coeff": 0.5, "entropy_coeff": 0.05, "entropy_coeff_schedule": null, "microbatch_size": null, "sgd_minibatch_size": 64, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": {"default_policy": [null, null, null, null]}, "policy_mapping_fn": "<function AlgorithmConfig.DEFAULT_POLICY_MAPPING_FN at 0x17e8f6700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 1}, "time_since_restore": 2692.4306185245514, "iterations_since_restore": 228, "perf": {"cpu_util_percent": 38.125, "ram_util_percent": 68.03125}}
